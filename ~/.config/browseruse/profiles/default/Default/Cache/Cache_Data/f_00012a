/*
 Kingdee Galaxy 
 build on [2023-05-30 09:33:03.729]. 
**/
function KDVGridConst(e,t){var r="KDVGrid",l=r,o=KDVGridHelper,a=(window.KDVXReses,t),i=a.CONSTVARS=function(e){var t={};t.C_MIN_COLWIDTH=5,t.C_MAX_COLWIDTH=1024,t.C_DelayCalc=1,t.C_DelayCalc_Scroll=4,t.C_Scroll_DetaGate=30,t.C_RowLimit=2e5,t.C_OptimizeRowLimit=1,t.C_OptimizeColLimit=15,t.C_RenderMaxCols=150,t.C_GroupLevelLeftInPx=12,t.C_CellBorderWidth=2,t.C_CellBorderHeight=2,t.C_VGrid_DefTheme_Cls=".kd-v-grid-theme-standard",t.C_VGrid_TxtEllipsisCls=".kd-v-text-ellipsis",t.C_VGrid_DrawRectCls=".kd-v-grid-draw-rangerect",t.C_SelField="F_SelState",t.C_DIV="<div>",t.C_SPAN="<span>",t.C_INPUT="<input>",t.C_SingleSel="single",t.C_MultiSel="multipule",t.C_DragColResizerKey="dragdropData_colresizer",t.C_DragColPosKey="dragdropData_colpos",t.C_RenderHandle="__renderOnce_handle",t.C_CalcViewHandle="__CalcViewOnce_handle",t.C_AfterTypingHandle="__AfterTyping_handle",t.C_AfterColHeadCtxMenuHandle="__AfterColHeadCtxMenu_handle",t.C_FindLocatingHandle="__FindLocating_handle",t.C_DataUiidKey="data-uiid",t.C_Area_CenterView="CenterView",t.C_Area_LeftView="LeftView",t.C_Area_RightView="RightView",t.C_VGrid_Area_Cls=".kd-v-grid-area",t.C_VGridCls=".kd-vgrid",t.C_VGridRootCls=".kd-v-grid-root",t.C_VGridFontsCls=".kd-vgrid-fonts",t.C_NoSelectText=".kd-v-noselecttext",t.C_VGridSingleSelModeCls=".kd-vgrid-single-sel",t.C_VGridIsCachedCls=".kd-v-grid-el-cached",t.C_VGridLeftPadCls=".kd-v-grid-left-pad",t.C_VGridCenterPadCls=".kd-v-grid-center-pad",t.C_VGridRightPadCls=".kd-v-grid-right-pad",t.C_VGridCenterPadViewCls=".kd-v-grid-center-vw",t.C_VGridLeftPadViewCls=".kd-v-grid-left-vw",t.C_VGridRightPadViewCls=".kd-v-grid-left-vw",t.C_VGridFrozenEmptyCls=".kd-v-grid-frozen-empty",t.C_VGridFrozenLeftCls=".kd-v-grid-frozenleft",t.C_VGridNormalCenterCls=".kd-v-grid-normalcenter",t.C_VGridFrozenRightCls=".kd-v-grid-frozenright",t.C_VGridViewCls=".kd-v-grid-viewport",t.C_VGridViewCliperCls=".kd-v-grid-vp-cliper",t.C_VGridViewCliperViewCls=".kd-v-grid-cliper-viewport",t.C_VGridViewLeftCls=".kd-v-grid-vp-pleft",t.C_VGridViewRightCls=".kd-v-grid-vp-pright",t.C_VGridHeaderCls=".kd-v-grid-header",t.C_ColHeaderContainerCls=".kd-v-grid-header-ct",t.C_ColHeaderCls=".kd-v-grid-colheader",t.C_ColHeaderCTCls=".kd-v-grid-colheader-ct",t.C_ColHeaderFuncCtCls=".kd-v-grid-colheader-func-ct",t.C_ColMergedHeaderCls=".kd-v-grid-colMergedheader",t.C_ColMergedHeaderUpCls=".kd-v-grid-colMergedheader-up",t.C_ColHeaderTitleCls=".kd-v-grid-colheader-title",t.C_ColHeaderSortCls=".kd-v-grid-colheader-sort",t.C_ColHeaderFilterCls=".kd-v-grid-colheader-filter",t.C_ColHeaderDebugCls=".kd-v-grid-colheader-debug",t.C_ColHeaderFilterPinnedCls=".kd-v-grid-colheader-filter-pinned",t.C_ColHeaderResizerCls=".kd-v-grid-colheader-resizer",t.C_ColHeaderResizerPhantomCls=".kd-v-grid-colheader-resizer-phantom",t.C_ColHeaderLeftResizerCls=".kd-v-grid-colheader-left-resizer",t.C_ColHeaderResizerPhantomCls=".kd-v-grid-colheader-resizer-phantom",t.C_ColHeaderChgPosFlagCls=".kd-v-grid-colheader-chgposflag",t.C_VGridFilterRowCls=".kd-v-grid-filter-row",t.C_ColFilterRowContainerCls=".kd-v-grid-filter-row-ct",t.C_ColFilterRowCellCls=".kd-v-grid-filter-row-cell",t.C_ColFilterRowInputCls=".kd-v-grid-filter-row-ct-input",t.C_ColInputDelBtnCls=".kd-v-grid-inpdel",t.C_VGridFooterCls=".kd-v-grid-footer",t.C_ColFooterRowContainerCls=".kd-v-grid-footer-row-ct",t.C_ColFooterRowCellCls=".kd-v-grid-footer-row-cell",t.C_ColFooterRowCellDataCls=".kd-v-grid-footer-row-cell-data",t.C_ColFooterRowCellLeftBrCls=".kd-v-grid-footer-row-leftbr",t.C_VGridHScrollbarCls=".kd-v-grid-hscrollbar",t.C_VGridHScrollbarHolderCls=".kd-v-grid-hscroll-holder",t.C_VGridRowCls=".kd-v-grid-row",t.C_VGridRowsContainerCls=".kd-v-grid-rowsct",t.C_VGridRowSelCls=".kd-v-grid-row-selected",t.C_VGridRowOddCls=".kd-v-grid-row-odd-disable",t.C_VGridCellCls=".kd-v-grid-cell",t.C_VGridCellCTCls=".kd-v-grid-cell-ct",t.C_VGridCellTxtCls=".kd-v-grid-cell-txt",t.C_VGridChkCls=".kd-v-grid-chk-lbl",t.C_VGridChkSelCls=".kd-v-grid-chk-lbl-sel",t.C_VGridChkHalfSelCls=".kd-v-grid-chk-lbl-half-sel",t.C_VGridCellComCls=".kd-v-grid-cellcom",t.C_VGridCellLocatedCls=".kd-v-grid-cell-located",t.C_VGridCellMulSelCls=".kd-v-grid-cell-mulsel",t.C_VGridCellSparkCls=".kd-v-grid-cell-spark",t.C_VGridCellVBorderCls=".kd-v-grid-cell-vborder",t.C_VGrid_Row_Role="kdvgridrow",t.C_VGrid_Cell_Role="kdvgridcell",t.C_VGrid_Filter_Row_Role="kdvgridfilterrow",t.C_VGrid_FilterCell_Role="kdvgridfiltercell",t.C_VGrid_Footer_Row_Role="kdvgridfooterrow",t.C_VGrid_SumCell_Role="kdvgridsumcell",t.C_VGrid_Header_Row_Role="kdvgridheaderrow",t.C_VGrid_Header_Cell_Role="kdvgridheadercell",t.C_RowSelector=o.strFormat("{0} {1}",t.C_VGridCenterPadCls,t.C_VGridRowCls),t.C_CellSelector=o.strFormat("{0} {1}",t.C_VGridCenterPadCls,t.C_VGridCellCls),t.C_CellComSelector=o.strFormat("{0} {1} {2}",t.C_VGridCenterPadCls,t.C_VGridCellCls,t.C_VGridCellComCls),t.C_LeftRowSelector=o.strFormat("{0} {1}",t.C_VGridLeftPadCls,t.C_VGridRowCls),t.C_FrozenLeftRowSelector=o.strFormat("{0} {1}",t.C_VGridFrozenLeftCls,t.C_VGridRowCls),t.C_SelCell_Selector=o.strFormat('[data-field="{0}"]',t.C_SelField),t.C_FrozenLeftRowHeaderChkerSelector=o.strFormat("{0} {1}{2}",t.C_VGridFrozenLeftCls,t.C_ColHeaderCls,t.C_SelCell_Selector),t.C_VGridGrpCellCt=".kd-v-grid-grpct",t.C_VGridGrpCellCheckBox=".kd-v-grid-grp-checkbox",t.C_VGridGrpColFlag=".kd-v-grid-grp-colflag",t.C_VGridGrpCellExpanded=".kd-v-grid-grp-expanded",t.C_VGridGrpCellContracted=".kd-v-grid-grp-contracted",t.C_VGridGrpCellText=".kd-v-grid-grp-txt",t.C_VGridGrpCellChild=".kd-v-grid-grp-child",t.C_GroupCellExpandSelector=o.strFormat("{0} {1},{0} {2}",t.C_VGridCellCTCls,t.C_VGridGrpCellExpanded,t.C_VGridGrpCellContracted),t.C_LeftPadRowChkerSelector=o.strFormat("{0} {1} {2}",t.C_VGridLeftPadCls,t.C_VGridRowCls,t.C_SelCell_Selector),t.C_LeftPadRowHeaderChkerSelector=o.strFormat("{0} {1}{2}",t.C_VGridLeftPadCls,t.C_ColHeaderCls,t.C_SelCell_Selector),t.C_HeaderResizerSelector=o.strFormat("{0} {1} {2}",t.C_VGridCenterPadViewCls,t.C_ColHeaderCls,t.C_ColHeaderResizerCls),t.C_HeaderResizerTargetSelector=o.strFormat("{0} {1}",t.C_VGridCenterPadViewCls,t.C_ColHeaderContainerCls),t.C_HeaderDragPosSelector=o.strFormat("{0} {1}",t.C_VGridCenterPadViewCls,t.C_ColHeaderCls),t.C_HeaderDragPosTargetSelector=o.strFormat("{0} {1}",t.C_VGridCenterPadViewCls,t.C_ColHeaderContainerCls),t.C_CtxMenuSelector=o.strFormat("{0},{1}",t.C_ColHeaderCls,t.C_VGridCellCls),t.C_VGrid_IconfontsCls=".kd-v-grid-iconfonts",t.C_VGrid_IconCls=".kd-v-grid-icon",t.C_VGridIconCtx=".kd-v-grid-ctxmenu-icon",t.C_VGridIconFilter=".kd-v-grid-i-filter",t.C_VGridIconGroup=".kd-v-grid-i-group",t.C_VGridIconUngroup=".kd-v-grid-i-ungroup",t.C_VGridIconGroupExpanded=".kd-v-grid-i-group-expanded",t.C_VGridIconGroupContracted=".kd-v-grid-i-group-contracted",t.C_VGridIconColumn=".kd-v-grid-i-column",t.C_VGridIconLock=".kd-v-grid-i-lock",t.C_VGridIconUnlock=".kd-v-grid-i-unlock",t.C_VGridIconFavor=".kd-v-grid-i-favor",t.C_VGridIconClose=".kd-v-grid-i-close",t.C_Click=o.strFormat("click.{0}",e),t.C_DBLClick=o.strFormat("dblclick.{0}",e),t.C_MouseDown=o.strFormat("mousedown.{0}",e),t.C_MouseMove=o.strFormat("mousemove.{0}",e),t.C_MouseUp=o.strFormat("mouseup.{0}",e),t.C_ContextMenu=o.strFormat("contextmenu.{0}",e),t.C_KeyDown=o.strFormat("keydown.{0}",e),t.C_KeyUp=o.strFormat("keyup.{0}",e),t.C_Scroll=o.strFormat("scroll.{0}",e),t.C_Change=o.strFormat("keyup.{0}",e),t.C_MouseMove=o.strFormat("mousemove.{0}",e),t.C_MouseOver=o.strFormat("mouseover.{0}",e),t.C_DragStart=o.strFormat("dragstart.{0}",e),t.C_DropEnd=o.strFormat("dragend.{0}",e),t.C_Drag=o.strFormat("drag.{0}",e),t.C_DragEnter=o.strFormat("dragenter.{0}",e),t.C_DragOver=o.strFormat("dragover.{0}",e),t.C_Drop=o.strFormat("drop.{0}",e),t.C_DragLeave=o.strFormat("dragleave.{0}",e),t.C_SortFlagText="",t.C_FilterFlageText="",t.C_ResizerText="",t.C_ColDefDisplayType="text",t.C_CMD_FrozenLeft="frozenLeft",t.C_CMD_FrozenRight="frozenRight",t.C_CMD_UnFrozen="unfrozen",t.C_CMD_GroupBy="groupby",t.C_CMD_UnGroupBy="ungroupby",t.C_CMD_CellUnGroupBy="cellungroupby",t.C_CMD_ColAggr="colAggr",t.C_CMD_Copy="copy",t.C_CMD_Parse="parse",t.C_CMD_CellMultiSel="cellMultiSel",t.C_CMD_UnCellMultiSel="unCellMultiSel",t.OpeKeys={SortData:"sortData",FilterData:"filterData",GroupBy:"groupBy",TotalSum:"TotalSum",Frozen:"frozen",MergerHeaders:"mergerHeaders",HScroll:"hScroll",VScroll:"vScroll",DataUpdate:"dataUpdate",DragDrop:"dragDrop",ShowHide:"showHide",ColWidth:"colWidth",Selection:"selection",ServerSelection:"serverselection",DoLayout:"doLayout"};var r=t.CacheElRoles={};return r[t.C_VGrid_Row_Role]=!0,r[t.C_VGrid_Cell_Role]=!0,r[t.C_VGrid_Filter_Row_Role]=!0,r[t.C_VGrid_FilterCell_Role]=!0,r[t.C_VGrid_Footer_Row_Role]=!0,r[t.C_VGrid_SumCell_Role]=!0,r[t.C_VGrid_Header_Row_Role]=!0,r[t.C_VGrid_Header_Cell_Role]=!0,t}(l);i=function(e,t){t.C_VGridCellEditorContainer=".kd-v-grid-cell-editor-ct",t.C_VGridCellEditorDefInput=".kd-v-grid-cell-editor-definput"}(l,i)}function KDVGrid_Events(e,t){var r="KDVGrid",l=KDVGridHelper,o=window.KDVXReses,a=t,i=a.CONSTVARS;l.ext(a,{handlerCenterPadRowClick:function(t){var r=this,o=r.options,n=r.viewOptions||{},s=e(t.target).closest(i.C_CellSelector,r).data()||{},d=!!s.field,c=n.currentFocusCell;l.equalsIC(c.field,i.C_SelField);if(!d){var C=c.field||r.getColumnDefs()[0].field,u=l.strFormat('[data-field="{0}"]',C);a.handlerCenterPadCellClick.call(r,t,e(u,t.currentTarget))}a.updateRowSelectUIState.call(r,{targetEl:e(t.currentTarget)}),o.onRowSelected&&(t.node={data:c},o.onRowSelected(t))},handlerCenterPadCellClick:function(t,r){var o=this,n=o.options,s=o.viewOptions||{},d=s.rowClickAsAppendSelect,c=s.selectedRows,C=e(r||t.target);C.hasClass(l.getClsNames(i.C_VGridCellCls))||(C=C.closest(i.C_CellSelector,o));var u=l.getData(C),f=C.closest(i.C_VGridRowCls),p=l.getData(f),g=l.equalsIC(u.field,i.C_SelField),h=o.isMultiSelection(),v=g||d||t.ctrlKey||t.shiftKey?i.C_MultiSel:i.C_SingleSel,w=h?v:i.C_SingleSel,_=!0;if(w==i.C_MultiSel){var m=p.rowid,V=s.selectedRows=s.selectedRows||{};_=void 0===V[m]?!0:!V[m]}if(t.shiftKey&&!l.isEmpty(s.lastShiftClickRowData)){for(var D=a.getViewRowDataMaps.call(o),y=[],F=s.lastShiftClickRowData.curindex,S=p.curindex,R=S>F?F:S,I=S>F?S:F,x=R;I>=x;x++){var G=D[x];l.isEmpty(G)||y.push(G.rowId)}for(var x=0;x<y.length;x++){var k=y[x];""!=k&&void 0!==k&&(c[k]=!0)}l.writeLogFormat("shift selected - lastShiftClickRowId: {0}",!1,s.lastShiftClickRowId)}a.setSelectedRows.call(o,p.rowid,_,w);var M=s.currentFocusCell={field:u.field,rowId:l.parseRowId(p.rowid,-1),rowIndex:p.rowindex,isSelected:_};n.onSelectionChanged&&(t.node={data:M},n.onSelectionChanged(t)),s.lastClickRowData=p,a.execCellEditorHandler(o,a.handlerCenterPadCellClick_cellEditor,t,r||C,M)},handlerCenterPadCellDBLClick:function(t){var r=this,o=r.options,n=r.viewOptions||{},s=e(t.currentTarget),d=l.getData(s),c=s.closest(i.C_VGridRowCls),C=l.getData(c),u=n.currentFocusCell={field:d.field,rowId:l.parseRowId(C.rowid,-1),rowIndex:C.rowindex,isSelected:!0};o.onRowDoubleClicked&&(t.node={data:u},o.onRowDoubleClicked(t)),a.execCellEditorHandler(r,a.handlerCenterPadCellDBLClick_cellEditor,t,s,u)},handlerCenterPadCellMouseDown:function(t){var r=this,o=(r.options,r.viewOptions||{}),n=(0==t.button,2==t.button);if(o.isMultiCellSelMode&&!n){t.preventDefault();var s=o.multiCellSelInfo,d=(o.selectedRows,e(t.currentTarget).closest(i.C_VGridCellCls)),c=d.closest(".kd-v-grid-area"),C=l.getData(d),u=d.closest(i.C_VGridRowCls),f=l.getData(u),p=l.getData(c),g=o.currentFocusCell={field:C.field,rowId:parseInt(f.rowid),rowIndex:f.rowindex,x:t.clientX,y:t.clientY,area:p.area||i.CS.C_Area_CenterView,isSelected:!0};s.isDrawing=!0,s.startCell=g,a.removeCellMulSelCls.call(r),a.execCellEditorHandler(r,a.handlerCenterPadCellMouseDown_cellEditor,t,d,g)}},handlerCenterPadCellMouseMove:function(e){var t=this,r=t.viewOptions||{};if(r.isMultiCellSelMode){var l=r.multiCellSelInfo;if(l.isDrawing){var o={x:e.clientX,y:e.clientY};l.curPos=o,a.drawCellSelectedRangeRect.call(t)}a.execCellEditorHandler(t,a.handlerCenterPadCellMouseMove_cellEditor,e)}},handlerCenterPadCellMouseUp:function(t){var r=this,o=(r.options,r.viewOptions||{}),n=(0==t.button,2==t.button);if(o.isMultiCellSelMode&&!n){var s=o.multiCellSelInfo,d=(o.selectedRows,e(t.currentTarget).closest(i.C_VGridCellCls)),c=l.getData(d),C=d.closest(i.C_VGridRowCls),u=l.getData(C);s.cells={},s.isDrawing=!1;var f=o.currentFocusCell={field:c.field,rowId:parseInt(u.rowid),rowIndex:u.rowindex,x:t.clientX,y:t.clientY,isSelected:!0};s.endCell=f,a.removeCellSelectedRangeRect.call(r),o.rendering=!0;var p=f.rowId,g=f.field;l.delayReferOnce(r,i.C_RenderHandle,function(t){a.updateMultiCellSelected.call(t,function(t){var r=e(l.strFormat('{0}[data-rowid="{1}"]',i.C_VGridRowCls,p),t);e(l.strFormat('{0}[data-field="{1}"]',i.C_VGridCellCls,g),r).trigger("focus")}),o.rendering=!1},i.C_DelayCalc,i.C_RenderHandle),a.execCellEditorHandler(r,a.handlerCenterPadCellMouseUp_cellEditor,t,d,f)}},handlerCenterPadCellComClick:function(t){var r=this,o=r.options,n=r.viewOptions||{},s=(n.selectedRows,e(t.currentTarget).closest(i.C_VGridCellCls)),d=l.getData(s),c=s.closest(i.C_VGridRowCls),C=l.getData(c),u=n.currentFocusCell={field:d.field,rowId:parseInt(C.rowid),rowIndex:C.rowindex,isSelected:!0};o.onCellComClick&&(t.node={data:u},o.onCellComClick(t)),a.execCellEditorHandler(r,a.handlerCenterPadCellComClick_cellEditor,t,s,u)},handlerKDVGridContextMenu:function(t){var n=this,s=n.viewOptions||{},d=150,c=(s||{}).colHeaderHeight||35,C=s.contextMenus=s.contextMenus||{};t.preventDefault();var u=e(t.currentTarget),f=u.text(),p=l.getData(u),g=(!!p.valfield,u.hasClass(l.getClsNames(i.C_ColHeaderCls))),h=u.hasClass(l.getClsNames(i.C_VGridCellCls)),v=g?u.closest(i.C_ColHeaderContainerCls):h?u.closest(i.C_VGridRowCls):u,w=l.getData(v),_=l.strFormat("{0}{1}",i.C_VGridHeaderCls,i.C_VGridCenterPadViewCls),m=v.closest(_),V=(l.getElPos(m),u.offset()),D=document.body.clientWidth-d,y=t.clientX>D?D:t.clientX,F={left:y,top:V.top+c},S=function(){return l.ext({},w,p,{owner:n,themeCls:s.themeCls,isHeader:g,isGridCell:h,cellText:f||"",offset:{left:F.left+2,top:F.top+2},size:{width:d,height:c},items:[],itemClick:function(e,t){var r=t.data||{},o=t.scope,i=l.setNextTick(function(t){l.clearNextTick(i),l.writeLogFormat("KDVGridContextMenu -itemClick - {0}",!1,r),a.handlerKDVGridContextMenu_itemClick.call(t,e,r)},100,o)}})}(),R=l.getClsNames(i.C_VGrid_IconfontsCls,i.C_VGridIconCtx);if(g){S.items=[{key:i.C_CMD_ColAggr,iconCls:l.strFormat("{0} {1}",l.getClsNames(i.C_VGridIconColumn),R),text:o[r][i.C_CMD_ColAggr]}];var I=a.getColDef.call(n,p.field||"");l.equalsIC(i.C_SelField,p.field)||l.isEmpty(I)||(S.items=S.items.concat([{key:i.C_CMD_FrozenLeft,iconCls:l.strFormat("{0} {1}",l.getClsNames(i.C_VGridIconLock),R),text:o[r][i.C_CMD_FrozenLeft]},{key:i.C_CMD_FrozenRight,iconCls:l.strFormat("{0} {1}",l.getClsNames(i.C_VGridIconFavor),R),text:o[r][i.C_CMD_FrozenRight]},{key:i.C_CMD_UnFrozen,iconCls:l.strFormat("{0} {1}",l.getClsNames(i.C_VGridIconUnlock),R),text:o[r][i.C_CMD_UnFrozen]}]),l.getValue(I,"groupable",!0)&&(S.items=S.items.concat([{key:i.C_CMD_GroupBy,iconCls:l.strFormat("{0} {1}",l.getClsNames(i.C_VGridIconGroup),R),text:o[r][i.C_CMD_GroupBy]},{key:i.C_CMD_UnGroupBy,iconCls:l.strFormat("{0} {1}",l.getClsNames(i.C_VGridIconUngroup),R),text:o[r][i.C_CMD_UnGroupBy]}])))}else{if(!h)return;S.items=[{key:i.C_CMD_Copy,text:o[r][i.C_CMD_Copy]}],s.isMultiCellSelMode?S.items.push({key:i.C_CMD_UnCellMultiSel,text:o[r][i.C_CMD_UnCellMultiSel]}):S.items.push({key:i.C_CMD_CellMultiSel,text:o[r][i.C_CMD_CellMultiSel]})}var x=g?"ctxHeader":"gridcell",G=C[x];G?G.setOptions.call(G,S):G=new KDVContextMenu(S),C[x]=G},handlerKDVGridContextMenu_itemClick:function(e,t){var r=this,o=!1,n=!1,s=r.viewOptions||{},d=s.viewColMaps,c=s.groupbyFieldMaps,C=r.getFrozenLeftViewColumns(),u=r.getFrozenRightViewColumns(),f=l.equalsIC(i.C_CMD_CellUnGroupBy,t.cmdKey)?t.valfield||t.field:t.field,p=d[f],g=l.equalsIC(i.C_CMD_ColAggr,t.cmdKey);if(g)o=!1,a.handlerColHeaderAggrListClick.call(r,e,t);else if(p)if(o=!0,l.equalsIC(i.C_CMD_FrozenLeft,t.cmdKey))p.area=i.C_Area_LeftView,l.addColPosMapItem(p,C),a.calcFrozenColWidth.call(r);else if(l.equalsIC(i.C_CMD_FrozenRight,t.cmdKey))p.area=i.C_Area_RightView,l.aheadInsColPosMapItem(p,u),a.calcFrozenColWidth.call(r);else if(l.equalsIC(i.C_CMD_UnFrozen,t.cmdKey))p.area=i.C_Area_CenterView,l.removeColPosMapItem(p,C),l.removeColPosMapItem(p,u),a.calcFrozenColWidth.call(r);else if(l.equalsIC(i.C_CMD_GroupBy,t.cmdKey)){p.rowGroup=!0,l.addColPosMapItem(p,c);var h=0;l.eachProp(c,"length",function(e,t){var r=t[e];r.rowGroupSeq=h,h++}),n=!0}else if(l.equalsIC(i.C_CMD_UnGroupBy,t.cmdKey)){p.rowGroup=!1,l.removeColPosMapItem(p,c);var h=0;l.eachProp(c,"length",function(e,t){var r=t[e];r.rowGroupSeq=h,h++}),n=!0}else if(l.equalsIC(i.C_CMD_CellUnGroupBy,t.cmdKey)){p.rowGroup=!1,l.removeColPosMapItem(p,c);var h=0;l.eachProp(c,"length",function(e,t){var r=t[e];r.rowGroupSeq=h,h++}),n=!0}else l.equalsIC(i.C_CMD_Copy,t.cmdKey)?(o=!1,a.copySelectedCellsToClipBoard.call(r,t.cellText,null,t)):l.equalsIC(i.C_CMD_CellMultiSel,t.cmdKey)?(s.isMultiCellSelMode=!0,o=!1):l.equalsIC(i.C_CMD_UnCellMultiSel,t.cmdKey)?(s.isMultiCellSelMode=!1,s.multiCellSelInfo={},o=!1,a.removeCellMulSelCls.call(r)):l.equalsIC(i.C_CMD_Parse,t.cmdKey)||(o=!1);if(o){var v=function(){l.writeLogFormat("{0}, {1}",!1,"handlerKDVGridContextMenu_itemClick","algorithmStrategyInvoke")};n?a.algorithmStrategyInvoke.call(r,v,i.OpeKeys.GroupBy):a.algorithmStrategyInvoke.call(r,v,i.OpeKeys.Frozen)}},handlerKDVGridMouseBtnDown:function(e){var t=this;t.viewOptions||{};return 2==e.which||3==e.which?(e.stopPropagation(),!1):void l.writeLogFormat("KDVGridMouseBtnDown - which = {0}",!1,e.which)},handlerKDVGridKeydown:function(e){var t=this,r=t.viewOptions||{},o=e.keyCode||e.which||e.charCode,n=e.ctrlKey||e.metaKey,s=e.shiftKey;1!=r.shiftKeyPressing&&s&&(r.lastShiftClickRowData=r.lastClickRowData,l.writeLogFormat("KDVGridKeydown - {0}",!1,e.keyCode),r.shiftKeyPressing=!0,t.addClass(l.getClsNames(i.C_NoSelectText))),n&&"70"==o&&(e.preventDefault(),a.showFindLocateWin.call(t,!0)),a.execCellEditorHandler(t,a.handlerKDVGridKeydown_cellEditor,e)},handlerKDVGridKeyup:function(t){var r=this,o=r.viewOptions||{},n=t.keyCode||t.which||t.charCode,s=t.ctrlKey||t.metaKey,d=(t.shiftKey,e(document.activeElement)),c=d.text(),C=(d.hasClass(l.getClsNames(i.C_ColHeaderCls)),d.hasClass(l.getClsNames(i.C_VGridCellCls)));0!=o.shiftKeyPressing&&(delete o.lastShiftClickRowData,l.writeLogFormat("KDVGridKeyup - {0}",!1,t.keyCode),o.shiftKeyPressing=!1,r.removeClass(l.getClsNames(i.C_NoSelectText))),s&&"67"==n&&C&&a.copySelectedCellsToClipBoard.call(r,c,d),a.execCellEditorHandler(r,a.handlerKDVGridKeyup_cellEditor,t)},handlerFrozenLeftHeaderCheckerRowClick:function(t){var r=this,o=r.options,n=r.isMultiSelection();if(n){var s=(o.rowData||[],r.viewOptions||{}),d=e(t.currentTarget),c=(l.getData(d),d.parent(i.C_ColHeaderContainerCls)),C=l.getData(c),u=a.getHeaderCheckNextOpeType.call(r);a.setSelectedRows.call(r,C.rowid,!0,n?u:i.C_SingleSel),a.updateRowSelectUIState.call(r,{targetEl:c});var f=l.ext({},s.currentFocusCell,{isHeaderSelected:!0});o.onRowSelected&&(t.node={data:f},o.onRowSelected(t))}},handlerLefPadHeaderCheckerRowClick:function(t){var r=this,o=r.options,n=r.isMultiSelection();if(n){var s=(o.rowData||[],r.viewOptions||{}),d=e(t.currentTarget),c=(l.getData(d),d.parent(i.C_ColHeaderContainerCls)),C=l.getData(c),u=a.getHeaderCheckNextOpeType.call(r);a.setSelectedRows.call(r,C.rowid,!0,n?u:i.C_SingleSel),a.updateRowSelectUIState.call(r,{targetEl:c}),o.onRowSelected&&(t.node={data:s.currentFocusCell},o.onRowSelected(t))}},handlerLefPadCheckerRowClick:function(t){var r=this,o=r.options,n=r.isMultiSelection(),s=r.viewOptions||{},d=e(t.currentTarget),c=l.getData(d),C=d.parent(i.C_VGridRowCls),u=l.getData(C),f=s.selectedRows=s.selectedRows||{},p=u.rowid,c=l.ext(s.currentFocusCell,{field:c.field,rowId:parseInt(p),rowIndex:u.rowindex,isSelected:!0}),g=void 0===f[p]?!0:!f[p];a.setSelectedRows.call(r,p,g,n?i.C_MultiSel:i.C_SingleSel),a.updateRowSelectUIState.call(r,{targetEl:C}),o.onRowSelected&&(t.node={data:c},o.onRowSelected(t)),l.writeLogFormat("leftPad.CS.C_Click({0})",!1,c)},handlerGroupExpanderClick:function(t){t.stopPropagation();var r=this,o=(r.options,r.viewOptions||{}),n=o.viewRowGroupDataInfos,s=n.allGroups,d=n.expands,c=e(t.currentTarget),C=l.getData(c.closest(i.C_VGridCellCls)),u=c.closest(i.C_VGridRowCls),f=l.getData(u),p=C.field,g=o.viewRowGroupDataMaps[f.rowindex],h=!g.isExpand;d[g.value]=h,s[g.value].isExpand=h,a.expGroupNodesToMap.call(r,function(e){a.algorithmStrategyInvoke.call(r,function(){l.writeLogFormat("{0}, {1}",!1,"handlerGroupExpanderClick","algorithmStrategyInvoke")},i.OpeKeys.DataUpdate)}),l.writeLogFormat("handlerGroupExpanderClick - {0} = {1}",!1,p,"")},handlerMouseOver:function(e){var t=this,r=t.options,o=(t.viewOptions,r.onMouseOver);o&&l.isFunc(o)&&o.call(t,e)}}),l.ext(a,{getInnerEventCallback:function(){var e=this,t={onHScroll:function(t){var r=(t.target||{}).scrollLeft||0;a.setScrollHorizenAt.call(e,r)},onVScroll:function(t){var r=(t.target||{}).scrollTop||0;a.setScrollVerticalAt.call(e,r)}};return t},attachGlobalEventHandlers:function(){var e=this;e.viewOptions||{};a.detachGlobalEventHandlers.call(e),e.off(i.C_MouseDown).on(i.C_MouseDown,function(t){a.hideAllPopup.call(e)}),e.delegate(i.C_RowSelector,i.C_Click,function(t){a.handlerCenterPadRowClick.call(e,t)}),e.delegate(i.C_CellSelector,i.C_Click,function(t){a.handlerCenterPadCellClick.call(e,t)}),e.delegate(i.C_CellSelector,i.C_DBLClick,function(t){a.handlerCenterPadCellDBLClick.call(e,t)}),e.delegate(i.C_CellSelector,i.C_MouseDown,function(t){a.handlerCenterPadCellMouseDown.call(e,t)}),e.delegate(i.C_CellSelector,i.C_MouseMove,function(t){a.handlerCenterPadCellMouseMove.call(e,t)}),e.delegate(i.C_CellSelector,i.C_MouseUp,function(t){a.handlerCenterPadCellMouseUp.call(e,t)}),e.delegate(i.C_CellComSelector,i.C_Click,function(t){a.handlerCenterPadCellComClick.call(e,t)}),e.delegate(i.C_FrozenLeftRowHeaderChkerSelector,i.C_Click,function(t){a.handlerFrozenLeftHeaderCheckerRowClick.call(e,t)}),e.delegate(i.C_CtxMenuSelector,i.C_ContextMenu,function(t){a.handlerKDVGridContextMenu.call(e,t)}),e.delegate(i.C_GroupCellExpandSelector,i.C_Click,function(t){a.handlerGroupExpanderClick.call(e,t)}),e.delegate(i.C_LeftPadRowHeaderChkerSelector,i.C_Click,function(t){a.handlerLefPadHeaderCheckerRowClick.call(e,t)}),e.delegate(i.C_LeftPadRowChkerSelector,i.C_Click,function(t){a.handlerLefPadCheckerRowClick.call(e,t)}),a.attachGlobalEventHandlers_sort.call(e),a.attachGlobalEventHandlers_filter.call(e),a.attachGlobalEventHandlers_colResizer.call(e),a.attachGlobalEventHandlers_colDragPosition.call(e),a.attachGlobalEventHandlers_cellEditor.call(e)},detachGlobalEventHandlers:function(){var e=this;e.off(i.C_MouseDown),e.undelegate(i.C_RowSelector,i.C_Click),e.undelegate(i.C_CellSelector,i.C_Click),e.undelegate(i.C_CellSelector,i.C_DBLClick),e.undelegate(i.C_CellSelector,i.C_MouseDown),e.undelegate(i.C_CellSelector,i.C_MouseMove),e.undelegate(i.C_CellSelector,i.C_MouseUp),e.undelegate(i.C_CellComSelector,i.C_Click),e.undelegate(i.C_FrozenLeftRowHeaderChkerSelector,i.C_Click),e.undelegate(i.C_CtxMenuSelector,i.C_ContextMenu),e.undelegate(i.C_GroupCellExpandSelector,i.C_Click),e.undelegate(i.C_LeftPadRowChkerSelector,i.C_Click),e.undelegate(i.C_LeftPadRowHeaderChkerSelector,i.C_Click),a.detachGlobalEventHandlers_sort.call(e),a.detachGlobalEventHandlers_filter.call(e),a.detachGlobalEventHandlers_colResizer.call(e),a.detachGlobalEventHandlers_colDragPosition.call(e),a.detachGlobalEventHandlers_cellEditor.call(e)},attachRootElEvents:function(e){var t=this;a.attachInnerElEvents.call(t,e,i.C_KeyDown,function(e){a.handlerKDVGridKeydown.call(t,e)}),a.attachInnerElEvents.call(t,e,i.C_KeyUp,function(e){a.handlerKDVGridKeyup.call(t,e)}),a.attachInnerElEvents.call(t,e,i.C_MouseDown,function(e){a.handlerKDVGridMouseBtnDown.call(t,e)}),a.attachInnerElEvents.call(t,e,i.C_MouseOver,function(e){a.handlerMouseOver.call(t,e)})},detachRootElEvents:function(){var e=this;e.detachVDomEvents()},setScrollHorizenAt:function(t){var r=this,o=r.viewOptions,n=i.C_DelayCalc_Scroll,s=Math.abs((t||0)-(o.vwX||0));o.rectChanging=!0,o.vwX=t;var d=l.strFormat("{0} {1} {2} {3}",i.C_VGridCenterPadCls,i.C_VGridHeaderCls,i.C_VGridNormalCenterCls,i.C_ColHeaderContainerCls);e(d,r).css({left:-1*o.vwX+1});var c=l.strFormat("{0} {1} {2}",i.C_VGridCenterPadCls,i.C_VGridNormalCenterCls,i.C_ColFilterRowContainerCls);e(c,r).css({left:-1*o.vwX+1});var C=l.strFormat("{0} {1} {2} {3}",i.C_VGridCenterPadCls,i.C_VGridViewCls,i.C_VGridNormalCenterCls,i.C_VGridRowsContainerCls);e(C,r).css({left:-1*o.vwX+1});var u=l.strFormat("{0} {1} {2}",i.C_VGridCenterPadCls,i.C_VGridNormalCenterCls,i.C_ColFooterRowContainerCls);e(u,r).css({left:-1*o.vwX+1});var f=function(e){s>i.C_Scroll_DetaGate&&(n=i.C_DelayCalc),l.delayToFlagReferOnce(e,"KDVGrid.C_Scroll",function(e){l.isMouseDraging()?f(e):a.algorithmStrategyInvoke.call(e,function(){o.rectChanging=!1},i.OpeKeys.HScroll)},n,"isHScroll")};f(r)},setScrollVerticalAt:function(t){var r=this,o=r.viewOptions,n=i.C_DelayCalc_Scroll,s=Math.abs((t||0)-(o.vwY||0));o.rectChanging=!0,o.vwY=t,e(l.strFormat("{0} {1} {2}",i.C_VGridLeftPadCls,i.C_VGridViewCls,i.C_VGridViewCliperCls),r).css({top:-1*o.vwY});var d=function(e){s>=i.C_Scroll_DetaGate&&(n=i.C_DelayCalc),l.delayToFlagReferOnce(e,"KDVGrid.C_Scroll",function(e){l.isMouseDraging()?d(e):a.algorithmStrategyInvoke.call(e,function(){o.rectChanging=!1},i.OpeKeys.VScroll)},n,"isVScroll")};d(r)}})}function KDVGrid_Frozen(e,t){var r=KDVGridHelper,l=(window.KDVXReses,t),o=l.CONSTVARS;r.ext(l,{initViewOptions_frozen:function(e){var t=this,o=t.options;r.ext(e,{frozenRightWidth:0,leftFrozenColPosMaps:{length:0},rightFrozenColPosMaps:{length:0},frozenLeftWidth:function(t){var r=e.showRowNum,l=t.isMultiSelection(),o=(l?68:45)-(r?0:40);return o}(t)}),l.setFrozenCore.call(t,o.frozenOptions||{})},hasFrozenCols:function(e){var t=this,r=(t.options,t.viewOptions||{}),l=r.calcViewOpts||{},o=l[e]||{},a=(o.endCell||{}).colIdx,i=void 0!=a&&a>=0;return i},clearFrozenCore:function(e){for(var t=this,l=(t.options,t.viewOptions||{}),o=(l.viewColMaps,t.getFrozenLeftViewColumns()),a=t.getFrozenRightViewColumns(),i=o||[],n=a||[],s=0;s<i.length;s++){var d=i[s];r.isEmpty(d)||delete d.area}for(var s=0;s<n.length;s++){var d=n[s];r.isEmpty(d)||delete d.area}l.leftFrozenColPosMaps={length:0},l.rightFrozenColPosMaps={length:0}},setFrozenCore:function(e){var t=this,l=t.options,a=t.viewOptions||{},i=a.viewColMaps,n=t.getFrozenLeftViewColumns(),s=t.getFrozenRightViewColumns();l.frozenOptions=e;for(var d=e.leftCols||[],c=e.rightCols||[],C=[],u=0;u<c.length;u++)d.indexOf(c[u])<0&&C.push(c[u]);for(var u=0;u<d.length;u++){var f=i[d[u]];r.isEmpty(f)||(f.area=o.C_Area_LeftView,r.addColPosMapItem(f,n))}for(var u=0;u<C.length;u++){var f=i[C[u]];r.isEmpty(f)||(f.area=o.C_Area_RightView,r.aheadInsColPosMapItem(f,s))}},calcFrozenColWidth:function(){var e=this,t=(e.options,e.viewOptions||{}),a=t.colWidth,i=0,n=t.rightFrozenColPosMaps;if(1==n.length){var s=l.getFrozenLeftWidth.call(e,i),d=l.getCenterWidth.call(e,i),c=l.getFrozenRightWidth.call(e,i),C=t.scollbarWidth,u=t.reservedWidth,f=4,p=t.width-(s+d+c+C+u+f);if(p>0&&n.length>0){var g=n[n.length-1].field,h=e.getColWidth(g,o.C_Area_RightView);a[g]=p+h,r.writeLogFormat("setFrozenCore No fill width. {0}",!1,p)}}},getFrozenLeftWidth:function(e){var t=this,r=t.viewOptions,l=t.isSingleSelection(),a=r.leftFrozenColPosMaps,i=l?0:r.frozenLeftWidth||0;if((a.length||0)>0)for(var n=0;n<a.length;n++){var s=a[n],d=t.getColWidth(s.field,o.C_Area_LeftView)+(e||0);i+=d}return i},getCenterWidth:function(e){var t=this,r=(t.viewOptions,o.C_Area_CenterView),l=t.getViewColumns(r),a=0;if((l.length||0)>0)for(var i=0;i<l.length;i++){var n=l[i],s=t.getColWidth(n.field,r)+(e||0);a+=s}return a},getFrozenRightWidth:function(e){var t=this,r=t.viewOptions,l=0,a=r.rightFrozenColPosMaps,i=(r.frozenRightWidth||0)+l;if((a.length||0)>0)for(var n=0;n<a.length;n++){var s=a[n],d=t.getColWidth(s.field,o.C_Area_RightView)+(e||0);i+=d}return i},inArea:function(e,t){var r=(e||o.C_Area_CenterView)==(t||o.C_Area_CenterView);return r},getCurIntActArea:function(e){var t=o.C_Area_CenterView;return t=e.closest(o.C_VGrid_Area_Cls).data().area||t}}),r.ext(l,{buildFrozenLayoutEls:function(e,t){var r=this;e.css({flexDirection:"row",display:"flex"});var o={forzenLeft:l.buildFrozenLeftPadEl.call(r,e),normalCenter:l.buildNormalCenterPadEl.call(r,e),frozenRight:l.buildFrozenRightPadEl.call(r,e)};return void 0!==t&&t>5&&(o.forzenLeft.css({height:t}),o.normalCenter.css({height:t}),o.frozenRight.css({height:t})),o},buildFrozenLeftPadEl:function(t){var a=this,i=(a.viewOptions,l.getFrozenLeftWidth.call(a)),n=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridFrozenLeftCls,o.C_VGrid_Area_Cls)).attr({"data-area":o.C_Area_LeftView}).css({minWidth:i||0,width:i||0}).appendTo(t);return n},buildNormalCenterPadEl:function(t){var l=this,a=(l.viewOptions,e(o.C_DIV).addClass(r.getClsNames(o.C_VGridNormalCenterCls,o.C_VGrid_Area_Cls)).attr({"data-area":o.C_Area_CenterView}).appendTo(t));return a},buildFrozenRightPadEl:function(t){var a=this,i=(a.viewOptions,l.getFrozenRightWidth.call(a)),n=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridFrozenRightCls,o.C_VGrid_Area_Cls)).attr({"data-area":o.C_Area_RightView}).css({minWidth:i||0,width:i||0}).appendTo(t);return n}}),r.ext(l,{buildFrozenLeftLayout:function(e){var t=this;l.buildFrozenLeftColHeaderNode.call(t,e),l.buildFrozenLeftFilterRowNode.call(t,e),l.buildFrozenLeftViewPortNode.call(t,e),l.buildFrozenLeftFooterNode.call(t,e),l.buildFrozenLeftHSScrollbarNode.call(t,e)},buildFrozenLeftColHeaderNode:function(e){var t=this,a=o.C_Area_LeftView,i=l.hasFrozenCols.call(t,a),n=i?"":o.C_VGridFrozenEmptyCls,s=t.frozenLayoutHeader.forzenLeft.addClass(r.getClsNames(o.C_VGridHeaderCls,o.C_VGridLeftPadViewCls,n));l.buildViewPortColHeaderCells.call(t,s,e,a)},buildFrozenLeftFilterRowNode:function(t){var a=this,i=o.C_Area_LeftView,n=(a.options,a.viewOptions),s=n.colFilterRowHeight;if(s>5){var d=l.hasFrozenCols.call(a,i),c=d?"":o.C_VGridFrozenEmptyCls,C=a.frozenLayoutFilterRow.forzenLeft.css({minHeight:s}).addClass(r.getClsNames(o.C_VGridFilterRowCls,c)),u=e(o.C_DIV).addClass(r.getClsNames(o.C_ColFilterRowContainerCls)).appendTo(C);l.buildViewPortFilterRowCells.call(a,u,t,i)}},buildFrozenLeftViewPortNode:function(t){var a=this,i=o.C_Area_LeftView,n=(a.options,a.isMultiSelection(),a.viewOptions),s=(r.strFormat('{0} [data-role="{1}"]',o.C_VGridLeftPadCls,o.C_VGrid_Row_Role)+'[data-rowid="{0}"]',n.colHeaderHeight,n.defRowHeight,n.rowHeight,a.getViewColumns(i),n.selectedRows||{},l.getViewRowDataMaps.call(a),l.hasFrozenCols.call(a,i)),d=s?"":o.C_VGridFrozenEmptyCls,c=a.frozenLayoutViewPort.forzenLeft.addClass(r.getClsNames(o.C_VGridLeftPadViewCls,d)),C=a.viewportCliper=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridViewCliperCls)).appendTo(c),u=a.vpNodeCliperVp=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridViewCliperViewCls)).appendTo(C),f=a.vpNodeRowsCt=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridRowsContainerCls)).appendTo(u);l.buildViewPortNormalCells.call(a,f,t,i)},buildFrozenLeftFooterNode:function(t){var a=this,i=o.C_Area_LeftView,n=(a.options,a.viewOptions),s=n.colFooterHeight,d=l.hasFrozenCols.call(a,i),c=d?"":o.C_VGridFrozenEmptyCls,C=a.frozenLayoutFooter.forzenLeft.css({minHeight:s}).addClass(r.getClsNames(c)),u=e(o.C_DIV).addClass(r.getClsNames(o.C_ColFooterRowContainerCls)).appendTo(C);l.buildViewPortSummaryRowCells.call(a,u,t,i)},buildFrozenLeftHSScrollbarNode:function(e){var t=this,a=t.viewOptions,i=o.C_Area_LeftView,n=(a.scollbarWidth,l.hasFrozenCols.call(t,i)),s=n?"":o.C_VGridFrozenEmptyCls;t.frozenLayoutHSScrollbar.forzenLeft.addClass(r.getClsNames(s)).css({})}}),r.ext(l,{buildFrozenRightLayout:function(e){var t=this;l.buildFrozenRightColHeaderNode.call(t,e),
l.buildFrozenRightFilterRowNode.call(t,e),l.buildFrozenRightViewPortNode.call(t,e),l.buildFrozenRightFooterNode.call(t,e),l.buildFrozenRightHSScrollbarNode.call(t,e)},buildFrozenRightColHeaderNode:function(e){var t=this,a=o.C_Area_RightView,i=l.hasFrozenCols.call(t,a),n=i?"":o.C_VGridFrozenEmptyCls,s=t.frozenLayoutHeader.frozenRight.addClass(r.getClsNames(o.C_VGridHeaderCls,o.C_VGridRightPadViewCls,n));l.buildViewPortColHeaderCells.call(t,s,e,a)},buildFrozenRightFilterRowNode:function(t){var a=this,i=o.C_Area_RightView,n=(a.options,a.viewOptions),s=n.colFilterRowHeight;if(s>5){var d=l.hasFrozenCols.call(a,i),c=d?"":o.C_VGridFrozenEmptyCls,C=a.frozenLayoutFilterRow.frozenRight.css({minHeight:s}).addClass(r.getClsNames(o.C_VGridFilterRowCls,c)),u=e(o.C_DIV).addClass(r.getClsNames(o.C_ColFilterRowContainerCls)).appendTo(C);l.buildViewPortFilterRowCells.call(a,u,t,i)}},buildFrozenRightViewPortNode:function(t){var a=this,i=o.C_Area_RightView,n=(a.options,a.isMultiSelection(),a.viewOptions),s=(r.strFormat('{0} [data-role="{1}"]',o.C_VGridRightPadCls,o.C_VGrid_Row_Role)+'[data-rowid="{0}"]',n.colHeaderHeight,n.defRowHeight,n.rowHeight,a.getViewColumns(i),n.selectedRows||{},l.getViewRowDataMaps.call(a),l.hasFrozenCols.call(a,i)),d=s?"":o.C_VGridFrozenEmptyCls,c=a.frozenLayoutViewPort.frozenRight.addClass(r.getClsNames(o.C_VGridRightPadViewCls,d)),C=a.viewportCliper=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridViewCliperCls)).appendTo(c),u=a.vpNodeCliperVp=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridViewCliperViewCls)).appendTo(C),f=a.vpNodeRowsCt=e(o.C_DIV).addClass(r.getClsNames(o.C_VGridRowsContainerCls)).appendTo(u);l.buildViewPortNormalCells.call(a,f,t,i)},buildFrozenRightFooterNode:function(t){var a=this,i=o.C_Area_RightView,n=(a.options,a.viewOptions),s=n.colFooterHeight,d=l.hasFrozenCols.call(a,i),c=d?"":o.C_VGridFrozenEmptyCls,C=a.frozenLayoutFooter.frozenRight.css({minHeight:s}).addClass(r.getClsNames(c)),u=e(o.C_DIV).addClass(r.getClsNames(o.C_ColFooterRowContainerCls)).appendTo(C);l.buildViewPortSummaryRowCells.call(a,u,t,i)},buildFrozenRightHSScrollbarNode:function(e){}})}function KDVGrid_DragDrop(e,t){var r="KDVGrid",l=KDVGridHelper,o=window.KDVXReses,a=t,i=a.CONSTVARS;l.ext(a,{initViewOptions_DragDrop:function(e){var t=this,r=(t.options,e.viewColDefs);l.ext(e,{mousePosition:{x:0,y:0},viewColPosMaps:function(e){for(var t={length:e.length},r=0;r<e.length;r++){var l=e[r];t[r]=l}return t}(r)})},getPackToColPos:function(e,t,r,o){var a=this,i=t,n=(a.viewOptions,a.getViewColumns.call(a,o)),s=0,d=0,c=0;if(!r)for(var C=0;C<n.length;C++){var u=n[C];if(l.equalsIC(u.field,e)){d=C;break}}for(var C=0;C<n.length;C++){var u=n[C],f=a.getColWidth(u.field,o);if(i>s&&s+f>i){f/2>i-s?(i=s,c=C):(i=s+f,c=C+1),s+=f;break}s+=f}0>i?(c=0,i=0):i>s&&(c=n.length,i=s);var p={x:i,curIdx:d,toIdx:c};return r&&delete p.curIdx,p},calcColumnAutoWidth:function(e){var t=this,n=t.options,s=e.field,d=e.header,c=t.viewOptions,C=c.colWidth,u=c.sumResult||{},f=10,p=c.rowData||[];if(s){var g=a.getColDef.call(t,s);if((g||{}).field){var h=t.getColWidth(s),v=g.__maxLenDisplayValue||"",w=1;if(g){if(!v){v=l.strFormat("{0}",d||g.headerName).trim(),w=l.getStrLenB(v);var _=""+(u[g.field]||""),m=l.getStrLenB(_);m>w&&(w=m,v=_);for(var V=0;V<p.length;V++){var D=p[V],y=l.getRowItemByMap(n,D),F=l.createCallerParams(g,y),S=a.fetchCellDisplayValue.call(t,F),R=l.getStrLenB(S);R>w&&(v=S,w=R)}g.__maxLenDisplayValue=v}if(w>0){var I=l.getStrWidth(v,o[r].cellTextDispayFont)+f;I<i.C_MIN_COLWIDTH?I=i.C_MIN_COLWIDTH:I>i.C_MAX_COLWIDTH&&(I=i.C_MAX_COLWIDTH),Math.abs(I-h)>3&&(C[s]=I,a.algorithmStrategyInvoke.call(t,function(){l.writeLogFormat("{0}, {1}",!1,"calcColumnAutoWidth","algorithmStrategyInvoke")},i.OpeKeys.ColWidth))}}}}},calcBalEqRatioAutoWidth:function(){var e=this,t=(e.viewOptions,!0);a.calcBalEqRatioColWidth.call(e,t),a.algorithmStrategyInvoke.call(e,function(){l.writeLogFormat("{0}, {1}",!1,"calcBalEqRatioAutoWidth","algorithmStrategyInvoke")},i.OpeKeys.ColWidth)}}),l.ext(a,{handlerColResizerStartDrag:function(t){var r=this,o=r.viewOptions,a=(o.mousePosition,t.originalEvent),n=e(t.currentTarget),s=n.closest(i.C_ColHeaderContainerCls),d=n.closest(i.C_ColHeaderCls),c=n.offset(),C=l.ext({},l.getData(d),{startX:a.clientX||emps.x,top:c.top,left:c.left,detaX:0});r.dataTransfer.setData(i.C_DragColResizerKey,l.toStr(C)),r.colResizerPhantom&&r.colResizerPhantom.remove(),r.colResizerPhantom=e(i.C_DIV).addClass(l.getClsNames(i.C_ColHeaderResizerPhantomCls)).appendTo(s),e(i.C_SPAN).appendTo(r.colResizerPhantom),l.isIE()&&t.currentTarget.dragDrop&&t.currentTarget.dragDrop()},handlerColResizerEndDrag:function(e){var t=this;t.dataTransfer.clearData(i.C_DragColResizerKey),t.colResizerPhantom&&t.colResizerPhantom.remove()},handlerColResizerDrag:function(t){var r=this,o=r.viewOptions,a=o.mousePosition,n=r.dataTransfer.getData(i.C_DragColResizerKey),s=t.originalEvent;if(!l.isEmpty(n)){var d=e(t.currentTarget),c=d.closest(i.C_ColHeaderContainerCls),C=c.offset();r.colResizerPhantom&&r.colResizerPhantom.css({left:(s.clientX||a.x)-C.left+e(document.body).scrollLeft()})}},handlerColResizerDrop:function(t){var r=this,o=r.viewOptions,n=o.mousePosition,s=t.originalEvent,d=r.dataTransfer.getData(i.C_DragColResizerKey),c=e(t.currentTarget),C=a.getCurIntActArea.call(r,c);if(!l.isEmpty(d)){var u=l.toObject(d||"{}");if(!l.isEmpty(u)){l.ext(u,{endX:s.clientX||n.x}),u.detaX=u.endX-u.startX;var r=this,o=r.viewOptions,f=(o.viewColMaps,o.colWidth),p=r.getColWidth(u.field,C)+u.detaX;p<i.C_MIN_COLWIDTH&&(p=i.C_MIN_COLWIDTH),f[u.field]=p,a.algorithmStrategyInvoke.call(r,function(){l.writeLogFormat("{0}, {1}",!1,"handlerColResizerDrop","algorithmStrategyInvoke")},i.OpeKeys.ColWidth)}}},handlerColResizerDBLClick:function(t){var r=this,o=(r.viewOptions,e(t.currentTarget)),n=(o.closest(i.C_ColHeaderContainerCls),o.closest(i.C_ColHeaderCls)),s=l.ext({},l.getData(n),{header:n.text()});l.equalsIC(i.C_SelField,s.field)?a.calcBalEqRatioAutoWidth.call(r):s.field&&a.calcColumnAutoWidth.call(r,s),l.writeLogFormat("{0}, {1}",!1,i.C_DBLClick,s)},attachGlobalEventHandlers_colResizer:function(){var e=this,t=e.viewOptions;e.delegate(i.C_HeaderResizerSelector,i.C_DragStart,function(t){t.stopPropagation(),a.handlerColResizerStartDrag.call(e,t)}),e.delegate(i.C_HeaderResizerSelector,i.C_DropEnd,function(t){a.handlerColResizerEndDrag.call(e,t)}),e.delegate(i.C_HeaderResizerSelector,i.C_Drag,function(t){a.handlerColResizerDrag.call(e,t)}),e.delegate(i.C_HeaderResizerSelector,i.C_Click,function(e){e.stopPropagation()}),e.delegate(i.C_HeaderResizerSelector,i.C_DBLClick,function(t){t.stopPropagation(),a.handlerColResizerDBLClick.call(e,t)}),e.delegate(i.C_HeaderResizerTargetSelector,i.C_DragEnter,function(e){e.preventDefault()}),e.delegate(i.C_HeaderResizerTargetSelector,i.C_DragOver,function(e){e.preventDefault();var r=t.mousePosition,o=e.originalEvent;l.ext(r,{x:o.clientX,y:o.clientY})}),e.delegate(i.C_HeaderResizerTargetSelector,i.C_Drop,function(t){t.preventDefault(),t.stopPropagation(),a.handlerColResizerDrop.call(e,t)})},detachGlobalEventHandlers_colResizer:function(){var e=this;e.undelegate(i.C_HeaderResizerSelector,i.C_DragStart),e.undelegate(i.C_HeaderResizerSelector,i.C_DropEnd),e.undelegate(i.C_HeaderResizerSelector,i.C_Drag),e.undelegate(i.C_HeaderResizerSelector,i.C_Click),e.undelegate(i.C_HeaderResizerSelector,i.C_DBLClick),e.undelegate(i.C_HeaderResizerTargetSelector,i.C_DragEnter),e.undelegate(i.C_HeaderResizerTargetSelector,i.C_DragOver),e.undelegate(i.C_HeaderResizerTargetSelector,i.C_Drop)}}),l.ext(a,{handlerColDragPosStartDrag:function(t){var r=this,o=r.viewOptions,a=(o.mousePosition,t.originalEvent),n=e(t.currentTarget),s=n.closest(i.C_ColHeaderContainerCls),d=n.offset(),c=l.ext({},l.getData(n),{startX:a.clientX||emps.x,top:d.top,left:d.left,detaX:0});r.dataTransfer.setData(i.C_DragColPosKey,l.toStr(c)),r.colChgPosFlag&&r.colChgPosFlag.remove(),r.colChgPosFlag=e(i.C_DIV).addClass(l.getClsNames(i.C_ColHeaderChgPosFlagCls)).appendTo(s),e(i.C_SPAN).appendTo(r.colChgPosFlag),l.isIE()&&t.currentTarget.dragDrop&&t.currentTarget.dragDrop()},handlerColDragPosEndDrag:function(e){var t=this;t.dataTransfer.clearData(i.C_DragColPosKey),t.colChgPosFlag&&t.colChgPosFlag.remove()},handlerColDragPosDrag:function(t){var r=this,o=r.viewOptions,n=o.colHeaderHeight,s=o.mousePosition,d=r.dataTransfer.getData(i.C_DragColPosKey),c=t.originalEvent,C=e(t.currentTarget),u=a.getCurIntActArea.call(r,C),f=a.getViewOffsetLeft.call(r,u);if(!l.isEmpty(d)){var p=l.toObject(d||"{}");if(!l.isEmpty(p)){var g=e(t.currentTarget),h=g.closest(i.C_ColHeaderContainerCls),v=h.offset(),w=(c.clientX||s.x)-v.left+e(document.body).scrollLeft()-f;w=(a.getPackToColPos.call(r,p.field,w,!0,u)||{}).x,r.colChgPosFlag&&r.colChgPosFlag.css({left:w-10+f,top:(n||35)-8})}}},handlerColDragPosDrop:function(t){var r=this,o=r.viewOptions,n=o.mousePosition,s=r.dataTransfer.getData(i.C_DragColPosKey),d=t.originalEvent,c=e(t.currentTarget),C=a.getCurIntActArea.call(r,c),u=a.getViewOffsetLeft.call(r,C);if(!l.isEmpty(s)){var f=l.toObject(s||"{}");if(!l.isEmpty(f)){var p=e(t.currentTarget),g=p.closest(i.C_ColHeaderContainerCls),h=g.offset(),v=(d.clientX||n.x)-h.left+e(document.body).scrollLeft()-u,w=a.getPackToColPos.call(r,f.field,v,!1,C),_=w.curIdx,m=w.toIdx;if(l.writeLogFormat("handlerColDragPosDrop {0}",!1,w),_!=m&&_!=m-1){var V=o.viewColPosMaps;C==i.C_Area_LeftView?V=o.leftFrozenColPosMaps:C==i.C_Area_RightView&&(V=o.rightFrozenColPosMaps),l.moveItemTo(V,_,m,!1),a.algorithmStrategyInvoke.call(r,function(){l.writeLogFormat("{0}, {1}",!1,"handlerColDragPosDrop","algorithmStrategyInvoke")},i.OpeKeys.DragDrop)}}}},attachGlobalEventHandlers_colDragPosition:function(){var e=this;e.delegate(i.C_HeaderDragPosSelector,i.C_DragStart,function(t){t.stopPropagation(),a.handlerColDragPosStartDrag.call(e,t)}),e.delegate(i.C_HeaderDragPosSelector,i.C_DropEnd,function(t){a.handlerColDragPosEndDrag.call(e,t)}),e.delegate(i.C_HeaderDragPosSelector,i.C_Drag,function(t){a.handlerColDragPosDrag.call(e,t)}),e.delegate(i.C_HeaderDragPosTargetSelector,i.C_DragEnter,function(e){e.preventDefault()}),e.delegate(i.C_HeaderDragPosTargetSelector,i.C_DragOver,function(e){e.preventDefault()}),e.delegate(i.C_HeaderDragPosTargetSelector,i.C_Drop,function(t){t.preventDefault(),t.stopPropagation(),a.handlerColDragPosDrop.call(e,t)})},detachGlobalEventHandlers_colDragPosition:function(){var e=this;e.undelegate(i.C_HeaderDragPosSelector,i.C_DragStart),e.undelegate(i.C_HeaderDragPosSelector,i.C_DropEnd),e.undelegate(i.C_HeaderDragPosSelector,i.C_Drag),e.undelegate(i.C_HeaderDragPosTargetSelector,i.C_DragEnter),e.undelegate(i.C_HeaderDragPosTargetSelector,i.C_DragOver),e.undelegate(i.C_HeaderDragPosTargetSelector,i.C_Drop)}})}function KDVGrid_Api(e,t){var r=KDVGridHelper,l=(window.KDVXReses,t),o=l.CONSTVARS,a=l.KDVGridPrototype;r.ext(l,{initViewOptions_Api:function(e){var t=this;t.options;r.ext(e,{})},setSortTypeCore:function(e,t,l){var o=this,a=o.viewOptions||{},i=a.sorts;l=void 0===l?!0:l,i=a.sorts=l?{}:a.sorts||{};var n=i.fieldSeq=i.fieldSeq||[],s=i[e]=t,d=n.indexOf(e);return d>=0&&n.splice(d,1),r.isDontSort(t)?delete i[e]:n.push(e),s},setSortsCore:function(e,t){var o=this;if(!r.isEmpty(e))if(t&&l.clearSortsCore.call(o,[]),r.isArray(e))for(var a=0;a<e.length;a++){var i=e[a];r.isEmpty(i)||l.setSortTypeCore.call(o,i.field,i.type,!1)}else r.isEmpty(e.field)||l.setSortTypeCore.call(o,i.field,i.type,!1)},clearSortsCore:function(e){var t=this,r=t.viewOptions||{};r.sorts;r.sorts={fieldSeq:[]}},setFilterValueCore:function(e){for(var t=this,o=t.viewOptions||{},a=o.filterRowValues,i=o.filters,n=(o.colFilterProxies||{},o.filterFieldsSeq||""),s=r.isEmpty(o.colFilterValueFetchType),d=!1,c=function(e){var t="clear"==e.opetype||"reset"==e.opetype;return t||(t=(void 0===e.value||""==e.value)&&"contains"==e.comparer),t},C=0;C<e.length;C++){var u=e[C],f=u.field||"",p=new RegExp(",{1,}"+f+",{1,}","g"),g=i[f]=i[f]||{};u&&(r.equalsIC(u.type,"filterrow")&&(a[f]=u.value),c(u)?delete g[u.type]:g[u.type]=u,d=!0),r.isEmpty(g)?(n=n.replace(p,","),d=!0):p.test(n)||(n=r.strFormat("{0},{1},",n,f))}o.filterFieldsSeq=n.replace(/\,{2,}/g,","),d&&!s&&l.releaseColFilters.call(t)},clearFilterCore:function(e){var t=this,r=t.viewOptions||{};delete r.filterFieldsSeq,r.filters={},r.filterRowValues={},l.releaseColFilters.call(t)}}),r.ext(a,{getSelFieldName:function(){return o.C_SelField},getOptions:function(){var e=this,t=e.options;return t},beginBatchUpdate:function(e){var t=this,r=t.__batchUpdateFlags=t.__batchUpdateFlags||{},l=e||"default",o=r[l]=r[l]||0;r[l]=o+1},endBatchUpdate:function(e,t){r.isFunc(e)&&(t=e,e="");var l=this,o=l.__batchUpdateFlags=l.__batchUpdateFlags||{},a=e||"default",i=o[a]=o[a]||0;i=o[a]=i-1,0>=i&&t&&t(l)},getColumnDefs:function(){var e=this,t=e.viewOptions,r=t.viewColDefs;return r},getFrozenLeftViewColumns:function(){var e=this,t=e.viewOptions,r=t.leftFrozenColPosMaps=t.leftFrozenColPosMaps||{length:0};return r},getFrozenRightViewColumns:function(){var e=this,t=e.viewOptions,r=t.rightFrozenColPosMaps=t.rightFrozenColPosMaps||{length:0};return r},getViewColumns:function(e){var t=this,l=t.options,a=(l.columnDefs,t.viewOptions),i=a.colWidth,n={length:0},s=a.viewColPosMaps=a.viewColPosMaps||n;r.equalsIC(e,o.C_Area_LeftView)?s=a.leftFrozenColPosMaps||n:r.equalsIC(e,o.C_Area_RightView)&&(s=a.rightFrozenColPosMaps||n);for(var d={},c=0,C=0;C<s.length;C++){var u=void 0==s[C].visible?!0:s[C].visible;if(u){var f=d[c]=r.shallowClone(s[C]);void 0!==i[f.field]&&(f.width=i[f.field]),c++}}return d.length=c,d},getColWidth:function(e,t){for(var r=this,a=0,i=r.viewOptions,n=i.viewColMaps,s=i.colWidth||{},d=i.defColWidth||0,c=(e||"").split(","),C=0;C<c.length;C++){var u=c[C],f=n[u],p=l.inArea((f||{}).area,t);a+=f&&p?s[u]||f.width||d:0}t==o.C_Area_CenterView;return a},isSingleSelection:function(){var e=this,t=!e.isMultiSelection.call(e);return t},isMultiSelection:function(){var e=this,t=e.viewOptions,l=!r.equalsIC(o.C_SingleSel,t.rowSelection);return l},getFocusedCell:function(){var e=this,t=e.viewOptions,l=r.clone(t.currentFocusCell);return l},getDisplayedRowCount:function(){return 0},getSelectedNodes:function(){var e=this,t=e.viewOptions,r=t.selectedRows||{},l=[];for(var o in r){var a=parseInt(o);NaN!=a&&l.push(a)}return l},getCurrentRowIds:function(){for(var e=this,t=(e.viewOptions,l.getViewRowDataMaps.call(e)),r=[],o=0;o<t.length;o++){var a=t[o];a&&void 0!==a.rowId&&r.push(a.rowId)}return r},getSortType:function(e){var t=this,r=t.viewOptions||{},l=r.sorts,o=void 0===e?l:l[e];return o},getFilterValue:function(){var e=this,t=e.viewOptions||{},r=t.filters;return r},getFilterRowValues:function(){var e=this,t=e.viewOptions||{},r=t.filterRowValues;return r}}),r.ext(a,{setSortType:function(e,t,a){var i=this,n=l.setSortTypeCore.call(i,e,t,a),s=function(){r.writeLogFormat("{0}, {1}",!1,"API.setSortType","refreshView")};return l.algorithmStrategyInvoke.call(i,s,o.OpeKeys.SortData),n},setSorts:function(e,t){var a=this,i=l.setSortsCore.call(a,e,t),n=function(){r.writeLogFormat("{0}, {1}",!1,"API.setSorts","refreshView")};return l.algorithmStrategyInvoke.call(a,n,o.OpeKeys.SortData),i},clearSorts:function(e){var t=this,a=l.clearSortsCore.call(t,e),i=function(){r.writeLogFormat("{0}, {1}",!1,"API.clearSort","refreshView")};return l.algorithmStrategyInvoke.call(t,i,o.OpeKeys.SortData),a},setFilterValue:function(e){var t=this,a=l.setFilterValueCore.call(t,e),i=function(){r.writeLogFormat("{0}, {1}",!1,"API.setFilterValue","refreshView")};return l.algorithmStrategyInvoke.call(t,i,o.OpeKeys.FilterData),a},clearFilter:function(e){var t=this,a=l.clearFilterCore.call(t,e),i=function(){r.writeLogFormat("{0}, {1}",!1,"API.clearFilter","refreshView")};return l.algorithmStrategyInvoke.call(t,i,o.OpeKeys.FilterData),a},setSummaryData:function(e){var t=this,a=t.options||{},i=t.viewOptions||{};a.sumData=i.sumResult=e,l.algorithmStrategyInvoke.call(t,function(){r.writeLogFormat("{0}, {1}",!1,"API.setSummaryData","algorithmStrategyInvoke")},o.OpeKeys.TotalSum)},setFrozen:function(e){var t=this;l.setFrozenCore.call(t,e),l.algorithmStrategyInvoke.call(t,function(){r.writeLogFormat("{0}, {1}",!1,"API.setFrozen","algorithmStrategyInvoke")},o.OpeKeys.Frozen)},clearFrozen:function(e){var t=this;l.clearFrozenCore.call(t,e),l.algorithmStrategyInvoke.call(t,function(){r.writeLogFormat("{0}, {1}",!1,"API.clearFrozen","algorithmStrategyInvoke")},o.OpeKeys.Frozen)},setRowData:function(e){var t=this,r=t.options;r.rowData=e||[],t.setOptions.call(t,r)},appendRows:function(e){var t=this,r=t.options;r.rowData=r.rowData.concat(e),t.setOptions.call(t,r)},clearRows:function(){var e=this,t=e.options;t.rowData=[],e.setOptions.call(e,t)},setCurrentRowIds:function(e,t){var a=this,i=a.viewOptions,n=i.selectedRows=i.selectedRows||{};if(r.isArray(e)){for(var s=e||[],d=0;d<s.length;d++)t?n[s[d]]=!0:delete n[s[d]];l.algorithmStrategyInvoke.call(a,function(){r.writeLogFormat("{0}, {1}",!1,"API.setCurrentRowIds","algorithmStrategyInvoke")},o.OpeKeys.ServerSelection)}},clearSelection:function(){var e=this,t=e.viewOptions;t.selectedRows={},l.algorithmStrategyInvoke.call(e,function(){r.writeLogFormat("{0}, {1}",!1,"API.clearSelection","algorithmStrategyInvoke")},o.OpeKeys.Selection)},hideAllPopup:function(){var e=this;l.hideAllPopup.call(e)},doLayout:function(e){var t=this,a=5,i=t.viewOptions,n=Math.abs(i.width-(e.width||0)),s=Math.abs(i.height-(e.height||0));(n>a||s>a)&&(r.ext(i,e),l.calcBalEqRatioColWidth.call(t),l.algorithmStrategyInvoke.call(t,function(){r.writeLogFormat("{0}, {1}",!1,"API.doLayout","algorithmStrategyInvoke")},o.OpeKeys.DoLayout))},destroy:function(){var e=this;try{l.releaseCtxMenu.call(e),l.detachGlobalEventHandlers.call(e),l.releaseFilters.call(e),l.releaseColAggrProxy.call(e),l.releaseFindLocate.call(e),l.releaseElementCachePool.call(e),e.releaseEl("KDVGrid destroy")}catch(t){r.writeLogFormat("KDVGrid destroy {0}",!1,t.message)}}}),r.ext(a,{getRowGroupColumns:function(){var e=this,t=e.viewOptions||{},l=t.groupbyFieldMaps,o=[];return r.eachProp(l,"length",function(e,t){var r=t[e];o.push(r.field)}),o},setRowGroupColumns:function(e){var t=this;t.invokeBatchGroupingApi(function(){var r=t.getRowGroupColumns();t.removeRowGroupColumns(r),t.addRowGroupColumns(e)})},addRowGroupColumn:function(e){var t=this;t.invokeBatchGroupingApi(function(){t.addRowGroupColumns([e])})},addRowGroupColumns:function(e){var t=this,l=t.viewOptions||{},o=l.viewColMaps,a=l.groupbyFieldMaps,i=r.isStr(e)?e.split(","):e||[];t.invokeBatchGroupingApi(function(){r.eachProp(i,"",function(e,t){var l=o[e];l&&(l.rowGroup=!0,r.addColPosMapItem(l,a))});var e=0;r.eachProp(a,"length",function(t,r){var l=r[t];l.rowGroupSeq=e,e++})})},removeRowGroupColumn:function(e){var t=this;t.invokeBatchGroupingApi(function(){t.removeRowGroupColumns([e])})},removeRowGroupColumns:function(e){var t=this,l=t.viewOptions||{},o=l.viewColMaps,a=l.groupbyFieldMaps,i=r.isStr(e)?e.split(","):e||[];t.invokeBatchGroupingApi(function(){r.eachProp(i,"",function(e,t){var l=o[e];l&&(delete l.rowGroup,delete l.rowGroupSeq,r.removeColPosMapItem(l,a))});var e=0;r.eachProp(a,"length",function(t,r){var l=r[t];l.rowGroupSeq=e,e++})})},moveRowGroupColumn:function(e,t){var l=this,o=l.viewOptions||{},a=(o.viewColMaps,o.groupbyFieldMaps),i=a[e];a.length;0>t||e==t||void 0!==i&&l.invokeBatchGroupingApi(function(){if(t>e)for(var l=e+1;t>=l;l++)a[l-1]=a[l];else for(var l=e;l>t;l--)a[l]=a[l-1];a[t]=i;var o=0;r.eachProp(a,"length",function(e,t){var r=t[e];r.rowGroupSeq=o,o++})})},invokeBatchGroupingApi:function(e){var t=this,a="groupData";if(r.isFunc(e)){var i=function(e){l.algorithmStrategyInvoke.call(e,function(e){r.writeLogFormat("{0}, {1}",!1,"api.setRowGroupColumns","groupData>refreshView")},o.OpeKeys.GroupBy)};t.invokeBatchActions.call(t,e,i,a,"")}}}),r.ext(a,{moveColumns:function(e,t){},setColumnWidths:function(e,t,r){},setColumnsVisible:function(e,t){}})}function KDVGrid_Grouping(e,t){var r=KDVGridHelper,l=(window.KDVXReses,t),o=l.CONSTVARS;r.ext(l,{hasGroupBy:function(){var e=this,t=e.viewOptions||{},r=t.groupbyFieldMaps,l=r&&r.length>0;return l},initViewOptions_Groups:function(e){var t=this,o=t.options,a=e.viewColDefs;r.ext(e,{groupbyFieldMaps:{length:0},groupbyAggrFileldMaps:{length:0},viewRowGroupDataMaps:[],sumData:o.sumData||{},sumColumns:o.sumColumns||{},sumResult:r.clone(o.sumData||{}),groupDisplayType:o.groupDisplayType||"multiple",groupDefaultExpand:o.groupDefaultExpand,viewRowGroupDataInfos:l.getGroupDataInfo()}),r.ext(e.components,{totalSummay:r.getSumGroupHandlers()});for(var i=e.groupbyFieldMaps={length:0},n=e.groupbyAggrFileldMaps={length:0},s=[],d=0;d<a.length;d++){var c=a[d];c.rowGroup===!0&&(r.isNumber(c.rowGroupSeq)||(c.rowGroupSeq=d),s.push(c)),void 0!==c.aggrFunc&&(n[n.length]=c,n.length++)}s.sort(function(e,t){var l=e.rowGroupSeq||0,o=t.rowGroupSeq||0,a=r.sortComparer(l,o,"asc");return a});for(var d=0;d<s.length;d++){var c=s[d];c.rowGroupSeq=d,i[d]=c}return i.length=s.length,i},calcViewPortGroupColXs:function(e,t,r){var o=this,a=l.calcViewPortColXs.call(o,e,t,r);return a},calcViewPortGroupRowYs:function(e,t){for(var r=this,l=(r.options,r.viewOptions),o=l.rowBorderHeight,a=l.cacheRows,i=l.defRowHeight,n=l.rowHeight||{},s=l.vwY,d={},c=0,C=-1*s,u=0,f=0,p=-1,g=-1*a*i,h=l.height-g,v=0;v<e.length;v++){var w=e[v].rowId,_=(n[w]||i)+o,m=C||0;if(c+=_,C+=_,(C>=g&&g>=m||0==v)&&(u=m,f=v,d.calcing=!0),d.calcing&&(d[w]=c-_),C>=h||v==e.length-1){p=v,delete d.calcing;break}m=C}return{fcoY:u,starRowIdx:f,endRowIdx:p,rowYs:d}},calcViewPortGroup:function(){var e=e||o.C_Area_CenterView,t=this,a=t.viewOptions||{},i=t.getViewColumns(e),n=a.viewRowGroupDataMaps,s=a.colHeaderHeight+5,d=a.vwX,c=a.vwY;a.viewColMaps,a.groupbyFieldMaps;r.ext(a,{width:t.width.call(t),height:t.height.call(t)-s});var C=l.calcViewPortGroupColXs.call(t,i,e),u=l.calcViewPortGroupRowYs.call(t,n,e),f={vwX:d,vwY:c,firstCellOffset:{x:C.fcoX,y:u.fcoY},startCell:{colIdx:C.starColIdx,rowIdx:u.starRowIdx},endCell:{colIdx:C.endColIdx,rowIdx:u.endRowIdx},colXs:C.colXs,rowYs:u.rowYs},p=a.calcViewOpts||{};p[e]=f;var g=a.frozenLeftWidth||0,h=a.leftFrozenColPosMaps,v=l.calcViewPortColXs.call(t,h,o.C_Area_LeftView,g),w={vwX:d,vwY:c,firstCellOffset:{x:v.fcoX,y:u.fcoY},startCell:{colIdx:v.starColIdx,rowIdx:u.starRowIdx},endCell:{colIdx:v.endColIdx,rowIdx:u.endRowIdx},rowYs:u.rowYs,colXs:v.colXs};p[o.C_Area_LeftView]=w;var _=a.frozenRightWidth||0,m=a.rightFrozenColPosMaps,v=l.calcViewPortColXs.call(t,m,o.C_Area_RightView,_),V={vwX:d,vwY:c,firstCellOffset:{x:v.fcoX,y:u.fcoY},startCell:{colIdx:v.starColIdx,rowIdx:u.starRowIdx},endCell:{colIdx:v.endColIdx,rowIdx:u.endRowIdx},rowYs:u.rowYs,colXs:v.colXs};p[o.C_Area_RightView]=V,r.ext(a,{calcViewOpts:p})},getGroupDataInfo:function(e){var t={maxLevel:0,allGroups:{},expands:(e||{}).expands||{},levelKeys:{},levelExistKeys:{}};return t},groupData:function(e){var t=this,o=t.options,a=(o.rowData,t.viewOptions),i=a.groupDefaultExpand,n=(a.viewColMaps,a.groupbyFieldMaps),s=a.groupbyAggrFileldMaps,d=n.length,c=a.viewRowDataMaps,C=l.getGroupDataInfo(a.viewRowGroupDataInfos);C.maxLevel=d;for(var u=function(e,t,r,l,o,a,i){var n={value:void 0==e?"root":e,text:void 0==t?"root":t,isRoot:r?!1:!0,isGroup:!0,isExpand:void 0===i?!1:i,rowId:-1,rowIndex:-1,srcRowId:r?r.rowId:-1,srcRowIndex:r?r.rowIndex:-1,col:l||{},groupParent:a,level:void 0===o?-1:o,childrenKeys:{},children:[]};return n},f=C.allGroups,p=C.levelKeys,g=C.levelExistKeys,h=C.expands,v=c,w=0;w<v.length;w++){for(var _=v[w],m=r.getRowItemByMap(o,_),V=new r.KDVString,D=void 0,y="",F="",S="",R=0;d-1>=R;R++){var I=g[R]=g[R]||{},x=p[R]=p[R]||[],G=R==d-1,k=n[R],M=l.getGroupValue(o,k,_),T=r.createCallerParams(k,m);y=V.toString(),V.append(M),F=V.toString(),S=l.fetchCellDisplayValue.call(t,T);var H=void 0===h[F]?G?i:!0:h[F],D=f[F]||u(F,S,_,k,R,void 0,H);if(y){var O=f[y];void 0===O.childrenKeys[F]&&(O.childrenKeys[F]=F,O.children.push(D)),D.groupParent=O}f[F]=D,I[F]||(x.push(F),I[F]=!0),void 0===h[F]&&(h[F]=H)}F=V.toString(),D=f[F]||u(F,F,_,k,d,void 0,H),D.children.push(_),_.groupParent=D,f[F]=D}for(var b=function(e,a){var i=e.isGroup?e:r.getRowItemByMap(o,e),n=r.createCallerParams(a,i),s=l.fetchCellCalcValue.call(t,n);return s},R=d-1;R>=0;R--){var P=p[R]||{length:0},G=R==d-1;r.eachProp(P,"length",function(e,t){var l=f[e];r.eachProp(s,"length",function(e,t){var o=t[e],a=o.aggrFunc,i=l.children||[];if(l.groupCount=i.length,G||"count"==a&&(a="sum"),"count"==a)l[o.field]=l.groupCount;else{var n=l[o.field];if("first"==a){var s=i[0],d=b(s,o);n=d}else if("last"==a){var c=i.length-1,s=i[c],d=b(s,o);n=d}else for(var C=0;C<i.length;C++){var s=i[C],d=b(s,o);n=r.aggregateFuncs[a](d,n)}l[o.field]=n}})})}a.viewRowGroupDataInfos=C,l.expGroupNodesToMap.call(t,e)},expGroupNodesToMap:function(e){var t=this,l=t.viewOptions,o=l.viewRowGroupDataMaps=[],a=l.viewRowGroupDataInfos,i=a.allGroups,n=a.levelKeys,s=function(e){if(o.push(e),e.dataIndex=e.rowIndex,e.rowIndex=o.length-1,e.isGroup&&(e.rowId=r.strFormat("G{0}",e.rowIndex+1),e.isExpand))for(var t=e.children||[],l=0;l<t.length;l++){var a=t[l];a.isGroup||(a=r.shallowClone(a)),s(a)}},d=n[0]=n[0]||{};r.eachProp(d,"length",function(e,t){var r=i[e];s(r)}),e&&e(t),i=void 0,n=void 0},totalSummary:function(e){var t=this,o=t.options,a=(o.rowData,t.viewOptions),i=function(){e&&e(t)};if(!r.isEmpty(o.sumData))return void i();for(var n={},s=a.sumColumns,d=a.components.totalSummay,c=r.getSumGroupHandlers(),C=a.viewColMaps,u=a.viewRowDataMaps,f={},p=0;p<u.length&&r.isEmpty(o.sumData);p++)for(var g=u[p],h=r.getRowItemByMap(o,g),v=0;v<s.length;v++){var w=s[v],_=C[w.field],m=d[w.sumType]||c[w.sumType];if(_&&m&&h){var V=r.createCallerParams(_,h),D=l.fetchCellCalcValue.call(t,V);f[w.field]=m(f[w.field],D)}}for(var v=0;v<s.length;v++){var w=s[v],_=C[w.field],y=w.formatter||r.defSumGrpValueFormatter;n[w.field]=y?y(w,f[w.field]):f[w.field]}r.isEmpty(o.sumData)&&(a.sumResult=n),i()},getGroupValue:function(e,t,o){var a=r.getRowItemByMap(e,o),i=r.createCallerParams(t,a),n=l.fetchCellDisplayValue(i);return n=r.isStr(n)?n:(n||{}).text||""+n||" "}})}function KDVGrid_FindLocate(e,t){var r="KDVGrid",l=KDVGridHelper,o=window.KDVXReses,a=t,i=a.CONSTVARS,n=(a.KDVGridPrototype,function(e,t,r){var l={},o=e.colIndex+1,a=e.rowIndex;o>=t.length&&(o=0,a+=1),a>=r.length&&(a=0);var i=t[o],n=r[a];return l={field:i.field,colIndex:o,rowIndex:a,rowId:n.rowId,found:!1}});l.ext(a,{initViewOptions_FindLocate:function(e){var t=this,r=t.options,o=e.findWinOption=e.findWinOption||{};l.isEmpty(o)&&l.ext(o,r.findWinOption||{value:"",showed:!1,width:280,height:85})},showFindLocateWin:function(t,r){var l=this,o=l.viewOptions||{},i=o.findWinOption||{},n=i.showed,s={themeCls:o.themeCls,parentContainer:e(document.body),eventsHandler:r,showFindWindow:void 0===t?n:t,offset:i.offset};a.updateShowFindLocateState.call(l,s)},buildFindLocateWindow:function(t,r){var l=this,o=l.viewOptions||{},i=o.findWinOption,n=i.showed,s={isVRoot:!0,parentContainer:e(document.body),eventsHandler:r,showFindWindow:n};a.updateShowFindLocateState.call(l,s)},updateShowFindLocateState:function(e){var t=this,r=t.viewOptions||{},o=r.findWinOption,i=o.showed,n=o.offset||{},s=r.width,d=r.height,c=o.width,C=o.height,u=o.value,f=t.findLocateWin,p=l.ext({},e);if(i!=e.showFindWindow&&(l.ext(o,{showed:e.showFindWindow}),i=e.showFindWindow),!i)return void(f&&f.hide&&f.hide.call(f));f&&f.show&&f.show.call(f);var g=n.left||Math.floor(s/2-c/2),h=n.top||Math.floor(d/2),v=t.frozenLayoutViewPort;v.normalCenter;l.ext(p,{showed:e.showFindWindow,value:u,size:{width:c,height:C},offset:{left:g,top:h},callback:function(e){a.findLocate.call(t,e)}}),l.isEmpty(f)?f=t.findLocateWin=new KDVFindWindow(p):f.setOptions.call(f,p)},findMatchNextCell:function(e,t){for(var r=this,o=r.options,i=(r.viewOptions,!1),s=!1,d={contains:{value:t.value,comparer:"contains"}},c={field:"",colIndex:0,rowIndex:0,rowId:0,found:!1},C=r.getViewColumns.call(r),u=a.getViewRowDataMaps.call(r),f=e.rowIndex,p=e.colIndex,g={rowIndex:f,colIndex:p};!i*!s;){g=n(g,C,u),g.rowIndex==f&&g.colIndex==p&&(s=!0);var h=u[g.rowIndex],v=l.getRowItemByMap(o,h),w=C[g.colIndex],_=l.createCallerParams(w,v),m=a.isGroupCol(_),V=v.text,D="";if(D=m?{dipslay:V,value:V}:a.fetchCellFilterValue.call(r,_),l.filterCompare(D,d)){s=!1,i=!0,c={colIndex:g.colIndex,field:w.field,rowIndex:g.rowIndex,rowId:v.rowId,found:!0};break}}return c},findLocate:function(t){var n=this,s=n.viewOptions,d=s.findWinOption=s.findWinOption||{},c=s.curLocateCell=s.curLocateCell||s.currentFocusCell||{field:"",rowIndex:0,rowId:0,isSelected:!0},C=(a.getViewRowDataMaps.call(n),{field:"",colIndex:0,rowIndex:0,rowId:0});switch(t.type){case"move":d.offset=t.offset;break;case"close":d.showed=!1,delete s.curLocateCell,e(i.C_VGridCellLocatedCls,n).removeClass(l.getClsNames(i.C_VGridCellLocatedCls));break;case"find":if(d.value=t.value,l.isEmpty(d.value))return void a.setFindLocateWinMessage.call(n,o.KDVFindWindow.emptyValue);if(s.findLocating)return;s.findLocating=!0,l.setBusy(!0);try{if(void 0===c.colIndex){for(var u=0,f=n.getViewColumns.call(n),p=0;p<f.length;p++)if(f[p].field==c.field){u=p;break}c.colIndex=u}if(C=a.findMatchNextCell.call(n,c,t),C.found){s.curLocateCell=C;var g=o[r].locateCellTipsTemplate||" (c:{0}, r:{1}) ",h=l.strFormat(g,C.colIndex+1,C.rowId);a.setFindLocateWinMessage.call(n,h),a.locateCell.call(n,C)}else a.setFindLocateWinMessage.call(n,o.KDVFindWindow.msgNoFound)}catch(v){l.writeLogFormat("find and locate {0}",!1,v.message)}finally{l.delayReferOnce(n,i.C_FindLocatingHandle,function(){delete s.findLocating,l.setBusy(!1)},800)}}},setFindLocateWinMessage:function(e){var t=this,r=t.findLocateWin;r&&r.setMessage(e||"")},locateCell:function(t){var r=this,o=0,a=i.C_Area_CenterView,n=(r.options,r.viewOptions),s=n.calcViewOpts||{},d=s[a]||{},c=d.rowYs,C=d.colXs,u=c[t.rowId],f=C[t.field],p=l.strFormat('[data-rowid="{0}"] .kd-v-grid-cell[data-field="{1}"]',t.rowId,t.field);e(i.C_VGridCellLocatedCls,r).removeClass(l.getClsNames(i.C_VGridCellLocatedCls)),e(p,r).addClass(l.getClsNames(i.C_VGridCellLocatedCls)),p=l.strFormat("{0} {1}",i.C_VGridHScrollbarCls,i.C_VGridNormalCenterCls),f>=o&&e(p,r).scrollLeft(f-o),p=l.strFormat("{0} {1}",i.C_VGridCenterPadCls,i.C_VGridViewCls),u>=o&&e(p,r).scrollTop(u-o)},releaseFindLocate:function(){var e=this;e.viewOptions;try{if(!l.isEmpty(e.findLocateWin)){var t=e.findLocateWin;t.destroy.call(t),delete e.findLocateWin}}catch(r){l.writeLogFormat("KDVGrid releaseFindLocate {0}",!1,r.message)}}})}function KDVGrid_Algorithm(e,t){var r=KDVGridHelper,l=(window.KDVXReses,t),o=l.CONSTVARS,a=l.KDVGridPrototype;r.ext(l,{initViewOptions_Algorithm:function(e){var t=this;t.options;r.ext(e,{})},algorithmStrategyInvoke:function(e,t){var a=this,i=a.viewOptions;switch(r.writeLogFormat(">> AlgorithmStrategyInvoke - {0}",!1,t||"default - do nothing."),t){case o.OpeKeys.FilterData:l.filterData.call(a,function(t){i.rectChanging=!1,l.algorithmStrategyInvoke.call(t,e,o.OpeKeys.SortData)});break;case o.OpeKeys.SortData:l.sortData.call(a,function(t){i.rectChanging=!1,l.hasGroupBy.call(t)?l.algorithmStrategyInvoke.call(t,e,o.OpeKeys.GroupBy):l.algorithmStrategyInvoke.call(t,e,o.OpeKeys.TotalSum)});break;case o.OpeKeys.GroupBy:l.groupData.call(a,function(t){i.rectChanging=!1,l.algorithmStrategyInvoke.call(t,e,o.OpeKeys.TotalSum)});break;case o.OpeKeys.TotalSum:l.totalSummary.call(a,function(t){i.rectChanging=!1,l.algorithmStrategyInvoke.call(t,e,o.OpeKeys.DataUpdate)});break;case o.OpeKeys.MergerHeaders:case o.OpeKeys.Frozen:case o.OpeKeys.DragDrop:case o.OpeKeys.ShowHide:case o.OpeKeys.ColWidth:i.rectChanging=!1,l.bulidHeaderMergedModel.call(a),l.algorithmStrategyInvoke.call(a,e,o.OpeKeys.DataUpdate);break;case o.OpeKeys.HScroll:case o.OpeKeys.VScroll:case o.OpeKeys.DataUpdate:case o.OpeKeys.ServerSelection:case o.OpeKeys.DoLayout:l.refreshView.call(a,e);break;case o.OpeKeys.Selection:}}}),r.ext(a,{invokeBatchActions:function(e,t,l,o){var a=this,i=l||"defaultBatchActions";if(r.isFunc(e)){a.beginBatchUpdate.call(a,i),e(),a.endBatchUpdate.call(a,i,t)}}});
}function KDVGrid_CellRender(e,t){var r="KDVGrid",l=KDVGridHelper,o=window.KDVXReses,a=t,i=a.CONSTVARS;l.ext(a,{initViewOptions_CellRender:function(e){var t=this;t.options;l.ext(e,{rowYs:{},colXs:{},firstCellOffset:{x:0,y:0},startCell:{colIdx:0,rowIdx:0},endCell:{colIdx:-1,rowIdx:-1}}),a.initDisplayTypeComponents.call(t)},initDisplayTypeComponents:function(){var e=this,t=(e.options,e.viewOptions);l.ext(t.displayTypeComponents,{link:function(e){var t=this,r=a.fetchCellDisplayValue.call(t,e),o='<a class="{0}" target="_blank" style="max-width:100%;display:inline-block;">{1}</a>',n=l.strFormat(o,l.getClsNames(i.C_VGridCellComCls,i.C_VGrid_TxtEllipsisCls),r),s=l.strFormat('<span class="{0}">{1}</span>',l.getClsNames(i.C_VGridCellTxtCls),n);return s},text:function(e){var t=this,r=a.fetchCellDisplayValue.call(t,e),o=l.strFormat('<span class="{0}">{1}</span>',l.getClsNames(i.C_VGridCellTxtCls),r);return o}})}}),l.ext(a,{buildViewPortColHeaderCells:function(t,r,o){for(var n=this,s=n.viewOptions,d=s.showColNum,c=i.C_CellBorderWidth,C=s.sorts,u=C.fieldSeq||[],f=s.filters,p=s.groupbyFieldMaps||{},g=p.length||0,h=l.strFormat('{0} {1}[data-field="{2}"]',i.C_VGridCenterPadCls,i.C_ColHeaderCls,"{0}"),v=s.reservedWidth,w=v,_=(s||{}).colHeaderHeight||35,m=n.getViewColumns(o),V=s.colMergedModel,D=V.isMerged?V.maxLevel||1:1,y=i.C_RenderMaxCols,F=o==i.C_Area_CenterView,S=o==i.C_Area_LeftView,R=a.getViewOffsetLeft.call(n,o),I=o!=i.C_Area_CenterView,x=[],G=0;D-1>G;G++){var k=e(i.C_DIV).addClass(l.getClsNames(i.C_ColHeaderContainerCls)).attr({"data-role":i.C_VGrid_Header_Row_Role,"data-rowindex":G,"data-curindex":G,"data-rowid":-1}).css({minHeight:_}).appendTo(t);x.push(k)}var V=s.colMergedModel,M=V.viewColMerged,T=l.strFormat('<div class="{0}">{1}</div>',l.getClsNames(i.C_ColHeaderResizerCls,i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls),i.C_ResizerText),H=l.strFormat('<div class="{0}">{1}</div>',l.getClsNames(i.C_ColHeaderLeftResizerCls,i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls),i.C_ResizerText),O=function(t,r){var a=r||R;t=t||{length:0};for(var s=0;s<t.length;s++){var d=t[s],C=d.level,u=d.headerName||"",f=d.field,p=n.getColWidth(d.field,o);if(d.isMergedHeader){var g=x[C],h=u.replace(/\s/g,"")?"":i.C_ColMergedHeaderUpCls,v=l.getClsNames(i.C_ColHeaderCls,i.C_ColMergedHeaderCls,h),w={width:p-c,left:a,position:"absolute"},_=p-c>0;if(_||(w.display="none"),_){var m=e(i.C_DIV).addClass(v).css(w).attr({"data-role":i.C_VGrid_Header_Cell_Role,"data-field":f}).appendTo(g);e(H).appendTo(m),e(i.C_SPAN).text(u).appendTo(m),e(T).appendTo(m)}O(d.children,a)}a+=p}};O(M[o]);var b=e(i.C_DIV).addClass(l.getClsNames(i.C_ColHeaderContainerCls)).attr({"data-role":i.C_VGrid_Header_Row_Role,"data-rowindex":D-1,"data-curindex":D-1,"data-rowid":-1}).appendTo(t);if(x.push(b),S){var P=n.isMultiSelection(),N=a.getRowSelectedColHeaderCls.call(n),L=a.buildRowSelector.call(n,r,-1,N,P),E=l.strFormat('<div class="{0}">{1}</div>',l.getClsNames(i.C_ColHeaderResizerCls,i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls),i.C_ResizerText),A=e(i.C_DIV).addClass(l.getClsNames(i.C_ColHeaderCls)).attr({"data-field":i.C_SelField}).css({position:"absolute",display:"block",width:R}).appendTo(b);e(i.C_DIV).addClass(l.getClsNames(i.C_VGridCellCTCls)).html(L).appendTo(A),e(E).css({cursor:"pointer"}).appendTo(A)}var K=s.calcViewOpts||{},z=K[o]||{},W=z.startCell,B=W.colIdx,U=(W.rowIdx,z.endCell),q=U.colIdx,X=(U.rowIdx,z.rowYs,z.colXs);if(F){var Y=q-B;m.length<=y?(B=0,q=m.length-1):y>=Y&&(B=B-y+Y,0>B&&(B=0),q=B+y,q>=m.length&&(q=m.length-1))}for(var G=0;G<m.length;G++){var j=m[G],Q=n.getColWidth(j.field,o);w+=Q}for(var Z=[],J=[],$=l.strFormat('<div draggable="true" class="{0}">{1}</div>',l.getClsNames(i.C_ColHeaderResizerCls,i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls),i.C_ResizerText),G=B;q+1>G;G++){var j=m[G];if(void 0===j)break;var ee=a.isGroupColDef(j),te=1>=g?"":(j.rowGroupSeq||0)+1,re=u.indexOf(j.field),le=j.headerTemplate,oe=n.getColWidth(j.field,o),ae=f[j.field],ie=l.isEmpty(ae)?"":i.C_ColHeaderFilterPinnedCls,ne=j.attrData,se=X[j.field],de=-1==re||u.length<=1?i.C_SortFlagText:re+1,ce=l.getSortTypeClass(C[j.field]),Ce=d?l.strFormat('<span class="{0}">{1}</span>',l.getClsNames(i.C_ColHeaderDebugCls),G+1):"",ue=0!=j.sortable&&ce?l.strFormat('<span class="{0}">{1}</span>',l.getClsNames(i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls,i.C_ColHeaderSortCls,ce),de):"",fe=0==j.filterable?"":l.strFormat('<span class="{0}">{1}</span>',l.getClsNames(i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls,i.C_ColHeaderFilterCls,ie,i.C_VGridIconFilter),i.C_FilterFlageText),pe=ee?l.strFormat('<span class="{0}">{1}</span>',l.getClsNames(i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls,i.C_VGridGrpColFlag,i.C_VGridIconGroup),te):"",ge=l.strFormat('<div Class="{0}">{1}{2}{3}</div>',l.getClsNames(i.C_ColHeaderFuncCtCls),"","",fe),he={draggable:!0,"data-field":j.field};for(var ve in ne)ve&&ne[ve]&&(he[l.strFormat("data-{0}",ve)]=ne[ve]);var we={position:"absolute",top:0,left:se,width:oe-c},_e=oe-c>0;if(_e||(we.display="none"),_e){var me=("<"==(le||"").trim().substr(0,1),l.aggregateFuncs.getName(j.aggrFunc,"({0})")),Ve=l.strFormat('<span class="{0}">{1}{2}{3}{4}</span>',l.getClsNames(i.C_ColHeaderTitleCls),le||j.headerName,me,ue,pe),De='<div><div class="{0}">{1}{2}{3}{4}</div></div>',ye=l.strFormat(De,l.getClsNames(i.C_ColHeaderCTCls),Ve,Ce,ge,$),Fe=e(ye).addClass(l.getClsNames(i.C_ColHeaderCls)).css(we).attr(he);e(l.strFormat(h,j.field),n).length>0?Z.push(Fe):J.push(Fe)}}for(var G=0;G<Z.length;G++)Z[G].appendTo(b);for(var G=0;G<J.length;G++)J[G].appendTo(b);for(var G=0;G<x.length;G++){var k=x[G],Se={width:w,minWidth:s.width,height:_,left:-1*s.vwX+1};I&&(Se.left=0,Se.width="100%"),k.css(Se)}o==i.C_Area_CenterView?s.totalWidth=w:o==i.C_Area_LeftView?s.leftFrozenTotalWidth=w:o==i.C_Area_RightView&&(s.rightFrozenTotalWidth=w)},buildViewPortFilterRowCells:function(t,n,s){var d=this,c=(d.options,d.viewOptions),C=c.filterRowValues,u=c.totalWidth,f=i.C_CellBorderWidth,p=2,g=l.strFormat('{0} {1}[data-field="{2}"]',i.C_VGridFilterRowCls,i.C_ColHeaderCls,"{0}"),h=c.colFilterRowHeight,v=d.getViewColumns(s),w=(a.getViewOffsetLeft.call(d,s),s!=i.C_Area_CenterView),_={width:u,height:h,left:-1*c.vwX+1};w&&(_.left=0,_.width="100%"),t.css(_);for(var m=c.calcViewOpts||{},V=m[s]||{},D=V.startCell,y=D.colIdx,F=(D.rowIdx,V.endCell),S=F.colIdx,R=(F.rowIdx,V.rowYs,V.colXs),I=[],x=[],G=y;S+1>G;G++){var k=v[G];if(void 0===k)break;var M=R[k.field],T=C[k.field]||"",H=d.getColWidth(k.field,s),O={position:"absolute",left:M,width:H-f},b=H-f>0;if(b||(O.display="none"),b){var P=e(i.C_DIV).addClass(l.getClsNames(i.C_ColFilterRowCellCls)).css(O).attr({"data-role":i.C_VGrid_FilterCell_Role,"data-field":k.field});e("<input/>").addClass(l.getClsNames(i.C_ColFilterRowInputCls)).css({position:"absolute",lineHeight:l.getLineHeight(h-1*p)}).attr({placeholder:o[r].filterRowCellHolder,"data-field":k.field}).appendTo(P).val(T),""==T?void 0:e(l.getInputDelBtnTemplate()).addClass(l.getClsNames(i.C_ColInputDelBtnCls)).appendTo(P);e(l.strFormat(g,k.field),d).length>0?I.push(P):x.push(P)}}for(var G=0;G<I.length;G++)I[G].appendTo(t);for(var G=0;G<x.length;G++)x[G].appendTo(t)},buildViewPortNormalCells:function(t,r,o){var n=this,s=n.options,d=n.viewOptions,c=d.selectRowBackground||"",C=!!c,u=d.showCellVBorder,f=(d.multiCellSelInfo||{}).cells||{},p=d.curLocateCell||{},g=("single"==d.groupDisplayType,d.totalWidth||d.width),h=n.getViewColumns(o),v=d.selectedRows||{},w=a.getViewRowDataMaps.call(n),_=i.C_CellBorderWidth,m=l.strFormat('{0} [data-role="{1}"]',i.C_VGridCenterPadCls,i.C_VGrid_Row_Role)+'[data-rowid="{0}"]',V=l.strFormat('{0} [data-role="{1}"]',i.C_VGridCenterPadCls,i.C_VGrid_Row_Role)+'[data-rowid="{0}"] '+i.C_VGridCellCls+'[data-field="{1}"]',D=d.defRowHeight,y=d.rowHeight,F=o==i.C_Area_LeftView,S=o==i.C_Area_CenterView,R=a.getViewOffsetLeft.call(n,o),I=!S,x=S?g:F?d.leftFrozenTotalWidth:d.rightFrozenTotalWidth,G={width:x,minWidth:S?d.width:x,left:-1*d.vwX+1,Top:-1*d.vwY};I&&(G.left=0,G.width="100%"),t.css(G);for(var k=d.calcViewOpts||{},M=k[o]||{},T=M.startCell,H=T.colIdx,O=T.rowIdx,b=M.endCell,P=b.colIdx,N=b.rowIdx,L=M.rowYs,E=M.colXs,A=[],K=[],z=O;N+1>z;z++){var W=w[z],B=W.isGroup,U=W.rowId,q=L[U],X=y[U]||D,Y=v[U]?i.C_VGridRowSelCls:"",j=!!Y,Q=z%2==0?i.C_VGridRowOddCls:"",Z=l.getRowItemByMap(s,W),J=Z.col,$=e(i.C_DIV).addClass(l.getClsNames(i.C_VGridRowCls,Q,Y)).attr({"data-role":i.C_VGrid_Row_Role,"data-rowindex":Z.rowIndex,"data-curindex":z,"data-rowid":U}).css({background:C&&j?c:"",transform:l.strFormat("translateY({0}px)",q),height:X});if(W){var ee=[],te=[];if(F){var re=n.isMultiSelection(),le=a.buildRowSelector.call(n,r,U,"",re),oe=e(i.C_DIV).addClass(l.getClsNames(i.C_VGridCellCls)).attr({"data-field":i.C_SelField}).css({display:"block",width:R}).appendTo($);e(i.C_DIV).addClass(l.getClsNames(i.C_VGridCellCTCls)).html(le).appendTo(oe)}for(var ae=H;P+1>ae;ae++){var ie=h[ae];if(void 0===ie)break;var ne=E[ie.field],se=n.getColWidth(ie.field,o),de=p.field==ie.field&&p.rowId==U,ce={left:ne,width:se-_,lineHeight:l.getLineHeight(X),textAlign:ie.rowGroup?"left":B?"right":ie.align||"left"},Ce=se-_>0;if(Ce){var ue=l.createCallerParams(ie,Z),fe=a.isGroupCell(ue),pe=l.strFormat("a{0}_c{1}_r{2}",o,ie.field,U),ge=f[pe],he=l.isEmpty(ge)?"":i.C_VGridCellMulSelCls,ve=function(e,t){var r="";return r=a.isGroupCol(e)?a.fetchCellGroupValue.call(t,e):a.fetchCellInnerValue.call(t,e)}(ue,n),we=e(i.C_DIV).attr({"data-role":i.C_VGrid_Cell_Role,tabindex:"-1"}).addClass(l.getClsNames(i.C_VGridCellCls,he)).css(ce).attr({"data-field":ie.field,"data-valfield":fe?(J||{}).field:""});de&&we.addClass(l.getClsNames(i.C_VGridCellLocatedCls)),u&&we.addClass(l.getClsNames(i.C_VGridCellVBorderCls));e(i.C_DIV).addClass(l.getClsNames(i.C_VGridCellCTCls)).html(ve).appendTo(we);e(l.strFormat(V,U,ie.field),n).length>0?ee.push(we):te.push(we)}else ce.display="none"}for(var ae=0;ae<ee.length;ae++)ee[ae].appendTo($);for(var ae=0;ae<te.length;ae++)te[ae].appendTo($)}if(e(l.strFormat(m,U),n).length>0?A.push($):K.push($),z>i.C_RowLimit){l.writeLogFormat("The row count is out of {0} limit. Center View Port render has been break.",!1,i.C_RowLimit);break}}for(var ae=0;ae<A.length;ae++)A[ae].appendTo(t);for(var ae=0;ae<K.length;ae++)K[ae].appendTo(t)},buildViewPortSummaryRowCells:function(t,r,o){var n=this,s=(n.options,n.viewOptions),d=s.sumResult||{},c=s.totalWidth,C=i.C_CellBorderWidth,u=10,f=2,p=l.strFormat('{0} {1}[data-field="{2}"]',i.C_ColFooterRowContainerCls,i.C_ColFooterRowCellCls,"{0}"),g=s.colFooterHeight,h=n.getViewColumns(o),v=(a.getViewOffsetLeft.call(n,o),o!=i.C_Area_CenterView),w={width:c,height:g,left:-1*s.vwX+1};v&&(w.left=0,w.width="100%"),t.css(w);for(var _=s.calcViewOpts||{},m=_[o]||{},V=m.startCell,D=V.colIdx,y=(V.rowIdx,m.endCell),F=y.colIdx,S=(y.rowIdx,m.rowYs,m.colXs),R=[],I=[],x=D;F+1>x;x++){var G=h[x];if(void 0===G)break;var k=S[G.field],M=d[G.field]?i.C_ColFooterRowCellDataCls:"",T=d[G.field]||" ",H=n.getColWidth(G.field,o),O={position:"absolute",left:k,width:H-C},b=H-C>0;if(b||(O.display="none"),b){var P=e(i.C_DIV).addClass(l.getClsNames(i.C_ColFooterRowCellCls,M)).css(O).attr({"data-role":i.C_VGrid_SumCell_Role,"data-field":G.field});if(M){e(i.C_SPAN).addClass(l.getClsNames(i.C_ColFooterRowCellLeftBrCls)).appendTo(P)}e(i.C_SPAN).css({width:H-u-f+1,height:g-1*f,lineHeight:l.getLineHeight(g-1*f)}).attr({"data-field":G.field}).text(T).appendTo(P);e(l.strFormat(p,G.field),n).length>0?R.push(P):I.push(P)}}for(var x=0;x<R.length;x++)R[x].appendTo(t);for(var x=0;x<I.length;x++)I[x].appendTo(t)}}),l.ext(a,{fetchModelValue:function(e){var t="";e.colDef;return t=e.data[e.colDef.field]||""},fetchCellValue:function(e){var t="",r=e.colDef;return t=r.valueGetter?r.valueGetter(e):e.data[e.colDef.field]||""},fetchCellDisplayValue:function(e){var t="",r=e.colDef;return r&&r.displayValueGetter?t=r.displayValueGetter(e):(t=e.data[e.colDef.field]||"",l.isArray(t)&&(t=t[0]||"")),t&&!l.isStr(t)&&(t=t.text||t.display||""),t},fetchCellSortValue:function(e){var t="",r=e.colDef;return t=r&&r.sortValueGetter?r.sortValueGetter(e):a.fetchCellCalcValue(e)},fetchCellCalcValue:function(e){var t="",r=e.colDef;return r&&r.calcValueGetter?t=r.calcValueGetter(e):(t=a.fetchCellValue(e),l.isArray(t)&&(t=t.length>1?t[1]:t[0])),t},fetchCellFilterValue:function(e){var t,r="",o=e.colDef;t=o&&o.filterValueGetter?o.filterValueGetter(e):a.fetchCellCalcValue(e);var i=function(e){return"string"==typeof(e||"")?e||"":e.toString()};return r=l.isArray(t)?{display:i(t[0]||""),value:t[1]||""}:"object"==typeof t?{display:i(t.text||t.display),value:t.value}:{display:i(t||""),value:t||""}},isGroupCol:function(e){var t=e.colDef,r=a.isGroupColDef(t);return r},isGroupColDef:function(e){var t=(e||{}).rowGroup,r=!!t;return r},isGroupCell:function(e){var t=e.colDef,r=e.data,l=r.isGroup,o=t.rowGroup,a=l&&o;return a},fetchCellInnerValue:function(e){var t=this,r=(t.options,t.viewOptions),o=e.colDef,n=l.strFormat("{0}",o.displayType||i.C_ColDefDisplayType),s=(e.data,o.template),d=(r.displayTypeComponents||{})[n]||null,c="";if(l.isFunc(s))c=s(e);else if(l.isFunc(d))c=d(e);else{var C=a.fetchCellDisplayValue.call(t,e);c=l.strFormat('<span class="{0}">{1}</span>',l.getClsNames(i.C_VGridCellTxtCls),C)}return c},fetchCellGroupValue:function(t){var r=this,o=r.viewOptions,n="single"==o.groupDisplayType,s=t.colDef,d=t.data,c=d.col||{},C=!1,u="";if(C=n?0==s.rowGroupSeq:s.field==c.field,a.isGroupCell(t)){var f="",p=a.fetchCellDisplayValue.call(r,t);s.aggrFunc&&(f=l.strFormat("({0})",p));var g=e(i.C_SPAN).addClass(l.getClsNames(i.C_VGridGroupCellCt,i.C_VGridCellTxtCls));if(C){var h=d.text,v=d.isExpand;if(n){var w=0;w=i.C_GroupLevelLeftInPx*(d.level||0),w>0&&g.css({paddingLeft:w})}e(i.C_SPAN).addClass(l.getClsNames(i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls,i.C_VGridGrpCellContracted,i.C_VGridIconGroupContracted)).css({display:v?"none":""}).appendTo(g),e(i.C_SPAN).addClass(l.getClsNames(i.C_VGrid_IconfontsCls,i.C_VGrid_IconCls,i.C_VGridGrpCellExpanded,i.C_VGridIconGroupExpanded)).css({display:v?"":"none"}).appendTo(g),e(i.C_SPAN).addClass(l.getClsNames(i.C_VGridGrpCellCheckBox)).appendTo(g),e(i.C_SPAN).html(h).addClass(l.getClsNames(i.C_VGridGrpCellText)).appendTo(g),e(i.C_SPAN).text(f).addClass(l.getClsNames(i.C_VGridGrpCellChild)).appendTo(g)}else n&&e(i.C_SPAN).text(f).addClass(l.getClsNames(i.C_VGridGrpCellChild)).appendTo(g);u=g[0].outerHTML}else n&&a.isGroupCol(t)?u=C?"":a.fetchCellInnerValue.call(r,t):l.equalsIC(s.displayType||i.C_ColDefDisplayType,i.C_ColDefDisplayType)||(u=a.fetchCellInnerValue.call(r,t));return u}}),l.ext(a,{getMultiCellValus:function(){var e=this,t=(e.options,e.viewOptions||{}),r=t.multiCellSelInfo;return r.copyText||""},updateMultiCellSelected:function(t){var r=this,o=r.options,n=r.viewOptions||{},s=n.copyOrginalValue,d=n.multiCellSelInfo,c=d.startCell.area,C=d.startCell.field,u=d.endCell.field,f=d.startCell.rowId,p=d.endCell.rowId;if(f!=p||C!=u){for(var g=r.getViewColumns.call(r),h=a.getViewRowDataMaps.call(r),v=-1,w=0,_=-1,m=0,V=0;V<g.length;V++){var D=g[V];(l.equalsIC(D.field,C)||l.equalsIC(D.field,u))&&(-1==v?(v=V,w=V):w=V)}for(var V=0;V<h.length;V++){var y=h[V];(y.rowId==f||y.rowId==p)&&(-1==_?(_=V,m=V):m=V)}for(var F=0,S=[],R={length:0},V=_;m>=V;V++){var I=h[V],x=l.getRowItemByMap(o,I),G=(x||{}).rowId||"",k={rowId:G,flds:[]};R[R.length]=k,R.length++;for(var M=v;w>=M;M++){var D=g[M];if(l.equalsIC(c,D.area||i.C_Area_CenterView)){var T=(D||{}).field||"",H=l.strFormat("a{0}_c{1}_r{2}",c,T,G);k.flds.push(T);var O=l.createCallerParams(D,x),b=s?a.fetchCellCalcValue.call(r,O):a.fetchCellDisplayValue.call(r,O);S.push(b),S.push("	"),d.cells[H]={rowId:G,field:T,dataIndex:V,selected:!0},F++}}S.push("\r\n")}d.cells.length=F,d.copyText=l.arrToStr(S);var P=t||function(){l.writeLogFormat("{0}({1}), {2}",!1,"updateMultiCellSelected",F,"refreshView")},N=240;if(N>F){for(var V=0;V<R.length;V++)for(var L=R[V],E=l.strFormat('{0}[data-rowid="{1}"]',i.C_VGridRowCls,L.rowId),A=e(E,r),M=0;M<L.flds.length;M++){var K=l.strFormat('{0}[data-field="{1}"]',i.C_VGridCellCls,L.flds[M]);e(K,A).addClass(l.getClsNames(i.C_VGridCellMulSelCls))}P(r)}else a.algorithmStrategyInvoke.call(r,P,i.OpeKeys.DataUpdate)}},copySelectedCellsToClipBoard:function(t,r,o){var n=this,s=n.options,d=n.viewOptions,c=d.copyOrginalValue,C=t,u=l.getClsNames(i.C_VGridCellSparkCls),f=r;if(d.isMultiCellSelMode)f=e(i.C_VGridCellMulSelCls,n).addClass(u),C=a.getMultiCellValus.call(n);else if(c){if(l.isEmpty(o)&&!l.isEmpty(r)){var p=l.getData(r),g=r.parent(i.C_VGridRowCls),h=l.getData(g);o={field:p.field||"",rowindex:h.rowindex}}if(!l.isEmpty(o)){var v=o.field,w=o.rowindex,_=a.getViewRowDataMaps.call(n),m=_[w],V=l.getRowItemByMap(s,m),D=a.getColDef.call(n,v),y=l.createCallerParams(D,V),F=a.fetchCellCalcValue.call(n,y);C=l.strFormat("{0}",F)}}C&&l.uiTxtToClipboard(C,function(){l.delayToFlagReferOnce(n,"KDVGrid.C_Coping_UICells",function(t){f&&f.removeClass(u),!f||r&&r.length||(r=e(f[0])),r&&r.trigger("focus")},360,"Coping_UICells")})},removeCellMulSelCls:function(){var t=this;e(i.C_VGridCellMulSelCls,t).removeClass(l.getClsNames(i.C_VGridCellMulSelCls))},removeCellSelectedRangeRect:function(){e(i.C_VGrid_DrawRectCls).remove()},drawCellSelectedRangeRect:function(){var t=this,r=t.viewOptions||{},o=r.multiCellSelInfo,a=o.startCell||{x:0,y:0},n=o.curPos||{x:0,y:0},s=e(i.C_VGrid_DrawRectCls);0==s.length&&(s=e(i.C_DIV).addClass(l.getClsNames(r.themeCls,i.C_VGrid_DrawRectCls)).appendTo(e(document.body)));var d=a.y,c=a.x,C=n.x-a.x,u=n.y-a.y;0>C&&(C=-1*C,c=n.x),0>u&&(u=-1*u,d=n.y),s.css({top:d,left:c,height:u,width:C})},hideAllPopup:function(){KDVContextMenu.hideAll(),KDVPopupList.hideAll(),KDVFindWindow.hideAll()},getViewOffsetLeft:function(e){var t=this,r=t.viewOptions||{},l=r.rowSelection==i.C_SingleSel,o=e==i.C_Area_LeftView,a=(e==i.C_Area_RightView,o&&!l?r.frozenLeftWidth:0);return a}})}function KDVGrid_Sort(e,t){var r=KDVGridHelper,l=(window.KDVXReses,t),o=l.CONSTVARS;r.ext(l,{initViewOptions_sort:function(e){var t=this,l=t.options;r.ext(e,{sorts:l.sorts||{},viewSortRowMaps:[]})},sortDataSingleField:function(e){var t=this,o=t.viewOptions,a=o.sorts,i=t.getViewColumns(),n=(o.viewSortRowMaps,void 0),s="";for(var d in a){s=a[d];for(var c=0;c<i.length;c++)if(i[c].field==d){n=i[c];break}}if(!r.isEmpty(n))if(r.isDontSort(s))o.viewRowDataMaps=o.rowData||[];else{var C=o.viewRowDataMaps=r.copyRowDataMap(o,function(e){var o=r.createCallerParams(n,e),a=l.fetchCellSortValue.call(t,o);return a});r.sortRowDataMap(C,s)}e&&e(t)},sortData:function(e){for(var t=this,o=t.options,a=t.viewOptions,i=a.sorts,n=i.fieldSeq||[],s=a.rowData||[],d=[],c=0;c<n.length;c++){var C=n[c],u=i[C],f=l.getColDef.call(t,C);d.push({col:f,type:u})}if(r.isEmpty(d))a.viewRowDataMaps=a.rowData;else if(r.isDontSort(u))a.viewRowDataMaps=a.rowData||[];else{var p=function(e,o){var a=r.createCallerParams(e,o),i=l.fetchCellSortValue.call(t,a);return i};a.viewRowDataMaps=r.sortRowDataMapByComparer(s,function(e,t){for(var l=0,a=r.getRowItemByMap(o,e),i=r.getRowItemByMap(o,t),n=0;n<d.length;n++){var s=d[n],c=p(s.col,a),C=p(s.col,i),u=r.sortComparer(c,C,s.type);if(0!=u){l=u;break}}return l})}e&&e(t)},handlerColHeaderSortClick:function(t){t.stopPropagation();var a=this,i=a.options,n=i.components||{},s=a.viewOptions||{},d=s.viewColMaps,c=(s.sorts,e(t.currentTarget)),C=r.getData(c),u=d[C.field],f=c.hasClass(r.getClsNames(o.C_ColHeaderCls))?c:c.closest(o.C_ColHeaderCls),p=r.getData(f);if(!r.equalsIC(C.field,o.C_SelField)&&void 0!==u&&0!=u.sortable){var g=r.switchSortType(a.getSortType(p.field));l.setSortTypeCore.call(a,p.field,g,!t.shiftKey),e(o.C_ColHeaderSortCls,a).empty();var h=c.hasClass(r.getClsNames(o.C_ColHeaderSortCls))?c:e(o.C_ColHeaderSortCls,c);if(h.html(r.getSortTypeContent(g)),l.algorithmStrategyInvoke.call(a,function(){},o.OpeKeys.SortData),r.isFunc(n.sort)){var v=r.ext({},p,{sortType:g});n.sort(v)}r.writeLogFormat("handlerColHeaderSortClick - {0}",!1,g)}},attachGlobalEventHandlers_sort:function(){var e=this;e.viewOptions||{};e.delegate(o.C_ColHeaderCls,o.C_Click,function(t){l.handlerColHeaderSortClick.call(e,t)})},detachGlobalEventHandlers_sort:function(){var e=this;e.viewOptions||{};e.undelegate(o.C_ColHeaderCls,o.C_Click)}})}function KDVGrid_Filter(e,t){var r=KDVGridHelper,l=(window.KDVXReses,t),o=l.CONSTVARS;o.C_Filter_Linkage_BaseAll="all",o.C_Filter_Linkage_BaseLast="baselast",o.C_Filter_Linkage_BaseCurr="basecurr",o.C_Filter_Linkage_ExcludeCurr="excludecurr",r.ext(l,{initViewOptions_filter:function(e){var t=this,a=t.options;r.ext(e,{colFilterProxies:{},colFilterSize:{width:180,height:280},filterFieldsSeq:"",filterRowValues:{},filterRowCaches:{},colFilterRowHeight:r.getValue(a,"colFilterRowHeight",30),colFilterValueFetchType:r.getValue(a,"colFilterValueFetchType",o.C_Filter_Linkage_ExcludeCurr),viewFilterRowMaps:[],filters:{}});var i=a.filters||{},n=[];if(!r.isEmpty(i)){for(var s in i){var d=i[s]||{};for(var c in d){var C=d[c];r.isEmpty(C)||n.push(C)}}r.isEmpty(n)||l.setFilterValueCore.call(t,n)}},filterData:function(e){var t=this;r.delayToFlagReferOnce(t,o.C_AfterTypingHandle,function(t){l.filterDataCore.call(t,function(t){e&&e(t),r.writeLogFormat("filterData - {0}",!1,"isTyping")},o.OpeKeys.FiilterData)},o.C_DelayCalc,"isTyping")},filterDataCore:function(e){var t=this,r=t.viewOptions;r.rowData=r.viewRowDataMaps=l.getfilterData.call(t),e&&e(t)},getfilterData:function(e){var t=this,o=t.options,a=o.rowData,i=t.viewOptions,n=i.filters,s=i.filterFieldsSeq||"",d=r.equalsIC(i.colFilterValueFetchType||"all","all"),c=i.viewColMaps,C=(i.viewFilterRowMaps,[]),u=i.filterRowCaches={},f=e?e.split(",").filter(function(e){return!!e}):[],p=s.split(",").filter(function(e){return!!e});if(p.length>0)for(var g=0;g<a.length;g++){for(var h=a[g],v=r.getRowItemByMap(o,h),w=!0,_=0;_<p.length;_++){var m=p[_]||"",V=c[m],D=n[m];if(0==f.length||f.indexOf(m)<0){var y=r.createCallerParams(V,v),F=l.fetchCellFilterValue.call(t,y);if(!r.filterCompare(F,D)){w=!1;break}if(!d){var S=u[m]=u[m]||[];S.push(h)}}}w&&C.push(h)}else C=a;return C},releaseFilters:function(){var e=this;e.viewOptions;l.releaseColFilters.call(e)},releaseColFilters:function(){var e=this,t=e.viewOptions;try{var o=t.colFilterProxies||{};for(var a in o)l.releaseColFilter.call(e,a);t.colFilterProxies={}}catch(i){r.writeLogFormat("KDVGrid releaseFilters {0}",!1,i.message)}},releaseNextColFilters:function(e){var t=this,o=t.viewOptions,a=o.filterFieldsSeq||"";try{var i=a.split(","),n=!1;for(var s in i){var d=i[s];n&&l.releaseColFilter.call(t,d),d&&d==e&&(n=!0)}}catch(c){r.writeLogFormat("KDVGrid releaseFilters {0}",!1,c.message)}},releaseColFilter:function(e){var t=this,l=t.viewOptions,o=e||"";try{var a=l.colFilterProxies||{},i=a[o]||{};i&&i.destroy&&i.destroy.call(i),delete a[o]}catch(n){r.writeLogFormat("KDVGrid releaseColFilter {0}",!1,n.message)}},releaseColAggrProxy:function(e){var t=this,l=t.viewOptions;try{var o=l.colAggrProxy;o&&o.destroy&&o.destroy.call(o),delete l.colAggrProxy}catch(a){r.writeLogFormat("KDVGrid releaseColAggrProxy {0}",!1,a.message)}}}),r.ext(l,{__getFilterRows_baselast:function(e){var t=this,o=(t.options,t.viewOptions||{}),a=void 0,i=r.equalsIC(o.colFilterValueFetchType||"all","all"),n=o.filterFieldsSeq,s=1==n.indexOf(e);if(!i&&!r.isEmpty(n)&&!s){for(var d=-1,c=o.filterRowCaches,C=n.split(",").filter(function(e){return!!e}),u=0;u<C.length;u++)if(C[u]==e){d=u;break}if(-1==d&&(d=C.length),d>0){var f=C[d-1];a=c[f]||a}}return r.isEmpty(a)&&(a=l.__getFilterRows_all.call(t,e)),a},__getFilterRows_basecurr:function(e){var t=this,o=(t.options,t.viewOptions||{}),a=void 0,i=r.equalsIC(o.colFilterValueFetchType||"all","all"),n=o.filterFieldsSeq,s=o.filterRowCaches||{},d=n.split(","),c=1==n.indexOf(e),C=r.equalsIC(d[d.length-2],e);if(!i&&!r.isEmpty(n)&&C){for(var u=-1,s=o.filterRowCaches,f=n.split(",").filter(function(e){return!!e}),p=0;p<f.length;p++)if(f[p]==e){u=p;break}if(-1==u&&(u=f.length),u>0){var g=f[u-1];a=s[g]||a}}return r.isEmpty(a)&&(a=c&&C?l.__getFilterRows_all.call(t,e):o.viewRowDataMaps),a},__getFilterRows_excludecurr:function(e){var t=this,r=t.options,o=t.viewOptions||{},a=o.filterFieldsSeq||"",i=r.rowData;return i=e&&a.split(",").indexOf(e)>0?l.getfilterData.call(t,e):l.__getFilterRows_basecurr.call(t,e)},__getFilterRows_all:function(e){var t=this,r=t.options,l=(t.viewOptions||{},r.rowData);return l},handlerColHeaderFilterClick:function(t){t.stopPropagation();var a=this,i=a.options,n=i.components||{},s=a.viewOptions||{},d=s.filters||{},c=r.strFormat("__getFilterRows_{0}",s.colFilterValueFetchType||"all","all"),C=l[c]||l.__getFilterRows_all,u=(s.filterFieldsSeq,s.colFilterSize),f=(s.colWidth||{},(s||{}).colHeaderHeight||35),p=s.viewColMaps,g=e(t.currentTarget).closest(o.C_ColHeaderCls),h=r.getData(g),v=h.field,w={},_=p[v],m=l.getCurIntActArea.call(a,g),V=a.getColWidth(v,m);if(!r.equalsIC(v,o.C_SelField)&&0!=_.filterable){w=C.call(a,v);var D=function(e){for(var t={},o=[],n=0;n<e.length;n++){var s=e[n],d=r.getRowItemByMap(i,s),c=r.createCallerParams(_,d),C=l.fetchCellFilterValue.call(a,c);if(""==C.value||""!=C.display){var u=r.toStr(C);t[u]||(t[u]=!0,o.push(C))}}return o},y=(d[v]||{}).filtercolin||{},F={},S=g.offset(),R=V,I=S.left+R-u.width,x=S.top+f+2;if(I=0>I?1:I,x=0>x?1:x,s.colFilterProxies[v]){var G=s.colFilterProxies[v];F={offset:{left:I,top:x},values:y},G.setOptions(F)}else{F={themeCls:s.themeCls,field:v,eventCallback:function(e,t){l.setFilterValueCore.call(a,[e]),l.algorithmStrategyInvoke.call(a,function(){if(r.isFunc(n.filter)){var t=e;n.filter(t)}},o.OpeKeys.FilterData),r.writeLogFormat("handlerColHeaderFilterClick - {0} = {1}",!1,v,e.length)},itemsSource:D(w),values:y,offset:{left:I,top:x},size:u};var G=new KDVGridColFilter(F);s.colFilterProxies[v]=G}if(r.isFunc(n.beforeFilter)){var k=F;n.beforeFilter(k)}r.writeLogFormat("handlerColHeaderFilterClick - {0}",!1,v)}},handlerFilterRowInputChange:function(t){t.stopPropagation();var a=this,i=a.options,n=i.components||{},s=a.viewOptions||{},d=s.filterRowValues,c=e(t.currentTarget),C=r.getData(c),u=C.field,f=r.setNextTick(function(e){r.clearNextTick(f),r.circleImeInputtingCheck(e,function(e){var t=c.val();u&&(d[u]=t);var a={type:"filterrow",field:u,comparer:"contains",value:t};l.setFilterValueCore.call(e,[a]),l.algorithmStrategyInvoke.call(e,function(){if(r.isFunc(n.filterRowChange)){var e=a;n.filterRowChange(e)}},o.OpeKeys.FilterData),r.writeLogFormat("handlerFilterRowInputChange - {0} = {1}",!1,u,t)})},100,a)},handlerInputDelBtn:function(t){t.stopPropagation();var l=this,a=(l.viewOptions||{},e(t.currentTarget).closest(o.C_ColFilterRowCellCls)),i=r.getData(a),n=i.field;e("input",a).val("").focus().trigger(o.C_Change),r.writeLogFormat("handlerInputDelBtn - {0} = {1}",!1,n,"")},handlerColHeaderAggrListClick:function(e,t){var a=this,i=(a.options,a.viewOptions||{}),n=i.viewColPosMaps,s=(i.colWidth||{},i.colFilterSize),d=o.C_Area_CenterView,c=t.field,C=((i||{}).colHeaderHeight||35,a.getColWidth(c,d),t.offset),u=function(e){for(var t={},l=[],o=0;o<e.length;o++){var a=e[o],i={display:r.strFormat("{0} {1}",o+1,a.headerName),value:a.field,index:o},n=i.value;t[n]||(t[n]=!0,l.push(i))}return l},f={},p=u(n),g=r.isEmpty(i.viewColStatus)?p:i.viewColStatus,h={opetype:"ok",type:"filtercolin",field:c,comparer:"in",value:g},v=e.clientX;if(0>v?v=25:v>document.body.clientWidth-s.width&&(v=document.body.clientWidth-s.width-10),i.colAggrProxy){var w=i.colAggrProxy;f={offset:{left:v,top:C.top+5},values:h},w.setOptions(f)}else f={themeCls:i.themeCls,field:c,isSort:!1,secBtnType:"reset",eventCallback:function(e,t){l.handlerColHeaderAggrListCallback.call(a,e,t)},itemsSource:p,values:h,offset:{left:v,top:C.top+5},size:{height:s.height,width:s.width}},i.colAggrProxy=new KDVPopupList(f)},handlerColHeaderAggrListCallback:function(e,t){var a=this,i=(a.options,a.viewOptions||{}),n=i.viewColPosMaps;if(delete i.viewColStatus,"reset"==e.opetype)for(var s=0;s<n.length;s++){var d=n[s];delete d.visible}else{for(var c=i.viewColStatus=(e||{}).value,C={},s=0;s<c.length;s++){var u=c[s],f=u.value||"def";C[f]=!0}for(var s=0;s<n.length;s++){var d=n[s],f=d.field;d.visible=!!C[f]}}l.algorithmStrategyInvoke.call(a,function(){r.writeLogFormat("{0}, {1}",!1,"handlerColHeaderAggrListCallback","algorithmStrategyInvoke")},o.OpeKeys.ShowHide)},attachGlobalEventHandlers_filter:function(){var e=this;e.delegate(o.C_ColHeaderFilterCls,o.C_Click,function(t){l.handlerColHeaderFilterClick.call(e,t)}),e.delegate(o.C_ColFilterRowInputCls,o.C_Change,function(t){l.handlerFilterRowInputChange.call(e,t)}),e.delegate(o.C_ColInputDelBtnCls,o.C_Click,function(t){l.handlerInputDelBtn.call(e,t)})},detachGlobalEventHandlers_filter:function(){var e=this;e.undelegate(o.C_ColHeaderFilterCls,o.C_Click),e.undelegate(o.C_ColFilterRowInputCls,o.C_Change),e.undelegate(o.C_ColInputDelBtnCls,o.C_Click)}})}function KDVGrid_CellEditor(t,r){var l=KDVGridHelper,o=(window.KDVXReses,r),a=o.CONSTVARS;o.KDVGridPrototype;l.ext(o,{getEditorContainer:function(e){var r=e,o=a.C_VGridCellEditorContainer,i=t(o,r);if(i.length<1){i=t(a.C_DIV).addClass(l.getClsNames(a.C_VGridCellEditorContainer)).appendTo(r);var n=l.ext({width:r.width(),height:r.height()});i.css(n)}return i},getDefaultCellEditor:function(e){var r=this,i=o.fetchCellCalcValue.call(r,e),n=t(a.C_INPUT).addClass(l.getClsNames(a.C_VGridCellEditorDefInput));return n.val(i).select(),n},getDefaultCellEditorParams:function(e){var t=e||{};return t},buildCellEditor:function(r,i){var n=this,s=n.options,d=(n.viewOptions||{},i.field||""),c=i.rowIndex,C=o.getColDef.call(n,d);if(!l.isEmpty(C)){var u=t(r||e.target);u.hasClass(l.getClsNames(a.C_VGridCellCls))||(u=u.closest(a.C_CellSelector,n));var f=a.C_VGridCellEditorContainer;t(f,n).hide();var p=o.getEditorContainer.call(n,u).show();if(t("input",p).length>0)return void t("input:eq(0)",p).trigger("focus");var g=C.__colScope__||n,h=C.cellEditor||o.getDefaultCellEditor,v=C.cellEditorParams||o.getDefaultCellEditorParams,w=s.rowData||[],_=w[c],m=l.getRowItemByMap(s,_),V=l.createCallerParams(C,m),D=v.call(g,V);D.cellContainer=p;var y=h.call(g,D);y=l.isEmpty(y)?void 0:l.isStr(y)?t(y):y,y&&y.length>0&&(p.empty().data(i),y.appendTo(p).trigger("focus"))}}}),l.ext(o,{handlerCenterPadCellClick_cellEditor:function(e,t,r){var l=this;e.shiftKey||e.altKey||e.ctrlKey||o.buildCellEditor.call(l,t,r)},handlerCenterPadCellDBLClick_cellEditor:function(e,t,r){},handlerCenterPadCellMouseDown_cellEditor:function(e,t,r){},handlerCenterPadCellMouseMove_cellEditor:function(e){},handlerCenterPadCellMouseUp_cellEditor:function(e,t,r){},handlerCenterPadCellComClick_cellEditor:function(e,t,r){},handlerKDVGridKeydown_cellEditor:function(e){var t=this;t.viewOptions||{},e.keyCode||e.which||e.charCode,e.ctrlKey||e.metaKey,e.shiftKey},handlerKDVGridKeyup_cellEditor:function(e){var t=this;t.viewOptions||{},e.keyCode||e.which||e.charCode,e.ctrlKey||e.metaKey,e.shiftKey}}),l.ext(o,{execCellEditorHandler:function(e,t){var r=void 0,a=(e||{}).viewOptions||{};if(a.editable){var i=l.isFunc(t)?t:l.isStr(t)?o[t]:void 0;if(l.isFunc(i)){for(var n=[],s=2;s<arguments.length;s++)n.push(arguments[s]);r=i.apply(e,n)}}return r},attachGlobalEventHandlers_cellEditor:function(){},detachGlobalEventHandlers_cellEditor:function(){}})}!function(e){}(jQuery),function(e){!function(){var e=window.KDVXReses=window.KDVXReses||{};e.images={queryDataTipsSrcSize:{width:36,height:36},queryDataTipsSrc:"data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZmlsbDpjdXJyZW50Q29sb3I7b3ZlcmZsb3c6aGlkZGVuOyIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik02NzkuNjUxMjgxIDcyMy44NDU0NTZDNjE0LjMxNzQ1OSA3NzkuMTUxMzQ3IDUyOS44MDMyMjggODEyLjUgNDM3LjUgODEyLjVDMjMwLjM5MzIxOSA4MTIuNSA2Mi41IDY0NC42MDY3ODEgNjIuNSA0MzcuNUM2Mi41IDIzMC4zOTMyMTkgMjMwLjM5MzIxOSA2Mi41IDQzNy41IDYyLjVDNjQ0LjYwNjc4MSA2Mi41IDgxMi41IDIzMC4zOTMyMTkgODEyLjUgNDM3LjVDODEyLjUgNTI5LjgwMzIyOCA3NzkuMTUxMzQ3IDYxNC4zMTc0NTkgNzIzLjg0NTQ1NiA2NzkuNjUxMjgxTDkyOC4zNDcwOTQgODg0LjE1MjkwNkM5NDAuNTUwOTc4IDg5Ni4zNTY3OTEgOTQwLjU1MDk3OCA5MTYuMTQzMjA5IDkyOC4zNDcwOTQgOTI4LjM0NzA5NEM5MTYuMTQzMjA5IDk0MC41NTA5NzggODk2LjM1Njc5MSA5NDAuNTUwOTc4IDg4NC4xNTI5MDYgOTI4LjM0NzA5NEw2NzkuNjUxMjgxIDcyMy44NDU0NTZMNjc5LjY1MTI4MSA3MjMuODQ1NDU2ek00MzcuNSA3NTBDNjEwLjA4ODk4NCA3NTAgNzUwIDYxMC4wODg5ODQgNzUwIDQzNy41Qzc1MCAyNjQuOTExMDE2IDYxMC4wODg5ODQgMTI1IDQzNy41IDEyNUMyNjQuOTExMDE2IDEyNSAxMjUgMjY0LjkxMTAxNiAxMjUgNDM3LjVDMTI1IDYxMC4wODg5ODQgMjY0LjkxMTAxNiA3NTAgNDM3LjUgNzUweiIgc3R5bGU9ImZpbGw6IHJnYig0NCwgNDQsIDQ0KTsiPjwvcGF0aD48L3N2Zz4NCg==",
emptyDataTipsSrcSize:{width:48,height:48},emptyDataTipsSrc:""},e.images.queryDataTipsSrc||(e.images.queryDataTipsSrc=e.images.emptyDataTipsSrc),e.KDVGridColFilter={btnReset:"",btnClear:"",btnOK:""},e.KDVListView={defaultAllItem:"",defaultNullItem:"()",multiSelTips:" {0} ",searching:""},e.KDVFindWindow={inpTxtHolder:"",btnClose:"",btnSearch:"",msgNoFound:"",emptyValue:"",title:""},e.KDVGrid={colAggr:"",frozenLeft:"",frozenRight:"",unfrozen:"",groupby:"",ungroupby:"",copy:"",parse:"",cellMultiSel:"",unCellMultiSel:"",filterRowCellHolder:"",queryData:"~",emptyData:"~",locateCellTipsTemplate:" (:{0}, :{1}) ",cellTextDispayFont:'13px "microsoft yahei"'},e.AggrFuncNames={sum:"",min:"",max:"",avg:"",count:"",first:"",last:""}}()}(jQuery),function(e){if(window.isJQueryOver19=window.isJQueryOver19||function(){var t=e().jquery;if(!isNaN(window.parseFloat(t.substring(0,3))))return t.indexOf("1.12.")>=0?!0:window.parseFloat(t.substring(0,3))>=1.9},window.isJQueryOver20=window.isJQueryOver20||function(){var t=e().jquery;isNaN(window.parseFloat(t.substring(0,3)))||window.parseFloat(e().jquery.substring(0,3))>=2},!e.browser&&isJQueryOver19()){var t=window.navigator.userAgent,r=/Chrome\/(\S+)/.test(t)?RegExp.$1:void 0,l=/Version\/(\S+)/.test(t)?RegExp.$1:void 0,o=/OPR\/(\S+)/.test(t)?RegExp.$1:void 0,a=/MSIE ([^;]+)/.test(t)||/Trident\/[^"]*rv:([^\s,^\)]+)/.test(t)?RegExp.$1:void 0,i=r||l||o||a;e.browser=e.extend(e.browser||{},{msie:a,safari:l,opera:o,chrome:r,version:i}),e.curCSS=e.css,e.isNaN=function(e){var t=/\d/;return null==e||!t.test(e)||isNaN(e)}}}(jQuery),function(e){window.KD=window.KD||function(){return{isDebug:function(){return"true"==KD.getQueryString("isDebug","false").toLowerCase()},getQueryString:function(e,t,r){return KD.getQueryStringCore(window.location.search,e,t,r)},getQueryStringCore:function(e,t,r,l){var o=void 0===l?!0:l,a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=o?(e||" ").toLowerCase():e||" ",n=i.substr(1).match(a);return null!=n?decodeURIComponent(n[2]):r}}}()}(jQuery),function(e){var t=window.KDVXReses,r=window.KDVGridHelper=function(){!function(){for(var e=0,t=["webkit","moz","ms"],l=0;l<t.length&&!window.requestAnimationFrame;++l)window.requestAnimationFrame=window[t[l]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[l]+"CancelAnimationFrame"]||window[t[l]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var l=(new Date).getTime(),o=Math.max(0,16-(l-e)),a=r.setNextTick(function(){t(l+o)},o);return e=l+o,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){r.clearNextTick(e)})}();var l=function(){return{getDefMilSec:function(){return 5},getDateTimeStr:function(){var e=new Date,t=r.strFormat("{0}-{1}-{2} {3}:{4}:{5}.{6}",e.getYear(),e.getMonth(),e.getDay(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return t},isDebug:function(){var e=KD.isDebug();return e},isFunc:function(e){var t=void 0!==e&&"function"==typeof e;return t},isArray:function(e){return Array.isArray(e)},isChrome:function(){return!!e.browser.chrome},isIE:function(){return!!e.browser.msie},getUiid:function(e){var t=(e||{}).uiid||r.strFormat("U{0}",r.guid["new"]("N"));return t},isOwnProp:function(e,t){var r=!!t&&void 0!==e&&t.hasOwnProperty(e);return r},isRunInForIn:function(e,t){var l=void 0;return l=r.isArray(t)?r.isOwnProp(e,t):!!t&&void 0!==e},getValue:function(e,t,r){var l=(e||{})[t||""];return l=void 0===l?r:l},eachProp:function(e,t,l){var o=t||"";if(Array.isArray(e))for(var a=0;a<e.length;a++){var i=e[a];(!r.isStr(i)||o.indexOf(i)<0||""===i)&&l(i,e)}else for(var i in e)r.isRunInForIn(i,e)&&o.indexOf(i)<0&&l(i,e)},isStr:function(e){var t="string"==typeof e;return t},isNumber:function(e){var t="number"==typeof e;return t},toStr:function(e){return r.isStr(e)?e:JSON.stringify(e)},toObject:function(e){var t=JSON.parse(e);return t},clone:function(e){if(!e)return e;if(r.isStr(e))return e;var t=r.toStr(e);return r.toObject(t)},shallowClone:function(e){var t={};return r.ext(t,e),t},copyObject:function(e,t){for(var r={},l=e||{},o=t||[],a=0;a<o.length;a++){var i=o[a]||"";i&&(r[i]=l[i])}return r},getClsNames:function(){for(var e="",t=0;t<arguments.length;t++){var l=arguments[t]||"",o="."==l.substr(0,1)?l.substr(1):l;e=r.strFormat("{0} {1}",e,o)}return(e||"").trim()},replaceAll:function(e,t,l){var o=e,a=l;if(!r.isEmpty(t))if(r.hasUnreplaceChars(a))for(var i=r.isStr(t)?new RegExp(t):t,n=i.toString().replace(/\\/g,"").length-2,s=i.exec(o);null!=s;)o=o.substr(0,s.index)+a+o.substr(s.index+n),i.lastIndex=s.index+a.length,s=i.exec(o);else if(r.isStr(t))for(;o.indexOf(t)>=0;)o=o.replace(t,a);else o=o.replace(new RegExp(t.toString(),"g"),a);return o},strFormat:function(e){var t=arguments,l=e||"";if(""!=l){for(var o=1;o<t.length;o++){var a="{"+(o-1)+"}",i=void 0===t[o]?"":t[o];r.isStr(i)&&/[\{\}]/.test(i)&&(i=r.replaceAll(i,"{","#lf_b#"),i=r.replaceAll(i,"}","#rg_b#")),l=r.replaceAll(l,a,i)}l=l||"",l=r.replaceAll(l,"#lf_b#","{"),l=r.replaceAll(l,"#rg_b#","}")}return r.isDebug()&&l!=r.strFormat_r.apply(window,arguments),l},hasUnreplaceChars:function(e){var t=!1;if(r.isStr(e))for(var l=["$&","$'","$`","$$"],o=0;o<l.length;o++)if(e.indexOf(l[o])>-1){t=!0;break}return t},strFormat_r:function(e){var t=arguments,l=e||"";if(""!=l){for(var o=1;o<t.length;o++){var a="\\{"+(o-1)+"\\}",i=("{"+(o-1)+"}").length,n=new RegExp(a,"g"),s=void 0===t[o]?"":t[o];if(r.isStr(s)&&/[\{\}]/.test(s)&&(s=s.replace(/\{/g,"#lf_b#").replace(/\}/g,"#rg_b#")),r.hasUnreplaceChars(s)){n=new RegExp(a);for(var d=n.exec(l);null!=d;)l=l.substr(0,d.index)+s+l.substr(d.index+i),n.lastIndex=d.index+s.length,d=n.exec(l)}else l=l.replace(n,s)}l=(l||"").replace(/#lf_b#/g,"{").replace(/#rg_b#/g,"}")}return l},arrToStr:function(e,t){var r=e.join(t||"");return r},equalsIC:function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;var l=!1;return l=r.isStr(e)&&r.isStr(t)?e.toUpperCase()===t.toUpperCase():e==t},writeLog:function(e,t){(t||r.isDebug())&&console&&console.log(e)},writeLogFormat:function(e,t){if(t||r.isDebug()){for(var l=[e],o=2;o<arguments.length;o++){var a=arguments[o];l.push(r.isStr(a)?a:r.toStr(a))}var i=r.strFormat.apply(this,l);r.writeLog(i,t)}},registerCssClass:function(e){var t=document.createElement("style"),r=document.getElementsByTagName("head")[0];r&&(document.all?(t.setAttribute("type","text/css"),t.styleSheet.cssText=e):t.appendChild(document.createTextNode(e)),r.firstChild?r.insertBefore(t,r.firstChild):r.appendChild(t))},isEmpty:function(e){var t=!1;if(void 0===e||null==e||""==e)t=!0;else if("object"==typeof e)if(void 0!==e&&e.constructor==Array)t=0==e.length;else if(void 0!==e&&e.constructor==Object){t=!0;for(var r in e){t=!1;break}}return t},getHtmlCoder:function(){var e=window.KDHtmlCoder;return e||(e=document.createElement("span"),window.KDHtmlCoder=e),e},htmlEncode:function(e){var t=r.getHtmlCoder();t.appendChild(document.createTextNode(e));var l=t.innerHTML;return t.innerHTML="",l},htmlDecode:function(e){var t=r.getHtmlCoder();t.innerHTML=e;var l=t.innerText||t.extContent;return t.innerHTML="",l},getSetTickFrame:function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;return e},getCancelTickFrame:function(){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame;return e},setNextTick:function(e,t,l){var o=0,a=r.getSetTickFrame();if(a&&r.isChrome())if((t||0)>r.getDefMilSec())o=window.setTimeout(function(t){var l=r.getCancelTickFrame();r.setNextTick.lastReqAniFrameHandle&&l(r.setNextTick.lastReqAniFrameHandle);var o=r.setNextTick.lastReqAniFrameHandle=a(function(){l(o),e(t)})},t,l);else{var i=r.getCancelTickFrame();r.setNextTick.lastReqAniFrameHandle&&i(r.setNextTick.lastReqAniFrameHandle);var n=r.setNextTick.lastReqAniFrameHandle=a(function(){i(n),e(l)})}else o=window.setTimeout(e,t,l);return o},clearNextTick:function(e){return clearTimeout(e)},delayReferOnce:function(e,t,l,o){e&&void 0!=e[t]&&(r.clearNextTick(e[t]||0),delete e[t]),void 0!==l&&(e[t]=r.setNextTick(function(e){var o=e||{};r.clearNextTick(o[t]||0),delete o[t],l(o)},o||r.getDefMilSec(),e))},delayToFlagReferOnce:function(e,t,l,o,a){e&&void 0!=e[t]&&(r.clearNextTick(e[t]||0),delete e[t]),void 0!==l&&(e[t]=r.setNextTick(function(e){var i=e||{};if(!i[a])if(void 0===i[a]){i[a]=!0;try{r.clearNextTick(i[t]||0),delete i[t],l(i)}finally{delete i[a]}}else r.delayToFlagReferOnce(i,t,l,o,a)},o||r.getDefMilSec(),e))},ext:function(){var t=void 0,r=e.extend;return t=arguments.length>1?r.apply({},arguments):arguments[0]},get:function(){var t=void 0,r=arguments[0],l=arguments[1],o=arguments[2];return t=e(r,l,o)},getData:function(e){var t={},r=(e[0]||e||{}).dataset;for(var l in r)"curindex"==l||"rowindex"==l?t[l]=parseInt(r[l]):t[l]=r[l];return t},parseRowId:function(e,t){var r=e;return"number"==typeof e&&(r=parseInt(e),r=isNaN(r)?t:r),r},createCallerParams:function(e,t){var r={colDef:e,data:t};return r},switchSortType:function(e){var t="";switch(e){case"asc":t="desc";break;case"desc":t="";break;default:t="asc"}return t},getSortTypeContent:function(e){var t="";return t=""},getSortTypeClass:function(e){var t="";return t="asc"==e?".kd-v-grid-i-sort-asc":"desc"==e?".kd-v-grid-i-sort-desc":""},copyRowDataMap:function(e,t){for(var l=(e||{}).rowData||[],o=new Array(l.length),a=0;a<l.length;a++){var i=l[a];o[a]={rowIndex:i.rowIndex,rowId:r.parseRowId(i.rowId,-1),value:t(i),isMap:!0}}return o},sortRowDataMap:function(e,t){(e||[]).sort(function(e,r){var l=e.value,o=r.value,a=0;return a="asc"==t?o>l?-1:l==o?0:1:"desc"==t?l>o?-1:l==o?0:1:0})},isDontSort:function(e){var t=!("asc"==e||"desc"==e);return t},sortRowDataMapByComparer:function(e,t){for(var l=new Array(e.length),o=0;o<e.length;o++){var a=e[o];l[o]={rowIndex:a.rowIndex,rowId:r.parseRowId(a.rowId,-1),value:"*",isMap:!0}}return l.sort(function(e,r){var l=t(e,r);return l}),l},sortComparer:function(e,t,l){var o=0;return o=r.isStr(e)?"asc"==l?e.localeCompare(t):"desc"==l?t.localeCompare(e):0:"asc"==l?t>e?-1:e==t?0:1:"desc"==l?e>t?-1:e==t?0:1:0},getRowItemByMap:function(e,t){var r=void 0,t=t||{rowIndex:0,rowId:0};if(t.isGroup)r=t;else{var l=e.rowData,o=void 0===t.dataIndex?t.rowIndex:t.dataIndex;r=l[o]||t}return r},getRowGroupItemByMap:function(e,t){var r=e.rowData||[],t=(e.groupRowData||[],t||{rowIndex:0,rowId:0}),l=r[t.rowIndex]||t;return l},filterCompare:function(e,t){var l=!0;for(var o in t){var a=t[o],i=a.value||"",n=a.comparer||"";if(void 0!==e&&i&&n){var s=r.comparerHandler[n+"IC"];if(s&&(l=s(e,i),!l))break}}return l},moveItemTo:function(e,t,r,l){var o={length:e.length};if(l)for(var a=0;a<e.length;a++)o[a]=e[a];else o=e;if(r>t){for(var i=o[t],a=t;r-1>a;a++)o[a]=o[a+1];o[r-1]=i}else if(t>r){for(var i=o[t],a=t;a>r;a--)o[a]=o[a-1];o[r]=i}return o},debug_MoveItemTo:function(e,t,l){for(var o=["a","b","c","d","e","f","g","h"],a={length:o.length},i=0;i<o.length;i++)a[i]=o[i];for(var n=(r.moveItemTo(a,e||1,t||3,void 0===l?!0:l),[]),i=0;i<a.length;i++)n.push(a[i]);r.writeLog(r.strFormat("debug_MoveItemTo before: {0}",r.toStr(o))),r.writeLog(r.strFormat("debug_MoveItemTo after : {0}",r.toStr(n)))},outputOptions:function(e){var t={};r.ext(t,e);var l=t.columnDefs;t.columnDefs=[];for(var o=0;o<l.length;o++){var a=r.ext({},l[o]);delete a.__colScope__,t.columnDefs.push(a)}var t=JSON.stringify(t);r.writeLog(t)},getSumGroupHandlers:function(){return{sum:function(e,t){var r=parseFloat(e)||0,l=parseFloat(t);return isNaN(r)&&(r=0),isNaN(l)&&(l=0),r+l},count:function(e,t){var r=parseFloat(e)||0;return isNaN(r)&&(r=0),r+1},average:function(e,t){var r=parseFloat(e)||0,l=parseFloat(t);return isNaN(r)&&(r=0),isNaN(l)&&(l=0),(r+l)/2},max:function(e,t){return e>t?e:t},min:function(e,t){return t>e?e:t}}},defSumGrpValueFormatter:function(e,t){if(r.isStr(t))return t;var l="",o=r.strFormat("{0}",t),a=o.indexOf(".")>0?parseFloat(t).toFixed(2):parseInt(t),i=r.strFormat("{0}",a).split("."),n=i[0]||"0",s=i[1]||"",d=n.length%3,c=n.length>3?parseInt(n.length/3):0;if(3==n.length)l=n;else{for(var C=0;c>C;C++)l=r.strFormat("{0},{1}",n.substr(n.length-3*(C+1),3),l);l=d>0?r.strFormat("{0},{1}",n.substr(0,d),l):l,l=(l||"").substr(0,l.length-1)}return l=s?r.strFormat("{0}.{1}",l,s):l||n},uiTxtToClipboard:function(e,t){var l=e,o=function(e){r.isFunc(t)&&t(e)},a=r.isFunc(window.getSelection)?window.getSelection().toString():"";if(r.isEmpty(a)||(l=a),null==l||void 0==l)return o(""),!1;if(window.clipboardData&&window.clipboardData.setData){var i=clipboardData.setData("Text",l);return o(l),i}if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var n=document.createElement("textarea");n.textContent=l,n.style.position="fixed",document.body.appendChild(n),null!=l&&void 0!=l&&n.select();try{return r.isEmpty(l)?document.execCommand("copy",n):document.execCommand("copy")}catch(s){return r.writeLog("Copy to clipboard failed.",s),!1}finally{document.body.removeChild(n),o(l)}}},circleImeInputtingCheck:function(e,t){var l=e;l.__circleImeInputtingCheckHandler&&(r.clearNextTick(l.__circleImeInputtingCheckHandler),l.__circleImeInputtingCheckHandler=void 0),l.__circleImeInputtingCheckHandler=r.setNextTick(function(e){r.isImeInputting?r.circleImeInputtingCheck(e,t):r.isFunc(t)&&t.call(e,e),r.clearNextTick(e.__circleImeInputtingCheckHandler),e.__circleImeInputtingCheckHandler=void 0},700,l)}}}();return function(t){t.ext(t,{addColPosMapItem:function(e,t){return r.removeColPosMapItem(e,t),t[t.length]=e,t.length++,t.length},aheadInsColPosMapItem:function(e,t){r.removeColPosMapItem(e,t);for(var l=t.length-1;l>=0;l--)t[l+1]=t[l];return t[0]=e,t.length++,t.length},removeColPosMapItem:function(e,t){for(var r=t.length,l=0,o=!1,a=[],i=0;r>i;i++){var n=t[i]||{};n.field===e.field?(l=i,o=!0,delete t[i]):a.push(n),delete t[i]}for(var i=0;i<a.length;i++)t[i]=a[i];return t.length=a.length,t.length},getStrLenB:function(e){var t=r.getStrLenB.__regEx=r.getStrLenB.__regEx||/^[\u4e00-\u9fa5\uf900-\ufa2d]+$/,l=r.getStrLenB.__asciiEx=r.getStrLenB.__asciiEx||/[\x00-\xff]/g,o=e||"",a=o.length;if(o)if(t.test(o))a=2*o.length;else{var i=o.match(l),n=2*o.length-((i?i.length:0)||0);a=n}return a},getStrWidth:function(t,l){var o=0,a=t||"";if(a){l=r.getStrWidth.__font=l||r.getStrWidth.__font||e(document.body).css("font")||"normal 12px sans-serif";var i=r.getStrWidth.__tCanvas=r.getStrWidth.__tCanvas||document.createElement("canvas"),n=i.getContext("2d");n.font=l,o=n.measureText(a).width}return o}})}(l),function(l){l.ext(l,{isKBShift:function(e){var t=(e||window.event||{}).shiftKey;return 1===t||t===!0},isKBCtrl:function(e){var t=(e||window.event||{}).ctrlKey;return 1===t||t===!0},isKBAlt:function(e){var t=(e||window.event||{}).altKey;return 1===t||t===!0},getActiveEl:function(t){var l=null;try{l=document.activeElement||(document.documentElement?document.documentElement.activeElement:null)}catch(o){l=null}return r.isEmpty(t)||r.isEmpty(t.relatedTarget)||(l=t.relatedTarget),l=r.isEmpty(l)?null:e(l)},setBusy:function(t,r){var l={cursor:t?"progress":""};e(document.body).css(l),r&&e(r).css(l)},isClickInside:function(t,l){var o=!0,a=".kd-v-grid-popup",i=".kd-ignore-click",n=null===t?null:e(t).closest(l||a),s=null!==n&&n.length>0;return s||(s=e(t).hasClass(r.getClsNames(i))||e(i,t).length>0),o=s},isOutOfVw:function(e){var t=!1,r=e;if(r.rectChanging){var l=r.cacheRows*(r.defRowHeight+r.rowBorderHeight),o=r.cacheCols*r.defColWidth,a=Math.abs(r.vwX-r.lastVw.vwX),i=Math.abs(r.vwY-r.lastVw.vwY),n=Math.abs(r.width-r.lastVw.width),s=Math.abs(r.height-r.lastVw.height);t=a>o||n>o||i>l||s>l?!0:!1}else t=!0;return t},isOutOfScroll:function(e,t,l,o){var a=e.offset().top,i=a+e.height(),n=t.offset().top,s=n>a&&i>n;if(!s&&!r.isEmpty(l))switch(l){case"up":s=n>=i;break;case"down":s=a>=n}return r.isFunc(o)&&o(s),s},isMouseDraging:function(){return!!window.__isMousedraging},getPointer:function(e){var t=e||window.event||{},r=0,l=0;return t.pageX||t.pageY?(r=t.pageX,l=t.pageY):(t.clientX||t.clientY)&&(r=t.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,l=t.clientY+document.documentElement.scrollTop+document.body.scrollTop),{x:r,y:l}},getLineHeight:function(e){var t=r.strFormat("{0}px",.6*e);return t},getElPos:function(e){var t={x:0,y:0},l=e&&e.length>0?e[0]:e,o=r.isFunc(l.getBoundingClientRect)?l.getBoundingClientRect():{};return r.isEmpty(o)||(t.x=void 0===o.x?t.x:o.x,t.y=void 0===o.y?t.y:o.y),t},getEmptyHtmlTemplate:function(e,l,o){var a=o?.6:1,i=t.images[o?"queryDataTipsSrc":"emptyDataTipsSrc"],n=t.images[o?"queryDataTipsSrcSize":"emptyDataTipsSrcSize"]||{width:36,height:36},s=r.strFormat('<div class="kd-grid-nodata" style="width: 100%; display: block; padding-top: 46.594px;text-align:center;opacity: {0};">',a)+r.strFormat('<img style="height:{1}px;width:{2}px;" src="{0}">',l||i,n.height,n.width)+r.strFormat("<p>{0}</p>",e||t.KDVGrid[o?"queryData":"emptyData"])+"</div>";return s},getInputDelBtnTemplate:function(){var e=r.strFormat('<div><span class="kd-v-grid-iconfonts kd-v-grid-inpdel-icon"></span></div>');return e}})}(l),function(e){e.ext(e,{addColPosMapArrItem:function(e,t){e&&(r.removeColPosMapArrItem(e,t),t.push(e))},removeColPosMapArrItem:function(e,t){var l=(t||[]).length,o=-1,a=!1;if(!e)return exist;for(var i=0;l>i;i++){var n=t[i]||{};if(n.field===e.field){o=i,a=!0;break}}return o>=0&&(t.splice(o,1),r.removeColPosMapArrItem(e,t)),a}})}(l),function(e){e.ext(e,{compareVal2Str:function(e,t){var l=e||"";return r.isStr(l)||(l=l.display&&l.value?l.display+","+l.value:r.toStr(l||"")),t||(l=(l||"").toUpperCase()),l},comparerHandler:{containsIC:function(t,r){var l=!0,o=e.compareVal2Str(r);if(void 0!==o&&""!=o){var a=e.compareVal2Str(t);l=a.indexOf(o)>=0}return l},inIC:function(e,t){var l=!0;if(r.isStr(e)){var o=function(e,t){return r.equalsIC(t.display,e)||r.equalsIC(t.value,e)};if(r.isStr(t))l=r.comparerHandler.containsIC(e,t);else if(r.isArray(t))for(var a=0;a<t.length&&!(l=o(e,t[a]));a++);else l=o(e,t)}else{var i=function(e,t){var r=e.value==t.value&&(e.display||"")==(t.display||"");return r};if(r.isArray(t))for(var a=0;a<t.length&&!(l=i(e,t[a]));a++);else l=i(e,t)}return l},equalsIC:function(e,t){var l=r.equalsIC(e,t);return l}}})}(l),function(e){e.ext(e,{aggregateFuncs:{getName:function(r,l){if(!r)return"";var o=r||" ",a=t.AggrFuncNames[o]||"";return l&&(a=e.strFormat(l,a)),a},sum:function(e,t){var r=t||0,l=e;return r+=l},min:function(e,t){var r=t,l=e;return r=l>r?r:l},max:function(e,t){var r=t,l=e;return r=r>l?r:l},avg:function(e,t){var r=t||0,l=e;return r=(r+l)/2},count:function(e,t){var r=t+1;return r},first:function(e,t){return t},last:function(e,t){return t}}})}(l),function(e){e.ext(e,{debug_invokeDebrisRun:function(e,t){var l=e||106,o=t||10,a={total:l,pageSize:o,onBeforePage:function(e,t){r.writeLog(r.strFormat("debug_invokePagesRun.onBeforePage({0})",t))},onEach:function(e,t){t%o==o-1&&r.writeLog(r.strFormat("debug_invokePagesRun.onEach({0})",t))},onAfterPage:function(e,t){r.writeLog(r.strFormat("debug_invokePagesRun.onAfterPage({0})\r\n",t))},onComplete:function(e,t){r.writeLog(r.strFormat("debug_invokePagesRun.onComplete({0})",t))}};return r.invokeDebrisRun(a,this)},getDebrisRunHandle:function(e){var t=r.invokeDebrisRun,l=t[e||"default"];return l},invokeDebrisRun:function(e,t){function l(e,r){return 0>=e?void(u&&u(t)):void(i[f]=g(function(){h(i[f]),delete i[f],d&&d(t,r);for(var o=0;s>o&&!(0>=e-o);o++)c&&c(t,r+o);C&&C(t,r+s-1);var a=e-s,n=r+s;l(a,n)}))}var o=e,a=o.jobName||r.guid["new"]("N"),i=r.invokeDebrisRun,n=o.total||0,s=o.pageSize||500,d=o.onBeforePage,c=o.onEach,C=o.onAfterPage,u=o.onComplete,f=r.strFormat("{0}_{1}_{2}",n,s,a),p=(parseInt(n/s)+(n%s>0?1:0),0),g=r.getSetTickFrame(),h=r.getCancelTickFrame();return l(n,p),f},invokePagesRun_For:function(e,t){function l(e,l,o){var a=r.strFormat("{0}_{1}_{2}",e,l,o);i[a]=p(function(){if(g(i[a]),o>=l)return void(u&&u(t));d&&d(t,o);for(var e=0;s>e;e++){var r=o+e;if(r>=l){u&&u(t);break}c&&c(t,r)}C&&C(t,o+s-1)})}for(var o=e,a=o.jobName||r.guid["new"]("N"),i=r.invokePagesRun_For,n=o.total||0,s=o.pageSize||500,d=o.onBeforePage,c=o.onEach,C=o.onAfterPage,u=o.onComplete,f=parseInt(n/s)+(n%s>0?1:0),p=r.getSetTickFrame(),g=r.getCancelTickFrame(),h=0;f>=h;h++){var v=h*s;r.writeLog(r.strFormat("invokePagesRun.for=({0})",v)),l(a,n,v)}},invokePagesRun_LoopIn:function(e,t){function l(e,o){return 0>=e?void(u&&u(t)):void(i[f]=r.setNextTick(function(){r.clearNextTick(i[f]),d&&d(t,o);for(var a=0;s>a&&!(0>=e-a);a++)c&&c(t,o+a);C&&C(t,o+s-1),l(e-s,o+s)}))}var o=e,a=o.jobName||r.guid["new"]("N"),i=r.invokePagesRun_LoopIn,n=o.total||0,s=o.pageSize||500,d=o.onBeforePage,c=o.onEach,C=o.onAfterPage,u=o.onComplete,f=r.strFormat("{0}_{1}_{2}",a,n,s),p=(parseInt(n/s)+(n%s>0?1:0),0);l(n,p)}})}(l),l}();!function(e){function t(e,t){if(t=t.replace(/\{|\(|\)|\}|-/g,""),t=t.toLowerCase(),32!=t.length||-1!=t.search(/[^0-9,a-f]/i))r(e);else for(var l=0;l<t.length;l++)e.push(t[l])}function r(e){for(var t=32;t--;)e.push("0")}function l(e,t){switch(t){case"N":return e.toString().replace(/,/g,"");case"D":var r=e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20,32);return r=r.replace(/,/g,"");case"B":var r=l(e,"D");return r="{"+r+"}";case"P":var r=l(e,"D");return r="("+r+")";default:return new o}}var o=e.guid=function(e){var l=this.arr=new Array;"string"==typeof e?t(l,e):r(l)};o["new"]=function(e){for(var t="",r=32;r--;)t+=Math.floor(16*Math.random()).toString(16);var l=new o(t);return e?l.ToString(e):l},o.prototype={IsGuid:function(){},Equals:function(e){return e&&e.IsGuid?this.ToString()==e.ToString():!1},ToString:function(e){var t=this.arr;return"string"==typeof e&&("N"==e||"D"==e||"B"==e||"P"==e)?l(t,e):l(t,"D")}}}(r),function(t){var r=function(e){window.__isMousedraging=!1},l=function(e){window.__isMousedraging=!0};e(document.body).off("mouseup",r).off("mousedown",l).on("mouseup",r).on("mousedown",l)}(r),function(e){e.KDVString=function(e){this._str="",this._sar=new Array,e&&this.append(e)},e.ext(e.KDVString.prototype,{append:function(e){this._str="",this._sar.push(e)},appendLine:function(e){this._str="",this._sar.push(e),this._sar.push("\r\n")},toString:function(t){return e.isEmpty(this._str)&&(this._str=this._sar.join(t||"")),this._str},equalStr:function(t){var r=e.isStr(t)?t:(t||"").toString(),l=this.toString()==r;return l},equal:function(e){var t=!0;if(this.length!=e.length)t=!1;else for(var r=0;r<this.length;r++)if(this[r]!=e[r]){t=!1;break}return t}})}(r),function(t){e(document.body).off("compositionstart").off("compositionend").on("compositionstart",function(){(t||{}).isImeInputting=!0}).on("compositionend",function(){(t||{}).isImeInputting=!1})}(r)}(jQuery),function(e){!function(){var e=window.KDVGridHelper,t=window.KDVXDataTransfer=function(){};e.ext(t.prototype,{setData:function(e,t){var r=this;e&&t&&(r.store=r.store||{},r.store[e]=t)},getData:function(e){var t=this,r=void 0;return e&&t.store&&(r=t.store[e]),r},clearData:function(e){var t=this;e&&t.store&&delete t.store[e]}})}()}(jQuery),function(e){var t="KDVListView",r=window.KDVGridHelper,l=window.KDVXReses,o=t,a={CONSTVARS:{C_DEF_PAGESIZE:50,C_DataUiidKey:"data-uiid",C_DIV:"<div>",C_SPAN:"<span>",C_INPUT:"<input>",C_RenderListViewHandle:"__renderOnce_listView_handle",C_ListViewCls:".kd-v-listview",C_ListViewTopCls:".kd-v-listview-top",C_ListViewFilterCls:".kd-v-listview-filter",C_ListViewFilterInpCls:".kd-v-listview-filter-input",C_ListViewCenterCls:".kd-v-listview-center",C_ListViewBottomCls:".kd-v-listview-bottom",C_ListViewTipsCls:".kd-v-listview-tips",C_ItemPanelCls:".kd-v-listview-itempanel",C_UpMoreCls:".kd-v-listview-item-upmore",C_DnMoreCls:".kd-v-listview-item-dnmore",C_ItemCls:".kd-v-listview-item",C_ItemSelCls:".kd-v-listview-item-sel",C_ItemHalfSelCls:".kd-v-listview-item-half-sel",C_ChkCls:".kd-v-chk-lbl",C_ItemTxtCls:".kd-v-item-txt",C_BottomHolderCls:".kd-v-bottom-holder",C_ColInputDelBtnCls:".kd-v-grid-inpdel",C_Click:r.strFormat("click.{0}",o),C_Change:r.strFormat("keyup.{0}",o),C_Focus:r.strFormat("focus.{0}",o),C_Scroll:r.strFormat("scroll.{0}",o)}},i=a.CONSTVARS;window.KDVListView=function(e,t){var l=this;l.uiid=r.getUiid(l),l.element=t,l.setOptions(e)},r.ext(a,{initViewOptions:function(){var e=this,t=e.options,l=e.viewOptions=r.ext({pageSize:i.C_DEF_PAGESIZE,filterInputText:""},t,{selected:t.selected||{},currentY:t.currentY||0,combined:t.combined});l.listStoreMap=l.listStore,r.isEmpty(l.filterInputText)||a.filterByText.call(e,l.filterInputText)},invokeRender:function(t,l){var o=this,n=o.element,s=o.options,d=s.field||"",c=t||function(){e("input",n).trigger(i.C_Focus),r.writeLog(r.strFormat("KDVListView.invokeRender~render {0}",d))};r.isFunc(s.onRerender)?s.onRerender(c):a.invokeSelfRender.call(scope,c,l)},invokeSelfRender:function(e,t){var l=this;r.delayReferOnce(l,i.C_RenderListViewHandle,function(r){a.detachEvents.call(r),r.render.call(r,e,t)})},getRootElement:function(){var t=this,l=e(r.strFormat('[{0}="{1}"]',i.C_DataUiidKey,t.uiid));return l},updateRowStateAll:function(o,n){var s=this,d=s.viewOptions,c=d.selected,C=o?"addClass":"removeClass";e(i.C_ListViewTipsCls,n).text(r.strFormat(l[t].multiSelTips||"",c.count||0)),e(r.strFormat("{0} {1}",i.C_ListViewCenterCls,i.C_ItemCls),n)[C](r.getClsNames(i.C_ItemSelCls)),a.updateAllRowState.call(s)},updateRowState:function(o,n,s){var d=this,c=d.viewOptions,C=(c.listStore,c.selected),u=c.multiCheck;u||e(i.C_ItemCls).removeClass(r.getClsNames(i.C_ItemSelCls));var f=n?"addClass":"removeClass";e(r.strFormat('{0}[data-key="{1}"]',i.C_ItemCls,o),s)[f](r.getClsNames(i.C_ItemSelCls)),e(i.C_ListViewTipsCls,s).text(r.strFormat(l[t].multiSelTips||"",C.count||0)),a.updateAllRowState.call(d)},updateAllRowState:function(t){var l=this,o=e(r.strFormat("{0} {1}",i.C_ListViewTopCls,i.C_ItemCls),t).removeClass(r.getClsNames(i.C_ItemSelCls)).removeClass(r.getClsNames(i.C_ItemHalfSelCls)),n=a.getAllStateCls.call(l);switch(n){case"all":o.addClass(r.getClsNames(i.C_ItemSelCls));break;case"half":o.addClass(r.getClsNames(i.C_ItemHalfSelCls))}},getAllStateCls:function(){var e=this,t=e.viewOptions,r=t.listStore,l=t.selected,o=l.count||0,a=r.length,i="";return i=o==a&&a>0?"all":0==o||0==a?"":"half"},attachEvents:function(t){var l=this,o=(l.options,"delegate");t.attachVDomEvents(t,i.C_Click,function(e){a.itemClick.call(l,e)},o,i.C_ItemCls),t.attachVDomEvents(t,i.C_Change,function(e){a.filterInputChange.call(l,e)},o,i.C_ListViewFilterInpCls),t.attachVDomEvents(t,i.C_Click,function(e){a.inputDelBtnClick.call(l,e)},o,i.C_ColInputDelBtnCls);var n=function(e){r.delayReferOnce(l,"KDVListView.C_Scroll",function(t){r.isMouseDraging()?n(e):a.containerScroll.call(t,e)},5)};t.attachVDomEvents(e(i.C_ListViewCenterCls,t),i.C_Scroll,n),l.eventHandlers=t.eventHandlers},detachEvents:function(e){var t=this,e=e||t.element;e&&e.detachVDomEvents()},buildItem:function(o,a){var n=this,s=n.options,d=n.viewOptions,c=d.padingTop||0,C=d.multiCheck,u=d.rowHeight,f=d.selected,p=o,g=p[s.keyField],h=p.display,v=r.isStr(g)?g:g+1,w=r.strFormat("{0}# {1}",v,h),_=e(i.C_DIV).addClass(r.getClsNames(i.C_ItemCls)).css({top:0>a?0:a*u+c,height:u,lineHeight:r.strFormat("{0}px",u-5)}).attr({"data-key":g,title:w}),m={};C&&(e("<lable>").addClass(r.getClsNames(i.C_ChkCls)).appendTo(_),m={paddingLeft:"21px"}),h||(h=l[t].defaultNullItem||""),e("<span>").addClass(r.getClsNames(i.C_ItemTxtCls)).text(h).css(m).appendTo(_),g>=0&&(f[g]?_.addClass(r.getClsNames(i.C_ItemSelCls)):_.removeClass(r.getClsNames(i.C_ItemSelCls)));var V=_;return V},filterByText:function(e){for(var t=this,l=t.options,o=t.viewOptions,a=o.listStore,i=o.selected,n=a.length,s=o.listStoreMap=[],d=o.filterInputText=e||"",c=0;n>c;c++){var C=a[c],u=C[l.keyField],f=C.display+"";delete i[u],r.comparerHandler.containsIC(f,d)&&(s.push(C),i[u]=!0)}i.count=s.length}}),r.ext(a,{itemClick:function(t){var l=this,o=e(t.currentTarget),i=a.getRootElement.call(l),n=r.getData(o),s=n.key,d=l.viewOptions,c=d.listStoreMap,C=d.selected,u=C.count||0,f=C[s],p=-1==s;if(p){var g=a.getAllStateCls.call(l);if("all"==g)delete C[s],u=0,d.selected={};else{C[s]=!0,u=c.length;for(var h=0;h<c.length;h++)d.selected[h]=!0}}else f?(delete C[s],u--):(u++,C[s]=!0);f=C[s],C.count=u,p?a.updateRowStateAll.call(l,f,i):a.updateRowState.call(l,s,f,i)},containerScroll:function(t){var l=this,o=t.target,n=(l.options,l.viewOptions),s=a.getRootElement.call(l),d=e(i.C_UpMoreCls,s),c=e(i.C_DnMoreCls,s);n.currentY=(o||{}).scrollTop||0;var C=d.length>0&&r.isOutOfScroll(s,d,"up")||c.length>0&&r.isOutOfScroll(s,c,"down");C&&a.invokeSelfRender.call(l)},filterInputChange:function(t){t.stopPropagation();var l=this,o=l.options,i=l.viewOptions||{},n=e(t.currentTarget),s=r.setNextTick(function(e){r.clearNextTick(s),r.circleImeInputtingCheck(l,function(e){var t=n.val();i.currentY=0,i.filterInputText=t,a.filterByText.call(e,t),a.invokeSelfRender.call(l),o.onFilterChange&&o.onFilterChange(t)})},100,l)},inputDelBtnClick:function(t){t.stopPropagation();var l=this,o=(l.viewOptions||{},e(t.currentTarget).closest(i.C_ListViewFilterCls)),a=r.getData(o),n=a.field;e("input",o).val("").trigger(i.C_Focus).trigger(i.C_Change),r.writeLogFormat("inputDelBtnClick - {0} = {1}",!1,n,"")}}),r.ext(KDVListView.prototype,{setOptions:function(e){var t=this,r=t.options=e;r.keyField=r.keyField||"index",r.listStore=r.listStore||[],a.initViewOptions.call(t),r.combined||t.render(function(){})},render:function(o){var n=this,s=n.options,d=n.viewOptions,c=d.height,C=d.rowHeight,u=d.padingTop||11,f=d.topHeight||C,p=d.bottomHeight||25,g=d.currentY||0,C=(d.multiCheck,d.rowHeight),h=d.listStoreMap,v=h.length,w=d.selected,_=d.pageSize||i.C_DEF_PAGESIZE;a.detachEvents.call(n);var m=n.element||e('[data-uiid="'+n.uiid+'"]'),V={};V[i.C_DataUiidKey]=n.uiid;var D=e(i.C_DIV).addClass(r.getClsNames(i.C_ListViewCls,s.classes)).attr(V);n.itemTop=e(i.C_DIV).addClass(r.getClsNames(i.C_ListViewTopCls)).appendTo(D),n.itemFilter=e(i.C_DIV).addClass(r.getClsNames(i.C_ListViewFilterCls)).appendTo(D),n.itemContainer=e(i.C_DIV).addClass(r.getClsNames(i.C_ListViewCenterCls)).css({height:c-u-f-p}).appendTo(D),n.itemPanel=e(i.C_DIV).addClass(r.getClsNames(i.C_ItemPanelCls)).css({height:v*C}).appendTo(n.itemContainer),n.itemBottom=e(i.C_DIV).addClass(r.getClsNames(i.C_ListViewBottomCls)).appendTo(D),e(i.C_SPAN).addClass(r.getClsNames(i.C_ListViewTipsCls)).text(r.strFormat(l[t].multiSelTips||"",w.count||0)).appendTo(n.itemBottom),n.itemPanel.append(e(i.C_DIV).addClass(r.getClsNames(i.C_BottomHolderCls))),a.attachEvents.call(n,D);var y=Math.floor((u>g?0:g-u)/C),F=y>0,S=y+_>v?v:y+_,R=v>S;F&&(n.upmore=e(i.C_DIV).addClass(r.getClsNames(i.C_UpMoreCls)).css({top:y*C+u-2}).appendTo(n.itemPanel));var I=a.getAllStateCls.call(n),x="all"==I?i.C_ItemSelCls:"half"==I?i.C_ItemHalfSelCls:"",G={display:l[t].defaultAllItem||"",value:"all"};G[s.keyField]=-1;var k=a.buildItem.call(n,G,0).css({position:"relative",backgroundColor:"white"}).addClass(r.getClsNames(x));k.appendTo(n.itemTop);var M=e(i.C_DIV).css({display:"flex"}),T=d.filterInputText||"";e(i.C_INPUT).val(T).attr({placeholder:l[t].searching}).addClass(r.getClsNames(i.C_ListViewFilterInpCls)).appendTo(M);r.isEmpty(T)?void 0:e(r.getInputDelBtnTemplate()).addClass(r.getClsNames(i.C_ColInputDelBtnCls)).appendTo(M);M.appendTo(n.itemFilter);for(var H=y;S>H;H++){var O=h[H],b=(O[s.keyField],a.buildItem.call(n,O,H));b.appendTo(n.itemPanel)}if(R&&(n.dnmore=e(i.C_DIV).addClass(r.getClsNames(i.C_DnMoreCls)).css({top:S*C+u+2}).appendTo(n.itemPanel)),!d.combined&&m){var P=n.currentVDom=D.buildVDom();m.renderVDom(P)}else d.combined=!1;return r.isFunc(o)&&o(),D},getEventHandlers:function(){var e=this,t={};return r.ext(t,e.eventHandlers),t},clearSelected:function(){var e=this,t=e.viewOptions;delete t.selected},getSelected:function(){var e=this,t=e.viewOptions,r=t.selected||{count:0};return r},getFilterInputText:function(){var e=this,t=e.viewOptions;
return t.filterInputText||""},setFilterInputText:function(e){a.filterByText.call(self,e),a.invokeRender.call(self)},getCurrentY:function(){var e=this,t=e.viewOptions,r=t.currentY;return r},destroy:function(){var e=this,t=e.element;a.detachEvents.call(e),t&&t.releaseEl("KDVListView destroy")}})}(jQuery),function(e){var t="KDVGridColFilter",r=window.KDVGridHelper,l=window.KDVXReses,o=t,a={CONSTVARS:{C_MaxHeight:360,C_DataUiidKey:"data-uiid",C_DIV:"<div>",C_RenderGridFilterHandle:"__renderOnce_GridFilter_handle",C_AttachEventsVGridFilterHandle:"__attachEventsOnce_VGridFilter_handle",C_VGrid_Popup:".kd-v-grid-popup",C_Filter_Popup:".kd-v-filter-popup",C_Col_Filter:".kd-v-colfilter",C_Col_Filter_Bottom:".kd-v-colfilter-bottom",C_Col_Filter_Center:".kd-v-colfilter-center",C_FilterButton:".kd-v-colfilter-btn",C_Click:r.strFormat("click.{0}",o)}},i=a.CONSTVARS;window.KDVPopupList=window.KDVGridColFilter=function(t,l){var o=this;o.uiid=r.getUiid(o);var n=r.ext(o,KDVGridColFilter.prototype,t);return n.baseCssOpts={},n.setOptions(t),KDVGridColFilter.outClickAttached||(KDVGridColFilter.outClickAttached=!0,e(document.body).off(i.C_Click).on(i.C_Click,function(t){var l=e(t.target),o=r.isClickInside(l,i.C_Filter_Popup);o||a.hideAll()})),n},KDVPopupList.hideAll=KDVGridColFilter.hideAll=function(){e(i.C_Filter_Popup).hide()},r.ext(a,{hideAll:function(){KDVPopupList.hideAll()},initViewOptions:function(){var e=this,t=e.options,l={values:t.values||{},selected:{}},o=e.viewOptions=r.ext(e.viewOptions||l,t||l),a=void 0===o.isSort?!0:o.isSort,i=o.itemsSource,n=o.values||{},s=n.value||[],d=r.isEmpty(n);a&&i.sort(function(e,t){return r.sortComparer(e.value,t.value,"asc")});for(var c=0;c<i.length;c++)i[c].index=c;for(var C=0,u=function(e,t){var r=e.value==t.value&&(e.display||"")==(t.display||"");return r},c=0;c<i.length;c++){var f=i[c];if(d)o.selected[f.index]=!0,C++;else for(var p=0;p<s.length;p++)if(u(f,s[p])){o.selected[f.index]=!0,C++;break}}o.selected.count=C},invokeRender:function(e,t){var l=this,o=l.options.field;r.delayReferOnce(l,i.C_RenderGridFilterHandle,function(l){l.render.call(l,function(){r.writeLog(r.strFormat("KDVGridFilter.invokeRender~render {0}",o)),r.isFunc(e)&&e()},t)})},attachEvents:function(e){var t=this;t.options;e.attachVDomEvents(e,i.C_Click,function(e){a.buttonClick.call(t,e)},"",i.C_FilterButton),t.eventHandlers=e.eventHandlers},detachEvents:function(e){e.detachVDomEvents()}}),r.ext(a,{buttonClick:function(t){var l=this,o=l.options,i=o.field,n=o.itemsSource,s=l.viewOptions,d=e(t.currentTarget),c=r.getData(d),C=l.lstPxy;switch(c.opetype){case"clear":C.clearSelected.call(C),a.hideAll();break;case"reset":a.hideAll();break;case"ok":a.hideAll();break;case"reset":C.clearSelected.call(C),a.invokeRender.call(l)}var u=l.getSelectedData(),f=n&&(0==u.length||u.length==n.length),p=s.values=r.ext({},c,{type:"filtercolin",field:i,opetype:f?"clear":"reset"==c.opetype?c.opetype:r.isEmpty(u)?"clear":c.opetype,comparer:"in",value:u});o.eventCallback&&o.eventCallback(p,t),r.writeLog(r.strFormat("KDVGridFilter.buttonClick {0}",c.opetype))}});r.ext(KDVGridColFilter.prototype,{setOptions:function(e){var l=this;l.options=r.ext(l.options||{},e);a.initViewOptions.call(l),l.render(function(){r.writeLog(r.strFormat("{0}.setOptions {1}",t,e.field))})},render:function(o){var n=this,s=n.options,d=n.viewOptions,c="reset"==d.secBtnType,C=s.itemsSource,u=d.selected,f="",p=d.currentListY,g=30,h=30,v=25,w=d.popHeight=d.popHeight||(C.length+2)*g+h+v+8,_=d.filterHeight=d.filterHeight||(w>i.C_MaxHeight?i.C_MaxHeight:w),m=_-h,V=n.element,D=n.lstPxy,y={tabindex:-1};y[i.C_DataUiidKey]=n.uiid,void 0===n.element&&(V=n.element=e(i.C_DIV).attr(y).appendTo(e(document.body))),r.isEmpty(D)||(u=D.getSelected.call(D),f=D.getFilterInputText.call(D),p=D.getCurrentY.call(D)),a.hideAll.call(n),a.detachEvents.call(n,V),a.attachEvents.call(n,V);var F=e(i.C_DIV).addClass(r.getClsNames(d.themeCls||"",i.C_VGrid_Popup,i.C_Filter_Popup)).attr(y).css(r.ext({},s.offset,s.size,{height:_})).show(),S={multiCheck:!0,height:m,rowHeight:g,listStore:C,selected:u,filterInputText:f,currentY:p||0,classes:r.getClsNames(i.C_Col_Filter_Center),combined:!0,onRerender:function(e){a.invokeRender.call(n,e)},onFilterChange:function(){}};D=n.lstPxy,r.isEmpty(D)?D=n.lstPxy=new KDVListView(S):D.setOptions(S);var R=D.render();R.appendTo(F),n.ctElBottom=e(i.C_DIV).addClass(r.getClsNames(i.C_Col_Filter_Bottom)).css({height:h}).appendTo(F),e("<button>").addClass(r.getClsNames(i.C_FilterButton)).attr({"data-opetype":"ok"}).text(l[t].btnOK||"OK").appendTo(n.ctElBottom),e("<span>").text("    ").appendTo(n.ctElBottom),!c&&e("<button>").addClass(r.getClsNames(i.C_FilterButton)).attr({"data-opetype":"clear"}).text(l[t].btnClear||"clear").appendTo(n.ctElBottom),c&&e("<button>").addClass(r.getClsNames(i.C_FilterButton)).attr({"data-opetype":"reset"}).text(l[t].btnReset||"reset").appendTo(n.ctElBottom);var I=n.currentVDom=F.buildVDom.call(F);V.renderVDom(I);var x=D.getEventHandlers.call(D),G=n.getEventHandlers.call(n);r.delayReferOnce(V,i.C_AttachEventsVGridFilterHandle,function(e){e.attachVDomChildrenEvents(x),e.attachVDomChildrenEvents(G),r.isFunc(o)&&o()})},hide:function(){var e=this,t=e.element;t&&t.hide&&t.hide()},hideAll:function(){a.hideAll()},getEventHandlers:function(){var e=this,t={};return r.ext(t,e.eventHandlers),t},getSelected:function(){var e=this,t=e.viewOptions,r=e.lstPxy;r&&(t.selected=r.getSelected.call(r));var l=t.selected;return l},getSelectedData:function(){var e=this,t=[],r=e.viewOptions,l=r.itemsSource,o=e.getSelected();if(l.length!=o.count)for(var a in o){var i=l[a];i&&t.push(i)}else t=l;return t},destroy:function(){var l=this,o=l.element,a=l.lstPxy;KDVGridColFilter.outClickAttached&&(KDVGridColFilter.outClickAttached=!1,e(document.body).off(i.C_Click)),a&&a.destroy&&a.destroy.call(a),o&&o.releaseEl(r.strFormat("{0} destroy",t))}})}(jQuery),function(e){var t="KDVContextMenu",r=window.KDVGridHelper,l=(window.KDVXReses,t),o={CONSTVARS:{C_MaxHeight:280,C_DataUiidKey:"data-uiid",C_DIV:"<div>",C_SPAN:"<span>",C_AttachEventsVContextMenuHandle:"__attachEventsOnce_VContextMenu_handle",C_VGrid_Popup:".kd-v-grid-popup",C_Col_CtxMenu:".kd-v-ctxmenu",C_CtxMenu_Popup:".kd-v-ctxmenu-popup",C_Col_CtxMenu_Item:".kd-v-ctxmenu-item",C_CtxMenu_Title:".kd-v-ctxmenu-title",C_PACK_PROPS:["role","rowid","rowindex","field","valfield","isGridCell","isHeader","offset"],C_Click:r.strFormat("click.{0}",l)}},a=o.CONSTVARS;window.KDVContextMenu=function(t,l){var i=this;i.uiid=r.getUiid(i);var n=r.ext(i,KDVContextMenu.prototype,t);return n.baseCssOpts={},n.setOptions(t),KDVContextMenu.outClickAttached||(KDVContextMenu.outClickAttached=!0,e(document.body).click(function(t){var l=e(t.target),i=r.isClickInside(l,a.C_CtxMenu_Popup);i||o.hideAll()})),n},KDVContextMenu.hideAll=function(){e(a.C_CtxMenu_Popup).hide()},r.ext(o,{hideAll:function(){KDVContextMenu.hideAll()},closeSelf:function(){var e=this,t=r.strFormat("{0}_closeSelf",e.uiid||a.C_AttachEventsVContextMenuHandle);r.delayReferOnce(e,t,function(){o.hideAll.call(e),e.destroy&&e.destroy.call(e)},30)},initViewOptions:function(){var e=this,t=e.options;e.viewOptions=r.ext({},t,{selected:{}})},attachEvents:function(e){var t=this,r=(t.options,"delegate");e.attachVDomEvents(e,a.C_Click,function(e){o.handlerItemClick.call(t,e)},r,a.C_Col_CtxMenu_Item),t.eventHandlers=e.eventHandlers},detachEvents:function(e){e.detachVDomEvents()},handlerItemClick:function(t,l){var i=this,n=i.options;if(o.closeSelf.call(i),r.isFunc(n.itemClick)&&n.owner){var s=e(t.target).closest(a.C_Col_CtxMenu_Item).data()||{},d=e.extend({cellText:n.cellText,cmdKey:s.key},r.copyObject(n,a.C_PACK_PROPS));n.itemClick.call(n.owner,t,{scope:n.owner,data:d})}}});r.ext(KDVContextMenu.prototype,{setOptions:function(e){var l=this;l.options=r.ext(l.options||{},e);o.initViewOptions.call(l),l.render(function(){r.writeLog(r.strFormat("{0}.setOptions {1}",t,e.field))})},render:function(t){var l=this,i=l.options,n=l.viewOptions,s=i.items,d=30,c=s.length*d+8,C=(c>a.C_MaxHeight?a.C_MaxHeight:c,l.element),u={};u[a.C_DataUiidKey]=l.uiid,l.destroy(),o.hideAll.call(l),void 0===l.element&&(C=l.element=e(a.C_DIV).attr(u).appendTo(e(document.body))),o.attachEvents.call(l,C);for(var f=e(a.C_DIV).addClass(r.getClsNames(n.themeCls||"",a.C_VGrid_Popup,a.C_CtxMenu_Popup)).attr(u).css(r.ext({},i.offset,{})).show(),p=f,g=0;g<s.length;g++){var h=s[g],v=e(a.C_DIV).addClass(r.getClsNames(a.C_Col_CtxMenu_Item)).attr({"data-key":h.key,title:h.tooltip||h.text}).appendTo(p);e(a.C_SPAN).addClass(r.getClsNames(h.iconCls)).appendTo(v),e(a.C_SPAN).addClass(r.getClsNames(a.C_CtxMenu_Title)).appendTo(v).text(h.text)}var w=l.currentVDom=f.buildVDom.call(f);C.renderVDom(w);var _=l.getEventHandlers.call(l);r.delayReferOnce(C,a.C_AttachEventsVContextMenuHandle,function(e){e.attachVDomChildrenEvents(_)})},getEventHandlers:function(){var e=this,t={};return r.ext(t,e.eventHandlers),t},destroy:function(){var e=this,l=e.element;l&&o.detachEvents.call(e,l),l&&l.releaseEl(r.strFormat("{0} destroy",t)),e.element=void 0}})}(jQuery),function(e){var t="KDVFindWindow",r=window.KDVGridHelper,l=window.KDVXReses,o=t,a=function(){return{CONSTVARS:{C_MaxHeight:380,C_DataUiidKey:"data-uiid",C_SPAN:"<span>",C_DIV:"<div>",C_INPUT:"<input>",C_BUTTON:"<button>",C_RenderVFindWindowHandle:"__renderOnce_VFindWindow_handle",C_AttachEventsVFindWindowHandle:"__attachEventsOnce_VFindWindow_handle",C_VGridRootCls:".kd-v-grid-root",C_FindLocate_win:".kd-v-findlocate-win",C_FindLocate_Inp_CT:".kd-v-findlocate-inp-ct",C_FindLocate_Inp:".kd-v-findlocate-inp",C_FindLocate_Msg:".kd-v-findlocate-msg",C_FindLocate_Button:".kd-v-findlocate-btn",C_FindLocate_Title:".kd-v-findlocate-title",C_FindLocate_Acts:".kd-v-findlocate-title-acts",C_VGrid_IconfontsCls:".kd-v-grid-iconfonts",C_VGridIconClos:".kd-v-grid-i-close",C_VGrid_IconCls:".kd-v-grid-icon",C_Click:r.strFormat("click.{0}",o),C_Keydown:r.strFormat("keydown.{0}",o),C_DragStart:r.strFormat("dragstart.{0}",o),C_DropEnd:r.strFormat("dragend.{0}",o),C_Drag:r.strFormat("drag.{0}",o),C_DragEnter:r.strFormat("dragenter.{0}",o),C_DragOver:r.strFormat("dragover.{0}",o),C_Drop:r.strFormat("drop.{0}",o),C_DragLeave:r.strFormat("dragleave.{0}",o),C_MouseDown:r.strFormat("mousedown.{0}",o),C_MouseUp:r.strFormat("mouseup.{0}",o),C_MouseMove:r.strFormat("mousemove.{0}",o),C_MouseLeave:r.strFormat("mouseleave.{0}",o),C_Ope_Search:"search",C_Ope_Find:"find",C_Ope_Close:"close",C_Ope_Move:"move",C_Ope_DragDrop:"dragdrop"}}}(),i=a.CONSTVARS;window.KDVFindWindow=function(t,l){var o=this;o.uiid=r.getUiid(o);var n=r.ext(o,KDVFindWindow.prototype,t);return n.baseCssOpts={},n.setOptions(t),KDVFindWindow.outClickAttached||(KDVFindWindow.outClickAttached=!0,e(document.body).off(i.C_Click).on(i.C_Click,function(t){var l=e(t.target),o=r.isClickInside(l,i.C_FindLocate_win);o||a.hideAll()})),n},KDVFindWindow.hideAll=function(){e(i.C_FindLocate_win).hide()},r.ext(a,{getUiidPatern:function(e){var t=r.strFormat("[data-uiid={0}]",e);return t},getElement:function(){var t=this;return e(a.getUiidPatern(t.uiid))},getParentContainer:function(){var t=this,r=t.options,l=r.parentContainer||e(document.body);return l},initViewOptions:function(){var e=this,t=e.options;e.viewOptions=r.ext(e.viewOptions||{showed:!1,value:"",message:"",offset:{left:0,top:0},size:{width:280,height:80}},t)},getEventHandlers:function(){var e=this,t={};return r.ext(t,e.eventHandlers),t},attachEvents:function(e){var t=this;t.options;e.attachVDomEvents(e,i.C_Click,function(e){a.buttonClick.call(t,e)},"",i.C_FindLocate_Button),e.attachVDomEvents(e,i.C_Keydown,function(e){a.keydownHandler.call(t,e)},"",i.C_FindLocate_Inp),t.eventHandlers=e.eventHandlers},detachEvents:function(e){e&&e.detachVDomEvents()},invokeRender:function(e,t){var l=this;r.delayReferOnce(l,i.C_RenderVFindWindowHandle,function(l){l.render.call(l,function(){r.writeLog(r.strFormat("KDVFindWindow.invokeRender~render {0}","invokeRender")),r.isFunc(e)&&e()},t)})},show:function(){var e=this,t=a.getElement.call(e);t&&t.show&&(a.hideAll(),t.show(),a.detachGlobalEventHandlers_MovingPosition.call(e),a.attachGlobalEventHandlers_MovingPosition.call(e))},hideAll:function(){KDVFindWindow.hideAll()},hide:function(){var e=this,t=a.getElement.call(e);t&&t.hide&&t.hide(),a.detachGlobalEventHandlers_MovingPosition.call(e)}}),r.ext(a,{invokeCallback:function(t,l){var o=this,n=o.options,s=o.viewOptions,d=n.callback;s.message="",s.value=e(i.C_FindLocate_Inp,a.getElement.call(o)).val();var c=r.ext({type:t,value:s.value},l||{});r.isFunc(d)&&d(c)},buttonClick:function(t){var l=this,o=(l.options,l.viewOptions,e(t.currentTarget)),n=r.getData(o);switch(n.opetype){case i.C_Ope_Search:case i.C_Ope_Find:break;case i.C_Ope_Close:a.hide.call(l)}a.invokeCallback.call(l,n.opetype)},keydownHandler:function(e){var t=this,r=(t.options,t.viewOptions||{},e.keyCode||e.which||e.charCode);e.ctrlKey||e.metaKey,e.shiftKey;"13"==r&&(e.preventDefault(),a.invokeCallback.call(t,i.C_Ope_Find))}}),r.ext(a,{attachGlobalEventHandlers_MovingPosition:function(){var e=this,t=(e.options,e.viewOptions),r=a.getParentContainer.call(e),l=a.getElement.call(e),o=a.getUiidPatern(e.uiid);l.on(i.C_MouseDown,function(r){t.isMouseKeyPressing=!0,r.preventDefault(),r.stopPropagation(),a.handlerStartMove.call(e,r)}),l.on(i.C_MouseUp,function(e){e.preventDefault(),e.stopPropagation(),t.isMouseKeyPressing=!1}),l.on(i.C_MouseLeave,function(e){t.isMouseKeyPressing&&(e.preventDefault(),e.stopPropagation(),t.isMouseKeyPressing=!1)}),r.delegate(o,i.C_MouseMove,function(r){r.preventDefault(),r.stopPropagation(),t.isMouseKeyPressing&&a.handlerMoving.call(e,r)})},detachGlobalEventHandlers_MovingPosition:function(){var e=this,t=(e.options,a.getParentContainer.call(e)),r=a.getElement.call(e),l=a.getUiidPatern(e.uiid);r.off(i.C_MouseDown),r.off(i.C_MouseUp),r.off(i.C_MouseLeave),t.undelegate(l,i.C_MouseMove)},handlerStartMove:function(t){var r=this,l=(r.options,r.viewOptions,a.getParentContainer.call(r),t.originalEvent),o=(e(t.currentTarget),e(t.currentTarget),a.getElement.call(r)),i=o.offset(),n=l.clientX-Math.trunc(i.left,0),s=l.clientY-Math.trunc(i.top,0),d={"data-winoffsetleft":n,"data-winoffsettop":s};o.attr(d)},handlerMoving:function(t){var l=this,o=l.viewOptions,n=t.originalEvent,s=(e(t.currentTarget),e(t.currentTarget),a.getElement.call(l)),d=r.ext({},r.getData(s)),c={left:n.clientX-parseInt(d.winoffsetleft||0)||0,top:n.clientY-parseInt(d.winoffsettop||0)||0};if(!(c.left<=0||c.top<=0)){var C=o.offset||{},u=2;Math.abs(C.top-c.top)<u&&Math.abs(C.left-c.left)<u||(o.offset=c,s.css(c),a.invokeCallback.call(l,i.C_Ope_Move,{offset:c}),r.writeLog(r.toStr({ex:t.clientX,ey:t.clientY,ox:n.clientX,oy:n.clientY})))}},handlerEndMove:function(e){var t=this,l=t.options,o=t.viewOptions,i=l.positionChanged,n=a.getElement.call(t),s=n.offset(),d=r.ext({},s);o.offset=s,r.isFunc(i)&&i(d),r.writeLog(r.toStr(d))}});r.ext(KDVFindWindow.prototype,{setOptions:function(e){var l=this;l.options=r.ext(l.options||{},e);a.detachGlobalEventHandlers_MovingPosition.call(l),a.initViewOptions.call(l),l.render(function(){r.writeLog(r.strFormat("{0}.setOptions {1}",t,e.value)),a.attachGlobalEventHandlers_MovingPosition.call(l)})},render:function(t){var o=this,n=o.options,s=n.parentContainer,d=o.viewOptions,c={};c[i.C_DataUiidKey]=o.uiid;var C=void 0,u=r.ext({},d.size,d.offset||{}),f=e(i.C_DIV).addClass(r.getClsNames(d.themeCls||"",i.C_FindLocate_win)).attr(c).css(u).show(),p=e(i.C_DIV).addClass(r.getClsNames(i.C_FindLocate_Title)).appendTo(f),g=(e(i.C_SPAN).text(l.KDVFindWindow.title).appendTo(p),e(i.C_DIV).addClass(r.getClsNames(i.C_FindLocate_Acts)).appendTo(p)),h=e(i.C_DIV).attr({"data-opetype":"close"}).addClass(r.getClsNames(i.C_FindLocate_Button)).appendTo(g);e(i.C_SPAN).addClass(r.getClsNames(i.C_VGrid_IconfontsCls,i.C_VGridIconClos,i.C_VGrid_IconCls)).appendTo(h);var v=e(i.C_DIV).addClass(r.getClsNames(i.C_FindLocate_Inp_CT)).appendTo(f),w=(e(i.C_DIV).attr({"data-opetype":"find"}).addClass(r.getClsNames(i.C_FindLocate_Button)).text(l.KDVFindWindow.btnSearch).appendTo(v),e(i.C_INPUT).addClass(r.getClsNames(i.C_FindLocate_Inp)).attr({value:d.value||n.value,placeholder:l.KDVFindWindow.inpTxtHolder}).appendTo(v),e(i.C_DIV).addClass(r.getClsNames(i.C_FindLocate_Msg)).appendTo(f));e(i.C_SPAN).text(d.message||"").appendTo(w);if(n.isVRoot){var _=a.getElement.call(o);_.remove(),C=f,a.detachEvents.call(o,f),a.attachEvents.call(o,f),f.appendTo(s)}else if(a.hideAll(),C=a.getElement.call(o),0==C.length){C=e(i.C_DIV).attr(c).appendTo(s),a.attachEvents.call(o,C);var m=o.currentVDom=f.buildVDom.call(f);C.renderVDom(m)}else e(r.strFormat("{0} SPAN",i.C_FindLocate_Msg),C).text(d.message||""),C.show();var V=o.getEventHandlers.call(o);r.delayReferOnce(C,i.C_AttachEventsVFindWindowHandle,function(l){l.attachVDomChildrenEvents(V),r.isFunc(t)&&t();var n=a.getElement.call(o);e(i.C_FindLocate_Inp,n).focus().select()})},setMessage:function(t){var l=this,o=(l.options,l.viewOptions);o.message=t;var n=a.getElement.call(l);e(r.strFormat("{0} SPAN",i.C_FindLocate_Msg),n).text(o.message||""),a.invokeRender.call(l,function(){})},show:function(){var e=this;a.show.call(e)},hide:function(){var e=this;a.hide.call(e)},getEventHandlers:function(){var e=this,t={};return r.ext(t,e.eventHandlers),t},destroy:function(){var l=this,o=a.getElement.call(l);r.strFormat("{0} destroy",t);o&&o.length>0&&(a.detachEvents.call(l,o),o.remove&&o.remove()),KDVFindWindow.outClickAttached&&(KDVFindWindow.outClickAttached=!1,e(document.body).off(i.C_Click)),a.detachGlobalEventHandlers_MovingPosition.call(l)}})}(jQuery),function(e){var t=KDVGridHelper,r=(window.KDVXReses,{});"function"==typeof KDVGridConst&&KDVGridConst.call(this,e,r);var l=r.CONSTVARS;e.fn.KDVGrid=function(r){var l=t.ext(this,e.fn.KDVGrid.defaults,e.fn.KDVGrid.prototype,r);l.baseCssOpts={};var o=r.initSize;return t.isEmpty(o)||l.css(o),l.setOptions(r),l};r.KDVGridPrototype=e.fn.KDVGrid.prototype={setOptions:function(e){var o=this;e=e||{},e.bizOptionsChanged=!0,e.groupDefaultExpand=!1,r.releaseCtxMenu.call(o),r.detachGlobalEventHandlers.call(o),r.releaseFilters.call(o),r.releaseFindLocate.call(o),o.options=e,o.dataTransfer=new KDVXDataTransfer,r.initViewOptions.call(o),r.bulidHeaderMergedModel.call(o),r.attachGlobalEventHandlers.call(o),r.algorithmStrategyInvoke.call(o,function(e){t.writeLog("setOptions first render complete.")},l.OpeKeys.FilterData)},render:function(o,a){var i=this,n=i.viewOptions;n.rendering=!0,t.delayReferOnce(i,l.C_RenderHandle,function(l){var a=t.strFormat('[data-uiid="{0}"]',l.uiid),s=e(a),d=l.currentNode=(s.length>0?s:null)||l,c=d.parent();if(r.calcViewPort.call(l),t.isOutOfVw(n)||n.bizOptionsChanged){n.bizOptionsChanged=!1,r.detachRootElEvents.call(l);var C=r.getInnerEventCallback.call(l),u=l.currentVNode=r.buildVRootNode.call(l,C),f=l.currentVDom=u.buildVDom(l.eventHandlers);c.hide(),l.currentNode=d.renderVDom(f),c.show(),n.lastVw={vwX:n.vwX,vwY:n.vwY,height:n.height,width:n.width}}n.rendering=!1,o&&o.call(i,i)})},isRenewRender:function(){var e=this,t=e.viewOptions,r=t.paramsSetTs!=t.paramsRenderTs;return r},setRenewRender:function(e){var t=this,r=t.viewOptions;e?r.paramsSetTs=(new Date).valueOf():r.paramsRenderTs=r.paramsSetTs}};t.ext(r,{initViewOptions:function(){for(var e=this,o=e.options,a=o.columnDefs||[],i=o.rowData,n="__colScope__",s=[],d=0;d<a.length;d++){var c=a[d],C=c[n];delete c[n];var u=t.clone(c);t.eachProp(c,"",function(e,r){var l=r[e];t.isFunc(l)&&(u[e]=l)}),s.push(u),u[n]=C,c[n]=C}var f=e.viewOptions=e.viewOptions||function(){return{rectChanging:!1,bizOptionsChanged:!1,themeCls:l.C_VGrid_DefTheme_Cls,editable:!1,vwX:0,vwY:0,vwPortBorderHeight:1,showCellVBorder:!0,autoBalEqRatioColWidth:!0,height:0,width:0,lastVw:{vwX:0,vwY:0,height:0,width:0},scollbarWidth:t.isChrome()?10:17,totalWidth:0,leftPadWidth:0,rightPadWidth:0,cacheRows:5,cacheCols:3,colHeaderHeight:35,colFooterHeight:0,defRowHeight:27,rowSelection:l.C_MultiSel,selectRowBackground:"",showRowNum:!0,showColNum:!0,rowClickAsAppendSelect:!1,rowBorderHeight:1,rowHeight:{},defColWidth:200,colWidth:{},reservedHeight:60,reservedWidth:10,selectedRows:{},selectedRowCount:0,multiCellSelInfo:{},rowData:i,viewColDefs:[],viewColMaps:{},colMergedModel:{},viewRowDataMaps:[]||i,currentFocusCell:{field:"",rowIndex:0,rowId:0,isSelected:!0},components:{},displayTypeComponents:{},copyOrginalValue:!1}}();t.ext(f,{bizOptionsChanged:t.getValue(o,"bizOptionsChanged",f.bizOptionsChanged),themeCls:t.getValue(o,"themeCls",f.themeCls),editable:t.getValue(o,"editable",f.editable),reservedHeight:t.getValue(o,"reservedHeight",f.reservedHeight),reservedWidth:t.getValue(o,"reservedWidth",f.reservedWidth),showCellVBorder:t.getValue(o,"showCellVBorder",f.showCellVBorder),autoBalEqRatioColWidth:t.getValue(o,"autoBalEqRatioColWidth",f.autoBalEqRatioColWidth),cacheRows:t.getValue(o,"cacheRows",f.cacheRows),cacheCols:t.getValue(o,"cacheCols",f.cacheCols),defRowHeight:t.getValue(o,"rowHeight",f.defRowHeight),scollbarWidth:o.scollbarWidth||f.scollbarWidth,colFooterHeight:o.colFooterHeight||f.colFooterHeight,showRowNum:t.getValue(o,"showRowNum",f.showRowNum),showColNum:t.getValue(o,"showColNum",f.showColNum),rowSelection:t.getValue(o,"rowSelection",l.C_MultiSel),selectRowBackground:t.getValue(o,"selectRowBackground",f.selectRowBackground),rowClickAsAppendSelect:t.getValue(o,"rowClickAsAppendSelect",f.rowClickAsAppendSelect),selectedRows:t.getValue(o,"selectedRows",f.selectedRows),rowData:i,selectedRowCount:0,viewColDefs:s,viewRowDataMaps:i,viewColMaps:function(e){for(var t={},r=0;r<e.length;r++){var l=e[r];t[l.field]=l}return t}(s),colMergedModel:{isMerged:!1,maxLevel:1,viewColMerged:{},isIinitOriginaHeader:!1},copyOrginalValue:t.getValue(o,"copyOrginalValue",f.copyOrginalValue)});for(var p=0;p<i.length;p++){var g=i[p];void 0===g.rowIndex&&(g.rowIndex=p)}var h=0;for(var v in f.selectedRows)"length"!==v&&h++;f.selectedRowCount=h,f.selectedRows.length=h;var w=l.C_OptimizeRowLimit,_=l.C_OptimizeColLimit,m=(f.rowData||[]).length;if(m>0&&w>m){f.cacheRows=m;var V=(f.viewColDefs||[]).length;V>0&&_>V&&(f.cacheCols=V)}r.initViewOptions_Api.call(e,f),r.initViewOptions_DragDrop.call(e,f),r.initViewOptions_sort.call(e,f),r.initViewOptions_filter.call(e,f),r.initViewOptions_frozen.call(e,f),r.initViewOptions_Groups.call(e,f),r.initViewOptions_CellRender.call(e,f),r.initViewOptions_FindLocate.call(e,f),r.initViewOptions_Algorithm.call(e,f),r.calcBalEqRatioColWidth.call(e),o.bizOptionsChanged=!1},getViewRowDataMaps:function(){var e=this,t=e.viewOptions,l=t.viewRowDataMaps||[];return r.hasGroupBy.call(e)&&(l=t.viewRowGroupDataMaps||[]),l},buildVRootNode:function(o){var a=this,i=a.viewOptions,n=i.themeCls||"",s=a.isSingleSelection(),d=s?l.C_VGridSingleSelModeCls:"",c=a.currentNode,C={"data-isRoot":!0,tabindex:-1};C[l.C_DataUiidKey]=(t.getData(c)||{}).uiid;var u=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridCls,l.C_VGridRootCls,n,d)).attr(C);r.attachRootElEvents.call(a,u),a.leftPad=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridLeftPadCls)).css({width:i.leftPadWidth}).appendTo(u);a.centerPad=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridCenterPadCls)).appendTo(u);return a.rightPad=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridRightPadCls)).css({width:i.rightPadWidth}).appendTo(u),r.buildVLeftPad.call(a,u,o),r.buildVCenterPad.call(a,u,o),r.buildFindLocateWindow.call(a,u,o),u},attachInnerElEvents:function(e,t,r){var l=this;l.attachVDomEvents(e,t,r)},releaseCtxMenu:function(){var e=this,r=e.viewOptions;try{var l=r.contextMenus=r.contextMenus||{};for(var o in l){var a=l[o];a&&a.destroy&&a.destroy.call(a)}}catch(i){t.writeLogFormat("KDVGrid releaseCtxMenu {0}",!1,i.message)}}}),t.ext(r,{buildRowSelector:function(e,r,o,a){var i=this,n=i.viewOptions,s=n.showRowNum,d=n.selectedRows,c=d[r],C=-1==r?"#":r,u=c?t.getClsNames(l.C_VGridChkSelCls):"",f=s?t.strFormat('<span class="kd-v-grid-sel-seq">{0}</span>',C):"",p=a?t.strFormat('<label class="{0}" for=":before"></label>',t.getClsNames(l.C_VGridChkCls,o,u)):"",g=t.strFormat('<span class="kd-v-grid-sel-ct">{0}{1}</span>',p,f);return g},getHeaderCheckNextOpeType:function(){var e=this,t=(e.options,e.viewOptions||{}),r=t.rowData||[],l="";return l=t.selectedRowCount==r.length?"clear":"all"},getRowSelectedColHeaderCls:function(){var e=this,r="",o=(e.options,e.viewOptions||{}),a=o.rowData||[],i=0===o.selectedRowCount?"clear":o.selectedRowCount!==a.length?"half":"";return t.equalsIC(i,"half")?r=t.getClsNames(l.C_VGridChkHalfSelCls):t.equalsIC(i,"clear")||(r=t.getClsNames(l.C_VGridChkSelCls)),r},setSelectedRows:function(e,r,o){var a=this,i=(a.options,t.equalsIC(o,"all")||t.equalsIC(o,"clear")),n=t.equalsIC(o,"all"),s=a.viewOptions||{},d=s.rowData||[];if(t.equalsIC(o,l.C_SingleSel))s.selectedRows={},s.selectedRows[e]=!0,s.selectedRowCount=1;else if(i){var c=s.selectedRows={};n?s.selectedRowCount=d.length:s.selectedRowCount-=d.length;for(var C=0;C<d.length;C++){var u=d[C].rowId;void 0!=u&&(n?c[u]=!0:delete c[u])}}else{var c=s.selectedRows=s.selectedRows||{};c[e]=r,c[e]===!1?(delete c[e],s.selectedRowCount--):s.selectedRowCount++}},updateRowSelectUIState:function(o){var a=this;t.delayReferOnce(a,l.C_RenderHandle,function(i){var n=(i.options,i.viewOptions||{}),s=n.selectRowBackground||"",d=!!s,c=o.targetEl,C=(t.getData(c),n.selectedRows=n.selectedRows||{}),u=t.getClsNames(l.C_VGridRowSelCls);d&&e(l.C_VGridRowSelCls,i).css({background:""}),e(l.C_VGridRowSelCls,i).removeClass(u),e(l.C_VGridChkSelCls,i).removeClass(t.getClsNames(l.C_VGridChkSelCls)),e(l.C_RowSelector,i).each(function(r,l){var o=t.getData(l);C[o.rowid]&&e(l).addClass(u)}),d&&e(l.C_VGridRowSelCls,i).css({background:s});var f=t.strFormat("{0} label{1}",l.C_FrozenLeftRowHeaderChkerSelector,l.C_VGridChkCls),p=e(f,i).removeClass(t.getClsNames(l.C_VGridChkSelCls,l.C_VGridChkHalfSelCls)),g=r.getRowSelectedColHeaderCls.call(i);p.addClass(g);var h=t.strFormat("{0} {1} label{2}",l.C_FrozenLeftRowSelector,l.C_SelCell_Selector,l.C_VGridChkCls);e(h,i).each(function(r,o){var a=e(o).closest(l.C_FrozenLeftRowSelector),i=t.getData(a);C[i.rowid]&&e(o).addClass(t.getClsNames(l.C_VGridChkSelCls))}),r.updateRowSelectLeftPadUIState.call(a,o)},20)},updateRowSelectLeftPadUIState:function(o){var a=this,i=a,n=(i.options,i.viewOptions||{}),s=o.targetEl,d=(t.getData(s),n.selectedRows=n.selectedRows||{}),c=t.getClsNames(l.C_VGridRowSelCls),C=t.strFormat("{0} label{1}",l.C_LeftPadRowHeaderChkerSelector,l.C_VGridChkCls),u=e(C,i).removeClass(t.getClsNames(l.C_VGridChkSelCls,l.C_VGridChkHalfSelCls)),f=r.getRowSelectedColHeaderCls.call(i);u.addClass(f),e(l.C_LeftRowSelector,i).each(function(r,l){var o=t.getData(l);d[o.rowid]&&e(l).addClass(c)});var p=t.strFormat("{0} {1} label{2}",l.C_LeftRowSelector,l.C_SelCell_Selector,l.C_VGridChkCls);e(p,i).each(function(r,o){var a=e(o).closest(l.C_LeftRowSelector),i=t.getData(a);d[i.rowid]&&e(o).addClass(t.getClsNames(l.C_VGridChkSelCls))})},refreshView:function(e){var t=this;r.delayRecalcViewPort.call(t,e,l.OpeKeys.DataUpdate)},delayRecalcViewPort:function(e,r){var o=this;t.delayReferOnce(o,l.C_CalcViewHandle,function(t){t.render.call(t,e,r)},l.C_DelayCalc)},calcViewPortColXs:function(e,t,r){for(var o=this,a=(o.options,o.viewOptions),i=a.defColWidth,n=a.vwX,s=a.reservedWidth,d=a.cacheCols,c=t==l.C_Area_CenterView,C=!c,u=t==l.C_Area_LeftView,f=u,p=f?a.frozenLeftWidth:0,g=f?p:0,h=0,v=C?g:-1*n,w=0,_=0,m=-1,V=r||0,D=void 0===r?-1*d*i:r,y=a.width-D,F={},S=!1,R=0;R<e.length;R++){var I=e[R],x=o.getColWidth(I.field,t),G=v||0;if(h+=x,v+=x,(v>=D&&D>=G||0==R)&&(w=G,_=R),F[I.field]=h-x+V,(v>=y||R==e.length-1)&&(S||(m=R,S=!0),!c))break;G=v}return{fcoX:w,starColIdx:_,endColIdx:m,colXs:F,totalWidth:h+s}},calcViewPortRowYs:function(e,t){for(var r=this,l=(r.options,r.viewOptions),o=l.rowBorderHeight,a=l.cacheRows,i=l.defRowHeight,n=l.rowHeight||{},s=l.vwY,d={},c=0,C=-1*s,u=0,f=0,p=-1,g=-1*a*i,h=l.height-g,v=0;v<e.length;v++){var w=e[v].rowId,_=(n[w]||i)+o,m=C||0;if(c+=_,C+=_,(C>=g&&g>=m||0==v)&&(u=m,f=v,d.calcing=!0),d.calcing&&(d[w]=c-_),C>=h||v==e.length-1){p=v,delete d.calcing;break}m=C}return{fcoY:u,starRowIdx:f,endRowIdx:p,rowYs:d}},calcViewPortNormal:function(){var e=e||l.C_Area_CenterView,o=this,a=(o.options,o.viewOptions),i=o.getViewColumns(e),n=r.getViewRowDataMaps.call(o),s=a.rowBorderHeight,d=a.colMergedModel||{},c=d.maxLevel||1,C=a.colHeaderHeight+s,u=a.scollbarWidth+s,f=a.vwX,p=a.vwY;t.ext(a,{width:o.width.call(o),height:o.height.call(o)-C*c-u});var g=r.calcViewPortColXs.call(o,i,e),h=r.calcViewPortRowYs.call(o,n,e),v={vwX:f,vwY:p,firstCellOffset:{x:g.fcoX,y:h.fcoY},startCell:{colIdx:g.starColIdx,rowIdx:h.starRowIdx},endCell:{colIdx:g.endColIdx,rowIdx:h.endRowIdx},colXs:g.colXs,rowYs:h.rowYs},w=a.calcViewOpts||{};w[e]=v;var _=a.frozenLeftWidth||0,m=a.leftFrozenColPosMaps,V=r.calcViewPortColXs.call(o,m,l.C_Area_LeftView,_),D={vwX:f,vwY:p,firstCellOffset:{x:V.fcoX,y:h.fcoY},startCell:{colIdx:V.starColIdx,rowIdx:h.starRowIdx},endCell:{colIdx:V.endColIdx,rowIdx:h.endRowIdx},rowYs:h.rowYs,colXs:V.colXs};w[l.C_Area_LeftView]=D;var y=a.frozenRightWidth||0,F=a.rightFrozenColPosMaps,V=r.calcViewPortColXs.call(o,F,l.C_Area_RightView,y),S={vwX:f,vwY:p,firstCellOffset:{x:V.fcoX,y:h.fcoY},startCell:{colIdx:V.starColIdx,rowIdx:h.starRowIdx},endCell:{colIdx:V.endColIdx,rowIdx:h.endRowIdx},rowYs:h.rowYs,colXs:V.colXs};w[l.C_Area_RightView]=S,t.ext(a,{calcViewOpts:w})},calcViewPort:function(){var e=this;r.hasGroupBy.call(e)?r.calcViewPortGroup.call(e):r.calcViewPortNormal.call(e)},calcBalEqRatioColWidth:function(e){var t=this,r=(t.options,t.viewOptions||{});if(r.autoBalEqRatioColWidth||e){for(var l=r.colWidth,o=r.frozenLeftWidth,a=r.scollbarWidth,i=r.reservedWidth,n=4,l=r.colWidth,s=t.getColumnDefs(),d=0,c=0;c<s.length;c++){var C=s[c];d+=C.width}var u=r.width-(d+a+i+n);if(u>0)for(var f=r.width-o-a-i-n,c=0;c<s.length;c++){var C=s[c],p=C.width/d;l[C.field]=p*f}}},getColDef:function(e){for(var t=this,r=t.options,l=r.columnDefs,o=void 0,a=0;a<l.length;a++){var i=l[a]||{};if(i.field==e){o=i;break}}return o}}),function(){function e(e){var t=(e||{}).mergeSplitChar||"&";return t}function o(t,r,l,o){var a=e(o),i=(t||"").split(a),n="";return n=l?i.slice(r).join(a):i.length>r?i[r]:""}function a(r,l,i){for(var l=l||{columnDefs:[]},n=e(l),s=l.columnDefs||[],d="",c={},C=0;C<r.length;C++){var u=r[C],f=u.mergeHeader,p=o(d,i,!1,l),g=o(f,i,!1,l),h=o(f,i,!0,l),v=!t.equalsIC(p,g);v&&h.indexOf(n)>=0?(c={headerName:g,isMergedHeader:!0,level:i,children:[]},s.push(c)):h.indexOf(n)<0&&(c={}),c.children?c.children.push(u):s.push(u),d=f}for(var C=0;C<s.length;C++){var w=s[C];w.children&&w.children.length>0&&(w.children=a(w.children,w,i+1))}return s}function i(t,r){var l=e(r);return(t||"").split(l)}function n(t,r,l,o,a){e(a);return t}function s(t,r,l,o,a){for(var i=e(a),n=0;o-r>n;n++)t+="    "+i;return t+=l}t.ext(r,{hasColMerged:function(){var t=this,r=t.options,l=e(r),o=(t.viewOptions,r.colMerged),a=t.getViewColumns();if(void 0==o)for(var i=0;i<a.length;i++){var n=a[i],s=n.mergeHeader||"";if(s.indexOf(l)>0){o=r.colMerged=!0;break}}return o},bulidHeaderMergedModel:function(){var e=this;r.bulidHeaderMergedModel_area.call(e),r.bulidHeaderMergedModel_area.call(e,l.C_Area_LeftView),r.bulidHeaderMergedModel_area.call(e,l.C_Area_RightView)},bulidHeaderMergedModel_area:function(e){e=e||l.C_Area_CenterView;var t=this,o=t.viewOptions,d=o.colMergedModel=o.colMergedModel||{isMerged:C,maxLevel:1,viewColMerged:{},isIinitOriginaHeader:!1},c=d.maxLevel||1,C=d.isMerged=r.hasColMerged.call(t);if(C){var u=t.options,f=t.getViewColumns(e);if(!d.isIinitOriginaHeader){for(var p=0;p<f.length;p++){var g=f[p],h=i(g.mergeHeader,u),v=h.length;c=c>v?c:v}d.maxLevel=c,d.isIinitOriginaHeader=!0}for(var p=0;p<f.length;p++){var g=f[p],h=i(g.mergeHeader,u),v=h.length,w="";w=n(w,h,v,c,u),w=s(w,v,g.mergeHeader,c,u),g.mergeHeader=w}d.viewColMerged[e]=a(f,{},0),r.updateMergedColWidth.call(t,d.viewColMerged[e],e)}},updateMergedColWidth:function(e,l){for(var o=this,a=o.viewOptions,i=(a.colWidth,0);i<e.length;i++){var n=e[i],s=n.children;if(s&&n.isMergedHeader){r.updateMergedColWidth.call(o,s,l);
for(var d=0,c="",C=0;C<s.length;C++){var u=s[C],f=u.field,p=o.getColWidth(f,l);d+=p,c+=","+f}t.ext(n,{width:d,field:c})}}}})}(),t.ext(r,{buildVLeftPad:function(e,t){var l=this,o=l.viewOptions,a=l.leftPad;o.leftPadWidth<5||(r.buildVLeftColHeaderNode.call(l,a,t),r.buildVLeftFilterRowNode.call(l,a,t),r.buildVLeftViewPortNode.call(l,a,t),r.buildVLeftFooterNode.call(l,a,t),r.buildVLeftHSScrollbarNode.call(l,a,t))},buildVLeftColHeaderNode:function(o,a){var i=this,n=i.isMultiSelection(),s=i.viewOptions||{},d=s.colHeaderHeight||35,c=(i.getViewColumns(l.C_Area_LeftView),s.colMergedModel),C=c.isMerged?c.maxLevel||1:1;i.leftHeader=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridHeaderCls,l.C_VGridLeftPadViewCls)).css({minHeight:d*C,display:"block"}).appendTo(o);for(var u=[],f=0;C-1>f;f++){var p=e(l.C_DIV).addClass(t.getClsNames(l.C_ColHeaderContainerCls)).attr({"data-role":l.C_VGrid_Header_Row_Role,"data-rowindex":f,"data-rowid":f+1}).appendTo(i.leftHeader);u.push(p)}i.leftHeaderCt=e(l.C_DIV).addClass(t.getClsNames(l.C_ColHeaderContainerCls)).css({display:"block"}).appendTo(i.leftHeader),u.push(i.leftHeaderCt);var g=r.getRowSelectedColHeaderCls.call(i),h=r.buildRowSelector.call(i,a,-1,g,n),v=e(l.C_DIV).addClass(t.getClsNames(l.C_ColHeaderCls)).attr({"data-field":l.C_SelField}).css({display:"block",width:s.frozenLeftWidth}).appendTo(i.leftHeaderCt);e(l.C_DIV).addClass(t.getClsNames(l.C_VGridCellCTCls)).html(h).appendTo(v);for(var f=0;f<u.length;f++){var p=u[f];p.css({height:d,width:"100%"})}},buildVLeftFilterRowNode:function(r,o){var a=this,i=(a.options,a.viewOptions),n=i.colFilterRowHeight;n>5&&(a.leftFilterRow=e(l.C_DIV).css({minHeight:n}).addClass(t.getClsNames(l.C_VGridFilterRowCls)).appendTo(r))},buildVLeftViewPortNode:function(o,a){var i=this,n=(i.options,i.isMultiSelection()),s=i.viewOptions,d=t.strFormat('{0} [data-role="{1}"]',l.C_VGridLeftPadCls,l.C_VGrid_Row_Role)+'[data-rowid="{0}"]',c=(s.colHeaderHeight,s.defRowHeight),C=s.rowHeight,u=(i.getViewColumns(l.C_Area_LeftView),s.selectedRows||{}),f=s.selectRowBackground||"",p=!!f,g=r.getViewRowDataMaps.call(i),h=i.leftViewPort=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewCls,l.C_VGridLeftPadViewCls)).appendTo(o),v=i.viewportCliper=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewCliperCls)).appendTo(h),w=i.vpNodeCliperVp=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewCliperViewCls)).appendTo(v),_=i.vpNodeRowsCt=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridRowsContainerCls)).appendTo(w);v.css({top:-1*s.vwY});for(var m=s.startCell,V=(m.colIdx,m.rowIdx),D=s.endCell,y=(D.colIdx,D.rowIdx),F=s.rowYs,S=[],R=[],I=V;y+1>I;I++){var x=g[I],G=x.rowId,k=F[G],M=I%2==0?l.C_VGridRowOddCls:"",T=u[G]?t.getClsNames(l.C_VGridRowSelCls):"",H=!!T,O=C[G]||c,b=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridRowCls,M,T)).attr({"data-role":l.C_VGrid_Row_Role,"data-rowindex":x.rowIndex,"data-rowid":G}).css({background:p&&H?f:"",transform:t.strFormat("translateY({0}px)",k),lineHeight:t.getLineHeight(O),height:O}).appendTo(_);if(x){var P=r.buildRowSelector.call(i,a,G,"",n),N=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridCellCls)).attr({"data-field":l.C_SelField}).css({display:"block",width:s.frozenLeftWidth}).appendTo(b);e(l.C_DIV).addClass(t.getClsNames(l.C_VGridCellCTCls)).html(P).appendTo(N)}if(e(t.strFormat(d,G),i).length>0?S.push(b):R.push(b),I>l.C_RowLimit){t.writeLogFormat("The row count is out of {0} limit. Left View Port render has been break.",!1,l.C_RowLimit);break}}for(var L=0;L<S.length;L++)S[L].appendTo(_);for(var L=0;L<R.length;L++)R[L].appendTo(_)},buildVLeftFooterNode:function(r,o){var a=this,i=(a.options,a.viewOptions),n=i.colFooterHeight;a.leftFooter=e(l.C_DIV).css({minHeight:n}).addClass(t.getClsNames(l.C_VGridFooterCls)).appendTo(r)},buildVLeftHSScrollbarNode:function(r,o){var a=this,i=a.viewOptions,n=i.scollbarWidth;a.leftHScrollbar=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridHScrollbarCls,l.C_VGridLeftPadViewCls)).css({minHeight:n}).appendTo(r)}}),t.ext(r,{buildVCenterPad:function(t,o){var a=this,i=a.viewOptions,n=i.scollbarWidth,s=a.centerPad,d=l.C_Area_CenterView;r.buildColHeaderNode.call(a,s,o,d),r.buildFilterRowNode.call(a,s,o,d),r.buildViewPortNode.call(a,s,o,d),r.buildFooterNode.call(a,s,o,d),r.buildHSScrollbarNode.call(a,s,o,d),r.buildFrozenLeftLayout.call(a,o),r.buildFrozenRightLayout.call(a,o),e(l.C_VGridCenterPadViewCls,t).css({width:i.width-i.leftPadWidth-i.rightPadWidth}),e(l.C_VGridHScrollbarCls,t).css({width:i.width-i.leftPadWidth-i.rightPadWidth-n})},buildColHeaderNode:function(o,a,i){var n=this,s=n.viewOptions,d=(s||{}).colHeaderHeight||35,c=s.colMergedModel,C=c.isMerged?c.maxLevel||1:1,u=n.header=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridHeaderCls,l.C_VGridCenterPadViewCls)).css({minHeight:d*C+C}).appendTo(o),f=n.frozenLayoutHeader=r.buildFrozenLayoutEls.call(n,u),p=f.normalCenter,g=s.scollbarWidth,h=r.getFrozenRightWidth.call(n)+g;f.frozenRight.css({minWidth:h}),r.buildViewPortColHeaderCells.call(n,p,a,i)},buildFilterRowNode:function(o,a,i){var n=this,s=(n.options,n.viewOptions),d=(s.totalWidth,t.strFormat('{0} {1}[data-field="{2}"]',l.C_VGridFilterRowCls,l.C_ColHeaderCls,"{0}"),s.colFilterRowHeight);if(d>5){var c=n.filterRow=e(l.C_DIV).css({minHeight:d}).addClass(t.getClsNames(l.C_VGridFilterRowCls,l.C_VGridCenterPadViewCls)).appendTo(o),C=n.frozenLayoutFilterRow=r.buildFrozenLayoutEls.call(n,c),u=C.normalCenter.css({display:"block"}),f=s.scollbarWidth,p=r.getFrozenRightWidth.call(n)+f;C.frozenRight.css({minWidth:p});var g=e(l.C_DIV).attr({"data-role":l.C_VGrid_Filter_Row_Role}).addClass(t.getClsNames(l.C_ColFilterRowContainerCls)).appendTo(u);r.buildViewPortFilterRowCells.call(n,g,a,i)}},buildViewPortNode:function(o,a,i){var n=this,s=n.options,d=s.isFetching,c=n.viewOptions,C=c.colFooterHeight,u=c.vwPortBorderHeight||0,f=c.rowBorderHeight,p=c.reservedHeight,g=(c.colHeaderHeight,c.defRowHeight),h=(c.rowHeight,n.isSingleSelection()),v=r.getViewRowDataMaps.call(n),w=v.length*(g+f)+p,_=n.viewport=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewCls,l.C_VGridCenterPadViewCls)).appendTo(o),m=n.frozenLayoutViewPort=r.buildFrozenLayoutEls.call(n,_,w),V=m.normalCenter,D=(c.height||0)-2*u-C;m.forzenLeft.css({minHeight:D}),m.frozenRight.css({minHeight:D});var y=(n.viewportLeft=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewLeftCls)).appendTo(V),n.viewportCliper=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewCliperCls)).appendTo(V)),F=n.vpNodeCliperVp=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewCliperViewCls)).appendTo(y),S=n.vpNodeRowsCt=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridRowsContainerCls)).appendTo(F);n.viewportRight=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridViewRightCls)).appendTo(V);0==v.length?(e(t.getEmptyHtmlTemplate(s.emptyTips,s.emptyImgSrc,d)).appendTo(_),V.css({display:"none"}),m.forzenLeft.css({display:"none"}),m.frozenRight.css({display:"none"})):(V.css({display:"block"}),h||(m.forzenLeft.css({display:"block"}),m.frozenRight.css({display:"block"}))),r.buildViewPortNormalCells.call(n,S,a,i),r.attachInnerElEvents.call(n,_,l.C_Scroll,function(e){var t=(a||{}).onVScroll;t&&t.call(n,e)})},buildFooterNode:function(o,a,i){var n=this,s=(n.options,n.viewOptions),d=s.colFooterHeight,c=n.footer=e(l.C_DIV).css({minHeight:d}).addClass(t.getClsNames(l.C_VGridFooterCls,l.C_VGridCenterPadViewCls)).appendTo(o),C=n.frozenLayoutFooter=r.buildFrozenLayoutEls.call(n,c),u=C.normalCenter,f=s.scollbarWidth,p=r.getFrozenRightWidth.call(n)+f;C.frozenRight.css({minWidth:p});var g=e(l.C_DIV).attr({"data-role":l.C_VGrid_Footer_Row_Role}).addClass(t.getClsNames(l.C_ColFooterRowContainerCls)).appendTo(u);d||c.hide(),r.buildViewPortSummaryRowCells.call(n,g,a,i)},buildHSScrollbarNode:function(o,a,i){var n=this,s=n.viewOptions,d=s.scollbarWidth,c=s.totalWidth,C=n.hscrollbar=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridHScrollbarCls)).css({minHeight:d}).appendTo(o),u=n.frozenLayoutHSScrollbar=r.buildFrozenLayoutEls.call(n,C),f=u.normalCenter;f.css({overflowX:"scroll",overflowY:"hidden"}),n.hscrollholder=e(l.C_DIV).addClass(t.getClsNames(l.C_VGridHScrollbarHolderCls)).appendTo(f),n.hscrollholder.css({width:c,height:1}),r.attachInnerElEvents.call(n,f,l.C_Scroll,function(e){var t=(a||{}).onHScroll;t&&t.call(n,e)})}}),function(e){var t=KDVGridHelper,o=window.KDVElementCachePool=window.KDVElementCachePool||function(){};t.isFunc(o.prototype.getKey)||(o.prototype=t.ext(o.prototype,{getKey:function(e,r){var o=this,a="";if(e){var i=e.parent(),n="";0!=r&&i&&i.length>0&&(n=o.getKey(i,!1),i=i.parent(),i&&i.length>0&&(n+=o.getKey(i,!1))),a=t.strFormat("{0}_{1}_{2}",(e[0]||"").tagName||"",t.replaceAll(e.attr("class")||"",t.getClsNames(l.C_VGridIsCachedCls),"").trim().replace(/(\s){1,}/g,"_"),e.textContent).toLowerCase(),a+=n}return a},put:function(e,r){var o=this,a=o.elementCaches=o.elementCaches||{},i=a[e]||{items:[]},n=r.text("").addClass(t.getClsNames(l.C_VGridIsCachedCls));return i.items.push(r),a[e]=i,n},pop:function(e){var r=this,o=t.getClsNames(l.C_VGridIsCachedCls),a=r.elementCaches=r.elementCaches||{},i=a[e]||{items:[]},n=i.items.length>0?i.items.shift():null;return n&&n.hasClass(o)&&n.removeClass(o),n},release:function(){var e=this,t=e.elementCaches=e.elementCaches||{};for(var r in t){var l=t[r]||{};l.items&&delete l.items,delete t[r]}delete e.elementCaches}})),t.ext(r,{initElementCachePool:function(e){var t=e.elementCaches=e.elementCaches||new KDVElementCachePool;return t},releaseElementCachePool:function(e){var t=e||this,r=t.elementCaches=t.elementCaches;r&&r.release()}})}(jQuery),function(e){function o(){return!!KDVGridConst.C_UseElCached}function a(e){var t=[];arguments.length>1&&(t=Array.prototype.slice.call(arguments),t.shift());var r=function(e,t){return function(){e.apply(this,t)}}(e,t),l=h.call(window,r);return l}function i(t,r){var l=void 0;return(t||{}).isText?l=e(document.createTextNode(t.value)):(l=e(document.createElement(t.tag)),t.attributes&&e.each(t.attributes,function(e,t){l.attr(e,t)}),t.children&&e.each(t.children,function(e,t){l.append(i(t,r))}),t.eventHandlers&&e.each(t.eventHandlers,function(e,t){f(l,t)})),l}function n(e,t){if(o()){var l=r.initElementCachePool(t),a=l.getKey(e),i=l.put(a,e);return i}return e.remove()}function s(e,t,l){if(o()){var a=r.initElementCachePool(l),i=a.getKey(e),n=a.pop(i);return n?n:t.append(e)}return t.append(e)}function d(e,t){if(o()){var l=r.initElementCachePool(t),a=l.getKey(e),i=l.pop(a);return i?i:e}return e}function c(e,t,r){return e.replaceWith(t)}function C(e,t){return e.empty()}function u(e,r){var l=e;try{var o=(e||{})[0],l=r?o[r]:o;if("attributes"==r){for(var a=!1,i=0;i<v.length;i++){var n=v[i];void 0===l[n]&&(e.attr(n,""),a=!0)}a&&(l=o[r])}}catch(s){t.writeLogFormat("getFHEL: {0}",!1,s.message)}return l}function f(t,r){var l=r||{},o=l.eventName,a=l.selector,i=l.evtType,n=l.handler;l.target;"delegate"==i?t.undelegate(a,o).delegate(a,o,n):a?e(a,t).off(o,n).on(o,n):t.off(o,n).on(o,n)}function p(t,r,l,o){t=u(t);var g=e(t);if((r||{}).isText)return a(function(e,t,r){t&&t.nodeType==document.TEXT_NODE?t.textContent!=e.value&&(t.textContent=e.value):(g&&g.length>0&&n(g,o),s(i(e,o),r,o))},r,t,l);if(!u(g))return a(function(e,t){s(i(e,o),t,o)},r,l);if(!r)return a(function(e){n(e,o)},g);if(!g.is(r.tag))return a(function(e,t){c(e,i(t,o),o)},g,r);if(r.attributes&&e.each(r.attributes,function(e,t){a(function(e,t,r){""==r||void 0===r?e.removeAttr(t):e.attr(t,r)},g,e,t)}),r.children&&e.isArray(r.children))for(var h=e(t.childNodes),v=Math.max(r.children.length,h.length),w=0;v>w;w++){var _=r.children[w],m=e(h.get(w));p(m,_,g,o)}if(r.eventHandlers&&e.each(r.eventHandlers,function(e,t){f(g,t)}),"input"==r.tag){var V=r.value;g.val()!==V&&void 0!==V&&document.activeElement!=g[0]&&a(function(e,t){e.val(t)},g,V)}r.children||r.content?d(g,o):a(function(e){C(e,o)},g)}function g(r,l){var o="#text"==(r||{}).nodeName,a=e(r),i={};if(o)i.isText=o,i.value=r.nodeValue||"";else{i.tag=a.prop("tagName").toLowerCase();var n=e(r.childNodes);n.length>0?(i.children=[],n.each(function(){i.children.push(g(this,l))})):a.text()&&(i.content=a.text());var s=u(a,"attributes");s.length>0&&(i.attributes={},e.each(s,function(e,t){i.attributes[t.name]=t.value})),"input"==i.tag&&(i.value=a.val()||"");var d=(t.getData(a)||{}).uiid;d&&(i.eventHandlers=(l||{})[d])}return i}var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,0)};t.isIE()&&(h=function(e){return window.setTimeout(e,5)});var v=["class","style","onclick"];e.fn.renderVDom=function(t){for(var r=this,l=0;l<r.length;l++){var o=r[l];p(e(o),t,null,r)}return r},e.fn.buildVDom=function(e){return g(u(this),e)},e.fn.attachVDomEvents=function(e,r,o,a,i){var n=this,s=n.eventHandlers=n.eventHandlers||{},d=t.strFormat("data-{0}",(r||"").replace(/\./g,"_")),c=t.getUiid(t.getData(e)),C={};C[l.C_DataUiidKey]=c,C[d]=!0,e.attr(C);var u=s[c]=s[c]||{},f=t.strFormat("{0}_{1}_{2}",r,a,i);u[f]={eventName:r,selector:i,evtType:a,target:e,handler:o}},e.fn.detachVDomEvents=function(){var r=this,o=r.eventHandlers=r.eventHandlers||{};for(var a in o){var i=o[a]||{};for(var n in i){var s=e(t.strFormat('[{0}="{1}"]',l.C_DataUiidKey,a),r),d=i[n],c=d.eventName,C=d.selector,u=d.evtType;0==s.length&&(s=e(t.strFormat('[{0}="{1}"]',l.C_DataUiidKey,a))),s.length>0&&("delegate"==u?s.undelegate(C,c):C?e(C,s).off(c,d.handler):s.off(c,d.handler));var f=d.target;"delegate"==u?f.undelegate(C,c):C?e(C,f).off(c,d.handler):f.off(c,d.handler),delete i[n]}t.isEmpty(i)&&delete o[a]}},e.fn.attachVDomChildrenEvents=function(r){var o=this,a=r||{};e.each(a,function(r,a){var i=t.strFormat('[{0}="{1}"]',l.C_DataUiidKey,r),n=t.getData(o).uiid==r,s=a||{},d=n?o:e(i,o);e.each(s,function(e,t){f(d,t)})})},e.fn.releaseEl=function(r){var l=this;try{l.detachVDomEvents();for(var o=e("*",l),a=o.length-1;a>=0;a--){var i=e(o[a]);e.event.remove(i),e.removeData(i),i.remove()}e.event.remove(l),e.removeData(l),l.empty(),l.remove();for(var n in l)t.isOwnProp(n,l)&&delete l[n]}catch(s){t.writeLogFormat("{0} {1}",!1,r||"",s.message)}}}(jQuery),"function"==typeof KDVGrid_Api&&KDVGrid_Api.call(this,e,r),"function"==typeof KDVGrid_Events&&KDVGrid_Events.call(this,e,r),"function"==typeof KDVGrid_DragDrop&&KDVGrid_DragDrop.call(this,e,r),"function"==typeof KDVGrid_Frozen&&KDVGrid_Frozen.call(this,e,r),"function"==typeof KDVGrid_Filter&&KDVGrid_Filter.call(this,e,r),"function"==typeof KDVGrid_Sort&&KDVGrid_Sort.call(this,e,r),"function"==typeof KDVGrid_Grouping&&KDVGrid_Grouping.call(this,e,r),"function"==typeof KDVGrid_FindLocate&&KDVGrid_FindLocate.call(this,e,r),"function"==typeof KDVGrid_CellRender&&KDVGrid_CellRender.call(this,e,r),"function"==typeof KDVGrid_Algorithm&&KDVGrid_Algorithm.call(this,e,r),"function"==typeof KDVGrid_CellEditor&&KDVGrid_CellEditor.call(this,e,r),e.fn.KDVGrid.defaults={metaHtml:"",defaults:{}}}(jQuery);
//# sourceMappingURL=kdvgrid.min.js.map