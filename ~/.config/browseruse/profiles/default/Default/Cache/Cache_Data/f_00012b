/*
 Kingdee Galaxy 
 build on [2023-06-05 19:20:58.301]. 
**/
function Getk3cloudloginInfo(e){for(var t,i=document.cookie,a=i?i.split(";"):[],n=0,o=a.length;o>n;n++)if(t=$.trim(a[n]).split("="),t[0]==e)return decodeURIComponent(t[1]);return null}function Sys$Enum$parse(e,t){var i,a,n;if(t){if(i=this.__lowerCaseValues,!i){this.__lowerCaseValues=i={};var o=this.prototype;for(var r in o)i[r.toLowerCase()]=o[r]}}else i=this.prototype;if(this.__flags){for(var s=(t?e.toLowerCase():e).split(","),l=0,d=s.length-1;d>=0;d--){var c=s[d].trim();if(a=i[c],"number"!=typeof a)throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,e.split(",")[d].trim(),this.__typeName));l|=a}return l}if(n=t?e.toLowerCase():e,a=i[n.trim()],"number"!=typeof a)throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,e,this.__typeName));return a}function Sys$Enum$toString(e){if("undefined"==typeof e||null===e)return this.__string;var t,i=this.prototype;if(this.__flags&&0!==e){var a=this.__sortedValues;if(!a){a=[];for(t in i)a[a.length]={key:t,value:i[t]};a.sort(function(e,t){return e.value-t.value}),this.__sortedValues=a}var n=[],o=e;for(t=a.length-1;t>=0;t--){var r=a[t],s=r.value;if(0!==s&&(s&e)===s&&(n[n.length]=r.key,o-=s,0===o))break}if(n.length&&0===o)return n.reverse().join(", ")}else for(t in i)if(i[t]===e)return t;return""}function Sys$Component$_setProperties(e,t){var i,a=Object.getType(e),n=a===Object||a===Sys.UI.DomElement,o=Sys.Component.isInstanceOfType(e)&&!e.get_isUpdating();o&&e.beginUpdate();for(var r in t){var s=t[r],l=n?null:e["get_"+r];if(n||"function"!=typeof l){var d=e[r];!s||"object"!=typeof s||n&&!d?e[r]=s:Sys$Component$_setProperties(d,s)}else{var c=e["set_"+r];if("function"==typeof c)c.apply(e,[s]);else if(s instanceof Array){i=l.apply(e);for(var h=0,u=i.length,p=s.length;p>h;h++,u++)i[u]=s[h]}else"object"==typeof s&&Object.getType(s)===Object&&(i=l.apply(e),Sys$Component$_setProperties(i,s))}}o&&e.endUpdate()}function Sys$Component$_setReferences(e,t){for(var i in t){var a=e["set_"+i],n=$find(t[i]);a.apply(e,[n])}}function CheckShellByWinService(){"1"!=isInstallShell&&KD.CheckProcessExists("Kingdee.BOS.DeskClient.WinService")}function kdformMain(){if(isDForm()){KD.openDebugger(),KD.applyGolbalFontName(),KD.initClientParameters(),KD.GetServerCommonConfig();var e=$("#MainPanel").css({height:"auto",width:KD.clientVisualWidth,"min-height":KD.clientMinHeight,"min-width":KD.clientMinWidth});$("body").addClass("kdmainformbg"),"1033"==KD.cookieLanguageId()?$("body").addClass("kd-body-enEnvironment"):$("body").removeClass("kd-body-enEnvironment"),$("body").css({"min-height":KD.clientMinHeight}),KDChangeFontSize.initFontSize(),e.addClass("mainpanel"),e.ready(function(){KD.writeSecureLog(),window.focus(),ClientAppProxy.Current.lastRequestTime=new Date;var t=$("#ctx").val();ClientAppProxy.Current.CTX=KD.parseObject(t);var i=$("#config").val(),a=KD.parseObject(i);a.isFlowForm=!0;var n=new KDMainDynamicFormProxy;if(ClientAppProxy.Current.rootForm=n,e.mainForm=n,n.setIsMain(!0),$.isArray(a))try{n.showErrMsgStrWindow(ResManager.LoadKDString("提示信息","0991733000004021"),a[0].param[0])}catch(o){n.showErrMsgStrWindow(JSON.stringify(a))}finally{n.release(),e.mainForm=void 0}else{ClientAppProxy.Current.defaultLocalId=a.localId;var r=new DFormConfig;if(r.loadConfig(a,ClientAppProxy.Current.defaultLocalId),!r)return void n.showErrMsgStrWindow(ResManager.LoadKDString("当前会话不可用","0991733000004022"));n.baseId=a.pageId,n.createControl(a);var s=n.getControl();s.appendTo(e),n.apply(r),document.rootForm=n,KD.lastHeight=$(window).innerHeight(),KD.lastWidth=$(window).innerWidth(),KD.circleInterval=KD.delayInvoke(KD.resetAppSize,3e3,!0),KDLockedSystem.init()}})}}function showChildFrameForm(e,t){var i=document.rootForm;i?i.showDynamicForm(e,!0):alert("no root")}function isSLIndex(){var e=KD.getCurPageName();return"silverlight/index.aspx"==e||"/k3cloud"==e||"k3cloud/"==e}function mainlogin(){KDCookieManager.renewKDSession(),KD.writeSecureLog(),KD.openDebugger(),KD.applyGolbalFontName(),KD.initClientParameters(),KD.GetServerCommonConfig();var e=KD.getQueryString("loginType");if(e&&"qrcode"==e){KD.storage.setItem("lastLoginType",JSON.stringify(e));var t=KD.getQueryString("lcid"),i=KD.getQueryString("dbid"),a=KD.storage.getItem("userHistory")||"{}",n=KD.parseObject(a),o={user:"qrcodeuser",lan:t,acc:i,ver:""};n[o.user]=o,KD.storage.setItem("userHistory",JSON.stringify(n));var o={user:"",acc:i,lan:t,ver:""};KD.storage.setItem(KD.CONST.k3CloudLoginInfoKey,JSON.stringify(o))}var r=function(e){renderMainLogin(e),KD.getIsHtml5LoginForSilverlight()&&$.isFunction(window.loadIndexSL)&&window.loadIndexSL(e)};KD.isStartAppVerify()?KD.StartVerify(this,function(e){var t=e;try{if(KD&&t&&t.BrandEntity&&(KD.Brand=t.BrandEntity),null==t||1==t.ResultType||1==t.ExitType)if(t&&t.Message&&-1==t.ResultType)showMessage(t.Message,"",function(){naviTo(KD.format("{0}/{1}/index.aspx",KD.getUrlRoot(),KD.getSubPath()))});else{if(KD.isQBoard()&&t.CustomArgs){var i=KD.parseObject(KD.base64Decode(t.CustomArgs));if(i&&i.CustomArgs){var a=KD.parseObject(i.CustomArgs);if(a.simpleport&&KD.storage.setItem(KD.CONST.k3CloudQBoardSimplePortKey,a.simpleport),a.simpleporterror&&KD.writeLog("simpleporterror: "+a.simpleporterror),a.udurl)return void naviTo(KD.format("{0}/{1}",KD.getUrlRoot(),a.udurl))}}r(e)}else{var n="",o=function(e){e&&naviTo(e)};switch(t.FailureCallBackType){case 3:showMessage(t.Message,"",function(){o(t.RedirectUrl)});break;case 2:n=t.RedirectUrl,o(n);break;case 1:showMessage(t.Message,"",function(){o("about:blank")});break;case 0:default:showMessage(t.Message,"")}}}catch(s){showMessage(t.Message,s.Stack,function(){r()})}}):r()}function showMessage(e,t,i){KDMessageBox.show({type:KDMessageBox.KDMesBoxType.Warning,sourceClass:"",sourceMethod:"",msg:e,description:t,callback:i})}function naviTo(e){var t=e;t&&(t.indexOf("://")<0&&"about:blank"!=t.toLowerCase()&&(t=KD.getUrlRoot()+"/"+t),window.location=t)}function _getLoginType(){var e=[],t=$(".boxtitles .boxtitle.active");t.length>0&&$.each(t,function(t,i){var a=$(i).attr("data-type");KD.IsNullOrWhiteSpace(a)||e.push(a)});var i=$("#qr_").is(":visible");return e.length>0&&$.inArray("qrcode",e)>-1&&i?"qrcode":e.length>0&&$.inArray("cloudaccount",e)>-1?"cloudaccount":"account"}function renderMainLogin(e){if(KD.setStartVerifyResult(e),!KD.getIsHtml5LoginForSilverlight()){var t=KD.getUserToken(),i=KD.isObject(e)?e.UserToken||t:t,a=KD.isObject(e)?e.CustomArgs:"",n=KD.isObject(e)?e.CustomParam:{},o=KD.isObject(e)?e.KDSVCSessionId:"";if(!KD.isEmpty(i))return KDCookieManager.renewKDSession(),void(KD.isEmpty(o)?KD.buildsession({UserToken:i,buildsessiononly:!0,async:!0,callback:function(e){loadMainForm(i,a,n)}}):(KDCookieManager.setKDSessionId(o),loadMainForm(i,a,n)))}$("#htmllogin").css("visibility","visible"),$("body form:first").hide().css("visibility","visible").show("slow"),$("#loginbackCt").addClass("loginbackCt"),$("#loginback").addClass("loginbackbrush"),$("#loginKDLogo").addClass("loginKDLogo"),$("body").addClass("mainpanel").css({"min-height":KD.clientMinHeight,"min-width":KD.clientMinWidth}),"1033"==KD.cookieLanguageId()?$("body").addClass("kd-body-enEnvironment"):$("body").removeClass("kd-body-enEnvironment");var r=$("#MainPanel");r.html("<div id='dbox' style='height:inherit;'>Hello!</div>"),r.ready(function(){var e=KD.getEntryRole();KD.initClientInfo();var t=KD.entryrolePlugins.getPlugin(e);t&&$.isFunction(t.initLoginPanel)&&t.initLoginPanel.call(t);var i=$("#dbox").length>0?$("#dbox").height("auto"):$("#qrCodeDiv").height("auto");i.text(""),i.children().remove();var a={entryrole:e,ok:function(e){if(KD.getIsHtml5LoginForSilverlight())$("#loginresult").attr("value",JSON.stringify(e)),SilverlightLoaded();else{var t=KD.getEntryRole();t=t?t.toLocaleLowerCase():t;var i=KD.entryrolePlugins.getPlugin(t),a=!1;if(i&&$.isFunction(i.isBuildSession)&&(a=i.isBuildSession.call(i)),a)KD.buildsession(e);else{var n=e.UserToken||e.Context&&e.Context.UserToken,o=KD.storage.getItem("KDLockedSystemInfo")||"{}",r=KD.parseObject(o);r[e.Context.UserName]&&delete r[e.Context.UserName],KD.storage.setItem("KDLockedSystemInfo",KD.obj2str(r));var s=KD.getStartVerifyResult();s&&s.IsStartLoginAuthen?loadMainForm(n,KD.isObject(s)?s.CustomArgs:"",e.CustomParam):loadMainForm(n,"",e.CustomParam)}var l=_getLoginType();KD.storage.setItem("lastLoginType",JSON.stringify(l)),_recordLoginByCloudAccount(l);var d=KD.storage.getItem("userHistory")||"{}",c=KD.parseObject(d),h="",u=$("#verifyType").data("kendoDropDownList");u&&u.value&&(h=u.value());var p={user:$("#user").val(),lan:$("#language").data("kendoDropDownList").value(),acc:$("#datacenter").data("kendoDropDownList").value(),ver:h};c[p.user]=p,KD.storage.setItem("userHistory",JSON.stringify(c))}},err:function(e){e.type=KDMessageBox.KDMesBoxType.Error;var t=KDMessageBox.show(e);t&&ClientAppProxy&&ClientAppProxy.Current&&ClientAppProxy.Current.writeLog(e.msg,e.description)}},n=function(){if($.isFunction(i.KDLogin)){if(window.LoginInterface=i.KDLogin(a),$("#qrCodeDiv")){var e=$(".loginKDLogo"),t=KD.getUrlSubRoot()+"//images/biz/International/kdcloud_icon",o=".png";KD.Brand&&KD.Brand.Resource6&&(t=KD.getUrlSubRoot()+"/"+KD.Brand.Resource6.split(".")[0],o="."+KD.Brand.Resource6.split(".")[1]);var r=parseInt(ResManager.Language);switch(r){case 1033:imgPath=t+"_1033"+o,e.width(260);break;default:imgPath=t+o}KD.GetDefaultBrandName(r),imgPath+="?v="+KD.getVersion(),e.css({"background-image":"url("+imgPath+")"})}if(_isUseKingdeeUnifiedStyle())_adjustmentLayoutForKingdeeUnifiedStyle();else{var s=$("#divBarTitle").kendoKDLoginAD().data("kendoKDLoginAD");s&&s.show()}$("#forgetpass .kd-getpassword-tips").click(function(e){return e.preventDefault,!1})}else KD.delayInvoke(n,100)};KD.delayInvoke(n,100)});var s="Cache Item Count:"+KD.storage.getLength();$("#indexClearCache").attr("title",s)}function loadMainForm(e,t,i){i&&KD.isObject(i)&&(i.GlobalWatermarkConfigStr="",delete i.GlobalWatermarkConfigStr);var a=KDCookieManager.getKDSessionId(),n=KDCookieManager.getAspNetSessionId(),o={ut:e,sid:a,key:n,lcp:i||{}},r=setTimeout(function(){clearTimeout(r),KD.storage.setItem("CurrentUserLoginIsFromIndexaspx","true");var i=$("#formId").val(),n=$("#formType").val(),s=$("#pageId").val();e=e||$("#userToken").val();var l=KD.getEntryRole(),d=KD.getQueryString("udencoding",""),c=t||"";c.indexOf("%")<0&&(c=KD.urlEncodeComponent(t||"")),beforeTransForm(o,3);var h=window,u=KD.getUrlRoot()+"/"+KD.getSubPath()+"/dform.aspx?formId="+i+"&formType="+n+(l?"&entryrole="+l:"")+(d?"&udencoding="+d:"")+"&pageId="+s;u+=KD.equalsIgnoreCase("true",KD.getConnectConfig().plainTextUrlCtxParam)?"&usertoken="+e+"&kdsid="+a:"&_cnneptstate_="+KD.urlEncodeComponent(h["C5.S6"]),u+="&custparam="+c+(KD.isDebug()?"&isDebug=true":""),KDCookieManager.setSessions(),$(location).attr("href",u)},50)}function getKDJQLayoutCallbacks(){return $.layout&&$.layout.callbacks?$.layout.callbacks.resizeTabLayout:void 0}function _isUseKingdeeUnifiedStyle(){return!0}function _recordLoginByCloudAccount(e){var t=KD.storage.getItem(KD.CONST.isHasLoginByCloudAccountName);KD.isEmpty(t)&&"cloudaccount"==e&&KD.storage.setItem(KD.CONST.isHasLoginByCloudAccountName,!0)}function _adjustmentLayoutForKingdeeUnifiedStyle(){KD.isIndex()&&$("body").css({"min-height":KD.clientMinHeight>600?600:KD.clientMinHeight,"min-width":KD.clientMinWidth>1024?1024:KD.clientMinWidth}),$("body").addClass("kd-company-unified-style"),$("#datacenter_ct").css({"float":"left"}),$("#verifyType_ct").css({"float":"right","margin-right":"0px"}),$("#loginBtnInfo").css({"margin-top":"73px"});var e="url("+KD.getImageUrlByNameAndVersion(KD.getUrlRoot()+"/images/biz/International/kdcloud_login_bg.png")+")";$("#loopbanners").css({"background-image":e}),$("#loopbanners").children().wrapAll($('<div class="kd-desc-container"></div>'));var t=ResManager.LoadKDString("金蝶云","00214298000004482"),i=KD.checkChinese(t);i?$("#loopbanners .kd-desc-container").removeClass("kd-desc-container-en"):$("#loopbanners .kd-desc-container").addClass("kd-desc-container-en"),$("#divBarTitle").text(t),$("#divImgBg").css({"min-height":"40px"}).text(ResManager.LoadKDString("为企业成长而生","00214298000004483"));var a="url("+KD.getImageUrlByNameAndVersion(KD.getUrlRoot()+"/images/biz/International/kingdee_icon.png")+")";$("#divTitle .loginKDLogo").addClass("kd-company-unified-style-icon").removeAttr("style").css({"background-image":a}),$("#loginUserInfo .kd-login-input-container").css({width:"100%",height:"44px"}),$("#loginUserInfo .kd-login-input-container .k-textbox").css({width:"313px",height:"44px"}),$("#loginUserInfo .kd-login-input-container #CAuser").css("width","308px"),a="url("+KD.getUrlRoot()+"/"+KD.getSubPath()+"/"+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+")",$("#loginUserInfo .kd_iconUserName").css({"background-image":a}),$("#loginUserInfo .kd_iconPassword").css({"background-image":a}),$("#loginUserInfo .kd-icon-sms-verification").css({"background-image":a}),$("#verifyType_ct .k-select .k-icon.k-i-arrow-s").css({"background-image":a}),$("#language_ct .k-dropdown").css({width:"120px",background:"transparent"}),$("#language_ct .k-dropdown-wrap").css({background:"transparent","text-align":"right"}),$("#language_ct .k-select").after($("#language_ct .k-input")),$("#language_ct .k-select .k-icon.k-i-arrow-s").css({"background-image":a}),$("#datacenter_ct .k-dropdown-wrap").css({"float":"left","max-width":"100%"}),$("#datacenter_ct .k-select .k-icon.k-i-arrow-s").css({"background-image":a}),$("#forgetpass").css({"margin-left":"0px"}),$("#velidationCode").css({width:"174px",height:"44px"}),KD.isManagementSite()&&$("#datacenter_ct").css({left:"0px"}),$("#grid_SRMSupplier").css({"margin-right":"0px"})}var CryptoJS=CryptoJS||function(e,t){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&"undefined"!=typeof global&&global.crypto&&(i=global.crypto),!i&&"function"==typeof require)try{i=require("crypto")}catch(a){}var n=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var i;return e.prototype=t,i=new e,e.prototype=null,i}}(),r={},s=r.lib={},l=s.Base=function(){return{extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=s.WordArray=l.extend({init:function(e,i){e=this.words=e||[],i!=t?this.sigBytes=i:this.sigBytes=4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,i=e.words,a=this.sigBytes,n=e.sigBytes;if(this.clamp(),a%4)for(var o=0;n>o;o++){var r=i[o>>>2]>>>24-o%4*8&255;t[a+o>>>2]|=r<<24-(a+o)%4*8}else for(var o=0;n>o;o+=4)t[a+o>>>2]=i[o>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],i=0;e>i;i+=4)t.push(n());return new d.init(t,e)}}),c=r.enc={},h=c.Hex={stringify:function(e){for(var t=e.words,i=e.sigBytes,a=[],n=0;i>n;n++){var o=t[n>>>2]>>>24-n%4*8&255;a.push((o>>>4).toString(16)),a.push((15&o).toString(16))}return a.join("")},parse:function(e){for(var t=e.length,i=[],a=0;t>a;a+=2)i[a>>>3]|=parseInt(e.substr(a,2),16)<<24-a%8*4;return new d.init(i,t/2)}},u=c.Latin1={stringify:function(e){for(var t=e.words,i=e.sigBytes,a=[],n=0;i>n;n++){var o=t[n>>>2]>>>24-n%4*8&255;a.push(String.fromCharCode(o))}return a.join("")},parse:function(e){for(var t=e.length,i=[],a=0;t>a;a++)i[a>>>2]|=(255&e.charCodeAt(a))<<24-a%4*8;return new d.init(i,t)}},p=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},g=s.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i,a=this._data,n=a.words,o=a.sigBytes,r=this.blockSize,s=4*r,l=o/s;l=t?e.ceil(l):e.max((0|l)-this._minBufferSize,0);var c=l*r,h=e.min(4*c,o);if(c){for(var u=0;c>u;u+=r)this._doProcessBlock(n,u);i=n.splice(0,c),a.sigBytes-=h}return new d.init(i,h)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(s.Hasher=g.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new f.HMAC.init(e,i).finalize(t)}}}),r.algo={});return r}(Math);!function(){function e(e,t,i){for(var n=[],o=0,r=0;t>r;r++)if(r%4){var s=i[e.charCodeAt(r-1)]<<r%4*2,l=i[e.charCodeAt(r)]>>>6-r%4*2,d=s|l;n[o>>>2]|=d<<24-o%4*8,o++}return a.create(n,o)}var t=CryptoJS,i=t.lib,a=i.WordArray,n=t.enc;n.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,a=this._map;e.clamp();for(var n=[],o=0;i>o;o+=3)for(var r=t[o>>>2]>>>24-o%4*8&255,s=t[o+1>>>2]>>>24-(o+1)%4*8&255,l=t[o+2>>>2]>>>24-(o+2)%4*8&255,d=r<<16|s<<8|l,c=0;4>c&&i>o+.75*c;c++)n.push(a.charAt(d>>>6*(3-c)&63));var h=a.charAt(64);if(h)for(;n.length%4;)n.push(h);return n.join("")},parse:function(t){var i=t.length,a=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var o=0;o<a.length;o++)n[a.charCodeAt(o)]=o}var r=a.charAt(64);if(r){var s=t.indexOf(r);-1!==s&&(i=s)}return e(t,i,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,i,a,n,o,r){var s=e+(t&i|~t&a)+n+r;return(s<<o|s>>>32-o)+t}function i(e,t,i,a,n,o,r){var s=e+(t&a|i&~a)+n+r;return(s<<o|s>>>32-o)+t}function a(e,t,i,a,n,o,r){var s=e+(t^i^a)+n+r;return(s<<o|s>>>32-o)+t}function n(e,t,i,a,n,o,r){var s=e+(i^(t|~a))+n+r;return(s<<o|s>>>32-o)+t}var o=CryptoJS,r=o.lib,s=r.WordArray,l=r.Hasher,d=o.algo,c=[];!function(){for(var t=0;64>t;t++)c[t]=4294967296*e.abs(e.sin(t+1))|0}();var h=d.MD5=l.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,o){for(var r=0;16>r;r++){var s=o+r,l=e[s];e[s]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var d=this._hash.words,h=e[o+0],u=e[o+1],p=e[o+2],g=e[o+3],f=e[o+4],m=e[o+5],v=e[o+6],y=e[o+7],b=e[o+8],D=e[o+9],k=e[o+10],C=e[o+11],x=e[o+12],w=e[o+13],K=e[o+14],S=e[o+15],I=d[0],P=d[1],F=d[2],T=d[3];I=t(I,P,F,T,h,7,c[0]),T=t(T,I,P,F,u,12,c[1]),F=t(F,T,I,P,p,17,c[2]),P=t(P,F,T,I,g,22,c[3]),I=t(I,P,F,T,f,7,c[4]),T=t(T,I,P,F,m,12,c[5]),F=t(F,T,I,P,v,17,c[6]),P=t(P,F,T,I,y,22,c[7]),I=t(I,P,F,T,b,7,c[8]),T=t(T,I,P,F,D,12,c[9]),F=t(F,T,I,P,k,17,c[10]),P=t(P,F,T,I,C,22,c[11]),I=t(I,P,F,T,x,7,c[12]),T=t(T,I,P,F,w,12,c[13]),F=t(F,T,I,P,K,17,c[14]),P=t(P,F,T,I,S,22,c[15]),I=i(I,P,F,T,u,5,c[16]),T=i(T,I,P,F,v,9,c[17]),F=i(F,T,I,P,C,14,c[18]),P=i(P,F,T,I,h,20,c[19]),I=i(I,P,F,T,m,5,c[20]),T=i(T,I,P,F,k,9,c[21]),F=i(F,T,I,P,S,14,c[22]),P=i(P,F,T,I,f,20,c[23]),I=i(I,P,F,T,D,5,c[24]),T=i(T,I,P,F,K,9,c[25]),F=i(F,T,I,P,g,14,c[26]),P=i(P,F,T,I,b,20,c[27]),I=i(I,P,F,T,w,5,c[28]),T=i(T,I,P,F,p,9,c[29]),F=i(F,T,I,P,y,14,c[30]),P=i(P,F,T,I,x,20,c[31]),I=a(I,P,F,T,m,4,c[32]),T=a(T,I,P,F,b,11,c[33]),F=a(F,T,I,P,C,16,c[34]),P=a(P,F,T,I,K,23,c[35]),I=a(I,P,F,T,u,4,c[36]),T=a(T,I,P,F,f,11,c[37]),F=a(F,T,I,P,y,16,c[38]),P=a(P,F,T,I,k,23,c[39]),I=a(I,P,F,T,w,4,c[40]),T=a(T,I,P,F,h,11,c[41]),F=a(F,T,I,P,g,16,c[42]),P=a(P,F,T,I,v,23,c[43]),I=a(I,P,F,T,D,4,c[44]),T=a(T,I,P,F,x,11,c[45]),F=a(F,T,I,P,S,16,c[46]),P=a(P,F,T,I,p,23,c[47]),I=n(I,P,F,T,h,6,c[48]),T=n(T,I,P,F,y,10,c[49]),F=n(F,T,I,P,K,15,c[50]),P=n(P,F,T,I,m,21,c[51]),I=n(I,P,F,T,x,6,c[52]),T=n(T,I,P,F,g,10,c[53]),F=n(F,T,I,P,k,15,c[54]),P=n(P,F,T,I,u,21,c[55]),I=n(I,P,F,T,b,6,c[56]),T=n(T,I,P,F,S,10,c[57]),F=n(F,T,I,P,v,15,c[58]),P=n(P,F,T,I,w,21,c[59]),I=n(I,P,F,T,f,6,c[60]),T=n(T,I,P,F,C,10,c[61]),F=n(F,T,I,P,p,15,c[62]),P=n(P,F,T,I,D,21,c[63]),d[0]=d[0]+I|0,d[1]=d[1]+P|0,d[2]=d[2]+F|0,d[3]=d[3]+T|0},_doFinalize:function(){var t=this._data,i=t.words,a=8*this._nDataBytes,n=8*t.sigBytes;i[n>>>5]|=128<<24-n%32;var o=e.floor(a/4294967296),r=a;i[(n+64>>>9<<4)+15]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),i[(n+64>>>9<<4)+14]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(i.length+1),this._process();for(var s=this._hash,l=s.words,d=0;4>d;d++){var c=l[d];l[d]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return s},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}});o.MD5=l._createHelper(h),o.HmacMD5=l._createHmacHelper(h)}(Math),function(){var e=CryptoJS,t=e.lib,i=t.WordArray,a=t.Hasher,n=e.algo,o=[],r=n.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=this._hash.words,a=i[0],n=i[1],r=i[2],s=i[3],l=i[4],d=0;80>d;d++){if(16>d)o[d]=0|e[t+d];else{var c=o[d-3]^o[d-8]^o[d-14]^o[d-16];o[d]=c<<1|c>>>31}var h=(a<<5|a>>>27)+l+o[d];h+=20>d?(n&r|~n&s)+1518500249:40>d?(n^r^s)+1859775393:60>d?(n&r|n&s|r&s)-1894007588:(n^r^s)-899497514,l=s,s=r,r=n<<30|n>>>2,n=a,a=h}i[0]=i[0]+a|0,i[1]=i[1]+n|0,i[2]=i[2]+r|0,i[3]=i[3]+s|0,i[4]=i[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,a=8*e.sigBytes;return t[a>>>5]|=128<<24-a%32,t[(a+64>>>9<<4)+14]=Math.floor(i/4294967296),t[(a+64>>>9<<4)+15]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=a._createHelper(r),e.HmacSHA1=a._createHmacHelper(r)}(),function(e){var t=CryptoJS,i=t.lib,a=i.WordArray,n=i.Hasher,o=t.algo,r=[],s=[];!function(){function t(t){for(var i=e.sqrt(t),a=2;i>=a;a++)if(!(t%a))return!1;return!0}function i(e){return 4294967296*(e-(0|e))|0}for(var a=2,n=0;64>n;)t(a)&&(8>n&&(r[n]=i(e.pow(a,.5))),s[n]=i(e.pow(a,1/3)),n++),a++}();var l=[],d=o.SHA256=n.extend({_doReset:function(){this._hash=new a.init(r.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,a=i[0],n=i[1],o=i[2],r=i[3],d=i[4],c=i[5],h=i[6],u=i[7],p=0;64>p;p++){if(16>p)l[p]=0|e[t+p];else{var g=l[p-15],f=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,m=l[p-2],v=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;l[p]=f+l[p-7]+v+l[p-16]}var y=d&c^~d&h,b=a&n^a&o^n&o,D=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),k=(d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25),C=u+k+y+s[p]+l[p],x=D+b;u=h,h=c,c=d,d=r+C|0,r=o,o=n,n=a,a=C+x|0}i[0]=i[0]+a|0,i[1]=i[1]+n|0,i[2]=i[2]+o|0,i[3]=i[3]+r|0,i[4]=i[4]+d|0,i[5]=i[5]+c|0,i[6]=i[6]+h|0,i[7]=i[7]+u|0},_doFinalize:function(){var t=this._data,i=t.words,a=8*this._nDataBytes,n=8*t.sigBytes;return i[n>>>5]|=128<<24-n%32,i[(n+64>>>9<<4)+14]=e.floor(a/4294967296),i[(n+64>>>9<<4)+15]=a,t.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=n._createHelper(d),t.HmacSHA256=n._createHmacHelper(d)}(Math),function(){function e(e){return e<<8&4278255360|e>>>8&16711935}var t=CryptoJS,i=t.lib,a=i.WordArray,n=t.enc;n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,i=e.sigBytes,a=[],n=0;i>n;n+=2){var o=t[n>>>2]>>>16-n%4*8&65535;a.push(String.fromCharCode(o))}return a.join("")},parse:function(e){for(var t=e.length,i=[],n=0;t>n;n++)i[n>>>1]|=e.charCodeAt(n)<<16-n%2*16;return a.create(i,2*t)}};n.Utf16LE={stringify:function(t){for(var i=t.words,a=t.sigBytes,n=[],o=0;a>o;o+=2){var r=e(i[o>>>2]>>>16-o%4*8&65535);n.push(String.fromCharCode(r))}return n.join("")},parse:function(t){for(var i=t.length,n=[],o=0;i>o;o++)n[o>>>1]|=e(t.charCodeAt(o)<<16-o%2*16);return a.create(n,2*i)}}}(),function(){if("function"==typeof ArrayBuffer){var e=CryptoJS,t=e.lib,i=t.WordArray,a=i.init,n=i.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,i=[],n=0;t>n;n++)i[n>>>2]|=e[n]<<24-n%4*8;a.call(this,i,t)}else a.apply(this,arguments)};n.prototype=i}}(),function(e){function t(e,t,i){return e^t^i}function i(e,t,i){return e&t|~e&i}function a(e,t,i){return(e|~t)^i}function n(e,t,i){return e&i|t&~i}function o(e,t,i){return e^(t|~i)}function r(e,t){return e<<t|e>>>32-t}var s=CryptoJS,l=s.lib,d=l.WordArray,c=l.Hasher,h=s.algo,u=d.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),p=d.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),g=d.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=d.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),m=d.create([0,1518500249,1859775393,2400959708,2840853838]),v=d.create([1352829926,1548603684,1836072691,2053994217,0]),y=h.RIPEMD160=c.extend({_doReset:function(){this._hash=d.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,s){for(var l=0;16>l;l++){var d=s+l,c=e[d];e[d]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var h,y,b,D,k,C,x,w,K,S,I=this._hash.words,P=m.words,F=v.words,T=u.words,_=p.words,A=g.words,L=f.words;C=h=I[0],x=y=I[1],w=b=I[2],K=D=I[3],S=k=I[4];for(var M,l=0;80>l;l+=1)M=h+e[s+T[l]]|0,M+=16>l?t(y,b,D)+P[0]:32>l?i(y,b,D)+P[1]:48>l?a(y,b,D)+P[2]:64>l?n(y,b,D)+P[3]:o(y,b,D)+P[4],M=0|M,M=r(M,A[l]),M=M+k|0,h=k,k=D,D=r(b,10),b=y,y=M,M=C+e[s+_[l]]|0,M+=16>l?o(x,w,K)+F[0]:32>l?n(x,w,K)+F[1]:48>l?a(x,w,K)+F[2]:64>l?i(x,w,K)+F[3]:t(x,w,K)+F[4],M=0|M,M=r(M,L[l]),M=M+S|0,C=S,S=K,K=r(w,10),w=x,x=M;M=I[1]+b+K|0,I[1]=I[2]+D+S|0,I[2]=I[3]+k+C|0,I[3]=I[4]+h+x|0,I[4]=I[0]+y+w|0,I[0]=M},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,a=8*e.sigBytes;t[a>>>5]|=128<<24-a%32,t[(a+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(t.length+1),this._process();for(var n=this._hash,o=n.words,r=0;5>r;r++){var s=o[r];o[r]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return n},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}});s.RIPEMD160=c._createHelper(y),s.HmacRIPEMD160=c._createHmacHelper(y)}(Math),function(){var e=CryptoJS,t=e.lib,i=t.Base,a=e.enc,n=a.Utf8,o=e.algo;o.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var i=e.blockSize,a=4*i;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),r=this._iKey=t.clone(),s=o.words,l=r.words,d=0;i>d;d++)s[d]^=1549556828,l[d]^=909522486;o.sigBytes=r.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,i=t.finalize(e);t.reset();var a=t.finalize(this._oKey.clone().concat(i));return a}})}(),function(){var e=CryptoJS,t=e.lib,i=t.Base,a=t.WordArray,n=e.algo,o=n.SHA1,r=n.HMAC,s=n.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i=this.cfg,n=r.create(i.hasher,e),o=a.create(),s=a.create([1]),l=o.words,d=s.words,c=i.keySize,h=i.iterations;l.length<c;){var u=n.update(t).finalize(s);n.reset();for(var p=u.words,g=p.length,f=u,m=1;h>m;m++){f=n.finalize(f),n.reset();for(var v=f.words,y=0;g>y;y++)p[y]^=v[y]}o.concat(u),d[0]++}return o.sigBytes=4*c,o}});e.PBKDF2=function(e,t,i){return s.create(i).compute(e,t)}}(),function(){var e=CryptoJS,t=e.lib,i=t.Base,a=t.WordArray,n=e.algo,o=n.MD5,r=n.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i,n=this.cfg,o=n.hasher.create(),r=a.create(),s=r.words,l=n.keySize,d=n.iterations;s.length<l;){i&&o.update(i),i=o.update(e).finalize(t),o.reset();for(var c=1;d>c;c++)i=o.finalize(i),o.reset();r.concat(i)}return r.sigBytes=4*l,r}});e.EvpKDF=function(e,t,i){return r.create(i).compute(e,t)}}(),function(){var e=CryptoJS,t=e.lib,i=t.WordArray,a=e.algo,n=a.SHA256,o=a.SHA224=n.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=n._createHelper(o),e.HmacSHA224=n._createHmacHelper(o)}(),function(e){var t=CryptoJS,i=t.lib,a=i.Base,n=i.WordArray,o=t.x64={};o.Word=a.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=a.extend({init:function(t,i){t=this.words=t||[],i!=e?this.sigBytes=i:this.sigBytes=8*t.length},toX32:function(){for(var e=this.words,t=e.length,i=[],a=0;t>a;a++){var o=e[a];i.push(o.high),i.push(o.low)}return n.create(i,this.sigBytes)},clone:function(){for(var e=a.clone.call(this),t=e.words=this.words.slice(0),i=t.length,n=0;i>n;n++)t[n]=t[n].clone();return e}})}(),function(e){var t=CryptoJS,i=t.lib,a=i.WordArray,n=i.Hasher,o=t.x64,r=o.Word,s=t.algo,l=[],d=[],c=[];!function(){for(var e=1,t=0,i=0;24>i;i++){l[e+5*t]=(i+1)*(i+2)/2%64;var a=t%5,n=(2*e+3*t)%5;e=a,t=n}for(var e=0;5>e;e++)for(var t=0;5>t;t++)d[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,s=0;24>s;s++){for(var h=0,u=0,p=0;7>p;p++){if(1&o){var g=(1<<p)-1;32>g?u^=1<<g:h^=1<<g-32}128&o?o=o<<1^113:o<<=1}c[s]=r.create(h,u)}}();var h=[];!function(){for(var e=0;25>e;e++)h[e]=r.create()}();var u=s.SHA3=n.extend({cfg:n.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;25>t;t++)e[t]=new r.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var i=this._state,a=this.blockSize/2,n=0;a>n;n++){var o=e[t+2*n],r=e[t+2*n+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);var s=i[n];s.high^=r,s.low^=o}for(var u=0;24>u;u++){for(var p=0;5>p;p++){for(var g=0,f=0,m=0;5>m;m++){var s=i[p+5*m];g^=s.high,f^=s.low}var v=h[p];v.high=g,v.low=f}for(var p=0;5>p;p++)for(var y=h[(p+4)%5],b=h[(p+1)%5],D=b.high,k=b.low,g=y.high^(D<<1|k>>>31),f=y.low^(k<<1|D>>>31),m=0;5>m;m++){var s=i[p+5*m];s.high^=g,s.low^=f}for(var C=1;25>C;C++){var g,f,s=i[C],x=s.high,w=s.low,K=l[C];32>K?(g=x<<K|w>>>32-K,f=w<<K|x>>>32-K):(g=w<<K-32|x>>>64-K,f=x<<K-32|w>>>64-K);var S=h[d[C]];S.high=g,S.low=f}var I=h[0],P=i[0];I.high=P.high,I.low=P.low;for(var p=0;5>p;p++)for(var m=0;5>m;m++){var C=p+5*m,s=i[C],F=h[C],T=h[(p+1)%5+5*m],_=h[(p+2)%5+5*m];s.high=F.high^~T.high&_.high,s.low=F.low^~T.low&_.low}var s=i[0],A=c[u];s.high^=A.high,s.low^=A.low}},_doFinalize:function(){var t=this._data,i=t.words,n=(8*this._nDataBytes,8*t.sigBytes),o=32*this.blockSize;i[n>>>5]|=1<<24-n%32,i[(e.ceil((n+1)/o)*o>>>5)-1]|=128,t.sigBytes=4*i.length,this._process();
for(var r=this._state,s=this.cfg.outputLength/8,l=s/8,d=[],c=0;l>c;c++){var h=r[c],u=h.high,p=h.low;u=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),d.push(p),d.push(u)}return new a.init(d,s)},clone:function(){for(var e=n.clone.call(this),t=e._state=this._state.slice(0),i=0;25>i;i++)t[i]=t[i].clone();return e}});t.SHA3=n._createHelper(u),t.HmacSHA3=n._createHmacHelper(u)}(Math),function(){function e(){return o.create.apply(o,arguments)}var t=CryptoJS,i=t.lib,a=i.Hasher,n=t.x64,o=n.Word,r=n.WordArray,s=t.algo,l=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],d=[];!function(){for(var t=0;80>t;t++)d[t]=e()}();var c=s.SHA512=a.extend({_doReset:function(){this._hash=new r.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var i=this._hash.words,a=i[0],n=i[1],o=i[2],r=i[3],s=i[4],c=i[5],h=i[6],u=i[7],p=a.high,g=a.low,f=n.high,m=n.low,v=o.high,y=o.low,b=r.high,D=r.low,k=s.high,C=s.low,x=c.high,w=c.low,K=h.high,S=h.low,I=u.high,P=u.low,F=p,T=g,_=f,A=m,L=v,M=y,E=b,B=D,R=k,N=C,H=x,O=w,V=K,j=S,z=I,U=P,q=0;80>q;q++){var G,$,W=d[q];if(16>q)$=W.high=0|e[t+2*q],G=W.low=0|e[t+2*q+1];else{var J=d[q-15],Q=J.high,X=J.low,Y=(Q>>>1|X<<31)^(Q>>>8|X<<24)^Q>>>7,Z=(X>>>1|Q<<31)^(X>>>8|Q<<24)^(X>>>7|Q<<25),ee=d[q-2],te=ee.high,ie=ee.low,ae=(te>>>19|ie<<13)^(te<<3|ie>>>29)^te>>>6,ne=(ie>>>19|te<<13)^(ie<<3|te>>>29)^(ie>>>6|te<<26),oe=d[q-7],re=oe.high,se=oe.low,le=d[q-16],de=le.high,ce=le.low;G=Z+se,$=Y+re+(Z>>>0>G>>>0?1:0),G+=ne,$=$+ae+(ne>>>0>G>>>0?1:0),G+=ce,$=$+de+(ce>>>0>G>>>0?1:0),W.high=$,W.low=G}var he=R&H^~R&V,ue=N&O^~N&j,pe=F&_^F&L^_&L,ge=T&A^T&M^A&M,fe=(F>>>28|T<<4)^(F<<30|T>>>2)^(F<<25|T>>>7),me=(T>>>28|F<<4)^(T<<30|F>>>2)^(T<<25|F>>>7),ve=(R>>>14|N<<18)^(R>>>18|N<<14)^(R<<23|N>>>9),ye=(N>>>14|R<<18)^(N>>>18|R<<14)^(N<<23|R>>>9),be=l[q],De=be.high,ke=be.low,Ce=U+ye,xe=z+ve+(U>>>0>Ce>>>0?1:0),Ce=Ce+ue,xe=xe+he+(ue>>>0>Ce>>>0?1:0),Ce=Ce+ke,xe=xe+De+(ke>>>0>Ce>>>0?1:0),Ce=Ce+G,xe=xe+$+(G>>>0>Ce>>>0?1:0),we=me+ge,Ke=fe+pe+(me>>>0>we>>>0?1:0);z=V,U=j,V=H,j=O,H=R,O=N,N=B+Ce|0,R=E+xe+(B>>>0>N>>>0?1:0)|0,E=L,B=M,L=_,M=A,_=F,A=T,T=Ce+we|0,F=xe+Ke+(Ce>>>0>T>>>0?1:0)|0}g=a.low=g+T,a.high=p+F+(T>>>0>g>>>0?1:0),m=n.low=m+A,n.high=f+_+(A>>>0>m>>>0?1:0),y=o.low=y+M,o.high=v+L+(M>>>0>y>>>0?1:0),D=r.low=D+B,r.high=b+E+(B>>>0>D>>>0?1:0),C=s.low=C+N,s.high=k+R+(N>>>0>C>>>0?1:0),w=c.low=w+O,c.high=x+H+(O>>>0>w>>>0?1:0),S=h.low=S+j,h.high=K+V+(j>>>0>S>>>0?1:0),P=u.low=P+U,u.high=I+z+(U>>>0>P>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,a=8*e.sigBytes;t[a>>>5]|=128<<24-a%32,t[(a+128>>>10<<5)+30]=Math.floor(i/4294967296),t[(a+128>>>10<<5)+31]=i,e.sigBytes=4*t.length,this._process();var n=this._hash.toX32();return n},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=a._createHelper(c),t.HmacSHA512=a._createHmacHelper(c)}(),function(){var e=CryptoJS,t=e.x64,i=t.Word,a=t.WordArray,n=e.algo,o=n.SHA512,r=n.SHA384=o.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=o._createHelper(r),e.HmacSHA384=o._createHmacHelper(r)}(),CryptoJS.lib.Cipher||function(e){var t=CryptoJS,i=t.lib,a=i.Base,n=i.WordArray,o=i.BufferedBlockAlgorithm,r=t.enc,s=(r.Utf8,r.Base64),l=t.algo,d=l.EvpKDF,c=i.Cipher=o.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,i){this.cfg=this.cfg.extend(i),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?C:b}return function(t){return{encrypt:function(i,a,n){return e(a).encrypt(t,i,a,n)},decrypt:function(i,a,n){return e(a).decrypt(t,i,a,n)}}}}()}),h=(i.StreamCipher=c.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),t.mode={}),u=i.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),p=h.CBC=function(){function t(t,i,a){var n,o=this._iv;o?(n=o,this._iv=e):n=this._prevBlock;for(var r=0;a>r;r++)t[i+r]^=n[r]}var i=u.extend();return i.Encryptor=i.extend({processBlock:function(e,i){var a=this._cipher,n=a.blockSize;t.call(this,e,i,n),a.encryptBlock(e,i),this._prevBlock=e.slice(i,i+n)}}),i.Decryptor=i.extend({processBlock:function(e,i){var a=this._cipher,n=a.blockSize,o=e.slice(i,i+n);a.decryptBlock(e,i),t.call(this,e,i,n),this._prevBlock=o}}),i}(),g=t.pad={},f=g.Pkcs7={pad:function(e,t){for(var i=4*t,a=i-e.sigBytes%i,o=a<<24|a<<16|a<<8|a,r=[],s=0;a>s;s+=4)r.push(o);var l=n.create(r,a);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},m=(i.BlockCipher=c.extend({cfg:c.cfg.extend({mode:p,padding:f}),reset:function(){var e;c.reset.call(this);var t=this.cfg,i=t.iv,a=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=a.createEncryptor:(e=a.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,i&&i.words):(this._mode=e.call(a,this,i&&i.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),i.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=t.format={},y=v.OpenSSL={stringify:function(e){var t,i=e.ciphertext,a=e.salt;return t=a?n.create([1398893684,1701076831]).concat(a).concat(i):i,t.toString(s)},parse:function(e){var t,i=s.parse(e),a=i.words;return 1398893684==a[0]&&1701076831==a[1]&&(t=n.create(a.slice(2,4)),a.splice(0,4),i.sigBytes-=16),m.create({ciphertext:i,salt:t})}},b=i.SerializableCipher=a.extend({cfg:a.extend({format:y}),encrypt:function(e,t,i,a){a=this.cfg.extend(a);var n=e.createEncryptor(i,a),o=n.finalize(t),r=n.cfg;return m.create({ciphertext:o,key:i,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:a.format})},decrypt:function(e,t,i,a){a=this.cfg.extend(a),t=this._parse(t,a.format);var n=e.createDecryptor(i,a).finalize(t.ciphertext);return n},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),D=t.kdf={},k=D.OpenSSL={execute:function(e,t,i,a){a||(a=n.random(8));var o=d.create({keySize:t+i}).compute(e,a),r=n.create(o.words.slice(t),4*i);return o.sigBytes=4*t,m.create({key:o,iv:r,salt:a})}},C=i.PasswordBasedCipher=b.extend({cfg:b.cfg.extend({kdf:k}),encrypt:function(e,t,i,a){a=this.cfg.extend(a);var n=a.kdf.execute(i,e.keySize,e.ivSize);a.iv=n.iv;var o=b.encrypt.call(this,e,t,n.key,a);return o.mixIn(n),o},decrypt:function(e,t,i,a){a=this.cfg.extend(a),t=this._parse(t,a.format);var n=a.kdf.execute(i,e.keySize,e.ivSize,t.salt);a.iv=n.iv;var o=b.decrypt.call(this,e,t,n.key,a);return o}})}(),CryptoJS.mode.CFB=function(){function e(e,t,i,a){var n,o=this._iv;o?(n=o.slice(0),this._iv=void 0):n=this._prevBlock,a.encryptBlock(n,0);for(var r=0;i>r;r++)e[t+r]^=n[r]}var t=CryptoJS.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(t,i){var a=this._cipher,n=a.blockSize;e.call(this,t,i,n,a),this._prevBlock=t.slice(i,i+n)}}),t.Decryptor=t.extend({processBlock:function(t,i){var a=this._cipher,n=a.blockSize,o=t.slice(i,i+n);e.call(this,t,i,n,a),this._prevBlock=o}}),t}(),CryptoJS.mode.ECB=function(){var e=CryptoJS.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),CryptoJS.pad.AnsiX923={pad:function(e,t){var i=e.sigBytes,a=4*t,n=a-i%a,o=i+n-1;e.clamp(),e.words[o>>>2]|=n<<24-o%4*8,e.sigBytes+=n},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},CryptoJS.pad.Iso10126={pad:function(e,t){var i=4*t,a=i-e.sigBytes%i;e.concat(CryptoJS.lib.WordArray.random(a-1)).concat(CryptoJS.lib.WordArray.create([a<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},CryptoJS.pad.Iso97971={pad:function(e,t){e.concat(CryptoJS.lib.WordArray.create([2147483648],1)),CryptoJS.pad.ZeroPadding.pad(e,t)},unpad:function(e){CryptoJS.pad.ZeroPadding.unpad(e),e.sigBytes--}},CryptoJS.mode.OFB=function(){var e=CryptoJS.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var i=this._cipher,a=i.blockSize,n=this._iv,o=this._keystream;n&&(o=this._keystream=n.slice(0),this._iv=void 0),i.encryptBlock(o,0);for(var r=0;a>r;r++)e[t+r]^=o[r]}});return e.Decryptor=t,e}(),CryptoJS.pad.NoPadding={pad:function(){},unpad:function(){}},function(e){var t=CryptoJS,i=t.lib,a=i.CipherParams,n=t.enc,o=n.Hex,r=t.format;r.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){var t=o.parse(e);return a.create({ciphertext:t})}}}(),function(){var e=CryptoJS,t=e.lib,i=t.BlockCipher,a=e.algo,n=[],o=[],r=[],s=[],l=[],d=[],c=[],h=[],u=[],p=[];!function(){for(var e=[],t=0;256>t;t++)128>t?e[t]=t<<1:e[t]=t<<1^283;for(var i=0,a=0,t=0;256>t;t++){var g=a^a<<1^a<<2^a<<3^a<<4;g=g>>>8^255&g^99,n[i]=g,o[g]=i;var f=e[i],m=e[f],v=e[m],y=257*e[g]^16843008*g;r[i]=y<<24|y>>>8,s[i]=y<<16|y>>>16,l[i]=y<<8|y>>>24,d[i]=y;var y=16843009*v^65537*m^257*f^16843008*i;c[g]=y<<24|y>>>8,h[g]=y<<16|y>>>16,u[g]=y<<8|y>>>24,p[g]=y,i?(i=f^e[e[e[v^f]]],a^=e[e[a]]):i=a=1}}();var g=[0,1,2,4,8,16,32,64,128,27,54],f=a.AES=i.extend({_doReset:function(){var e;if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,i=t.words,a=t.sigBytes/4,o=this._nRounds=a+6,r=4*(o+1),s=this._keySchedule=[],l=0;r>l;l++)a>l?s[l]=i[l]:(e=s[l-1],l%a?a>6&&l%a==4&&(e=n[e>>>24]<<24|n[e>>>16&255]<<16|n[e>>>8&255]<<8|n[255&e]):(e=e<<8|e>>>24,e=n[e>>>24]<<24|n[e>>>16&255]<<16|n[e>>>8&255]<<8|n[255&e],e^=g[l/a|0]<<24),s[l]=s[l-a]^e);for(var d=this._invKeySchedule=[],f=0;r>f;f++){var l=r-f;if(f%4)var e=s[l];else var e=s[l-4];4>f||4>=l?d[f]=e:d[f]=c[n[e>>>24]]^h[n[e>>>16&255]]^u[n[e>>>8&255]]^p[n[255&e]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,r,s,l,d,n)},decryptBlock:function(e,t){var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i,this._doCryptBlock(e,t,this._invKeySchedule,c,h,u,p,o);var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i},_doCryptBlock:function(e,t,i,a,n,o,r,s){for(var l=this._nRounds,d=e[t]^i[0],c=e[t+1]^i[1],h=e[t+2]^i[2],u=e[t+3]^i[3],p=4,g=1;l>g;g++){var f=a[d>>>24]^n[c>>>16&255]^o[h>>>8&255]^r[255&u]^i[p++],m=a[c>>>24]^n[h>>>16&255]^o[u>>>8&255]^r[255&d]^i[p++],v=a[h>>>24]^n[u>>>16&255]^o[d>>>8&255]^r[255&c]^i[p++],y=a[u>>>24]^n[d>>>16&255]^o[c>>>8&255]^r[255&h]^i[p++];d=f,c=m,h=v,u=y}var f=(s[d>>>24]<<24|s[c>>>16&255]<<16|s[h>>>8&255]<<8|s[255&u])^i[p++],m=(s[c>>>24]<<24|s[h>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^i[p++],v=(s[h>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&c])^i[p++],y=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[c>>>8&255]<<8|s[255&h])^i[p++];e[t]=f,e[t+1]=m,e[t+2]=v,e[t+3]=y},keySize:8});e.AES=i._createHelper(f)}(),function(){function e(e,t){var i=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=i,this._lBlock^=i<<e}function t(e,t){var i=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=i,this._rBlock^=i<<e}var i=CryptoJS,a=i.lib,n=a.WordArray,o=a.BlockCipher,r=i.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],d=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=r.DES=o.extend({_doReset:function(){for(var e=this._key,t=e.words,i=[],a=0;56>a;a++){var n=s[a]-1;i[a]=t[n>>>5]>>>31-n%32&1}for(var o=this._subKeys=[],r=0;16>r;r++){for(var c=o[r]=[],h=d[r],a=0;24>a;a++)c[a/6|0]|=i[(l[a]-1+h)%28]<<31-a%6,c[4+(a/6|0)]|=i[28+(l[a+24]-1+h)%28]<<31-a%6;c[0]=c[0]<<1|c[0]>>>31;for(var a=1;7>a;a++)c[a]=c[a]>>>4*(a-1)+3;c[7]=c[7]<<5|c[7]>>>27}for(var u=this._invSubKeys=[],a=0;16>a;a++)u[a]=o[15-a]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(i,a,n){this._lBlock=i[a],this._rBlock=i[a+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var o=0;16>o;o++){for(var r=n[o],s=this._lBlock,l=this._rBlock,d=0,u=0;8>u;u++)d|=c[u][((l^r[u])&h[u])>>>0];this._lBlock=l,this._rBlock=s^d}var p=this._lBlock;this._lBlock=this._rBlock,this._rBlock=p,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),i[a]=this._lBlock,i[a+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});i.DES=o._createHelper(u);var p=r.TripleDES=o.extend({_doReset:function(){var e=this._key,t=e.words;if(2!==t.length&&4!==t.length&&t.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var i=t.slice(0,2),a=t.length<4?t.slice(0,2):t.slice(2,4),o=t.length<6?t.slice(0,2):t.slice(4,6);this._des1=u.createEncryptor(n.create(i)),this._des2=u.createEncryptor(n.create(a)),this._des3=u.createEncryptor(n.create(o))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});i.TripleDES=o._createHelper(p)}(),function(){function e(){for(var e=this._S,t=this._i,i=this._j,a=0,n=0;4>n;n++){t=(t+1)%256,i=(i+e[t])%256;var o=e[t];e[t]=e[i],e[i]=o,a|=e[(e[t]+e[i])%256]<<24-8*n}return this._i=t,this._j=i,a}var t=CryptoJS,i=t.lib,a=i.StreamCipher,n=t.algo,o=n.RC4=a.extend({_doReset:function(){for(var e=this._key,t=e.words,i=e.sigBytes,a=this._S=[],n=0;256>n;n++)a[n]=n;for(var n=0,o=0;256>n;n++){var r=n%i,s=t[r>>>2]>>>24-r%4*8&255;o=(o+a[n]+s)%256;var l=a[n];a[n]=a[o],a[o]=l}this._i=this._j=0},_doProcessBlock:function(t,i){t[i]^=e.call(this)},keySize:8,ivSize:0});t.RC4=a._createHelper(o);var r=n.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var t=this.cfg.drop;t>0;t--)e.call(this)}});t.RC4Drop=a._createHelper(r)}(),CryptoJS.mode.CTRGladman=function(){function e(e){if(255===(e>>24&255)){var t=e>>16&255,i=e>>8&255,a=255&e;255===t?(t=0,255===i?(i=0,255===a?a=0:++a):++i):++t,e=0,e+=t<<16,e+=i<<8,e+=a}else e+=1<<24;return e}function t(t){return 0===(t[0]=e(t[0]))&&(t[1]=e(t[1])),t}var i=CryptoJS.lib.BlockCipherMode.extend(),a=i.Encryptor=i.extend({processBlock:function(e,i){var a=this._cipher,n=a.blockSize,o=this._iv,r=this._counter;o&&(r=this._counter=o.slice(0),this._iv=void 0),t(r);var s=r.slice(0);a.encryptBlock(s,0);for(var l=0;n>l;l++)e[i+l]^=s[l]}});return i.Decryptor=a,i}(),function(){function e(){for(var e=this._X,t=this._C,i=0;8>i;i++)r[i]=t[i];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0;for(var i=0;8>i;i++){var a=e[i]+t[i],n=65535&a,o=a>>>16,l=((n*n>>>17)+n*o>>>15)+o*o,d=((4294901760&a)*a|0)+((65535&a)*a|0);s[i]=l^d}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}var t=CryptoJS,i=t.lib,a=i.StreamCipher,n=t.algo,o=[],r=[],s=[],l=n.Rabbit=a.extend({_doReset:function(){for(var t=this._key.words,i=this.cfg.iv,a=0;4>a;a++)t[a]=16711935&(t[a]<<8|t[a]>>>24)|4278255360&(t[a]<<24|t[a]>>>8);var n=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],o=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];this._b=0;for(var a=0;4>a;a++)e.call(this);for(var a=0;8>a;a++)o[a]^=n[a+4&7];if(i){var r=i.words,s=r[0],l=r[1],d=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),h=d>>>16|4294901760&c,u=c<<16|65535&d;o[0]^=d,o[1]^=h,o[2]^=c,o[3]^=u,o[4]^=d,o[5]^=h,o[6]^=c,o[7]^=u;for(var a=0;4>a;a++)e.call(this)}},_doProcessBlock:function(t,i){var a=this._X;e.call(this),o[0]=a[0]^a[5]>>>16^a[3]<<16,o[1]=a[2]^a[7]>>>16^a[5]<<16,o[2]=a[4]^a[1]>>>16^a[7]<<16,o[3]=a[6]^a[3]>>>16^a[1]<<16;for(var n=0;4>n;n++)o[n]=16711935&(o[n]<<8|o[n]>>>24)|4278255360&(o[n]<<24|o[n]>>>8),t[i+n]^=o[n]},blockSize:4,ivSize:2});t.Rabbit=a._createHelper(l)}(),CryptoJS.mode.CTR=function(){var e=CryptoJS.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var i=this._cipher,a=i.blockSize,n=this._iv,o=this._counter;n&&(o=this._counter=n.slice(0),this._iv=void 0);var r=o.slice(0);i.encryptBlock(r,0),o[a-1]=o[a-1]+1|0;for(var s=0;a>s;s++)e[t+s]^=r[s]}});return e.Decryptor=t,e}(),function(){function e(){for(var e=this._X,t=this._C,i=0;8>i;i++)r[i]=t[i];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0;for(var i=0;8>i;i++){var a=e[i]+t[i],n=65535&a,o=a>>>16,l=((n*n>>>17)+n*o>>>15)+o*o,d=((4294901760&a)*a|0)+((65535&a)*a|0);s[i]=l^d}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}var t=CryptoJS,i=t.lib,a=i.StreamCipher,n=t.algo,o=[],r=[],s=[],l=n.RabbitLegacy=a.extend({_doReset:function(){var t=this._key.words,i=this.cfg.iv,a=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],n=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];this._b=0;for(var o=0;4>o;o++)e.call(this);for(var o=0;8>o;o++)n[o]^=a[o+4&7];if(i){var r=i.words,s=r[0],l=r[1],d=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),h=d>>>16|4294901760&c,u=c<<16|65535&d;n[0]^=d,n[1]^=h,n[2]^=c,n[3]^=u,n[4]^=d,n[5]^=h,n[6]^=c,n[7]^=u;for(var o=0;4>o;o++)e.call(this)}},_doProcessBlock:function(t,i){var a=this._X;e.call(this),o[0]=a[0]^a[5]>>>16^a[3]<<16,o[1]=a[2]^a[7]>>>16^a[5]<<16,o[2]=a[4]^a[1]>>>16^a[7]<<16,o[3]=a[6]^a[3]>>>16^a[1]<<16;for(var n=0;4>n;n++)o[n]=16711935&(o[n]<<8|o[n]>>>24)|4278255360&(o[n]<<24|o[n]>>>8),t[i+n]^=o[n]},blockSize:4,ivSize:2});t.RabbitLegacy=a._createHelper(l)}(),CryptoJS.pad.ZeroPadding={pad:function(e,t){var i=4*t;e.clamp(),e.sigBytes+=i-(e.sigBytes%i||i)},unpad:function(e){for(var t=e.words,i=e.sigBytes-1,i=e.sigBytes-1;i>=0;i--)if(t[i>>>2]>>>24-i%4*8&255){e.sigBytes=i+1;break}}},define("crypto_js",function(){}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,a,n,o,r,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,r=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,i=0;o>i;i+=1)r[i]=str(i,l)||"null";return n=0===r.length?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+s+"]":"["+r.join(",")+"]",gap=s,n}if(rep&&"object"==typeof rep)for(o=rep.length,i=0;o>i;i+=1)"string"==typeof rep[i]&&(a=rep[i],n=str(a,l),n&&r.push(quote(a)+(gap?": ":":")+n));else for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(n=str(a,l),n&&r.push(quote(a)+(gap?": ":":")+n));return n=0===r.length?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+s+"}":"{"+r.join(",")+"}",gap=s,n}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;
},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var a;if(gap="",indent="","number"==typeof i)for(a=0;i>a;a+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,a,n=e[t];if(n&&"object"==typeof n)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a=walk(n,i),void 0!==a?n[i]=a:delete n[i]);return reviver.call(e,t,n)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json2",function(){}),function(){var e,t,i;!function(a){function n(e,t){return D.call(e,t)}function o(e,t){var i,a,n,o,r,s,l,d,c,h,u=t&&t.split("/"),p=y.map,g=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(u=u.slice(0,u.length-1),e=u.concat(e.split("/")),d=0;e.length>d;d+=1)if(h=e[d],"."===h)e.splice(d,1),d-=1;else if(".."===h){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((u||g)&&p){for(i=e.split("/"),d=i.length;d>0;d-=1){if(a=i.slice(0,d).join("/"),u)for(c=u.length;c>0;c-=1)if(n=p[u.slice(0,c).join("/")],n&&(n=n[a])){o=n,r=d;break}if(o)break;!s&&g&&g[a]&&(s=g[a],l=d)}!o&&s&&(o=s,r=l),o&&(i.splice(0,r,o),e=i.join("/"))}return e}function r(e,t){return function(){return p.apply(a,k.call(arguments,0).concat([e,t]))}}function s(e){return function(t){return o(t,e)}}function l(e){return function(t){m[e]=t}}function d(e){if(n(v,e)){var t=v[e];delete v[e],b[e]=!0,u.apply(a,t)}if(!n(m,e)&&!n(b,e))throw Error("No "+e);return m[e]}function c(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function h(e){return function(){return y&&y.config&&y.config[e]||{}}}var u,p,g,f,m={},v={},y={},b={},D=Object.prototype.hasOwnProperty,k=[].slice;g=function(e,t){var i,a=c(e),n=a[0];return e=a[1],n&&(n=o(n,t),i=d(n)),n?e=i&&i.normalize?i.normalize(e,s(t)):o(e,t):(e=o(e,t),a=c(e),n=a[0],e=a[1],n&&(i=d(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:i}},f={require:function(e){return r(e)},exports:function(e){var t=m[e];return void 0!==t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:h(e)}}},u=function(e,t,i,o){var s,c,h,u,p,y,D=[];if(o=o||e,"function"==typeof i){for(t=!t.length&&i.length?["require","exports","module"]:t,p=0;t.length>p;p+=1)if(u=g(t[p],o),c=u.f,"require"===c)D[p]=f.require(e);else if("exports"===c)D[p]=f.exports(e),y=!0;else if("module"===c)s=D[p]=f.module(e);else if(n(m,c)||n(v,c)||n(b,c))D[p]=d(c);else{if(!u.p)throw Error(e+" missing "+c);u.p.load(u.n,r(o,!0),l(c),{}),D[p]=m[c]}h=i.apply(m[e],D),e&&(s&&s.exports!==a&&s.exports!==m[e]?m[e]=s.exports:h===a&&y||(m[e]=h))}else e&&(m[e]=i)},e=t=p=function(e,t,i,n,o){return"string"==typeof e?f[e]?f[e](t):d(g(e,t).f):(e.splice||(y=e,t.splice?(e=t,t=i,i=null):e=a),t=t||function(){},"function"==typeof i&&(i=n,n=o),n?u(a,e,t,i):setTimeout(function(){u(a,e,t,i)},4),p)},p.config=function(e){return y=e,y.deps&&p(y.deps,y.callback),p},i=function(e,t,i){t.splice||(i=t,t=[]),n(m,e)||n(v,e)||(v[e]=[e,t,i])},i.amd={jQuery:!0}}(),i("../node_modules/almond/almond",function(){}),i("jxg",[],function(){var e={};return"object"!=typeof JXG||JXG.extend||(e=JXG),e.extend=function(e,t,i,a){var n,o;i=i||!1,a=a||!1;for(n in t)(!i||i&&t.hasOwnProperty(n))&&(o=a?n.toLowerCase():n,e[o]=t[n])},e.extend(e,{boards:{},readers:{},elements:{},registerElement:function(e,t){e=e.toLowerCase(),this.elements[e]=t},registerReader:function(e,t){var i,a;for(i=0;t.length>i;i++)a=t[i].toLowerCase(),"function"!=typeof this.readers[a]&&(this.readers[a]=e)},shortcut:function(e,t){return function(){return e[t].apply(this,arguments)}},getRef:function(e,t){return e.select(t)},getReference:function(e,t){return e.select(t)},debugInt:function(){var e,t;for(e=0;arguments.length>e;e++)t=arguments[e],"object"==typeof window&&window.console&&console.log?console.log(t):"object"==typeof document&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=t+"<br/>")},debugWST:function(){var t=Error();e.debugInt.apply(this,arguments),t&&t.stack&&(e.debugInt("stacktrace"),e.debugInt(t.stack.split("\n").slice(1).join("\n")))},debugLine:function(){var t=Error();e.debugInt.apply(this,arguments),t&&t.stack&&e.debugInt("Called from",t.stack.split("\n").slice(2,3).join("\n"))},debug:function(){e.debugInt.apply(this,arguments)}}),e}),i("utils/zip",["jxg"],function(e){var t=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],n=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],r=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],s=256;return e.Util=e.Util||{},e.Util.Unzip=function(l){function d(){return R+=8,M>E?l[E++]:-1}function c(){B=1}function h(){var e;try{return R++,e=1&B,B>>=1,0===B&&(B=d(),e=1&B,B=128|B>>1),e}catch(t){throw t}}function u(e){var i=0,a=e;try{for(;a--;)i=i<<1|h();e&&(i=t[i]>>8-e)}catch(n){throw n}return i}function p(){A=0}function g(e){x++,_[A++]=e,P.push(String.fromCharCode(e)),32768===A&&(A=0)}function f(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function m(){for(;;){if(z[j]>=S)return-1;if(K[z[j]]===j)return z[j]++;z[j]++}}function v(){var e,t=V[O];if(17===j)return-1;if(O++,j++,e=m(),e>=0)t.b0=e;else if(t.b0=32768,v())return-1;if(e=m(),e>=0)t.b1=e,t.jump=null;else if(t.b1=32768,t.jump=V[O],t.jumppos=O,v())return-1;return j--,0}function y(e,t,i){var a;for(V=e,O=0,K=i,S=t,a=0;17>a;a++)z[a]=0;return j=0,v()?-1:0}function b(e){for(var t,i,a,n=0,o=e[n];;)if(a=h()){if(!(32768&o.b1))return o.b1;for(o=o.jump,t=e.length,i=0;t>i;i++)if(e[i]===o){n=i;break}}else{if(!(32768&o.b0))return o.b0;n++,o=e[n]}}function D(){var s,l,m,v,D,k,C,x,w,K,S,I,P,F,T,L,M;do if(s=h(),m=u(2),0===m)for(c(),K=d(),K|=d()<<8,I=d(),I|=d()<<8,65535&(K^~I)&&e.debug("BlockLen checksum mismatch\n");K--;)l=d(),g(l);else if(1===m)for(;;)if(D=t[u(7)]>>1,D>23?(D=D<<1|h(),D>199?(D-=128,D=D<<1|h()):(D-=48,D>143&&(D+=136))):D+=256,256>D)g(D);else{if(256===D)break;for(D-=257,w=u(a[D])+i[D],D=t[u(5)]>>3,o[D]>8?(S=u(8),S|=u(o[D]-8)<<8):S=u(o[D]),S+=n[D],D=0;w>D;D++)l=_[32767&A-S],g(l)}else if(2===m){for(C=Array(320),F=257+u(5),T=1+u(5),L=4+u(4),D=0;19>D;D++)C[D]=0;for(D=0;L>D;D++)C[r[D]]=u(3);for(w=H.length,v=0;w>v;v++)H[v]=new f;if(y(H,19,C,0))return p(),1;for(P=F+T,v=0,M=-1;P>v;)if(M++,D=b(H),16>D)C[v++]=D;else if(16===D){if(D=3+u(2),v+D>P)return p(),1;for(k=v?C[v-1]:0;D--;)C[v++]=k}else{if(D=17===D?3+u(3):11+u(7),v+D>P)return p(),1;for(;D--;)C[v++]=0}for(w=N.length,v=0;w>v;v++)N[v]=new f;if(y(N,F,C,0))return p(),1;for(w=N.length,v=0;w>v;v++)H[v]=new f;for(x=[],v=F;C.length>v;v++)x[v-F]=C[v];if(y(H,T,x,0))return p(),1;for(;;)if(D=b(N),D>=256){if(D-=256,0===D)break;for(D-=1,w=u(a[D])+i[D],D=b(H),o[D]>8?(S=u(8),S|=u(o[D]-8)<<8):S=u(o[D]),S+=n[D];w--;)l=_[32767&A-S],g(l)}else g(D)}while(!s);return p(),c(),0}function k(){var e,t,i,a,n,o,r,l,c=[];try{if(P=[],L=!1,c[0]=d(),c[1]=d(),120===c[0]&&218===c[1]&&(D(),T[F]=[P.join(""),"geonext.gxt"],F++),31===c[0]&&139===c[1]&&(I(),T[F]=[P.join(""),"file"],F++),80===c[0]&&75===c[1]&&(L=!0,c[2]=d(),c[3]=d(),3===c[2]&&4===c[3])){for(c[0]=d(),c[1]=d(),C=d(),C|=d()<<8,l=d(),l|=d()<<8,d(),d(),d(),d(),r=d(),r|=d()<<8,r|=d()<<16,r|=d()<<24,o=d(),o|=d()<<8,o|=d()<<16,o|=d()<<24,n=d(),n|=d()<<8,n|=d()<<16,n|=d()<<24,a=d(),a|=d()<<8,i=d(),i|=d()<<8,e=0,U=[];a--;)t=d(),"/"===t|":"===t?e=0:s-1>e&&(U[e++]=String.fromCharCode(t));for(w||(w=U),e=0;i>e;)t=d(),e++;x=0,8===l&&(D(),T[F]=Array(2),T[F][0]=P.join(""),T[F][1]=U.join(""),F++),I()}}catch(h){throw h}}var C,x,w,K,S,I,P=[],F=0,T=[],_=Array(32768),A=0,L=!1,M=l.length,E=0,B=1,R=0,N=Array(288),H=Array(32),O=0,V=null,j=(Array(64),Array(64),0),z=Array(17),U=[];z[0]=0,I=function(){var e,t,i,a,n,o,r=[];if(8&C&&(r[0]=d(),r[1]=d(),r[2]=d(),r[3]=d(),80===r[0]&&75===r[1]&&7===r[2]&&8===r[3]?(e=d(),e|=d()<<8,e|=d()<<16,e|=d()<<24):e=r[0]|r[1]<<8|r[2]<<16|r[3]<<24,t=d(),t|=d()<<8,t|=d()<<16,t|=d()<<24,i=d(),i|=d()<<8,i|=d()<<16,i|=d()<<24),L&&k(),r[0]=d(),8===r[0]){if(C=d(),d(),d(),d(),d(),d(),a=d(),4&C)for(r[0]=d(),r[2]=d(),j=r[0]+256*r[1],n=0;j>n;n++)d();if(8&C)for(n=0,U=[],o=d();o;)("7"===o||":"===o)&&(n=0),s-1>n&&(U[n++]=o),o=d();if(16&C)for(o=d();o;)o=d();2&C&&(d(),d()),D(),e=d(),e|=d()<<8,e|=d()<<16,e|=d()<<24,i=d(),i|=d()<<8,i|=d()<<16,i|=d()<<24,L&&k()}},e.Util.Unzip.prototype.unzipFile=function(e){var t;for(this.unzip(),t=0;T.length>t;t++)if(T[t][1]===e)return T[t][0];return""},e.Util.Unzip.prototype.unzip=function(){return k(),T}},e.Util}),i("utils/encoding",["jxg"],function(e){var t=0,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return e.Util=e.Util||{},e.Util.UTF8={encode:function(e){var t,i,a="",n=e.length;if(e=e.replace(/\r\n/g,"\n"),"function"==typeof unescape&&"function"==typeof encodeURIComponent)return unescape(encodeURIComponent(e));for(t=0;n>t;t++)i=e.charCodeAt(t),128>i?a+=String.fromCharCode(i):i>127&&2048>i?(a+=String.fromCharCode(192|i>>6),a+=String.fromCharCode(128|63&i)):(a+=String.fromCharCode(224|i>>12),a+=String.fromCharCode(128|63&i>>6),a+=String.fromCharCode(128|63&i));return a},decode:function(e){var a,n,o,r=0,s=0,l=t,d=[],c=e.length,h=[];for(a=0;c>a;a++)n=e.charCodeAt(a),o=i[n],s=l!==t?63&n|s<<6:255>>o&n,l=i[256+l+o],l===t&&(s>65535?d.push(55232+(s>>10),56320+(1023&s)):d.push(s),r++,0===r%1e4&&(h.push(String.fromCharCode.apply(null,d)),d=[]));return h.push(String.fromCharCode.apply(null,d)),h.join("")},asciiCharCodeAt:function(e,t){var i=e.charCodeAt(t);if(i>255)switch(i){case 8364:i=128;break;case 8218:i=130;break;case 402:i=131;break;case 8222:i=132;break;case 8230:i=133;break;case 8224:i=134;break;case 8225:i=135;break;case 710:i=136;break;case 8240:i=137;break;case 352:i=138;break;case 8249:i=139;break;case 338:i=140;break;case 381:i=142;break;case 8216:i=145;break;case 8217:i=146;break;case 8220:i=147;break;case 8221:i=148;break;case 8226:i=149;break;case 8211:i=150;break;case 8212:i=151;break;case 732:i=152;break;case 8482:i=153;break;case 353:i=154;break;case 8250:i=155;break;case 339:i=156;break;case 382:i=158;break;case 376:i=159}return i}},e.Util.UTF8}),i("utils/base64",["jxg","utils/encoding"],function(e,t){function i(e,t){return 255&e.charCodeAt(t)}function a(e,t){var i=n.indexOf(e.charAt(t));if(-1===i)throw Error("JSXGraph/utils/base64: Can't decode string (invalid character).");return i}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="=";return e.Util=e.Util||{},e.Util.Base64={encode:function(e){var a,r,s,l,d,c=[];for(d=t.encode(e),s=d.length,l=s%3,a=0;s-l>a;a+=3)r=i(d,a)<<16|i(d,a+1)<<8|i(d,a+2),c.push(n.charAt(r>>18),n.charAt(63&r>>12),n.charAt(63&r>>6),n.charAt(63&r));switch(l){case 1:r=i(d,s-1),c.push(n.charAt(r>>2),n.charAt(63&r<<4),o,o);break;case 2:r=i(d,s-2)<<8|i(d,s-1),c.push(n.charAt(r>>10),n.charAt(63&r>>4),n.charAt(63&r<<2),o)}return c.join("")},decode:function(e,i){var n,r,s,l,d,c,h=[],u=[];if(n=e.replace(/[^A-Za-z0-9\+\/=]/g,""),s=n.length,0!==s%4)throw Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(n.charAt(s-1)===o&&(l=1,n.charAt(s-2)===o&&(l=2),s-=4),r=0;s>r;r+=4)d=a(n,r)<<18|a(n,r+1)<<12|a(n,r+2)<<6|a(n,r+3),u.push(d>>16,255&d>>8,255&d),0===r%1e4&&(h.push(String.fromCharCode.apply(null,u)),u=[]);switch(l){case 1:d=a(n,s)<<12|a(n,s+1)<<6|a(n,s+2),u.push(d>>10,255&d>>2);break;case 2:d=a(n,r)<<6|a(n,r+1),u.push(d>>4)}return h.push(String.fromCharCode.apply(null,u)),c=h.join(""),i&&(c=t.decode(c)),c},decodeAsArray:function(e){var t,i=this.decode(e),a=[],n=i.length;for(t=0;n>t;t++)a[t]=i.charCodeAt(t);return a}},e.Util.Base64}),i("../build/compressor.deps.js",["jxg","utils/zip","utils/base64"],function(e,t,i){return e.decompress=function(e){return unescape(new t.Unzip(i.decodeAsArray(e)).unzip()[0][0])},e}),window.JXG=t("../build/compressor.deps.js")}(),define("jsxcompressor",function(){}),function(e){e.isJQueryOver19=function(){var t=$().jquery;return t.indexOf("1.12.")>=0?!0:e.parseFloat(t.substring(0,3))>=1.9},e.isJQueryOver20=function(){e.parseFloat($().jquery.substring(0,3))>=2},e.getOffHandler=function(){return e.isJQueryOver19()?"off":"die"},e.getOnHandler=function(){return e.isJQueryOver19()?"on":"live"},e.getPropName=function(){return e.isJQueryOver19()?"prop":"attr"}}(window),function(e){if(isJQueryOver19()){var t=window.navigator.userAgent,i=/Chrome\/(\S+)/.test(t)?RegExp.$1:void 0,a=/Version\/(\S+)/.test(t)?RegExp.$1:void 0,n=/OPR\/(\S+)/.test(t)?RegExp.$1:void 0,o=/MSIE ([^;]+)/.test(t)||/Trident\/[^"]*rv:([^\s,^\)]+)/.test(t)?RegExp.$1:void 0,r=i||a||n||o;e.browser=e.extend(e.browser||{},{msie:o,safari:a,opera:n,chrome:i,version:r}),e.curCSS=e.css,e.isNaN=function(e){var t=/\d/;return null==e||!t.test(e)||isNaN(e)}}}(jQuery),function(e){e.wafutil=e.wafutil||{},e.extend(e.wafutil,{getLazyOption:function(t){var i,a=e(t).data("_OPTIONS_"),n=e(t).attr("id");if(!a&&window._serverOptions_&&n&&e.isArray(window._serverOptions_)){var o=jlinq.from(window._serverOptions_).equals("id",n).select();o&&o.length>0&&(a=e.extend(!0,{},o[0].option?o[0].option:{}),i=o[0].type,window.debug&&o.length>0&&e.log.lazyLog({type:o[0].type,id:o[0].id}))}return a&&(a.url&&(a.url=this.handleUrl(a.url)),a.dataUrl&&(a.dataUrl=this.handleUrl(a.dataUrl)),a.urlSource&&(a.urlSource=this.handleUrl(a.urlSource)),a.subWidgetOptions&&a.subWidgetOptions.url&&(a.subWidgetOptions.url=this.handleUrl(a.subWidgetOptions.url)),a.subWidgetOptions&&a.subWidgetOptions.dataUrl&&(a.subWidgetOptions.dataUrl=this.handleUrl(a.subWidgetOptions.dataUrl))),a||{}}})}(jQuery),function(){var e=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi;$.htmlPrefilter=function(t){return function(t){return t+="",t.replace(e,"<$1></$2>")}}($.htmlPrefilter)}(),define("jqueryk3cloudex",function(e){return function(){var t;return t||e.jqueryk3cloudex}}(this)),function(e){e.extend({xml2json:function(t,i){function a(t,s){if(!t)return null;var l="",d=null,c=null;t.nodeType,n(t.localName||t.nodeName),t.text||t.nodeValue||"";if(t.childNodes&&t.childNodes.length>0){e.each(t.childNodes,function(e,t){var i=t.nodeType,o=n(t.localName||t.nodeName),s=t.text||t.nodeValue||"";if(8!=i)if(3!=i&&4!=i&&o)d=d||{},d[o]?(d[o].length&&"string"!=typeof d[o]||(d[o]=r(d[o])),d[o][d[o].length]=a(t,!0),d[o].length=d[o].length):d[o]=a(t);else{if(s.match(/^\s+$/))return;l+=s.replace(/^\s+/,"").replace(/\s+$/,"")}})}t.attributes&&t.attributes.length>0&&(c={},d=d||{},e.each(t.attributes,function(e,t){var i=n(t.name),a=t.value;c[i]=a,d[i]?(d[i].length||(d[i]=o(d[i])),d[i][d[i].length]=a,d[i].length=d[i].length):d[i]=a})),d&&(d=e.extend(""!=l?new String(l):{},d||{}),l=d.text?("object"==typeof d.text?d.text:[d.text||""]).concat([l]):l,l&&(d.text=l),l="");var h=d||l;return i&&(l&&(h={}),l=h.text||l||"",l&&(h.text=l),s||(h=o(h))),h}if(!t)return{};var n=function(e){return String(e||"").replace(/-/g,"_")},o=function(e){return e.length||(e=[e]),e.length=e.length,e},r=function(e){return e.length&&"string"!=typeof e||(e=[e]),e.length=e.length,e};if("string"==typeof t&&(t=e.text2xml(t)),t.nodeType){if(3==t.nodeType||4==t.nodeType)return t.nodeValue;var s=9==t.nodeType?t.documentElement:t,l=a(s,!0);return t=null,s=null,l}},text2xml:function(t){var i;try{var a=e.browser.msie?new ActiveXObject("Microsoft.XMLDOM"):new DOMParser;a.async=!1}catch(n){throw new Error("XML Parser could not be instantiated")}try{i=e.browser.msie?a.loadXML(t)?a:!1:a.parseFromString(t,"text/xml")}catch(n){throw new Error("Error parsing XML string")}return i}})}(jQuery),define("jqxml2JSON",["jqueryk3cloudex"],function(e){return function(){var t;return t||e.jqxml2JSON}}(this)),eval(function(e,t,i,a,n,o){if(n=function(e){return(t>e?"":n(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;i--;)o[n(i)]=a[i]||n(i);a=[function(e){return o[e]}],n=function(){return"\\w+"},i=1}for(;i--;)a[i]&&(e=e.replace(new RegExp("\\b"+n(i)+"\\b","g"),a[i]));return e}('I 6N={33:J(a){7t.33(a)},1o:J(1y,3Z,6G,58){if(6G=="4C"){6G=3w.au.4C}if(3w.5d&&3w.5d[3Z]){3w.5d[3Z]=1m}X{if(3H.5d&&3H.5d[3Z]){3H.5d[3Z]=1m}}I 6H=[3Z];if(6G!==1p){6H.Y(6G);if(58){if(39 58=="81"){g1{58=aJ(58);6H.Y(58)}g2(fZ){}}X{6H.Y(58)}}}7t.1e.1o.1t(1y,6H)},7H:J(a){3w.at.7H(a)},3B:J(c,b,a){c.3B(b,a)},4G:J(e,b,c,a){K e.4G(b,c,a)},68:J(b,a){K b.68(a)},8d:J(a){K 7t.5D(a)},8x:J(a,b){K a.8x(b)},9H:J(f,e,c,b,a){K 3w.g0.70(f,e,c,b,a)},61:J(b,a){K 3w.at.g3(b,a)},7C:J(a,b,c){a.3m.7C(b,c)},7L:J(a,b){K a.3m.7L(b)},5B:J(a,b,c){if(!a){K}if(a.3m){a.3m.5B(b,c)}X{if(a.g6){$5B(a,b,c)}}},7S:J(){K O 3w.9N()},5A:J(c,b,e,a){$5A(c,b)},7V:J(a){$7V(a)},3L:J(a,b){K 5b.3L(a,b)},7b:J(b,a){K 5b.7b(b,a)},2h:J(a){I b=3w.au.g7.2h(a);K O N.W.2b(b.x,b.y,b.P,b.T)},4V:J(a){K 3w.ae.af.g4(a)},6q:J(a){K 3w.ae.af.fS(a)},c9:J(b,a,e,f){I c=O fT();2i=b;c.fQ=J(){if(c.fR==4&&c.fU==cN){I g=1l.4V(1l.4V(c.fX).d);f.1t(b,[g])}};c.fY("c8",a);c.fV("fW-7t","c6/8p; ce=cf-8");c.gk(e)}};I bW={33:J(f){I a=3H;I g=f.1n(".");13(I c=0;c<g.V;c++){I b=g[c];I e=a[b];if(!e){e=a[b]={}}a=e}},1o:J(e,a,f,g){if(f=="4C"){f=N.7d.4C}e.1e.3z=e;e.3b=a;if(f){e.4X=f;13(I c in f.1e){I b=f.1e[c];if(!e.1e[c]){e.1e[c]=b}}}},7H:J(a){$(3H).gl(J(){a.5w()})},3B:J(c,b,a){I e=c.4X;if(e){if(!a){e.1t(b)}X{e.1t(b,a)}}},4G:J(f,c,e,b){I g=f.4X;if(g){I a=g.1e[e];if(a){if(!b){K a.1t(c)}X{K a.1t(c,b)}}}},68:J(b,a){if(!a){K 1m}if(a 4d b){K 1v}I c=a.3z.4X;2W(c){if(c===b){K 1v}c=c.4X}K 1m},8d:J(3Z){if(!3Z){K 19}I fn=aJ(3Z);if(39(fn)=="J"){K fn}},8x:J(a,c){I b=a.4X;2W(b){if(b===c){K 1v}b=b.4X}K 1m},9H:J(f,e,c,b,a){I g=O f(a,e);g.6F=a;H.7H(g);$(a).2C("N",g);g.6z();K g},61:J(c,b){I a;if(b){a=$(b).gj("#"+c)}X{a=$("#"+c)}if(a){K a.2C("N")}K 19},6Y:J(a,b,c){if(a.3m[b]==1p){if(!c){K 19}a.3m[b]=[]}K a.3m[b]},7C:J(a,b,c){if(!a.3m){a.3m=H.7S()}I e=H.6Y(a,b,1v);e.Y(c)},7L:J(a,b){I c=H.6Y(a,b);if(!c||(c.V===0)){K 19}K J(h,f){13(I g=0,e=c.V;g<e;g++){c[g](h,f)}}},5B:J(a,b,e){if(!a){K}if(a.3m){I f=H.6Y(a,b);if(!f){K}I c=f.1R(e);if(c>-1){f.3D(c,1)}}X{$(a).9Q(b,e)}},7S:J(){K O N.1I.8X()},5A:J(c,b,g,a){13(I f in b){$(c).gm(f,b[f])}},7V:J(a){$(a).9Q()},3L:J(a,b){K $.8y(b,a)},7b:J(b,a){K J(){I c=2I.V;if(c>0){I e=[];13(I f=0;f<c;f++){e[f]=2I[f]}e[c]=a;K $.8y(b.1t(H,e),a)}K $.8y(b,a)}},2h:J(f){I b=$(f).8e();I e=$.fn.gq;I a=e.1n(".");if((a[0]==1&&a[1]<9)){I g=bP($.bM(27.5e,"gn"))||0;I c=bP($.bM(27.5e,"go"))||0;b.1k+=g;b.1j+=c}K O N.W.2b(b.1j,b.1k,$(f).P(),$(f).T())},4V:J(a){if(5g){K 5g.5D(a)}X{59 O 4Q("5g is 1p.")}},6q:J(a){if(5g){K 5g.ga(a)}X{59 O 4Q("5g is 1p.")}},c9:J(b,a,c,e){$.gb({1y:"c8",g8:a,2C:c,g9:"c6/8p; ce=cf-8",gd:"8p",1i:b,fP:J(g){I f=1l.4V(g.d);e.1t(H,[f])},c5:J(){fq("fr c5")}})}};if(39 $18=="1p"){$18={}}4U=H.4U||"bV";I bU=J(a){13(I b in 6N){if(6N[b]4d 5b){if(a[b]==1p||!(a[b]4d 5b)){59 O 4Q("fp fs fv fw 8A ft fu fg "+b)}}}K 1v};if(4U=="fh"){1l=6N}X{if(4U=="bV"){1l=bW}X{if(4U 4d 79){if(bU(4U)){1l=4U}}}}1l.33("N");N.7h=1l;N.33=J(a){N.7h.33(a)};N.1o=J(b,a,c,e){N.7h.1o(b,a,c,e)};N.9a=J(a){K N.7h.61(a)};N.33("N.7d");(J(a){I b=a.4C=J(c){H.6F=c};b.1e={5w:J(){},1O:J(){K H.6F}};N.1o(b,"N.7d.4C")})(N.7d);if(!N.2E||!N.2E.3b){I 2E=N.2E=J(){1l.3B(2E,H)};2E.1e={};N.1o(2E,"N.2E");N.2E.9n=O N.2E()}if(!N.4l||!N.4l.3b){I 4l=N.4l=J(){1l.3B(4l,H)};4l.1e={ff:J(){K H.bX},fi:J(a){H.bX=a}};N.1o(4l,"N.4l",2E)}if(!N.2U||!N.2U.3b){I 2U=N.2U=J(c,b,a){1l.3B(2U,H);H.7P=c;H.bi=b;H.4i=a;H.aZ()};2U.1e={aZ:J(){I e=79.6Z(H.7P);e=e.71(J(h){K 2U.bq(e,h)});I a={};13(I c in e){I b=e[c].1n("3x")[1];I g=b.35(0).5U()+b.3M(1);I f="I 5I = \'"+g+"\' + \'5C\'; I 5J = \'"+g+"\' + \'4I\'; I 5H = \'3U\' + \'"+b+"\'; H[5I] = 1H; H[5J] = 1v; if (H.4i != 19) 	H.4i[5H](1H); K H;";H[g]=O 5b("1H",f);if(g=="2s"){f="I 5I = \'"+g+"\' + \'5C\'; I 5J = \'"+g+"\' + \'4I\'; I 5H = \'3U\' + \'"+b+"\'; if (2I.V == 2) { 1H = O N.W.6w(6k, 2p); }X 1H = 2I[0]; H[5I] = 1H; H[5J] = 1v; if (H.4i != 19) 	H.4i[5H](1H); K H;";H[g]=O 5b("6k","2p",f)}if(g=="1W"){f="I 5I = \'"+g+"\' + \'5C\'; I 5J = \'"+g+"\' + \'4I\'; I 5H = \'3U\' + \'"+b+"\'; if (2I.V == 3) { 1H = {1y:\'3X\', 2u:2u, 2y: 2y, 2P:7U};}X if (2I.V == 4) { 1H = {1y:\'aE\', 2u:2u, 2y: 2y, 8s: 7U, 8t: aY};}X 1H = 2I[0]; H[5I] = 1H; H[5J] = 1v; if (H.4i != 19) 	H.4i[5H](1H); K H;";H[g]=O 5b("2u","2y","7U","aY",f)}}},70:J(){I b=H.7P.3W();I f=1l.8d(b);if(!f){K 19}I i=O f(H.bi);I a=79.6Z(H);a=a.71(J(j){K 2U.9M(a,j)});13(I e in a){I c=a[e].1n("4I")[0];I h=H[c+"5C"];I g="3U"+c.35(0).6g()+c.3M(1);if(i[g]){i[g](h)}}K i},fl:J(b){H.4i=b;I a=79.6Z(H);a=a.71(J(f){K 2U.9M(a,f)});13(I e in a){I c=a[e].1n("4I")[0];bh H[a[e]];bh H[c+"5C"]}}};2U.bq=J(c,b){if(b.1R("3x")!==0){K 1m}I a=b.1n("3x")[1];I e="3U"+a;K c.1R(e)>-1};2U.9M=J(c,b){if(b.1R("4I")==-1){K 1m}I a=b.1n("4I")[0];I e=a+"5C";K c.1R(e)>-1};N.1o(2U,"N.2U")}N.33("N.1I");(J(b){I a=b.5F=J(){I e=O 6E();I c=b.am;e.1R=c.1R;e.3n=c.3n;e.3p=c.3p;e.9y=c.9y;e.5V=c.5V;e.2o=c.2o;e.9A=c.9A;K e};a.1R=J(e,c){K e.1R(c)};a.2Z=J(e,c){e.Y(c)};a.fG=J(f,c,e){f.3D(c,0,e)};a.3n=J(f,e){I c=f.1R(e);if(c>-1){f.3D(c,1);K 1v}K 1m};a.fH=J(e,c){if(c>-1){e.3D(c,1);K 1v}K 1m};a.3p=J(e,c){K e.1R(c)>-1};a.2o=J(j,h,c){13(I g=0,e=j.V;g<e;g++){I f=j[g];if(39(f)!=="1p"){h.48(c,f,g,j)}}};a.1Z=J(c){K c.3M(0)};a.fK=J(g,e){13(I f=0,c=e.V;f<c;f++){g.Y(e[f])}}})(N.1I);(J(b){I a=b.8X=J(){H.2l=O b.7o()};a.1e.3U=J(c,f){I e=H.2l.3x(c);if(e==19){e=H.2l.2Z(c)}e.1H=f};a.1e.3x=J(c){I e=H.2l.3x(c);if(e!=19){K e.1H}59 O 4Q("fN 9a 5u "+c)};a.1e.3p=J(c){K H.2l.3p(c)};a.1e.3n=J(c){K H.2l.3n(c)};a.1e.ap=J(){K H.2l.5Z};a.1e.2o=J(c,e){H.2l.2o(J(f){c.48(e,f.5u,f.1H)})};a.1e.fO=J(c,e){H.2l.2o(J(f){c.48(e,f.1H)})};a.1e.aU=J(c,e){H.2l.2o(J(f){c.48(e,f.5u)})};a.1e.6Z=J(){I c=O 6E();H.aU(J(e){c.Y(e)});K c};N.1o(a,"N.1I.8X")})(N.1I);(J(b){I a=b.c4=J(c,e){H.b2();if(c>0&&e>0){H.5h(c,e)}};a.1e={1Z:J(){I h=O a(H.4p,H.4J);13(I g=0;g<H.4p;g++){13(I f=0;f<H.4J;f++){I e=H.3x(g,f);if(e){if(e.1Z){h.3U(g,f,e.1Z())}X{h.3U(g,f,e)}}}}K h},3x:J(c,e){K H.2C[c][e]},3U:J(c,f,e){H.2C[c][f]=e},b2:J(){H.2C=[];H.4p=0;H.4J=0},5h:J(e,f){H.4p=e;H.4J=f;H.2C.V=e;13(I c=0;c<e;c++){if(!H.2C[c]){H.2C[c]=[]}H.2C[c].V=f}},fz:J(c){H.2C.3D(c,1);H.4p--},fA:J(c){H.2C.3D(c,0,[]);H.4p++;H.2C[c].V=4J},fx:J(e){13(I c=0;c<H.4p;c++){H.2C[c].3D(e,1)}H.4J--},fy:J(e){13(I c=0;c<H.4p;c++){H.2C[c].3D(e,0,19)}H.4J++}};N.1o(a,"N.1I.c4")})(N.1I);(J(a){I b=a.7o=J(){H.6x=O 6E();H.2p=2A;H.5Z=0};b.1e.2Z=J(c){H.5Z++;I f=H.7f(c);I e={5u:c};f.Y(e);K e};b.1e.3x=J(e){I f=H.7f(e);I c=H.9l(e,f);if(c==-1){K 19}K f[c]};b.1e.3p=J(c){I e=H.3x(c);K e!=19};b.1e.3n=J(e){I g=H.7f(e);I c=H.9l(e,g);if(c==-1){K 19}H.5Z--;I f=g[c];g.3D(c,1);K f};b.1e.2o=J(f){13(I c=0;c<H.6x.V;++c){I g=H.6x[c];if(g==1p){5E}13(I e=0;e<g.V;++e){f(g[e])}}};b.1e.7f=J(e){I c=H.cc(e)%H.2p;I f=H.6x[c];if(f===1p){f=O 6E();H.6x[c]=f}K f};b.1e.9l=J(e,g){13(I c=0;c<g.V;++c){I f=g[c];if(f.5u===e){K c}}K-1};b.1e.cc=J(c){if(39 c=="fC"){K c&c}if(39 c=="81"){K H.bQ(c)}if(39 c=="fD"){K H.bL(c)}59 O 4Q("hd 1y 8A he.")};b.1e.bQ=J(f){I g=0;if(f.V==0){K g}13(I c=0;c<f.V;c++){I e=f.45(c);g=((g<<5)-g)+e;g=g&g}K g};b.1e.bL=J(c){I e=c.bK;if(e===1p){e=b.a6++;c.bK=e}K e};b.a6=0;N.1o(b,"N.1I.7o")})(N.1I);(J(a){I b=a.93=J(c){1l.3B(b,H);H.a8=c};b.1e.hb=J(){K H.a8};N.1o(b,"N.1I.93",N.2E)})(N.1I);(J(c){I b=N.1I.5F;I a=c.aq=J(){1l.3B(a,H);H.3m=O 1l.9N()};a.1e.2Z=J(g){b.2Z(H,g);I f=1l.7L(H,"9B");I e=O N.1I.93(g);f(H,e)};a.1e.hg=J(e){1l.7C(H,"9B",e)};a.1e.hh=J(e){1l.5B(H,"9B",e)};N.1o(a,"N.1I.aq",6E)})(N.1I);(J(b){I a=b.9K=J(){H.4D=19;H.6D=19;H.2p=0};a.1e.h4=J(e){I c={1H:e,7z:19};if(H.4D==19){H.4D=c;H.6D=H.4D}X{H.6D.7z=c;H.6D=H.6D.7z}H.2p++};a.1e.h5=J(){if(H.2p<1){59 O 4Q("9K is 2v.")}I c=H.4D.1H;H.4D=H.4D.7z;H.2p--;K c};a.1e.bc=J(){K H.2p};N.1o(a,"N.1I.9K")})(N.1I);(J(b){I a=b.9G=J(){H.2l=O b.7o()};a.1e.2Z=J(c){I e=H.2l.3x(c);if(e==19){e=H.2l.2Z(c)}};a.1e.3p=J(c){K H.2l.3p(c)};a.1e.3n=J(c){I e=H.2l.3n(c);if(e){K 1v}K 1m};a.1e.ap=J(){K H.2l.5Z};a.1e.2o=J(c,e){H.2l.2o(J(f){c.48(e,f.5u)})};N.1o(a,"N.1I.9G")})(N.1I);N.1I.am={1R:J(b){13(I a=0;a<H.V;++a){if(H[a]===b){K a}}K-1},3n:J(b){I a=H.1R(b);if(a>-1){H.3D(a,1)}},3p:J(a){K H.1R(a)>-1},9y:J(a,c){13(I b=0;b<H.V;++b){if(a.48(c,H[b])){K H[b]}}K 19},5V:J(b,e){I a=[];13(I c=0;c<H.V;++c){if(b.48(e,H[c])){a.Y(H[c])}}K a},2o:J(b,c){13(I a=0;a<H.V;++a){if(b.48(c,H[a])===$18){18}}},9A:J(b,c){13(I a=H.V-1;a>=0;a--){if(b.48(c,H[a])===$18){18}}},ha:J(c,f,b){13(I a=0,e=c.V;a<e;a++){f.Y(b(c[a]))}}};N.33("N.3k");(J(a){a.9D=J(c,b){if(c===b){K{a:0,r:0}}I g=b.x-c.x;I f=b.y-c.y;I h=a.3t(c,b);I e=S.h7(-f/g);if(g<0){e+=S.1z}K{a:e,r:h}};a.6c=J(c,b){I e=a.9D(c,b);e.a=a.ar(e.a);K e};a.9w=J(b,c){if(c.r==0){K b}K{x:b.x+S.4Z(c.a)*c.r,y:b.y-S.4x(c.a)*c.r}};a.8n=J(b,c){I e={a:a.8z(c.a),r:c.r};K a.9w(b,e)};a.h8=J(b,c,f){I e=a.9D(c,b);e.a+=f;K a.9w(c,e)};a.3t=J(f,e){I c=f.x-e.x;I b=f.y-e.y;K S.2T(c*c+b*b)};a.ar=J(b){K b*2N/S.1z};a.8z=J(b){K b*S.1z/2N};a.hw=J(x,o,n){I t=n.1Z();I m=N.W.2b;I u=m.4E(o.x,o.y,n.x,n.y);I w=o.x;I g=o.y;I v=n.x;I e=n.y;if(S.2B(w-v)>0.6l){I h=(x.1j()+x.1g())/2;I f=(x.1k()+x.1h())/2;I l=(x.1g()-x.1j())/2;I k=(x.1h()-x.1k())/2;I F=(g-e)/(w-v);I E=(w*e-v*g)/(w-v);I s=k*k+F*F*l*l;I r=2*F*(E-f)*l*l-2*h*k*k;I q=k*k*h*h+l*l*(E-f)*(E-f)-l*l*k*k;I z,y,j,i;I p=S.2T(r*r-4*s*q);z=(-r+p)/(2*s);y=(-r-p)/(2*s);j=F*z+E;i=F*y+E;if(g==e){j=i=g}t.x=z;t.y=j;if(t.x>=u.1j()&&t.x<=u.1g()&&t.y>=u.1k()&&t.y<=u.1h()){K t}t.x=y;t.y=i;if(t.x>=u.1j()&&t.x<=u.1g()&&t.y>=u.1k()&&t.y<=u.1h()){K t}}X{I h=(x.1j()+x.1g())/2;I f=(x.1k()+x.1h())/2;I l=(x.1g()-x.1j())/2;I k=(x.1h()-x.1k())/2;I c=w;I j=f-S.2T((1-(c-h)*(c-h)/(l*l))*k*k);I i=f+S.2T((1-(c-h)*(c-h)/(l*l))*k*k);t.x=c;t.y=j;if(t.x>=u.1j()&&t.x<=u.1g()&&t.y>=u.1k()&&t.y<=u.1h()){K t}t.x=c;t.y=i;if(t.x>=u.1j()&&t.x<=u.1g()&&t.y>=u.1k()&&t.y<=u.1h()){K t}}K t}})(N.3k);(J(a){I c=N.1I.5F;I e=a.ac=J(f,h,g){H.x=f;H.y=h;H.r=g};e.5v=J(n){if(n.V==2){K 9I(n[0],n[1])}if(n.V==3){K 9F(n[0],n[1],n[2])}I i={x:0,y:24.2f};c.2o(n,J(o){if(o.y<i.y){i=o}});I j=24.2f;I h=19;c.2o(n,J(o){if(i==o){K}I p={x:o.x,y:i.y};I q=b(i,o,p);if(q<j){j=q;h=o}});I m=O N.1I.9G();2W(1v){j=24.2f;I f=19;c.2o(n,J(o){if(i==o||h==o||m.3p(o)){K}I p=b(o,i,h);if(p<j){j=p;f=o}});I g=j;I k=b(i,h,f);I l=S.1z-g-k;if(g<S.1z/2&&k<S.1z/2&&l<S.1z/2){K e.9F(i,h,f)}if(g>=S.1z/2){K e.9I(i,h)}if(k>=S.1z/2){m.2Z(i);i=f}X{if(l>=S.1z/2){m.2Z(h);h=f}X{K 19}}}};e.9F=J(u,s,p){if(u.x==s.x){I w=p;p=s;s=w}X{if(p.x==s.x){I w=u;u=s;s=w}}I i=u.x;I n=u.y;I h=s.x;I l=s.y;I g=p.x;I j=p.y;I q=(l-n)/(h-i);I o=(j-l)/(g-h);if(o==q){K 19}I m=(q*o*(n-j)+o*(i+h)-q*(h+g))/(2*(o-q));I k=q!=0?-(m-(i+h)/2)/q+(n+l)/2:-(m-(h+g)/2)/o+(l+j)/2;I z=m-i;I v=k-n;I f=S.2T(z*z+v*v);K O e(m,k,f)};e.9I=J(k,j){I f=(k.x+j.x)/2;I l=(k.y+j.y)/2;I h=f-k.x;I g=l-k.y;I i=S.2T(h*h+g*g);K O e(f,l,i)};J b(j,h,g){if(h.x==g.x&&h.y==g.y){K 0}I k=a.3t(j,h);I i=a.3t(j,g);I f=a.3t(h,g);K S.hx((k*k+i*i-f*f)/(2*k*i))}a.3t=J(i,h){I g=i.x-h.x;I f=i.y-h.y;K S.2T(g*g+f*f)};N.1o(e,"N.3k.ac")})(N.3k);N.33("N.W");(J(b){I a=b.7a=J(g,f,e,c){H.1j=g;H.1k=f;H.1g=e;H.1h=c};a.1e={bv:J(c){c.x+=H.1j;c.y+=H.1k;c.P-=H.1j+H.1g;if(c.P<0){c.P=0}c.T-=H.1k+H.1h;if(c.T<0){c.T=0}},hB:J(c){c.x-=H.1j;c.y-=H.1k;c.P+=H.1j+H.1g;c.T+=H.1k+H.1h}};a.9h=J(c){K O a(c.1j,c.1k,c.1g,c.1h)};N.1o(a,"N.W.7a")})(N.W);(J(b){I a=b.4z=J(e,c){H.P=e;H.T=c};a.1e={2v:J(){K(H.P===0&&H.T===0)}};a.9h=J(c){K O a(c.P,c.T)};N.1o(a,"N.W.4z")})(N.W);(J(b){I a=b.ak=J(e,i,c,g,f,h){H.x=e;H.y=i;H.28=c;H.9d=g;H.9c=f;H.8W=h;H.1c=O b.1s(e,i)};a.1e={3W:J(){K H.3z.3b},26:J(c){c.2a=H.1r;c.21=(H.1q?H.1q:1)/c.1G;b.4j.1t(c,H.4L);c.1Y();c.8F(H.x,H.y,H.28,H.9d,H.9c,H.8W);c.1L()},4s:J(c){I e=b.1s.3t(c,H.1c);K(e<=H.28)},8C:J(c){if(!c){K H}I e=O a(H.x,H.y,H.28+c,H.9d,H.9c,H.8W);K e},1r:"4r"};N.1o(a,"N.W.ak")})(N.W);(J(a){I b=a.ah=J(i,k,g,j,e,h,c,f){H.3e=i;H.38=k;H.36=g;H.3f=j;H.7p=e;H.7q=h;H.7n=c;H.7M=f};b.5v=J(c,e){K O b(c[e+0].x,c[e+0].y,c[e+1].x,c[e+1].y,c[e+2].x,c[e+2].y,c[e+3].x,c[e+3].y)};b.1e={1r:"4r",1q:0,26:J(e,c){if(H.1A&&c!=1m){e.1D();H.1A.1t(e)}e.2a=H.1r;e.21=(H.1q?H.1q:1)/e.1G;a.4j.1t(e,H.4L);e.1Y();e.1x(H.3e,H.38);e.2K(H.36,H.3f,H.7p,H.7q,H.7n,H.7M);e.1L();if(H.1A&&c!=1m){e.1B()}},4f:J(c){if(H.1A){c.1D();H.1A.1t(c);c.21=(H.1q?H.1q:1)/c.1G;c.1Y();c.1x(H.3e,H.38);c.2K(H.36,H.3f,H.7p,H.7q,H.7n,H.7M);c.2a=H.1A.1M;c.1L();c.1B()}},43:J(c){c.1Y();c.1x(H.3e,H.38);c.2K(H.36,H.3f,H.7p,H.7q,H.7n,H.7M)}};N.1o(b,"N.W.ah")})(N.W);(J(a){I b=a.ai=J(c){H.4b=c;H.1C=O a.1N();H.1y=H.3z.3b};b.1e={3W:J(){K H.1y},26:J(f,e){J i(l,n,k,m){J j(p){I o=S.6B(p*f.1G)/f.1G;K o}f.1Y();f.1x(j(l),j(n));f.1u(j(k),j(m));f.1L()}I h=H.4b;I c=1/f.1G;I g=c*2;f.1D();f.21=c;f.2a="9r";i(h.1j(),h.1k(),h.1g(),h.1k());i(h.1j(),h.1k(),h.1j(),h.1h());f.2a="hp";i(h.1j()+c,h.1k()+c,h.1g()-2*c,h.1k()+c);i(h.1j()+c,h.1k()+c,h.1j()+c,h.1h()-2*c);f.2a="4e";i(h.1j(),h.1h()-c,h.1g(),h.1h()-c);i(h.1j()+c,h.1h()-g,h.1g()-c,h.1h()-g);i(h.1g()-c,h.1k(),h.1g()-c,h.1h());i(h.1g()-g,h.1k()+c,h.1g()-g,h.1h()-c);f.1B()}};N.1o(b,"N.W.ai")})(N.W);(J(c){I b=N.1I.5F;I f=2n.2V;I a=c.bJ=J(g){1l.3B(a,H,[g]);H.14=[];H.2s=O c.6w("8Q-8P",4);H.5n=c.4Y.62;H.1K=2A;H.1d=O c.2b(0,0,h1,gC);H.92=16;H.9R=1l.3L(H,H.1F)};a.1e={6z:J(){1l.4G(a,H,"6z");I g=H.1O();if(39 g.73!=="1p"){H.1i=g.73("2d")}H.5T()},5w:J(){1l.4G(a,H,"5w")},4A:J(g){H.1d=g;H.9s()},2h:J(){K H.1d},gD:J(g){if(H.5n!==g){H.5n=g;H.5T()}},gA:J(){K H.5n},al:J(i){if(H.1K!==i){if(H.3y){I h=H.3y();I g=H.4g();H.1K=i;H.5T();H.gB(h);H.gE(g);H.5p("7u",19)}X{H.1K=i;H.5T();H.5p("7u",19)}}},ad:J(){K H.1K},aw:J(){K 19},az:J(){K O N.W.4z(0,0)},aC:J(){K N.29.2J.3d},1F:J(){if(!H.1i){K}I h=O N.W.1N();if(H.2g){h.3G(-H.2g.2Q,-H.2g.2D)}h.1E(H.1E,H.1E);h.3G(-H.1d.x,-H.1d.y);H.1i.5W=h;H.1i.1G=H.1E;H.ay();H.1i.1D();H.1i.1C.1t(H.1i,h.34());if(H.aM){H.aK.gH(H.1i)}H.1i.21=1/H.1E;if(H.9W){H.9Z()}if(H.aH){H.aH(H.1d)}I g=(H.aF==N.29.aG.gF);if(H.aF==N.29.aG.gu){H.aD()}I l=H.9k();13(I k=0;k<l.V;k++){I j=l[k];if(j.aA||(j.7J&&j.7J.aB()==1m)){5E}j.26(H.1i,g,1m)}if(H.aM){H.aK.gv(H.1i)}if(H.aL){H.aL()}if(H.ax){H.ax()}if(H.5p){H.5p("1F",N.2E.9n)}H.1i.1B();if(H.5R){gw(H.5R);H.5R=19}},ay:J(){I n=H.1d;I m=H.1i.5W.6U(n);H.1i.1D();H.1i.gU(m.x,m.y,m.P,m.T);H.1i.1Y();H.1i.4b(m.x,m.y,m.P,m.T);H.1i.3s=N.29.3q.40(H.1i,H.av!=19?H.av():H.gS,m);H.1i.22();H.1i.1B();I i=H.aw();I l=H.az();I k=H.aC();if(i&&i.8V){I o=N.29.2J;3F(k){1b o.3d:H.1i.2w(i,(m.1g()+m.x-l.P)/2,(m.1h()+m.y-l.T)/2,l.P,l.T);18;1b o.by:I g=m.P/m.T;I p=l.P/l.T;if(g>p){H.1i.2w(i,(m.1g()+m.x-l.P*p)/2,m.y,p*l.T,m.T)}X{H.1i.2w(i,m.x,(m.1h()+m.y-l.P/p)/2,m.P,p*l.P)}18;1b o.bA:H.1i.2w(i,m.x,m.y,m.P,m.T);18;1b o.bz:13(I q=0;q<m.P;q+=l.P){13(I j=0;j<m.T;j+=l.T){H.1i.2w(i,q,j,l.P,l.T)}}18;1b o.bR:H.1i.2w(i,m.x,m.y,l.P,l.T);18;1b o.bC:H.1i.2w(i,m.x,m.1h()-l.T,l.P,l.T);18;1b o.bB:H.1i.2w(i,m.1g()-l.P,m.y,l.P,l.T);18;1b o.bD:H.1i.2w(i,m.1g()-l.P,m.1h()-l.T,l.P,l.T);18;1b o.bF:H.1i.2w(i,m.x+m.P/2-l.P/2,m.y,l.P,l.T);18;1b o.bE:H.1i.2w(i,m.x+m.P/2-l.P/2,m.1h()-l.T,l.P,l.T);18;1b o.bx:H.1i.2w(i,m.x,m.y+m.T/2-l.T/2,l.P,l.T);18;1b o.bw:H.1i.2w(i,m.1g()-l.P,m.y+m.T/2-l.T/2,l.P,l.T);18}}},aD:J(){I j=H.9k();13(I h=0;h<j.V;h++){I g=j[h];if(g.aA||(g.7J&&g.7J.aB()==1m)){5E}g.26(H.1i,1v,1v)}},9b:J(h){I g=h.x;I j=h.y;if(H.2g){g+=H.2g.2Q;j+=H.2g.2D}I i=O c.1s(g/H.1E,j/H.1E);K O c.1s(i.x+H.1d.x,i.y+H.1d.y)},gM:J(g){K g/H.1E},gJ:J(g){I h=O c.1s(g.x/H.1E,g.y/H.1E);K O c.1s(h.x+H.1d.x,h.y+H.1d.y)},gK:J(g){I h=O c.1s(g.x-H.1d.x,g.y-H.1d.y);h=O c.1s(h.x*H.1E,h.y*H.1E);if(H.2g){h.x-=H.2g.2Q;h.y-=H.2g.2D}K h},gN:J(g){I h=O c.1s(g.x-H.1d.x,g.y-H.1d.y);K O c.1s(h.x*H.1E,h.y*H.1E)},gQ:J(o,j,g,m){if(!H.1i){K O c.2b(0,0,20,10)}if(!g){g=O c.2b(0,0,24.2f,24.2f)}I p=O c.6u(o,g);p.2s=j;p.5z=O c.7a(0,0,0,0);p.bu=m;H.1i.1D();H.1i.2s=j.3E();I q;if(m){q=p.bZ(H.1i,g.P)}X{H.1i.1E(H.1E,H.1E);I r=p.8k(H.1i,g);if(g.P!=24.2f){I h=g.P}X{I h=H.1i.3V(o).P;if(r.V>1){I k=0;13(I l=0;l<r.V;l++){k=S.2j(k,H.1i.3V(r[l]).P)}h=k}}I n=((p.2s.2p)*r.V);q=O c.4z(h,n)}H.1i.1B();K q},gR:J(m,n,j,q){I g=O c.2b.4E(n.x,n.y,j.x,j.y);g=N.29.3q.bN(g);I i=n.x;I p=n.y;I h=j.x;I l=j.y;if(i===h){q.x=i;q.y=m.y;if(q.x>=m.x&&q.x<=m.1g()&&q.y>=g.y&&q.y<=g.1h()){K}q.y=m.1h();if(q.x>=m.x&&q.x<=m.1g()&&q.y>=g.y&&q.y<=g.1h()){K}}X{if(p===l){q.y=p;q.x=m.x;if(q.y>=m.y&&q.y<=m.1h()&&q.x>=g.x&&q.x<=g.1g()){K}q.x=m.1g();if(q.y>=m.y&&q.y<=m.1h()&&q.x>=g.x&&q.x<=g.1g()){K}}X{I o=(p-l)/(i-h);I k=(i*l-h*p)/(i-h);q.y=m.y;q.x=(q.y-k)/o;if(q.x>=m.x&&q.x<=m.1g()&&q.y<=m.1h()&&q.y>=g.y&&q.y<=g.1h()){K}q.y=m.1h();q.x=(q.y-k)/o;if(q.x>=m.x&&q.x<=m.1g()&&q.y>=m.y&&q.y>=g.y&&q.y<=g.1h()){K}q.x=m.x;q.y=o*q.x+k;if(q.y>=m.y&&q.y<=m.1h()&&q.x<=m.1g()&&q.x>=g.x&&q.x<=g.1g()){K}q.x=m.1g();q.y=o*q.x+k;if(q.y>=m.y&&q.y<=m.1h()&&q.x>=m.x&&q.x>=g.x&&q.x<=g.1g()){K}}}},gO:J(g){H.14.Y(g);if(H.3J&&(g.6R===24.2f||g.6R===1p)){H.3J.Y(g)}X{H.3J=19}H.7G()},gP:J(g){b.3n(H.14,g);if(H.3J){b.3n(H.3J,g)}H.7G()},7G:J(){if(!H.5R){H.5R=ck(H.9R,20)}},dv:J(){H.3J=19;H.7G()},9k:J(){if(!H.3J){H.3J=b.1Z(H.14);H.3J.6Q(e)}if(H.9V){H.9V()}K H.3J},5T:J(){H.1E=H.1K/2A/c.4Y.8Y(H.5n);if(H.1i){H.1i.1G=H.1E}H.9s()},9s:J(){if(H.2g){H.6W.7A.P=H.1d.P*H.1E+"9g";H.6W.7A.T=H.1d.T*H.1E+"9g";I g=1l.2h(H.1O().5l);H.1O().P=S.1Q(g.P-H.9p(1),H.1d.P*H.1E);H.1O().T=S.1Q(g.T-H.9p(0),H.1d.T*H.1E)}X{H.1O().P=H.1d.P*H.1E;H.1O().T=H.1d.T*H.1E}H.1F();if(H.5p){H.5p("dz",N.2E.9n)}},dj:J(){K H.6W?H.6W:H.1O()},di:J(){K H.2g?H.2g:H.1O().5l},9p:J(g){if(!H.2g){K 0}if(g==0&&H.2g.dh>H.2g.do){K H.92}if(g==1&&H.2g.dp>H.2g.dn){K H.92}K 0},9Z:J(){I m=H.dD();if(!H.9W){K}I u=H.1i.2a;H.1i.2a=H.dT;I B=(H.1d.P-H.6m)/H.5s;I z=(H.1d.T-H.6n)/H.5k;I C=c.4Y.8Y(H.5n);I k=H.5s/C;I w=H.5k/C;I D=H.1O().5l.2Q;I h=H.1O().5l.2D;I o=H.1O().5l.dP;I A=H.1O().5l.dX;I s=H.9b({x:D,y:h});I p=H.9b({x:o,y:A});I r=S.8j((s.x-H.6m)/H.5s);I q=S.8j((s.y-H.6n)/H.5k);H.1i.1Y();if(H.9t==N.29.9z.dW){13(I v=0;v<=z;++v){I l=(v+q)*H.5k+H.6n;if(l>s.y+p.y){18}13(I t=0;t<=B;++t){I n=(t+r)*H.5s+H.6m;if(n>s.x+p.x){18}H.5q(n,l,n+C,l+C)}}}X{if(H.9t==N.29.9z.dU){13(I v=1;v<=z;++v){I l=(v+q)*H.5k+H.6n;if(l>s.y+p.y){18}H.5q(H.1d.x,l,H.1d.1g(),l)}13(I t=1;t<=B;++t){I n=(t+r)*H.5s+H.6m;if(n>s.x+p.x){18}H.5q(n,H.1d.y,n,H.1d.1h())}}X{if(H.9t==N.29.9z.dH){I g=H.dI/2;13(I v=0;v<=z;++v){I l=(v+q)*H.5k+H.6n;if(l>s.y+p.y){18}13(I t=0;t<=B;++t){I n=(t+r)*H.5s+H.6m;if(n>s.x+p.x){18}H.5q(n-g,l,n+g,l);H.5q(n,l-g,n,l+g)}}}}}H.1i.1L();H.1i.2a=u},5q:J(j,h,i,g){H.1i.1x(j,h);H.1i.1u(i,g)},dL:J(){d=19}};J e(j,i){I h=j.6R;if(h===1p){h=24.2f}I g=i.6R;if(g===1p){g=24.2f}if(h<g){K-1}if(h>g){K 1}K 0}N.1o(a,"N.W.bJ","4C")})(N.W);(J(a){I b=a.bO=J(c,f,e){if(f==19){f=H.6M(c[1],c[0])}if(e==19){e=H.6M(c[c.V-2],c[c.V-1])}H.4t=c.3M();H.4t.cS(f);H.4t.Y(e);H.4t=H.bI(H.4t,0.5)};b.1e={1r:"4r",1q:0,6M:J(e,c){I h=O a.1s(0,0);I g=e.x-c.x;I f=e.y-c.y;h.x=c.x-g;h.y=c.y-f;K h},bI:J(r,l){I c=a.1T;I q=[];I x=0.8M;I k=1;I j=r.V-2;13(I s=k;s<j;++s){I o=(s+1)%r.V;I t=(o+1)%r.V;I u=s-1<0?r.V-1:s-1;I h=r[u];I g=r[s];I f=r[o];I e=r[t];I y=c.4o(g,h).V();I w=c.4o(f,g).V();I v=c.4o(e,f).V();I n,m;if(S.2B(y)<x){n=g}X{n=c.3S(f,S.1J(y,2*l));n=c.4o(n,c.3S(h,S.1J(w,2*l)));n=c.2Z(n,c.3S(g,(2*S.1J(y,2*l)+3*S.1J(y,l)*S.1J(w,l)+S.1J(w,2*l))));n=c.3S(n,1/(3*S.1J(y,l)*(S.1J(y,l)+S.1J(w,l)))).8m()}if(S.2B(v)<x){m=f}X{m=c.3S(g,S.1J(v,2*l));m=c.4o(m,c.3S(e,S.1J(w,2*l)));m=c.2Z(m,c.3S(f,(2*S.1J(v,2*l)+3*S.1J(v,l)*S.1J(w,l)+S.1J(w,2*l))));m=c.3S(m,1/(3*S.1J(v,l)*(S.1J(v,l)+S.1J(w,l)))).8m()}if(s==k){q.Y(g)}q.Y(n);q.Y(m);q.Y(f)}K q},26:J(f,c){if(H.1A&&c!=1m){f.1D();H.1A.1t(f)}f.2a=H.1r;f.21=(H.1q?H.1q:1)/f.1G;a.4j.1t(f,H.4L);f.1Y();I g=H.4t;f.1x(g[0].x,g[0].y);13(I e=0;e<g.V-1;e+=3){f.2K(g[e+1].x,g[e+1].y,g[e+2].x,g[e+2].y,g[e+3].x,g[e+3].y)}f.1L();if(H.1A&&c!=1m){f.1B()}},4f:J(e){if(H.1A){e.1D();H.1A.1t(e);e.21=(H.1q?H.1q:1)/e.1G;e.1Y();I f=H.4t;e.1x(f[0].x,f[0].y);13(I c=0;c<f.V-1;c+=3){e.2K(f[c+1].x,f[c+1].y,f[c+2].x,f[c+2].y,f[c+3].x,f[c+3].y)}e.2a=H.1A.1M;e.1L();e.1B()}},43:J(e){e.1Y();I f=H.4t;e.1x(f[0].x,f[0].y);13(I c=0;c<f.V-1;c+=3){e.2K(f[c+1].x,f[c+1].y,f[c+2].x,f[c+2].y,f[c+3].x,f[c+3].y)}}};N.1o(b,"N.W.bO")})(N.W);(J(b){I a=b.cd=J(c,e){H.x=c;H.y=e;H.3r=[]};a.1e.26=J(f,c,g){if(H.9L){H.9L.cW();H.9L=19}if(H.x||H.y||H.37||H.2S){f.1D();if(H.x!==1p){f.3G(H.x,H.y)}if(H.2S){f.1D();f.3G(H.6K.x,H.6K.y);f.aT(H.2S*S.1z/2N);f.3G(-H.6K.x,-H.6K.y)}if(H.37){if(1l.68(N.W.2b,H.37)){f.1Y();H.37.bb(f);f.37()}X{if(1l.68(N.W.5c,H.37)){H.37.43(f,1m);f.37()}}}if(g){13(I e=0;e<H.3r.V;e++){if(H.3r[e].4f){H.3r[e].4f(f)}}}X{13(I e=0;e<H.3r.V;e++){H.3r[e].26(f,c)}}if(H.2S){f.1B()}if(H.6I){H.6I(f,c,g)}f.1B()}X{if(g){13(I e=0;e<H.3r.V;e++){if(H.3r[e].4f){H.3r[e].4f(f)}}}X{13(I e=0;e<H.3r.V;e++){H.3r[e].26(f,c)}}if(H.6I){H.6I(f,c,g)}}};N.1o(a,"N.W.cd")})(N.W);N.W.5S=J(f,e,c){H.p=f;H.a=e;H.b=c};N.W.5S.1e={d9:J(){K S.2T(H.8B())},8B:J(){if(H.a===H.b){K H.6e(H.p,H.a)}I c=H.b.x-H.a.x;I b=H.b.y-H.a.y;I a=(H.p.x-H.a.x)*c+(H.p.y-H.a.y)*b;if(a<0){K H.6e(H.a,H.p)}a=(H.b.x-H.p.x)*c+(H.b.y-H.p.y)*b;if(a<0){K H.6e(H.b,H.p)}K H.cb(H.p,H.a,H.b)},6e:J(b,a){K(b.x-a.x)*(b.x-a.x)+(b.y-a.y)*(b.y-a.y)},cb:J(i,f,c){if(f===c){K H.6e(i,f)}I g=c.x-f.x;I e=c.y-f.y;I h=(i.y-f.y)*g-(i.x-f.x)*e;K h*h/(g*g+e*e)}};N.1o(N.W.5S,"N.W.5S");(J(b){I a=b.c0=J(e,h,f,c){if(2I.V==1){I g=e;e=g.x;h=g.y;f=g.P;c=g.T}H.x=e;H.y=h;H.P=f;H.T=c;H.1C=O b.1N()};a.1e={1Z:J(){K O a(H.x,H.y,H.P,H.T)},26:J(f){f.1D();f.1C.1t(f,H.1C.34());f.3s=N.29.3q.40(f,H.1W,H.2h());f.2a=H.1r;f.21=(H.1q?H.1q:1)/f.1G;b.4j.1t(f,H.4L);I c=H.x;I j=H.y;I e=H.P;I g=H.T;I i=0.dc;6d=(e/2)*i,6o=(g/2)*i,6P=c+e,7g=j+g,4K=c+e/2,4q=j+g/2;f.1Y();f.1x(c,4q);f.2K(c,4q-6o,4K-6d,j,4K,j);f.2K(4K+6d,j,6P,4q-6o,6P,4q);f.2K(6P,4q+6o,4K+6d,7g,4K,7g);f.2K(4K-6d,7g,c,4q+6o,c,4q);f.6J();f.22();f.1L();f.1B()},2h:J(c){K O N.W.2b(H.x,H.y,H.P,H.T)},3E:J(){K H.x+", "+H.y+", "+H.P+", "+H.T},1C:19,1r:"4r",1W:"4a"};N.1o(a,"N.W.c0")})(N.W);(J(a){I c=a.6w=J(f,h,g,e,i){H.6k=f;H.2p=h;H.4S=g;H.4W=e;H.5Y=i};c.1e.3E=J(g){I f=H.2p;if(g){f*=g}I e="";if(H.4S){e+="4S "}if(H.4W){e+="4W "}e+=f+"9g "+H.6k;K e};c.9h=J(e){K O c(e.6k,e.2p,e.4S,e.4W,e.5Y)};c.eN=O c("8Q-8P",3);N.1o(c,"N.W.6w");I b=a.eK={eL:0,eO:1,eR:2,eS:4}})(N.W);N.W.3P=J(c,b,a){H.2u=c;H.2y=b;H.2P=a};N.W.3P.eP=[32,5f,4c,2L,32,74,97,5j,97,83,99,2L,4y,bY,4v,44,32,4v,2L,4y,97,9i,32,5j,5i,2L,9m,4y,4c,9q];N.W.3P.eQ=[32,5f,4c,2L,32,65,83,80,46,78,69,84,32,77,86,67,44,32,4v,2L,4y,97,9i,32,5j,5i,2L,9m,4y,4c,9q];N.W.3P.eD=[32,5f,4c,2L,32,65,83,80,46,78,69,84,44,32,4v,2L,4y,97,9i,32,5j,5i,2L,9m,4y,4c,9q];N.W.3P.eF=[32,5f,4c,2L,32,65,83,80,46,78,69,84,44,32,5j,53,46,52,46,49,32,98,5i,4v,97];N.W.3P.eI=[32,5f,4c,2L,32,74,97,5j,97,83,99,2L,4y,bY,4v,44,32,86,50,46,51,46,49,32,98,5i,4v,97];N.W.3P.eT=[32,5f,4c,2L,32,65,83,80,46,78,69,84,32,77,86,67,44,32,49,46,55,32,98,5i,4v,97,32];N.1o(N.W.3P,"N.W.3P");N.W.4Y={fb:0,b3:1,8Z:2,1s:3,b0:4,b1:5,62:6,b4:7,fc:8,b5:9,9f:J(a){3F(a){1b H.b3:K 2A;1b H.b1:K eW;1b H.b0:K 1;1b H.62:K 25.4;1b H.1s:K 72;1b H.8Z:K 96;1b H.b4:K 96;1b H.b5:K 2.54}K 1},7y:J(a,b,c){K a*H.9f(c)/H.9f(b)},8Y:J(a){K H.7y(1,H.8Z,a)},9U:J(a){K H.7y(1,H.62,a)}};N.W.5Q=J(a){H.8V=1m;H.5M=O 5Q();H.1d=a;H.1C=O N.W.1N();H.2G=O N.W.5c();H.1y=H.3z.3b;H.aP=1m};N.W.5Q.1e={3W:J(){K H.1y},4A:J(b,c){H.1d=b;I a=O N.W.1N();if(c!==0){a.4T(c,H.1d.x+H.1d.P/2,H.1d.y+H.1d.T/2)}H.1C=a},26:J(b){if(H.5M==19){K}if(H.5M.eZ!==""&&H.8V){if(!H.2G.2v()){b.1D();H.2G.43(b);b.1B();b.1D();b.37()}b.1D();if(H.aP){I c=H.aW(b);b.8R(1,0,0,1,0,0);I a=O N.W.1N();if(H.2S!==0){a.4T(H.2S,c.x+c.P/2,c.y+c.T/2)}b.1C.1t(b,a.34());b.2w(H.5M,c.x,c.y,c.P,c.T)}X{b.1C.1t(b,H.1C.34());b.2w(H.5M,H.1d.x,H.1d.y,H.1d.P,H.1d.T)}b.1B();if(!H.2G.2v()){b.1B()}}},aW:J(b){I c=H.1d.1Z();I a=b.5W;I e=c.5r();a.6f(e);c.x=e.x;c.y=e.y;c.P*=b.1G;c.T*=b.1G;K c},1d:19,1C:19,5M:19};N.1o(N.W.5Q,"N.W.5Q");(J(a){I b=a.aV=J(e,g,c,f){H.3e=e;H.38=g;H.36=c;H.3f=f;H.1C=O a.1N();H.1r="4r";H.1q=0};b.1e={26:J(e,c){if(H.2G&&!H.2G.2v()){H.2G.43(e);e.1D();e.37()}if(H.1A&&c!=1m){e.1D();H.1A.1t(e)}e.2a=H.1r;e.21=(H.1q?H.1q:1)/e.1G;a.4j.1t(e,H.4L);e.1Y();e.1x(H.3e,H.38);e.1u(H.36,H.3f);e.1L();if(H.1A&&c!=1m){e.1B()}if(H.2G&&!H.2G.2v()){e.1B()}},4f:J(c){if(H.1A){c.1D();H.1A.1t(c);c.21=(H.1q?H.1q:1)/c.1G;c.1Y();c.1x(H.3e,H.38);c.1u(H.36,H.3f);c.2a=H.1A.1M;c.1L();c.1B()}},4A:J(e,c){H.3e=e.x;H.38=e.y;H.36=c.x;H.3f=c.y},bm:J(c){H.1r=c}};N.1o(b,"N.W.aV");a.4j={eh:0,ee:1,ef:2,e2:3,e3:4,e0:5,1t:J(c,e){if(!c.4k){K}I f=2/c.1G;if(e==1){c.4k([4*f,f])}X{if(e==2){c.4k([f,f])}X{if(e==3){c.4k([4*f,f,f,f])}X{if(e==4){c.4k([4*f,f,f,f,f,f])}X{c.4k([])}}}}}}})(N.W);N.W.1N=J(){H.14=[];H.14[0]=1;H.14[1]=0;H.14[2]=0;H.14[3]=1;H.14[4]=0;H.14[5]=0};N.W.1N.ag=J(b){I a=O N.W.1N();a.14=b;K a};N.W.1N.1e={34:J(){K H.14},e1:J(){if(H.14[0]==1&&H.14[1]==0&&H.14[2]==0&&H.14[3]==1&&H.14[4]==0&&H.14[5]==0){K 1v}K 1m},1Z:J(){I a=O N.W.1N();a.14=H.14.3M(0);K a},3G:J(a,b){H.14[4]+=H.14[0]*a+H.14[2]*b;H.14[5]+=H.14[1]*a+H.14[3]*b},1E:J(b,a){H.14[0]*=b;H.14[1]*=b;H.14[2]*=a;H.14[3]*=a},e4:J(f,c,b){I a=b.x+b.P/2;I e=b.y+b.T/2;H.3G(a,e);H.1E(f,c);H.3G(-a,-e)},aT:J(j){j=(j*S.1z)/2N;I g=S.4x(j).75(3);I h=S.4Z(j).75(3);I f=H.14[0];I e=H.14[1];I k=H.14[2];I i=H.14[3];H.14[0]=f*h-e*g;H.14[1]=f*g+e*h;H.14[2]=k*h-i*g;H.14[3]=k*g+i*h},4T:J(e,l,i){if(l 4d N.W.1s){i=l.y;l=l.x}e=e*S.1z/2N;H.3G(l,i);I h=S.4x(e).75(3);I m=S.4Z(e).75(3);I k=H.14[0];I j=H.14[1];I g=H.14[2];I f=H.14[3];H.14[0]=k*m-j*h;H.14[1]=k*h+j*m;H.14[2]=g*m-f*h;H.14[3]=g*h+f*m;H.3G(-l,-i)},e6:J(){I b=H.14[0]*(H.14[3]*1-H.14[5]*0)-H.14[1]*(H.14[2]*1-0*H.14[4])+0*(H.14[2]*H.14[5]-H.14[3]*H.14[4]);I c=1/b;I a=O N.W.1N();a.14[0]=(H.14[3]*1-H.14[5]*0)*c;a.14[1]=(H.14[4]*H.14[5]-H.14[1]*1)*c;a.14[2]=(0*H.14[4]-H.14[2]*1)*c;a.14[3]=(H.14[0]*1-0*H.14[4])*c;a.14[4]=(H.14[2]*H.14[5]-H.14[4]*H.14[3])*c;a.14[5]=(H.14[4]*H.14[1]-H.14[0]*H.14[5])*c;K a},6f:J(b){I a=b.x;I c=b.y;b.x=H.14[0]*a+H.14[2]*c+H.14[4];b.y=H.14[1]*a+H.14[3]*c+H.14[5]},7B:J(b){13(I a=0;a<b.V;a++){H.6f(b[a])}},6U:J(b){I a=b.ba();H.7B(a);K N.W.2b.bg(a)}};N.1o(N.W.1N,"N.W.1N");(J(b){I a=b.5c=J(c){H.eu=19;H.1f=19;H.bn=19;H.1W=19;H.1r=19;H.1P=19;H.4B=19;H.4w=19;H.4M=24.2f;H.4H=24.2f;H.5x=0;H.5y=0;H.1q=0;H.6j="ev";H.1C=O b.1N();H.7e();if(c!=19){I g=["M","L","B","Q","A","Z","C","E","R","U"];I f=0;2W(f<g.V){I e=g[f];c=c.3C(O 8i(e,"g"),":"+e);f++}I h=c.1n(":");H.b9=h.71(2n);H.5D();H.bp()}};a.1e={4A:J(c){H.1d=c;H.bs()},7e:J(){H.1f=[]},1Z:J(){I c=O a();c.4M=H.4M;c.4H=H.4H;c.5x=H.5x;c.5y=H.5y;c.1f=H.1f;c.1r=H.1r;c.1W=H.1W;c.1C=O b.1N();K c},3W:J(){K H.3z.3b},2v:J(){if(H.1f.V===0){K 1v}K 1m},5D:J(){b.9u.5D(H.b9,H)},43:J(g,e){if(e==1m){g.1D()}if(H.1C){g.1C.1t(g,H.1C.34())}g.1Y();I h=H.1f;I c=h.V;if(c>0){I f=0;2W(f<c){3F(h[f]){1b"M":g.1x(h[f+1],h[f+3]);f+=4;18;1b"L":g.1u(h[f+1],h[f+3]);f+=4;18;1b"C":g.2K(h[f+1],h[f+3],h[f+5],h[f+7],h[f+9],h[f+11]);f+=12;18;1b"Q":g.4h(h[f+1],h[f+3],h[f+5],h[f+7]);f+=8;18;1b"A":g.8F(h[f+1],h[f+3],h[f+5],h[f+7],h[f+9],h[f+11]);f+=12;18;1b"R":g.4b(h[f+1],h[f+3],h[f+5],h[f+7]);f+=8;18;1b"E":g.1x(h[f+1],h[f+3]-h[f+7]/2);g.2K(h[f+1]+h[f+5]/2,h[f+3]-h[f+7]/2,h[f+1]+h[f+5]/2,h[f+3]+h[f+7]/2,h[f+1],h[f+3]+h[f+7]/2);g.2K(h[f+1]-h[f+5]/2,h[f+3]+h[f+7]/2,h[f+1]-h[f+5]/2,h[f+3]-h[f+7]/2,h[f+1],h[f+3]-h[f+7]/2);f+=8;18;1b"U":g.9E(h[f+1],h[f+3],h[f+5],h[f+7],h[f+9]);f+=10;18;1b"Z":if(g.6J){g.6J()}c7:f+=1}}}if(e==1m){g.1B()}},26:J(e,c){e.1D();H.43(e);if(H.1A&&c!=1m){H.1A.1t(e)}if(H.1W){e.3s=N.29.3q.40(e,H.1W,H.2h());e.22()}e.1B();if(H.1r){e.2a=N.29.3q.40(e,H.1r,H.2h(),1v);e.21=(H.1q?H.1q:1)/e.1G;b.4j.1t(e,H.4L);e.6j=H.6j;e.1L()}},4f:J(c){if(H.1A){c.1D();H.43(c);H.1A.1t(c);if(H.1W){c.3s=H.1A.1M;c.22()}X{if(H.1r){c.2a=H.1A.1M;c.21=(H.1q?H.1q:1)/c.1G;c.6j=H.6j;c.1L()}}c.1B()}},bp:J(){if(H.1f){H.bn=H.1f.ex("")}H.6h()},1x:J(c,e){H.1f.Y("M");H.1f.Y(c);H.1f.Y(",");H.1f.Y(e);H.4B=c;H.4w=e;H.2H(c,e)},1u:J(c,e){H.1f.Y("L");H.1f.Y(c);H.1f.Y(",");H.1f.Y(e);H.4B=c;H.4w=e;H.2H(c,e)},9C:J(g,i,e,h,c,f){H.1f.Y("C");H.1f.Y(g);H.1f.Y(",");H.1f.Y(i);H.1f.Y(",");H.1f.Y(e);H.1f.Y(",");H.1f.Y(h);H.1f.Y(",");H.1f.Y(c);H.1f.Y(",");H.1f.Y(f);H.4B=c;H.4w=f;H.2H(g,i);H.2H(e,h);H.2H(c,f)},4F:J(e,j,c,g,f,i){H.1f.Y("A");H.1f.Y(e);H.1f.Y(",");H.1f.Y(j);H.1f.Y(",");H.1f.Y(c);H.1f.Y(",");H.1f.Y(g);H.1f.Y(",");H.1f.Y(f);H.1f.Y(",");H.1f.Y(i);H.4B=e;H.4w=j;I h=+c;H.2H(+e-h,+j-h);H.2H(+e+h,+j+h)},4h:J(e,f,c,g){H.1f.Y("Q");H.1f.Y(e);H.1f.Y(",");H.1f.Y(f);H.1f.Y(",");H.1f.Y(c);H.1f.Y(",");H.1f.Y(g);H.4B=c;H.4w=g;H.2H(e,f);H.2H(c,g)},7T:J(e,g,f,c){H.1f.Y("R");H.1f.Y(e);H.1f.Y(",");H.1f.Y(g);H.1f.Y(",");H.1f.Y(f);H.1f.Y(",");H.1f.Y(c);H.4B=e+f;H.4w=g+c;H.2H(e,g);H.2H(e+f,g+c)},6v:J(e,c){H.1x(e.x,e.y+c);H.1u(e.x,e.y+e.T-c);H.4h(e.x,e.y+e.T,e.x+c,e.y+e.T);H.1u(e.x+e.P-c,e.y+e.T);H.4h(e.x+e.P,e.y+e.T,e.x+e.P,e.y+e.T-c);H.1u(e.x+e.P,e.y+c);H.4h(e.x+e.P,e.y,e.x+e.P-c,e.y);H.1u(e.x+c,e.y);H.4h(e.x,e.y,e.x,e.y+c)},9E:J(f,h,e,g,c){I i=N.W.2b.5v(O N.W.1s(f,h),O N.W.1s(e,g));H.6v(i,c)},ey:J(e,g,f,c){H.1f.Y("E");H.1f.Y(e);H.1f.Y(",");H.1f.Y(g);H.1f.Y(",");H.1f.Y(f);H.1f.Y(",");H.1f.Y(c);H.4B=e;H.4w=g;H.2H(e-f,g-c);H.2H(e+f,g+c)},5G:J(){H.1f.Y("Z")},ek:J(c){H.1W=c;H.6h()},bm:J(c){H.1r=c;H.6h()},eq:J(c){H.1P=c;H.6h()},70:J(c){},2h:J(){K O b.2b(H.4M,H.4H,H.5x-H.4M,H.5y-H.4H)},2H:J(c,e){H.4M=S.1Q(H.4M,c);H.4H=S.1Q(H.4H,e);H.5x=S.2j(H.5x,c);H.5y=S.2j(H.5y,e)},bs:J(){},6h:J(){},1C:19};a.5v=J(e){I f=O a(19);13(I c=0;c<e.V;c++){f.1x(e[c].x,e[c].y)}K f};N.1o(a,"N.W.5c")})(N.W);(J(b){I a=b.9u=J(){};a.5D=J(h,p){13(I m=0;m<h.V;m++){I l=h[m];I r=h[m][0];3F(r){1b"M":l=l.1U(1,l.V);I v=+l.1n(",")[0];I t=+l.1n(",")[1];p.1x(v,t);18;1b"L":l=l.1U(1,l.V);I v=+l.1n(",")[0];I t=+l.1n(",")[1];p.1u(v,t);18;1b"B":l=l.1U(1,l.V);I g=+l.1n(",")[0];I u=+l.1n(",")[1];I f=+l.1n(",")[2];I s=+l.1n(",")[3];I e=+l.1n(",")[4];I q=+l.1n(",")[5];p.9C(f,s,e,q,g,u);18;1b"C":l=l.1U(1,l.V);I g=+l.1n(",")[0];I u=+l.1n(",")[1];I f=+l.1n(",")[2];I s=+l.1n(",")[3];I e=+l.1n(",")[4];I q=+l.1n(",")[5];p.9C(g,u,f,s,e,q);18;1b"Q":l=l.1U(1,l.V);I g=+l.1n(",")[0];I u=+l.1n(",")[1];I v=+l.1n(",")[2];I t=+l.1n(",")[3];p.4h(g,u,v,t);18;1b"A":l=l.1U(1,l.V);I v=+l.1n(",")[0];I t=+l.1n(",")[1];I n=+l.1n(",")[2];I o=+l.1n(",")[3];I j=+l.1n(",")[4];I k=(+l.1n(",")[5]===1);p.4F(v,t,n,o,j,k);18;1b"U":l=l.1U(1,l.V);I g=+l.1n(",")[0];I u=+l.1n(",")[1];I f=+l.1n(",")[2];I s=+l.1n(",")[3];I n=+l.1n(",")[4];p.9E(g,u,f,s,n);18;1b"Z":p.5G();18}}};N.1o(a,"N.W.9u")})(N.W);N.W.1s=J(a,b){H.x=a;H.y=b;H.1y=H.3z.3b};N.W.1s.3t=J(b,a){K S.2T(S.1J((a.x-b.x),2)+S.1J((a.y-b.y),2))};N.W.1s.bj=J(e,c){I a=c.y-e.y;I b=c.x-e.x;K S.ao(a,b)/S.1z*2N};N.W.1s.6T=J(a,b){I c=a.1Z();c.6T(b);K c};N.W.1s.1e={3W:J(){K H.1y},2v:J(){K(H.x===0&&H.y===0)},3t:J(a){K S.2T(S.1J((H.x-a.x),2)+S.1J((H.y-a.y),2))},bj:J(a){I b=a.y-H.y;I c=a.x-H.x;K S.ao(b,c)/S.1z*2N},6T:J(a){H.x+=a.x;H.y+=a.y;K H},lh:J(b,a){I c=H.1Z();c.x+=b;c.y+=a;K c},8w:J(a){if(!a){K 1m}K(H.x===a.x&&H.y===a.y)},1Z:J(){I a=O N.W.1s(H.x,H.y);K a}};N.1o(N.W.1s,"N.W.1s");(J(c){I a=N.1I.5F;I b=c.2b=J(f,h,g,e){if(h 4d N.W.4z){g=h.P;e=h.T}if(f 4d N.W.1s){h=f.y;f=f.x}H.x=f;H.y=h;H.P=g;H.T=e;H.1C=O c.1N();H.1y=H.3z.3b};b.4E=J(f,g,h,e){K O b(S.1Q(f,h),S.1Q(g,e),S.2B(h-f),S.2B(e-g))};b.li=J(e){K O b(e[0],e[1],e[2],e[3])};b.5v=J(f,e){K b.4E(f.x,f.y,e.x,e.y)};b.l7=J(e,g){I f=g.P;I i=g.T;K O b(e.x-f/2,e.y-i/2,f,i)};b.kX=J(e,f){K O b(e.x,e.y,f.P,f.T)};b.kV=J(f){I e=f.P;I g=f.T;K O b(f.x-e/2,f.y-g/2,e,g)};b.bg=J(h){I f=24.2f;I g=24.2f;I i=24.bf;I e=24.bf;a.2o(h,J(j){f=S.1Q(f,j.x);g=S.1Q(g,j.y);i=S.2j(i,j.x);e=S.2j(e,j.y)});K b.4E(f,g,i,e)};b.1e={3W:J(){K H.1y},l5:J(){K(H.P===0&&H.T===0)},1g:J(){K S.2j(H.x,H.x+H.P)},1j:J(){K S.1Q(H.x,H.x+H.P)},1h:J(){K S.2j(H.y,H.y+H.T)},1k:J(){K S.1Q(H.y,H.y+H.T)},1c:J(){K O c.1s(H.1j()+H.P/2,H.1k()+H.T/2)},5r:J(){K O c.1s(H.1j(),H.1k())},7I:J(){K O c.1s(H.1g(),H.1k())},l3:J(){K O c.1s(H.x+H.P/2,H.1k())},7E:J(){K O c.1s(H.1j(),H.1h())},7s:J(){K O c.1s(H.1g(),H.1h())},l0:J(e){K!(H.8v(e)===b.2v)},l6:J(e){if(H.1h()<=e.1k()){K 1m}if(H.1k()>=e.1h()){K 1m}if(H.1j()>=e.1g()){K 1m}if(H.1g()<=e.1j()){K 1m}K 1v},3p:J(e){if(e){if(e 4d N.W.2b){if(H.4s(e.7E())&&H.4s(e.7s())&&H.4s(e.5r())&&H.4s(e.7I())){K 1v}}X{if(e 4d N.W.1s){if(H.4s(e)){K 1v}}}}K 1m},4s:J(e){K H.1j()<=e.x&&H.1g()>=e.x&&H.1k()<=e.y&&H.1h()>=e.y},bG:J(g){if(!g){K H}I i=S.1Q(H.1j(),g.1j());I f=S.2j(H.1g(),g.1g());I h=S.1Q(H.1k(),g.1k());I e=S.2j(H.1h(),g.1h());K O b(i,h,f-i,e-h)},8v:J(g){if(H.1h()<g.1k()){K b.2v}if(H.1k()>g.1h()){K b.2v}if(H.1j()>g.1g()){K b.2v}if(H.1g()<g.1j()){K b.2v}I i=S.2j(H.1j(),g.1j());I f=S.1Q(H.1g(),g.1g());I e=S.1Q(H.1h(),g.1h());I h=S.2j(H.1k(),g.1k());K O b(i,h,f-i,e-h)},1Z:J(){K O b(H.x,H.y,H.P,H.T)},26:J(f,e){f.1D();f.1C.1t(f,H.1C.34());f.1Y();f.4b(H.x,H.y,H.P,H.T);f.1D();if(H.1A&&e!=1m){H.1A.1t(f)}if(H.1W){f.3s=N.29.3q.40(f,H.1W,H.2h());f.22()}f.1B();if(H.1r){f.2a=H.1r;f.21=(H.1q?H.1q:1)/f.1G;c.4j.1t(f,H.4L);f.1L()}f.1B()},4f:J(e){if(H.1A){e.1D();H.1A.1t(e);e.1C.1t(e,H.1C.34());e.1Y();e.4b(H.x,H.y,H.P,H.T);e.3s=H.1A.1M;e.22();e.1B()}},bb:J(e){e.4b(H.x,H.y,H.P,H.T)},2h:J(e){K O N.W.2b(H.x,H.y,H.P,H.T)},4A:J(e){H.x=e.x;H.y=e.y;H.P=e.P;H.T=e.T},a1:J(e){H.x=e.x;H.y=e.y},ko:J(e){H.x=e.x-H.P/2;H.y=e.y-H.T/2},8C:J(e){if(!e){K H}I f=b.4E(H.x-e,H.y-e,H.1g()+e,H.1h()+e);K f},8e:J(e,f){H.x+=e;H.y+=f},ba:J(){K[H.5r(),H.7I(),H.7s(),H.7E()]},ks:J(){K O b(0,0,H.P,H.T)},8w:J(e){if(!e){K 1m}K(H.x===e.x&&H.y===e.y&&H.P===e.P&&H.T===e.T)},kr:J(e){K H.P==e.P&&H.T==e.T},3E:J(){K H.x+", "+H.y+", "+H.P+", "+H.T},bc:J(){K O c.4z(H.P,H.T)},1C:19,1r:"4r",1q:0,1W:"4a"};N.1o(b,"N.W.2b");b.2v=O b(0,0,0,0)})(N.W);(J(a){I b=a.bk=J(e,c,f){H.1M=e;H.be=c;H.bd=f};b.1e={1t:J(c){c.cC=H.be;c.cB=H.bd;c.cE=4;c.3o=H.1M}};N.1o(b,"N.W.bk")})(N.W);(J(c){I b=N.1I.5F;I a={};I e=c.6u=J(g,f){H.1P=g;H.1d=f;H.x=f.x;H.y=f.y;H.P=f.P;H.T=f.T;H.2G=O c.5c();H.3I=1X.5N;H.5O=1X.5N;H.bt="7R";H.5z=O c.7a(1,1,1,1);H.1y=H.3z.3b};e.1e={3W:J(){K H.1y},1Z:J(){I f=O e(H.1P,H.1d);f.2S=H.2S;f.2G=H.2G.1Z();f.3I=H.3I;f.5O=H.5O;f.5z=H.5z;f.8h=H.8h;if(H.1L){f.1L=H.1L}if(H.1q){f.1q=H.1q}K f},8k:J(f,g){H.5L=e.bT(f,H.1P,g.P);K H.5L},26:J(g,f){if(H.1P===""){K}I i=H.6a?1:g.1G;g.1D();if(!H.2G.2v()){H.2G.43(g);g.37()}g.8f=H.bt;g.3s=H.1r;if(H.1L){if(H.1q!==1p){g.21=H.1q*i}g.2a=N.29.3q.40(g,H.1L,H.1d,1v)}H.3a=H.2s.2p*i;I h=H.1d.1Z();H.5z.bv(h);if(!H.6a){if(g.5W){h=g.5W.6U(h)}g.8R(1,0,0,1,0,0);g.21=g.21*i}if(H.2S){g.1C.1t(g,H.8g(h).34())}if(H.bu){I j=H.8U(H.1P);H.bo(g,j,h,H.3I,H.5O)}X{g.2s=H.2s.3E(i);if(H.8h){H.8k(g,h);H.bl(g,h)}X{if(H.3I==1X.5N){g.56="1j"}X{if(H.3I==1X.3d){g.56="1c"}X{if(H.3I==1X.4N){g.56="1g"}}}if(H.1L){if(H.1q!==1p){g.21=H.1q*i}g.7Q(H.1P,h.x,h.y)}g.7N(H.1P,h.x,h.y)}}g.1B()},bl:J(h,m){if(H.5L.V===0){K}I p=(m.T>0)?m.T:H.3a;I n=S.8j(p/(H.3a)+0.8M);if(n==0&&p>H.3a*0.9){n=1}n=S.1Q(n,H.5L.V);I l=n*H.3a;I k=m.y;3F(H.5O){1b 1X.3d:k+=m.T/2-l/2;18;1b 1X.4N:k+=m.T-l;18}I o=m.x;3F(H.3I){1b 1X.5N:h.56="1j";18;1b 1X.3d:o+=m.P/2;h.56="1c";18;1b 1X.4N:o+=m.P;h.56="1g";18}if(h.8f=="7R"){k+=H.3a/2}13(I j=0;j<n;j++){I q=H.5L[j];if(!q){5E}I g=k+H.3a*j;if(H.1L){if(H.1q!==1p){h.21=H.1q*h.1G}h.7Q(q,o,g)}h.7N(q,o,g);if(H.2s.5Y){g+=H.3a/2;I f=h.3V(q);3F(H.3I){1b 1X.5N:H.60(h,o,g,f.P);18;1b 1X.3d:H.60(h,o-f.P/2,g,f.P);18;1b 1X.4N:H.60(h,o-f.P,g,f.P);18}}}},l2:J(){I f=O c.1s(H.x,H.y);I i=O c.1s(H.x+H.P,H.y+H.T);I h=[f,i];I g=H.8g(H.1d);g.7B(h);K c.2b.4E(h[0].x,h[0].y,h[1].x,h[1].y)},4A:J(f,g){H.1d=f;H.x=f.x;H.y=f.y;H.P=f.P;H.T=f.T;H.2S=g},8g:J(g){I f=O c.1N();if(H.2S&&H.2S!==0){f.4T(H.2S,g.x+g.P/2,g.y+g.T/2)}K f},bo:J(l,n,F,u,o){I s=F.x;I r=F.y;I z=F.P;I v=F.T;I g=H.8T(l,n,z);I f=19;I p=H.3a;I E=p;if(l.8f=="7R"){E/=2}if(o==1X.3d){E+=v/2-p*g.V/2}if(o==1X.4N){E+=v-p*g.V}E+=r;l.56="1j";I G=H.lc&&g.V>1;if(G){l.1D();l.1Y();l.4b(F.x,F.y,F.P,F.T);l.37()}13(I C=0;C<g.V;C++){I t=g[C];I m=0;if(u==1X.3d){m=z/2-t.P/2}if(u==1X.4N){m=z-t.P}13(I B=0;B<t.V;B++){I A=t[B];if(A.5K!=f){H.8L(l,A.5K);f=A.5K}I k=A.5K.8K;I q=k===0?0:H.2s.2p*l.1G*(k>0?-1:1)/3;13(I D=1;D<S.2B(k);D++){q+=q/3}I w=E+A.dy+q;if(!G&&(w<r+p/4||w>r+v-p/4)){5E}if(H.1L){if(H.1q!==1p){l.21=H.1q*l.1G}l.7Q(A.1P,s+m+A.dx,w)}l.7N(A.1P,s+m+A.dx,w);if(A.5K.5Y){H.60(l,s+m+A.dx,w+p/2,A.4O)}}}if(G){l.1B()}},8U:J(f){if(H.aX==f&&H.7Z){K H.7Z}H.aX=f;f=f.3C(/\\r\\n/g,"<br />").3C(/[\\r\\n]/g,"<br />");f=f.3C(/<1M=/g,"<1M 1H=");if(!e.7X){e.7X=27.7F("6O")}I h=e.7X;h.95=f;I g=[];H.7W(h,g,{});H.7Z=g;K g},7W:J(j,n,h){I m=j.kP.5U();if(m=="#1P"){I k=j.cF;I l=H.aO(k,h);n.Y(l)}X{if(m=="br"){n.Y(a)}X{if(m=="1M"){m+="="+j.kF("1H")}H.aS(m,h);13(I g=0;g<j.6S.V;g++){I f=j.6S[g];H.7W(f,n,h)}H.aR(m,h)}}},aO:J(g,f){K{1P:g,4W:f.i>0,4S:f.b>0,5Y:f.u>0,8K:f.aQ?f.aQ:0-(f.4o?f.4o:0),1M:f.57?f.57[f.57.V-1]:19}},aS:J(g,i){if(g.1R("1M")==0){if(!i.57){i.57=[]}I f=g.1n("=")[1];i.57.Y(f);K}I h=i[g];if(!h){h=0}h++;i[g]=h},aR:J(f,g){if(f.1R("1M")==0){g.57.m0();K}g[f]--},60:J(g,f,i,h){if(!H.1L){if(H.1q!==1p){g.21=H.1q*g.1G}g.2a=g.3s}if(g.4k){g.4k([])}g.1Y();g.1x(f,i);g.1u(f+h,i);g.1L()},8T:J(h,q,g){I s=[];I t=[];t.P=0;I o=1v;I m=0;I j=0;I r=H.3a;J p(){s.Y(t);t=[];t.P=0;j+=r;m=0;o=1v}13(I n=0;n<q.V;n++){I l=q[n];if(l===a){p();5E}H.8L(h,l);I k=l.1P;2W(k.V>0){I f=H.b6(h,k,m,j,g,o);f.5K=l;t.Y(f);t.P+=f.4O;k=f.5P;if(k.V>0){p()}X{m+=f.4O;o=1m}}}if(t.V>0){s.Y(t)}K s},b8:J(g,h){I f=g.1U(h).lY(/\\s+/);K f>-1?f+h:g.V},b6:J(j,r,o,n,f,m){if(m){2W(r.V>0&&/\\s/.8c(r.35(0))){r=r.1U(1)}}I g=j.3V(r);if(o+g.P>f){I h=0;I q=0;13(I l=0;l<=r.V;){I k=H.b8(r,l);g=j.3V(r.1U(0,k));if(o+g.P>f){I p=r.1U(0,h);if(p.V==0&&m){K H.b7(j,r,o,n,f,m)}K{5P:r.1U(p.V),4O:q,1P:p,dx:o,dy:n}}h=k;q=g.P;l=k+1}}K{5P:"",4O:g.P,1P:r,dx:o,dy:n}},b7:J(h,p,m,l,f,k){if(k){2W(p.V>0&&/\\s/.8c(p.35(0))){p=p.1U(1)}}I g=h.3V(p);if(m+g.P>f){I o=0;13(I j=1;j<=p.V;j++){g=h.3V(p.1U(0,j));if(m+g.P>f){I n=p.1U(0,j-1);if(n.V==0&&k){n=p.1U(0,1);o=g.P}K{5P:p.1U(n.V),4O:o,1P:n,dx:m,dy:l}}o=g.P}}K{5P:"",4O:g.P,1P:p,dx:m,dy:l}},8L:J(h,k){I f="";I j=h.1G;13(I g=0;g<S.2B(k.8K);g++){j*=66/2A}if(k.4S){f="4S "+f}if(k.4W){f="4W "+f}f+=H.2s.3E(j);h.2s=f;if(k.1M){h.3s=k.1M}X{h.3s=H.1r}},bZ:J(g,n){I h=H.5z;if(H.1P===""){K O c.4z(h.1j+h.1g,h.1k+h.1h)}I j=H.6a?1:g.1G;g.1D();H.3a=H.2s.2p*j;if(n!=24.2f){n*=j}if(!H.6a){g.8R(1,0,0,1,0,0)}I l=H.8U(H.1P);I p=H.8T(g,l,n);g.1B();I o=H.3a*p.V;I f=0;13(I k=0;k<p.V;k++){f=S.2j(f,p[k].P)}if(!H.6a){f+=1}K O c.4z(f/j+h.1j+h.1g,o/j+h.1k+h.1h)},1r:"4r",1d:19,5L:19};e.bT=J(h,j,i){I g=j.1n("\\n");if(i==24.2f){K g}I f=[];b.2o(g,J(k){e.bS(h,k,i,f)});K f};e.bS=J(g,n,l,p){I k=n.1n(" ");I o="";13(I j=0;j<k.V;j++){I f=k[j];I h=g.3V(o+f).P;if(h<l){if(j==0){o+=(f)}X{o+=(" "+f)}}X{if(o!=""){p.Y(o)}o=f}if(j==k.V-1){p.Y(o);18}}};e.lo=J(n,g,j,m){j.1D();j.1E(m,m);j.2s=g;I l=n.1n(/\\s{1,}/);I f=0;I k=0;13(I h=0;h<l.V;h++){f=j.3V(l[h]).P;if(f>k){k=f}}j.1B();K k};N.1o(e,"N.W.6u");1X={5N:0,3d:1,4N:2}})(N.W);N.W.1T=J(a,b){H.x=a;H.y=b;H.1y=H.3z.3b};N.W.1T.1e={3W:J(){K H.1y},1Z:J(){K O N.W.1T(H.x,H.y)},V:J(){K S.2T(N.W.1T.8o(H,H))},lL:J(){K N.W.1T.8o(H,H)},lK:J(){K O N.W.1T(-H.x,-H.y)},lN:J(){K O N.W.1T(H.x/H.V(),H.y/H.V())},8m:J(){K O N.W.1s(H.x,H.y)}};N.W.1T.5v=J(b,a){K O N.W.1T(a.x-b.x,a.y-b.y)};N.W.1T.8o=J(b,a){K(b.x*a.x)+(b.y*a.y)};N.W.1T.3S=J(a,b){K O N.W.1T(a.x*b,a.y*b)};N.W.1T.lE=J(a,b){K O N.W.1T(a.x*(1/b),a.y*(1/b))};N.W.1T.2Z=J(b,a){K O N.W.1T(b.x+a.x,b.y+a.y)};N.W.1T.4o=J(b,a){K O N.W.1T(b.x-a.x,b.y-a.y)};N.1o(N.W.1T,"N.W.1T");N.33("N.2Y");N.2Y.lI={lH:"lG",km:"iz",iA:"c7",iw:"ix",iE:"iF",iD:"e-5h",iB:"iC-5h",io:"ip-5h",im:"n-5h",6u:"1P",il:"iu",iv:"it",iq:"ir",iG:"iU",iV:"5V-ca",iT:"19",iR:"8A-iZ",j0:"5V-ca"};N.2Y.1S={76:0,7c:1,7j:2,7l:3,88:4,85:5,8b:6,8r:7};N.2Y.2F={ch:0,2R:1};N.2Y.3N={cn:0,7i:1,7Y:2,6r:3};N.33("N.29");(J(a){I b=N.W.2b;I c=N.W.1s;I e=a.3q=J(){};e.iL=J(f,g){I h=O c(50,50);if(g.P>0&&g.T>0){h.x=(f.x-g.x)*2A/g.P;h.y=(f.y-g.y)*2A/g.T}K h};e.iJ=J(q,l,f){I p=0,j=0,r=l.x,k=l.y,m=q;3F(f){1b a.2J.bR:p=m.1j();j=m.1k();18;1b a.2J.bC:p=m.1j();j=m.1h()-k;18;1b a.2J.bB:p=m.1g()-r;j=m.1k();18;1b a.2J.bD:p=m.1g()-r;j=m.1h()-k;18;1b a.2J.3d:p=(m.1g()+m.1j()-r)/2;j=(m.1h()+m.1k()-k)/2;18;1b a.2J.bF:p=m.x+m.P/2-r/2;j=m.y;18;1b a.2J.bE:p=m.x+m.P/2-r/2;j=m.1h()-k;18;1b a.2J.bx:p=m.x;j=m.y+m.T/2-k/2;18;1b a.2J.bw:p=m.1g()-r;j=m.y+m.T/2-k/2;18;1b a.2J.by:I i=m.T;I n=m.P;if(i==0){18}I o=n/i;I g=r/k;if(o>g){k=i;r=(g*k);j=m.1k();p=(m.1g()+m.1j()-r)/2}X{r=n;if(g==0){18}k=(r/g);p=m.1j();j=(m.1h()+m.1k()-k)/2}18;1b a.2J.bA:r=m.1g()-m.1j();k=m.1h()-m.1k();p=m.1j();j=m.1k();18;1b a.2J.bz:p=m.1j();j=m.1k();18}K O b(p,j,r,k)};e.hM=J(g,f){if(g.P===0||g.T===0){K f}K g.bG(f)};e.bN=J(g){I f=O b(0,0,0,0);f.x=S.1Q(g.x,g.1g());f.P=S.2B(g.P);f.y=S.1Q(g.y,g.1h());f.T=S.2B(g.T);K f};e.8C=J(g,f,h){if(g.P+2*f<0){f=-g.P/2}if(g.T+2*h<0){h=-g.T/2}K O b(g.x-f,g.y-h,g.P+2*f,g.T+2*h)};e.hT=J(l,h,k,i){I g=24.2f;if(i){i.1H=0}13(I o=0;o<k-1;++o){I n=h[o];I m=h[o+1];I j=O N.W.5S(l,n,m);I f=j.8B();if(f<g){g=f;if(i){i.1H=o}}}K S.2T(g)};e.8v=J(i,h,g,f){K(H.6i(i,h,g)*H.6i(i,h,f)<=0)&&(H.6i(g,f,i)*H.6i(g,f,h)<=0)};e.6i=J(l,j,h){I k,i;I g,f;k=j.x-l.x;i=h.x-l.x;g=j.y-l.y;f=h.y-l.y;K((k*f>g*i)?1:-1)};e.8u=J(p,o,i,h){if(p.x==o.x&&i.x==h.x){K 1p}if(p.x==o.x){I n=(i.y-h.y)/(i.x-h.x);I l=(i.x*h.y-h.x*i.y)/(i.x-h.x);K O c(p.x,n*p.x+l)}if(i.x==h.x){if(p.y==o.y){K O c(i.x,p.y)}I n=(p.y-o.y)/(p.x-o.x);I l=(p.x*o.y-o.x*p.y)/(p.x-o.x);K O c(i.x,n*i.x+l)}I g=(p.y-o.y)/(p.x-o.x);I m=(p.x*o.y-o.x*p.y)/(p.x-o.x);I f=(i.y-h.y)/(i.x-h.x);I k=(i.x*h.y-h.x*i.y)/(i.x-h.x);if(g==f){K 1p}I j=O c((k-m)/(g-f),g*(k-m)/(g-f)+m);if(p.y==o.y){j.y=p.y}K j};e.bH=J(l,j,g,f){I n=e.8u(l,j,g,f);if(!n){K n}I m=(n.x-l.x)*(n.x-j.x);I k=(n.y-l.y)*(n.y-j.y);if(m>0.6l||k>0.6l){K 1p}I i=(n.x-g.x)*(n.x-f.x);I h=(n.y-g.y)*(n.y-f.y);if(i>0.6l||h>0.6l){K 1p}K n};e.hC=J(g,l){I m=0;l=l.3M(0);13(I k=0;k<l.V;++k){l[k].x-=g.x;l[k].y-=g.y}13(I k=0;k<l.V;++k){I h=(k+1)%l.V;if(l[k].y>0&&l[h].y<=0||l[h].y>0&&l[k].y<=0){I f=(l[k].x*l[h].y-l[h].x*l[k].y)/(l[h].y-l[k].y);if(f>0){m++}}}K m%2==1};e.hD=J(m,n,j,g){I k,f,h=24.2f;13(I l=0;l<m.V;l++){f=e.bH(m[l],m[(l+1)%m.V],n,j);if(f){k=e.a2(f,j);if(k<h){h=k;g.x=f.x;g.y=f.y}}}K h<24.2f};e.hH=J(l,i,f){if(i.8w(f)){K i}I j=f.x-i.x;I h=f.y-i.y;I g=(l.x-i.x)*j+(l.y-i.y)*h;if(g<0){K i}g=(f.x-l.x)*j+(f.y-l.y)*h;if(g<0){K f}I k=e.9T({x:i.x-f.x,y:i.y-f.y});I m=O c(l.x+k.x,l.y+k.y);K e.8u(i,f,l,m)};e.9T=J(f){K{x:f.y,y:-f.x}};e.6M=J(f,h){I i=O c(h.x-f.x,h.y-f.y);I g=O c(i.x+h.x,i.y+h.y);K g};e.i9=J(g,l,f){I k=l.x-g.x;I i=l.1g()-g.x;I h=l.y-g.y;I j=l.1h()-g.y;if(i<0){if(h>0){K(i*i+h*h<f*f)}X{if(j<0){K(i*i+j*j<f*f)}X{K(S.2B(i)<f)}}}X{if(k>0){if(h>0){K(k*k+h*h<f*f)}X{if(j<0){K(k*k+j*j<f*f)}X{K(S.2B(k)<f)}}}X{if(h>0){K(S.2B(h)<f)}X{if(j<0){K(S.2B(j)<f)}X{K 1v}}}}};e.i7=J(f,h){I g=e.9S(f,h);K c.3t(f,g)};e.9S=J(f,g){K O c(e.8S(f.x,g.x,g.1g()),e.8S(f.y,g.y,g.1h()))};e.8S=J(k,h,f){I j,g;I i=e.9X(k,h,f,j,g);j=i.a;g=i.b;if(e.a0(k,j,g)){K k}X{K j}};e.8H=J(f,g){K S.2B(f-g)<0.8M};e.ie=J(g,f){K e.8H(g.x,f.x)&&e.8H(g.y,f.y)};e.i1=J(g,f){K O c((g.x+f.x)/2,(g.y+f.y)/2)};e.9X=J(f,l,j,k,g){I h=e.6Q(l,j);l=h.a;j=h.b;I i;if(f<l){i=1v}X{if(f>j){i=1m}X{i=f-l<j-f}}if(i){k=l;g=j}X{k=j;g=l}K{a:k,b:g}};e.a3=J(g,f){I h=g;g=f;f=h;K{a:g,b:f}};e.6Q=J(g,f){if(f<g){I h=e.a3(g,f);g=h.a;f=h.b}K{a:g,b:f}};e.a0=J(i,g,f){I h=e.6Q(g,f);g=h.a;f=h.b;K e.6b(i,g,f)};e.6b=J(h,g,f){K g<=h&&h<=f};e.i5=J(g,f){K{x:g.x-f.x,y:g.y-f.y}};e.i6=J(h,f,k){if(h.V!==f.V){K}13(I g=0;g<h.V;++g){I j=f[g].1Z();h[g]=j.6T(k)}};e.i2=J(f,g){K O c(g.x+f.x/2A*g.P,g.y+f.y/2A*g.T)};e.i3=J(g,f){g.P=f.P;g.T=f.T;g.a1(f.5r())};e.jV=J(f,g){K e.6b(f.x,0,g.P)&&e.6b(f.y,0,g.T)};e.6b=J(h,g,f){K g<=h&&h<=f};e.jR=J(f){K 5*N.W.4Y.9U(f)};e.a2=J(g,f){K(g.x-f.x)*(g.x-f.x)+(g.y-f.y)*(g.y-f.y)};e.7O=J(f){K f/2N*S.1z};e.k0=J(f){K f/S.1z*2N};e.jY=J(f,g,i){I h=O N.W.1N();h.4T(i,g.x,g.y);f=f.1Z();h.6f(f);K f};e.jX=J(k,g,m){I h=O N.W.1N();h.4T(m,g.x,g.y);13(I j=0,f=k.V;j<f;++j){h.6f(k[j])}};e.jL=J(f){K O c(f.x+f.P/2,f.y+f.T/2)};e.jJ=J(h,f,i){if(i==0){K h}I g=O N.W.1N();g.4T(i,f.x,f.y);K g.6U(h)};e.2h=J(g){I f=e.6L();I i=1l.2h(g);if(aa.a5.5U().1R("a4")>-1){if(f.2Q!=0||f.2D!=0){I h=g.a7();if((i.x-h.1j)<1&&(i.y-h.1k)<1){i.x+=f.2Q;i.y+=f.2D}}}K i};e.6L=J(){I g=0;I f=0;if(3H.9Y!=1p){g=3H.9Y}X{if(27.5e.2D!==0){g=27.5e.2Q}X{g=27.ab.2Q}}if(3H.a9!=1p){f=3H.a9}X{if(27.5e.2D!==0){f=27.5e.2D}X{f=27.ab.2D}}K{2Q:g,2D:f}};e.7D=J(k,h){I g=e.6L();I j=1l.2h(h);I f=k.9O-j.x+g.2Q;I l=k.9P-j.y+g.2D;if(aa.a5.5U().1R("a4")>-1){if(g.2Q!=0||g.2D!=0){I i=h.a7();if((j.x-i.1j)<1&&(j.y-i.1k)<1){f-=g.2Q;l-=g.2D}}}K O c(f,l)};e.kd=J(h){I g=e.6L();I f=h.9O+g.2Q;I i=h.9P+g.2D;K O c(f,i)};e.cz=J(k,j){I f=[];if(j==1p){j=27}if(j.8a.6g()==k.6g()){f.Y(j)}I h=j.6S;13(I g=0;g<h.V;g++){if(h[g].8a){if(h[g].8a.6g()==k.6g()){f.Y(h[g])}}}K f};e.40=J(j,f,q,o){if(!f){K(o)?"#5m":"#9j"}if(f.1y=="k4"){if(39 f.1M=="81"){K f.1M}X{if(f.1M.1H){K f.1M.1H}}}X{if(f.1y=="3X"){I x=f.3e?f.3e:q.x;I m=f.38?f.38:q.y+q.T/2;I w=f.36?f.36:q.x+q.P;I h=f.3f?f.3f:q.y+q.T/2;if(f.2P){if(f.2P===2N){x=q.x+q.P/2;m=q.y+q.T/2;w=q.x;h=q.y+q.T/2}X{if(f.2P===90){x=q.x+q.P/2;m=q.y;w=q.x+q.P/2;h=q.y+q.T}X{if(f.2P===87){x=q.x+q.P/2;m=q.y+q.T;w=q.x+q.P/2;h=q.y}X{I A=O c(q.x+q.P/2,q.y+q.T/2);I y=f.2P;I s;y=((y%8J)+8J)%8J;if(y>=0&&y<90){I B=N.3k.6c(A,q.7I()).a;s=y-B}X{if(y>=90&&y<2N){I B=N.3k.6c(A,q.5r()).a;s=y-B}X{if(y>=2N&&y<87){I B=N.3k.6c(A,q.7E()).a;s=y-B}X{I B=N.3k.6c(A,q.7s()).a;s=y-B}}}I t=S.2T(q.P*q.P/4+q.T*q.T/4);if(s!==0){t=t*S.4x(N.3k.8z(90-S.2B(s)))}I p=N.3k.8n(A,{a:y,r:t});I n=N.3k.8n(A,{a:y-2N,r:t});x=p.x;m=p.y;w=n.x;h=n.y}}}}I z=j.jc(x,m,w,h);if(f.4n){13(I v=0,u=f.4n.V;v<u;v++){z.5o(f.4n[v].aN,f.4n[v].1M)}}X{z.5o(0,f.2u);z.5o(1,f.2y)}K z}X{if(f.1y=="aE"){I x=(f.3e!=1p)?f.3e:q.1c().x;I m=(f.38!=1p)?f.38:q.1c().y;I w=(f.36!=1p)?f.36:q.1c().x;I h=(f.3f!=1p)?f.3f:q.1c().y;I k=(f.8s!=1p)?f.8s:0;I g=(f.8t!=1p)?f.8t:S.2j(q.P,q.T)/2;I z=j.j3(x,m,k,w,h,g);if(f.4n){13(I v=0,u=f.4n.V;v<u;v++){z.5o(f.4n[v].aN,f.4n[v].1M)}}X{z.5o(0,f.2u);z.5o(1,f.2y)}K z}X{K f}}}};e.j2=J(s,g,q){I x=s[g*3+0].x;I k=s[g*3+0].y;I w=s[g*3+1].x;I j=s[g*3+1].y;I v=s[g*3+2].x;I i=s[g*3+2].y;I u=s[g*3+3].x;I h=s[g*3+3].y;I f=q;I p=(1-f)*(1-f)*(1-f);I o=3*f*(1-f)*(1-f);I n=3*f*f*(1-f);I l=f*f*f;I m=p*x+o*w+n*v+l*u;I r=p*k+o*j+n*i+l*h;K O c(m,r)};e.j9=J(m,k,f){if(f==1p){f=0}I g=[];13(I h=f;h<m.V-3;h+=3){I o=m[h];I n=m[h+1];I l=m[h+2];I j=m[h+3];e.8D(g,k,o.x,o.y,n.x,n.y,l.x,l.y,j.x,j.y)}K g};e.8D=J(u,r,g,f,z,w,i,h,o,l){I v=1/r;13(I s=0;s<=1;s+=v){I p=S.1J(1-s,3);I m=3*S.1J(1-s,2)*s;I k=3*(1-s)*s*s;I j=s*s*s;I q=p*g+m*z+k*i+j*o;I n=p*f+m*w+k*h+j*l;u.Y(O c(q,n))}};e.aI=J(s,r,g,f,i,h,p,n){I m=1/r;13(I u=m;u<=1;u+=m){I l=(1-u)*(1-u);I k=2*(1-u)*u;I j=u*u;I q=l*g+k*i+j*p;I o=l*f+k*h+j*n;s.Y(O c(q,o))}};e.aj=J(s,r,j,h,l,m,f,g){if(!g){2W(f<m){f+=2*S.1z}}X{2W(f>m){f-=2*S.1z}}I n=(f-m)/r;I q=m;13(I k=0;k<=r;k++){I p=j+l*S.4Z(q);I o=h+l*S.4x(q);s.Y(O c(p,o));q+=n}};e.j8=J(){K{3c:[],1Y:J(){},1x:J(f,g){H.3c.Y(O c(f,g))},1u:J(f,g){H.7v();H.3c.Y(O c(f,g))},2K:J(h,g,j,i,f,l){H.7v();I k=H.8l();e.8D(H.3c,20,k.x,k.y,h,g,j,i,f,l)},4h:J(h,g,f,j){H.7v();I i=H.8l();e.aI(H.3c,20,i.x,i.y,h,g,f,j)},8F:J(g,k,f,i,h,j){e.aj(H.3c,20,g,k,f,i,h,j)},7v:J(){if(H.3c.V==0){H.3c.Y(O c(0,0))}},8l:J(){K H.3c[H.3c.V-1]},1C:{1t:J(g,f){H.34=N.W.1N.ag(f)}},jx:J(){if(H.1C.34){H.1C.34.7B(H.3c)}K H.3c}}};e.jD=J(s,q,t,n,r,u){I v=[];I k,p,o;I f=u>0;o=r+u;r=H.7O(r);o=H.7O(o);p=r;13(I m=0;m<4;m++){if(f){if(p>=o){18}k=S.1Q(p+S.1z/2,o)}X{if(p<=o){18}k=S.2j(p-S.1z/2,o)}I g=H.as(s,q,t,n,p,k);13(I l=0;l<g.V;l++){v.Y(g[l])}p+=S.1z/2*(f?1:-1)}K v};e.as=J(u,t,v,n,B,p){I g=v/2,f=n/2;I k=u+g,j=t+f;I A=S.4Z(B),r=S.4x(B);I o=S.4Z(p),l=S.4x(p);I q=4/3*(1-S.4Z((p-B)/2))/S.4x((p-B)/2);I z=[O c(A,r),O c(A-q*r,r+q*A),O c(o+q*l,l-q*o),O c(o,l)];13(I m=0;m<z.V;m++){z[m].x*=g;z[m].x+=k;z[m].y*=f;z[m].y+=j}K z};e.jq=J(f,g){I h=g/2;K O b(f.x-h,f.y-h,g,g)};e.jo=J(){I h=(39(2n)=="J")?2I[0]:H;13(I f=0;f<2I.V;f++){I g=O 8i("\\\\{"+f+"\\\\}","gi");h=h.3C(g,2I[f+1])}K h};e.jm=J(f){if(f!=19&&f!=""){K f.3C(/\\n/g,"\\\\n")}X{K f}};e.an=J(g,f,h){K O b(g.x+f,g.y+h,g.P,g.T)};e.8e=J(g,f){K e.an(g,f.x,f.y)};e.ju=J(f){K!9e(f-0)};e.jv=J(f){K!/^-?\\d+$/.8c(2n(f))};e.jr=J(f){if(+f===f){K(f===0)?f:(f>0)?1:-1}K js};e.jt=J(f){K N.W.4Y.7y(0.4,f,N.W.4Y.62)};e.cv=J(){I h=2I[0];13(I f=1;f<2I.V;f++){I g=O 8i("\\\\{"+(f-1)+"\\\\}","gi");h=h.3C(g,2I[f])}K h};e.jn=J(g){I f=e.cL(g);if(f){I h="jp";if(39 f.8N!=="1p"){h=("7x"+f.8N.3E(16)).3M(-2)}K"#"+h+("7x"+f.6V.3E(16)).3M(-2)+("7x"+f.7m.3E(16)).3M(-2)+("7x"+f.7K.3E(16)).3M(-2)}K"#jC"};e.cL=J(j){I i="^#{0,1}?[A-jB-f0-9]{3,6}$";I f=j;I k=e.cq(f);if(k){f=k}if(f.8E(i)){I h=e.cg(f);if(h){K h}}X{I l=27.7F("6O");l.7A.cO=f;I g=l.7A.cO;I h=e.cj(g);if(h){K h}}59 O 4Q("jF 1M jw: "+j)};e.cg=J(l){if(!l||l.V<3||l.V>7){K}l=l.3C("#","");I k,j,f;I i=2;if(l.V==3){l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]}I h=l.1U(l.V-i);f=8I(h,16);l=l.1U(0,l.V-i);i=l.V==1?1:2;h=l.1U(l.V-i);l=l.1U(0,l.V-i);j=8I(h,16);if(l.V==0){k=0}X{k=8I(l,16)}K{6V:k,7m:j,7K:f}};e.cj=J(j){if(j.V==0||j=="4a"){K 19}if(j.8E(/[0-9,\\s]+/g)==19){K 19}I h=j.8E(/[0-9,\\s]+/g)[0].1n(", ");if(h.V!=3&&h.V!=4){K 19}I l=+h[0];I k=+h[1];I f=+h[2];I i=(h.V==4)?+h[3]:1;if((l>=0&&l<=8O)&&(k>=0&&k<=8O)&&(f>=0&&f<=8O)&&(i>=0&&i<=1)){K{6V:l,7m:k,7K:f,8N:i}}K 19};e.jl=J(j,i,f,h){if(j!=1p&&i!=1p&&f!=1p){if(h==1p){h=1}K e.cv("6C({0},{1},{2},{3})",j,i,f,h)}K"6C(0,0,0,1)"};e.cq=J(i){I f=e.cs;I g=i.5U();13(I h in f){if(g==h){K f[h]}}K 19};e.cs={j1:"#j5",j4:"#jj",jb:"#cG",jd:"#jf",je:"#k8",k7:"#k9",kb:"#ka",4r:"#5m",k3:"#k2",7K:"#k6",k5:"#kh",kl:"#kk",kg:"#kf",k1:"#jN",jM:"#jO",jQ:"#jP",jI:"#jH",jK:"#jZ",jS:"#jT",jU:"#i4",hY:"#cG",hX:"#hZ",i0:"#ic",ig:"#ii",i8:"#ib",ia:"#hW",hI:"#hL",hK:"#hE",hG:"#hF",hS:"#hR",hV:"#hU",hN:"#hO",hP:"#ij",iN:"#iM",iO:"#iQ",iP:"#cy",iI:"#cy",iH:"#iX",iW:"#iY",iS:"#ik",iy:"#lC",lJ:"#lO",lP:"#lQ",lM:"#lr",ls:"#lt",lq:"#ln",lp:"#lz",lA:"#cI",lB:"#ly",lw:"#lx",lR:"#mb",ma:"#m7",9r:"#cJ",m8:"#cJ",7m:"#me",mk:"#mg",mf:"#mi",mh:"#lW",lV:"#lS",lU:"#m6",m3:"#m2",lX:"#kH",kI:"#kJ",kD:"#kE",kO:"#kL",kM:"#kn",kz:"#lb",l9:"#lf",lk:"#lj",lg:"#l1",kZ:"#cK",kU:"#cK",kT:"#kY",kW:"#la",ku:"#mc",m5:"#kG",kK:"#kR",kN:"#kt",kp:"#ct",kA:"#ct",ky:"#kv",kx:"#ll",l4:"#kS",l8:"#le",ld:"#kB",kq:"#cI",kQ:"#ml",mj:"#m9",ep:"#eo",er:"#en",ej:"#em",el:"#eA",ez:"#ew",et:"#es",ei:"#e5",e8:"#e7",eg:"#ed",ea:"#e9",ec:"#eb",f1:"#f3",f2:"#eY",eV:"#eU",eX:"#fa",f9:"#f8",f5:"#f4",cH:"#f7",f6:"#eH",eG:"#eJ",eC:"#eB",eE:"#eM",dZ:"#d4",d7:"#d6",d1:"#d0",d3:"#d2",dd:"#df",de:"#d8",db:"#da",cZ:"#cU",cX:"#cT",6V:"#cY",cV:"#dK",dJ:"#dN",dM:"#dF",dE:"#dG",dO:"#dV",dY:"#dQ",dR:"#dS",dm:"#dl",dg:"#dk",dq:"#dw",dA:"#dC",dB:"#ds",dr:"#dt",du:"#d5",fd:"#gL",gY:"#gX",h0:"#gZ",gW:"#gT",gV:"#gx",gz:"#gy",gs:"#gr",gt:"#gG",gI:"#hq",4e:"#hs",hr:"#ho",hl:"#hk",hn:"#hm"};e.3v={47:"hz+/=",hy:J(h){I f="";I p,n,l,o,m,k,j;I g=0;h=e.3v.cx(h);2W(g<h.V){p=h.45(g++);n=h.45(g++);l=h.45(g++);o=p>>2;m=((p&3)<<4)|(n>>4);k=((n&15)<<2)|(l>>6);j=l&63;if(9e(n)){k=j=64}X{if(9e(l)){j=64}}f=f+e.3v.47.35(o)+e.3v.47.35(m)+e.3v.47.35(k)+e.3v.47.35(j)}K f},hA:J(h){I f="";I p,n,l;I o,m,k,j;I g=0;h=h.3C(/[^A-hu-ht-9\\+\\/\\=]/g,"");2W(g<h.V){o=e.3v.47.1R(h.35(g++));m=e.3v.47.1R(h.35(g++));k=e.3v.47.1R(h.35(g++));j=e.3v.47.1R(h.35(g++));p=(o<<2)|(m>>4);n=((m&15)<<4)|(k>>2);l=((k&3)<<6)|j;f=f+2n.2V(p);if(k!=64){f=f+2n.2V(n)}if(j!=64){f=f+2n.2V(l)}}f=e.3v.cl(f);K f},cx:J(g){g=g.3C(/\\r\\n/g,"\\n");I f="";13(I i=0;i<g.V;i++){I h=g.45(i);if(h<5X){f+=2n.2V(h)}X{if((h>h9)&&(h<h6)){f+=2n.2V((h>>6)|h3);f+=2n.2V((h&63)|5X)}X{f+=2n.2V((h>>12)|cQ);f+=2n.2V(((h>>6)&63)|5X);f+=2n.2V((h&63)|5X)}}}K f},cl:J(f){I g="";I h=0;I j=c1=c2=0;2W(h<f.V){j=f.45(h);if(j<5X){g+=2n.2V(j);h++}X{if((j>h2)&&(j<cQ)){c2=f.45(h+1);g+=2n.2V(((j&31)<<6)|(c2&63));h+=2}X{c2=f.45(h+1);c3=f.45(h+2);g+=2n.2V(((j&15)<<12)|((c2&63)<<6)|(c3&63));h+=3}}}K g}};e.hj=J(f){I g=27.7F("6O");g.hi(27.hf(f));K g.95};e.hc=J(f){I h=27.7F("6O");h.95=f;I g=h.6S[0];K g?g.cF:""};N.1o(e,"N.29.3q")})(N.29);(J(b){I c=N.29.3q;I a=b.3l=J(f,e){H.9o=f;H.1y=e;H.1r="#5m";H.1W="4a";H.3R="#5m";H.4R="4a";H.3K="#5m";H.3A="cH";H.3O="#5m";H.4P="4a"};a.1e={26:J(f){f.1D();I e=H==H.9o.6p;if(H.2z){H.2z.1r=e?H.3K:H.1r;H.2z.1W=c.40(f,e?H.3A:H.1W,H.2z.2h());f.1D();f.cC=1;f.cB=1;f.cE=2;f.3o=H.9o.3o;H.2z.26(f);f.6J();f.1B()}if(H.2M){H.2M.1r=e?H.3O:H.3R;H.2M.1W=c.40(f,e?H.4P:H.4R,H.2M.2h());H.2M.26(f)}f.1B()},cw:J(e){if(H.1d.4s(e)){K H}K 19},4A:J(e){if(H.1d!=e){H.1d=e}},fF:J(e){if(H.2z!=e){H.2z=e}},fE:J(e){if(H.2M!=e){H.2M=e}}};N.1o(a,"N.2Y.3l")})(N.2Y);(J(a){I c=N.W.2b;I e=N.W.5c;I f=N.W.6u;I g=N.29.3q;I b=a.6A=J(h){1l.3B(b,H,[h]);H.3Q={};H.6s=[];H.2x=5;H.23=0;H.2q=cN;H.2X=10;H.3Y=1v;H.1K=2A;H.2m=10;H.3u=1v;H.3h=4;H.2x=2;H.2r=a.3N.7i;H.3h=2;H.22="#9j";H.41="#9j";H.2t="fB";H.3g="6C(77,83,94,1)";H.3i="6C(91,91,91,1)";H.3o="9r";H.3T="6C(77,83,94,1)";H.42=1v;H.7e()};b.1e={6z:J(){1l.4G(b,H,"6z");H.7w=27.9v(H.1O().id+"fM");I h=g.cz("6X",H.1O())[0];if(39 h.73!=="1p"){H.6X=h;H.1i=h.73("2d")}1l.5A(H.6F,{fL:1l.3L(H,H.co)});1l.5A(H.6F,{fJ:1l.3L(H,H.cp)});H.9J=1l.3L(H,H.cA);1l.5A(27,{cu:H.9J})},5w:J(){1l.5B(27,"cu",H.9J);1l.4G(b,H,"5w")},fI:J(j){I i=27.9v(j);if(i){I h=i.fk;if(h){h.7r("fj",1l.3L(H,1l.7b(H.9x,{id:j})))}}},9x:J(i,h){I j=27.9v(h.id);if(j){j.1H=H.6q()}},cM:J(){if(H.1O()){3H.fm(H.1O().id,H.7w)}},7e:J(){I j=1l.2h(H.1O());I i=j.P;I h=j.T;H.1d=O c(0,0,i,h);H.3j=i>h?a.2F.ch:a.2F.2R;H.1a=(H.3j==a.2F.2R)?H.1d.P:H.1d.T;H.2O=(H.3j==a.2F.2R)?H.1d.T:H.1d.P;H.28=(H.1a-2*H.2x)/2;H.1c=H.1a/2;H.17=H.2c=H.1a/5;H.1V=H.1a/10},2e:J(){I q=O a.3l(H,a.1S.cn);I x=O e();x.4F(H.1a/2,H.1a/2,(H.1a-H.2x*2)/2,0,2*S.1z,1m);q.2z=x;q.1r=H.3g;q.1W=H.22;I p=O a.3l(H,a.1S.7c);p.1d=O c(H.1c-H.28/4,H.1c-H.28,H.28/2,H.28);x=O e();x.4F(H.1a/2,H.1a/2,(H.1a-H.2x*2)/2,(5*S.1z)/4,(7*S.1z)/4,1m);x.1u(H.1c,H.1a/2);x.5G();p.2z=x;x=O e();x.1x(H.1c-H.1V,H.1V*3);x.1u(H.1c,H.1V*2);x.1u(H.1c+H.1V,H.1V*3);p.2M=x;I l=O a.3l(H,a.1S.76);l.1d=O c(H.1c-H.28,H.1c-H.28/4,H.28,H.28/2);x=O e();x.4F(H.1a/2,H.1a/2,(H.1a-H.2x*2)/2,(3*S.1z)/4,(5*S.1z)/4,1m);x.1u(H.1c,H.1a/2);x.5G();l.2z=x;x=O e();x.1x(H.1V*3,H.1c-H.1V);x.1u(H.1V*2,H.1c);x.1u(H.1V*3,H.1c+H.1V);l.2M=x;I h=O a.3l(H,a.1S.7l);h.1d=O c(H.1c-H.28/4,H.1c,H.28/2,H.28);x=O e();x.4F(H.1a/2,H.1a/2,(H.1a-H.2x*2)/2,S.1z/4,(3*S.1z)/4,1m);x.1u(H.1c,H.1a/2);x.5G();x.4h(H.1c,H.1a,H.17,H.1a-H.17);h.2z=x;x=O e();x.1x(H.1c-H.1V,H.1a-H.1V*3);x.1u(H.1c,H.1a-H.1V*2);x.1u(H.1c+H.1V,H.1a-H.1V*3);h.2M=x;I t=O a.3l(H,a.1S.7j);t.1d=O c(H.1c,H.1c-H.28/4,H.28,H.28/2);x=O e();x.4F(H.1a/2,H.1a/2,(H.1a-H.2x*2)/2,(7*S.1z)/4,S.1z/4,1m);x.1u(H.1c,H.1a/2);x.5G();t.2z=x;x=O e();x.1x(H.1a-H.1V*3,H.1c-H.1V);x.1u(H.1a-H.1V*2,H.1c);x.1u(H.1a-H.1V*3,H.1c+H.1V);t.2M=x;p.1r=p.3K=h.1r=h.3K=l.1r=l.3K=t.1r=t.3K="4a";p.3A={1y:"3X",2u:H.2t,2y:"4e",2P:87};t.3A={1y:"3X",2u:H.2t,2y:"4e",2P:0};l.3A={1y:"3X",2u:H.2t,2y:"4e",2P:2N};h.3A={1y:"3X",2u:H.2t,2y:"4e",2P:90};p.4R=p.4P=l.4R=l.4P=h.4R=h.4P=t.4R=t.4P="4a";p.3R=p.3O=l.3R=l.3O=h.3R=h.3O=t.3R=t.3O=H.3i;I w=O a.3l(H,a.1S.88);I j=O c(H.2O-H.1a-H.17,H.1c-H.17,H.17*2,H.17*2);if(H.3j==a.2F.2R){j=O c(H.1c-H.17,H.1a+H.17,H.17*2,H.17*2)}w.1d=j;x=O e();x.6v(j,H.3h);w.2z=x;x=O e();if(H.3j==a.2F.2R){x.1x(H.1c-H.2c/2,H.1a+H.2c*2);x.1u(H.1c+H.2c/2,H.1a+H.2c*2);x.1x(H.1c,H.1a+H.2c*2-H.2c/2);x.1u(H.1c,H.1a+H.2c*2+H.2c/2)}X{x.1x(H.2O-H.1a,H.1c+H.2c/2);x.1u(H.2O-H.1a,H.1c-H.2c/2);x.1x(H.2O-H.1a-H.2c/2,H.1c);x.1u(H.2O-H.1a+H.2c/2,H.1c)}w.2M=x;w.1r=w.3K=H.3g;w.1W=H.22;w.3R=w.3O=H.3i;w.3A={1y:"3X",2u:H.2t,2y:"4e",2P:30};I s=O a.3l(H,a.1S.85);j=O c(H.1a+H.17,H.1c-H.17,H.17*2,H.17*2);if(H.3j==a.2F.2R){j=O c(H.1c-H.17,H.2O-H.1a-H.17,H.17*2,H.17*2)}s.1d=j;x=O e();x.6v(j,H.3h);s.2z=x;x=O e();if(H.3j==a.2F.2R){x.1x(H.1c-H.2c/2,H.2O-H.1a);x.1u(H.1c+H.2c/2,H.2O-H.1a)}X{x.1x(H.1a+H.2c*2-H.2c/2,H.1c);x.1u(H.1a+H.2c*2+H.2c/2,H.1c)}s.2M=x;s.1r=s.3K=H.3g;s.1W=H.22;s.3R=s.3O=H.3i;s.3A={1y:"3X",2u:H.2t,2y:"4e",2P:30};I n=O a.3l(H,a.1S.8b);I v=S.6B((H.2q-H.23)/H.2X)+2;I r=H.2O-H.1a*2-H.17*4;I m=(r-H.17)/(v-2);j=O c(H.1a+H.17*3,H.1c-H.17,r,H.17*2);if(H.3j==a.2F.2R){j=O c(H.1c-H.17,H.1a+H.17*3,H.17*2,r)}n.1d=j;x=O e();if(H.3j==a.2F.2R){x.7T(H.1c-H.17/4,H.1a+H.17*3,H.17/2,r);if(H.2r==a.3N.7i||H.2r==a.3N.6r){13(I o=0;o<v-1;o++){x.1x(H.1c-H.17/2,H.1a+H.17*3+H.17/2+m*o);x.1u(H.1c-H.17,H.1a+H.17*3+H.17/2+m*o)}}if(H.2r==a.3N.7Y||H.2r==a.3N.6r){13(I o=0;o<v-1;o++){x.1x(H.1c+H.17/2,H.1a+H.17*3+H.17/2+m*o);x.1u(H.1c+H.17,H.1a+H.17*3+H.17/2+m*o)}}}X{x.7T(H.1a+H.17*3,H.1c-H.17/4,r,H.17/2);if(H.2r==a.3N.7i||H.2r==a.3N.6r){13(I o=0;o<v-1;o++){x.1x(H.1a+H.17*3+H.17/2+m*o,H.1c-H.17/2);x.1u(H.1a+H.17*3+H.17/2+m*o,H.1c-H.17)}}if(H.2r==a.3N.7Y||H.2r==a.3N.6r){13(I o=0;o<v-1;o++){x.1x(H.1a+H.17*3+H.17/2+m*o,H.1c+H.17/2);x.1u(H.1a+H.17*3+H.17/2+m*o,H.1c+H.17)}}}n.2M=x;n.1r=n.3K=n.3A="4a";n.4R=n.4P=H.22;n.3R=n.3O=H.3i;I k=O a.3l(H,a.1S.8r);k.1r=k.3K=H.3g;k.1W=H.22;k.3A={1y:"3X",2u:H.2t,2y:"4e",2P:30};I u;if(H.3u){I j=O c(H.2O-H.1a/2+H.17/2,H.1c,H.1a,H.1a);if(H.3j==a.2F.2R){j=O c(H.1c,H.2O-H.1a/2+H.17/2,H.1a,H.1a)}u=O f(H.1K+"%",j);u.2s=O N.W.6w("8Q-8P",10);u.3I=1X.3d;u.5O=1X.3d;u.1r=H.3T}H.3Q={2g:q,fe:p,fo:l,ge:h,gg:t,gf:w,gc:s,1E:n,8G:k};if(H.3u){H.3Q.cD=u}H.6s=[p,l,h,t,w,s,k,n]},1F:J(){if(!H.1i){K}H.6X.P=H.6X.P;H.1i.4b(H.1d.x,H.1d.y,H.1d.P,H.1d.T);H.1i.3s=H.41;H.1i.22();13(I h in H.3Q){if(H.3Q[h].26){H.3Q[h].26(H.1i)}}},4V:J(h){if(h>""){I i=1l.4V(h);H.6t=i.6t;H.2x=i.2x;H.23=i.23;H.2q=i.2q;H.2X=i.2X;H.2m=i.2m;H.3Y=i.3Y;H.3u=i.3u;H.2r=i.2r;H.3h=i.3h;H.22=i.22;H.41=i.41;H.2t=i.2t;H.3g=i.3g;H.3i=i.3i;H.3o=i.3o;H.3T=i.3T;H.2e();H.4m(i.1K,1v,1m);H.cr(i.42);H.cm(i.5t);I j=H;ck(J(){K j.ci()},2A)}},ci:J(){I h=1l.61(H.6t);if(h){H.1w=h;if(h.7r){h.7r("7u",1l.3L(H,H.8q))}H.1F()}},6q:J(){I h={id:H.1O().id,6t:H.6t,2x:H.2x,23:H.23,2q:H.2q,1K:H.1K,2X:H.2X,2m:H.2m,3Y:H.3Y,3u:H.3u,2r:H.2r,3h:H.3h,22:H.22,41:H.41,2t:H.2t,3g:H.3g,3i:H.3i,3o:H.3o,3T:H.3T,42:H.42,5t:H.5t};K 1l.6q(h)},gh:J(h){H.2e();H.4m(H.1K,1v,1m);H.1w=h;if(h){h.7r("7u",1l.3L(H,H.8q))}H.1F()},8q:J(){H.4m(H.1w.1K,1v,1m)},co:J(i){if(!H.42){K}H.5a=g.7D(i,H.1O());I h=H.82(H.5a);if(h){H.cP(i,h)}H.6p=h;H.1F()},cp:J(h){if(!H.42){K}if(H.5a){if(H.6p){if(H.6p.1y==a.1S.8r){H.89(h)}}}},cA:J(i){if(!H.42){K}I j=g.7D(i,H.1O());g5(H.6y);if(H.5a!=19){if(j.3t(H.5a)<2){I h=H.82(H.5a);if(h){H.cR(i,h)}}}H.5a=19;H.6p=19;H.1F()},89:J(l){I n=g.7D(l,H.1O());I i=H.1a+H.17*3;I m=H.2O-H.1a*2-H.17*5;I h=n;h.x-=H.17/2;h.y-=H.17/2;if(H.3j==a.2F.2R){I o=S.1Q(m,S.2j(h.y-i,0));I j=o/m;I k=S.6B((H.2q-H.23)-(H.2q-H.23)*j)}X{I o=S.1Q(m,S.2j(h.x-i,0));I j=o/m;I k=S.6B((H.2q-H.23)*j)}H.4m(H.23+k,1v)},82:J(k){if(!H.6s){K 1m}13(I j=0;j<H.6s.V;j++){I h=H.6s[j];if(h.cw(k)){K h}}K 19},4m:J(k,i,j){if(!i){H.1K=k}X{if(H.3Y&&k>H.23&&k<H.2q){I h=H.23+(S.6B((k-H.23)/H.2X)*H.2X);H.1K=S.1Q(H.2q,S.2j(H.23,h))}X{H.1K=S.1Q(H.2q,S.2j(H.23,k))}}H.2k();H.1F();if(j!=1m){if(H.1w!=19){H.1w.gp(H.1K)}}},2k:J(){I l=H.2O-H.1a*2-H.17*5;I j=(H.1K-H.23)/(H.2q-H.23);I h=(l*j)+H.17/2;I i=O c(H.1a+H.17*2+H.17/2+h,H.1c-H.17,H.17,H.17*2);if(H.3j==a.2F.2R){h=l-(l*j)+H.17/2;i=O c(H.1c-H.17,H.1a+H.17*2+H.17/2+h,H.17*2,H.17)}H.3Q.8G.4A(i);I k=O e();k.6v(i,H.3h);H.3Q.8G.2z=k;if(H.3u){H.3Q.cD.1P=H.1K+"%"}H.1F()},cP:J(i,h){if(!H.1w){K}2i=H;3F(h.1y){1b a.1S.76:H.6y=7k(J(){2i.1w.4u(2i.1w.3y()-2i.2m,2i.1w.4g())},2A);18;1b a.1S.7c:H.6y=7k(J(){2i.1w.4u(2i.1w.3y(),2i.1w.4g()-2i.2m)},2A);18;1b a.1S.7j:H.6y=7k(J(){2i.1w.4u(2i.1w.3y()+2i.2m,2i.1w.4g())},2A);18;1b a.1S.7l:H.6y=7k(J(){2i.1w.4u(2i.1w.3y(),2i.1w.4g()+2i.2m)},2A);18}},cR:J(i,h){3F(h.1y){1b a.1S.88:H.4m(H.1K+H.2X,1v);18;1b a.1S.85:H.4m(H.1K-H.2X,1v);18;1b a.1S.8b:H.89(i);18;1b a.1S.76:if(H.1w){H.1w.4u(H.1w.3y()-H.2m,H.1w.4g())}18;1b a.1S.7c:if(H.1w){H.1w.4u(H.1w.3y(),H.1w.4g()-H.2m)}18;1b a.1S.7j:if(H.1w){H.1w.4u(H.1w.3y()+H.2m,H.1w.4g())}18;1b a.1S.7l:if(H.1w){H.1w.4u(H.1w.3y(),H.1w.4g()+H.2m)}18}if(H.7w){H.9x(H,H.7w.id);if(H.5t){H.cM()}}},cr:J(h){H.42=h},hv:J(){K H.42},jz:J(){K H.5t},cm:J(h){H.5t=h},al:J(h){if(H.1K!==h){H.4m(h)}},ad:J(){K H.1K},jE:J(h){if(H.23!==h){H.23=h;H.2e();H.2k();H.1F()}},jy:J(){K H.23},jA:J(h){if(H.2q!==h){H.2q=h;H.2e();H.2k();H.1F()}},j7:J(){K H.2q},j6:J(h){if(H.2X!==h){H.2X=h;H.2e();H.2k();H.1F()}},ja:J(){K H.2X},jh:J(h){if(H.2m!==h){H.2m=h;H.2e();H.2k();H.1F()}},jg:J(){K H.2m},ji:J(h){if(H.41!==h){H.41=h;H.1F()}},jk:J(){K H.41},jG:J(h){if(H.22!==h){H.22=h;H.2e();H.2k();H.1F()}},ki:J(){K H.22},kj:J(h){if(H.2t!==h){H.2t=h;H.2e();H.2k();H.1F()}},kc:J(){K H.2t},ke:J(h){if(H.3g!==h){H.3g=h;H.2e();H.2k();H.1F()}},jW:J(){K H.3g},ih:J(h){if(H.3i!==h){H.3i=h;H.2e();H.2k();H.1F()}},hJ:J(){K H.3i},hQ:J(h){if(H.3o!==h){H.3o=h;H.2e();H.2k();H.1F()}},iK:J(){K H.3o},lF:J(h){if(H.3T!==h){H.3T=h;H.2e();H.2k();H.1F()}},lD:J(){K H.3T},lu:J(h){if(H.3u!==h){H.3u=h;H.2e();H.2k();H.1F()}},lv:J(){K H.3u},md:J(h){if(H.2r!==h){H.2r=h;H.2e();H.2k();H.1F()}},lT:J(){K H.2r},lZ:J(h){if(H.3Y!==h){H.3Y=h;H.2e();H.2k();H.1F()}},m4:J(){K H.3Y},kw:J(h){if(H.2x!==h){H.2x=h;H.2e();H.2k();H.1F()}},lm:J(){K H.2x},kC:J(h){if(H.3h!==h){H.3h=h;H.2e();H.2k();H.1F()}},m1:J(){K H.3h}};N.2Y.6A.70=J(h){K 1l.9H(N.2Y.6A,19,19,19,h)};N.2Y.6A.9a=J(h,i){K 1l.61(h,i)};N.1o(b,"N.2Y.6A","4C")})(N.2Y);',62,1386,"|||||||||||||||||||||||||||||||||||||||||||this|var|function|return|||MindFusion|new|width|||Math|height||length|Drawing|else|push|||||for|elements|||spacing|break|null|minDim|case|center|bounds|prototype|builder|right|bottom|context|left|top|mflayer|false|split|registerClass|undefined|strokeThickness|pen|Point|apply|lineTo|true|target|moveTo|type|PI|shadow|restore|transform|save|scale|repaint|_mf_scale|value|Collections|pow|zoomFactor|stroke|color|Matrix|get_element|text|min|indexOf|ButtonType|Vector|substring|decorationSize|brush|Alignment|beginPath|clone||lineWidth|fill|minZoomFactor|Number||draw|document|radius|Diagramming|strokeStyle|Rect|buttonSize||createControls|MAX_VALUE|scroller|getBounds|thisObj|max|updateControls|table|scrollStep|String|forEach|size|maxZoomFactor|tickPosition|font|activeColor|color1|empty|drawImage|padding|color2|shape|100|abs|data|scrollTop|EventArgs|Orientation|clipPath|expandRect|arguments|ImageAlign|bezierCurveTo|114|decoration|180|maxDim|angle|scrollLeft|Vertical|rotationAngle|sqrt|Builder|fromCharCode|while|zoomStep|Controls|add||||registerNamespace|matrix|charAt|x2|clip|y1|typeof|lineHeight|__typeName|points|Center|x1|y2|borderColor|cornerRadius|innerColor|orientation|Geometry|Button|eventHandlers|remove|shadowColor|contains|Utils|content|fillStyle|distance|showLabel|Base64|Sys|get|getScrollX|constructor|hotBrush|initializeBase|replace|splice|toString|switch|translate|window|textAlignment|cachedZOrder|hotPen|createDelegate|slice|TickPosition|hotDecorationPen|Gradient|controls|decorationPen|multiplyScalar|textColor|set|measureText|getType|LinearGradientBrush|snapToZoomStep|typeName|getBrush|backColor|enabled|addToContext||charCodeAt||_keyStr|call||transparent|rect|111|instanceof|white|drawShadow|getScrollY|quadraticCurveTo|instance|DashStyle|setLineDash|CancelEventArgs|setZoomFactorInternal|colorStops|sub|columns|ym|black|containsPoint|splinePoints|setScroll|116|positionY|sin|105|Size|setBounds|positionX|Control|head|fromLTRB|arcTo|callBaseMethod|minY|Assigned|rows|xm|strokeDashStyle|minX|Far|advance|hotDecorationBrush|Error|decorationBrush|bold|rotateAt|MindFusionImpl|fromJson|italic|__baseType|GraphicsUnit|cos|||||||textAlign|colors|interfaceTypes|throw|mouseDownPoint|Function|Path|__registeredTypes|body|102|JSON|resize|101|118|gridSizeY|parentNode|000000|measureUnit|addColorStop|raiseEvent|drawDashLine|topLeft|gridSizeX|autoPostBack|key|fromPoints|dispose|maxX|maxY|margin|addHandlers|removeHandler|Value|parse|continue|ArrayList|close|funcName|propName|prop2Name|format|lines|image|Near|lineAlignment|remaining|Image|repaintId|DistanceToSegment|updateScale|toLowerCase|all|_mf_transform|128|underline|count|drawUnderline|findControl|Millimeter||||||isInstanceOfType||ignoreTransform|betweenOrEqualSorted|cartesianToPolarDegrees|ox|distanceSq|transformPoint|toUpperCase|updatePathDefinition|ccw|lineJoin|name|0001|gridOffsetX|gridOffsetY|oy|currentManipulator|toJson|Both|manipulators|targetId|Text|addRoundRect|Font|buckets|timer|initialize|ZoomControl|round|rgba|tail|Array|_element|baseType|prms|drawCallback|closePath|pivot|getPageScroll|symmetricPoint|MsAjaxImpl|div|xe|sort|zIndex|childNodes|addVector|transformRect|red|innerScroller|canvas|getEvent|keys|create|filter||getContext||toFixed|ScrollLeft|||Object|Thickness|createCallback|ScrollUp|Dom|init|bucket|ye|AbstractionLayer|Left|ScrollRight|setInterval|ScrollDown|green|x4|HashTable|x3|y3|addEventListener|bottomRight|Type|zoomChanged|ensureStart|postDataField|00|convert|next|style|transformPoints|addHandler|getCursorPos|bottomLeft|createElement|invalidate|registerDisposableObject|topRight|item|blue|getHandler|y4|fillText|radians|prototypeClass|strokeText|middle|eventHandlerList|addRect|coord1|clearHandlers|collectSequences|parser|Right|cachedSequences||string|hitTestManipulators|||ZoomOut||270|ZoomIn|onSliderMove|tagName|ZoomScale|test|parseType|offset|textBaseline|rotationTransform|fitInBounds|RegExp|floor|getLines|lastPoint|toPoint|polarToCartesianDegrees|dot|json|onZoomChanged|ZoomSlider|radius1|radius2|getIntersectionPoint|intersect|equals|inheritsFrom|proxy|degreeToRadian|not|distanceToSegmentSquared|inflate|addCubicBezierPoints|match|arc|slider|equalEpsilon|parseInt|360|scriptOffset|applyFormat|00001|alpha|255|serif|sans|setTransform|distToRectSelect|getStyledLines|parseStyledText|loaded|anticlockwise|Dictionary|getPixel|Pixel|||scrollbarSize|ItemEventArgs||innerHTML|||||find|clientToDoc|endAngle|startAngle|isNaN|unitsPerInch|px|copy|108|FFFFFF|getZOrder|indexInBucket|115|Empty|parent|getScrollbarSize|110|gray|updateCanvasSize|gridStyle|PathParser|getElementById|polarToCartesian|preparePostback|any|GridStyle|forReverse|itemAdded|bezierTo|cartesianToPolar|roundRect|fromThreePoints|Set|createControl|fromTwoPoints|mouseUpDelegate|Queue|invalidParent|isAssignment|EventHandlerList|clientX|clientY|unbind|repaintDelegate|distToRectPoint|getLeftVector|getMillimeter|updateContainersZOrder|showGrid|closer|pageXOffset|drawGrid|betweenOrEqual|setLocation|DistanceSq|swap|chrome|userAgent|objectIdCounter|getBoundingClientRect|_item|pageYOffset|navigator|documentElement|Circle|getZoomFactor|Serialization|JavaScriptSerializer|fromValues|Bezier|Border3D|addArcPoints|Arc|setZoomFactor|Utilities|offset1|atan2|getCount|ObservableCollection|radianToDegree|arcSegmentToBezier|Application|UI|getEffectiveBackBrush|getBackgroundImage|drawMagnifier|drawBackground|getBackgroundImageSize|invisible|getTopLevel|getBackgroundImageAlign|drawShadows|RadialGradientBrush|shadowsStyle|ShadowsStyle|updateLabelLayout|addQuadraticBezierPoints|eval|laneGrid|drawForeground|showLaneGrid|position|createSequence|svg|sup|removeFromFormat|addToFormat|rotate|forEachKey|Line|applyDiagramTransform|cachedText|coord2|generate|Inch|Document|clear|Display|WpfPoint|Centimeter|fitInLine|fitInLineWrapByChar|findWhitespace|commands|getCornerPoints|drawPath|getSize|offsetY|offsetX|MIN_VALUE|boundingRect|delete|diagram|angleBetween|Shadow|drawLines|setPen|path|drawStyledText|done|isGetSetter||updatePosition|baseline|enableStyledText|applyTo|MiddleRight|MiddleLeft|Fit|Tile|Stretch|TopRight|BottomLeft|BottomRight|BottomCenter|TopCenter|union|getSegmentIntersection|CatmullRomToBezier|Canvas|_mf_autoId|objectId|css|normalizeRect|CardinalSpline|parseFloat|hashString|TopLeft|wrapLine|wrapText|checkImplementation|JQuery|JQueryImpl|_cancel|112|measureStyledText|Ellipse||||Grid|error|application|default|POST|ajaxRequest|scroll|distanceToLineSquared|hashCode|Container|charset|utf|hexToRgb|Horizontal|prepare|stringToRgb|setTimeout|_utf8_decode|setAutoPostBack|None|onMouseDown|onMouseMove|checkKnownColor|setEnabled|knownColors|778899|mouseup|formatString|hitTest|_utf8_encode|2f4f4f|getChildrenByTagName|onMouseUp|shadowOffsetY|shadowOffsetX|label|shadowBlur|nodeValue|00ffff|orange|ff00ff|808080|d3d3d3|parseColor|postback|200|backgroundColor|onButtonMouseDown|224|onButtonClick|unshift|800080|b0e0e6|rosybrown|updateCanvasElements|purple|ff0000|powderblue|ffefd5|papayawhip|ffdab9|peachpuff|afeeee|00ff7f|d87093|palevioletred|ffc0cb|distanceToSegment|dda0dd|plum|5522848|peru|pink|cd853f|silver|scrollWidth|scrollElement|sizeElement|c0c0c0|a0522d|sienna|clientHeight|clientWidth|scrollHeight|skyblue|snow|708090|fffafa|springgreen|invalidateZOrder|87ceeb|||sizeChanged|slateblue|slategray|6a5acd|getGridPointSize|salmon|8b4513|fa8072|Crosses|gridPointSize|royalblue|bc8f8f|onLoad|saddlebrown|4169e1|sandybrown|offsetWidth|2e8b57|seashell|fff5ee|gridColor|Lines|f4a460|Points|offsetHeight|seagreen|paleturquoise|Custom|isIdentity|DashDot|DashDotDot|scaleAtCenter|48d1cc|invert|c71585|mediumvioletred|f5fffa|mintcream|ffe4e1|mistyrose|191970|Dash|Dot|midnightblue|Solid|mediumturquoise|mediumpurple|setBrush|mediumseagreen|9370d8|ba55d3|0000cd|mediumblue|setText|mediumorchid|00fa9a|mediumspringgreen|shapeImpl|miter|7b68ee|join|addEllipse|mediumslateblue|3cb371|eee8aa|palegoldenrod|tm3|palegreen|tm4|orchid|ff4500|tm5|da70d6|FontStyle|Regular|98fb98|defaultFont|Bold|tm|tm2|Italic|Underline|tm6|000080|navy|300|oldlace|ffdead|src||moccasin|navajowhite|ffe4b5|6b8e23|olivedrab|orangered|ffa500|808000|olive|fdf5e6|World|Percent|steelblue|upButton|get_cancel|member|MsAjax|set_cancel|submit|form|setInstance|__doPostBack||leftButton|Abstract|alert|Ajax|layer|implement|interface|implementation|does|deleteRow|insertRow|deleteColumn|insertColumn|skyBlue|number|object|setDecoration|setShape|insert|removeAt|registerForSubmit|mousemove|addRange|mousedown|_PostData|Cannot|forEachValue|success|onreadystatechange|readyState|serialize|XMLHttpRequest|status|setRequestHeader|Content|responseText|open|err|Component|try|catch|findComponent|deserialize|clearInterval|_events|DomElement|url|contentType|stringify|ajax|zoomOutButton|dataType|downButton|zoomInButton|rightButton|setTarget||children|send|unload|bind|borderTopWidth|borderLeftWidth|setZoomLevel|jquery|ee82ee|violet|violetred|OneLevel|drawLast|clearTimeout|ff6347|40e0d0|turquoise|getMeasureUnit|setScrollX|297|setMeasureUnit|setScrollY|ZOrder|d02090|drawFirst|wheat|clientToDocOverflow|docToClient|4682b4|clientToDocLength|docToClientOverflow|addElement|removeElement|measureString|getRectIntersection|backBrush|d8bfd8|clearRect|tomato|thistle|d2b48c|tan|008080|teal|210|191|192|enqueue|dequeue|2048|atan|rotatePoint|127|mapTo|get_item|unescapeHtml|Key|supported|createTextNode|add_itemAdded|remove_itemAdded|appendChild|escapeHtml|ffff00|yellow|9acd32|yellowgreen|f5f5f5|darkGray|f5deb3|whitesmoke|ffffff|z0|Za|getEnabled|getEllipseIntr|acos|encode|ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|decode|addToRect|pointInPolygon|getPolygonIntersection|8b008b|556b2f|darkolivegreen|getClosestSegmentPoint|darkkhaki|getInnerColor|darkmagenta|bdb76b|unionRects|darkred|8b0000|darksalmon|setShadowColor|ff8c00|darkorange|distToPolyline|9932cc|darkorchid|006400|darkblue|cyan|00008b|darkcyan|mid|rectPtFromPercent|setRect|dc143c|subtract|offsetPointCollection|minDistToRect|darkgray|checkIntersect|darkgreen|a9a9a9|008b8b||pointEqualEpsilon||darkgoldenrod|setInnerColor|b8860b|e9967a|ff1493|Wait|VerticalResize||DiagonalResize|nw|Progress|progress||help|wait|Help|Pointer|pointer|deepskyblue|crosshair|Default|CounterDiagonalResize|ne|HorizontalResize|Move|move|Inherit|darkturquoise|darkslategrey|getImageRect|getShadowColor|getRectPtPercent|8fbc8f|darkseagreen|darkslateblue|darkslategray|483d8b|NotAllowed|deeppink|Nothing|inherit|Rotate|darkviolet|00ced1|9400d3|allowed|Pan|aliceblue|getBezierPt|createRadialGradient|antiquewhite|f0f8ff|setZoomStep|getMaxZoomFactor|getApproximatingContext|approximateBezier|getZoomStep|aqua|createLinearGradient|aquamarine|azure|7fffd4|getScrollStep|setScrollStep|setBackColor|faebd7|getBackColor|rgbToString|escapeNewLine|colorStringToHex|stringFormat|FF|newRect|sign|NaN|getFitTextStep|isNumber|isFloat|code|transformAndGetPoints|getMinZoomFactor|getAutoPostBack|setMaxZoomFactor|Fa|FFFFFFFF|arcToBezierCurves|setMinZoomFactor|Unknown|setFill|ff7f50|coral|rotateRect|cornflowerblue|getCenter|chartreuse|5f9ea0|7fff00|d2691e|chocolate|getLineHitTest|cornsilk|fff8dc|crimson|pointInRect|getBorderColor|rotatePointsAt|rotatePointAt|6495ed|degrees|cadetblue|ffebcd|blanchedalmond|SolidBrush|blueviolet|0000ff|beige|f0ffff|f5f5dc|ffe4c4|bisque|getActiveColor|getClientPos|setBorderColor|deb887|burlywood|8a2be2|getFill|setActiveColor|a52a2a|brown|Crosshair|fffacd|setCenter|lightslategray|magenta|sameSize|getSizeRect|8470ff|lightsalmon|b0c4de|setPadding|lightyellow|lightsteelblue|lightblue|lightslategrey|faf0e6|setCornerRadius|lavenderblush|fff0f5|getAttribute|20b2aa|f0e68c|lavender|e6e6fa|lightskyblue|7cfc00|lemonchiffon|lightslateblue|lawngreen|nodeName|maroon|87cefa|00ff00|lightgreen|lightgrey|fromVertex|lightpink|fromPositionAndSize|90ee90|lightgray|intersectsWith|fafad2|getRotatedBounds|topMiddle|lime|isEmpty|intersectsInc|fromCenterAndSize|limegreen|lightcoral|ffb6c1|add8e6|clipToBounds|linen|32cd32|f08080|lightgoldenrodyellow|newWithOffset|fromArgs|e0ffff|lightcyan|ffffe0|getPadding|fffaf0|getMinWidth|forestgreen|floralwhite|d19275|firebrick|b22222|setShowLabel|getShowLabel|ghostwhite|f8f8ff|dcdcdc|228b22|fuchsia|gainsboro|00bfff|getTextColor|divideScalar|setTextColor|auto|Auto|MouseCursors|dimgray|negate|lengthSquared|feldspar|normalize|696969|dodgerblue|1e90ff|gold|cd5c5c|getTickPosition|indigo|indianred|ff69b4|khaki|search|setSnapToZoomStep|pop|getCornerRadius|fffff0|ivory|getSnapToZoomStep|lightseagreen|4b0082|daa520|grey|66cdaa|goldenrod|ffd700|ffa07a|setTickPosition|008000|honeydew|adff2f|hotpink|f0fff0|mediumaquamarine|greenyellow|800000".split("|"),0,{})),
define("MindFusion_Common",["jqueryk3cloudex"],function(e){return function(){var t;return t||e.MindFusion_Common}}(this)),eval(function(e,t,i,a,n,o){if(n=function(e){return(t>e?"":n(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;i--;)o[n(i)]=a[i]||n(i);a=[function(e){return o[e]}],n=function(){return"\\w+"},i=1}for(;i--;)a[i]&&(e=e.replace(new RegExp("\\b"+n(i)+"\\b","g"),a[i]));return e}('1e.Ap("1e.3N");if(5G $iu=="1v"){$iu={}}(1c(d){1b b=1e.2T.5i;1b f=1e.2T.8u;1b e=1e.2T.dZ;1b c=d.Pd=1c(){1a.co=10;1a.3X=10;1a.eo=1u;1a.4z=d.4s.ed;1a.c4=d.cQ.9j;1a.6P=d.gS.lj;1a.8h=1u;1a.9X=d.gg.7U};c.1n.kq=1m;c.1n.hR=1m;c.1n.ji=1m;c.1n.ie=1u;c.1n.7M=10;c.1n.mf=1c(){1d 1a.c4==d.cQ.a5};c.1n.fr=1c(){1d 1a.eo};c.1n.c5=1c(C){1b A;C.2q.1B(1c(j){if(j.6l.1f==0){A=j;1d $1Q}});if(!A){1d $iu}1a.7m=C.7m(A);if(!1a.7m){1d $iu}1b k=A.x+A.1q/2;1b h=A.y+A.1p/2;1a.x=0;1a.y=0;1a.Ep(A);1b z=1g b();1k(1b t=0;t<1a.7m.9U.1f;t++){1b u=1a.7m.9U[t];1b w=0;1k(1b s=0;s<u.1f;s++){if(1a.6C()){w=1s.1U(w,u[s].1q)}1l{w=1s.1U(w,u[s].1p)}}z.1h(w)}1b n=0;1b D=0;1k(1b p=1;p<z.1f;p++){D+=z[p];D+=1a.co}D+=1a.7M;if(!1a.kR()){n=D}1k(1b t=0;t<1a.7m.9U.1f;t++){1b u=1a.7m.9U[t];1k(1b s=0;s<u.1f;s++){1b o=u[s];if(1a.6C()){o.x+=n}1l{o.y+=n}}if(1a.kR()){n+=1a.co+z[t]}1l{n+=-(1a.co+z[t])}}if(1a.eo){1b r=A.x;1b q=A.y;1b B=k-r;1b v=h-q;1a.8m(A,B,v)}if(1a.c4!=d.cQ.9j){56(1a.c4){1T d.cQ.ds:56(1a.4z){1T d.4s.ed:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x+j.1E.1q/2,y:j.1E.y},{x:j.1x.x,y:j.1x.y-j.1x.1p/2}]});1Q;1T d.4s.jh:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x+j.1E.1q/2,y:j.1E.y},{x:j.1x.x,y:j.1x.y+j.1x.1p/2}]});1Q;1T d.4s.fH:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x,y:j.1E.y+j.1E.1p/2},{x:j.1x.x-j.1x.1q/2,y:j.1x.y}]});1Q;1T d.4s.fq:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x,y:j.1E.y+j.1E.1p/2},{x:j.1x.x+j.1x.1q/2,y:j.1x.y}]});1Q}1Q;1T d.cQ.a5:56(1a.4z){1T d.4s.ed:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x+j.1E.1q/2,y:j.1E.y},{x:j.1x.x,y:j.1E.y},{x:j.1x.x,y:j.1x.y-j.1x.1p/2}]});1Q;1T d.4s.jh:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x+j.1E.1q/2,y:j.1E.y},{x:j.1x.x,y:j.1E.y},{x:j.1x.x,y:j.1x.y+j.1x.1p/2}]});1Q;1T d.4s.fH:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x,y:j.1E.y+j.1E.1p/2},{x:j.1E.x,y:j.1x.y},{x:j.1x.x-j.1x.1q/2,y:j.1x.y}]});1Q;1T d.4s.fq:1a.7m.2g.1B(1c(j){j.1r=[{x:j.1E.x,y:j.1E.y+j.1E.1p/2},{x:j.1E.x,y:j.1x.y},{x:j.1x.x+j.1x.1q/2,y:j.1x.y}]});1Q}1Q}}};c.1n.Ep=1c(k){1b n=1g 1e.1z.2O.cK(k);n.x=1a.x;n.y=1a.y;if(1a.4z==d.4s.fq){1b l=1e.1z.2O.cK(1a.7m.dB);1b j=n.1q;n=1g 2O(l.2y()-j,n.3Z(),n.1q,n.1p)}1l{if(1a.4z==d.4s.jh){1b l=1e.1z.2O.cK(1a.7m.dB);1b j=n.1p;n=1g 2O(n.3M(),l.2V()-j,n.1q,n.1p)}}k.x=n.x+n.1q/2;k.y=n.y+n.1p/2;if(1a.6C()){1a.y+=n.1p+1a.3X}1l{1a.x+=n.1q+1a.3X}1b h=1a;g(k).1B(1c(o){h.Ep(o)})};c.1n.8m=1c(k,h,l){1b j=1c(n,o){n.x+=o[0];n.y+=o[1]};a(k,j,[h,l])};c.1n.6C=1c(){1d 1a.4z==d.4s.fH||1a.4z==d.4s.fq};c.1n.kR=1c(){1d 1a.4z==d.4s.fH||1a.4z==d.4s.ed};1c g(j){1b h=1g b();j.3S.1B(1c(k){h.1h(k.1x)});1d h}1c a(k,j,l){j.Mp(1a,k,l);1b h=g(k);h.1B(1c(n){a(n,j,l)})}c.bi=1c(){if(!eX){eX=1g 1e.5b(c.1n)}1l{eX.5c(1j)}1d eX};c.1n.8v=1c(){if(!eX){eX=1g 1e.5b(c.1n,1j,1a)}1l{eX.5c(1a)}1d eX};c.1n.aA=1c(){1d 1a.4L.8s};eX=1j;c.1n.Mo=1c(){1d 1a.co};c.1n.Mn=1c(h){1a.co=h};c.1n.rO=1c(){1d 1a.3X};c.1n.rD=1c(h){1a.3X=h};c.1n.Lt=1c(){1d 1a.eo};c.1n.Lr=1c(h){1a.eo=h};c.1n.yG=1c(){1d 1a.4z};c.1n.yI=1c(h){1a.4z=h};c.1n.Lx=1c(){1d 1a.c4};c.1n.Li=1c(h){1a.c4=h};c.1n.mE=1c(){1d 1a.6P};c.1n.mD=1c(h){1a.6P=h};c.1n.mv=1c(){1d 1a.8h};c.1n.mu=1c(h){1a.8h=h};c.1n.s5=1c(){1d 1a.9X};c.1n.rT=1c(h){1a.9X=h};1e.1Z(c,"1e.3N.Pd")})(1e.3N);(1c(b){1b a=b.r5=1c(d,c){1a.1E=d;1a.1x=c};a.1n.7z=1c(c){1d 1a.1E==c?1a.1x:1a.1E};a.1n.RC=1c(c){if(1a.1E==c.1E||1a.1E==c.1x){1d 1a.1E}if(1a.1x==c.1E||1a.1x==c.1x){1d 1a.1x}1d 1j};a.1n.Rw=1c(d,c){if(1a.1E==d&&1a.1x==c||1a.1E==c&&1a.1x==d){1d 1m}1d 1u};a.1n.vO=1c(){1d[1a.1E,1a.1x]};a.1n.N3=1c(c){1d 1a.1E==c||1a.1x==c};a.1n.MZ=1c(c){1d 1a.1E.2g.2c(c)||1a.1x.2g.2c(c)};a.1n.n5=1c(c){1a.1E.2g.3l(1a);1a.1E.3S.3l(1a);c.2g.1h(1a);c.3S.1h(1a);1a.1E=c};a.1n.Pf=1c(c){1a.1x.2g.3l(1a);1a.1x.6l.3l(1a);c.2g.1h(1a);c.6l.1h(1a);1a.1x=c};a.1n.l7=1c(d,c){if(1a.1E==d){1a.n5(c)}1l{if(1a.1x==d){1a.Pf(c)}}};a.1n.bh=1c(){1b c=1a.1E;1b d=1a.1x;1a.1E=d;c.3S.3l(1a);1a.1E.3S.1h(1a);1a.1x=c;d.6l.3l(1a);1a.1x.6l.1h(1a)};a.1n.Rv=1c(c){if(1a.1x!=c){1a.bh()}};a.1n.Rx=1c(){1b c=1g a(1x,1E,1a);c.RE=1m;1d c};1e.1Z(a,"1e.3N.r5")})(1e.3N);1e.3N.yJ={8n:1,d6:2};1e.3N.Oy={Ox:1,8n:2,d6:3};1e.3N.gS={lj:0,OI:1,OH:2};1e.3N.4s={ed:0,fH:1,jh:2,fq:3};1e.3N.cQ={9j:0,ds:1,a5:2};1e.3N.gg={vc:0,7U:1};1e.3N.bd=1e.3N.gg;(1c(c){1b d=1e.2T.8u;1b a=1e.2T.5i;1b e=c.OG=1c(){1a.6P=c.gS.lj;1a.8h=1u;1a.dB=1j;1a.9X=c.gg.7U};e.1n.kq=1u;e.1n.hR=1u;e.1n.ji=1m;e.1n.ie=1m;e.1n.7M=10;e.1n.c5=1c(h){1b f=1a.dB&&1a.dB.e0&&h.2q.2c(1a.dB.e0)?1a.dB.e0:h.2q[0];f.pD=1m;1a.qI=1g d();1a.yk(f);1b g=1a.qI.1G(f);1a.vx(g,{x:0,y:0},0)};e.1n.yk=1c(t){1b p=t.1q;1b v=t.1p;1b l={};1b n=1s.bR(p*p+v*v)/2;l.1C=t;1a.qI.2p(t,l);1b k=[];1b j=0;t.w4().1B(1c(w){if(1a.qI.2c(w)){1d}1b h=1a.yk(w);k.1h(h);j+=h.7h},1a);k.5q(b);if(!t.pD){j=j*72/71}1b o=[{x:-p/2,y:-v/2},{x:p/2,y:-v/2},{x:p/2,y:v/2},{x:-p/2,y:v/2}];1b s=0;if(!t.pD){s+=1s.PI/72}1b f=2*1s.PI;1k(1b u=0;u<k.1f;++u){1b z=k[u];1b r=f*z.7h/j;if(r>1s.PI){r=1s.PI;f=1s.PI;j-=z.7h}z.Ob=r}1k(1b u=0;u<k.1f;++u){1b z=k[u];1b A=z.Ob/2;s+=A;z.gT=s;s+=A;1b B=1s.1U(n+z.7h,z.7h/1s.dT(A));z.wq=B;1b q=1s.1U(n+2*z.7h,z.7h+z.7h/1s.dT(A));1b g={x:q*1s.mq(z.gT),y:q*1s.dT(z.gT)};o.1h(g)}if(k.1f>0){1b C=1e.cd.aJ.ea(o);l.7h=C.r;l.yC=C.x;l.wm=C.y}1l{l.7h=n;l.yC=l.wm=0}l.Of=k;1d l};e.1n.vx=1c(h,f,k){1b g=k;if(!h.1C.pD){g+=1s.PI-h.gT}1b j={x:f.x-h.yC,y:f.y-h.wm};a.1B(h.Of,1c(n){1b l={x:j.x+n.wq*1s.mq(n.gT),y:j.y+n.wq*1s.dT(n.gT)};l=1e.cd.OK(l,f,g);1a.vx(n,l,g)},1a);j=1e.cd.OK(j,f,g);h.1C.x=j.x;h.1C.y=j.y};1c b(j,h){1b g=j.7h;1b f=h.7h;if(g<f){1d 1}if(g>f){1d-1}1d 0}e.bi=1c(){if(!fz){fz=1g 1e.5b(e.1n)}1l{fz.5c(1j)}1d fz};e.1n.8v=1c(){if(!fz){fz=1g 1e.5b(e.1n,1j,1a)}1l{fz.5c(1a)}1d fz};e.1n.aA=1c(){1d 1a.4L.8s};fz=1j;e.1n.mE=1c(){1d 1a.6P};e.1n.mD=1c(f){1a.6P=f};e.1n.mv=1c(){1d 1a.8h};e.1n.mu=1c(f){1a.8h=f};e.1n.RL=1c(){1d 1a.dB};e.1n.RK=1c(f){1a.dB=f};e.1n.s5=1c(){1d 1a.9X};e.1n.rT=1c(f){1a.9X=f};1e.1Z(e,"1e.3N.OG")})(1e.3N);(1c(c){1b g=1e.2T.5i;1b d=1e.2T.8u;1b a=1e.3N.yJ;1b j=1e.3N.Oy;1b e=c.mL=1c(){1a.2q=1g g();1a.2g=1g g()};e.1n.1J=1c(k){1b n=1g e();if(k){n.ym=1g d();n.Ow=1g d()}1b l=1g d();1a.2q.1B(1c(o){1b p=o.1J();l.2p(o,p);n.2q.1h(p);if(k){n.ym.2p(p,o)}});1a.2g.1B(1c(p){if(l.2c(p.1E)&&l.2c(p.1x)){1b o=n.ge(l.1G(p.1E),l.1G(p.1x));if(k){n.Ow.2p(o,p)}}});1d n};e.1n.7m=1c(s,v,r){1b w=1g e();s.8Z=0;w.dB=s;1b q=1g g();1b n=1g g();w.2q.1h(s);q.1h(s);n.1h(s);1b l=1;2L(n.1f>0){1b p=n.9K();p.3S.1B(1c(B){if(q.2c(B.1x)){1d}1b A=B.1E;1b z=B.1x;z.8Z=A.8Z+1;z.1t=A;if(l<z.8Z+1){l=z.8Z+1}n.1h(z);q.1h(z);w.2q.1h(z);w.2g.1h(B)})}if(v){n.1h(s);q=1g g();q.1h(s);2L(n.1f>0){1b p=n.9K();1b u=a.d6;1k(1b o=0;o<p.3S.1f;o++){1b k=p.3S[o].1x;if(q.2c(k)){2t}n.1h(k);q.1h(k);56(k.5j.iX().jD){1T j.8n:k.7o=a.8n;1Q;1T j.d6:k.7o=a.d6;1Q;1T j.Ox:if(u===a.8n){k.7o=a.d6}1l{k.7o=a.8n}1Q;aL:2t}u=k.7o}}q=1g g();l=1a.x5(q,s,r)+1}1b t=1g g();1k(1b o=0;o<l;o++){t.1h(1g g())}w.2q.1B(1c(z){t[z.8Z].1h(z)});w.9U=t;1d w};e.1n.x5=1c(r,u,s){1b k=u.8Z;1b l=u.8Z;1b v=u.8Z;1b t=-1;1b q=1g g();1k(1b o=0;o<u.3S.1f;o++){q.1h(u.3S[o].1x)}q.5q(1c(z,w){1b B=z.5j.iX().jD;1b A=w.5j.iX().jD;if(B&&!A){1d-1}if(!B&&A){1d 1}1d z.1y-w.1y});1k(1b o=0;o<q.1f;o++){1b n=q[o];if(r.2c(n)){2t}r.1h(n);if(n.5j.iX().jD){if(n.7o===a.8n){if(s){n.8Z=k+1}1l{n.8Z=1s.1U(k,l)+1}}1l{if(n.7o===a.d6){if(s){n.8Z=l+1}1l{n.8Z=v+1}}}}1l{if(t===-1){t=1s.1U(k,l)+1}n.8Z=t}1b p=1a.x5(r,n,s);if(n.5j.iX().jD){if(n.7o===a.8n){k=1s.1U(k,p)}1l{l=1s.1U(l,p);v=1s.1U(k,l)}}1l{v=1s.1U(v,p)}}1d 1s.1U(v,k)};e.1n.ge=1c(n,l,k){1b o=1g c.r5(n,l);1a.2g.1h(o);o.1E.3S.1h(o);o.1E.2g.1h(o);o.1x.6l.1h(o);o.1x.2g.1h(o);if(k){o.5j=k}1d o};e.1n.sa=1c(k){1a.2g.1h(k);k.1E.3S.1h(k);k.1E.2g.1h(k);k.1x.6l.1h(k);k.1x.2g.1h(k)};e.1n.iY=1c(k){1a.2g.3l(k);g.3l(k.1E.3S,k);g.3l(k.1E.2g,k);g.3l(k.1x.6l,k);g.3l(k.1x.2g,k)};e.1n.gl=1c(l,k){1b n=1g c.rh();1a.2q.1h(n);if(l){n.x=l.x;n.y=l.y;n.1q=l.1q;n.1p=l.1p}if(k){n.5j=k}1d n};e.1n.oS=1c(k){1a.2q.1h(k);g.1B(k.3S,1c(l){1a.2g.1h(l)},1a)};e.1n.j4=1c(){1k(1b k=0;k<1a.2q.1f;++k){1b n=1a.2q[k];n.1y=k}1k(1b k=0;k<1a.2g.1f;++k){1b l=1a.2g[k];l.1y=k}};e.1n.mx=1c(){1a.rC=0;1a.j4();1b l=h(1a.2q.1f,-1);1k(1b k=0;k<1a.2q.1f;k++){if(l[k]==-1){1a.vP(l,k);1a.rC++}}1b o=[];1k(1b n=0;n<1a.rC;++n){o[n]=1g e()}1k(1b n=0;n<l.1f;++n){1b p=o[l[n]];p.oS(1a.2q[n])}1d o};e.1n.vP=1c(l,k){l[k]=1a.rC;1b n=1a.2q[k];g.1B(n.2g,1c(q){1b p=q.7z(n);1b o=p.1y;if(l[o]==-1){1a.vP(l,o)}},1a)};e.1n.RI=1c(){1b k=[];1a.j4();1a.2g.1B(1c(v){4m v.wf});1b w=0;1b r=[];1b s=[];1b l=[];1k(1b D=0;D<1a.2q.1f;D++){1b t=1a.2q[D];if(r[t.1y]!==1v){2t}if(t.2g.1f==0){1b B=1g e();B.oS(t);k.1h(B.1J(1m));2t}1b p=[];1b o=[];r[t.1y]=w++;l[t.1y]=r[t.1y];p.1h(t);o.1h(t.2g.6t(0));2L(1m){2L(o[o.1f-1].1f>0){1b u=p[p.1f-1];1b n=o[o.1f-1].e6();1b A=n.7z(u);if(n.wf){2t}s.1h(n);n.wf=1m;if(r[A.1y]===1v){r[A.1y]=w++;p.1h(A);o.1h(A.2g.6t(0));l[A.1y]=r[u.1y]}1l{if(r[A.1y]<l[u.1y]){l[u.1y]=r[A.1y]}}}if(p.1f>1){1b z=p[p.1f-1];1b q=p[p.1f-2];if(l[z.1y]==r[q.1y]){1b B=1g e();1b C=s[s.1f-1];2L(r[C.1E.1y]>=r[q.1y]&&r[C.1x.1y]>=r[q.1y]){s.9K();if(!B.2q.2c(C.1E)){B.oS(C.1E)}if(!B.2q.2c(C.1x)){B.oS(C.1x)}if(s.1f==0){1Q}C=s[s.1f-1]}k.1h(B.1J(1m))}1l{if(l[q.1y]>l[z.1y]){l[q.1y]=l[z.1y]}}p.9K();o.9K()}1l{1Q}}}1d k};e.1n.RH=1c(){1d 1a.vs(1u)};e.1n.PU=1c(){1d 1a.vs(1m)};e.1n.vs=1c(s){if(1a.2q.1f<2){1d s?1g g():[1a]}if(1a.2q[0].1y===1v){1a.j4()}1a.2g.1B(1c(E){4m E.r9;4m E.oK});1b o=1g g();1b n=0;1b C=[];1b r=[];1b u=[];1b A=[];1b p=[];1b q=[];1b w=[];1b B=[];1b D=[];1b v=1g d();1c l(F,E){1b J=F.1y;C[J]=n++;D[J]=F;r[J]=1;u[J]=C[J];A[J]=F;p[J]=C[J];q[J]=F;if(B[J]===1v){B[J]=[]}F.2g.1B(1c(O){if(O==E){1d}1b L=O.7z(F);1b K=L.1y;if(C[K]===1v){O.oK=1m;O.jQ=L;l(L,O);1b M=B[K];1b N=M.1f>0?M[M.1f-1]:1j;if(N!=1j&&L==N.q){M.9K();o.1h([O,N.8G]);O.r9=1m;N.8G.r9=1m;if(s){if(!v.2c(N.8G)){v.2p(N.8G,1g g())}v.1G(N.8G).1h(O)}if(F!=N.p){M.1h({8G:N.8G,p:N.p,q:F})}if(N.8G.oK){1b P=N.8G.jQ.1y;D[P]=F}}r[J]=r[J]+r[K];if(u[K]<u[J]){p[J]=u[J];u[J]=u[K];q[J]=A[J];A[J]=A[K];B[J]=B[K].6t(0);w[J]=O}1l{if(u[K]<p[J]){p[J]=u[K];q[J]=A[K];B[K]=[]}}}1l{if(C[J]>C[K]){if(C[K]<=u[J]){p[J]=u[J];u[J]=C[K];q[J]=A[J];A[J]=L;B[J]=[];w[J]=O}1l{if(C[K]<p[J]){p[J]=C[K];q[J]=L}}}}});1b G=B[J];1b I=G.1f>0?G[G.1f-1]:1j;if(I==1j){if(p[J]>u[J]){G.1h({8G:w[J],p:A[J],q:q[J]})}}1l{if(p[J]>C[I.q.1y]){G.1h({8G:w[J],p:I.q,q:q[J]})}1l{2L(G.1f>0&&p[J]<=C[G[G.1f-1].p.1y]){G.9K()}if(G.1f>0&&p[J]<C[G[G.1f-1].q.1y]){1b H=G.9K();G.1h({8G:H.8G,p:H.p,q:q[J]})}}}F.2g.1B(1c(O){1b K=O.7z(F);1b M=K.1y;if(O.oK||C[J]>C[M]){1d}1b N=G.1f>0?G[G.1f-1]:1j;1b P=N==1j?1j:N.8G.jQ;1b L=P?P.1y:0;2L(N!=1j&&N.8G.oK&&C[L]<=C[M]&&C[M]<=C[L]+r[L]-1){G.9K();N=G.1f>0?G[G.1f-1]:1j;P=N==1j?1j:N.8G.jQ;L=P?P.1y:0}})}l(1a.2q[0],1j);if(s){v.1B(1c(H,E){1k(1b G=0;G<E.1f;G++){1k(1b F=G+1;F<E.1f;F++){if(!o.jJ(1c(I){1d I[0]==E[G]&&I[1]==E[F]})){o.1h([E[G],E[F]])}}}});1d o}1b t=1g g();1a.2g.1B(1c(E){if(E.r9){t.1h(E)}});t.1B(1c(E){1a.iY(E)},1a);1b z=[];1a.2q.1B(1c(E){if(D[E.1y]!=E){1b F=1a.ge(E,D[E.1y]);z.1h(F)}},1a);1b k=1a.mx();z.1B(1c(E){1a.iY(E)},1a);t.1B(1c(E){1a.sa(E)},1a);1d k};e.1n.Rh=1c(){1b o=1a.2q;if(o.1f<4){1d[]}1c n(w,t){1b q=[];1b r=[];1b u=1;o.1B(1c(z){if(z!=w&&z!=t){q.1h(z);r[z.1y]=1m;1d $1Q}});2L(q.1f>0){1b s=q.e6();s.w4().1B(1c(v){if(r[v.1y]||w==v||t==v){1d}q.1h(v);r[v.1y]=1m;u++})}1d u==o.1f-2}1a.j4();1b p=[];1k(1b l=0;l<o.1f-1;l++){1k(1b k=l+1;k<o.1f;k++){if(!n(o[l],o[k])){p.1h([o[l],o[k]])}}}1d p};e.1n.Rk=1c(){1b G=0;1b B=[];1b u=[];1b J=[];1b I=[];1b z=[];1b n=[];1b r=[];1b D=[];1b q=1g g();1b E=1g g();1b t=1a;1b H=t.2q.1f;1a.2g.1B(1c(K){4m K.az});1c F(N,Q){1b S=N.1y;n[S]=[];B[S]=G++;u[B[S]]=N;z[S]=Q;J[S]=I[S]=B[S];r[S]=1;N.2g.1B(1c(V){1b P=V.7z(N);1b U=P.1y;if(B[U]===1v){V.az=1m;n[S].1h(P);F(P,N);if(J[U]<J[S]){I[S]=1s.2b(J[S],I[U]);J[S]=J[U]}1l{if(J[U]==J[S]){I[S]=1s.2b(I[S],I[U])}1l{I[S]=1s.2b(I[S],J[U])}}r[S]+=r[U]}1l{if(B[U]<B[S]&&(U!=Q.1y||D[S])){if(B[U]<J[S]){I[S]=J[S];J[S]=B[U]}1l{if(B[U]>J[S]){I[S]=1s.2b(I[S],B[U])}}}}if(P==Q){D[S]=1m}});if(Q){1b L=u[J[S]];1b O=r[S];if(L!=Q&&I[S]>=B[Q.1y]&&O<H-2){q.1h([L,Q])}1l{if(B[L.1y]>0&&o(L,Q,N)){q.1h([L,Q])}}}1b T=1u;k(N).1B(1c(P){if(J[S]==J[P.1y]){T=1m;1d $1Q}});if(r[S]>1&&!T){1b R=t.gl();R.1y=t.2q.1f-1;g.1B(N.2g.6t(0),1c(U){if(!U.az){1b P=U.7z(N);if(B[S]>B[P.1y]){U.l7(N,R)}}});1b M=t.ge(N,R);M.1y=t.2g.1f-1;M.az=1m;B[R.1y]=B[S];J[R.1y]=J[S];r[R.1y]=1;z[R.1y]=N;A(R,N);E.1h(R)}1b K=0;N.2g.1B(1c(P){if(!P.az){K++}});if(K>1){A(N,N);E.1h(N)}}1c C(K,M){1b L=1g g();2L(z[M.1y]!=K){L.1h(z[M.1y]);M=z[M.1y]}1d L}1c o(L,O,M){1b N=C(L,O);1b K=1m;N.1B(1c(P){P.2g.1B(1c(R){1b Q=R.7z(P);if(Q==L||Q==O){1d}if(B[Q.1y]===1v){K=1u}1l{if(B[Q.1y]<B[L.1y]){K=1u}1l{if(B[Q.1y]>B[O.1y]&&B[Q.1y]<B[M.1y]){K=1u}1l{if(J[Q.1y]<B[L.1y]){K=1u}}}}});if(!K){1d $1Q}});1d K}1c k(K){1b L=K.1y;1b M=1g g();K.2g.1B(1c(O){if(O.az){1b N=O.7z(K);if(B[L]<B[N.1y]){M.1h(N)}}});1d M}1c A(N,U){1b Y=N.1y;1b K=1g g();1b R=1g g();N.2g.1B(1c(ab){if(ab.az){1d}1b V=ab.7z(N);if(B[Y]>B[V.1y]){if(!K.2c(V)){K.1h(V)}}1l{if(!R.2c(V)){R.1h(V)}}});K.5q(v);R.5q(v);1b aa=1g g();K.1B(1c(ab){1b V=t.gl();V.fh=U;V.1y=t.2q.1f-1;r[V.1y]=r[Y];aa.1h(V)});1b Q=1g g();R.1B(1c(ab){1b V=t.gl();V.fh=U;V.1y=t.2q.1f-1;r[V.1y]=r[Y];Q.1h(V)});1b M=[];aa.PN(1c(V){M.1h(V)});Q.PN(1c(V){M.1h(V)});1k(1b P=0;P<M.1f-1;P++){1b T=t.ge(M[P],M[P+1]);T.1y=t.2g.1f-1;T.fh=U;T.az=1m}1b O=1j;1b L=1g g();N.2g.1B(1c(ab){if(ab.az){1b V=ab.7z(N);if(B[Y]<B[V.1y]){L.1h(ab)}1l{if(B[Y]>=B[V.1y]){O=ab}}}});if(O){O.l7(N,M[0]);O.fh=U}L.1B(1c(V){V.l7(N,M[M.1f-1]);V.fh=U});z[M[0].1y]=z[Y];1k(1b P=0;P<K.1f;P++){1b Z=K[P];1b X=N.vT(Z);X.1B(1c(V){if(!V.az){V.l7(N,aa[P])}});J[aa[P].1y]=J[Y];B[aa[P].1y]=B[Y]}1k(1b P=0;P<R.1f;P++){1b W=R[P];1b S=N.vT(W);S.1B(1c(V){if(!V.az){V.l7(N,Q[P])}});J[Q[P].1y]=J[Y];B[Q[P].1y]=B[Y]}}1c v(L,K){if(B[L.1y]<B[K.1y]){1d-1}if(B[L.1y]>B[K.1y]){1d 1}1d 0}1c s(K,L){2L(z[L.1y]!=K){L=z[L.1y]}1d L}1a.j4();F(1a.2q[0],1j);E.1B(1c(K){t.2q.3l(K)});1b l=1g g();1b w=1a.PU();w.1B(1c(Q){if(!(Q[0].az&&Q[1].az)){1d}1b M=Q[0].vO();1b N=Q[1].vO();M.5q(v);N.5q(v);if(!z[M[0].1y]&&r[N[1].1y]===1){1d}if(!z[N[0].1y]&&r[M[1].1y]===1){1d}1b P=[];P.1h(Q[0].1E);P.1h(Q[0].1x);1b O=[];O.1h(Q[1].1E);O.1h(Q[1].1x);1k(1b L=0;L<P.1f;L++){1k(1b K=0;K<O.1f;K++){if(P[L]!=O[K]){l.1h([P[L],O[K]])}}}});l.1B(1c(N){1b K,M;if(B[N[0].1y]<B[N[1].1y]){K=N[0];M=N[1]}1l{M=N[0];K=N[1]}if(K.fh){K=K.fh}if(M.fh){M=M.fh}if(K==M){1d}1b L=p(K,M,n[M.1y][0],n[M.1y]);if(L[1]!=0&&L[0]+L[2]!=0&&!q.jJ(1c(O){1d O[0]==K&&O[1]==M})){q.1h([K,M])}});1c p(K,R,M,N){1b O=N.1f==0?0:r[M.1y];1b L=s(K,R);1b P=r[L.1y]-O-1;N.1B(1c(S){if(S==M){1d}if(J[S.1y]<B[K.1y]){P-=r[S.1y]}});1b Q=H-P-O-2;1d[Q,P,O]}1d q};e.1n.PP=1c(){if(1a.2q.1f<=1||1a.2g.1f<=1){1d[]}if(1a.2q.1f==2){1b E=[];1b q=1a.2g[0];q.bh();E.1h(q);1d E}1b p=1a.1J(1m);1b r=1a.2q.1f;1b z=1g d();p.2q.1B(1c(n){b(n,r,z)});1b t=[];1b o=[];2L(p.2q.1f>0){if(z.2c(2-r)){1b u=z.1G(2-r);2L(u.1f>0){1b D=u.9K();D.2g.1B(1c(v){1b n=v.7z(D);1b F=f(n,r);z.1G(F).3l(n);n.iY(v);b(n,r,z)});p.2q.3l(D);o.wl(D)}}if(z.2c(r-2)){1b l=z.1G(r-2);2L(l.1f>0){1b k=l.9K();k.2g.1B(1c(v){1b n=v.7z(k);1b F=f(n,r);z.1G(F).3l(n);n.iY(v);b(n,r,z)});p.2q.3l(k);t.1h(k)}}if(p.2q.1f>0){1k(1b w=r-3;w>2-r;w--){if(z.2c(w)&&z.1G(w).1f>0){1b s=z.1G(w);1b C=s.9K();C.2g.1B(1c(v){1b n=v.7z(C);1b F=f(n,r);z.1G(F).3l(n);n.iY(v);b(n,r,z)});p.2q.3l(C);t.1h(C);1Q}}}}g.bg(t,o);1b B=1g d();1k(1b w=0;w<1a.2q.1f;w++){B.2p(p.ym.1G(t[w]),w)}1b A=1g g();1a.2g.1B(1c(n){if(B.1G(n.1E)>B.1G(n.1x)){n.bh();A.1h(n)}});1d A};1c f(k,l){if(k.3S.1f==0){1d 2-l}1l{if(k.6l.1f==0){1d l-2}1l{1d k.3S.1f-k.6l.1f}}}1c b(k,p,o){1b l=f(k,p);if(!o.2c(l)){o.2p(l,1g g())}o.1G(l).1h(k)}1c h(l,n){1b o=[];1k(1b k=0;k<l;++k){o[k]=n}1d o}1e.1Z(e,"1e.3N.mL")})(1e.3N);(1c(d){1b f=1e.2T.5i;1b e=1e.2T.8u;1b j=1e.2T.dZ;1b b=1e.3N.yJ;1b a=d.Le=1c(){1a.co=10;1a.3X=10;1a.eo=1u;1a.4z=d.4s.ed;1a.c4=d.cQ.9j;1a.6P=d.gS.lj;1a.8h=1u;1a.k2=1u;1a.PX=1u;1a.9X=d.gg.7U};a.1n.kq=1m;a.1n.hR=1m;a.1n.ji=1m;a.1n.ie=1u;a.1n.7M=10;a.1n.mf=1c(){1d 1a.c4==d.cQ.a5};a.1n.fr=1c(){1d 1a.eo};a.1n.c5=1c(V){1b J;V.2q.1B(1c(s){if(s.6l.1f==0){J=s;1d $1Q}});if(!J){1d $iu}1b F=V.7m(J,1a.k2,1a.PX);if(!F){1d $iu}F.2q.1B(1c(s){s.cq=s.5j.iX().jD});1b T=J.x+J.1q/2;1b R=J.y+J.1p/2;h(F,J,1c(s,aj){s.x=s.1q/2;s.y=s.1p/2},1j);1b ab=1g f();1k(1b ah=0;ah<F.9U.1f;ah++){1b P=F.9U[ah];1b z=0;1k(1b ag=0;ag<P.1f;ag++){if(1a.6C()){z=1s.1U(z,P[ag].1q)}1l{z=1s.1U(z,P[ag].1p)}}ab.1h(z)}1b Q=F.9U[F.9U.1f-1];1b ac=0;1k(1b ah=0;ah<Q.1f;ah++){1b O=Q[ah];if(1a.6C()){O.y=ac+O.1p/2;ac+=O.1p+1a.3X}1l{O.x=ac+O.1q/2;ac+=O.1q+1a.3X}}1b E=1g e();1b ad=1g e();1k(1b ah=F.9U.1f-1;ah>=0;ah--){1b P=F.9U[ah];1k(1b ag=0;ag<P.1f;ag++){1b O=P[ag];1b D=g(F,O);if(D.1f>0){if(1a.LZ(O)&&1a.k2){1b B=1v;1b L=1v;D.1B(1c(s){if(s.7o===b.8n){B=s}1l{if(s.7o===b.d6){L=s}}});if(B&&L){1b ae=1a.cy(B);1b l=1a.cy(L);if(1a.6C()){O.y+=ae.2V()+(l.3Z()-ae.2V())/2-O.1p/2}1l{O.x+=ae.2y()+(l.3M()-ae.2y())/2-O.1q/2}}1l{if(B){1b o=1a.cy(B);if(1a.6C()){O.y=o.2V()+1a.3X/2}1l{O.x=o.2y()+1a.3X/2}}1l{1b o=1a.cy(L);if(1a.6C()){O.y=o.3Z()-1a.3X/2}1l{O.x=o.3M()-1a.3X/2}}}}1l{1b U=1e.1z.2O.cK(D[0]);1k(1b ai=1;ai<D.1f;ai++){U=U.9I(1e.1z.2O.cK(D[ai]))}if(1a.6C()){O.y+=(U.3Z()+U.2V())/2-O.1p/2}1l{O.x+=(U.3M()+U.2y())/2-O.1q/2}}}if(O.cq&&1a.k2){1b r=[];if(O.1t){1k(1b ai=0;ai<O.1t.3S.1f;ai++){1b q=O.1t.3S[ai].1x;if(q.cq){2t}r.1h(q)}}if(r.1f>0){1b U=1e.1z.2O.cK(r[0]);1k(1b ai=1;ai<r.1f;ai++){U=U.9I(1e.1z.2O.cK(r[ai]))}1b Y=1a.cy(O);if(1a.6C()){1b W=0;if(O.7o===b.8n){W=U.y+U.1p/2-Y.2V()-1a.3X/2}1l{W=U.y+U.1p/2-Y.3Z()+1a.3X/2}1a.8m(F,O,0,W)}1l{1b W=0;if(O.7o===b.8n){W=U.x+U.1q/2-Y.2y()-1a.3X/2}1l{W=U.x+U.1q/2-Y.3M()+1a.3X/2}1a.8m(F,O,W,0)}}1l{if(O.1t){1b aa=1v;if(E.2c(O.1t)){aa=E.1G(O.1t)}1b u=1v;if(ad.2c(O.1t)){u=ad.1G(O.1t)}if(aa||u){1b C=1a.cy(O);if(O.7o===b.d6){if(u){1b A=1a.cy(u);if(1a.6C()){1b W=A.3Z()-C.3Z();1a.8m(F,O,0,W)}1l{1b W=A.3M()-C.3M();1a.8m(F,O,W,0)}}1l{if(aa){1b A=1a.cy(aa);if(1a.6C()){1b W=A.2V()+1a.3X-C.3Z();1a.8m(F,O,0,W)}1l{1b W=A.2y()+1a.3X-C.3M();1a.8m(F,O,W,0)}}}}1l{if(aa){1b A=1a.cy(aa);if(1a.6C()){1b W=A.2V()-C.2V();1a.8m(F,O,0,W)}1l{1b W=A.2y()-C.2y();1a.8m(F,O,W,0)}}1l{if(u){1b A=1a.cy(u);if(1a.6C()){1b W=A.3Z()-1a.3X-C.2V();1a.8m(F,O,0,W)}1l{1b W=A.3M()-1a.3X-C.2y();1a.8m(F,O,W,0)}}}}}}}}if(O.cq&&1a.k2){if(O.7o===b.8n){E.2p(O.1t,O)}1l{if(O.7o===b.d6){ad.2p(O.1t,O)}}}}1k(1b ag=0;ag<P.1f-1;ag++){1k(1b af=ag;af>=0;af--){if(P[af].cq||P[ag+1].cq){2t}1b p=1a.MD(F,P[af],P[ag+1]);1b N=af!=ag;if(N?p<1a.3X:1m){if(1a.6C()){1a.8m(F,P[ag+1],0,1a.3X-p)}1l{1a.8m(F,P[ag+1],1a.3X-p,0)}}}}}1b G;1b t;1b S;if(1a.kR()){G=0;t=F.9U.1f;S=+1}1l{G=F.9U.1f-1;t=-1;S=-1}1b M=0;1k(1b ah=G;1a.kR()?ah<t:ah>t;ah+=S){1b K=0;1b P=F.9U[ah];1k(1b ag=0;ag<P.1f;ag++){1b O=P[ag];1b w=0;if(1a.6C()){w=O.1q;1b n=0;if(1a.4z==d.4s.fq){n=ab[ah]-w}O.x=M+n+1a.7M;O.y=O.y+1a.7M}1l{w=O.1p;1b I=0;if(1a.4z==d.4s.jh){I=ab[ah]-w}O.x=O.x+1a.7M;O.y=M+I+1a.7M}K=1s.1U(K,w)}M+=K+1a.co}if(1a.eo){1b Z=J.x;1b X=J.y;1b n=T-Z;1b I=R-X;1a.8m(F,J,n,I)}if(1a.c4!=d.cQ.9j){56(1a.c4){1T d.cQ.ds:56(1a.4z){1T d.4s.ed:F.2g.1B(1c(s){s.1r=[{x:s.1E.x,y:s.1E.y+s.1E.1p/2},{x:s.1x.x,y:s.1x.y-s.1x.1p/2}]});1Q;1T d.4s.jh:F.2g.1B(1c(s){s.1r=[{x:s.1E.x,y:s.1E.y-s.1E.1p/2},{x:s.1x.x,y:s.1x.y+s.1x.1p/2}]});1Q;1T d.4s.fH:F.2g.1B(1c(s){s.1r=[{x:s.1E.x+s.1E.1q/2,y:s.1E.y},{x:s.1x.x-s.1x.1q/2,y:s.1x.y}]});1Q;1T d.4s.fq:F.2g.1B(1c(s){s.1r=[{x:s.1E.x-s.1E.1q/2,y:s.1E.y},{x:s.1x.x+s.1x.1q/2,y:s.1x.y}]});1Q}1Q;1T d.cQ.a5:1b H=1a.k2;1b v=1a.co/2;56(1a.4z){1T d.4s.ed:F.2g.1B(1c(s){if(H&&s.1x.cq){s.1r=[{x:s.1E.x,y:s.1E.y+s.1E.1p/2},{x:s.1E.x,y:s.1x.y},s.1x.7o===b.8n?{x:s.1x.x+s.1x.1q/2,y:s.1x.y}:{x:s.1x.x-s.1x.1q/2,y:s.1x.y}]}1l{s.1r=[{x:s.1E.x,y:s.1E.y+s.1E.1p/2},{x:s.1E.x,y:s.1x.y-s.1x.1p/2-v},{x:s.1x.x,y:s.1x.y-s.1x.1p/2-v},{x:s.1x.x,y:s.1x.y-s.1x.1p/2}]}});1Q;1T d.4s.jh:F.2g.1B(1c(s){if(H&&s.1x.cq){s.1r=[{x:s.1E.x,y:s.1E.y-s.1E.1p/2},{x:s.1E.x,y:s.1x.y},s.1x.7o===b.8n?{x:s.1x.x+s.1x.1q/2,y:s.1x.y}:{x:s.1x.x-s.1x.1q/2,y:s.1x.y}]}1l{s.1r=[{x:s.1E.x,y:s.1E.y-s.1E.1p/2},{x:s.1E.x,y:s.1x.y+s.1x.1p/2+v},{x:s.1x.x,y:s.1x.y+s.1x.1p/2+v},{x:s.1x.x,y:s.1x.y+s.1x.1p/2}]}});1Q;1T d.4s.fH:F.2g.1B(1c(s){if(H&&s.1x.cq){s.1r=[{x:s.1E.x+s.1E.1q/2,y:s.1E.y},{x:s.1x.x,y:s.1E.y},s.1x.7o===b.8n?{x:s.1x.x,y:s.1x.y+s.1x.1p/2}:{x:s.1x.x,y:s.1x.y-s.1x.1p/2}]}1l{s.1r=[{x:s.1E.x+s.1E.1q/2,y:s.1E.y},{x:s.1x.x-s.1x.1q/2-v,y:s.1E.y},{x:s.1x.x-s.1x.1q/2-v,y:s.1x.y},{x:s.1x.x-s.1x.1q/2,y:s.1x.y}]}});1Q;1T d.4s.fq:F.2g.1B(1c(s){if(H&&s.1x.cq){s.1r=[{x:s.1E.x-s.1E.1q/2,y:s.1E.y},{x:s.1x.x,y:s.1E.y},s.1x.7o===b.8n?{x:s.1x.x,y:s.1x.y+s.1x.1p/2}:{x:s.1x.x,y:s.1x.y-s.1x.1p/2}]}1l{s.1r=[{x:s.1E.x-s.1E.1q/2,y:s.1E.y},{x:s.1x.x+s.1x.1q/2+v,y:s.1E.y},{x:s.1x.x+s.1x.1q/2+v,y:s.1x.y},{x:s.1x.x+s.1x.1q/2,y:s.1x.y}]}});1Q}}}};a.1n.LZ=1c(n){1k(1b l=0;l<n.3S.1f;l++){if(n.3S[l].1x.cq){1d 1m}}1d 1u};a.1n.cy=1c(o){1b q=1e.1z.2O;1b p=[];p.1h(o);1b n=1g f();1b l;2L(p.1f>0){1b s=p[0];p.8O(0,1);n.1h(s);if(!l){l=q.cK(s)}1l{l=l.9I(q.cK(s))}1k(1b r=0;r<s.3S.1f;r++){1b t=s.3S[r].1x;if(!n.2c(t)){p.1h(t)}}}1d l};a.1n.MD=1c(D,C,A){1b v=1a.3M(A)-1a.2y(C);1b t=1g e();1b s=1g e();k(D,C,t);k(D,A,s);1b B=t.OR();1k(1b u=0;u<B.1f;u++){1b o=B[u];if(!s.2c(o)){2t}1b z=t.1G(o);1b w=s.1G(o);1b n=0;1k(1b q=0;q<z.1f;q++){n=1s.1U(n,1a.2y(z[q]))}1b p=3W.5s;1k(1b q=0;q<w.1f;q++){p=1s.2b(p,1a.3M(w[q]))}if((p-n<v)&&(z.1f>0&&w.1f>0)){v=p-n}}1d v};a.1n.2y=1c(l){if(1a.6C()){1d l.y+l.1p/2}1l{1d l.x+l.1q/2}};a.1n.3M=1c(l){if(1a.6C()){1d l.y-l.1p/2}1l{1d l.x-l.1q/2}};1c k(l,n,o){1b q=n.8Z;1b p=1j;if(o.2c(q)){p=o.1G(q)}1l{p=1g f();o.2p(q,p)}p.1h(n);g(l,n).1B(1c(r){k(l,r,o)})}a.1n.8m=1c(l,p,n,q){if(!n&&!q){1d}1b o=1c(r,s){r.x+=s[0];r.y+=s[1]};h(l,p,o,[n,q])};a.1n.6C=1c(){1d 1a.4z==d.4s.fH||1a.4z==d.4s.fq};a.1n.kR=1c(){1d 1a.4z==d.4s.fH||1a.4z==d.4s.ed};1c c(l,n){1d(l-l%n)/n}1c g(l,o){1b n=1g f();o.3S.1B(1c(p){if(l.2g.2c(p)){n.1h(p.1x)}});1d n}1c h(l,p,o,q){o.Mp(1a,p,q);1b n=g(l,p);n.1B(1c(r){h(l,r,o,q)})}a.bi=1c(){if(!gs){gs=1g 1e.5b(a.1n)}1l{dQ.5c(1j)}1d gs};a.1n.8v=1c(){if(!gs){gs=1g 1e.5b(a.1n,1j,1a)}1l{gs.5c(1a)}1d gs};a.1n.aA=1c(){1d 1a.4L.8s};gs=1j;a.1n.Mo=1c(){1d 1a.co};a.1n.Mn=1c(l){1a.co=l};a.1n.rO=1c(){1d 1a.3X};a.1n.rD=1c(l){1a.3X=l};a.1n.Lt=1c(){1d 1a.eo};a.1n.Lr=1c(l){1a.eo=l};a.1n.yG=1c(){1d 1a.4z};a.1n.yI=1c(l){1a.4z=l};a.1n.Lx=1c(){1d 1a.c4};a.1n.Li=1c(l){1a.c4=l};a.1n.mE=1c(){1d 1a.6P};a.1n.mD=1c(l){1a.6P=l};a.1n.mv=1c(){1d 1a.8h};a.1n.mu=1c(l){1a.8h=l};1e.1Z(a,"1e.3N.Le")})(1e.3N);(1c(c){1b b=1e.2T.5i;1b e=1e.2T.8u;1b d=1e.2T.dZ;1b a=c.MT=1c(){1a.6Z=c.bd.vc;1a.sh=1m;1a.5I=1;1a.fR=1j;1a.qQ=0;1a.Lf=1};a.1n.kq=1u;a.1n.hR=1u;a.1n.ji=1u;a.1n.ie=1u;a.1n.tU=1m;a.1n.7M=10;a.1n.mf=1c(){1d 1u};a.1n.fr=1c(){1d 1u};a.1n.c5=1c(j){if(1a.fR==1j){1a.fR=j.fR}1b h=[];1a.aU=1g e();1b g=0;j.2q.1B(1c(k){if(k.bD==1j){g+=1a.yy(k);h.1h(k)}},1a);if(1a.sh){1a.xL(h,1a.fR,[],g)}1l{1a.yZ(h,1a.fR,1a.6Z==c.bd.7U,g)}};a.1n.xL=1c(h,l,n,g){1b j=h.6t();1b k=1a.aU;j.5q(1c(p,o){1d k.1G(o)-k.1G(p)});1a.pR(j,l,n,g)};a.1n.pR=1c(l,n,t,k){1b h=n.1q>n.1p;1b g=1s.2b(n.1q,n.1p);1b q=0,p=0;1b s=t.6t();if(l.1f>0){1b o=l[0];s.1h(o);1b j=n.1q*n.1p;q=1a.yF(t,g,j*1a.8q(t)/k);p=1a.yF(s,g,j*1a.8q(s)/k)}if(l.1f>0&&(q==0||q>=p)){l.e6();1a.pR(l,n,s,k)}1l{1b r=1a.Lo(n,t,!h,k);k-=1a.8q(t);if(h){n.x+=r;n.1q-=r}1l{n.y+=r;n.1p-=r}if(l.1f>0){1a.pR(l,n,[],k)}}};a.1n.8q=1c(h){1b g=0;h.1B(1c(j){g+=1a.aU.1G(j)},1a);1d g};a.1n.nL=1c(g){1b h=-1a.5I/2;g=g.5B(h);1b j=1a.Lf;if(g.1q<j){g.1q=j}if(g.1p<j){g.1p=j}};a.1n.Lo=1c(l,s,j,k){1b h=1e.1z.2O;1b n=l.1q*l.1p;1b g=j?l.1q:l.1p;1b q=0;s.1B(1c(t){q+=1a.aU.1G(t)},1a);1b r=n*q/k;1b o=r/g;1b p=j?l.x:l.y;s.1B(1c(w){1b z=1a.aU.1G(w);1b v=j?1g h(p,l.y,r*z/q/o,o):1g h(l.x,p,o,r*z/q/o);1a.nL(v);f(w,v);p+=r*z/q/o;if(w.dR!=1j){1b u=w.dR.6t();1b t=1a.vm(w);1a.nL(t);1a.xL(u,t,[],z)}},1a);1d o};a.1n.yZ=1c(j,n,h,g){1b k=1e.1z.2O;1b o=h?n.x:n.y;1b l=h?n.1q:n.1p;j.1B(1c(t){1b p=l*1a.aU.1G(t)/g;1b s=h?1g k(o,n.y,p,n.1p):1g k(n.x,o,n.1q,p);1a.nL(s);f(t,s);if(t.dR!=1j){1b r=t.dR.6t();1b q=1a.vm(t);1a.nL(q);1a.yZ(r,q,!h,1a.aU.1G(t))}o+=p},1a)};a.1n.yF=1c(l,k,j){1b g=0;1b h=0;l.1B(1c(n){1b o=1a.aU.1G(n);h+=o},1a);l.1B(1c(o){1b p=1a.aU.1G(o);1b n=j*p/h;g=1s.1U(g,1s.1U(k*k*n/(j*j),j*j/(k*k*n)))},1a);1d g};a.1n.yy=1c(g){if(1a.aU.2c(g)){1d 1a.aU.1G(g)}if(g.dR==1j){1a.aU.2p(g,g.8q);1d g.8q}1b h=0;g.dR.1B(1c(j){h+=1a.yy(j)},1a);1a.aU.2p(g,h);1d h};a.1n.vm=1c(j){1b h=1e.1z.2O;1b k=h.cK(j);if(j.y9){1b g=j.y9;if(g<k.1p){k.y+=g;k.1p-=g}1l{k.y+=k.1p/2;k.1p/=2}}if(j.dR!=1j){1d k.5B(-1a.qQ)}1d k};1c f(h,g){1b j=g.4e();h.x=j.x;h.y=j.y;h.1q=g.1q;h.1p=g.1p}a.bi=1c(){if(!dQ){dQ=1g 1e.5b(a.1n)}1l{dQ.5c(1j)}1d dQ};a.1n.8v=1c(){if(!dQ){dQ=1g 1e.5b(a.1n,1j,1a)}1l{dQ.5c(1a)}1d dQ};a.1n.aA=1c(){1d 1a.4L.8s};dQ=1j;a.1n.Q1=1c(){1d 1a.6Z};a.1n.xI=1c(g){1a.6Z=g};a.1n.Sn=1c(){1d 1a.sh};a.1n.Sp=1c(g){1a.sh=g};a.1n.Q5=1c(){1d 1a.5I};a.1n.PZ=1c(g){1a.5I=g};a.1n.Sm=1c(){1d 1a.fR};a.1n.RV=1c(g){1a.fR=g};a.1n.RU=1c(){1d 1a.qQ};a.1n.RX=1c(g){1a.qQ=g};1e.1Z(a,"1e.3N.MT")})(1e.3N);(1c(b){1b a=1e.2T.5i;1b c=b.rh=1c(){1a.2g=1g a();1a.3S=1g a();1a.6l=1g a();1a.8q=1};c.1n.1J=1c(){1b d=1g c();if(1a.8b!==1v){d.8b=1a.8b}if(1a.8q!==1v){d.8q=1a.8q}if(1a.vV!==1v){d.vV=1a.vV}if(1a.5j!==1v){d.5j=1a.5j}1d d};c.1n.iY=1c(d){if(d.1E==1a){1a.2g.3l(d);1a.3S.3l(d);d.1E=1j}if(d.1x==1a){1a.2g.3l(d);1a.6l.3l(d);d.1x=1j}};c.1n.N3=1c(d){1d 1a.2g.2c(d)};c.1n.MZ=1c(d){1d 1a.y6(d)!==1j};c.1n.y6=1c(e){1b d=1a;1d 1a.2g.jJ(1c(f){1d f.7z(d)===e},1a)};c.1n.vT=1c(d){1d 1a.2g.RP(1c(e){1d e.7z(1a)===d},1a)};c.1n.RS=1c(d){1d 1a.3S.jJ(1c(e){1d e.1x==d})};c.1n.w4=1c(){1b d=1g a();1a.6l.1B(1c(f){d.1h(f.7z(1a))},1a);1a.3S.1B(1c(f){d.1h(f.7z(1a))},1a);1d d};c.1n.mB=1c(){1d 1a.2g.1f};1e.1Z(c,"1e.3N.rh")})(1e.3N);(1c(c){1b a=c.Q3=1c(){1a.3X=30;1a.kZ=RY;1a.re=1u;1a.mY=0;1a.mZ=0;1a.6P=c.gS.lj;1a.8h=1u;1a.9X=c.gg.7U};a.1n.ie=1m;a.1n.7M=10;a.1n.c5=1c(g){1a.mY=1a.3X*9;1a.mZ=1a.mY;1a.9m=g;1b e=b(g,d(g),1,4);1a.1q=e.1q;1a.1p=e.1p;1k(1b f=0;f<1a.kZ;f++){1a.re=f>=1a.kZ*3/4;g.2q.1B(1c(h){1a.Nj(h)},1a);g.2g.1B(1c(h){1a.Nk(h)},1a);g.2q.1B(1c(h){1a.Nc(h)},1a);1a.mZ=1a.re?1a.mY/30:1a.mY*(1-f/1a.kZ/2)}};a.1n.vv=1c(h,e){1b g=1s.MP()*2*1s.PI;1b f=e*1s.MP();if(f==0){f=e/2}h.x+=f*1s.mq(g);h.y-=f*1s.dT(g)};a.1n.vJ=1c(e,f,q,o){1b p=0;if(1a.re){1b n=q.x-o.x;1b l=q.y-o.y;1b k=q.1q/2;1b j=q.1p/2;1b h=o.1q/2;1b g=o.1p/2;p=(n*n)/1s.5O(k+h+f,2)+(l*l)/1s.5O(j+g+f,2)}1l{p=e*e/f/f}1d p*4/3};a.1n.Nh=1c(h,e,g,f){1d 1/1a.vJ(h,e,g,f)};a.1n.Nj=1c(e){e.dx=0;e.dy=0;1b f=1a.3X;1a.9m.2q.1B(1c(k){if(k==e){1d}2L(e.x==k.x&&e.y==k.y){1a.vv(k,f/4)}1b h=e.x-k.x;1b g=e.y-k.y;1b l=1s.bR(h*h+g*g);1b j=1a.Nh(l,f,e,k);e.dx+=(h/l)*j;e.dy+=(g/l)*j},1a)};a.1n.Nk=1c(h){1b o=h.1E;1b l=h.1x;1b g=1a.3X;2L(o.x==l.x&&o.y==l.y){1a.vv(l,g/4)}1b k=o.x-l.x;1b j=o.y-l.y;1b f=1s.bR(k*k+j*j);1b n=1a.vJ(f,g,o,l);1b q=(k/f)*n;1b p=(j/f)*n;o.dx-=q;o.dy-=p;l.dx+=q;l.dy+=p};a.1n.Nc=1c(e){1b f=1s.bR(e.dx*e.dx+e.dy*e.dy);if(f==0){1d}e.x+=1s.2b(f,1a.mZ)*e.dx/f;e.y+=1s.2b(f,1a.mZ)*e.dy/f;e.x=1s.2b(1a.1q,1s.1U(e.1q/2,e.x));e.y=1s.2b(1a.1p,1s.1U(e.1p/2,e.y))};1c d(f){1b e=0;if(f.2q.1f==0){1d e}f.2q.1B(1c(g){1b h=g.1q*g.1p;if(h>0){e+=1s.bR(h)}});1d e/f.2q.1f}1c b(j,h,l,k){1b f=h*1s.R4(1s.bR(j.2q.1f));1b g=f*1s.bR(l);1b e=f/1s.bR(l);1d{1q:g*k,1p:e*k}}a.bi=1c(){if(!eY){eY=1g 1e.5b(a.1n)}1l{eY.5c(1j)}1d eY};a.1n.8v=1c(){if(!eY){eY=1g 1e.5b(a.1n,1j,1a)}1l{eY.5c(1a)}1d eY};a.1n.aA=1c(){1d 1a.4L.8s};eY=1j;a.1n.rO=1c(){1d 1a.3X};a.1n.rD=1c(e){1a.3X=e};a.1n.QV=1c(){1d 1a.kZ};a.1n.Ra=1c(e){1a.kZ=e};a.1n.mE=1c(){1d 1a.6P};a.1n.mD=1c(e){1a.6P=e};a.1n.mv=1c(){1d 1a.8h};a.1n.mu=1c(e){1a.8h=e};a.1n.s5=1c(){1d 1a.9X};a.1n.rT=1c(e){1a.9X=e};1e.1Z(a,"1e.3N.Q3")})(1e.3N);(1c(l){1b o=1e.2T.5i;1b n=1e.2T.8u;1b q=1e.2T.dZ;1b k=1e.3N.r5;1b p=1e.3N.rh;1b g=l.MX=1c(){1a.3X=20;1a.rB=25;1a.4z=l.4s.ed;1a.rE=1;1a.6P=l.gS.lj;1a.8h=1u;1a.9X=l.gg.7U};g.1n.kq=1m;g.1n.ji=1m;g.1n.ie=1m;g.1n.7M=10;g.1n.c5=1c(G){G.j4();1a.9m=G;1b E=G.PP();1k(1b s=0;s<G.2q.1f;s++){1b t=G.2q[s];t.8b=-1;t.lK=0;t.lM=0;t.iH=0;t.iV=0;t.j2=0;t.j1=0;t.2K=0;t.6K=1u}1k(1b u=0;u<G.2g.1f;u++){1b F=G.2g[u];F.gC=0}1b v=[];1b D=[];1b H=1g n();G.2q.1B(1c(I){if(I.6l.1f==0){v.1h(I);H.2p(I,0);D.1h(I)}});2L(D.1f>0){1b A=D.e6();A.3S.1B(1c(J){1b I=J.1x;if(!H.2c(I)){H.2p(I,H.1G(A)+1)}1l{H.2p(I,1s.1U(H.1G(I),H.1G(A)+1))}if(!o.2c(D,I)){D.1h(I)}})}1b C=0;H.vZ(1c(I){C=1s.1U(C,I)});1b r=[];o.bg(r,H.OR());r.5q(1c(L,K){1b J=H.1G(L);1b I=H.1G(K);if(J<I){1d 1}if(J>I){1d-1}1d 0});1k(1b s=0;s<r.1f;++s){1b t=r[s];1b z=3W.5s;if(t.3S.1f==0){2t}1k(1b u=0;u<t.3S.1f;++u){1b F=t.3S[u];z=1s.2b(z,H.1G(F.1x))}if(z>1){H.2p(t,z-1)}}1a.2z=[];1k(1b w=0;w<C+1;w++){1a.2z.1h([])}H.1B(1c(J,I){J.8b=I;1a.2z[I].1h(J)},1a);1k(1b u=0;u<1a.2z.1f;u++){1b B=1a.2z[u];1k(1b w=0;w<B.1f;w++){B[w].2K=w}}1a.O6();1a.MM();1a.N5();1a.NY();1a.Pp();1a.ML();E.1B(1c(I){if(I.1r){I.1r.bh()}})};g.1n.mU=1c(r,v,t){1b s=r.8b;1b u=r.7L;1a.iM[s][u]=t};g.1n.8a=1c(s,r){1b u=s.8b;1b v=s.7L;1b t=r.7L;1b w=1s.2b(v,t);1b B=1s.1U(v,t);1b A=0;1k(1b z=w;z<B;++z){A+=1a.iM[u][z]}1d A};g.1n.Oz=1c(){1b s={6T:1j};1b r=1a.wG(s,1);1a.na=s.6T;1d r};g.1n.OC=1c(){1b s={6T:1j};1b r=1a.wG(s,-1);1a.nb=s.6T;1d r};g.1n.wG=1c(B,C){1b r=B.6T=1g n();1b w=0;1k(1b v=0;v<1a.2z.1f;++v){w=v;1b A=1a.2z[v];1k(1b s=C==1?0:A.1f-1;0<=s&&s<A.1f;s+=C){1b t=A[s];if(!r.2c(t)){r.2p(t,w);if(t.6K){1a.vo(t).1B(1c(D){r.2p(D,w)})}}1l{w=r.1G(t)}}}1b u=[];1k(1b z=0;z<1a.2z.1f;z++){u.1h(1j)}r.1B(1c(E,D){if(u[D]===1j){u[D]=[]}u[D].1h(E)});1d u};g.1n.QC=1c(u){1b v=1g n();1k(1b C=0;C<1a.2z.1f;++C){1b z=u[C];if(z==1j){2t}1k(1b s=0;s<z.1f;s++){1b t=z[s];if(!v.2c(t)){1a.wd(t,v,C)}}1b B=3W.qW;1k(1b s=0;s<z.1f;s++){1b t=z[s];1b w=1a.vW(t);if(w!=1j&&1a.na.1G(w)!=C){B=1s.2b(B,v.1G(w)-v.1G(t)-1a.8a(t,w))}}if(B==3W.qW){1b r=[];1k(1b s=0;s<z.1f;s++){1b t=z[s];1b F=[];o.bg(F,1a.ee.1G(t));o.bg(F,1a.bH.1G(t));1k(1b A=0;A<F.1f;A++){1b E=F[A];if(1a.na.1G(E)<C){r.1h(v.1G(E)-v.1G(t))}}}r.5q();if(r.1f==0){B=0}1l{if(r.1f%2==1){B=r[j(r.1f,2)]}1l{B=(r[j(r.1f,2)-1]+r[j(r.1f,2)])/2}}}1k(1b s=0;s<z.1f;s++){1b t=z[s];v.2p(t,v.1G(t)+B)}}1d v};g.1n.QJ=1c(C){1b z=1g n();1k(1b B=0;B<1a.2z.1f;++B){1b v=C[B];if(v==1j){2t}1k(1b t=0;t<v.1f;t++){1b u=v[t];if(!z.2c(u)){1a.vS(u,z,B)}}1b A=3W.qC;1k(1b t=0;t<v.1f;t++){1b u=v[t];1b s=1a.vY(u);if(s!=1j&&1a.nb.1G(s)!=B){A=1s.1U(A,z.1G(s)-z.1G(u)+1a.8a(s,u))}}if(A==3W.qC){1b r=[];1k(1b t=0;t<v.1f;t++){1b u=v[t];1b F=[];o.bg(F,1a.ee.1G(u));o.bg(F,1a.bH.1G(u));1k(1b w=0;w<F.1f;w++){1b E=F[w];if(1a.nb.1G(E)<B){r.1h(z.1G(u)-z.1G(E))}}}r.5q();if(r.1f==0){A=0}1l{if(r.1f%2==1){A=r[j(r.1f,2)]}1l{A=(r[j(r.1f,2)-1]+r[j(r.1f,2)])/2}}}1k(1b t=0;t<v.1f;t++){1b u=v[t];z.2p(u,z.1G(u)+A)}}1d z};g.1n.Pp=1c(){1k(1b K=0;K<1a.2z.1f;++K){1b S=1a.2z[K];S.5q(c)}1a.iM=[];1k(1b K=0;K<1a.2z.1f;++K){1b S=1a.2z[K];1a.iM[K]=[];1k(1b F=0;F<S.1f;++F){1b H=S[F];H.7L=F;1a.iM[K][F]=1a.3X;if(F<S.1f-1){if(1a.4z%2==0){1a.iM[K][F]+=(H.1q+S[F+1].1q)/2}1l{1a.iM[K][F]+=(H.1p+S[F+1].1p)/2}}}}1a.bH=1g n();1a.ee=1g n();1a.9m.2q.1B(1c(u){1a.bH.2p(u,[]);1a.ee.2p(u,[])},1a);1a.9m.2g.1B(1c(V){1b T=V.1E;1b U=V.1x;1b W=1j,u=1j;if(T.8b>U.8b){W=V.1E;u=V.1x}1l{u=V.1E;W=V.1x}1a.bH.1G(u).1h(W);1a.ee.1G(W).1h(u)},1a);1a.bH.vZ(1c(u){u.5q(c)});1a.ee.vZ(1c(u){u.5q(c)});1k(1b K=0;K<1a.2z.1f-1;++K){1b S=1a.2z[K];1k(1b A=0;A<S.1f-1;A++){1b r=S[A];if(!r.6K){2t}1b Q=1a.bH.1G(r)[0];if(!Q.6K){2t}1k(1b F=A+1;F<S.1f;++F){1b H=S[F];if(!H.6K){2t}1b I=1a.bH.1G(H)[0];if(!I.6K){2t}if(Q.2K>I.2K){1b v=Q.2K;Q.2K=I.2K;I.2K=v;1b J=Q.7L;1b G=I.7L;1a.2z[K+1][J]=I;1a.2z[K+1][G]=Q;Q.7L=G;I.7L=J}}}}1b B=1a.Oz();1b t=1a.OC();1b E=1a.QC(B);1b O=1a.QJ(t);1b w=1g n();1a.9m.2q.1B(1c(u){w.2p(u,(E.1G(u)+O.1G(u))/2)});1b L=1g n();1b P=1g n();1k(1b K=0;K<1a.2z.1f;++K){1b S=1a.2z[K];1b N=-1,s=-1;1k(1b F=0;F<S.1f;++F){1b H=S[F];L.2p(H,0);P.2p(H,1u);if(H.6K){if(N==-1){N=F}1l{if(N==F-1){N=F}1l{s=F;L.2p(S[N],0);if(w.1G(H)-w.1G(S[N])==1a.8a(S[N],H)){P.2p(S[N],1m)}1l{P.2p(S[N],1u)}N=F}}}}}1b z=[1,-1];o.1B(z,1c(aa){1b u=aa==1?0:1a.2z.1f-1;1b W=aa==1?1a.2z.1f-1:0;1k(1b U=u;0<=U&&U<1a.2z.1f;U+=aa){1b Y=1a.2z[U];1b ab=e(Y);1b Z=1j;1b V=1j;if(ab!=-1){Z=Y[ab];V=[];1k(1b X=0;X<ab;X++){V.1h(Y[X])}}1l{Z=1j;V=Y}if(V.1f>0){1a.lf(w,1j,Z,aa,V);1k(1b X=0;X<V.1f-1;++X){1a.mU(V[X],V[X+1],w.1G(V[X+1])-w.1G(V[X]))}if(Z!=1j){1a.mU(V[V.1f-1],Z,w.1G(Z)-w.1G(V[V.1f-1]))}}2L(Z!=1j){1b ac=h(Y,Z);if(ac==1j){ab=Z.7L;V=[];1k(1b X=ab+1;X<Y.1f;X++){V.1h(Y[X])}if(V.1f>0){1a.lf(w,Z,1j,aa,V);1k(1b X=0;X<V.1f-1;++X){1a.mU(V[X],V[X+1],w.1G(V[X+1])-w.1G(V[X]))}1a.mU(Z,V[0],w.1G(V[0])-w.1G(Z))}}1l{if(L.1G(Z)==aa){ab=Z.7L;1b T=ac.7L;V=[];1k(1b X=ab+1;X<T;X++){V.1h(Y[X])}if(V.1f>0){1a.lf(w,Z,ac,aa,V)}P.2p(Z,1m)}}Z=ac}1a.Lp(U,aa,L,P)}},1a);1b R=1a.7M;1k(1b M=(1a.4z<2?0:1a.2z.1f-1);1a.4z<2?M<1a.2z.1f:M>=0;M+=(1a.4z<2?1:-1)){1b S=1a.2z[M];1b D=3W.UK;1k(1b F=0;F<S.1f;++F){1b H=S[F];if(1a.4z%2==0){D=1s.1U(D,H.1p)}1l{D=1s.1U(D,H.1q)}}1k(1b F=0;F<S.1f;++F){1b H=S[F];1b C=H.2K;if(1a.4z%2==0){H.x=w.1G(H);H.y=R+D/2}1l{H.x=R+D/2;H.y=w.1G(H)}}R+=1a.rB+D}};g.1n.Lp=1c(D,J,F,I){if(D+J<0||D+J>=1a.2z.1f){1d}1b u=1j,H=1j;1b K=1a.2z[D+J];1k(1b A=0;A<K.1f;++A){1b v=K[A];if(v.6K){1b z=1a.Lz(v,D);if(z.6K){if(u!=1j){1b w=I.1G(H);1b t=1a.2z[D];1b C=H.7L;1b B=z.7L;1k(1b G=C+1;G<B;++G){if(t[G].6K){w=w&&I.1G(t[G])}}if(w){F.2p(u,J);1b s=u.7L;1b r=v.7L;1k(1b E=s+1;E<r;++E){if(K[E].6K){F.2p(K[E],J)}}}}u=v;H=z}}}};g.1n.Lz=1c(s,r){1b t=1a.ee.1G(s)[0];if(t.8b==r){1d t}t=1a.bH.1G(s)[0];if(t.8b==r){1d t}1d 1j};g.1n.lf=1c(s,B,z,u,A){if(A.1f==1){1a.Lg(s,B,z,u,A[0])}if(A.1f>1){1b w=A.1f,v=j(w,2);1a.lf(s,B,z,u,A.6t(0,v));1a.lf(s,B,z,u,A.6t(v));1a.Lm(s,B,z,u,A)}};g.1n.Lg=1c(r,z,v,s,u){1b t=s==-1?1a.bH.1G(u):1a.ee.1G(u);1b w=t.1f;if(w!=0){if(w%2==1){r.2p(u,r.1G(t[j(w,2)]))}1l{r.2p(u,(r.1G(t[j(w,2)-1])+r.1G(t[j(w,2)]))/2)}if(z!=1j){r.2p(u,1s.1U(r.1G(u),r.1G(z)+1a.8a(z,u)))}if(v!=1j){r.2p(u,1s.2b(r.1G(u),r.1G(v)-1a.8a(u,v)))}}};g.1n.Lm=1c(B,v,s,G,A){1b E=A.1f,D=j(E,2);1b u=[];1k(1b L=0;L<D;++L){1b M=0;1b J=G==-1?1a.bH.1G(A[L]):1a.ee.1G(A[L]);1k(1b I=0;I<J.1f;++I){1b z=J[I];if(B.1G(z)>=B.1G(A[L])){M++}1l{M--;u.1h({k:B.1G(z)+1a.8a(A[L],A[D-1]),v:2})}}u.1h({k:B.1G(A[L])+1a.8a(A[L],A[D-1]),v:M})}if(v!=1j){u.1h({k:B.1G(v)+1a.8a(v,A[D-1]),v:3W.5s})}u.5q(d);1b F=[];1k(1b L=D;L<E;++L){1b M=0;1b J=G==-1?1a.bH.1G(A[L]):1a.ee.1G(A[L]);1k(1b I=0;I<J.1f;++I){1b z=J[I];if(B.1G(z)<=B.1G(A[L])){M++}1l{M--;F.1h({k:B.1G(z)-1a.8a(A[L],A[D]),v:2})}}F.1h({k:B.1G(A[L])-1a.8a(A[L],A[D]),v:M})}if(s!=1j){F.1h({k:B.1G(s)-1a.8a(s,A[D]),v:3W.5s})}F.5q(b);1b w=0,C=0;1b K=1a.8a(A[D-1],A[D]);2L(B.1G(A[D])-B.1G(A[D-1])<K){if(w<C){if(u.1f==0){B.2p(A[D-1],B.1G(A[D])-K);1Q}1l{1b H=u.e6();w=w+H.v;B.2p(A[D-1],H.k);B.2p(A[D-1],1s.1U(B.1G(A[D-1]),B.1G(A[D])-K))}}1l{if(F.1f==0){B.2p(A[D],B.1G(A[D-1])+K);1Q}1l{1b H=F.e6();C=C+H.v;B.2p(A[D],H.k);B.2p(A[D],1s.2b(B.1G(A[D]),B.1G(A[D-1])+K))}}}1k(1b L=D-2;L>=0;L--){B.2p(A[L],1s.2b(B.1G(A[L]),B.1G(A[D-1])-1a.8a(A[L],A[D-1])))}1k(1b L=D+1;L<E;L++){B.2p(A[L],1s.1U(B.1G(A[L]),B.1G(A[D])+1a.8a(A[L],A[D])))}};g.1n.wd=1c(s,r,t){1b u=3W.qC;1a.L(s).1B(1c(z){1b w=1a.vY(z);if(w!=1j&&1a.na.1G(w)==1a.na.1G(z)){if(!r.2c(w)){1a.wd(w,r,t)}u=1s.1U(u,r.1G(w)+1a.8a(w,z))}},1a);if(u==3W.qC){u=0}1a.L(s).1B(1c(w){r.2p(w,u)})};g.1n.vS=1c(t,s,r){1b u=3W.qW;1a.L(t).1B(1c(w){1b z=1a.vW(w);if(z!=1j&&1a.nb.1G(z)==1a.nb.1G(w)){if(!s.2c(z)){1a.vS(z,s,r)}u=1s.2b(u,s.1G(z)-1a.8a(w,z))}},1a);if(u==3W.qW){u=0}1a.L(t).1B(1c(w){s.2p(w,u)})};g.1n.vY=1c(t){1b s=1a.2z[t.8b];1b r=t.7L;if(r==0){1d 1j}1d s[r-1]};g.1n.vW=1c(t){1b s=1a.2z[t.8b];1b r=t.7L;if(r==s.1f-1){1d 1j}1d s[r+1]};g.1n.L=1c(r){if(r.6K){1d 1a.vo(r)}1b s=1g o();s.1h(r);1d s};g.1n.NY=1c(){1k(1b r=0;r<1a.2z.1f;r++){1b u=1a.2z[r];1k(1b t=0;t<u.1f;t++){1b z=u[t];z.j2=z.iH;z.j1=z.iV}}1b w=2;1k(1b v=0;v<w;v++){1k(1b s=1a.2z.1f-1;s>=1;s--){1a.wH(1u,s)}1k(1b s=0;s<1a.2z.1f-1;s++){1a.wH(1m,s)}}1b A=3W.5s;1k(1b r=0;r<1a.2z.1f;r++){1b u=1a.2z[r];1k(1b t=0;t<u.1f;t++){1b z=u[t];A=1s.2b(A,z.2K)}}if(A<0){1k(1b r=0;r<1a.2z.1f;r++){1b u=1a.2z[r];1k(1b t=0;t<u.1f;t++){1b z=u[t];z.2K=z.2K-A}}}};g.1n.wH=1c(w,t){1b s;1b u;if(w){u=1a.2z[s=t+1]}1l{u=1a.2z[s=t-1]}1b r=[];1k(1b v=0;v<u.1f;v++){r.1h(u[v])}r.5q(1c(A,z){1b C=(A.j2+A.j1)/2;1b B=(z.j2+z.j1)/2;if(1s.3j(C-B)<0.kP){1d 0}if(C<B){1d 1}1d-1});o.1B(r,1c(C){1b B=C.2K;1b z=f(C);1b A=(C.j2+C.j1)/2;if(1s.3j(B-z)<0.kP){1d}if(1s.3j(B-z)<0.25+0.kP){1d}if(B<z){2L(B<z){if(!1a.wB(C,u,A)){1Q}B=C.2K}}1l{2L(B>z){if(!1a.wp(C,u,A)){1Q}B=C.2K}}},1a);if(s>0){1a.sm(s-1)}if(s<1a.2z.1f-1){1a.so(s+1)}};g.1n.wB=1c(w,v,u){1b t=o.6r(v,w);if(t==v.1f-1){w.2K=w.2K+0.5;1d 1m}1b s=v[t+1];1b r=(s.j2+s.j1)/2;if(s.2K>w.2K+1){w.2K=w.2K+0.5;1d 1m}if(r>u||1s.3j(r-u)<0.kP){1d 1u}if(1a.wB(s,v,u)){w.2K=w.2K+0.5;1d 1m}1d 1u};g.1n.wp=1c(v,t,s){1b r=o.6r(t,v);if(r==0){v.2K=v.2K-0.5;1d 1m}1b w=t[r-1];1b u=(w.j2+w.j1)/2;if(w.2K<v.2K-1){v.2K=v.2K-0.5;1d 1m}if(u>s||1s.3j(u-s)<0.kP){1d 1u}if(1a.wp(w,t,s)){v.2K=v.2K-0.5;1d 1m}1d 1u};g.1n.vK=1c(s,r){1a.vE.2p(s,r);if(!1a.n6.2c(r)){1a.n6.2p(r,1g o())}1a.n6.1G(r).1h(s)};g.1n.vo=1c(r){1d 1a.n6.1G(1a.vE.1G(r))};g.1n.O6=1c(){1a.n6=1g n();1a.vE=1g n();1b s=1a.9m.2g.6t(0);1k(1b G=0;G<s.1f;G++){1b z=s[G];1b E=z.1E;1b K=z.1x;1b J=E.8b;1b A=K.8b;1b u=E.2K;1b B=K.2K;1b w=(B-u)/1s.3j(A-J);1b D=E;if(J-A>1){1k(1b I=J-1;I>A;I--){1b t=1g p();t.x=E.x;t.y=E.y;t.1q=E.1q/100;t.1p=E.1p/100;1b L=1a.2z[I];1b v=(I-A)*w+u;if(v>L.1f){v=L.1f}if(u>=1a.2z[J].1f-1&&B>=1a.2z[A].1f-1){v=L.1f}1l{if(u==0&&B==0){v=0}}t.8b=I;t.lK=0;t.lM=0;t.iH=0;t.iV=0;t.2K=v;t.6K=1m;o.fo(L,v,t);1k(1b C=v+1;C<L.1f;C++){1b F=L[C];F.2K=F.2K+1}1b H=1g k(D,t);H.gC=0;D=t;1a.9m.2q.1h(t);1a.9m.sa(H);t.1y=1a.9m.2q.1f-1;1a.vK(t,z)}z.n5(D);z.gC=J-A-1}if(J-A<-1){1k(1b I=J+1;I<A;I++){1b t=1g p();t.x=E.x;t.y=E.y;t.1q=E.1q/100;t.1p=E.1p/100;1b L=1a.2z[I];1b v=(I-J)*w+u;if(v>L.1f){v=L.1f}if(u>=1a.2z[J].1f-1&&B>=1a.2z[A].1f-1){v=L.1f}1l{if(u==0&&B==0){v=0}}t.8b=I;t.lK=0;t.lM=0;t.iH=0;t.iV=0;t.2K=v;t.6K=1m;v=v&v;o.fo(L,v,t);1k(1b C=v+1;C<L.1f;C++){1b F=L[C];F.2K=F.2K+1}1b H=1g k(D,t);H.gC=0;D=t;1a.9m.2q.1h(t);1a.9m.sa(H);t.1y=1a.9m.2q.1f-1;1a.vK(t,z)}z.n5(D);z.gC=A-J-1}}};g.1n.ML=1c(){1b s=1m;2L(s){s=1u;1k(1b u=0;u<1a.9m.2g.1f;u++){1b z=1a.9m.2g[u];if(z.gC==0){2t}1b A=[];o.fo(A,0,{x:z.1x.x,y:z.1x.y});o.fo(A,0,{x:z.1E.x,y:z.1E.y});1b B=z;1b r=z.gC;1k(1b w=0;w<r;w++){1b t=B.1E;1b v=t.6l[0];o.fo(A,0,{x:v.1E.x,y:v.1E.y});B=v}z.n5(B.1E);z.gC=0;z.1r=A;s=1m;1Q}}};g.1n.MM=1c(){1b s=-1;1b u=3;1b r=0;2L(s!=0){if(r++>u){1Q}s=0;1k(1b t=1a.2z.1f-1;t>=1;t--){s+=1a.vu(1u,t)}1k(1b t=0;t<1a.2z.1f-1;t++){s+=1a.vu(1m,t)}}};g.1n.so=1c(v){if(v==0){1d}1b A=1a.2z[v];1b r=1g q();1b C=1a.2z[v-1];1k(1b u=0;u<C.1f;u++){r.3u(C[u])}1k(1b u=0;u<A.1f;u++){1b s=A[u];1b w=0;1b B=0;1k(1b t=0;t<s.6l.1f;t++){1b z=s.6l[t];if(r.2c(z.1E)){B++;w+=z.1E.2K}}1k(1b t=0;t<s.3S.1f;t++){1b z=s.3S[t];if(r.2c(z.1x)){B++;w+=z.1x.2K}}if(B>0){s.lK=w/B;s.iH=B}1l{s.lK=u;s.iH=0}}};g.1n.sm=1c(u){if(u==1a.2z.1f-1){1d}1b z=1a.2z[u];1b B=1g q();1b C=1a.2z[u+1];1k(1b t=0;t<C.1f;t++){B.3u(C[t])}1k(1b t=0;t<z.1f;t++){1b r=z[t];1b v=0;1b A=0;1k(1b s=0;s<r.6l.1f;s++){1b w=r.6l[s];if(B.2c(w.1E)){A++;v+=w.1E.2K}}1k(1b s=0;s<r.3S.1f;s++){1b w=r.3S[s];if(B.2c(w.1x)){A++;v+=w.1x.2K}}if(A>0){r.lM=v/A;r.iV=A}1l{r.lM=t;r.iV=0}}};g.1n.vu=1c(B,z){1b t;1b A;if(B){A=1a.2z[t=z+1]}1l{A=1a.2z[t=z-1]}1b v=A.6t(0);if(B){1a.so(t)}1l{1a.sm(t)}A.5q(1c(F,E){1b G=f(F);1b D=f(E);if(1s.3j(G-D)<0.kP){if(F.mB()==E.mB()){1d a(F,E)}1l{if(F.mB()<E.mB()){1d 1}}1d-1}1b C=(D-G)*ng;if(C>0){1d-1}1l{if(C<0){1d 1}}1d a(F,E)});1b r=0;1k(1b w=0;w<A.1f;w++){if(A[w]!=v[w]){r++}}if(r>0){1b s=0;1k(1b w=0;w<A.1f;w++){1b u=A[w];u.2K=s++}}1d r};g.1n.N5=1c(){1b E=1a.rE;1b G=0;2L(1m){if(G++>E){1Q}1b K=(G%4<=1);1b I=(G%4==1);1k(1b F=(K?0:1a.2z.1f-1);K?F<=1a.2z.1f-1:F>=0;F+=(K?1:-1)){1b L=1a.2z[F];1b v=1u;1b w=1m;1b A=0;1k(1b D=0;D<L.1f-1;D++){1b B=0;1b C=0;1b t=0;if(w){if(F!=0){B=1a.mA(F-1,F)}if(F!=1a.2z.1f-1){C=1a.mA(F,F+1)}if(K){B*=2}1l{C*=2}t=B+C}1l{t=A}if(t==0){2t}1b s=L[D];1b r=L[D+1];1b z=s.2K;1b H=r.2K;L[D]=r;L[D+1]=s;s.2K=H;r.2K=z;B=0;if(F!=0){B=1a.mA(F-1,F)}C=0;if(F!=1a.2z.1f-1){C=1a.mA(F,F+1)}if(K){B*=2}1l{C*=2}1b J=B+C;1b u=1u;if(I){u=J>=t}1l{u=J>t}if(u){s=L[D];r=L[D+1];z=s.2K;H=r.2K;L[D]=r;L[D+1]=s;s.2K=H;r.2K=z;A=t;w=1u}1l{v=1m;w=1m}}if(v){if(F!=1a.2z.1f-1){1a.so(F+1)}if(F!=0){1a.sm(F-1)}}}}};g.1n.mA=1c(z,t){1b G=0;1b H=1g q();1b R=1a.2z[z];1k(1b L=0;L<R.1f;L++){H.3u(R[L])}1b A=1g q();1b Q=1a.2z[t];1k(1b L=0;L<Q.1f;L++){A.3u(Q[L])}1b v=1g q();1b s=[];1b O=[];H.1B(1c(S){o.bg(O,S.6l);o.bg(O,S.3S)});1k(1b u=0;u<O.1f;u++){1b w=O[u];if(H.2c(w.1E)&&A.2c(w.1x)){v.3u(w);s.1h(w)}1l{if(A.2c(w.1E)&&H.2c(w.1x)){s.1h(w)}}}1k(1b K=0;K<s.1f;K++){1b F=s[K];1k(1b J=0;J<s.1f;J++){if(K==J){2t}1b D=s[J];1b C,B;1b N,M;if(v.2c(F)){C=F.1E;B=F.1x}1l{C=F.1x;B=F.1E}if(v.2c(D)){N=D.1E;M=D.1x}1l{N=D.1x;M=D.1E}1b P=C.2K;1b E=B.2K;1b r=N.2K;1b I=M.2K;if((P-r)*(E-I)<0){G++}}}1d G/2};1c f(v){1b u=v.iH;1b r=v.iV;1b t=v.lK;1b s=v.lM;if(u>0&&r>0){1d(t+s)/2}if(u>0){1d t}if(r>0){1d s}1d 0}1c c(r,s){if(r.2K<s.2K){1d-1}if(r.2K>s.2K){1d 1}1d 0}1c b(r,s){if(r.k<s.k){1d-1}if(r.k>s.k){1d 1}1d 0}1c d(r,s){if(r.k<s.k){1d 1}if(r.k>s.k){1d-1}1d 0}1c e(r){1k(1b s=0;s<r.1f;s++){if(r[s].6K){1d s}}1d-1}1c a(u,t){1b s=u.1y;1b r=t.1y;if(s<r){1d 1}if(s>r){1d-1}1d 0}1c j(r,s){1d(r-r%s)/s}1c h(s,t){1b u=t.7L;1k(1b r=u+1;r<s.1f;++r){if(s[r].6K){1d s[r]}}1d 1j}g.bi=1c(){if(!fi){fi=1g 1e.5b(g.1n)}1l{fi.5c(1j)}1d fi};g.1n.8v=1c(){if(!fi){fi=1g 1e.5b(g.1n,1j,1a)}1l{fi.5c(1a)}1d fi};g.1n.aA=1c(){1d 1a.4L.8s};fi=1j;g.1n.rO=1c(){1d 1a.3X};g.1n.rD=1c(r){1a.3X=r};g.1n.Vm=1c(){1d 1a.rB};g.1n.VC=1c(r){1a.rB=r};g.1n.yG=1c(){1d 1a.4z};g.1n.yI=1c(r){1a.4z=r};g.1n.Vw=1c(){1d 1a.rE};g.1n.Vv=1c(r){1a.rE=r};g.1n.mE=1c(){1d 1a.6P};g.1n.mD=1c(r){1a.6P=r};g.1n.mv=1c(){1d 1a.8h};g.1n.mu=1c(r){1a.8h=r};g.1n.s5=1c(){1d 1a.9X};g.1n.rT=1c(r){1a.9X=r};1e.1Z(g,"1e.3N.MX")})(1e.3N);1e.1i.gD=1c(a){1o.2u(1e.1i.gD,1a);1a.1H=a};1e.1i.gD.1n={6H:1c(a){},5R:1c(a){},6j:1c(a){},5z:1c(){},zf:1c(){1d 1m}};1e.1Z(1e.1i.gD,"1e.1i.gD");1e.1i.hw=1c(a,g,d,f,e,b,c){1a.x=(a)?a:0;1a.y=(g)?g:0;1a.fb=(d!=1v)?d:1m;1a.fe=(f!=1v)?f:1m;1a.hj=(e!==1v)?e:1e.1i.d8.jX;1a.3s=(b)?b:"#4T";1a.jG=-1;1a.3x=1j;1a.cE=(c)?c:3};1e.1i.hw.1n={2k:1c(){1d{x:1a.x,y:1a.y,fb:1a.fb,fe:1a.fe,hj:1a.hj,3s:1a.3s,3y:1a.jG,3x:1a.3x,cE:1a.cE}},2E:1c(a){1a.NU(a.x);1a.NT(a.y);1a.NN(a.fb);1a.NP(a.fe);1a.NR(a.hj);1a.O4(a.3s);1a.NO(a.3y);1a.cC(a.3x);1a.O0(a.cE)},4E:1c(b,a){a.3O(1a.fb,"KO",b);a.3O(1a.fe,"KR",b);a.dC(1a.3s,"i0",b);a.3m(1a.jG,"q6",b);a.3m(1a.hj,"d8",b);a.nZ(1a,1a.3x,"jB",b);a.aW(1a.mw,"V1",b);a.4W(1a.x,"X",b);a.4W(1a.y,"Y",b)},V0:1c(a){1d 1g 5k(a.x+a.1q*1a.x/100,a.y+a.1p*1a.y/100)},Jx:1c(){1d 1a.x},NU:1c(a){1a.x=a},Jl:1c(){1d 1a.y},NT:1c(a){1a.y=a},6c:1c(){1d 1a.jG},NO:1c(a){1a.jG=a},Kz:1c(){1d 1a.fb},NN:1c(a){1a.fb=a},KA:1c(){1d 1a.fe},NP:1c(a){1a.fe=a},Jw:1c(){1d 1a.hj},NR:1c(a){1a.hj=a},K0:1c(){1d 1a.3s},O4:1c(a){1a.3s=a},g1:1c(){1d 1a.3x},cC:1c(a){1a.3x=a},UT:1c(){1d 1a.mw},Vd:1c(a){if(1a.mw!=a){if(a==1j){1a.mw=""}1l{1a.mw=a}}},h1:1c(){1d 1a.cE},O0:1c(a){1a.cE=a},Vg:1c(c,b,h,a,e){1b j=b.x+b.1q*1a.x/100;1b g=b.y+b.1p*1a.y/100;1b f=e/2}};1e.1Z(1e.1i.hw,"1e.1i.hw");(1c(a){1b d=1e.1z.5t;1b b=1e.1z.2O;1b c=a.eU=1c(e){1o.2u(c,1a);1a.1C=e};c.1n={8T:1c(){},8r:1c(e){},ii:1c(e){},lJ:1c(e){1d 1u},6H:1c(e){},5R:1c(e){},6j:1c(e){},6X:1c(){},bP:1c(e){}};1e.1Z(c,"1e.1i.eU",1e.1z.jc)})(1e.1i);1e.1i.Vf={yg:0,NJ:1,Nv:2,NL:3,Ve:4,NC:5,Nt:6,NK:7,Nu:8,ce:9,tp:10,9j:11};1e.1i.cH={4H:0,Au:1,V7:2,V6:3,yg:4,Nt:5,Nv:6,Nu:7,NJ:8,NK:9,NL:10,NC:11};1e.1i.3q={c0:0,4H:1,ek:2};1e.1i.io={4D:0,Cp:1,BY:2};1e.1i.6G={4D:0,tv:1,Kk:2,KW:4,KX:8,wj:16,wE:32,ww:64,wA:Va,cO:FN,ce:V9,HT:V8};1e.1i.ud={7q:0,Gx:1,Gy:2,ya:3,GB:4,GA:5,GH:8,iN:9,G0:10,G1:11,ff:12,G4:15,FZ:16,G2:17,FX:23,FV:24,Gd:25,G5:26};1e.1i.3z={4D:0,4Y:1,7q:2,SY:3};1e.1i.m9={Bu:0,BA:1};1e.1i.q4={4D:0,EL:1,xe:2};1e.1i.d8={4D:0,jX:1,X:2,aJ:3,6h:4};1e.1i.o2={JQ:0,SX:1,p4:2,JX:4};1e.1i.QN={hv:0,SW:1,SV:2};1e.1i.hO={Ci:0,l3:1};1e.1i.4q={7e:0,ja:1,a5:2,SU:3};1e.1i.Qm={z5:0,z6:1,sX:2};1e.1i.LF={Lh:0,Lw:1,Aq:2};1e.1i.iQ={l4:0,k4:1,Tb:2};1e.1i.Kg={DY:0,KP:1,KM:2,JI:3};1e.1i.fI={OS:0,md:1,OZ:2,OX:3,va:4,OY:5,vR:6,mg:7,ly:8,OT:9,iN:10,wz:11,vU:12,vX:13};1e.1i.eT={ds:0,vg:1,Ta:2};1e.1i.zm={PQ:0,Pw:1};1e.1i.jd={4D:0,QO:1,FB:2};1e.1i.eM={4D:0,ff:1,gF:2,xl:3,q8:4};1e.1i.bn={4D:0,ff:1,z9:2,gF:4,yi:8,q8:16};1e.1i.ey={4H:0,ce:1,yT:2,Kv:3,Ku:4,I8:5};1e.1i.vj={4D:0,QL:1,Te:2};1e.1i.dt={6h:0,ln:1};1e.1i.bd={p4:0,7U:1,vc:2};1e.1i.uS={JH:0,xT:1};(1c(a){1b b=a.q9=1c(d,c){1o.2u(b,1a,[d]);1a.my=c};b.1n={6H:1c(d){1b f=a.1A.7t(d,1a.1H.2e());1b c=1a.1H.7B(f);1a.my.6H(c)},5R:1c(d){1b f=a.1A.7t(d,1a.1H.2e());1b c=1a.1H.7B(f);1a.my.5R(c);1a.1H.1F()},6j:1c(d){1b f=a.1A.7t(d,1a.1H.2e());1b c=1a.1H.7B(f);1a.my.6j(c)},5z:1c(){1a.my.6X()}};1e.1Z(b,"1e.1i.q9",a.gD)})(1e.1i);(1c(c){1b a=1e.1i.hw;1b d=1e.1i.d8;1b b=c.fa=1c(f,e){1a.1r=(f)?f:[];1a.M3=-1;if(e!=1v){1a.y8(e)}1a.vq=1u};b.1n={2k:1c(){1b e={id:1a.eH};if(!e.id||e.id==""||!1a.vq){e.1r=1a.Mr()}1d e},Mr:1c(){1b f=[];1b k=0;1k(1b j=0,g=1a.1r.1f;j<g;j++){1b e=1a.1r[j];e.7Z=k++;1b h=e.2k();f.1h(h)}1d f},2E:1c(g){1b h=[];1k(1b f=0;f<g.1r.1f;f++){if(g.1r[f]){1b e=1g a();e.2E(g.1r[f]);1a.1r.1h(e)}}},y8:1c(e){if(b.iI.2c(e)){4R 1g T4("eS fa bB T3 T8 be T7.")}1a.eH=e;b.iI.2p(1a.eH,1a)},T6:1c(e,f,h){if(1a.1r==1j){1d 1u}1k(i=0;i<1a.1r.1f;++i){1b g=1a.1r[i];if(e){if(g.fe()&&f.ME(1j,1m,i,h)){1d 1m}}1l{if(g.fb()&&f.ME(1j,1u,i,h)){1d 1m}}}1d 1u},SA:1c(e){if(1a.eH!=""){1d}if(b.iI.2c(e)){1d}1a.y8(e)},3F:1c(g){1a.1r=[];1k(1b f=0;f<g.1r.1f;f++){1b e=g.1r[f];1a.1r.3u(e.1J())}},Sz:1c(){1d 1a.M3},oQ:1c(e){1a.1r=e},hM:1c(){1d 1a.1r},pg:1c(){1d 1a.eH},SC:1c(){if(b.iI.2c(1a.eH)){1d 1m}1d 1u}};b.iI=1g 1e.2T.8u();b.SB=1g b([1g a(50,0,1m,1u,d.aJ,"6O"),1g a(0,50,1m,1u,d.aJ,"6O"),1g a(50,100,1u,1m,d.6h,"7R"),1g a(100,50,1u,1m,d.6h,"7P")],"Su");b.St=1g b([1g a(50,0,1m,1u,d.aJ,"6O"),1g a(0,50,1u,1m,d.6h,"7P"),1g a(50,100,1u,1m,d.6h,"7R"),1g a(100,50,1u,1m,d.6h,"7P")],"Ss");b.Sx=1g b([1g a(0,50,1m,1u,d.aJ,"6O"),1g a(100,50,1u,1m,d.6h,"6O")],"Sw");b.SP=1g b([1g a(50,0,1m,1u,d.aJ,"6O"),1g a(50,100,1u,1m,d.6h,"7R")],"SO");b.1I=1c(e){if(b.iI.2c(e)){1d b.iI.1G(e)}};1e.1Z(b,"1e.1i.fa")})(1e.1i);(1c(a){1b c=1e.1z.5t;1b d=1e.bf.aV;1b b=a.ei=1c(e){1o.2u(b,1a);1a.6u=1j;1a.cf=1j;1a.mM=1j;1a.1H=e;1a.6o=d.cO};b.1n={6H:1c(f){if(1a.cf==1j){1b g=a.1A.7t(f,1a.1H.2e());1a.cf=1a.1H.7B(g);1a.mM=f.5S;1d 1m}1d 1u},5R:1c(g){if(1a.cf==1j){1d}1b k=a.1A.7t(g,1a.1H.2e());1b j=1a.1H.7B(k);1b h=c.3h(1a.1H.2o);1b f=1a.6u;if(f==1j&&(j.5E(1a.cf)>h)){1a.1H.un();f=1a.mQ(1a.cf,g);if(f!=1j){1a.6u=f;f.tz()}1l{1a.1H.uP()}}if(f!=1j){f.kb(j);1a.1H.2e().1P.ez=f.wk(j)?1a.6o:d.SN;if(f.dN()){1a.6o=d.tp;1a.6X();1d}}},6j:1c(h){1b f=1a.1H;1b o=a.1A.7t(h,f.2e());1b n=f.7B(o);1b l=c.3h(f.2o);if(1a.6u!=1j){1b k=1a.mM!=h.5S&&f.gZ(h.5S,a.bn.z9);if(k||!1a.6u.wk(n)){1a.6u.6X(f);f.uP()}1l{1a.6u.Ol(n);if(f.bw!=a.jd.4D){f.sJ(1a.6u.4B)}f.xA(1a.6u.4B,n);f.iz()}1a.6u=1j}1l{if(1a.cf!=1j){if(n.5E(1a.cf)<l){if(f.pp(h)){1a.cf=1j;1d}1b g=f.f4(1a.cf,1m,1m);1b j=1a.1H.iZ.k5(a.eM.gF,h);if(h.5S==0||f.gZ(h.5S,a.bn.gF)){if(!(j)||!f.3i.w9){if(!f.3i.w8(g)){f.3i.n9()}}}if(g!=1j){if(h.5S==0||f.gZ(h.5S,a.bn.gF)){if(j&&g.d9()){f.3i.c3(g)}1l{f.3i.54(g)}}}}}}1a.cf=1j},mQ:1c(f,l){1b j=1a.1H;1b h=1u;if(!j.gZ(1a.mM,a.bn.yi)){if(!j.gZ(1a.mM,a.bn.gF)){1d 1j}h=1m}if((l.5S==0&&j.iZ.k5(a.eM.gF,l))||h){1d 1g a.9Q(j.3i,a.3z.4Y,1j,f)}1b k=1j;if(j.3i.1R.1f>1){1b n=j.3i.8c(f);if(n){k=j.3i;1d 1g a.9Q(k,a.3z.7q,n,f)}}1b n=j.hG(f);k=j.8M;if(k&&n==1j){n=k.8c(f)}if(k&&n!=1j&&n.2w==k){1b g=j.iZ.k5(a.eM.xl,l);if(!g){1d 1g a.9Q(k,a.3z.7q,n,f)}}k=j.9e;if(k&&n!=1j&&n.2w==k){j.3i.qK();j.3i.54(k);j.m0(1j);1d 1g a.9Q(k,a.3z.7q,n,f)}1d 1a.iq(f)},t6:1c(f,e){1b g=1g a.3G(1a.1H,f,e);g.2r.ny(e);1d g},k9:1c(e,n){1b j=n.1y;1b h=1o.1Y(a.2Z,n.2w)?n.2w:1j;if(h==1j||j==8||1o.1Y(a.eQ,n)){1d 1a.bp(d.cO)}if(j==9){1d 1a.bp(d.ce)}if(h.9u()!=0){1b f=0,g=0;1b l=aY/16;1b k=1e.cd.ys(h.5C(),e);k.a=1e.cd.SG(k.a);f=5v((aY-k.a)%aY);if(f>=1*l&&f<3*l){1a.6o=d.gc}1l{if(f>=3*l&&f<5*l){1a.6o=d.dH}1l{if(f>=5*l&&f<7*l){1a.6o=d.ga}1l{if(f>=7*l&&f<9*l){1a.6o=d.dF}1l{if(f>=9*l&&f<11*l){1a.6o=d.gc}1l{if(f>=11*l&&f<13*l){1a.6o=d.dH}1l{if(f>=13*l&&f<15*l){1a.6o=d.ga}1l{1a.6o=d.dF}}}}}}}}1l{if(j==0||j==2){1a.6o=d.gc}if(j==1||j==3){1a.6o=d.ga}if(j==4||j==6){1a.6o=d.dH}if(j==5||j==7){1a.6o=d.dF}}1d 1a.6o},PA:1c(e){if(e==0||e==2){1d d.gc}if(e==1||e==3){1d d.ga}if(e==4||e==6){1d d.dH}if(e==5||e==7){1d d.dF}1d 1j},bP:1c(e,f){},SF:1c(){1d 1a.6u},SJ:1c(e){1a.6u=e},6X:1c(){if(1a.6u){1a.6u.6X(1a.1H);1a.1H.uP();1a.6u=1j}1a.cf=1j},bp:1c(e){1a.6o=e;1d e},sF:1c(e){if(1a.yD&&e.vk){1d e.vk(1a.1H.eF,1a.1H.8P)}1d e}};1e.1Z(b,"1e.1i.ei",a.gD)})(1e.1i);(1c(b){1b c=1e.1z.2O;1b a=b.v3=1c(e,d){1a.7f=e;1a.5y=d.5y;1a.sg=d.Gq;1a.3y=d.3y;1a.2A=d.2A};a.1n={h2:1c(){1d 1a.5y.6g()},eC:1c(d){if(1a.7f.2f==0){1d 1a.sg}1l{1d b.1A.iK(1a.sg.1J(),1a.7f.2s().4e(),1a.7f.2f)}},gY:1c(d,e){1d 1g b.k3({1C:1a.7f,5y:1a.5y,c9:d,ca:e,3y:1a.3y,2A:1a.2A})},nm:1c(d){1a.5y.6Q(d)},jZ:1c(){1d 1a.7f}};1e.1Z(a,"1e.1i.v3")})(1e.1i);(1c(c){1b e=1e.bf.aV;1b a=1e.1i.hO;1b d=1e.1z.5t;1b b=c.C1=1c(g,f){1o.2u(b,1a,[g]);1a.p7=f;1a.3y=1a.1C.6c(1a.p7);1a.PD=1a.3y.1q;1a.PL=1a.3y.aD==a.l3};b.1n={8r:1c(f){1d 1u},lJ:1c(f){1d 1m},bP:1c(g){if(1a.1C.9u()!=0){1b f=1a.1C.9u();if(f>=-8j&&f<-lP){1d e.gc}1l{if(f>=-lP&&f<-90){1d e.dH}1l{if(f>=-90&&f<-45){1d e.ga}1l{if(f>=-45&&f<0){1d e.dF}1l{if(f>=0&&f<45){1d e.gc}1l{if(f>=45&&f<90){1d e.dH}1l{if(f>=90&&f<lP){1d e.ga}1l{1d e.dF}}}}}}}}1d e.dF},lO:1c(f){if(1a.1C.9u()!=0){1d c.1A.6A(f,1a.1C.1w.4e(),-1a.1C.9u())}1d f.1J()},6H:1c(g){1a.9d=1m;1b f=1a.lO(g);1a.7y=1a.a3=f.x},5R:1c(k){if(!1a.9d){1d}1b h=1a.lO(k);1a.7y=h.x;1b g=1a.1C.3o();if(!1a.7K){if(1s.3j(1a.7y-1a.a3)>=d.3h(g.2o)*2){1a.7K=1m;if(g.9z()){1a.lN=1g c.ul(g,1a.1C,1a.3y)}}}if(1a.7K){if(1a.3y.aD==a.l3){1a.1C.mm(1a.3y,a.Ci)}1b f=1a.3y.1q;1a.1C.jC(1a.3y,1s.1U(d.3h(g.2o),1a.3y.1q+(1a.7y-1a.a3)));1b j={6T:1v};if(!g.Ph(1a.1C,1a.p7,k,0,j)){1a.1C.jC(1a.3y,f)}if(j.6T){1a.6X()}if(f!=1a.3y.1q){1a.a3=1a.7y}}},6j:1c(g){if(1a.7K){1b f=1a.1C.3o();if(f.9z()){f.3H.9S(1a.lN)}f.Po(1a.1C,1a.p7,g,0)}1a.9d=1u;1a.7K=1u},6X:1c(){if(1a.7K){1a.9d=1u;1a.7K=1u;1a.1C.jC(1a.3y,1a.PD);if(1a.PL){1a.3y.mm(a.l3)}1a.lN=1j}}};1e.1Z(b,"1e.1i.C1",c.eU)})(1e.1i);(1c(a){1b b=a.e5=1c(c){1a.1H=c};b.1n={d1:1c(){},9Y:1c(){},9T:1c(){}};1e.1Z(b,"1e.1i.e5")})(1e.1i);(1c(b){1b d=1e.1z.5k;1b a=b.u9=1c(g,f,e){1a.1C=g;1a.2h=f;1a.9W=e;1a.3d={1y:-1,4r:1g 1e.1z.5k(0,0)};1a.3a=1a.4L.8s};a.1n={cx:1c(){if(1a.9W){1a.1C.BG(1a.2h)}1l{1a.1C.Bv(1a.2h)}},cp:1c(){if(1a.9W){1a.1C.Bw(1a.2h)}1l{1a.1C.Bx(1a.2h)}},SH:1c(f){1b e=f.1C;1d(e!=1j&&e===1a.1C)},9H:1c(h){if(h===1v){h=1m}1b e=1a.9W?1a.2h.bq():1a.2h.fF();1b k=1a.1C.2f;if(k!==0){1b g=b.1A.5C(1a.1C.1w);e=b.1A.6A(e,g,-k)}if(h){1b f=b.3V.eq(1a.1C);if(f){1b j=f.2s();1a.a0=b.1A.jo(e,j);1d}}1a.a0=b.1A.jo(e,1a.1C.1w)},ny:1c(e){1a.3d=1a.PR(e);if(!1a.3d){1a.3d=1a.e3(e)}},PR:1c(e){if(!1a.1C.4d){1d 1j}1b f=1a.1C.fD(e,1a.2h,1a.9W);if(f.1y===-1){1d 1j}1d f},e3:1c(e){1b g=1a.1C.e3(e);1b f=b.1A.jo(g,1a.1C.1w);1d{4r:g,6v:f,1y:-1}},mb:1c(e){1a.3d=1a.fD(e,1a.2h,1a.9W)},ug:1c(f,e){1d(1a.1C!==f)},dI:1c(){1d 1a.1C.5C()},iA:1c(e){1d b.2Z.iA(1a.1C,e.1C)},bN:1c(f,e){1d 1a.1C.bN(f,e)},Tf:1c(){1d 1a.1C.1w},o5:1c(){1b f=b.3V.eq(1a.1C);if(f){1b e=b.1A.iB(1a.a0,f.2s());1d e}1d 1a.bq()},bq:1c(){1b e=b.1A.iB(1a.a0,1a.1C.1w);1b g=1a.1C.2f;if(g!==0){1b f=b.1A.5C(1a.1C.1w);e=b.1A.6A(e,f,g)}1d e},TN:1c(e){1d 1a.1C.2M(e)},aA:1c(){1d 1a.3a},fD:1c(e,g,f){1d 1a.1C.fD(e,g,f)},1J:1c(f,e){1b g=e.lL(f,1g d(),1a.9W);if(!1o.1Y(b.9o,e)&&e.4d&&e.4d.1r.1f>1a.3d.1y){g.3d.1y=1a.3d.1y}g.a0=1a.a0;1d g}};1e.1Z(a,"1e.1i.u9");1b c=b.sB=1c(g,f,e){1o.2u(c,1a,[1j,g,f]);1a.4r=e;1a.1C=1a.2h.oC()};c.1n={dI:1c(){1d 1a.4r},fD:1c(e,g,f){1d{1y:0,4r:1a.4r,6v:1a.4r}},e3:1c(e){1d{1y:0,4r:e,6v:e}}};1e.1Z(c,"1e.1i.sB",a)})(1e.1i);(1c(a){1b d=1e.1z.5t;1b c=1e.1z.gE;1b b=1e.1z.2O;1b e=a.yj=1c(f){1o.2u(e,1a,[f]);1a.5D();1a.8T()};e.1n={8T:1c(){1b f=1a.5J();1a.x=f.x;1a.y=f.y},ii:1c(h){1b g=1a.b2();if(!g.2M(h)){1d}1b f=1a.1C;f.1t.nd(f)},8r:1c(f){1d 1a.b2().2M(f)},5J:1c(){1b j=1a.1C;1b k=d.3h(j.1t.2o);1b h=j.1w.1J();1b f=j.hK();1b g=j.cN?j.cN():f+k*2;1d 1g b(f<5*k?h.2y()-2.5*k-f/2:h.2y()-f,h.y+g/2-f/2,f,f)},b2:1c(){1b g=1a.5J();if(1a.1C.2f!=0){1b k=[];k.1h(g.5a());k.1h(g.a7());k.1h(g.9Z());k.1h(g.aR());a.1A.cU(k,a.1A.5C(1a.1C.1w),1a.1C.2f);1b f=1s.2b(k[0].x,1s.2b(k[1].x,1s.2b(k[2].x,k[3].x)));1b l=1s.2b(k[0].y,1s.2b(k[1].y,1s.2b(k[2].y,k[3].y)));1b j=1s.1U(k[0].x,1s.1U(k[1].x,1s.1U(k[2].x,k[3].x)));1b h=1s.1U(k[0].y,1s.1U(k[1].y,1s.1U(k[2].y,k[3].y)));1d b.9N(f,l,j,h)}1d g},5D:1c(){1b j=1a.1C;1b h=j.9R();1b f=j.9k();1b n=d.3h(j.1t.2o);1b g=1a.5J();g.x=g.y=0;1b l=1g c(g.x+n,g.y+n,g.2y()-n,g.2V()-n);l.2j=h;l.2v=f;1a.2H.1h(l);1b k=1g c(g.2y()-n,g.y+n,g.x+n,g.2V()-n);k.2j=h;k.2v=f;1a.2H.1h(k)}};1e.1Z(e,"1e.1i.yj",a.eU)})(1e.1i);(1c(b){1b h=1e.2T.5i;1b t=1e.2T.8u;1b p=1e.1z.8t;1b n=1e.1z.5t;1b u=1e.1z.5k;1b f=1e.1z.2O;1b r=1e.2T.dZ;1b a=1e.1z.TL;1b s=1e.1z.9t;1b l=1e.1z.aX;1b k=1e.bf.aV;1b o=z0;1b d=2;1b q=d*d;1b j=b.4c=1c(w){1o.2u(j,1a,[w]);1a.OB=1g b.vG(1a);1a.nR=1o.nS();1a.6K=1g b.9o(1a);1a.fO=1g 1e.1i.4j.mr(1a);1a.yW=1g bZ();1a.qc=1u;1a.hB=1g u(0,0);1a.nC=1g u(0,0);1a.x4=1g u(0,0);1a.yV=1g u(0,0);1a.pb=1j;1a.HK=1g u(0,0);1a.x7=1g bZ();1a.3T=1m;1a.1R=[];1a.3n=[];1a.3L=[];1a.Ki=20;1a.3i=1g b.fj(1a);1a.8M=1j;1a.hr=b.zm.PQ;1a.9e=1j;1a.ef=1u;1a.6f="";1a.5V="#h4";1a.fd="#h4";1a.ht="#4T";1a.dk="#h4";1a.gV="#4T";1a.dg=b.4q.ja;1a.cl=1m;1a.ma="#h4";1a.dP=2;1a.fW=1m;1a.v7("6h");1a.nw("oh");1a.9h=1j;1a.fE=5;1a.fB=5;1a.hD=b.q4.xe;1a.og=1g b.yB(1a);1a.e4=1u;1a.mO=8;1a.hg=b.o2.p4;1a.hb=1j;1a.9g=1u;1a.bO=1m;1a.iP="#TQ";1a.b5=4;1a.b0=4;1a.jg=b.QN.hv;1a.dX=0;1a.dL=0;1a.tE=1.5;1a.cP=b.cH.yg;1a.y7(b.ud.ya);1a.bI=1u;1a.eK=1m;1a.2I=[];1a.eZ=b.eT.ds;1a.fT=1.5;1a.g4=0;1a.fM=2;1a.bw=b.jd.QO;1a.ct=8;1a.fG=0;1a.fN=1m;1a.mJ=0;1a.nI=0;1a.g2=8;1a.fZ=3W.5s;1a.eF=["6h","uA","nv"];1a.w3("aJ");1a.c7=1u;1a.dh=TP;1a.dp=30;1a.dq=30;1a.cY=1;1a.gM=1m;1a.fJ="8k";1a.dm="uj";1a.g3=b.vj.QL;1a.iZ=1g b.v5();1a.Fb(b.bn.yi);1a.F5(b.bn.4D);1a.EZ(b.bn.z9);1a.3H=1j;1a.97=[];1a.aT=[];1a.G6=1a.Qv();1a.2S(1u)};j.1n={bo:1c(){1o.2a(j,1a,"bo");1b w=1a.2e();1o.5N(w,{jn:1o.3t(1a,1a.5R)});1o.5N(w,{xM:1o.3t(1a,1a.6H)});1o.5N(w,{jr:1o.3t(1a,1a.6j)});1a.z8=1o.3t(1a,1a.jF);1o.5N(w.3C,{nF:1a.z8});w.6b("PB",1o.3t(1a,1a.pV),1u);w.6b("PJ",1o.3t(1a,1a.pS),1u);w.6b("PK",1o.3t(1a,1a.ks),1u);w.6b("PH",1o.3t(1a,1a.ks),1u);1a.jt=1o.3t(1a,1a.nB);1o.5N(4O,{mi:1a.jt});1a.za=1o.3t(1a,1a.H3);1a.Io=1o.3t(1a,1a.Ig);1a.QG();1a.2l(b.1S.dW)},hA:1c(){1a.kc();1o.zj(1a.2e());if(1a.2e()){1o.d3(1a.2e().3C,"nF",1a.z8)}1o.d3(4O,"mi",1a.jt);if(1a.9v){1o.d3(1a.9v,"Ql",1a.za)}1o.2a(j,1a,"hA")},QG:1c(){if(1a.9v){3p.cS.kH(1a.9v)}1a.9v=3p.dj("TG");1a.9v.1P.1q="QQ";1a.9v.1P.1p="QQ";1a.9v.1P.5d="i3";1a.9v.TF=Mb;3p.cS.cL(1a.9v);1o.5N(1a.9v,{Ql:1a.za})},Gk:1c(w){if(1a.9v){1b z=b.1A.xs(w);1a.9v.1P.3M=z.x+"px";1a.9v.1P.3Z=z.y+"px";1a.9v.Ih();w.hV()}},wW:1c(A){1b z=3p.hS(A);if(z){1b w=z.wY;if(w){w.6b("wL",1o.3t(1a,1o.rj(1a.jO,{id:A})))}}},Qv:1c(){1b w=1g t();1c z(A,B,C){w[B]=A;A.i9={ex:B,hQ:C}}z(b.3G,"3b:3G",2);z(b.5m,"3b:5m",1);z(b.cg,"3b:cg",1);z(b.3V,"3b:3V",3);z(b.ix,"3b:ix",2);z(b.aF,"3b:aF",1);z(b.kI,"3b:kI",1);z(b.lo,"3b:lo",1);1d w},TJ:1c(){1d 1a.OB},6b:1c(w,z){1o.nT(1a,w,z)},qk:1c(w,z){1o.d3(1a,w,z)},2l:1c(w,z){1b A=1o.h3(1a,w);if(A!=1j){A(1a,z)}},2F:1c(z,w){if(!w||w==""){1d}1b A=1g nK("7C","7c","1d "+w+"(7C, 7c)");1a.6b(z,A)},TZ:1c(){if(1a.9e!=1j){1a.9e.lm(1a.3R)}1b A=1a.3i.1R;1k(1b w=0;w<A.1f;w++){1b z=A[w];z.lm(1a.3R)}},H5:1c(){1b C=1a.2e();if(1a.gq&&!1a.3k){1o.zj(C.3C);1b E=1o.2s(C.3C);1b A=E.1q;1b D=E.1p;C.3C.1P.zi="";C.1P.5d="i3";C.1P.cj=1;C.1q=1s.2b(A-1a.pz(1),1a.1w.1q*1a.3A);C.1p=1s.2b(D-1a.pz(0),1a.1w.1p*1a.3A);1b z=3p.dj("xQ");z.1P.1q=A+"px";z.1P.1p=D+"px";z.1P.5d="i3";z.1P.zi="nh";1a.3k=z;1b B=3p.dj("xQ");B.1P.5d="i3";1a.OF=B;z.cL(B);C.3C.cL(z);1o.5N(z,{nF:1o.3t(1a,1a.jF)})}1l{if(!1a.gq&&1a.3k){C.1P.cj="";C.1P.5d="";1o.zj(1a.3k);C.3C.1P.zi="nh";C.3C.kH(1a.3k);4m 1a.3k;4m 1a.OF;1o.5N(C.3C,{nF:1o.3t(1a,1a.jF)})}}1a.uu()},HB:1c(){if(1a.3k){1b A=1a.2e();1b C=1o.2s(A.3C);1b z=C.1q;1b B=C.1p;A.1q=1s.2b(z,1a.1w.1q*1a.3A);A.1p=1s.2b(B,1a.1w.1p*1a.3A);1a.3k.1P.1q=z+"px";1a.3k.1P.1p=B+"px";1a.uu()}},jw:1c(w){1a.3T=w},yM:1c(){1d 1a.3T},DL:1c(w){1a.eD=w},DX:1c(){1d 1a.eD},IY:1c(w){1a.hD=w},TY:1c(){1d 1a.hD},tJ:1c(w){if(1a.5V!=w){1a.5V=w;1a.1F();1a.2S(1m)}},Ds:1c(){1d 1a.5V},jI:1c(){if(1a.5V){1d 1a.5V}1b z=1a.8I(b.1X.1n.u5);if(z){1b w=z.Ds();if(w){1d w}}1d"9D"},8I:1c(w){if(1a.1P&&w.3F(1a.1P)){1d 1a.1P}1b A=1a.9y;if(A){1b z=A.3E["3b:4c"];if(z){1d z}}1d 1j},uf:1c(){if(!1a.2I){1a.2I=[]}1d 1a.2I},xZ:1c(){if(1a.2I){1d 1a.2I}1b w=1a.8I(b.1X.1n.ue);if(w){1b z=w.uf();if(z){1d z}}1d[]},v7:1c(w){if(5G w=="bB"){w=b.1D.1I(w)}if(1a.8P!==w){1a.8P=w;1a.2S(1m)}},TX:1c(){1d 1a.8P},U3:1c(w){1a.eF=w},U2:1c(){1d 1a.eF},U1:1c(w){1a.fZ=w},TT:1c(){1d 1a.fZ},TS:1c(w){1a.g2=w},TU:1c(){1d 1a.g2},xn:1c(w){if(1a.fd!==w){1a.fd=w;1a.2S(1m)}},TE:1c(){1d 1a.fd},IX:1c(w){if(1a.ht!==w){1a.ht=w;1a.2S(1m)}},To:1c(){1d 1a.ht},wU:1c(w){if(1a.dk!==w){1a.dk=w;1a.2S(1m)}},Tn:1c(){1d 1a.dk},Ji:1c(w){if(1a.gV!==w){1a.gV=w;1a.2S(1m)}},Tm:1c(){1d 1a.gV},xN:1c(w){if(!w){w=b.4q.7e}if(1a.dg!==w){1a.dg=w;1a.2S(1m)}},Tr:1c(){1d 1a.dg},nw:1c(w){if(5G w=="bB"){w=b.1D.1I(w)}if(1a.9E!==w){1a.9E=w;1a.2S(1m)}},Tq:1c(){1d 1a.9E},v6:1c(w){if(5G w=="bB"){w=b.1D.1I(w)}if(1a.9h!==w){1a.9h=w;1a.2S(1m)}},Tp:1c(){1d 1a.9h},xh:1c(w){if(1a.fE!==w){1a.fE=w;1a.2S(1m)}},Ti:1c(){1d 1a.fE},xf:1c(w){if(1a.fB!==w){1a.fB=w;1a.2S(1m)}},Th:1c(){1d 1a.fB},Tg:1c(w){if(1a.cl!=w){1a.cl=w;1a.2S(1m)}},Tl:1c(){1d 1a.cl},Tk:1c(w){if(1a.cP!=w){1a.cP=w;1a.2S(1m);1a.1F()}},yU:1c(){1d 1a.cP},IQ:1c(w){if(w){if(1a.hp!=w){1a.hp=w;1a.7Q=1g c6();1o.5N(1a.7Q,{kv:1o.3t(1a,1a.eI)});1a.7Q.kk=w;1a.2S(1m)}}1l{1a.hp=w;1a.7Q=1j;1a.2S(1m)}},Tj:1c(){1d 1a.hp},xP:1c(z){if(1a.jb!=z){1a.jb=z;if(z){1a.7Q=1g c6();1a.7Q.1q=100;1a.7Q.1p=100;1b w="7x:3w/LO;BQ,"+1a.jb;1o.5N(1a.7Q,{kv:1o.3t(1a,1a.eI)});1a.7Q.kk=w;1a.2S(1m)}}},TA:1c(){1d 1a.jb},y4:1c(){1d 1a.7Q},LP:1c(){if(1a.7Q){1d 1g 1e.1z.9t(1a.7Q.1q,1a.7Q.1p)}1d 1g 1e.1z.9t(0,0)},eI:1c(){1a.7Q.qb=1m;1a.1F()},jK:1c(z){1b w=h.6r(1a.97,z);if(w==-1){h.3u(1a.97,z)}1d h.6r(1a.97,z)},BI:1c(z){1b w=h.6r(1a.aT,z);if(w==-1){h.3u(1a.aT,z)}1d h.6r(1a.aT,z)},Ok:1c(w){if(1o.1Y(b.2Z,w)){1a.2l(b.1S.t7,1g b.4M({1C:w}))}if(1o.1Y(b.3G,w)){1a.2l(b.1S.uY,1g b.7A({2h:w}))}},xy:1c(w){if(1o.1Y(b.2Z,w)){1a.2l(b.1S.t0,1g b.4M({1C:w}))}if(1o.1Y(b.3G,w)){1a.2l(b.1S.tu,1g b.7A({2h:w}))}},uV:1c(A,z){1b w=z.6R.1J();1b C=1m;1b D=1u;1b B;if(1o.1Y(b.2Z,A)){B=1g b.4M({1C:A,4b:w});1a.2l(b.1S.ub,B)}if(1o.1Y(b.3G,A)){B=1g b.7A({2h:A,4b:w});1a.2l(b.1S.tZ,B)}if(B){C=!B.cc();D=B.dN()}if(D){z.ne();C=1u}1d C},Oq:1c(A,z){1b w=z.6R.1J();1b B=z.3J.1y;1b D=1m;1b E=1u;1b C;if(1o.1Y(b.2Z,A)){C=1g b.4M({1C:A,4b:w,3J:B});1a.2l(b.1S.tI,C)}if(1o.1Y(b.3G,A)){C=1g b.7A({2h:A,4b:w,3J:B});1a.2l(b.1S.uc,C)}if(1o.1Y(b.fj,A)){C=1g b.xC({4b:w,3J:B});1a.2l(b.1S.tQ,C)}if(C){D=!C.cc();E=C.dN()}if(E){z.ne();D=1u}1d D},HR:1c(w){1b A=1m;1b z;if(1o.1Y(b.2Z,w)){z=1g b.4M({1C:w});1a.2l(b.1S.tF,z)}if(1o.1Y(b.3G,w)){z=1g b.7A({2h:w});1a.2l(b.1S.um,z)}if(z){A=!z.cc()}1d A},wF:1c(w,A,z){if(1o.1Y(b.2Z,w)){1a.2l(b.1S.sS,1g b.4M({1C:w,4b:A,3J:z}))}if(1o.1Y(b.3G,w)){1a.2l(b.1S.sM,1g b.7A({2h:w,4b:A,3J:z}))}},Gw:1c(w){1a.2l(b.1S.tW,1g b.4M({1C:w}))},Gz:1c(w){1a.2l(b.1S.tL,1g b.4M({1C:w}))},Pi:1c(){1b w=h.1J(1a.3i.1R);h.1B(w,1c(z){1a.wF(z,1g u(0,0),-1)},1a)},JF:1c(w){if(1o.1Y(b.2Z,w)){1a.2l(b.1S.sZ,1g b.4M({1C:w}))}if(1o.1Y(b.3G,w)){1a.2l(b.1S.tk,1g b.7A({2h:w}))}},os:1c(A,B,w){if(A){1d A.os(B,w)}1l{1b z=1g b.xH({4b:B,6k:w});1a.2l(b.1S.tH,z);1d 1m}},o1:1c(z,A,w){1d z.o1(A,w)},Qc:1c(w){if(1o.1Y(b.2Z,w)){1a.2l(b.1S.i2,1g b.4M({1C:w}))}if(1o.1Y(b.3G,w)){1a.2l(b.1S.tS,1g b.7A({2h:w}))}},w5:1c(w){if(1o.1Y(b.2Z,w)){1a.2l(b.1S.tN,1g b.4M({1C:w}))}if(1o.1Y(b.3G,w)){1a.2l(b.1S.tB,1g b.7A({2h:w}))}},I1:1c(w,A){1b z;if(1o.1Y(b.2Z,w)){z=1g b.4M({1C:w,4b:A})}1l{if(1o.1Y(b.3G,w)){z=1g b.7A({2h:w,4b:A})}}1a.2l(b.1S.ty,z);1d z.xB()},KT:1c(z,w){1b A;if(1o.1Y(b.2Z,z)){A=1g b.4M({1C:z,3R:w})}1l{if(1o.1Y(b.3G,z)){A=1g b.7A({2h:z,3R:w})}}1a.2l(b.1S.lR,A)},JU:1c(z,B){1b w=b.6G.4D;1b A;if(1o.1Y(b.2Z,z)){A=1g b.4M({1C:z,4b:B,3J:w});1a.2l(b.1S.oF,A)}1l{if(1o.1Y(b.3G,z)){A=1g b.7A({2h:z,4b:B,3J:w});1a.2l(b.1S.ow,A)}}},J5:1c(z){1b w=1g b.uq(z);1a.2l(b.1S.Tz,Ty);1d w.a6()},J3:1c(z){1b w=1g b.uq(z);1a.2l(b.1S.wg,w);z.3x=w.g1();1d w.a6()},Ph:1c(C,B,E,z,D){1b w=C.8p(B,0);1b A=1g b.oq({5y:w,6k:z,4b:E,3y:B,2A:-1});1a.2l(b.1S.sV,A);D.6T=A.dN();1d!A.cc()},Po:1c(C,B,D,z){1b w=C.8p(B,0);1b A=1g b.k3({5y:w,6k:z,4b:D,3y:B,2A:-1});1a.2l(b.1S.sK,A)},N6:1c(B,C,E,z,D){1b w=B.8p(0,C);1b A=1g b.oq({5y:w,6k:z,4b:E,3y:-1,2A:C});1a.2l(b.1S.tj,A);D.6T=A.dN();1d!A.cc()},Nl:1c(B,C,D,z){1b w=B.8p(0,C);1b A=1g b.oq({5y:w,6k:z,4b:D,3y:-1,2A:C});1a.2l(b.1S.tn,A)},DN:1c(A,w){1b z=1g b.vd(A,w);1a.2l(b.1S.t2,z);1d!z.cc()},PS:1c(A,w){1b z=1g b.vd(A,w);1a.2l(b.1S.tc,z)},Ft:1c(w){if(1o.1Y(b.2Z,w)){1a.2l(b.1S.tg,1g b.4M({1C:w}))}if(1o.1Y(b.3G,w)){1a.2l(b.1S.t5,1g b.7A({2h:w}))}},jF:1c(){if(1a.5W){1a.pC(1u)}if(1a.9g||1a.3k){1a.5Y()}},5R:1c(z){1b A=b.1A.7t(z,1a.2e());1b w=1a.kL=1a.7B(A);if(!1a.3T){1d}1a.EP();if((1a.hg&b.o2.p4)!=0){1a.Gs(1a.go(w,1m,1m))}if(1a.hr==b.zm.Pw){1a.Gl(w)}if(1a.5x!=1j){1a.Py=1u;if(1a.fN&&1a.5x.zf()){1a.Py=1a.Pq(w,z)}1a.5x.5R(z)}1l{1a.Ez(w,z)}},Pq:1c(A,B){1b z=1a.lH();if(z.1q>1a.ct*2){z=b.1A.5B(z,-1a.ct,0)}if(z.1p>1a.ct*2){z=b.1A.5B(z,0,-1a.ct)}1b w=!b.1A.TD(A,z);if(w){1b D=1a.fG>0?1a.fG:(4*n.3h(1a.2o));1a.mJ=0;1a.nI=0;if(A.x<z.3M()){1a.mJ=-D}if(A.y<z.3Z()){1a.nI=-D}if(A.x>z.2y()){1a.mJ=D}if(A.y>z.2V()){1a.nI=D}1a.zl(B);if(!1a.lF){1b C=1a;1a.lF=TC(1c(){C.zl(B)},100)}}1l{if(1a.lF){1a.t3();1a.1F()}}1d w},t3:1c(){if(1a.lF){TB(1a.lF);4m 1a.lF}},zl:1c(B){1b z=1a.lH();if(1a.3k){z.1q-=1a.pz(0);z.1p-=1a.pz(1)}1b A=1a.gA(),w=1a.gy();if(z.1q<1a.1w.1q){A+=1a.mJ}if(z.1p<1a.1w.1p){w+=1a.nI}1a.yO(A,w,z,1a.1w);if(1a.5x&&1a.5x.6u){1a.5x.6u.kb(1a.kL);if(1a.bw!=b.jd.4D){1a.sJ(1a.5x.6u.4B)}}1a.1F()},Gl:1c(D){1b B=1a.f4(D,1m,1m);if(B==1j&&1a.9e!=1j&&1o.1Y(b.2Z,1a.9e)){1b A=1a.9e;1b w=b.1A.Tx(D,A.1w);1b z=b.1A.GN(D,w);1b C=1a.dP/2+7*n.3h(1a.2o);C*=C;if(z<=C){B=1a.9e}}1a.m0(B)},6H:1c(z){1a.uv=1u;if(1a.8l&&1g bZ()-1a.8l<z0){1d}if(!1a.3T){1d}1b w=1a.2e();1b G=b.1A.7t(z,w);1b D=1a.7B(G);1b A=(1a.5W!=1j)&&1a.kz.2M(D);if(A){1d}1a.pC(1m);1a.Gk(z);if(z.5S==0){1a.hB=D;1b F=1a.nC;1a.nC=G;1a.qc=1a.G7(F)>1;if(1a.qc){1b B=1a.f4(1a.hB,1m,1m);if(B==1j){if(1a.tA()&&1a.fO.DX()){1b C={};1b E=1a.fO.Nx(1a.hB,C);if(E!=1j){E.nk(C.LT);E.HU(C.3y,C.2A);1a.xK(E,1a.hB)}}}1l{if(1a.pb==B){1a.pb=1j;1a.FU(B,1a.hB,z.5S)}}1d}1l{1a.pb=1a.f4(1a.hB,1m,1m)}if(w.Go){w.Go()}}1l{if(z.5S==2){1a.x4=D;1a.yV=G}}if(1o.1Y(b.q9,1a.5x)){1a.5x.5z();1a.5x=1j}1a.5x=1a.mQ(z);if(1a.5x!=1j){1a.5x.6H(z)}},6j:1c(w){1a.uv=1u;1a.t3();if(1a.8l&&1g bZ()-1a.8l<z0){1d}if(3p.Gm){3p.Gm()}1a.p2(w)},p2:1c(w){if(!1a.3T){1d}if(1a.5x!=1j){1a.5x.6j(w);1a.5x=1j}},nn:1c(w){1a.p2(w);1a.yW=1g bZ()},Ts:1c(w){1a.p2(w)},zg:1c(A){1b w=A.5S==0?1a.nC:1a.yV;1b B=b.1A.7t(A,1a.2e());1b z=1g bZ();1d(!1a.qc&&!1a.xk(w,B)&&(z-1a.yW)>o)},pp:1c(A){1b w=A.5S==0?1a.hB:1a.x4;1b z=1a.dr(w);if(z==1j){1b B=1a.f4(w,1m);1a.os(B,w,A.5S)}1d z!=1j},FU:1c(A,w,z){1a.o1(A,w,z);if(1a.eD&&!A.aB()&&A.dr(w)==1j){1a.xK(A,w)}},G7:1c(w){1b z=1g bZ();1b A=1a.xk(w,1a.nC)||(z-1a.x7)>o?1:2;1a.x7=z;1d A},xk:1c(w,z){1d q<b.1A.GN(w,z)},H3:1c(w){if(!1a.3T){1d}if(1a.kA){1d}if(w.pM==46||w.pM==TV||(TW.TR.Eu().6r("TI")>-1&&w.pM==8)){if(1a.5x==1j){if(1a.hD==b.q4.EL){1a.nd(1a.8M)}if(1a.hD==b.q4.xe){1a.yS()}}}},ku:1c(z){1b w=z.k0;1b A={5S:0,pT:w[0].pT,pU:w[0].pU};1d A},pV:1c(z){1a.uG=2.5*n.3h(1a.2o);1b w=z.k0;if(1a.eK&&!1a.5x){1a.8l=1a.ku(z);1a.6H(1a.8l)}1l{if(1a.eK&&1a.5x&&w.1f>1){1a.5x.6j(z);1a.5x=1j}}},pS:1c(z){1b w=z.k0;if(1a.eK&&w.1f==1){1a.8l=1a.ku(z);1a.5R(1a.8l);z.hV()}},ks:1c(w){if(1a.eK){1a.nn(1a.8l);1a.8l=1g bZ()}1a.uG=0},F2:1c(w){w.hV()},mQ:1c(D){1b E=b.1A.7t(D,1a.2e());1b w=1a.7B(E);1b z=1a.dr(w);if(z!=1j){if(z.lJ(w)){1d 1g b.q9(1a,z)}z.ii(w);1d 1j}1b C=1a.3T&&(1a.fA==b.ud.ff||1a.gZ(D.5S,b.bn.ff)||(D.5S==0&&1a.iZ.k5(b.eM.ff,D)));if(C){1d 1g b.pw(1a)}1b A=1a.3T&&(1a.gZ(D.5S,b.bn.q8)||(D.5S==0&&1a.iZ.k5(b.eM.q8,D)));if(A){1d 1g b.v8(1a)}if(D.5S==0&&1a.tA()&&1a.uJ().ej){1b B=1a.wQ(w);if(B){1d 1g 1e.1i.4j.Ek(1a,B.4x,B.eO,B.9q)}}if(1a.3T){1d 1a.5x?1a.5x:1a.5A}1d 1j},wQ:1c(G){1b E=f.7s;1b D=1j;1b B=1u;1b z=1a.uJ();1b C=z.MK(G,E,1g u(0,0));if(C!=1j){1b F=2*n.3h(1a.2o);1b w=E.9q.1J();w.y=w.2V()-F;w.1p=F;1b A=E.9q.1J();A.x=A.2y()-F;A.1q=F;1b D=1j;1b B=1u;if(w.2c(G)){D=C;B=1u}1l{if(A.2c(G)){D=C;B=1m}}if(D!=1j){1d{4x:D,eO:B,9q:E.9q}}}1d 1u},EP:1c(){if(1a.wO){jV(1a.wO)}if(1a.qj){3p.cS.kH(1a.qj);1a.qj=1j}},Ez:1c(w,B){if(1a.F4()){1a.Fc(w)}1b A=1a.2e();1b z=1a.Fx(w);if(z==1e.bf.aV.wR){z=1a.5A.bP(w)}if(A!=1j&&1a.uv!=1m&&z!=1e.bf.aV.wR){A.1P.ez=z}1b D=b.1A.xs(B);1a.KQ=D.x;1a.KL=D.y;1a.K3=w;1b C=1a;1a.wO=j7(1c(){1d C.JT()},1a.dJ);if(1a.c7){1a.TK=j7(1c(){1d C.1F()},100)}},Fx:1c(D){1b C=1e.bf.aV.wR;1k(1b z=1a.1R.1f-1;z>=0;z--){1b A=1a.1R[z];if(!1a.s9(A)){2t}1b w=A.dr(D);if(w!=1j){if(w.lJ(D)){w.5R(D)}C=w.bP(D)}}if(1a.tA()&&1a.uJ().ej){1b B=1a.wQ(D);if(B){if(B.eO){C=k.dF}1l{C=k.dH}}}1d C},gZ:1c(w,A){1b z=b.bn.4D;if(w==0&&1a.3T){z=1a.ut}if(w==1&&1a.3T){z=1a.uH}if(w==2&&1a.3T){z=1a.uK}1d(z&A)!=0},F4:1c(){1d 1o.h3(1a,"oF")||1o.h3(1a,"ow")},Fc:1c(z){if(1a.iG){jV(1a.iG);4m 1a.iG}1b w=1a;1a.iG=j7(1c(){1d w.EJ(z)},TM)},EJ:1c(w){if(1a.iG){jV(1a.iG);4m 1a.iG}1a.JU(1a.f4(w,1u),w)},JT:1c(){1b z=1a.f4(1a.K3,1m,1u);if(z&&z.7j){1b w=1a.2e().id+"SE";1b A=1a.qj=3p.dj("xQ");3p.cS.cL(A);A.2X("id",w);A.Ex=z.7j;A.1P.3M=1a.KQ+20+"px";A.1P.3Z=1a.KL+"px";A.1P.1q="nh";A.1P.5d="i3";A.1P.SK="SL";A.1P.NW="9D";A.1P.Kf="Il Ia";A.1P.cj=2}},SM:1c(){1a.1F()},xK:1c(G,E){if(1a.kA){1d}1b B=1a.iO=G.ni(E);1b F=B.h2();1b D=B.eC(E);1b A=1j;1b w=1o.h3(1a,"om");if(w!=1j){1b C=1g b.oH({2w:G,bj:1j,1w:1a.nl(D)});1a.2l(b.1S.om,C);A=C.bj}if(A==1j){1a.5W=3p.dj("Sv");1a.5W.6T=F;1a.5W.1P.5d="i3";1a.5W.1P.cj=2;1a.nk(D);1a.5W.1P.Kf="Ia Il #SD";3p.cS.cL(1a.5W)}1l{1a.5W=A}1a.5W.Sy=1a.Io;1b z=1a;j7(1c(){1d z.Ii.3F(z)},100);1a.kA=1m;1a.2l(b.1S.u1,1g b.oH({2w:G,bj:1a.5W}))},Ig:1c(w){if(w.pM==27){1a.pC(1u)}},nl:1c(A){1b z=1g f();1b w=b.1A.2s(1a.2e());1a.kz=1g f(w.x-(1a.3k?1a.3k.6s:0)+1a.3A*1a.1w.x+1a.3A*A.x,w.y-(1a.3k?1a.3k.6m:0)+1a.3A*1a.1w.y+1a.3A*A.y,1a.3A*A.1q,1a.3A*A.1p);1b B=1a.JN(A.5a());z.x=w.x+B.x;z.y=w.y+B.y;z.1q=1a.kz.1q;z.1p=1a.kz.1p;1d z},nk:1c(z){1b w=1a.nl(z);1a.5W.1P.3M=w.x+"px";1a.5W.1P.3Z=w.y+"px";1a.5W.1P.1q=w.1q+"px";1a.5W.1P.1p=w.1p+"px"},Ii:1c(){if(1a.5W){1a.5W.Ih()}},pC:1c(z){if(!1a.kA){1d}1a.2l(b.1S.u2,1g b.oH({2w:1a.iO,bj:1a.5W}));1b w=1a.iO.h2();1b B=1a.5W.6T;1a.5W.1P.SQ="y0";3p.cS.kH(1a.5W);1a.5W=1j;1b C=1a.iO;1a.iO=1j;1a.kA=1u;if(z){1b D=1j;1b A=C.jZ();if(A){D=1a.K9(C.jZ())}C.nm(B);if(1o.1Y(b.2Z,C)){1a.2l(b.1S.u8,C.gY(w,B))}1l{if(1o.1Y(b.3G,C)){1a.2l(b.1S.sO,C.gY(w,B))}1l{if(1o.1Y(b.v3,C)){1a.2l(b.1S.u0,C.gY(w,B))}1l{if(1o.1Y(1e.1i.4j.d2,C)){1a.2l(b.1S.wh,C.gY(w,B))}}}}if(D){1a.K8(D)}}},nB:1c(){1a.HB();if(!1a.kA){1d}1b w=1a.7B(1a.HK);1b A=1a.iO.h2();1b z=1a.iO.eC(w);1a.nk(z)},Td:1c(){1d 1a.1R},Qf:1c(){1d 1a.3n},T9:1c(){1d 1a.3L},kc:1c(){1a.m0(1j);1a.3i.qK();1k(1b z=0,w=1a.1R.1f;z<w;z++){1b A=1a.1R[0];h.3l(1a.1R,A);1a.xa(A)}1a.3n=[];1a.3L=[];if(1a.3H!=1j){1a.3H=1g b.tP(1a)}},54:1c(w){if(1a.9z()){1a.3H.jj();1a.3H.9S(1g b.th(1a,w));1a.3H.js()}1l{1a.ms(w)}},ms:1c(w){if(h.2c(1a.1R,w)){1d}if(1o.1Y(b.2Z,w)){1a.3n.1h(w);w.f2()}1l{if(!h.2c(1a.1R,w.1E)&&(w.1E==1j||!1o.1Y(b.9o,w.1E))){1d}if(!h.2c(1a.1R,w.1x)&&(w.1x==1j||!1o.1Y(b.9o,w.1x))){1d}1a.3L.1h(w);w.KB()}if(w.gi()===1v){w.jR(1a.1R.1f)}h.3u(1a.1R,w);1a.F6(w);if(1a.bw!=b.jd.4D){1a.sJ(w)}if(1o.1Y(b.3G,w)){if(1e.1i.3V.gJ){if(w.1E.2N!=1j||w.1x.2N!=1j){1a.oI()}}}1a.2l(b.1S.td,1g b.p1({2w:w}));1a.2S(1m)},c3:1c(w){if(!w){1d}if(1a.9z()){1a.3H.jj();1a.3H.9S(1g b.sG(1a,w));1a.3H.js()}1l{1a.lX(w,1m)}},lX:1c(w){if(1a.9e==w){1a.m0(1j)}1a.3i.c3(w);1a.HS(w);1a.HX(w);if(1e.1i.3V.gJ){1a.oI()}if(1o.1Y(b.2Z,w)){w.Ik();w.FK();if(w.7r){1a.yE([w.2s()])}}1l{if(1o.1Y(b.3G,w)){w.o8();w.2x.cp();w.2r.cp()}}w.ok();if(1a.bw!=b.jd.4D){1a.zh()}1a.2l(b.1S.te,1g b.p1({2w:w}));1a.2S(1m)},HS:1c(w){if(1o.1Y(b.2Z,w)){h.3l(1a.3n,w)}1l{h.3l(1a.3L,w)}},HX:1c(w){h.3l(1a.1R,w);1a.xa(w)},wc:1c(B,E){1b w=[];1b D=1a.xg();if(E>D.1f){E=D.1f}if(B){1k(1b A=E-1;A>=0;A--){1b C=D[A].2w;if(1o.1Y(b.3G,C)){w.1h(C)}}}1l{1k(1b A=E+1;A<D.1f;A++){1b C=D[A].2w;if(1o.1Y(b.3G,C)){w.1h(C)}}}1d w},nd:1c(w){if(w!=1j&&1a.HR(w)){1a.c3(w)}},yS:1c(){1a.un();1b B=1a.3i.3L;1k(1b z=0,w=B.1f;z<w;z++){if(1a.3i.3L.6r(B[0])>-1){1a.nd(B[0])}}1b A=1a.3i.3n;1k(1b z=0,w=A.1f;z<w;z++){if(1a.3i.3n.6r(A[0])>-1){1a.nd(A[0])}}1a.iz()},SR:1c(w){1d c(1a.1R,w)},SS:1c(w){1d c(1a.3n,w)},ST:1c(w){1d c(1a.3L,w)},f4:1c(z,A,w){1d g(1a.1R,z,A,w)},go:1c(z,A,w){1d g(1a.3n,z,A,w,1m)},T0:1c(z,A,w){1d g(1a.3L,z,A,w)},hG:1c(w,B){1b C=1a.3i.1R;1k(1b z=0;z<C.1f;z++){1b A=C[z].8c(w);if(A!=1j){1d A}}if(B){1d 1j}if(1a.9e!=1j){1b A=1a.9e.8c(w);if(A!=1j){1d A}}},Kd:1c(G,w,B,z){1b C=3W.5s;1b F=1j;1k(1b D=0;D<1a.3n.1f;D++){1b A=1a.3n[D];if(z&&A.aB()){2t}if(A===B){2t}if(b.1A.T1(G,A.1w,w)){1b E=b.1A.T2(G,A.1w);if(E<C){F=A;C=E}}}1d F},j8:1c(D,E,G,C){1b B=b.1A.oG(D);if(C){1k(1b A=0,w=1a.1R.1f;A<w;A++){1b F=1a.1R[A];if(!F.9b()){2t}if(!F.aB()&&F.bQ(D)){E.1h(F);if(!G){1d}if(1o.1Y(b.3V,F)){F.j8(D,E,G,C)}}}}1l{1k(1b A=0,w=1a.1R.1f;A<w;A++){1b F=1a.1R[A];if(!F.9b()){2t}1b z=F.6N();if(!F.aB()&&B.2c(z)){E.1h(F);if(!G){1d}if(1o.1Y(b.3V,F)){F.j8(D,E,G,C)}}}}},la:1c(E,F,H,D){1b C=0;1b B=b.1A.oG(E);if(D){1k(1b A=0,w=1a.1R.1f;A<w;A++){1b G=1a.1R[A];if(!G.9b()){2t}if(!G.aB()&&G.bQ(E)){C+=1;if(1o.1Y(b.3V,G)){C+=G.la(E,F,H,D)}}}}1l{1k(1b A=0,w=1a.1R.1f;A<w;A++){1b G=1a.1R[A];if(!G.9b()){2t}1b z=G.6N();if(!1a.1R[A].aB()&&B.2c(z)){C+=1;if(1o.1Y(b.3V,G)){C+=G.la(E,F,H,D)}}}}},Is:1c(){if(1e.1i.3V.gJ){1k(1b z=0,w=1a.1R.1f;z<w;z++){1a.1R[z].AS(1m)}1k(1b z=0,w=1a.3n.1f;z<w;z++){if(1o.1Y(1e.1i.3V,1a.3n[z])){1a.3n[z].IB()}}}},kU:1c(A){if(!A.bV()){1d 1u}if(!A.wi){if(1o.1Y(1e.1i.2Z,A)){if(1e.1i.3V.eq(A)!=1j){1d 1u}}if(1o.1Y(1e.1i.3G,A)){1b z=1e.1i.3V.eq(A.1E);if(z!=1j){1b w=1e.1i.3V.eq(A.1x);if(z==w){1d 1u}}}}1d 1m},s9:1c(w){if(w.aB()){1d 1u}1d 1m},aA:1c(){1d 1a.4L.8s},jO:1c(z,w){1b A=3p.hS(w.id);if(A){A.6T=b.1A.PF(1a.2k())}},2k:1c(){1b D=1a.2e().3C;1b C=1o.2s(D);1b A={id:1a.2e().id,1q:C.1q,1p:C.1p,nf:1a.1w,3T:1a.3T,2o:1a.2o,eD:1a.eD,2i:1a.2i,8P:1a.8P?1a.8P.id:"iy",5V:1a.5V,ht:1a.ht,fd:1a.fd,dg:1a.dg,gV:1a.gV,dk:1a.dk,9h:(1a.9h)?1a.9h.id:1j,9E:(1a.9E)?1a.9E.id:1j,fB:1a.fB,fE:1a.fE,g4:1a.g4,6s:1a.2e().3C.6s,6m:1a.2e().3C.6m,e4:1a.e4,fy:1a.fy,gP:1a.gP,fM:1a.fM,eZ:1a.eZ,fT:1a.fT,hx:1a.hx,gq:1a.gq,hg:1a.hg,hr:1a.hr,hD:1a.hD,jg:1a.jg,iP:1a.iP,b5:1a.b5,b0:1a.b0,dX:1a.dX,dL:1a.dL,9g:1a.9g,bO:1a.bO,c7:1a.c7,9l:(1a.9l)?1a.9l.id:1j,dh:1a.dh,dp:1a.dp,dq:1a.dq,cY:1a.cY,gM:1a.gM,fJ:1a.fJ,dm:1a.dm,xp:1a.9z(),fA:1a.fA,bI:1a.bI,dP:1a.dP,fW:1a.fW,bw:1a.bw,fN:1a.fN,ct:1a.ct,fG:1a.fG,ef:1a.ef,dw:1a.dw,di:1a.di,3x:1a.g1()||1j,1P:1a.1P?1a.1P.2k():1j,9y:1a.9y?1a.9y.2k():1j,hp:1a.hp,cP:1a.cP,5M:1a.fw(),5L:1a.fv(),g3:1a.Fk(),1R:1a.uC(),fO:1a.fO.2k(),hC:1a.hC,97:1a.97,aT:1a.aT,dJ:1a.dJ,6f:1a.6f,fZ:1a.fZ,g2:1a.g2,eF:1a.eF,cl:1a.cl};1b B=[];1k(1b z=0,w=1a.2I.1f;z<w;z++){if(1a.2I[z]!=1j){B.1h(1a.2I[z].2k())}}A.5e=B;if(1a.jb){A.xU=1a.jK(1a.jb)}1d 1o.2k(A)},uC:1c(){1b w=[];1a.xX();1k(1b B=0,z=1a.3n.1f;B<z;B++){1b A=1a.3n[B].2k();w.1h(A)}1k(1b B=0,z=1a.3L.1f;B<z;B++){1b A=1a.3L[B].2k();w.1h(A)}1d w},xX:1c(){1b A=0;1k(1b z=0,w=1a.3n.1f;z<w;z++){1a.3n[z].7Z=A++}1k(1b z=0,w=1a.3L.1f;z<w;z++){1a.3L[z].7Z=A++}},2E:1c(B){1a.kc();if(B>""){1b F=1o.2E(B);if(F.6f!=1j&&F.6f!=""){1a.uM(F.6f)}1a.1w=1g 1e.1z.2O(F.nf.x,F.nf.y,F.nf.1q,F.nf.1p);1a.jw(F.3T);1a.2i=F.2i?p.bC(F.2i):1j;1a.v7(F.8P);1a.H6(F.gq);1a.wP(F.2o);1a.SZ();1a.DL(F.eD);1a.IY(F.hD);1a.Hp(F.e4);1a.m8(F.hx);1a.Gu(F.hg);1a.Hs(F.hr);1a.Hk(F.jg);1a.Gg(F.iP);1a.G8(F.b5);1a.Hg(F.b0);1a.He(F.dX||0);1a.Hd(F.dL||0);if(F.bw!==1v){1a.EX(F.bw)}if(F.fN!==1v){1a.Fw(F.fN)}1a.Fr(F.ct||8);1a.Fq(F.fG||0);1a.Gc(F.9g);1a.Gh(F.bO);1a.tJ(F.5V);1a.IX(F.ht);1a.xn(F.fd);1a.Ji(F.gV);1a.wU(F.dk);1a.xN(F.dg);1a.v6(F.9h);1a.nw(F.9E);1a.xf(F.fB);1a.xh(F.fE);1a.EC(F.g4);if(F.c7!==1v){1a.Fu(F.c7)}if(F.9l!==1v){1a.w3(F.9l)}if(F.dh!==1v){1a.FD(F.dh)}if(F.dp!==1v){1a.FM(F.dp)}if(F.dq!==1v){1a.FP(F.dq)}if(F.cY!==1v){1a.FG(F.cY)}if(F.J7!==1v){1e.1z.Bs.tm=F.J7}if(F.gM!==1v){1a.FJ(F.gM)}if(F.fJ!==1v){1a.FI(F.fJ)}if(F.dm!==1v){1a.F7(F.dm)}if(F.xp!==1v){1a.Fl(F.xp)}if(F.mj!==1v){1a.GJ(F.mj)}if(F.m3!==1v){1a.GL(F.m3)}if(F.fA!==1v){1a.y7(F.fA)}if(F.bI!==1v){1a.bI=F.bI}if(F.dP!==1v){1a.dP=F.dP}if(F.fW!==1v){1a.fW=F.fW}if(F.fy!==1v){1a.fy=F.fy}if(F.gP!==1v){1a.gP=F.gP}if(F.fM!==1v){1a.fM=F.fM}if(F.eZ!==1v){1a.eZ=F.eZ}if(F.fT!==1v){1a.fT=F.fT}if(F.ef!==1v){1a.ef=F.ef}if(F.dw!==1v){1a.dw=F.dw}if(F.di!==1v){1a.di=F.di}if(F.fZ!==1v){1a.fZ=F.fZ}if(F.g2!==1v){1a.g2=F.g2}if(F.eF!==1v){1a.eF=F.eF}if(F.3x!==1v){1a.3x=F.3x}if(F.1P){1a.1P=1g b.1X(1u);1a.1P.2E(F.1P)}if(F.9y){1a.9y=1g b.hc();1a.9y.2E(F.9y)}1a.2I=[];if(F.5e){1k(1b A=0,z=F.5e.1f;A<z;A++){1b D=1o.e7(F.5e[A].lg);if(D){1b C=1g D(1a);C.2E(F.5e[A]);1a.2I.1h(C)}}}if(F.97!=1v){1a.97=F.97}if(F.aT!=1v){1a.aT=F.aT}if(F.cP!==1v){1a.cP=F.cP}if(F.hp!==1v){1a.IQ(F.hp)}if(F.xU!=1v){1a.xP(1a.97[F.xU])}if(F.5M!==1v){1a.5M=F.5M}if(F.5L!==1v){1a.5L=F.5L}if(F.g3!==1v){1a.g3=F.g3}if(F.dJ!==1v){1a.dJ=F.dJ}if(F.cl!==1v){1a.cl=F.cl}1a.2F(b.1S.sW,F.UX);1a.2F(b.1S.tw,F.UY);1a.2F(b.1S.t0,F.UU);1a.2F(b.1S.ub,F.UV);1a.2F(b.1S.tu,F.V2);1a.2F(b.1S.tZ,F.V3);1a.2F(b.1S.sS,F.V4);1a.2F(b.1S.tI,F.UZ);1a.2F(b.1S.sM,F.Vh);1a.2F(b.1S.uc,F.VD);1a.2F(b.1S.sZ,F.VF);1a.2F(b.1S.tF,F.Vl);1a.2F(b.1S.tk,F.Vn);1a.2F(b.1S.um,F.Vp);1a.2F(b.1S.u8,F.Ul);1a.2F(b.1S.sO,F.Um);1a.2F(b.1S.u0,F.Uh);1a.2F(b.1S.5Y,F.Uj);1a.2F(b.1S.qh,F.Uq);1a.2F(b.1S.tQ,F.Ur);1a.2F(b.1S.t7,F.Us);1a.2F(b.1S.uY,F.Un);1a.2F(b.1S.tW,F.Uo);1a.2F(b.1S.tL,F.Up);1a.2F(b.1S.i2,F.PW);1a.2F(b.1S.tN,F.U8);1a.2F(b.1S.tS,F.U9);1a.2F(b.1S.tB,F.U5);1a.2F(b.1S.sU,F.Ue);1a.2F(b.1S.t1,F.Uf);1a.2F(b.1S.oF,F.Ug);1a.2F(b.1S.ow,F.Ub);1a.2F(b.1S.dW,F.wI);1a.2F(b.1S.qq,F.Uc);1a.2F(b.1S.qo,F.Ud);1a.2F(b.1S.qg,F.Ut);1a.2F(b.1S.qf,F.UJ);1a.2F(b.1S.sv,F.UL);1a.2F(b.1S.tK,F.UG);1a.2F(b.1S.lR,F.UH);1a.2F(b.1S.ty,F.UI);1a.2F(b.1S.tH,F.UP);1a.2F(b.1S.u1,F.UQ);1a.2F(b.1S.u2,F.UR);1a.2F(b.1S.om,F.UM);1a.2F(b.1S.sV,F.UN);1a.2F(b.1S.tj,F.UO);1a.2F(b.1S.sK,F.Ux);1a.2F(b.1S.tn,F.Uy);1a.2F(b.1S.tg,F.Uz);1a.2F(b.1S.t5,F.Uu);1a.2F(b.1S.t2,F.Uv);1a.2F(b.1S.tc,F.Uw);1a.2F(b.1S.td,F.UD);1a.2F(b.1S.te,F.UE);if(F.6s){1a.2e().3C.6s=F.6s}if(F.6m){1a.2e().3C.6m=F.6m}1b w=[];if(F.1R mN ke){1k(1b A=0;A<F.1R.1f;A++){if(F.1R[A]){if(1a.z1(F.1R[A])){1b E=1a.i6(F.1R[A],w);w[F.1R[A].7Z]=E;1a.54(E);if(F.1R[A].6B){1a.3i.54(E)}}}}1k(1b A=0;A<F.1R.1f;A++){if(F.1R[A]){if(1a.z2(F.1R[A])){1b E=1a.i6(F.1R[A],w);w[F.1R[A].7Z]=E;1a.54(E);if(F.1R[A].6B){1a.3i.54(E)}}}}}if(F.fO!==1v){1a.fO.2E(F.fO)}if(F.hC!=1v){1a.hC=F.hC}}1k(1b A=0;A<w.1f;A++){w[A].iE(w)}if(1a.iE){1a.iE()}1a.1F();1a.2S(1u);1a.2l(b.1S.dW)},z1:1c(z){1b w=1o.e7(z.nz||z.3a);if(!w){1d 1u}1d 1o.ia(w,b.2Z)},z2:1c(z){1b w=1o.e7(z.nz||z.3a);if(!w){1d 1u}1d w==b.3G||1o.ia(w,b.3G)},i6:1c(E,A){1b B=1o.e7(E.nz||E.3a);if(!B){1d 1j}if(1o.ia(B,b.2Z)){1b D=1g B(1a);D.2E(E);1d D}if(B==b.3G||1o.ia(B,b.3G)){1b z=A[E.1E];1b w=A[E.1x];1b C=1g B(1a,z,w);C.2E(E);1d C}1d 1j},4f:1c(w,A,B){1b z=1a;1b C=1g AR();C.NI=1c(){z.y3(C.NM);if(A){A(z)}};C.NE=1c(){iw.mI("5h 2L AN AO.");if(B){B(z)}};C.AE("LI",w);C.LK="3p";C.At()},4E:1c(w){1b z=1g AR();z.AE("UA",w,1m);z.UB("BV-6n","1K/BP");z.At(1a.JG(b.uS.xT))},UC:1c(w){if(w.Sr(0)=="{"){1a.2E(w)}1l{1b z=1g QY();1a.y3(z.R5(w,"R6/BP"))}},JG:1c(z){if(5G z=="1v"){z=b.uS.JH}if(z==b.uS.xT){1b w=1g R9();1d w.R8(1a.Jp())}1l{1d 1a.2k()}},y3:1c(G){1a.kc();1b I=G.QW;1b z=1g b.o7(1a,G);z.yv=5v(I.3c("ew"));z.Hi(I);1a.K7("Kb",I,z);1b J=1a.1w;1a.rL("fY",I,z);1b w=I.4K("Jq")[0];1b F=w.Jn;2L(F!=1j){1b B=z.Bz(F);1a.54(B);F=F.Jo}1b K=I.4K("Ju")[0];1b F=K.Jn;2L(F!=1j){1b H=z.Bz(F);1a.54(H);F=F.Jo}1b A=z.9x("fj",I);if(A){1b C=A.4K("ih");1k(1b E=0;E<C.1f;E++){1b F=C[E];1b L=z.rA(F);if(L){1a.3i.54(L)}}1b D=z.9x("Kc",A);if(D){1a.8M=z.rA(D)}}1a.iR(z.Db("1X",I));1a.GS(z.In("hc",I));1a.3g(J)},Jp:1c(){1a.xX();1b z=3p.Rb.QX("","",1j);1b B=z.dj("4c");B.2X("ew","17");z.cL(B);1b D=1g b.o7(1a,z);1b w=D.2m("Jq",B);1k(1b C=0;C<1a.3n.1f;C++){D.BB(1a.3n[C],w,"Bu")}1b E=D.2m("Ju",B);1k(1b C=0;C<1a.3L.1f;C++){D.BB(1a.3L[C],E,"R7")}1a.JR("Kb",B,D);1a.rJ("fY",B,D);1b A=D.2m("fj",B);1b F=1a.3i.1R;1k(1b C=0;C<F.1f;C++){D.iC(F[C],"ih",A)}D.iC(1a.8M,"Kc",A);D.BM(1a.1P,"1X",B,"3b:R0");D.I3(1a.9y,"hc",B);D.Hj(B);1a.2S(1u);1d z},K7:1c(w,z,B){1b A=B.9x(w,z);if(!A){4R 1g 5h("R3 to kv 1H QT.")}1a.wP(B.2Q("JM",A));1a.cP=B.2Q("cH",A);1a.xP(B.pF("JS",A));1a.3x=B.oa(1a,"jB",A);1a.xN(B.2Q("Fe",A));1a.wU(B.6p("Ff",A));if(B.yv>13){1a.nw(B.hX("xb",A));1a.v6(B.hX("x9",A))}1l{1a.nw(B.oe("xb",A));1a.v6(B.oe("x9",A))}1a.xh(B.4G("F3",A));1a.xf(B.4G("F0",A));1a.v7(B.hX("F1",A));1a.xn(B.6p("F9",A));1a.1w=B.zt("sr",A);1a.cl=B.3U("Fa",A,1m)},JR:1c(w,z,B){1b A=B.2m(w,z);B.3m(1a.2o,"JM",A);B.3m(1a.cP,"cH",A);B.pX(1a.jb,"JS",A);B.nZ(1a,1a.3x,"jB",A);B.3m(1a.dg,"Fe",A);B.6I(1a.dk,"Ff",A);B.hW(1a.9E,"xb",A);B.4W(1a.fE,"F3",A);B.hW(1a.9h,"x9",A);B.4W(1a.fB,"F0",A);B.hW(1a.8P,"F1",A);B.6I(1a.fd,"F9",A);B.sb(1a.1w,"sr",A);B.3O(1a.cl,"Fa",A)},rL:1c(w,z,D){1a.2I=[];1b E=z.4K(w);1b C=1j;1k(1b B=0;B<E.1f;B++){if(E[B].3C!=z){2t}C=E[B];1Q}if(!C){1d}1b F=C.4K("g0");1k(1b B=0;B<F.1f;B++){1b A=F[B];1a.2I.1h(D.vb(A))}},rJ:1c(w,A,C){1b z=C.2m(w,A);1k(1b B=0;B<1a.2I.1f;B++){C.uD(1a.2I[B],"g0",z)}},F6:1c(w){w.1t=1a;w.lz()},xa:1c(w){w.lG()},2S:1c(w){if(j.6z){1d}if(w===1v){w=1m}1a.F8=w},RW:1c(){1d 1a.F8},vl:1c(B){1k(1b z=0,w=1a.1R.1f;z<w;z++){1b A=1a.1R[z];A[B]=1v}},Fv:1c(w){if(1a.3i.1R.1f==0){1d}1b z=1a.3i.2k();if(w&&4O.t4){4O.t4.Sk("1K",z)}1l{4O.FL=z}},Sl:1c(F,C,I,z){1b K;if(I&&4O.t4){K=4O.t4.Sj("1K")}1l{K=4O.FL}if(K){1b M=F||0;1b L=C||0;1a.un();1a.3i.qK();1b D=1o.2E(K);1b E=[];1b G=D.1R;if(G mN ke){1k(1b B=0;B<G.1f;B++){if(1a.z1(G[B])){1b J=1a.i6(G[B],E);E[G[B].7Z]=J;if(M!=0||L!=0){1b H=J.2s();J.3g(1g f(H.x+M,H.y+L,H.1q,H.1p))}1a.54(J);1a.3i.54(J)}}1k(1b B=0;B<G.1f;B++){if(1a.z2(G[B])){if(!z&&(G[B].1E==-1||G[B].1x==-1)){2t}1b J=1a.i6(G[B],E);E[G[B].7Z]=J;if(M!=0||L!=0){1k(1b A=0;A<J.1r.1f;++A){1b w=J.1r[A];J.1r[A]=1g u(w.x+M,w.y+L)}}1a.54(J);1a.3i.54(J);J.4k()}}}1k(1b B=0;B<E.1f;B++){E[B].iE(E)}1a.iz();1k(1b B=0;B<E.1f;B++){1a.Ft(E[B])}}},So:1c(w){1a.Fv(w);1a.yS()},oE:1c(w){if(1a.2i!==w){1a.2i=w;1a.2S(1m)}},q1:1c(){1d 1a.2i},c5:1c(z){1a.ta();1b w=b.jA.c5(z,1a);1a.iz();1d w},jy:1c(A,z,w){1d b.jA.jy(A,z,w,1a.3n,1a.3L)},Sb:1c(z){if(z===1v){z=10}1b w=1a.lQ();1a.3g(f.9N(w.3M()-z,w.3Z()-z,w.2y()+z,w.2V()+z))},sJ:1c(E){if(E==1j){1a.zh();1d}if(1o.1Y(b.fj,E)||!1o.1Y(b.8A,E)){1d}1b F=1u;1b B=1a.1w.3M();1b w=1a.1w.3Z();1b A=1a.1w.2y();1b C=1a.1w.2V();1b z=E.2s().1J();1b D=12*n.3h(1a.2o);if(1a.bw==b.jd.FB){if(z.3M()<B+D){B=z.3M()-D;F=1m}if(z.3Z()<w+D){w=z.3Z()-D;F=1m}}if(z.2y()>A-D){A=z.2y()+D;F=1m}if(z.2V()>C-D){C=z.2V()+D;F=1m}if(F){1a.3g(f.9N(B,w,A,C))}},zh:1c(){1b z=1a.1w.1J();1b w=1a.1w.1J();h.1B(1a.1R,1c(A){if(z==f.7s){z=A.2s().1J()}1l{z=z.9I(A.2s())}});if(z!=w){1a.3g(f.9N(1a.1w.3M(),1a.1w.3Z(),z.2y(),z.2V()))}},lQ:1c(){1b w=f.7s;h.1B(1a.1R,1c(z){if(w==f.7s){w=z.2s().1J()}1l{w=w.9I(z.2s())}});1d w},m1:1c(w,C){1b A=1a.gA();1b z=1a.gy();1b B=1a.nr(1g u(w,C));if(1a.3k){1a.3k.6s=B.x;1a.3k.6m=B.y}1l{1a.2e().3C.6s=B.x;1a.2e().3C.6m=B.y}if(1a.kL){1a.kL.x+=1a.gA()-A;1a.kL.y+=1a.gy()-z}},yO:1c(A,z,w,B){if(!B){B=1a.1w}if(A<B.3M()){A=B.3M()}if(A>B.2y()-w.1q){A=1s.1U(B.2y()-w.1q,B.3M())}if(z<B.3Z()){z=B.3Z()}if(z>B.2V()-w.1p){z=1s.1U(B.2V()-w.1p,B.3Z())}1a.m1(A,z)},gA:1c(){if(1a.3k){1b w=1g u(1a.3k.6s,1a.3k.6m)}1l{1b w=1g u(1a.2e().3C.6s,1a.2e().3C.6m)}1d 1a.k7(w).x},Sd:1c(z){1b w=1a.nr(1g u(z,0));if(1a.3k){1a.3k.6s=w.x}1l{1a.2e().3C.6s=w.x}},gy:1c(){if(1a.3k){1b w=1g u(1a.3k.6s,1a.3k.6m)}1l{1b w=1g u(1a.2e().3C.6s,1a.2e().3C.6m)}1d 1a.k7(w).y},RO:1c(z){1b w=1a.nr(1g u(0,z));if(1a.3k){1a.3k.6m=w.y}1l{1a.2e().3C.6m=w.y}},yR:1c(){if(1a.3k){1b w=1g u(1a.3k.6s,1a.3k.6m)}1l{1b w=1g u(1a.2e().3C.6s,1a.2e().3C.6m)}1d 1a.k7(w)},lH:1c(){1b A=1a.3k?1a.3k:1a.2e().3C;1b z=1g u(A.6s,A.6m);z=1a.k7(z);1b w=1g u(A.6s+A.Ro,A.6m+A.P6);w=1a.k7(w);1d f.ea(z,w)},Rm:1c(B,A){1b z=1a.nr(A);1b w=1a.nr(1a.yR());1b C=b.1A.d4(z,w);1a.m8(B);C=1a.k7(C);1a.m1(A.x-C.x,A.y-C.y)},H4:1c(A){1a.m8(100);1b z=1a.lH();1b B=1s.2b(z.1q/A.1q,z.1p/A.1p);1a.m8(100*B);1b w=A.4e();z=1a.lH();1a.m1(1s.1U(1a.1w.x,w.x-z.1q/2),1s.1U(1a.1w.y,w.y-z.1p/2))},Rn:1c(){1a.H4(1a.lQ())},Rt:1c(w){1a.m8(w)},Rr:1c(w,z){1a.m1(w,z)},Rf:1c(){1d 1a.fy},Rc:1c(w){1a.fy=w},Rd:1c(){1d 1a.e4},Hp:1c(w){1a.e4=w},yE:1c(w){1b A=[];1k(1b B=0;B<1a.3L.1f;B++){1b E=1a.3L[B];if(!E.5Z){2t}1k(1b D=0;D<w.1f;D++){1b C=w[D];1b F=1a.mO;1b z=b.1A.5B(C,F,F);if(z.bc(E.2s())){A.1h(E);1Q}}}1a.og.e4(A);A.1B(1c(G){G.sl()})},Rg:1c(){1d 1a.8M},Rj:1c(){1d 1a.9e},m0:1c(w){if(w!=1a.9e){1a.9e=w;1a.1F()}},Ri:1c(){1d 1a.hr},Hs:1c(w){if(1a.hr!=w){1a.hr=w;1a.9e=1j}},RF:1c(){1d 1a.mO},RG:1c(w){1a.mO=w},RJ:1c(){1a.ta();1a.og.e4(1a.3L);1a.3L.1B(1c(w){w.sl()});1a.iz()},RM:1c(){1d 1a.3i},RN:1c(){1d 1a.ef},Ry:1c(w){1a.ef=w},Rz:1c(){1d 1a.dw},RD:1c(w){1a.dw=w},RB:1c(){1d 1a.di},Rp:1c(w){if(1a.di==w){1d}1a.di=w;1a.2S(1m)},JC:1c(){1d 1a.dP},Zp:1c(w){if(1a.dP==w){1d}1a.dP=w;1a.5Y()},w7:1c(){1d 1a.fW},10a:1c(w){if(1a.fW==w){1d}1a.fW=w;1a.5Y();1a.2S(1m)},JZ:1c(){1d 1a.hg},Gu:1c(w){if(1a.hg==w){1d}1a.hg=w;1a.jL();1a.2S(1m)},jL:1c(){1k(1b w=0;w<1a.3n.1f;w++){1a.3n[w].jL()}},o4:1c(){1d 1a.hb},Gs:1c(w){if(w!=1a.hb){if(1a.hb!=1j){1a.hb.jL(w)}1a.hb=w;if(1a.hb!=1j){1a.hb.f2()}}},10b:1c(){1d 1a.fA},y7:1c(z){if(1a.fA==z){1d}1a.fA=z;1a.2S(1m);1b w=b.ud;56(1a.fA){1T w.7q:1a.5A=1g b.wN(1a);1Q;1T w.GH:1a.5A=1g b.xq(1a);1Q;1T w.ya:1a.5A=1g b.fX(1a,1c(A){1d 1g b.5m(1a.1H)});1Q;1T w.Gy:1a.5A=1g b.xE(1a);1Q;1T w.Gx:1a.5A=1g b.gN(1a,1c(A){1d 1g b.5m(1a.1H)});1Q;1T w.GB:1a.5A=1g b.fX(1a,1c(A){1d 1g b.cg(1a.1H)});1Q;1T w.GA:1a.5A=1g b.gN(1a,1c(A){1d 1g b.cg(1a.1H)});1Q;1T w.G1:1a.5A=1g b.fX(1a,1c(A){1d 1g b.3V(1a.1H)});1Q;1T w.G0:1a.5A=1g b.gN(1a,1c(A){1d 1g b.3V(1a.1H)});1Q;1T w.FZ:1a.5A=1g b.fX(1a,1c(A){1d 1g b.ix(1a.1H)});1Q;1T w.G4:1a.5A=1g b.gN(1a,1c(A){1d 1g b.ix(1a.1H)});1Q;1T w.ff:1a.5A=1g b.pw(1a);1Q;1T w.G2:1a.5A=1g b.vf(1a);1Q;1T w.iN:1a.5A=1g b.fX(1a,1c(A){1b B=1o.e7(1a.1H.mj);if(!B){1d 1g b.5m(1a.1H)}1d 1g B(1a.1H)},1c(C,B,A){1b D=1o.e7(1a.1H.m3);if(!D){1d 1g b.3G(1a.1H,B,A)}1d 1g D(1a.1H,B,A)});1Q;1T w.FV:1a.5A=1g b.fX(1a,1c(A){1d 1g b.aF(1a.1H)});1Q;1T w.FX:1a.5A=1g b.gN(1a,1c(A){1d 1g b.aF(1a.1H)});1Q;1T w.G5:1a.5A=1g b.fX(1a,1c(A){1d 1g b.aF(1a.1H)});1a.5A.yD=1m;1Q;1T w.Gd:1a.5A=1g b.gN(1a,1c(A){1d 1g b.aF(1a.1H)});1a.5A.yD=1m;1Q}},sF:1c(w){if(1a.5A==1j){1d w}1d 1a.5A.sF(w)},109:1c(){1d 1a.9g},Gc:1c(w){if(1a.9g==w){1d}1a.9g=w;1a.5Y();1a.2S(1m)},no:1c(){1d 1a.bO},Gh:1c(w){if(1a.bO!==w){1a.bO=w;1a.2S(1m)}},107:1c(){1d 1a.iP},Gg:1c(w){if(1a.iP==w){1d}1a.iP=w;1a.2S(1m);if(1a.9g){1a.5Y()}},yK:1c(){1d 1a.b5},G8:1c(w){if(1a.b5==w){1d}1a.b5=w;1a.2S(1m);if(1a.9g){1a.5Y()}},yL:1c(){1d 1a.b0},Hg:1c(w){if(1a.b0==w){1d}1a.b0=w;1a.2S(1m);if(1a.9g){1a.5Y()}},108:1c(){1d 1a.dX},He:1c(w){if(1a.dX==w){1d}1a.dX=w;1a.2S(1m);if(1a.9g){1a.5Y()}},10c:1c(){1d 1a.dL},Hd:1c(w){if(1a.dL==w){1d}1a.dL=w;1a.2S(1m);if(1a.9g){1a.5Y()}},10g:1c(){1d 1a.jg},Hk:1c(w){if(1a.jg==w){1d}1a.jg=w;1a.2S(1m);if(1a.9g){1a.5Y()}},10h:1c(){1d 1a.tE},10f:1c(w){if(1a.tE==w){1d}1a.tE=w;1a.2S(1m);if(1a.9g){1a.5Y()}},I4:1c(z,w){1d 1a.yH(w.5a())},yH:1c(w){if(1a.bO){1b z=1a.b5/2;if(b.1A.Hv(1a.dX)){z=1a.dX-1a.b5*1s.6i(1a.dX/1a.b5)}1b A=1a.b0/2;if(b.1A.Hv(1a.dL)){A=1a.dL-1a.b0*1s.6i(1a.dL/1a.b0)}1d 1g u(z+1a.b5*1s.b1((w.x-z)/1a.b5),A+1a.b0*1s.b1((w.y-A)/1a.b0))}1d w},ti:1c(z,w,A){1d 1a.yH(w)},tA:1c(){1d 1a.hC},10e:1c(w){if(1a.hC==w){1d}1a.hC=w;1a.5Y();1a.2S(1m)},dr:1c(C){1k(1b A=0,z=1a.1R.1f;A<z;A++){1b B=1a.1R[A];1b w=B.dr(C);if(w!==1j){1d w}}1d 1j},ZT:1c(w){if(1a.bI!==w){1a.bI=w;1a.2S(1m)}},ZU:1c(){1d 1a.bI},ZS:1c(w){if(1a.sz!==w){1a.sz=w;1a.2S(1m)}},ZQ:1c(){1d 1a.sz},uW:1c(D,w){if(b.3V.gJ){b.3V.Ef=1u;1b E=1a.kX(w,1a.GO,D);if(b.3V.Ef){1d E}1b z=D.2N;if(z){1b B=z.1w;1b C=D.6N();if(!B.2c(C)&&!B.bc(C)){if(!z.7a){1d 1u}1b A=1g b.4M({1C:D,2N:z});1a.2l(b.1S.tK,A);if(A.cc()){1d 1u}}}}1d 1m},GO:1c(z,w){if(z==w){1d 1u}1d z.Ee(w)},xA:1c(z,w){1a.kX(w,1a.GT,z)},GT:1c(z,w){if(z==w){1d 1u}1d z.AJ(w)},kX:1c(w,E,C){1k(1b A=1a.1R.1f-1;A>=0;A--){1b B=1a.1R[A];if(C==B){2t}if(1o.1Y(b.2Z,B)&&B.9b()&&!B.aB()&&B.2M(w)){if(1o.1Y(b.3V,B)){1b z=B.kX(w,E,C);if(z){1d 1m}}1b D=E(B,C);if(D){1d 1m}}}1d 1u},iR:1c(w){if(1a.1P!==w){1a.1P=w;1a.1F();1a.2S(1m)}},cG:1c(){1d 1a.1P},GS:1c(w){if(1a.9y!=w){1a.9y=w;h.1B(1a.1R,1c(z){z.1F()});1a.2S(1m)}},ZR:1c(){1d 1a.9y},cC:1c(w){if(1a.3x!=w){1a.3x=w;1a.2S(1m)}},g1:1c(){1d 1a.3x},GJ:1c(w){1a.mj=w},ZV:1c(){1d 1a.mj},GL:1c(w){1a.m3=w},104:1c(){1d 1a.m3},H6:1c(w){if(1a.gq!=w){1a.gq=w;1a.H5()}},ZY:1c(){1d 1a.gq},ZW:1c(w){if(1a.dJ!==w){1a.dJ=w;1a.2S()}},ZX:1c(){1d 1a.dJ!=1v?1a.dJ:ng},10x:1c(){1d 1a.g4},EC:1c(w){if(1a.g4!==w){1a.g4=w||0;1a.2S(1m)}},ij:1c(){1d 1a.eZ},10y:1c(A){if(1a.eZ==A){1d}1a.eZ=A;1a.vl("lk");1k(1b w=0;w<1a.3L.1f;w++){1b z=1a.3L[w];z.1F()}1a.1F();1a.2S(1m)},IH:1c(){1d 1a.fT},10w:1c(w){if(1a.fT==w){1d}1a.fT=w;1a.vl("lk");1a.1F();1a.2S(1m)},qR:1c(){1d 1a.gP},10u:1c(w){if(1a.gP!==w){1a.gP=w;1a.1F();1a.2S(1m)}},w1:1c(){1d 1a.fM},10v:1c(w){if(1a.fM!==w){1a.fM=w;1a.1F();1a.2S(1m)}},10z:1c(){1d 1a.bw},EX:1c(w){1a.bw=w},10D:1c(){1d 1a.fN},Fw:1c(w){if(1a.fN!=w){1a.fN=w;1a.t3()}},10C:1c(){1d 1a.ct},Fr:1c(w){if(1a.ct!=w){1a.ct=w}},10B:1c(){1d 1a.fG},Fq:1c(w){if(1a.fG!=w){1a.fG=w}},10l:1c(){1d 1a.c7},Fu:1c(w){if(1a.c7!=w){1a.c7=w;1a.1F()}},10m:1c(){1d 1a.dh},FD:1c(w){if(1a.dh!=w){1a.dh=w}},10k:1c(){1d 1a.dp},FM:1c(w){if(1a.dp!=w){1a.dp=w}},10i:1c(){1d 1a.dq},FP:1c(w){if(1a.dq!=w){1a.dq=w}},10j:1c(){1d 1a.cY},FG:1c(w){if(1a.cY!=w){1a.cY=w}},10n:1c(){1d 1a.gM},FJ:1c(w){if(1a.c7!=w){1a.gM=w}},10r:1c(){1d 1a.9l},w3:1c(w){if(5G w=="bB"){w=b.1D.1I(w)}if(1a.9l!=w){1a.9l=w;if(1a.7d){1a.7d.4P(1a.9l)}}},10q:1c(){1d 1a.fJ},FI:1c(w){if(1a.fJ==w){1d}1a.fJ=w;if(1a.c7){1a.5Y()}},10o:1c(){1d 1a.dm},F7:1c(w){if(1a.dm==w){1d}1a.dm=w;if(1a.dm){1a.5Y()}},10p:1c(){1d 1a.iZ},Zk:1c(){1d 1a.ut},Fb:1c(w){if(1a.ut!=w){1a.ut=w}},Zj:1c(){1d 1a.uH},F5:1c(w){if(1a.uH!=w){1a.uH=w}},Zi:1c(){1d 1a.uK},EZ:1c(w){if(1a.uK!=w){1a.uK=w;if(w&&w!=b.bn.4D){1a.2e().Fm=1a.F2}1l{1a.2e().Fm=1j}}},9z:1c(){1d 1a.3H!=1j},Fl:1c(w){if(1a.9z()!=w){1a.3H=w?1g b.tP(1a):1j;1a.m6()}},JK:1c(w){if(1a.5M!==w){1a.5M=w;1a.1F()}},fw:1c(){if(1a.5M===1v){1d 4}1d 1a.5M},JJ:1c(w){if(1a.5L!==w){1a.5L=w;1a.1F()}},fv:1c(){if(1a.5L===1v){1d 4}1d 1a.5L},Zm:1c(w){if(1a.g3!==w){1a.g3=w;1a.1F()}},Fk:1c(){if(1a.g3===1v){1d b.vj.4D}1d 1a.g3},uM:1c(z){if(1a.6f!=z){1a.6f=z;if(1a.6f!=1j&&1a.6f!=""){Q6{b.1D.7T=1m;1g b.lC().4f(1a.6f,1o.3t(1a,1a.us),1o.3t(1a,1a.ur))}Q4(w){b.1D.7T=1u;4R w}}1l{b.1D.7T=1u}}},Q2:1c(){1d 1a.6f},us:1c(){b.1D.7T=1u;1a.vF();1a.1F()},gj:1c(w){b.1D.7T=1u;h.1B(1a.1R,1c(z){if(z.hZ){z.hZ()}})},ur:1c(){b.1D.7T=1u;1a.vF();1a.1F()},vF:1c(){if(1a.9l&&1a.9l.hm()){1a.9l=b.1D.1I(1a.9l.id);if(1a.7d){1a.7d.4P(1a.9l)}}if(1a.8P&&1a.8P.hm()){1a.8P=b.1D.1I(1a.8P.id)}if(1a.9E&&1a.9E.hm()){1a.9E=b.1D.1I(1a.9E.id)}if(1a.9h&&1a.9h.hm()){1a.9h=b.1D.1I(1a.9h.id)}},sD:1c(){if(!1a.sI){1d}1a.1F();1a.v1=1m},xj:1c(w){if(!1a.v1){1d}if(!w){w=1a.1w}1a.Fi(w);1a.v1=1u},Zq:1c(){if(!1a.sI){1d}1b w=1a.lQ();w=w.9I(1a.1w);1a.v1=1m;1a.xj(w);1a.1F()},Fi:1c(F){1b E=[];1b D=[];1k(1b C=0,A=1a.3n.1f;C<A;C++){if(F.bc(1a.3n[C].1w)){E.1h(1a.3n[C].1w)}}1k(1b C=0,A=1a.3L.1f;C<A;C++){if(1a.3L[C].3r!=1v){1k(1b B=0,z=1a.3L[C].3r.1f;B<z;B++){if(1a.3L[C].3r[B].a9){if(F.bc(1a.3L[C].3r[B].i5())){D.1h(1a.3L[C].3r[B])}}1l{1a.3L[C].3r[B].eE()}}}}1k(1b C=0,A=D.1f;C<A;C++){1b G=1a.Fh(D[C],E);1b w=D[C].sE(G);D[C].2h.1F();E.1h(w)}},Fh:1c(K,X){K.eE();1b z=K.i5();1b G=1a.1w.1J();G=G.5B(-z.1q/2,-z.1p/2);1b Y=3W.5s;1b F=4*n.3h(1a.2o);1b I=1g u(z.x+z.1q/2,z.y+z.1p/2);1b E=I.1J();1b H=K.2h;1b V=H.zd(30);1k(1b W=0,S=V.1f-1;W<S;W++){1b B=V[W];1b A=V[W+1];1b Z=1g a(A.x-B.x,A.y-B.y);1b w=1s.6i(Z.1f()/F);Z=a.vC(Z,(F/Z.1f()));1b O=1a.JP(B,Z,A,w);1k(1b U=0,Q=O.1f;U<Q;U++){1b R=O[U];1b C=1g a(Z.y,-Z.x);1b D=1g a(-Z.y,Z.x);C=a.vC(a.JY(C,C.1f()),1a.vD(z,C.JW())+1);D=a.vC(a.JY(D,D.1f()),1a.vD(z,D.JW())+1);1b J=R.1J().d5(C);1b M=R.1J().d5(D);1b N=1a.vA(K,X,J,J.5E(E)+((J.y>M.y)?1:0));1b P=1a.vA(K,X,M,M.5E(E)+((M.y>J.y)?1:0));1b T=1g f(J.x-z.1q/2,J.y-z.1p/2,z.1q,z.1p);1b L=1g f(M.x-z.1q/2,M.y-z.1p/2,z.1q,z.1p);if(H.bQ(T)){N+=50}if(H.bQ(L)){P+=50}if(N<Y&&G.2M(J)){I=J;Y=N}if(P<Y&&G.2M(M)){I=M;Y=P}}}1d I},Zr:1c(){if(1o.1Y(b.v8,1a.5x)||1a.c7){1b D=1a.kL;if(D==1v){1d}1b G=1a.JN(D);1b z=1s.b1(1a.dp/(1a.dh/100))*1a.3A;1b C=1s.b1(1a.dq/(1a.dh/100))*1a.3A;1b F=1g f(1s.b1(G.x-z/2),1s.b1(G.y-C/2),z,C);z=1a.dp*(1/(1a.hx/100));C=1a.dq*(1/(1a.hx/100));1b B=1g f(1s.b1(D.x-z/2),1s.b1(D.y-C/2),z,C);if(!1a.7d){1a.7d=1g b.b8(1a.9l)}1a.7d.hU(B,0);1a.7d.7O="4l";1a.7d.8w="4l";1a.7d.nE(1a.3R);1a.3R.iU();1a.3R.Z7(1a.2e(),1s.1U(F.x,0),1s.1U(F.y,0),1s.1U(F.1q,1),1s.1U(F.1p,1),1s.1U(B.x,0),1s.1U(B.y,0),1s.1U(B.1q,1),1s.1U(B.1p,1));if(1a.gM){1b A={3a:"mk",5H:[{5d:0,3s:"aM(0,0,0,0)"},{5d:0.8,3s:"aM(0,0,0,0.1)"},{5d:0.9,3s:"aM(0,0,0,0.2)"}]};1a.7d.7O=A;1a.7d.nE(1a.3R)}if(1a.cY>0){1b E=1a.3A/(1a.hx/100);1a.7d.7O="4l";1a.7d.8w=1a.dm;1a.7d.2v=(1a.cY+1)*E;1a.7d.nE(1a.3R);1a.7d.8w=1a.fJ;1a.7d.2v=1a.cY*E;1a.7d.nE(1a.3R)}}},JP:1c(D,A,z,C){1b w=[];1k(1b B=0;B<=C;++B){D=1e.1z.5k.d5(D,A);w.1h(D)}if(w.1f==0||!w[w.1f-1].hh(z)){w.1h(z.1J())}1d w},vA:1c(E,C,H,G){1b D=E.i5();D.wv(H);D.qX(-D.1q/2,-D.1p/2);1b F=0;1k(1b B=0,A=C.1f;B<A;B++){if(D.bc(C[B])){1b w=D.vr(C[B]);1b z=w.1q*w.1p;F=1s.1U(F,z)}}1d F+G},vD:1c(D,z){1b w=1g u(D.x+D.1q/2,D.y+D.1p/2);1b E=a.ea(w,1g u(D.x,D.y));1b C=a.ea(w,1g u(D.x+D.1q,D.y));1b B=a.ea(w,1g u(D.x+D.1q,D.y+D.1p));1b A=a.ea(w,1g u(D.x,D.y+D.1p));1b F=[];F.1h((E.x*z.x+E.y*z.y)/z.1f());F.1h((C.x*z.x+C.y*z.y)/z.1f());F.1h((B.x*z.x+B.y*z.y)/z.1f());F.1h((A.x*z.x+A.y*z.y)/z.1f());F.5q();1d F[3]},m6:1c(){1a.tM=1a.9z()&&1a.3H.tM();1a.tO=1a.9z()&&1a.3H.tO()},9Y:1c(){if(1a.3H!=1j){1a.3H.9Y();1a.1F()}},9T:1c(){if(1a.3H!=1j){1a.3H.9T();1a.1F()}},un:1c(){if(1a.3H!=1j){1a.3H.jj()}},iz:1c(){if(1a.3H!=1j){1a.3H.js(1m)}},uP:1c(){if(1a.3H!=1j){1a.3H.js(1u)}},9w:1c(w){if(1a.3H!=1j){if(1o.1Y(r,w)){w.1B(1c(A){1b B=1g b.kB(1a,A);1a.3H.9S(B)},1a)}1l{if(1o.1Y(b.8A,w)){1b z=1g b.kB(1a,w);1a.3H.9S(z)}}}},9S:1c(w){if(1a.3H!=1j){1a.3H.9S(w)}},K9:1c(w){1d 1a.3H==1j?1j:1g b.kB(1a,w)},K8:1c(w){if(1a.3H!=1j&&w!=1j){1a.3H.9S(w)}},ta:1c(){if(1a.3H!=1j){1a.3H.jj();1k(1b z=0,w=1a.1R.1f;z<w;z++){1b A=1g b.kB(1a,1a.1R[z]);1a.3H.9S(A)}}},uJ:1c(){1d 1a.fO}};1c v(z,w){1d z.MC(1c(A){1d A.2M(w)})}1c c(z,w){1b A=v(z,w);A.5q(e);1d A}1c g(B,D,w,E,G){1b C=c(B,D);1k(1b z=C.1f-1;z>=0;z--){1b F=C[z];if(w&&!F.bV()){2t}if(E&&F.oi()){2t}if(F.9b()){1b A=F.8r(D,0,G,E);if(A!=1j){1d A}}}1d 1j}1c e(B,A){1b z=B.gi();if(z===1v){z=3W.5s}1b w=A.gi();if(w===1v){w=3W.5s}if(z<w){1d-1}if(z>w){1d 1}1d 0}j.ns="1e.1i";1e.1Z(j,"1e.1i.4c",1e.1z.oW)})(1e.1i);1e.1i.4c.yN=1c(a){1d 1o.oX(1e.1i.4c,1j,1j,1j,a)};1e.1i.4c.mF=1c(a,b){1d 1o.lB(a,b)};(1c(c){1b b=1e.2T.5i;1b f=1e.1z.8t;1b e=1e.1z.Du;1b d=1e.1z.BW;1b a=c.8A=1c(g){1o.2u(a,1a);1a.1t=g;1a.1w=1g 1e.1z.2O(0,0,20,20);1a.1K=1g 1e.1z.aX("",1a.1w);if(a.nJ===1u){1a.1V={3a:"bv",3s:"#h4"};1a.2j="#4T";1a.2v=0}1a.6B=1u;1a.8e=1u;1a.7j="";1a.8o="";1a.aG=1g d(1,1,1,1);1a.4n=1g 1e.1z.jc(0,0)};a.1n={aA:1c(){1d 1a.4L.8s},1J:1c(){1b g=1g 1a.4L(1a.1t);g.1w=1a.1w.1J();g.2D=1a.2D;g.dl=1a.dl;g.dn=1a.dn;g.uI(d.bC(1a.aG));g.2i=(1a.2i)?f.bC(1a.2i):1v;g.1V=1a.1V;g.2j=1a.2j;g.2v=1a.2v;g.3f=1a.3f;g.8e=1a.8e;g.fQ=1a.fQ;g.t8=1a.t8;g.a4=1a.a4;g.7j=1a.7j;g.8o=1a.8o;g.4t=1a.4t;g.5M=1a.5M;g.5L=1a.5L;g.1P=(1a.1P)?1a.1P.1J():1v;g.6x(1a.8F());g.6F(1a.9c());g.jR(1a.gi());g.cC(1a.g1());g.wo(1a.pg());g.bW(1a.bV());g.1F(1u);1d g},2k:1c(){1b g={nz:1a.aA(),7Z:1a.7Z,cj:1a.gi(),3x:1a.3x||1j,id:1a.id||1j,fQ:1a.fQ,1K:1a.6g(),2D:1a.2D,dl:1a.dl,dn:1a.dn,aG:1a.aG,2i:1a.2i,8e:1a.8e,1V:1a.1V,2j:1a.2j,2v:1a.2v,3f:1a.3f,6B:1a.6B,o0:1a.bV(),a4:1a.oi(),7j:1a.7j,8o:1a.8o,4t:1a.4t,5M:1a.fw(),5L:1a.fv(),4a:1a.8F(),4p:1a.9c(),1P:1a.1P?1a.1P.2k():1j};1d g},2E:1c(g){1a.jR(g.cj);1a.cC(g.3x);1a.wo(g.id);1a.6Q(g.1K);1a.4y(g.1V);1a.5o(g.2j);1a.2v=g.2v;1a.3f=g.3f;1a.fQ=g.fQ;1a.2D=g.2D;1a.dl=g.dl;1a.dn=g.dn;if(g.aG){1a.uI(d.bC(g.aG))}if(g.o0!==1v){1a.bW(g.o0)}if(g.8e){1a.8e=1m}if(g.2i){1a.2i=f.bC(g.2i)}if(g.1P){1a.1P=1g c.1X(1u);1a.1P.2E(g.1P)}if(g.a4!==1v){1a.a4=g.a4}1a.7j=g.7j;1a.8o=g.8o;1a.4t=g.4t;1a.5M=g.5M;1a.5L=g.5L;if(g.4a!==1v){1a.6x(g.4a)}if(g.4p!==1v){1a.6F(g.4p)}},4f:1c(j,h){1a.jR(h.2Q("K6",j));1a.8o=h.7W("K2",j);1a.a4=h.3U("K4",j);1a.bW(h.3U("AC",j,1m));1a.1V=h.6p("cR",j);1a.1P=h.Db("1X",j);1b l=h.pQ("Zb",j);if(l){1a.2j=l.1V;1a.2v=l.1q;1a.3f=l.du}1l{1a.2j=h.6p("sQ",j);1a.2v=h.4G("sP",j);1a.3f=1e.1z.hH[h.7W("lU",j)];if(1a.3f===1v){1a.3f=h.2Q("lU",j)}}1a.2i=h.pN("8t",j);if(!1a.2i){1b g=h.7W("Dw",j);1b k=h.4G("Dx",j);if(g!=""&&k>0){1a.2i=1g f(g,k)}}1a.6Q(h.7W("aX",j));1a.2D=h.6p("hl",j);1a.uI(h.zN("JL",j));1a.8e=h.3U("Jt",j);1a.7j=h.7W("Js",j);1a.4t=h.6p("sT",j,1a.4t);1a.5M=h.4G("Jr",j,h.1H.fw());1a.5L=h.4G("Jv",j,h.1H.fv());1a.3x=h.oa(1a,"jB",j);1a.id=h.oa(1a,"Id",j)},4E:1c(h,g){g.3m(1a.gi(),"K6",h);g.aW(1a.8o,"K2",h);g.3O(1a.oi(),"K4",h);g.3O(1a.bV(),"AC",h);if(1a.1V){g.6I(1a.1V,"cR",h)}if(1a.4L.i9){g.BM(1a.1P,"1X",h,1a.4L.i9.ex+"1X")}if(1a.2j){g.6I(1a.2j,"sQ",h)}if(1a.2v!==1v){g.4W(1a.2v,"sP",h)}if(1a.3f!==1v){g.3m(1a.3f,"lU",h)}if(1a.2i){g.pY(1a.2i,"8t",h)}g.aW(1a.6g(),"aX",h);g.6I(1a.2D,"hl",h);g.zC(1a.Jk(),"JL",h);g.3O(1a.8e,"Jt",h);if(1a.7j){g.aW(1a.7j,"Js",h)}g.6I(1a.4t,"sT",h);if(1a.5M!==1v){g.4W(1a.5M,"Jr",h)}if(1a.5L!==1v){g.4W(1a.5L,"Jv",h)}g.nZ(1a,1a.3x,"jB",h);g.nZ(1a,1a.id,"Id",h)},iE:1c(g){},3o:1c(){1d 1a.1t},fV:1c(g){1a.1t=g},3Y:1c(){if(1a.1t&&1a.1t.2S){1a.1t.2S(1m)}},6Q:1c(g){if(g!=1v&&g!==1a.1K.1K){1a.1K.1K=g+"";1a.1F()}},6g:1c(){1d 1a.1K.1K},dS:1c(g){if(1a.2D!==g){1a.2D=g;1a.1F()}},e2:1c(){1d 1a.2D},Zc:1c(g){if(1a.dl!==g){1a.dl=g;1a.1F()}},ZH:1c(){1d 1a.dl},ZI:1c(g){if(1a.dn!==g){1a.dn=g;1a.1F()}},ZG:1c(){1d 1a.dn},uI:1c(g){if(1a.aG!==g){1a.aG=g;1a.1K.3K=g;1a.1F()}},Jk:1c(){1d 1a.aG},oE:1c(g){if(1a.2i!==g){1a.2i=g;1a.1F()}},q1:1c(){1d 1a.2i},4y:1c(g){if(1a.1V!==g){1a.1V=g;1a.1F()}},7g:1c(){1d 1a.1V},5o:1c(g){if(1a.2j!==g){1a.2j=g;1a.1F()}},ZE:1c(){1d 1a.2j},Co:1c(g){if(1a.2j!==g){1a.2j=g;1a.1F()}},j9:1c(){1d 1a.2j},Cn:1c(g){if(1a.2v!==g){1a.2v=g;1a.1F()}},j6:1c(){1d 1a.2v},Qz:1c(g){if(1a.3f!==g){1a.3f=g;1a.1F()}},D8:1c(){1d 1a.3f},cC:1c(g){if(1a.3x!==g){1a.3x=g;1a.3Y()}},g1:1c(){1d 1a.3x},ZF:1c(g){if(1a.8q!==g){1a.8q=g;1a.3Y()}},ye:1c(){if(1a.8q===1v){1d 1}1d 1a.8q},wo:1c(g){if(1a.id!==g){1a.id=g;1a.3Y()}},pg:1c(){1d 1a.id},ZJ:1c(g){if(1a.7j!==g){1a.7j=g;1a.3Y()}},ZN:1c(){1d 1a.7j},ZO:1c(g){if(1a.8e!==g){1a.8e=g;1a.3Y()}},ZM:1c(){1d 1a.8e},iX:1c(){if(!1a.fQ){1a.fQ={}}1d 1a.fQ},jW:1c(){1d 1a.8e||!1a.bV()},jR:1c(g){if(1a.4n.cj!==g){1a.4n.cj=g;if(1a.1t&&1a.1t.oI){1a.1t.oI()}1a.3Y()}},gi:1c(){1d 1a.4n.cj},AM:1c(){if(1a.1t){1d b.6r(1a.1t.1R,1a)}1d 1j},qE:1c(g){if(1a.6B!=g){1a.6B=g;1a.1F()}},oJ:1c(g){if(1a.1t&&1a.6B!=g){if(g){1a.1t.3i.54(1a)}1l{1a.1t.3i.c3(1a)}1a.3Y()}},d9:1c(){1d 1a.6B},ZK:1c(g){if(1a.8o!==g){1a.8o=g||"";1a.3Y()}},ZL:1c(){1d 1a.8o||""},9w:1c(g){g.Oc(1a)},7k:1c(g){g.cv.2p(1a,1a.nX())},5z:1c(g){1a.rH(g)},eP:1c(g){},hE:1c(g){1d 1m},nX:1c(){1d 1j},ok:1c(){if(1a.1t){if(1a.2N){1a.2N.3l(1a,1m)}1a.1t.JF(1a);1a.1t=1j}},2M:1c(g){1d 1u},8r:1c(j,h,k,g){if(1a.1t!=1j&&!1a.1t.kU(1a)){1d 1j}if(g&&1a.1t!=1j&&!1a.1t.s9(1a)){1d 1j}1b l=h>0?1a.2M(j,h):1a.2M(j);1d l?1a:1j},aB:1c(){1d!1a.bV()||1a.a4},lz:1c(){1a.4n.2w=1a;1a.1t.hI(1a.4n);1a.1F(1u)},lG:1c(){if(1a.1t){1a.1t.kE(1a.4n)}},hZ:1c(){},eW:1c(){},1F:1c(g){1a.4n.f5=1a;if(1a.1t){1a.1t.1F();if(g===1v){g=1m}if(g&&1a.1t.2S){1a.1t.2S(1m)}}},bW:1c(g){if(1a.4n.uo==!g){1d}if(g){4m 1a.4n.uo;if(1a.xY){1a.xY()}}1l{1a.4n.uo=1m;if(1a.6B){1a.oJ(1u)}if(1a.xJ){1a.xJ()}}if(1a.1t){1a.1t.1F()}},bV:1c(){1d 1a.4n.uo?1u:1m},ZD:1c(g){if(1a.a4!==g){1a.a4=g;1a.3Y()}},oi:1c(){1d 1a.a4?1m:1u},9b:1c(){if(1a.1t){1b g=1a.1t.5x;if(g&&g.6u){if(g.6u.4B==1a){1d 1m}if(g.6u.4B==1a.1t.3i&&1a.6B){1d 1m}}}1d 1a.wi},AS:1c(g){1a.wi=g},dr:1c(g){1d 1j},ni:1c(g){1d 1a},jZ:1c(){1d 1a},h2:1c(){1d 1a.1K.1K},nm:1c(g){1a.6Q(g)},Cm:1c(g){if(1a.4t!==g){1a.4t=g;1a.1F()}},BK:1c(){1d 1a.4t},JK:1c(g){if(1a.5M!==g){1a.5M=g;1a.1F()}},fw:1c(){if(1a.5M===1v){if(1a.1t.fw){1d 1a.1t.fw()}1d 4}1d 1a.5M},JJ:1c(g){if(1a.5L!==g){1a.5L=g;1a.1F()}},fv:1c(){if(1a.5L===1v){if(1a.1t.fv){1d 1a.1t.fv()}1d 4}1d 1a.5L},dA:1c(){1b g=1a.JD();1d g?1g 1e.1z.ky(g,1a.fw(),1a.fv()):1v},iR:1c(g){if(1a.1P!==g){1a.1P=g;1a.1F()}},cG:1c(){1d 1a.1P},6x:1c(g){if(1a.1K.4a!=g){1a.1K.4a=g;1a.1F()}},8F:1c(){1d 1a.1K.4a},6F:1c(g){if(1a.1K.4p!=g){1a.1K.4p=g;1a.1F()}},9c:1c(){1d 1a.1K.4p},8I:1c(g){if(1a.1P&&g.3F(1a.1P)){1d 1a.1P}if(1a.1t){1b h=1a.1t.1P;if(h&&g.3F(h)){1d h}1b k=1a.1t.9y;if(k){1b j=1a.7u(g,k);if(j){1d j}}}1d 1a.7u(g,c.hc.9j)},7u:1c(h,k){1b g=k.3E["3b:8A"];if(g){if(h.3F(g)){1d g}}1b j=k.3E["3b:4c"];if(j){if(h.3F(j)){1d j}}1d 1j},gr:1c(){if(1a.1V){1d 1a.1V}1b g=1a.8I(c.1X.1n.u5);if(g){1d g.7g()}1d"9D"},aI:1c(){if(1a.2j){1d 1a.2j}1b g=1a.8I(c.1X.1n.Dt);if(g){1d g.j9()}1d"9D"},9k:1c(){if(1a.2v!==1v){1d 1a.2v}1b g=1a.8I(c.1X.1n.Di);if(g){1d g.j6()}1d 0},bz:1c(){if(1a.3f!==1v){1d 1a.3f}1b g=1a.8I(c.1X.1n.D3);if(g){1d g.D8()}1d 0},9R:1c(){if(1a.2D){1d 1a.2D}1b g=1a.8I(c.1X.1n.D4);if(g){1d g.e2()}1d"8k"},gB:1c(){1d 1a.dl},iL:1c(){1d 1a.dn||0},c8:1c(){if(1a.2i){1d 1a.2i}1b j=1a.Jz();1b h=(j&e.A3)!=0;1b g=(j&e.zW)!=0;1b k=(j&e.zZ)!=0;1d 1g f(1a.l5(),1a.hK(),h,g,k)},l5:1c(){1b g=1a.8I(c.1X.1n.Dd);if(g){1d g.iD()}1d"nN-nt"},hK:1c(){1b g=1a.8I(c.1X.1n.BL);if(g){1d g.il()}1d 4},Jz:1c(){1b g=1a.8I(c.1X.1n.BN);if(g){1d g.ON()}1d e.Zv},JD:1c(){if(1a.4t){1d 1a.4t}1b g=1a.8I(c.1X.1n.BH);if(g){1d g.BK()}1d"uj"},fL:1c(){if(1a.t8){1d 1a.t8}if(1a.1t){1d 1a.1t.JC()}1d 2},9f:1c(){1b g={};g.cj=1a.gi();g.3x=1a.3x;g.1K=1a.6g();g.2D=1a.2D;g.2i=1a.2i;g.8e=1a.8e;g.1V=1a.1V;g.2j=1a.2j;g.2v=1a.2v;g.6B=1a.6B;g.o0=1a.bV();g.a4=1a.oi();g.7j=1a.7j;g.8o=1a.8o;g.4t=1a.4t;g.5M=1a.fw();g.5L=1a.fv();g.1P=1a.1P;g.4a=1a.8F();g.4p=1a.9c();1d g},a2:1c(g){1a.jR(g.cj);1a.cC(g.3x);1a.6Q(g.1K);1a.4y(g.1V);1a.5o(g.2j);1a.2v=g.2v;1a.2D=g.2D;1a.bW(g.o0);1a.8e=g.8e;1a.2i=g.2i;1a.1P=g.1P;1a.a4=g.a4;1a.7j=g.7j;1a.8o=g.8o;1a.4t=g.4t;1a.5M=g.5M;1a.5L=g.5L;if(g.4a){1a.6x(g.4a)}if(g.4p){1a.6F(g.4p)}}};a.nJ=1m;1e.1Z(a,"1e.1i.8A")})(1e.1i);(1c(c){1b b=1e.1z.5t;1b e=1e.1z.2O;1b k=1e.1z.bX;1b o=1e.1z.5k;1b l=1e.1z.9t;1b g=1e.1z.hH;1b p=1e.2T.5i;1b q=c.3G=1c(u,t,s){c.4c.6z=1m;1o.2u(q,1a,[u]);1a.1N=c.4q.ja;1a.1r=[];1a.1r.1h(1g o(0,0));1a.1r.1h(1g o(20,20));1a.9L=[];1a.4u=5;1a.4w=5;1a.Av(6y);1a.Zu={};1a.Zs={};1a.g8(c.1M.ou());1a.1K="";1a.4a=3q.4H;1a.6L=c.ey.4H;1a.4F=1g l(0,0);if(u){if(u.dg!==1v){1a.4P(u.dg)}1a.4u=u.fB;1a.4w=u.fE;if(u.9h){1a.j5(u.9h)}if(u.9E){1a.g8(u.9E)}if(u.fy!=1v){1a.7D=u.fy}if(u.di!=1v){1a.6L=u.di}}1a.oj=1g 1e.1z.2O(1a.1r[0].x-1a.4u/2,1a.1r[0].y-1a.4u/2,1a.4u,1a.4u);1a.ol=1g 1e.1z.2O(1a.1r[1a.1r.1f-1].x-1a.4w/2,1a.1r[1a.1r.1f-1].y-1a.4w/2,1a.4w,1a.4w);if(u&&q.nJ===1u){1a.5o(u.gV);1a.oA(u.dk);1a.oN(u.dk)}1a.3I=1g 1e.1i.xc(1a);1a.3I.6L=1a.6L;1a.3I.4a=c.3q.4H;1a.jx();if(u){1a.5Z=u.e4}c.4c.6z=1u};q.1n={1J:1c(){c.4c.6z=1m;1b v=1o.2a(q,1a,"1J",[]);v.1r=p.1J(1a.1r);v.1N=1a.1N;v.5Z=1a.5Z;v.7D=1a.7D;v.5g=1a.5g;v.3I=1a.3I.1J();v.1K=1a.1K;v.6L=1a.6L;v.4u=1a.4u;v.4w=1a.4w;v.j5(1a.5n);v.g8(1a.4v);v.oA(1a.9J);v.oN(1a.9C);v.aS=1a.yY();v.ba=1a.yf();v.8V=1a.yA();v.4k();v.jx();if(1a.3r!=1v){v.3r=[];1k(1b u=0,s=1a.3r.1f;u<s;u++){1b t=1a.3r[u].1J();t.2h=v;v.3r.1h(t)}}c.4c.6z=1u;1d v},2k:1c(){1b u=1o.2a(q,1a,"2k",[]);u.1E=(1a.1E)?1a.1E.7Z:-1;u.1x=(1a.1x)?1a.1x.7Z:-1;u.2r=1a.2r.a0;u.2x=1a.2x.a0;u.vH=1a.wr();u.vy=1a.wC();u.l0=1a.1r;u.1N=1a.1N;u.5n=(1a.5n)?1a.5n.id:1j;u.4v=(1a.4v)?1a.4v.id:1j;u.4u=1a.4u;u.4w=1a.4w;u.9J=1a.HM()||1j;u.9C=1a.IZ()||1j;u.aS=1a.yY();u.ba=1a.yf();u.8V=1a.yA();u.7D=1a.7D;u.5g=1a.5g;u.6L=1a.6L;u.5Z=1a.5Z;if(1a.2r.3d){u.i8=1a.2r.3d.1y}if(1a.2x.3d){u.ic=1a.2x.3d.1y}if(1a.3r!=1v){1b v=[];1k(1b t=0,s=1a.3r.1f;t<s;t++){v.1h(1a.3r[t].2k())}u.3r=v}1d u},2E:1c(v){1o.2a(q,1a,"2E",[v]);if(v.1N!==1v){1a.4P(v.1N)}if(v.6L!==1v){1a.zk(v.6L)}1a.j5(v.5n?c.1D.1I(v.5n):1j);if(v.9J){1a.oA(v.9J)}if(v.4u){1a.x6(v.4u)}1a.g8(v.4v?c.1D.1I(v.4v):1j);if(v.9C){1a.oN(v.9C)}if(v.4w){1a.rd(v.4w)}if(v.aS){1a.IU(v.aS)}if(v.ba){1a.Jc(v.ba)}if(v.8V){1a.IC(v.8V)}if(v.vH!==1v){1a.2r.cZ(v.vH,1u)}if(v.vy!==1v){1a.2x.cZ(v.vy,1u)}1b w=1g 1e.1z.5k(v.2r.x,v.2r.y);1b z=1g 1e.1z.5k(v.2x.x,v.2x.y);if(!w.7s()){1a.2r.a0=w}if(!z.7s()){1a.2x.a0=z}1a.oQ(v.l0,1m);if(v.i8!==1v){1a.2r.3d.1y=v.i8}if(v.ic!==1v){1a.2x.3d.1y=v.ic}if(v.3r){1a.3r=[];1k(1b u=0,s=v.3r.1f;u<s;u++){1b t=1g c.nq(1a);t.2E(v.3r[u]);1a.3r.1h(t)}}1a.7D=v.7D;1a.5g=v.5g;if(v.5Z!=1v){1a.5Z=v.5Z}},4f:1c(C,t){1o.2a(q,1a,"4f",[C,t]);1b B=t.yv<16?t.2Q("1X",C,1a.1N):t.2Q("1D",C,1a.1N);1a.4P(B);1a.Kp(t.I6("hv",C));if(1a.2r.cZ){1a.2r.cZ(t.2Q("KJ",C),1m)}if(1a.2x.cZ){1a.2x.cZ(t.2Q("KI",C),1m)}1a.2r.3d.1y=t.2Q("KF",C);1a.2r.3d.4r=1a.fF();1a.2x.3d.1y=t.2Q("KK",C);1a.2x.3d.4r=1a.bq();1a.7D=t.3U("KS",C);1a.5Z=t.3U("L7",C);1a.5g=t.3U("L4",C);1a.zk(t.2Q("Ld",C));if(t.hQ>1){1a.j5(t.hX("yp",C));1a.g8(t.hX("yt",C))}1l{1a.j5(t.oe("yp",C));1a.g8(t.oe("yt",C))}1a.rd(t.4G("Lc",C));1a.x6(t.4G("Lb",C));1a.9C=t.6p("KZ",C);1a.9J=t.6p("KV",C);1b u=t.pQ("Zx",C);if(u){1a.aS=u.1V;1a.ba=u.1q;1a.8V=u.du}1l{1a.aS=t.6p("KU",C);1a.ba=t.4G("KY",C);1a.8V=1e.1z.hH[t.7W("yz",C)];if(1a.8V===1v){1a.8V=t.2Q("yz",C)}}1b z=t.Ip(C,"Km");if(z){1a.3r=[];1b s=z.4K("Kl");1k(1b v=0;v<s.1f;++v){1b w=s[v];1b A=1g c.nq(1a);A.4f(w,t);3r.1h(A)}}},4E:1c(u,t){1o.2a(q,1a,"4E",[u,t]);t.iC(1o.1Y(c.9o,1a.2r.1C)?1j:1a.2r.1C,"Ga",u);t.rW(1a.2r.a0,"ZB",u);t.3m(1a.ve(),"KF",u);t.iC(1o.1Y(c.9o,1a.2x.1C)?1j:1a.2x.1C,"G9",u);t.rW(1a.2x.a0,"ZC",u);t.3m(1a.yu(),"KK",u);if(1a.2r.cZ){t.3m(1a.2r.2A,"KJ",u)}if(1a.2x.cZ){t.3m(1a.2x.2A,"KI",u)}t.3m(1a.gz(),"1D",u);t.3m(1a.e9(),"ZA",u);t.KD(1a.1r,"hv",u);t.3O(1a.7D,"KS",u);t.3O(1a.5Z,"L7",u);t.3O(1m,"Zy",u);t.3O(1a.5g,"L4",u);t.3m(1a.Kn(),"Ld",u);t.hW(1a.HY(),"yp",u);t.hW(1a.HV(),"yt",u);t.4W(1a.HN(),"Lc",u);t.4W(1a.HW(),"Lb",u);t.6I(1a.9C,"KZ",u);t.6I(1a.9J,"KV",u);if(1a.aS!==1v){t.6I(1a.aS,"KU",u)}if(1a.ba!==1v){t.4W(1a.ba,"KY",u)}if(1a.8V!==1v){t.3m(1a.8V,"yz",u)}if(1a.3r){1b s=t.2m("Km",u);3r.1B(1c(w){1b v=t.2m("Kl",s);w.4E(v,t)})}},1F:1c(){1o.2a(q,1a,"1F");if(1a.3r){1k(1b t=0,s=1a.3r.1f;t<s;t++){1a.3r[t].1F()}}},4P:1c(s){if(1a.1N!=s){1a.1N=s;if(!n[1a.1N].o9(1a)){n[1a.1N].bo(1a,1a.fF(),1a.bq())}1a.o8();1a.1F()}},gz:1c(){1d 1a.1N},Kp:1c(s){1a.1r=s;1a.4k();1a.3Y()},10F:1c(){1d 1a.1r},zk:1c(s){if(1a.6L!=s){1a.6L=s;1a.jx();1a.1F();1a.3Y()}},Kn:1c(){1d 1a.6L},6x:1c(s){if(1a.4a!=s){1a.4a=s;1a.jx();1a.1F();1a.3Y()}},8F:1c(){1d 1a.4a},h2:1c(){1d 1a.1K},6Q:1c(s){if(s!=1v&&s!==1a.1K){1a.1K=s+"";1a.1F()}},6g:1c(){1d 1a.1K},os:1c(u,s){1b t=1g c.7A({2h:1a,4b:u,6k:s});1a.1t.2l(c.1S.tw,t);1d t.a6()},o1:1c(u,s){1b t=1g c.7A({2h:1a,4b:u,6k:s});1a.1t.2l(c.1S.t1,t);1d t.a6()},kt:1c(){1a.1r[0]=1a.2r.dI();1a.1r[1a.1r.1f-1]=1a.2x.dI();if(!1a.2r.iA(1a.2x)){1a.1r[0]=1a.2r.bN(1a.1r[0],1a.1r[1]);1a.1r[1a.1r.1f-1]=1a.2x.bN(1a.1r[1a.1r.1f-1],1a.1r[1a.1r.1f-2])}1a.2r.9H();1a.2x.9H()},Bt:1c(){1a.1r[0]=1a.2r.dI();if(!1a.2r.iA(1a.2x)){1a.1r[0]=1a.2r.bN(1a.1r[0],1a.1r[1])}1a.2r.9H();1a.4k();if(1a.5Z){1a.fp({4k:1u})}},Br:1c(){1a.1r[1a.1r.1f-1]=1a.2x.dI();if(!1a.2r.iA(1a.2x)){1a.1r[1a.1r.1f-1]=1a.2x.bN(1a.1r[1a.1r.1f-1],1a.1r[1a.1r.1f-2])}1a.2x.9H();1a.4k();if(1a.5Z){1a.fp({4k:1u})}},KC:1c(){1k(1b t=0,s=1a.1r.1f-1;t<s;t++){1b z=1a.1r[t];1b w=1a.1r[t+1];1a.1w=1a.2s();1a.9L.1h(o.11I(z,w));1b v=o.d5(z,{x:1a.4u/2,y:1a.4u/2});1b u=o.d5(w,{x:1a.4u/2,y:1a.4u/2});if(t===0){1a.oj=1g 1e.1z.2O(z.x-1a.4u/2,z.y-1a.4u/2,1a.4u,1a.4u)}if(t===1a.1r.1f-2){1a.ol=1g 1e.1z.2O(w.x-1a.4w/2,w.y-1a.4w/2,1a.4w,1a.4w)}}},7k:1c(s){1o.2a(q,1a,"7k",[s]);if(s.4X===c.3z.4Y&&1a.2r!=1j){1a.2r.ny(s.cW);1a.1r[0]=1a.2r.3d.4r;1a.4k()}},eP:1c(u){1b z=u.3J.1y;1b t=u.cv.1G(1a).l0;1b w=1g o(t[z].x,t[z].y);1b s=w.d5(u.ws());1b A=(z===0||z===1a.1r.1f-1);if(A){1a.Ke(s,z>0)}1b v=A&&1a.8z!=1j&&!1o.1Y(c.9o,1a.8z.1C);1a.1r[z]=s=v?1a.8z.3d.4r:s;if(u.4X===c.3z.4Y){n[1a.1N].bo(1a,1a.fF(),1a.bq())}1l{n[1a.1N].ob(1a,s,u)}if(1a.7D&&1a.1N!=c.4q.a5&&1a.1r.1f>2&&(z==1||z==1a.1r.1f-2)){1a.gm()}1a.4k(1m,t)},hP:1c(s){1b t=1u;1b u=s.3J.1y;1b v=s.6R;if(u===0||u===1a.1r.1f-1){if(u===0){1a.vQ(1a.8z)}1l{if(u===1a.1r.1f-1){1a.vN(1a.8z)}}1a.2r.9H();1a.2x.9H();1a.1E=1a.2r.1C;1a.1x=1a.2x.1C;if(s.4X===c.3z.4Y){if(1a.1E==1a.1x&&!1o.1Y(c.9o,1a.1E)){1a.vw()}1l{n[1a.1N].bo(1a,1a.fF(),1a.bq())}}if(1a.5Z){1a.fp({4k:1u})}}1a.4k()},hE:1c(s){1b t=s.3J.1y;if(t!==0&&t!==(1a.1r.1f-1)){1d 1m}if(1a.8z==1j){1d 1a.1t.dw}if(!1a.8z.1C.6D&&t===1a.1r.1f-1){1d 1u}if(!1a.1t.cl){if(t==0&&1a.1x==1a.8z.1C){1d 1u}if(t==1a.1r.1f-1&&1a.1E==1a.8z.1C){1d 1u}}1d 1m},nX:1c(){1d{l0:p.1J(1a.1r)}},rH:1c(s){1b u=s.cv.1G(1a);if(u!=1j){1b t=1a.1r;1a.1r=u.l0;1a.4k(1m,t)}},Ke:1c(s,t){1b u=1a.1t.go(s,1m,1m);if(u==1j){u=1a.1t.Kd(s,1a.1t.Ki,(t)?1a.1E:1a.1x,1m)}if(u!=1j){if(t&&!u.6D||!t&&!u.7p){u=1j}}if(u==1j&&1a.1t.dw){u=1a.oC()}if(u){if(1a.8z==1j||(1a.8z!=1j&&1a.8z.ug(u,s))){1a.8z=u.lL(1a,s,t)}if(1a.8z!=1j){1a.8z.ny(s)}1d}1a.8z=1j},eC:1c(s){1b t=1g 1e.1z.9t(100,25/1a.1t.3A);1d 1g 1e.1z.2O(s.x-t.1q/2,s.y-t.1p/2,t.1q,t.1p)},Kx:1c(s,t){1b u=t?1u:1m;if(1a.2r!=1j){1a.2r.cp();1a.2r=1j}1a.1E=s;if(1a.1E!=1j){if(!t){t=s.oP(s.5C(),1a,1u)}1a.2r=1a.1E.lL(1a,t.4r,1u,1m);1a.2r.3d=t;1a.1r[0]=t.4r}if(u){1a.2r.cx();1a.kt();n[1a.1N].eR(1a,1m);1a.1F()}},de:1c(){1d 1a.1E},yb:1c(s){1b t=1a.1E.yl(s);if(!t){1d}1a.2r.3d=t;1a.1r[0]=t.4r;n[1a.1N].eR(1a,1m);1a.1F()},ve:1c(){if(!1a.2r.3d){1d-1}1l{1d 1a.2r.3d.1y}},Kt:1c(s,t){1b u=t?1u:1m;if(1a.2x!=1j){1a.2x.cp();1a.2x=1j}1a.1x=s;if(1a.1x!=1j){if(!t){t=s.oP(s.5C(),1a,1m)}1a.2x=1a.1x.lL(1a,t.4r,1m,1m);1a.2x.3d=t;1a.1r[1a.1r.1f-1]=t.4r;1a.2x.9H()}if(u){1a.2x.cx();1a.kt();n[1a.1N].eR(1a,1m);1a.1F()}},d7:1c(){1d 1a.1x},yc:1c(s){1b t=1a.1x.yl(s,1m);if(!t){1d}1a.2x.3d=t;1a.1r[1a.1r.1f-1]=t.4r;n[1a.1N].eR(1a,1m);1a.1F()},yu:1c(){if(!1a.2x.3d){1d-1}1l{1d 1a.2x.3d.1y}},11F:1c(){if(1a.1E==1j||1o.1Y(c.9o,1a.1E)){1d 1u}if(1a.1x==1j||1o.1Y(c.9o,1a.1x)){1d 1u}1d 1m},ui:1c(){1a.1N=c.4q.ja;1a.1r.1f=2;1a.kt();1a.4k()},lq:1c(z,u,t,w,B){if(!z){1a.ui();1d}1a.1r=[];1k(1b v=0,s=z.1f;v<s;v++){1b A=z[v];1a.1r.1h(1g o(A.x+u,A.y+t))}if(w){1a.kt();1a.4k()}if(!B){n[1a.1N].kJ(1a)}},gm:1c(){if(1a.7D&&1a.1E!=1a.1x){1a.vL(c.3z.7q,1u);if(c.3V.gJ){1b t=c.3V.eq(1a.de());if(t!=1j){1a.1r[0]=1a.2r.o5();if(1a.1N==c.4q.a5){f.r6(1a)}}1b s=c.3V.eq(1a.d7());if(s!=1j){1a.1r[1a.1r.1f-1]=1a.2x.o5();if(1a.1N==c.4q.a5){f.11H(1a)}}}}1l{1a.1r[0]=1a.2r.o5();1a.1r[1a.1r.1f-1]=1a.2x.o5()}n[1a.1N].eR(1a,1u)},4k:1c(){1b s=1m;if(6y.1f>0){s=6y[0]}1b t=1j;if(6y.1f>1){t=6y[1]}1a.9L=[];1a.KC();if(s){if(1a.2r!=1j){1a.2r.9H()}if(1a.2x!=1j){1a.2x.9H()}}if(1a.5n){if(!1a.5Q){1a.5Q=1g c.b8(1a.5n)}1a.5Q.hU(1a.oj,1a.9L[0]+90)}if(1a.4v){if(!1a.4o){1a.4o=1g c.b8(1a.4v)}1a.4o.hU(1a.ol,1a.9L[1a.9L.1f-1]+90)}1b v=1a.3o();if(v&&v.ij()!=c.eT.ds){if(t){1b u=1a.xV(t);u=u.9I(1a.2s());1a.o8(u)}1l{1a.o8()}}1a.1F()},KB:1c(){if(1a.2r!=1j){1a.2r.cx()}if(1a.2x!=1j){1a.2x.cx()}},vQ:1c(s){1b t=1a.2r;1a.2r=s;if(t!=1j){t.cp()}1a.2r.cx()},vN:1c(s){1b t=1a.2x;1a.2x=s;if(t!=1j){t.cp()}1a.2x.cx()},8c:1c(s){if(!1a.1t){1d 1j}1b v=1a.fL();1b z=b.3h(1a.1t.2o);1b u=1a.1r;1b w=1g e(0,0,v,v);if(1a.1t){w=w.5B(1a.1t.uG)}1k(1b t=0;t<u.1f;++t){w.11q(u[t]);if(w.2M(s)){1d{2w:1a,1y:t}}}},Av:1c(t){if(t.1f===0){1d}1a.1t=t[0];if(t[1]&&1o.1Y(c.2Z,t[1])){1a.1E=t[1];1a.Kx(1a.1E,1a.1E.oP(1a.1E.5C(),1a,1u))}1l{1b s=t[1]&&1o.1Y(o,t[1])?t[1]:1a.1r[0];1a.2r=1g c.sB(1a,1u,s);1a.1E=1a.oC()}if(t[2]&&1o.1Y(c.2Z,t[2])){1a.1x=t[2];1a.Kt(1a.1x,1a.1x.oP(1a.1x.5C(),1a,1m))}1l{1b s=t[2]&&1o.1Y(o,t[2])?t[2]:1a.1r[1a.1r.1f-1];1a.2x=1g c.sB(1a,1m,s);1a.1x=1a.oC()}1a.kt();1a.4k();1a.vL(c.3z.7q,1u)},11n:1c(s){1a.1r[0]=s},fF:1c(){1d 1a.1r[0].1J()},11w:1c(s){1a.1r[1a.1r.1f-1]=s},bq:1c(){1d 1a.1r[1a.1r.1f-1].1J()},mV:1c(s){1d 1a.1r[s]},LL:1c(){1d 1a.4L.LN.8s},oC:1c(){if(1a.1t){1d 1a.1t.6K}1d 1g c.9o()},2M:1c(s){1b v=1a.2s();1b t=-1;if(1a.1t.g4!=0){t=1a.1t.g4}1l{t=c.1A.11u(1a.1t.2o)}1b w=t/2;1b u=t*2/3;if(1a.w2(s)!=1j){1d 1m}v=c.1A.5B(v,w,w);if(!v.2M(s)){1d 1u}if(n[1a.1N].2M(1a,s,u)){1d 1m}if(1a.6B&&1a.8c(s)){1d 1m}1d 1u},2s:1c(){1d 1a.xV(1a.1r)},xV:1c(z){1b C=z[0];1b B=z[z.1f-1];1b u=1s.2b(C.x,B.x);1b A=1s.1U(C.x,B.x);1b w=1s.2b(C.y,B.y);1b s=1s.1U(C.y,B.y);1k(1b v=1;v<z.1f-1;++v){u=1s.2b(u,z[v].x);w=1s.2b(w,z[v].y);A=1s.1U(A,z[v].x);s=1s.1U(s,z[v].y)}1d 1g 1e.1z.2O(u,w,A-u,s-w)},jx:1c(){if(!1a.1t){1d}1b ae=1e.cd;1a.3I.yX();1a.4F=1a.1t.9r(1a.1K,1a.c8());1b U=1a.e9();if(1a.6L==c.ey.ce){1b B=1s.6i(1a.1r.1f/2-1);1b A=1;1b ag=B;1b aj=0,ax=0,P=0;if(1a.1N!=c.4q.7e){if(1a.1N==c.4q.a5||(1a.1N==c.4q.ja&&U%2==1)){do{1b z=ae.ys(1a.1r[B],1a.1r[B+1]);ax=z.a;aj=z.r;if(aj>P){P=aj;ag=B}B=B+A;A=-c.1A.I7(A)*(1s.3j(A)+1);if(B<0||B>=1a.1r.1f-1){1Q}}2L(1a.4F.1q>aj);B=ag;x=(1a.1r[B].x+1a.1r[B+1].x)/2;y=(1a.1r[B].y+1a.1r[B+1].y)/2}1l{B=B+1;x=1a.1r[B].x;y=1a.1r[B].y}}1l{if(U%2==1){B=1s.6i((B+1)/4);1b ah=c.1A.dd(1a.1r,B,0.5);x=ah.x;y=ah.y}1l{B=1s.6i((B+1)/4);1b ah=1a.1r[(B+1)*3];x=ah.x;y=ah.y}}if(1a.1N!=c.4q.7e){if(1a.1N==c.4q.a5||(1a.1N==c.4q.ja&&U%2==1)){1b ad=1a.1r[B];1b ab=1a.1r[B+1];1b z=ae.7X(ad,ab);ax=z.a;aj=z.r}1l{1b H=0,ao=0;1b z=ae.7X(1a.1r[B-1],1a.1r[B]);ax=z.a;aj=z.r;1b z=ae.7X(1a.1r[B],1a.1r[B+1]);ao=z.a;G=z.r;ax=(ax+ao)/2}}1l{if(U%2==1){1b ad=c.1A.dd(1a.1r,B,0.45);1b ab=c.1A.dd(1a.1r,B,0.55);1b z=ae.7X(ad,ab);ax=z.a;aj=z.r}1l{1b ad=c.1A.dd(1a.1r,B,0.95);1b ab=c.1A.dd(1a.1r,B+1,0.I0);1b z=ae.7X(ad,ab);ax=z.a;aj=z.r}}ax=8j-ax;if(ax>90&&ax<z3){ax-=8j}1a.3I.en.1h(1a.1K);1a.3I.9L.1h(ax);1a.3I.9G.1h(1g e(x,y,1a.4F.1q,1a.4F.1p))}1l{if(1a.6L==c.ey.4H){if(1a.1r.1f%2==1){x=1a.1r[1s.6i(1a.1r.1f/2)].x;y=1a.1r[1s.6i(1a.1r.1f/2)].y}1l{x=1a.1r[1a.1r.1f/2-1].x+1a.1r[1a.1r.1f/2].x;y=1a.1r[1a.1r.1f/2-1].y+1a.1r[1a.1r.1f/2].y;x/=2;y/=2}1a.3I.en.1h(1a.1K);1a.3I.9L.1h(0);1a.3I.9G.1h(1g e(x,y,1a.4F.1q,1a.4F.1p))}1l{if(1a.6L==c.ey.yT){1b X=3q.4H;1b af=3q.4H;1b I=1a.IM();1b E=1a.Iu(I).1J();1b R=1a.Iv(I).1J();1b w=1s.3j(E.x-R.x);1b v=1s.3j(E.y-R.y);if(w>v*1.3&&1a.4a!=3q.4H){if(E.x<R.x&&1a.4a==3q.c0){X=3q.c0;E.y-=1a.4F.1p/2;E.x+=1a.4w;1a.3I.9G.1h(1g e(E.x,E.y,1a.4F.1q,1a.4F.1p))}1l{if(E.x>R.x&&1a.4a==3q.ek){X=3q.c0;R.y-=1a.4F.1p/2;R.x+=1a.4w;1a.3I.9G.1h(1g e(R.x,R.y,1a.4F.1q,1a.4F.1p))}1l{if(E.x<R.x&&1a.4a==3q.ek){X=3q.ek;R.x-=1a.4w;1a.3I.9G.1h(1g e(R.x-1a.4F.1q,R.y-1a.4F.1p/2,1a.4F.1q,1a.4F.1p))}1l{X=3q.ek;E.x-=1a.4w;1a.3I.9G.1h(1g e(E.x-1a.4F.1q,E.y-1a.4F.1p/2,1a.4F.1q,1a.4F.1p))}}}}1l{1b u=1a.IE(I);1a.3I.9G.1h(1g e(u.x,u.y,1a.4F.1q,1a.4F.1p))}1a.3I.en.1h(1a.1K);1a.3I.9L.1h(0);1a.3I.4a=X;1a.3I.4p=af}1l{if(1a.6L==c.ey.Kv){1a.3I.4a=3q.c0;1a.3I.4p=3q.c0;1b Y=p.1J(1a.1r);1b S=0;if(1a.1N==c.4q.7e){1b C=[];n[1a.1N].hz(1a,C);1b ac=c.1A.Ln();1k(1b ar=0;ar<C.1f;ar++){C[ar].hd(ac)}Y=ac.Lj();S=1}if(Y[0].x>Y[Y.1f-1].x){1k(1b ar=0;ar<Y.1f/2;ar++){1b ai=Y[ar];Y[ar]=Y[Y.1f-ar-1];Y[Y.1f-ar-1]=ai}}1b L=1a.4F.1p;1b Q=Y[0];1k(1b ar=S;ar<Y.1f-1;ar++){1b am=Y[ar];1b ai=Y[ar+1];1b z=ae.7X(ai,am);1b ax=z.a;1b aj=z.r;1b N=0;1b al=0;1b G=0;if(ar<Y.1f-2){1b au=Y[ar+1];1b Z=Y[ar+2];1b z=ae.7X(au,Z);al=z.a;G=z.r;if(al<ax){al+=aY}N=al-ax}1b W=0;1b K=0;1b z=ae.7X(Q,ai);K=z.a;W=z.r;1b aq=Q;1b ap=ai;1b an=1g o(0,0);1b ak=1g o(0,0);1b s;if(N<8j){ak=ae.8S(aq,{a:ax-90,r:L});an=ae.8S(ap,{a:ax-90,r:L});s=W;Q=ai}1l{ak=ae.8S(aq,{a:ax-90,r:L});1b D=(aY-N)/2;1b V=L/1s.dT(c.1A.mK(D));1b O=1s.bR(1s.5O(V,2)-1s.5O(L,2));if(O>W){O=W;V=1s.bR(1s.5O(O,2)+1s.5O(L,2))}an=ae.8S(ap,{a:ax-D,r:V});ap=ae.8S(ap,{a:ax,r:O});s=W-O;if(O>G){O=G}Q=ae.8S(ai,{a:al,r:O})}1a.3I.9G.1h(1g e(ak.x,ak.y,s,L));1a.3I.9L.1h(8j-ax)}1b M=1a.1K;1k(1b ar=0;ar<1a.3I.9G.1f;ar++){1b aw=1a.3I.9G[ar];1b av=1a.Ir(M,aw.1q,1a.c8());if(av==0){1a.3I.en.1h("");2t}1b J=M.h8(0,av);M=M.h8(av);1a.3I.en.1h(J)}}1l{if(1a.6L==c.ey.Ku){if(1a.1r.1f%2==1){1b aa=1s.6i(1a.1r.1f/2);1b T=1a.1r[aa];1b F=1a.1r[aa-1];1b at=1a.1r[aa+1];if(ae.5E(T,F)>ae.5E(T,at)){x=(F.x+T.x)/2;y=(F.y+T.y)/2}1l{x=(at.x+T.x)/2;y=(at.y+T.y)/2}}1l{x=1a.1r[1a.1r.1f/2-1].x+1a.1r[1a.1r.1f/2].x;y=1a.1r[1a.1r.1f/2-1].y+1a.1r[1a.1r.1f/2].y;x/=2;y/=2}1a.3I.en.1h(1a.1K);1a.3I.9L.1h(0);1a.3I.9G.1h(1g e(x,y,1a.4F.1q,1a.4F.1p))}1l{if(1a.6L==c.ey.I8){1b B=1s.6i(1a.1r.1f/2-1);1b A=1;1b ag=B;1b aj=0,ax=0,P=0;if(1a.1N!=c.4q.7e){do{1b z=ae.7X(1a.1r[B],1a.1r[B+1]);ax=z.a;aj=z.r;if(aj>P){P=aj;ag=B}B=B+A;A=-c.1A.I7(A)*(1s.3j(A)+1);if(B<0||B>=1a.1r.1f-1){1Q}}2L(1a.4F.1q>aj);B=ag;x=(1a.1r[B].x+1a.1r[B+1].x)/2;y=(1a.1r[B].y+1a.1r[B+1].y)/2}1l{if(U%2==1){B=1s.6i((B+1)/4);1b ah=c.1A.dd(1a.1r,B,0.5);x=ah.x;y=ah.y}1l{B=1s.6i((B+1)/4);1b ah=1a.1r[(B+1)*3];x=ah.x;y=ah.y}}if(1a.1N!=c.4q.7e){1b ad=1a.1r[B];1b ab=1a.1r[B+1];1b z=ae.7X(ad,ab);ax=z.a;aj=z.r}1l{if(U%2==1){1b ad=c.1A.dd(1a.1r,B,0.45);1b ab=c.1A.dd(1a.1r,B,0.55);1b z=ae.7X(ad,ab);ax=z.a;aj=z.r}1l{1b ad=c.1A.dd(1a.1r,B,0.95);1b ab=c.1A.dd(1a.1r,B+1,0.I0);1b z=ae.7X(ad,ab);ax=z.a;aj=z.r}}ax=8j-ax;if(ax>90&&ax<z3){ax-=8j}1a.3I.en.1h(1a.1K);1a.3I.9L.1h(ax);1a.3I.9G.1h(1g e(x,y,1a.4F.1q,1a.4F.1p))}}}}}}},bQ:1c(E){1b t=1a.2s();if(!t.bc(E)){1d 1u}if(E.2c(t)){1d 1m}1k(1b C=0,A=1a.1r.1f;C<A;C++){if(E.2M(1a.1r[C])){1d 1m}}1b D=[];D.1h(1g o(E.x,E.y));D.1h(1g o(E.2y(),E.y));D.1h(1g o(E.2y(),E.2V()));D.1h(1g o(E.x,E.2V()));1k(1b C=0,z=1a.1r.1f-1;C<z;++C){1k(1b B=0;B<4;++B){1b u=1a.1r[C];1b s=1a.1r[C+1];1b w=D[B];1b v=D[(B+1)%4];if(c.1A.vr(u,s,w,v)){1d 1m}}}1d 1u},6N:1c(){1d 1a.2s()},hZ:1c(){1a.4n.f5=1a},eW:1c(){1b v=1a.4n.2H=[];if(1a.5n&&1a.5n.hm()&&!c.1D.7T){1a.5n=c.1D.1I(1a.5n.id);if(1a.5Q){1a.5Q.4P(1a.5n)}}if(1a.4v&&1a.4v.hm()&&!c.1D.7T){1a.4v=c.1D.1I(1a.4v.id);if(1a.4o){1a.4o.4P(1a.4v)}}1b z=1a.9k();1b C=1a.bz();1b B=1a.aI();n[1a.1N].hz(1a,v);if(1a.5n){if(!1a.5Q){1a.5Q=1g c.b8(1a.5n)}1a.5Q.AA(1a.oj,1a.1r[0].1J(),1a.IK(1a.1r));1a.5Q.2v=1a.y5();1a.5Q.7O=1a.pa();1a.5Q.8w=1a.iF();1a.5Q.gU=1a.iF();1a.5Q.3f=1a.yw();v.1h(1a.5Q)}if(1a.4v){if(!1a.4o){1a.4o=1g c.b8(1a.4v)}1a.4o.AA(1a.ol,1a.1r[1a.1r.1f-1].1J(),1a.IG(1a.1r));1a.4o.2v=1a.y5();1a.4o.7O=1a.pa();1a.4o.8w=1a.iF();1a.4o.gU=1a.iF();1a.4o.3f=1a.yw();v.1h(1a.4o)}1a.3I.2i=1a.c8();1a.3I.2j=1a.9R();1a.3I.3P=1a.gB();1a.3I.2v=1a.9k();1a.jx();v.1h(1a.3I);if(1a.3r){1k(1b u=0,s=1a.3r.1f;u<s;u++){1b A=1a.3r[u];A.1K.2i=A.2i!=1v?A.2i:1a.c8();A.1K.2j=A.2D!=1v?A.2D:1a.9R();A.1K.3P=A.2D!=1v?A.2D:1a.gB();A.1K.2v=1a.iL();A.i5()}1a.1t.xj();1b t=b.3h(1a.1t.2o);1k(1b u=0,s=1a.3r.1f;u<s;u++){1b A=1a.3r[u];if(A.1V){1b w=A.9O.5B(t);w.1V=w.2j=A.1V;v.1h(w)}v.1h(A.1K)}}if(1a.dD){1a.dD(1a)}},lm:1c(z){1b u=1a.1t;z.8Q=c.1A.7g(z,u.ma,u.2s());z.6U="8k";if(z.hN){z.hN([])}z.7i=1/z.7w;1b w=1a.fL();1b t=w/2;1k(1b v=0;v<1a.1r.1f;v++){1b s=1a.1r[v];if(v%3>0||1a.1N!=c.4q.7e){z.iT(s.x-t,s.y-t,w,w);z.ls(s.x-t,s.y-t,w,w)}1l{c.mp.lV(z,s,t)}}},j5:1c(s){if(5G s=="bB"){s=c.1D.1I(s)}if(1a.5n!=s){1a.5n=s;if(1a.5Q){if(1a.5n){1a.5Q.4P(1a.5n);1a.5Q.7O=1a.J0();1a.5Q.8w=1a.iF()}1l{1a.5Q=1j;4m 1a.5Q}}1a.1F()}},HY:1c(){1d 1a.5n},x6:1c(s){if(s!=1a.4u){1a.4u=s;1b t=1a.1r[0];1a.oj=1g 1e.1z.2O(t.x-1a.4u/2,t.y-1a.4u/2,1a.4u,1a.4u);1a.1F()}},HW:1c(){1d 1a.4u},g8:1c(s){if(5G s=="bB"){s=c.1D.1I(s)}if(1a.4v!=s){1a.4v=s;if(1a.4o){if(1a.4v){1a.4o.4P(1a.4v);1a.4o.7O=1a.pa();1a.4o.8w=1a.iF()}1l{1a.4o=1j;4m 1a.4o}}1a.1F()}},HV:1c(){1d 1a.4v},rd:1c(s){if(s!=1a.4w){1a.4w=s;1b t=1a.1r[1a.1r.1f-1];1a.ol=1g 1e.1z.2O(t.x-1a.4w/2,t.y-1a.4w/2,1a.4w,1a.4w);1a.1F()}},HN:1c(){1d 1a.4w},oA:1c(s){if(1a.9J!=s){1a.9J=s;if(1a.5n){if(!1a.5Q){1a.5Q=1g c.b8(1a.5n)}1a.5Q.7O=s;1a.1F()}1l{1a.3Y()}}},HM:1c(){1d 1a.9J},J0:1c(){if(1a.9J){1d 1a.9J}1d 1a.gr()},oN:1c(s){if(1a.9C!=s){1a.9C=s;if(1a.4v){if(!1a.4o){1a.4o=1g c.b8(1a.4v)}1a.4o.7O=s;1a.1F()}1l{1a.3Y()}}},IZ:1c(){1d 1a.9C},pa:1c(){if(1a.9C){1d 1a.9C}1d 1a.gr()},IU:1c(s){if(1a.aS!=s){1a.aS=s;if(1a.4v){if(!1a.4o){1a.4o=1g c.b8(1a.4v)}1a.4o.8w=s;1a.1F()}1l{1a.3Y()}}},yY:1c(){1d 1a.aS},iF:1c(){if(1a.aS){1d 1a.aS}1d 1a.aI()},Jc:1c(s){if(1a.ba!=s){1a.ba=s;if(1a.4v){if(!1a.4o){1a.4o=1g c.b8(1a.4v)}1a.4o.2v=s;1a.1F()}1l{1a.3Y()}}},yf:1c(){1d 1a.ba},y5:1c(){if(1a.ba){1d 1a.ba}1d 1a.9k()},IC:1c(s){if(1a.8V!=s){1a.8V=s;if(1a.4v){if(!1a.4o){1a.4o=1g c.b8(1a.4v)}1a.4o.3f=s;1a.1F()}1l{1a.3Y()}}},yA:1c(){1d 1a.8V},yw:1c(){if(1a.8V){1d 1a.8V}1d 1a.bz()},oQ:1c(s,t){1a.lq(s,0,0,1u,t);1a.4k(1u)},vw:1c(){1b t=1a.1E.1w.Pg();1b s=b.3h(1a.1t.2o)*8;1a.1N=c.4q.7e;1a.1r=[t,t.Iw(-s,-1.5*s),t.Iw(+s,-1.5*s),t.1J()];1a.4k()},fp:1c(s){if(1a.1t.og){1a.1t.og.fp(1a);1a.sl(s)}},sl:1c(s){n[1a.1N].kJ(1a);if(!(s&&s.4k===1u)){1a.4k()}},10Y:1c(){1d 1a.5Z},10X:1c(s){1a.5Z=s;if(s){1a.fp()}},10V:1c(){1d 1a.7D},10W:1c(s){if(1a.7D!==s){1a.7D=s;1a.3Y()}},vL:1c(t,v){1b u=1a.2r.dI();1b s=1a.2x.dI();if(!1a.2r.iA(1a.2x)){u=1a.2r.bN(u,t==c.3z.4Y||v?s:1a.1r[1]);s=1a.2x.bN(s,t==c.3z.4Y||v?u:1a.1r[1a.1r.1f-2])}1a.2r.mb(u);1a.2x.mb(s);1a.1r[0]=1a.2r.3d.4r;1a.1r[1a.1r.1f-1]=1a.2x.3d.4r;1a.2r.9H(1u);1a.2x.9H(1u)},IG:1c(u){1b t=u[u.1f-1];1k(1b s=u.1f-2;s>=0;--s){if(!c.1A.II(u[s],t)){1d u[s].1J()}}1d t.1J()},IK:1c(u){1b t=u[0];1k(1b s=1,v=u.1f;s<v;++s){if(!c.1A.II(u[s],t)){1d u[s].1J()}}1d t.1J()},iv:1c(s){if(1a.1t.bI){if(1a.1E){1a.1E.iv(s)}}1l{if(1a.1x){1a.1x.iv(s)}}s.3u(1a);1a.bW(1u);if(1a.6B&&1a.1t){1a.1t.3i.c3(1a)}},10J:1c(s){1a.2r.cZ(s,1m)},wr:1c(){1d 1a.2r.2A},10K:1c(s){1a.2x.cZ(s,1m)},wC:1c(){1d 1a.2x.2A},OJ:1c(){1b t=1a.wr();1b s=1a.wC();if(t!==1v&&t>-1){1a.Bt();if(1a.1r.1f>2){1a.5g=1m;f.r6(1a)}}if(s!==1v&&s>-1){1a.Br();if(1a.1r.1f>2){f.vM(1a)}}},7u:1c(s,u){1b t=u.3E["3b:3G"];if(t){if(s.3F(t)){1d t}}1d 1o.2a(q,1a,"7u",[s,u])},e9:1c(){if(1a.1N==c.4q.7e){1d(1a.1r.1f-1)/3}1l{1d 1a.1r.1f-1}},10G:1c(B){1b t=1a.fF();1b v=1a.bq();if(1a.1N==c.4q.7e){1a.1r.1f=B*3+1}1l{1a.1r.1f=B+1}1b E=(v.x-t.x)/(1a.1r.1f-1);1b D=(v.y-t.y)/(1a.1r.1f-1);1k(1b z=0;z<1a.1r.1f;z++){1a.1r[z]=1g o(t.x+E*z,t.y+D*z)}if(1a.1N==c.4q.a5){1b C=1s.6i(B/2);1b u=1s.6i(B/2);1a.5g=1s.3j(E)>1s.3j(D);if(1a.5g&&B%2!=0){C++}if(!1a.5g&&B%2!=0){u++}1b w=(v.x-t.x)/C;1b A=(v.y-t.y)/u;1b s=1a.5g;1k(1b z=1;z<1a.1r.1f;z++){if(s){1a.1r[z].x=1a.1r[z-1].x+w;1a.1r[z].y=1a.1r[z-1].y}1l{1a.1r[z].x=1a.1r[z-1].x;1a.1r[z].y=1a.1r[z-1].y+A}s=!s}}1a.4k()},zd:1c(v){if(1a.1N==c.4q.7e){1b s=[];1k(1b t=0;t<1a.e9();++t){1b u=c.1A.r7(1a.1r,v,t*3);s=s.IS(u)}1d s}1d 1a.1r},QH:1c(t){1b s=[];if(1a.1N!=c.4q.7e){s.1h(1a.1r[t]);s.1h(1a.1r[t+1])}1l{s=c.1A.r7(1a.1r.6t(0),30,t*3)}1d s},9b:1c(){if(!c.3V.gJ){1d 1m}if(1a.1E!=1j&&1a.1E.9b()){1d 1m}if(1a.1x!=1j&&1a.1x.9b()){1d 1m}1d 1o.2a(q,1a,"9b",[])},10H:1c(t){1b s=1g c.nq(1a,t);if(1a.3r==1v){1a.3r=[]}1a.3r.1h(s);1a.1F();1d s},10O:1c(s){if(s!=1v&&1a.3r!=1v){p.3l(1a.3r,s)}1a.1F()},w2:1c(s){if(1a.3r==1v){1d 1j}1k(1b u=0,t=1a.3r.1f;u<t;u++){if(1a.3r[u].i5().2M(s)){1d 1a.3r[u]}}1d 1j},ni:1c(s){1b t=1a.w2(s);if(t!=1j){1d t}1d 1a},gY:1c(s,t){1d 1g c.7A({2h:1a,c9:s,ca:t})},wD:1c(A){1b t=1a.3o();1b v=t.xg();1b w=1v;1k(1b s=0;s<v.1f;s++){1b u=v[s].2w;if(u==1a){w=s;1Q}}if(w===1v){w=v.1f}1d t.ij()==c.eT.vg?t.wc(A,w):t.wc(!A,w)},o8:1c(w){1b v=1a.3o();if(v==1j||v.ij()==c.eT.ds){1d}if(!w){w=1a.2s()}1a.lk=1v;1b s;if(v.Ls==1j){s=v.3L}1l{s=1a.wD(1u)}1k(1b t=0;t<s.1f;t++){1b z=s[t];1b u=z.2s();if(u.bc(w)){z.lk=1v}}},J2:1c(){1b v=1e.cd.10N;1b G=1a.3o();1b S=b.3h(G.2o);1b O=G.IH();1b M=1a.2s();1b aa=[];1b Z=1a.lk;if(Z==1j){1a.lk=Z=[];1b s=1a.wD(1m);1b D=1a.e9();1k(1b w=0;w<D;++w){1b F=1a.1r[w];1b C=1a.1r[w+1];if(!F.hh(C)){1k(1b Q=0;Q<s.1f;++Q){1b B=s[Q];if(!B.bV()||B.gz()==c.4q.7e){2t}1b u=B.2s();if(!u.bc(M)){2t}1b T=B.e9();1k(1b W=0;W<T;++W){1b R=B.1r[W];1b P=B.1r[W+1];if(R.hh(P)){2t}1b E=c.1A.10L(F,C,R,P);if(E&&F.5E(E)>O&&C.5E(E)>O&&R.5E(E)>O&&P.5E(E)>O){1b t={6v:E,7h:O};aa.1h(t)}}}aa.5q(r(F))}1b V=r(F);1b Y=Z[w];if(!Y){Y=Z[w]=[]}Y.1h({6v:F,7h:0});1k(1b A=0;A<aa.1f;++A){1b z=aa[A];1b L=z.6v;O=z.7h;1b N=e.9N(L.x-O,L.y-O,L.x+O,L.y+O);1b I=v(N,F,L);1b H=v(N,C,L);1b X={6v:I,7h:O};1b U={6v:H,7h:O};if(V(X,U)<0){Y.1h(X);Y.1h(U)}1l{Y.1h(U);Y.1h(X)}}Y.1h({6v:C,7h:0});1k(1b Q=1;Q<Y.1f-2;){1b K=Y[Q];1b J=Y[Q+1];if(V(K,J)>0||K.6v.5E(J.6v)<S/2){p.IR(Y,Q);p.IR(Y,Q)}1l{Q++}}aa.1f=0}}1d Z},IM:1c(){1b v=0;1b t=0;1b s=1a.e9();1k(1b u=0;u<s;++u){1b w=1a.IN(u);if(w>t){t=w;v=u}}1d v},IN:1c(w){1b F=1e.cd;56(1a.1N){1T c.4q.ja:1T c.4q.a5:1d F.5E(1a.1r[w],1a.1r[w+1]);1T c.4q.7e:1b u=w*3;1b t=[];t.1h(1a.1r[u++]);t.1h(1a.1r[u++]);t.1h(1a.1r[u++]);t.1h(1a.1r[u]);1b v=c.1A.r7(t,0,30);1b z=0;1k(1b E=0;E<v.lY-1;++E){1b B=v[E];1b A=v[E+1];1b D=B.x-A.x;1b C=B.y-A.y;z+=1s.bR(D*D+C*C)}1d z}1d 0},IE:1c(A){56(1a.1N){1T c.4q.7e:1b z=A*3;1b N=1a.1r[0+z].x;1b w=1a.1r[0+z].y;1b M=1a.1r[1+z].x;1b v=1a.1r[1+z].y;1b L=1a.1r[2+z].x;1b u=1a.1r[2+z].y;1b K=1a.1r[3+z].x;1b s=1a.1r[3+z].y;1b I=0.5;1b H=(1-I)*(1-I)*(1-I);1b G=3*I*(1-I)*(1-I);1b F=3*I*I*(1-I);1b C=I*I*I;1b D=H*N+G*M+F*L+C*K;1b J=H*w+G*v+F*u+C*s;1d 1g o(D,J);aL:1b E=1a.1r[A];1b B=1a.1r[A+1];1d 1g o((E.x+B.x)/2,(E.y+B.y)/2)}},Iu:1c(s){if(1a.1N==c.4q.7e){1d 1a.1r[s*3]}1d 1a.1r[s]},Iv:1c(s){if(1a.1N==c.4q.7e){1d 1a.1r[s*3+3]}1d 1a.1r[s+1]},Ir:1c(A,u,t){if(A.1f==0){1d 0}1b w=0;1b z=A[w];1b v=1g e(0,0,3W.5s,3W.5s);1b s=0;2L(1m){s+=1a.1t.9r(z,t,v).1q;if(s>u){1d 1s.1U(0,w)}w++;if(w<A.1f){z=A[w]}1l{1d w}}},rc:1c(t,s){1a.rd(t.np()+(t.DZ()-t.np())*s)},9f:1c(){1b s=1o.2a(q,1a,"9f",[]);s.2r=1a.2r.1J(1a,1a.1E);s.2x=1a.2x.1J(1a,1a.1x);s.1r=p.1J(1a.1r);s.1N=1a.1N;s.4u=1a.4u;s.4w=1a.4w;s.5n=1a.5n;s.4v=1a.4v;s.9J=1a.9J;s.9C=1a.9C;s.7D=1a.7D;s.5Z=1a.5Z;s.3r=1a.3r;1d s},a2:1c(s){1o.2a(q,1a,"a2",[s]);1a.2r.cp();1a.2r=s.2r.1J(1a,1a.1E);1a.2r.cx();1a.2x.cp();1a.2x=s.2x.1J(1a,1a.1x);1a.2x.cx();1a.oQ(s.1r,1m);1a.4k();1a.4P(s.1N);1a.4u=s.4u;1a.4w=s.4w;1a.j5(s.5n);1a.oA(s.9J);1a.g8(s.4v);1a.oN(s.9C);1a.7D=s.7D;1a.5Z=s.5Z;1a.3r=s.3r},8v:1c(){if(!fg){fg=1g 1e.5b(q.1n,1j,1a)}1l{fg.5c(1a)}1d fg},119:1g o(0,0)};1b j={bo:1c(w,z,s){1b v=w.1r=[z];1b t=3;1k(1b u=1;u<3;++u){v[u]=1g o(z.x+u*(s.x-z.x)/t,z.y+u*(s.y-z.y)/t)}w.1r.1h(s)},hz:1c(w,v){1b A=w.1r;if(A.1f<4){1d a.hz(w,v)}1b B=w.aI();1b z=w.9k();1b C=w.bz();1k(1b u=1,t=A.1f;u<t;u+=3){1b s=1e.1z.7e.ea(A,u-1);s.2j=B;s.2v=z;s.3f=C;s.aK=w.dA();v.1h(s)}},2M:1c(u,s,t){1b v=c.1A.r7(u.1r,16);1d c.1A.lW(s,v,v.1f)<t},ob:1c(z,s,u){1b w=z.1r;if(w.1f<4){1d}1b t=u.cv.1G(z).l0;1b v=u.3J.1y;if(w.1f==t.1f){if((v+1)%3==0&&v<w.1f-3){w[v+2]=c.1A.P4(w[v],w[v+1])}if((v-1)%3==0&&v>3){w[v-2]=c.1A.P4(w[v],w[v-1])}if((v%3==0)&&v>0&&v<w.1f-1){1b A=u.ws();w[v-1]=o.d5(t[v-1],A);w[v+1]=o.d5(t[v+1],A)}}},eR:1c(t,s){t.4k(s)},kJ:1c(B){1b z=B.1r;1b A=[];1b s,v,u,t;A.1h(z[0]);1b w=0;2L(w<z.1f-2){u=z[w+1];A.1h(u);A.1h(u);if(w!=z.1f-3){t=z[w+2];s=1g o((u.x+t.x)/2,(u.y+t.y)/2);A.1h(s)}1l{A.1h(z[w+2])}w+=1}if(A.1f==1){A=[];v=z[0];u=z[z.1f-1];s=1g o((v.x+u.x)/2,(v.y+u.y)/2);A[0]=v;A[1]=s;A[2]=s.1J();A[3]=u}B.1r=A},o9:1c(s){1d(s.1r.1f-1)%3==0}};1b a={bo:1c(t,u,s){t.1r=[u,s]},hz:1c(z,v){1b s=z.3o();if(s&&(s.qR()||s.ij()!=c.eT.ds)){1b w=1g d(z);v.1h(w);1d}1b E=z.aI();1b A=z.9k();1b G=z.bz();1b C=z.1r;1k(1b u=0,t=C.1f-1;u<t;u++){1b D=C[u];1b B=C[u+1];1b F=1g 1e.1z.gE(D.x,D.y,B.x,B.y);F.5o(E);F.2v=A;F.3f=G;F.aK=z.dA();v.1h(F)}},2M:1c(u,s,t){1d c.1A.lW(s,u.1r,u.1r.1f)<t},ob:1c(u,s,t){},eR:1c(t,s){t.4k(s)},kJ:1c(s){},o9:1c(s){1d 1m}};1b f={bo:1c(t,u,s){if(t.1r.1f<3){p.fo(t.1r,1,1g 1e.1z.5k(0,0))}1a.vi(t,u,s)},hz:1c(t,s){a.hz(t,s)},2M:1c(u,s,t){1d a.2M(u,s,t)},ob:1c(A,t,v){1b z=A.1r;if(z.1f<3){1d}1b B=v.6R;1b w=v.3J.1y;1b u=z[z.1f-1].x-z[0].x;1b s=z[z.1f-1].y-z[0].y;if(v.4X===c.3z.4Y&&(w==0||w==z.1f-1)&&((A.5g&&1s.3j(u)<1s.3j(s))||(!A.5g&&1s.3j(u)>1s.3j(s)))){A.5g=1s.3j(u)>1s.3j(s);1a.vi(A,z[0],z[z.1f-1])}1l{1a.Je(A,w)}},vi:1c(z,t,u){z.5g=1s.3j(t.x-u.x)>1s.3j(t.y-u.y);1b A=z.1r=[t,t,u,u];1b w=A.1f;1b D=u.x-t.x;1b B=u.y-t.y;1b s,C;1k(1b v=1;v<w-1;++v){if(z.5g){if(v%2!=0){s=D/(w/2);C=0}1l{s=0;C=B/((w-1)/2)}}1l{if(v%2!=0){s=0;C=B/(w/2)}1l{s=D/((w-1)/2);C=0}}A[v]=1g o(A[v-1].x+s,A[v-1].y+C)}v--;if((z.5g&&(v%2!=0))||(!z.5g&&!(v%2!=0))){A[w-2]=1g o(A[w-1].x,A[w-2].y)}1l{A[w-2]=1g o(A[w-2].x,A[w-1].y)}},Je:1c(v,u){1b t=v.1r;1b w=u-1;1b s=u+1;if((v.5g&&u%2!=0)||(!v.5g&&!(u%2!=0))){if(w==0){t[u]=1g o(t[u].x,t[w].y)}if(s==t.1f-1){t[u]=1g o(t[s].x,t[u].y)}if(w>=0&&w<t.1f){t[w]=1g o(t[w].x,t[u].y)}if(s>=0&&s<t.1f){t[s]=1g o(t[u].x,t[s].y)}}1l{if(w==0){t[u]=1g o(t[w].x,t[u].y)}if(s==t.1f-1){t[u]=1g o(t[u].x,t[s].y)}if(w>=0&&w<t.1f){t[w]=1g o(t[u].x,t[w].y)}if(s>=0&&s<t.1f){t[s]=1g o(t[s].x,t[u].y)}}},eR:1c(t,s){1a.r6(t);1a.vM(t);t.4k(s)},r6:1c(v){1b t=v.1r;1b u=t[1].x;1b s=t[1].y;if(v.5g){s=t[0].y}1l{u=t[0].x}t[1]=1g o(u,s)},vM:1c(u){1b s=u.1r;1b w=s.1f;1b v=s[w-2].x;1b t=s[w-2].y;if(w%2!=0){if(u.5g){v=s[w-1].x}1l{t=s[w-1].y}}1l{if(u.5g){t=s[w-1].y}1l{v=s[w-1].x}}s[w-2]=1g o(v,t)},kJ:1c(t){1b s=t.1r;t.5g=s[0].y==s[1].y},o9:1c(s){if(s.1r.1f<3){1d 1u}1d 1m}};1b h={bo:1c(t,u,s){t.1r=[u,s]},hz:1c(u,t){1b w=u.aI();1b s=u.9k();1b v=u.bz();1b z=1g 1e.1z.114(u.1r);z.2j=w;z.2v=s;z.3f=v;z.aK=u.dA();t.1h(z)},10P:1c(L){1b w=0.5;1b C=16;1b s=[],M=[],A,z,v,G,u,E,I,H,F,D,J,B,K;s=L.6t(0);s.wl(L[1]);s.wl(L[0]);s.1h(L[L.1f-2]);s.1h(L[L.1f-1]);1k(K=2;K<(s.1f-4);K+=2){1k(B=0;B<=C;B++){v=(s[K+2]-s[K-2])*w;G=(s[K+4]-s[K])*w;u=(s[K+3]-s[K-1])*w;E=(s[K+5]-s[K+1])*w;J=B/C;I=2*1s.5O(J,3)-3*1s.5O(J,2)+1;H=-(2*1s.5O(J,3))+3*1s.5O(J,2);F=1s.5O(J,3)-2*1s.5O(J,2)+J;D=1s.5O(J,3)-1s.5O(J,2);A=I*s[K]+H*s[K+2]+F*v+D*G;z=I*s[K+1]+H*s[K+3]+F*u+D*E;M.1h(A);M.1h(z)}}1d M},2M:1c(u,s,t){1d c.1A.lW(s,u.1r,u.1r.1f)<t},ob:1c(u,s,t){},eR:1c(t,s){t.4k(s)},kJ:1c(s){},o9:1c(s){1d 1m}};1b d=1c(s){1a.2h=s};d.1n={l6:1c(s,t){1b u=1a.2h;1b w=u.3o();1b B=u.aI();1b v=u.9k();1b C=u.bz();1b A=u.1r;if(A.1f<2){1d}1b z=u.dA();if(z&&t!=1u){s.8D();z.3F(s)}s.6U=B;s.7i=(v?v:1)/s.7w;g.3F(s,C);1a.wb(s);if(z&&t!=1u){s.8N()}},Ms:1c(t){1b u=1a.2h;1b s=u.9k();1b v=u.bz();1b w=u.dA();if(w){t.8D();w.3F(t);t.6U=w.3s;t.7i=(s?s:1)/t.7w;g.3F(t,v);1a.wb(t);t.8N()}},wb:1c(t){1b w=1a.2h;1b v=w.3o();1b u=w.1r;if(u.1f<2){1d}1b s=v?v.ij():c.eT.ds;if(s==c.eT.ds){if(w.1t.qR()){1a.wn(t,u,v.w1(),1m)}1l{1a.op(t,u)}}1l{1a.J1(t,w,u,v.w1())}},op:1c(u,v){u.ck();u.6V(v[0].x,v[0].y);1k(1b t=1,s=v.1f;t<s;t++){1b w=v[t];u.3D(w.x,w.y)}u.3P()},wn:1c(t,S,v,G){1b A=1e.cd;if(v<0.wt){1a.op(t,S);1d S[S.1f-1]}if(S.1f<=2){1a.op(t,S);1d S[S.1f-1]}1b L=S[0];if(G){t.ck();t.6V(L.x,L.y)}1b Y,E,C,N;1k(1b T=0;T<S.1f-2;T++){Y=S[T+1];E=S[T];C=S[T+1];N=S[T+2];1b W=1u;2L(1s.3j(C.x-N.x)+1s.3j(C.y-N.y)<0.wt){T++;if(T>=S.1f-2){W=1m;1Q}N=S[T+2]}if(W){2t}1b R=A.7X(Y,E);1b ac=R.a;1b U=R.r;1b O=A.7X(Y,N);1b ab=O.a;1b Q=O.r;2L(ac<0){ac+=aY}2L(ab<0){ab+=aY}if(ab<ac){ab+=aY}1b aa=ab-ac;if(aa==0||aa==8j){2t}1b K=1u;if(aa>8j){1b X=ac;ac=ab;ab=X;X=U;U=Q;Q=X;aa=ab-ac;2L(aa<0){aa+=aY}K=1m}1b D=v;1b M=1s.dT(A.gO(aa/2));1b z=1s.dT(A.gO(90-aa/2));1b B=z*D/M;1b V=1s.2b(U,Q);if(B>1s.2b(V/3,10)){B=1s.2b(V/3,10);D=M*B/z}1b u=A.8S(Y,{a:ac,r:B});1b s=A.8S(Y,{a:ab,r:B});1b P=1s.bR(1s.5O(B,2)+1s.5O(D,2));1b Z=A.8S(Y,{a:ac+aa/2,r:P});1b J=A.7X(Z,u);eV=J.a;11p=J.r;1b I=A.7X(Z,s);gt=I.a;11o=I.r;2L(1s.3j(gt-eV)>8j){if(gt<eV){gt+=aY}1l{eV+=aY}}if(gt<eV){1b X=gt;gt=eV;eV=X}if(K){1b X=u;u=s;s=X}t.3D(u.x,u.y);if(D>0){1b w=aY-eV;1b H=-(gt-eV);if(!K){w=w+H;H=-H}t.cJ(Z.x,Z.y,D,A.gO(w),A.gO(w+H),H<0)}L=s}if(G){1b F=S[S.1f-1];t.3D(F.x,F.y);t.3P()}1d L},J1:1c(v,C,U,w){1b N=C.J2();if(!N||N.1f==0){1a.op(v,U);1d}1b B=1e.cd;v.ck();v.6V(U[0].x,U[0].y);1b O=1j;1b F=C.e9();1b J=C.3o();1b K=1u;1k(1b V=0;V<F;++V){1b s=N[V];if(s.1f>0){1k(1b T=0;T<s.1f-1;++T){1b S=s[T].7h;1b H=s[T].6v;1b E=s[T+1].6v;if(O){H=O}if(K){v.6V(H.x,H.y);K=1u}O=1j;if(T%2==0){if(J.qR()){if(T==s.1f-2&&V!=F-1){1b z=V+2;1b Q=U[z];2L(1s.3j(Q.x-E.x)+1s.3j(Q.y-E.y)<0.wt){z++;if(z==U.1f){1Q}Q=U[z]}if(z==U.1f){v.3D(E.x,E.y)}1l{1b ab=N[z-1];if(ab.1f>2){Q=ab[1].6v}1b P=[H,E,Q];O=1a.wn(v,P,w,1u)}}1l{v.3D(E.x,E.y)}}1l{v.3D(E.x,E.y)}}1l{if(J.ij()==c.eT.vg){1b Z=H.5E(E)/2;1b aa=B.7X(H,E);1b Y=aa.a;1b D=aa.r;1b X=[B.8S(H,{a:Y,r:S}),B.8S(H,{a:Y,r:2*Z-S})];1b R=[H,B.8S(H,{a:Y,r:2*Z-2*S})];1b G=[B.8S(H,{a:Y,r:2*S}),E];1b W=Y;if(W<90){W+=8j}1b M=0*90;if(Y<90){M=90-M}1b A=8j-W-M;1b L=-90;if(Y<90){A+=L;L=-L}v.cJ(X[0].x,X[0].y,S,B.gO(A),B.gO(A+L),L<0);1b u=B.8S(X[0],{a:W-90,r:S});1b t=B.8S(X[1],{a:W-90,r:S});v.3D(t.x,t.y);M=1*90;if(Y<90){M=90-M}A=8j-W-M;L=-90;if(Y<90){A+=L;L=-L}v.cJ(X[1].x,X[1].y,S,B.gO(A),B.gO(A+L),L<0)}1l{K=1m}}}}1l{v.3D(U[V+1].x,U[V+1].y)}}1b I=U[U.1f-1];v.3D(I.x,I.y);v.3P()}};q.bi=1c(s){if(!fg){fg=1g 1e.5b(q.1n,s)}1l{fg.5c(1j)}1d fg};fg=1j;1b n=[j,a,f,h];1b r=1c(s){1d 1c(u,t){1b A=u.6v;1b w=t.6v;if(A.hh(w)){1d 0}1b v=(s.x-A.x)*(s.x-A.x);v+=(s.y-A.y)*(s.y-A.y);1b z=(s.x-w.x)*(s.x-w.x);z+=(s.y-w.y)*(s.y-w.y);if(v==z){1d 0}1d(v<z)?-1:1}};1e.1Z(q,"1e.1i.3G",c.8A)})(1e.1i);(1c(c){1b g=1e.1z.5t;1b e=1e.1z.5k;1b d=1e.1z.2O;1b b=1e.2T.5i;1b a=c.2Z=1c(h){1o.2u(a,1a,[h]);1a.2f=0;1a.5r=c.6G.HT&~c.6G.ce;1a.6E=c.fI.md;1a.8B=[];1a.8y=[];1a.6D=1m;1a.7p=1m;1a.7r=1m;1a.4d=1j;1a.cT=1g b();1a.jM=1u;1a.bT=1u;1a.6d=1m;1a.f6=1u;1a.2I=[];if(h&&h.sz){1a.ko(1m)}};a.iA=1c(j,h){if(!j.pP()||!h.pP()){1d 1u}1b k=j.1w.vr(h.1w);if(k.1p>0&&k.1q>0){1d 1m}1d 1u};a.1n={1J:1c(){1b h=1o.2a(a,1a,"1J",[]);h.2f=1a.2f;h.5r=1a.5r;h.6E=1a.6E;h.6D=1a.6D;h.7p=1a.7p;h.7r=1a.7r;h.4d=1a.4d;h.ko(1a.bT);h.6d=1a.6d;h.6D=1a.6D;h.7p=1a.7p;h.7r=1a.7r;h.2I=1a.2I.6t(0);h.1K=1a.1K.1J();h.yh(1a.f6);1d h},2k:1c(){1b k=1o.2a(a,1a,"2k",[]);k.1w=1a.1w;if(1a.4d){k.4d=1a.4d.2k()}k.2f=1a.2f;k.5r=1a.5r;k.6E=1a.6E;k.6d=1a.6d;k.bT=1a.bT;k.6D=1a.6D;k.7p=1a.7p;k.7r=1a.7r;k.f6=1a.f6;if(1a.7Y){k.bD=1a.7Y.7Z}if(1a.2N){k.2N=1a.2N.7Z}1b n=[];1k(1b j=0,h=1a.2I.1f;j<h;j++){if(1a.2I[j]==1j){n.1h(1j)}1l{n.1h(1a.2I[j].2k())}}k.5e=n;1d k},2E:1c(n){1o.2a(a,1a,"2E",[n]);1a.3g(1g d(n.1w.x,n.1w.y,n.1w.1q,n.1w.1p));if(n.4d){1b q=n.4d.id;1b k;if(q){k=c.fa.1I(q)}1l{k=1g c.fa();k.2E(n.4d)}k.vq=1m;1a.xS(k)}1a.ox(n.2f);1a.xW(n.5r);if(n.6E!==1v){1a.6E=n.6E}if(n.6d!==1v){1a.6d=n.6d}if(n.bT!==1v){1a.ko(n.bT)}if(1a.7b){1a.7b.5D()}if(n.f6!==1v){1a.yh(n.f6)}if(n.6D!==1v){1a.xu(n.6D)}if(n.7p!==1v){1a.xt(n.7p)}if(n.7r!==1v){1a.xw(n.7r)}if(n.bD!==1v){1a.oD=n.bD}if(n.2N!==1v){1a.oy=n.2N}1a.2I=[];if(n.5e){1k(1b j=0,h=n.5e.1f;j<h;j++){if(n.5e[j]==1j){1a.2I.1h(1j);2t}1b p=1o.e7(n.5e[j].lg);if(p){1b o=1g p(1a);o.2E(n.5e[j]);1a.2I.1h(o)}}}},4f:1c(k,j){1o.2a(a,1a,"4f",[k,j]);1a.3g(j.zt("sr",k));1a.ox(j.4G("HC",k));1a.4d=j.JA("fa",k);1a.7r=j.3U("Hx",k,1m);1a.6D=j.3U("Hy",k,1m);1a.7p=j.3U("Hz",k,1m);1a.6d=j.3U("HD",k,1m);1a.ko(j.3U("HH",k));if(1a.7b){1a.7b.5D()}1a.5r=j.2Q("HI",k,1a.5r);1a.6E=j.2Q("fI",k,1a.6E);1b l=j.HL("HJ",k);if(l){1k(1b h=0;h<l.ig.1f;h++){l.ig[h].xR(1a)}1k(1b h=0;h<l.3B.1f;h++){1a.3u(l.3B[h])}}1a.rL("fY",k,j)},4E:1c(j,h){1o.2a(a,1a,"4E",[j,h]);h.sb(1a.2s(),"sr",j);h.4W(1a.9u(),"HC",j);h.K5(1a.4d,"fa",j);h.3O(1a.7r,"Hx",j);h.3O(1a.6D,"Hy",j);h.3O(1a.7p,"Hz",j);h.3O(1a.6d,"HD",j);h.3O(1a.La(),"HH",j);h.3m(1a.5r,"HI",j);h.3m(1a.6E,"fI",j);1b k={Aw:1a};if(1a.9V&&1a.9V.1f>0){k.ig=1a.oo()}if(1a.3B&&1a.3B.1f>0){k.3B=1a.3B}if(k.ig||k.3B){h.HF(k,"HJ",j)}1a.rJ("fY",j,h)},rL:1c(h,j,o){1a.2I=[];1b n=o.9x("fY",j);if(!n){1d}1b p=n.4K("g0");1k(1b l=0;l<p.1f;l++){1b k=p[l];1a.2I.1h(o.vb(k))}},rJ:1c(h,k,n){1b j=n.2m(h,k);1k(1b l=0;l<1a.2I.1f;l++){n.uD(1a.2I[l],g0,k)}},iE:1c(j){1o.2a(a,1a,"iE",[j]);if(1a.oD!==1v){1a.xR(j[1a.oD]);4m 1a.oD}if(1a.oy!==1v){1b h=j[1a.oy];h.3B.1h(1a);1a.2N=h;4m 1a.oy}},117:1c(){1d 1a.8B},115:1c(){1d 1a.8y},xu:1c(h){if(1a.6D!==h){1a.6D=h;1a.3Y()}},11b:1c(){1d 1a.6D},xt:1c(h){if(1a.7p!==h){1a.7p=h;1a.3Y()}},113:1c(){1d 1a.7p},nu:1c(h){if(h&&!1a.7p){1d 1u}if(!h&&!1a.6D){1d 1u}1d 1m},ox:1c(h){if(1a.2f!=h){1a.2f=h;if(1a.1t){1a.gX();if(1a.4d){1a.wS()}}1a.1F()}},9u:1c(){1d 1a.2f},os:1c(k,h){1b j=1g c.4M({1C:1a,4b:k,6k:h});1a.1t.2l(c.1S.sW,j);1d j.a6()},o1:1c(k,h){1b j=1g c.4M({1C:1a,4b:k,6k:h});1a.1t.2l(c.1S.sU,j);1d j.a6()},lL:1c(k,h,j){1b l=1g c.u9(1a,k,j);l.3d.4r=h;1d l},BG:1c(h){if(!b.2c(1a.8B,h)){1a.8B.1h(h)}},Bv:1c(h){if(!b.2c(1a.8y,h)){1a.8y.1h(h)}},Bw:1c(h){b.3l(1a.8B,h)},Bx:1c(h){b.3l(1a.8y,h)},da:1c(h){1k(1b j=0;j<1a.8B.1f;j++){if(h.6r(1a.8B[j])===-1){h.1h(1a.8B[j])}}},db:1c(h){1k(1b j=0;j<1a.8y.1f;j++){if(h.6r(1a.8y[j])===-1){h.1h(1a.8y[j])}}},kQ:1c(){1b h=[];1a.da(h);1a.db(h);1d h},Ik:1c(){if(1a.1t){1b h=[];1a.da(h);1a.db(h);1k(1b j=0;j<h.1f;j++){1a.1t.c3(h[j])}}},9w:1c(h){if(h.Od(1a)){1d}1o.2a(a,1a,"9w",[h]);b.1B(1a.kQ(),1c(j){j.9w(h)});b.1B(1a.oo(),1c(j){j.9w(h)})},7k:1c(h){1o.2a(a,1a,"7k",[h]);1b j=1a.kQ();1k(1b k=0;k<j.1f;++k){h.cv.2p(j[k],j[k].nX())}},eP:1c(k){1b p=k.3J.1y;if(p===9){1b o=1a.2f;1b j=1e.cd.ys(c.1A.5C(1a.1w),k.6R).a;1a.ox(90-j*8j/1s.PI);if(k.4B==1a){k.11e=1a.2f-o}1d}1b h=k.cv.1G(1a);if(h==1j){1d}1b n=h.1w;1b l=1a.sE(n,1a.1w,k);1a.3g(l,1m,1m);1a.f2()},hP:1c(j){1b h=j.cv.1G(1a);if(h==1j){1d}1b k=h.1w;if(1a.7r){1a.1t.yE([k,1a.1w])}if(1a.2N){1a.2N.Ej(1a,j.3J.1y)}},hE:1c(h){if(1a.1t){1d 1a.1t.uW(1a,h.6R)}1d 1m},5z:1c(h){1o.2a(a,1a,"5z",[h]);b.1B(1a.kQ(),1c(j){j.rH(h)})},Ee:1c(h){1d 1u},IO:1c(h){},nX:1c(){1d{1w:1a.1w}},rH:1c(h){1b j=h.cv.1G(1a);if(j!=1j){1a.3g(j.1w,1u,1u)}},gX:1c(){1b j=1a.kQ();1k(1b k=0,h=j.1f;k<h;k++){1b n=j[k];if(c.4A.5u){c.4A.5u.M2(n);2t}n.gm()}},3g:1c(j,k,h){1b l=1a.1w;1a.1w=j;if(c.4A.5u&&l.11f(j)){c.4A.5u.M1(1a,c.1A.d4(j.5a(),l.5a()))}1a.wS();1a.KG();1a.1F();if(k){1a.gX()}if(h){1a.Gr(l,j)}1a.lT()},2s:1c(){1d 1a.1w},lT:1c(){if(1a.1t&&1a.1t.sD){1a.1t.sD()}},Gr:1c(l,h){if(!1a.9V&&!1a.3B){1d}1b j=c.4A.5u?c.4A.5u:(c.4A.5u=1g c.4A(1a));1b n=h.5a();1b k=l.5a();if(1a.2f!=0){n=c.1A.6A(n,h.4e(),1a.2f);k=c.1A.6A(k,l.4e(),1a.2f)}1b o=c.1A.d4(n,k);1a.qB(j,o);if(j&&j.bD==1a){j.gX();c.4A.5u=1j}},qB:1c(h,j){if(!1a.9V){1d}1a.9V.1B(1c(l){1b k=l.1C;if(!h.qL(k)){k.3g(c.1A.qX(k.2s(),j),1m,1m)}})},yr:1c(o,s,r,p,k){1b q=o.1q;1b j=o.1p;1b n=1g d(o.x-q/2+s,o.y-j/2+r,q,j);1b l=1g ke();if(!c.4A.5u){c.4A.5u=1g c.4A(l)}1a.3g(n,p,k);if(c.4A.5u.bD==l){c.4A.5u.gX();c.4A.5u=1j}},yq:1c(o,k,r,n){1b j=1a.1w.1q;1b p=1a.1w.1p;1b q=1g d(o,k,j,p);1b l=1g ke();if(!c.4A.5u){c.4A.5u=1g c.4A(l)}1a.3g(q,r,n);if(c.4A.5u.bD==l){c.4A.5u.gX();c.4A.5u=1j}},sE:1c(l,q,r){1b t=r.6R.1J();1b k=r.cW.1J();if(r.3J.1y===8){1d 1a.I2(l,t,r)}if(r.4X==c.3z.7q){1b p=r.3J.2w;if(p.2f){1b j=r.cv;if(j!=1j){1b z=j.1G(p).1w;t=c.1A.6A(t,z.4e(),-p.2f);k=c.1A.6A(k,z.4e(),-p.2f)}}1b w=c.1A.d4(t,k);1b n=g.3h(1a.1t.2o);1b o=c.mp.im(l,n);t=o[r.3J.1y];t.d5(w)}if(1a.1t.bO&&!1a.2f){t=1a.1t.ti(1a,t,r.3J)}1b h=l;1b v=h.4e();56(r.3J.1y){1T 0:h=1a.fn(t.x,t.y,h.2y(),h.2V());1Q;1T 1:h=1a.fn(h.x,t.y,t.x,h.2V());1Q;1T 2:h=1a.fn(h.x,h.y,t.x,t.y);1Q;1T 3:h=1a.fn(t.x,h.y,h.2y(),t.y);1Q;1T 4:h=1a.fn(h.x,t.y,h.2y(),h.2V());1Q;1T 5:h=1a.fn(h.x,h.y,t.x,h.2V());1Q;1T 6:h=1a.fn(h.x,h.y,h.2y(),t.y);1Q;1T 7:h=1a.fn(t.x,h.y,h.2y(),h.2V());1Q}if(h.1q===0){h.1q=1a.1t.bO?1a.1t.b5:g.fK(1a.1t.2o)}if(h.1p===0){h.1p=1a.1t.bO?1a.1t.b0:g.fK(1a.1t.2o)}if(1a.2f!==0){1b u=1g e(h.x,h.y);1b s=1g e(h.2y(),h.2V());u=c.1A.6A(u,v,1a.2f);s=c.1A.6A(s,v,1a.2f);v=1g e((u.x+s.x)/2,(u.y+s.y)/2);u=c.1A.6A(u,v,-1a.2f);s=c.1A.6A(s,v,-1a.2f);h=d.ea(u,s)}1d h},I2:1c(p,s,q){if(1a.1t.bO){1b h=q.cv;if(h==1j){1d p}1b v=h.1G(1a).1w;1b j=c.1A.qX(v,c.1A.d4(s,q.cW));1b k=1g e(0,0);if(1a.2f!==0){1b r=1a.yd(j,c.1A.5C(j),1a.2f);k=c.1A.d4(r.5a(),j.5a());j=r}1b o=1a.1t.I4(1a,j);o.x-=k.x;o.y-=k.y;1b u=o}1l{1b t=c.1A.d4(s,q.cW);1b u=p.5a().d5(t)}1b n=1a.HZ();1b l=1g d(u.x,u.y,p.1q,p.1p);1d(n)?l:1a.1w},HZ:1c(){1d 1m},mV:1c(k,j){if(j==1j){j=1a.1w}1b h=1a.I5(k,j);if(1a.2f!==0){h=c.1A.6A(h,j.4e(),1a.2f)}1d h},8c:1c(h){if(!1a.1t){1d 1j}if(1a.6E==c.fI.iN){1b j=1a.1t.I1(1a,h);1d j!==1v?{2w:1a,1y:j}:1j}1d c.mp.P2(h,1a)},I5:1c(n,l){if(l==1j){l=1a.1w}1b j=l.5a();1b k=l.9Z();1b h=l.4e();56(n){1T 0:1d j;1T 1:1d 1g e(k.x,j.y);1T 2:1d k;1T 3:1d 1g e(j.x,k.y);1T 4:1d 1g e(h.x,j.y);1T 5:1d 1g e(k.x,h.y);1T 6:1d 1g e(h.x,k.y);1T 7:1d 1g e(j.x,h.y);1T 8:1d h;1T 9:1d 1g e(h.x,j.y-g.fK(1a.1t.2o)*6)}1d h},2M:1c(h){1d 1a.1w.2M(h)},5C:1c(){1d 1g e((1a.1w.x+(1a.1w.x+1a.1w.1q))/2,(1a.1w.y+(1a.1w.y+1a.1w.1p))/2)},6N:1c(){1d 1a.yd(1a.1w)},yd:1c(j){1b n=[];n.1h(j.5a());n.1h(j.a7());n.1h(j.9Z());n.1h(j.aR());c.1A.cU(n,c.1A.5C(j),1a.2f);1b h=1s.2b(n[0].x,1s.2b(n[1].x,1s.2b(n[2].x,n[3].x)));1b o=1s.2b(n[0].y,1s.2b(n[1].y,1s.2b(n[2].y,n[3].y)));1b l=1s.1U(n[0].x,1s.1U(n[1].x,1s.1U(n[2].x,n[3].x)));1b k=1s.1U(n[0].y,1s.1U(n[1].y,1s.1U(n[2].y,n[3].y)));1d d.9N(h,o,l,k)},bN:1c(k,j){if(k.hh(j)){1d k.1J()}1b h=1a.5C();if(1a.1w.1q!==0&&1a.1w.1p!==0){if(1a.1w.2M(k)&&1a.1w.2M(j)){1d h}c.1A.11h(1a.5P(),k,j,h)}1d h},bQ:1c(j){1b h=1a.6N();1d h.bc(j)},fn:1c(j,l,h,k){1d 1g d.9N(j,l,h,k)},pP:1c(){1d 1m},Kq:1c(j,h){1d j.d-h.d},oP:1c(h,k,j){1b l=1a.fD(h,k,j);if(l.1y===-1){1d 1j}1d l},yl:1c(l,j){if(1a.4d==1j){1d}1b p=1a.4d.hM();if(l<0||l>=p.1f){1d}1b n=p[l];1b o=1e.1i.1A.iB(1g e(n.x,n.y),1a.1w);1b h=[o];if(1a.2f!==0){1b k=1a.iK(1a.1w);k.lZ(h)}1d{1y:l,4r:h[0],6v:c.1A.jo(h[0],1a.1w)}},fD:1c(s,q,l){1b r=1a.e3(s);if(1a.4d==1j){1d{1y:0,4r:r,6v:r}}1b t=[];1b o=[];1b v=[];1b u=1a.4d.hM();1k(1b n=0;n<u.1f;n++){1b h=u[n];if(l&&!h.Kz()){2t}if(!l&&!h.KA()){2t}1b w=1e.1i.1A.iB(1g e(h.x,h.y),1a.1w);o.1h(w);v.1h(n)}if(1a.2f!==0){1b k=1a.iK(1a.1w);k.lZ(o)}1k(1b n=0;n<o.1f;n++){1b j=o[n];1b p=v[n];t.1h({p:j,d:s.5E(j),i:p})}t.5q(1a.Kq);if(t.1f>0){1d{1y:t[0].i,4r:t[0].p,6v:c.1A.jo(t[0].p,1a.1w)}}1l{1d{1y:0,4r:r,6v:r}}},lG:1c(){1a.i7(1a.cT);1o.2a(a,1a,"lG",[])},im:1c(){1b o=1a.1w;1b k=o.5a();1b n=o.9Z();1b h=o.4e();1b j=[];if((1a.5r&c.6G.tv)!==0){j.1h(k)}if((1a.5r&c.6G.Kk)!==0){j.1h(o.a7())}if((1a.5r&c.6G.KW)!==0){j.1h(n)}if((1a.5r&c.6G.KX)!==0){j.1h(o.aR())}if((1a.5r&c.6G.wj)!==0){j.1h(1g e(h.x,k.y))}if((1a.5r&c.6G.wE)!==0){j.1h(1g e(n.x,h.y))}if((1a.5r&c.6G.ww)!==0){j.1h(1g e(h.x,n.y))}if((1a.5r&c.6G.wA)!==0){j.1h(1g e(k.x,h.y))}if((1a.5r&c.6G.cO)!==0){j.1h(h)}if((1a.5r&c.6G.ce)!==0){j.1h(1g e(h.x,k.y-g.3h(1a.1t.2o)*6))}if(1a.2f!==0){1b l=1a.iK(1a.1w);l.lZ(j)}1d j},iK:1c(j){1b h=1g 1e.1z.gp();h.cz(1a.2f,j.4e().x,j.4e().y);1d h},P7:1c(h){if(1a.2f!=0){1b j=1a.2s().4e();1d c.1A.6A(h,j,-1a.2f)}1d h},lm:1c(h){h.8D();1b j=1a.1w;h.8f(j.x+j.1q/2,j.y+j.1p/2);h.Dy(c.1A.mK(1a.2f));h.8f(-j.x-j.1q/2,-j.y-j.1p/2);if(1a.6E==c.fI.iN){1a.1t.KT(1a,h)}1l{c.mp.lR(h,1a)}h.8N()},xW:1c(h){if(1a.5r!=h){1a.5r=h;1a.1F()}},lp:1c(){1d 1a.5r},11g:1c(h){if(1a.6E!=h){1a.6E=h;1a.1F()}},t9:1c(){1d 1a.6E},xw:1c(h){if(1a.7r!==h){1a.7r=h;1a.3Y()}},zc:1c(){1d 1a.7r},ko:1c(h){if(1a.bT!=h){1a.bT=h;if(h){1a.7b=1g c.vt(1a);1a.oO(1a.7b)}1l{1a.oR(1a.7b);4m 1a.7b}}},La:1c(){1d 1a.bT},EA:1c(h){if(1a.6d!=h){if(h){1a.vp()}1l{1a.iv()}}},10I:1c(){1d 1a.6d},yh:1c(h){if(1a.f6!=h){1a.f6=h;if(h){1a.pA=1g c.yj(1a);1a.oO(1a.pA)}1l{1a.oR(1a.pA);4m 1a.pA}}},11A:1c(){1d 1a.f6},oO:1c(h){if(!1a.bA){1a.bA=1g b()}1a.bA.1h(h);1a.4n.2H.1h(h);if(1a.1t){1a.1t.1F()}},oR:1c(h){if(!1a.bA){1d}1a.bA.3l(h);b.3l(1a.4n.2H,h);if(1a.1t){1a.1t.1F()}},KG:1c(){if(!1a.bA){1d}1a.bA.1B(1c(h){h.8T()})},dr:1c(k){if(!1a.bA){1d 1j}1k(1b j=0;j<1a.bA.1f;j++){1b h=1a.bA[j];if(h.8r(k)){1d h}}1d 1j},oc:1c(h){if(1a.bA){1a.bA.1B(1c(j){h.1h(j)})}},iv:1c(j){if(j){if(j.2c(1a)){1d}j.3u(1a);1a.bW(1u);if(1a.6B&&1a.1t){1a.1t.3i.c3(1a)}if(!1a.6d){1d}}1l{j=1a.qa=1g 1e.2T.dZ();j.3u(1a);1a.6d=1u;if(1a.7b){1a.7b.5D()}if(1a.1t){1a.1t.1F()}}1b h=[];if(1a.1t.bI){1a.da(h)}1l{1a.db(h)}b.1B(h,1c(k){k.iv(j)})},vp:1c(){1a.6d=1m;if(1a.7b){1a.7b.5D()}if(1a.1t){1a.1t.1F()}if(1a.qa){1a.qa.1B(1c(j){j.bW(1m)});4m 1a.qa}1l{1b h=[];if(1t.bI){1a.da(h);b.1B(h,1c(k){k.bW(1m);1b j=k.de();j.bW(1m);if(j.7b){j.6d=1u;j.7b.5D()}})}1l{1a.db(h);b.1B(h,1c(k){k.bW(1m);1b j=k.d7();j.bW(1m);if(j.7b){j.6d=1u;j.7b.5D()}})}}},JB:1c(j,h,k){56(j){aL:1o.2a(a,1a,"JB",[j,h,k]);1Q}},5P:1c(){1d 1a.1w.lu()},e3:1c(h){1b j=1a.5P();j.1h(j[0].1J());1b k={6T:0};c.1A.lW(h,j,j.1f,k);1d c.1A.11t(h,j[k.6T],j[k.6T+1])},11y:1c(){1d 1a.4d},xS:1c(h){if(1a.4d!=1j){1a.i7(1a.cT)}1a.4d=h;1a.f2();1a.1F()},pL:1c(o,n,j){if(o==1j){1d}1a.jM=1m;1k(1b k=0;k<o.hM().1f;k++){1b l=o.hM()[k];1b h=1a.JE(l);if(!h){2t}1a.1t.hI(h);n.1h(h)}},i7:1c(j){if(j==1j){1d}1a.jM=1u;1b h=j.9K();2L(h){1a.1t.kE(h);h=j.9K()}},JE:1c(s){1b h=1a.1w;1b j=1;if(s){j=s.h1()}1b z=1e.1i.1A.iB(1g e(s.Jx(),s.Jl()),h);1b o;if(1a.2f!==0){1b k=c.1A.6A(z,h.4e(),1a.2f);o=1e.1i.1A.Jm(k,j)}1l{o=1e.1i.1A.Jm(z,j)}1b n=o.x;1b u=o.y;1b w=s.h1();1b q=w/2;1b r=1e.1i.1A.Z4;1b v;56(s.Jw()){1T 1e.1i.d8.jX:1b p="M{0},{1} L{2},{1} M{3},{4} L{3},{5}";p=r(p,n,(u+q),(n+w),(n+q),u,(u+w));v=1g 1e.1z.bX(p);1Q;1T 1e.1i.d8.X:1b p="M{0},{1} L{2},{3} M{0},{3} L{2},{1}";p=r(p,n,u,n+w,u+w);v=1g 1e.1z.bX(p);1Q;1T 1e.1i.d8.aJ:v=1g 1e.1z.WN(n+q,u+q,q,0,aY,0);1Q;1T 1e.1i.d8.6h:v=1g d(n,u,w,w);1Q;1T 1e.1i.d8.4D:1d}v.2j=s.K0();v.1V="4l";1d v},f2:1c(){if(1a.1t&&1a.1t.o4){1a.jL(1a.1t.o4())}},Ka:1c(h){1a.K1(1a.4d,1a.cT,h)},K1:1c(j,l,h){if(1a.4d==1j){1d}1b k=j.hM();if(1a.jM&&!h){1a.i7(1a.cT)}if(!1a.jM&&h){1a.pL(1a.4d,1a.cT,1m)}if(1a.jM&&h){1a.i7(1a.cT);1a.pL(1a.4d,1a.cT,1m)}},jL:1c(h){1a.Ka(1a.wV(h))},wV:1c(h){if(1a.1t==1j||!1a.bV()){1d 1u}1b k=1a.1t.JZ();1b j=h==1a||k==1e.1i.o2.JQ||1a.d9()&&k==1e.1i.o2.JX;1d j},wS:1c(){if(1a.4d==1j){1d}1a.i7(1a.cT);if(!1a.1t||!1a.1t.o4){1d}if(1a.wV(1a.1t.o4())){1a.pL(1a.4d,1a.cT,1m)}},WL:1c(h){1b j=1;if(Fo){j=Fo.2s().1q}1d 1e.1i.1A.iB(1g e(Fp.x,Fp.y),1a.2s())},WM:1c(){1d 1a.1w.WQ()},xR:1c(h){h.FE(1a)},FK:1c(){if(1a.7Y){1a.7Y.AQ(1a);1a.3Y()}},FE:1c(h){if(!1a.9V){1a.9V=1g b()}1a.9V.1h({1C:h});h.7Y=1a;1a.3Y()},AQ:1c(j){if(!1a.9V){1d}1b h=1j;1a.9V.1B(1c(k){if(k.1C==j){h=k;1d $1Q}});if(h){1a.9V.3l(h);4m j.7Y}},AT:1c(){1d 1a.7Y},oo:1c(){if(!1a.9V){1d[]}1b h=[];1a.9V.1B(1c(j){h.1h(j.1C)});1d h},9b:1c(){if(!1e.1i.3V.gJ){1d 1m}1b h=1a.FH();if(h){1d 1o.2a(a,h,"9b",[])}1d 1o.2a(a,1a,"9b",[])},FH:1c(){1b j=f++;1b h=1a.7Y;2L(h!=1j&&h.7Y!=1j){if(h==1a){1Q}if(h.FQ==j){1Q}h.FQ=j;h=h.7Y}1d h},eC:1c(h){1d 1a.6N()},gY:1c(h,j){1d 1g c.4M({1C:1a,c9:h,ca:j})},AJ:1c(h){1d 1u},xJ:1c(){1a.i7(1a.cT)},xY:1c(){if(1a.4d){1a.f2()}},ua:1c(h){if(1a.2N){1d 1a.2N}if(h&&1a.7Y){1d 1a.7Y}1d 1j},7u:1c(j,k){1b h=k.3E["3b:2Z"];if(h){if(j.3F(h)){1d h}}1d 1o.2a(a,1a,"7u",[j,k])},WV:1c(){if(1a.2I===1v){1a.2I=[]}1d 1a.2I},FC:1c(){if(1a.2I&&1a.2I.1f){1d 1a.2I}1b h=1a.8I(c.1X.1n.ue);if(h){1d h.uf()}1d[]},eN:1c(n,p){if(!1a.1t){1d}p.KH=1a.1N&&1a.1N.AH&&1a.1N.AH();p.Fj=g.fK(1a.1t.2o);1b j=1a.FC();1b q=j.1f>0&&j[0]==1j;if(!q){if(1a.1t.xZ){1b o=1a.1t.xZ();1k(1b k=0,h=o.1f;k<h;k++){if(o[k]!=1j){o[k].3F(1a,n,p)}}}}1k(1b k=0,h=j.1f;k<h;k++){if(j[k]!=1j){j[k].3F(1a,n,p)}}},rc:1c(k,j){1b h=1a.1w;1b l=k.np()+(k.DZ()-k.np())*j;1a.3g(1g d(h.x,l,h.1q,h.1p),1m,1m)},9f:1c(){1b h=1o.2a(a,1a,"9f",[]);h.1w=1a.1w;h.4d=1a.4d;h.2f=1a.2f;h.5r=1a.5r;h.6E=1a.6E;h.6d=1a.6d;h.bT=1a.bT;h.6D=1a.6D;h.7p=1a.7p;h.7r=1a.7r;h.bD=1a.7Y;h.2N=1a.2N;h.2I=1a.2I;1d h},a2:1c(h){1o.2a(a,1a,"a2",[h]);1a.3g(h.1w);1a.xS(h.4d);1a.ox(h.2f);1a.xW(h.5r);1a.6E=h.6E;1a.EA(h.6d);1a.ko(h.bT);1a.xu(h.6D);1a.xt(h.7p);1a.xw(h.7r);1a.oD=h.bD;1a.oy=h.2N;1a.2I=h.2I}};1e.1Z(a,"1e.1i.2Z",c.8A);1b f=0})(1e.1i);(1c(b){1b a=b.xq=1c(c){1o.2u(a,1a,[c])};a.1n={iq:1c(c){1d 1j},6H:1c(c){1d 1u},5R:1c(c){},6j:1c(c){if(1a.1H.zg(c)){1a.1H.pp(c)}},bP:1c(c,d){1a.6o=1e.bf.aV.9j;1d 1a.6o}};1e.1Z(a,"1e.1i.xq",b.ei)})(1e.1i);(1c(a){1b c=1e.bf.aV;1b b=a.xE=1c(d){1o.2u(b,1a,[d])};b.1n={iq:1c(e){1b d=1a.1H.go(e,1m,1m);if((d!=1j&&d.nu(1m))||(d==1j&&1a.1H.dw)){1b f=1a.t6(d,e);1a.1H.54(f);1b g={2w:f,1y:f.1r.1f-1};1d 1g a.9Q(f,a.3z.4Y,g,e)}1d 1g a.9Q(1a.1H.3i,a.3z.4Y,1j,e)},bP:1c(d,e){1b f=1a.1H.3i.8c(d);if(f){1d 1a.bp(c.cO)}1b h=1a.1H.hG(d);if(h){1d 1a.k9(d,h)}1b g=1a.1H.go(d,1m,1m);if(g!=1j&&g.nu(1m)){1d 1a.bp(c.tp)}1d 1a.bp(c.9j)}};1e.1Z(b,"1e.1i.xE",a.ei)})(1e.1i);(1c(a){1b c=1e.bf.aV;1b b=a.gN=1c(e,d){1o.2u(b,1a,[e]);1a.tf=d};b.1n={iq:1c(d){1b e=1a.1H.no()?1a.1H.yK():1;1b g=1a.1H.no()?1a.1H.yL():1;1b j=1a.tq();1b f=1a.1H.ti(j,d,a.6G.tv);j.3g(1g 1e.1z.2O(f.x,f.y,e,g));1a.1H.54(j);1b k={2w:j,1y:2};1d 1g a.9Q(j,a.3z.4Y,k,d)},bP:1c(d,e){1b f=1a.1H.3i.8c(d);if(f){1d 1a.bp(c.cO)}1b g=1a.1H.hG(d);if(g){1d 1a.k9(d,g)}1d 1a.bp(c.9j)},tq:1c(){1d 1a.tf(1a.1H)}};1e.1Z(b,"1e.1i.gN",a.ei)})(1e.1i);(1c(a){1b b=a.9o=1c(c){1o.2u(b,1a,[c])};b.1n={pP:1c(){1d 1u},bN:1c(c,d){1d c}};1e.1Z(b,"1e.1i.9o",a.2Z)})(1e.1i);(1c(a){1b h=a.p1=1c(o){1o.2u(h,1a);if(o.7C){1a.7C=o.7C}if(o.1w){1a.1w=o.1w}if(o.4b){1a.4b=o.4b}if(o.6k!==1v){1a.6k=o.6k}if(o.3J!==1v){1a.3J=o.3J}if(o.ca!==1v){1a.ca=o.ca}if(o.c9!==1v){1a.c9=o.c9}if(o.3R!==1v){1a.3R=o.3R}if(o.2w!==1v){1a.2w=o.2w}};h.1n={xG:1c(){1d 1a.4b},xD:1c(){1d 1a.6k},xB:1c(){1d 1a.3J},WB:1c(o){1a.3J=o},GV:1c(){1d 1a.ca},GW:1c(){1d 1a.c9},sL:1c(){1d 1a.3R},a6:1c(){1d 1a.i4},wZ:1c(o){1a.i4=o},cc:1c(){1d 1a.6X},uB:1c(o){1a.6X=o},5z:1c(){1a.kd=1m},dN:1c(){1d 1a.kd},GY:1c(){1d 1a.2w}};1e.1Z(h,"1e.1i.p1",1e.1i.wT);1b f=a.4M=1c(o){1o.2u(f,1a,[o]);if(o.1C){1a.1C=o.1C}if(o.2N!==1v){1a.2N=o.2N}};f.1n={WC:1c(){1d 1a.1C},Wx:1c(){1d 1a.2N}};1e.1Z(f,"1e.1i.4M",h);1b n=a.7A=1c(o){1o.2u(n,1a,[o]);if(o.2h){1a.2h=o.2h}};n.1n={Wy:1c(){1d 1a.2h}};1e.1Z(n,"1e.1i.7A",h);1b k=a.xC=1c(o){1o.2u(k,1a);if(o.7C){1a.7C=o.7C}if(o.4b){1a.4b=o.4b}if(o.3J!==1v){1a.3J=o.3J}};k.1n={xG:1c(){1d 1a.4b},xB:1c(){1d 1a.3J},cc:1c(){1d 1a.6X},uB:1c(o){1a.6X=o},5z:1c(){1a.kd=1m},dN:1c(){1d 1a.kd}};1e.1Z(k,"1e.1i.xC",1e.1i.wT);1b c=a.xH=1c(o){1o.2u(c,1a);if(o.7C){1a.7C=o.7C}if(o.4b){1a.4b=o.4b}if(o.6k!==1v){1a.6k=o.6k}};c.1n={xG:1c(){1d 1a.4b},xD:1c(){1d 1a.6k}};1e.1Z(c,"1e.1i.xH",1e.dV);1b l=a.oH=1c(o){1o.2u(l,1a);if(o.2w){1a.2w=o.2w}if(o.bj){1a.bj=o.bj}if(o.1w){1a.1w=o.1w}};l.1n={GY:1c(){1d 1a.2w},PV:1c(){1d 1a.bj},PT:1c(o){1a.bj=o},2s:1c(){1d 1a.1w}};1e.1Z(l,"1e.1i.oH",1e.dV);1b d=a.k3=1c(o){1o.2u(d,1a);if(o.7C){1a.7C=o.7C}if(o.1C){1a.1C=o.1C}if(o.5y){1a.5y=o.5y}if(o.3y!==1v){1a.3y=o.3y}if(o.2A!==1v){1a.2A=o.2A}if(o.ca!==1v){1a.ca=o.ca}if(o.c9!==1v){1a.c9=o.c9}if(o.3R!==1v){1a.3R=o.3R}if(o.6k!==1v){1a.6k=o.6k}if(o.4b!==1v){1a.4b=o.4b}};d.1n={8p:1c(){1d 1a.5y},xD:1c(){1d 1a.6k},GV:1c(){1d 1a.ca},GW:1c(){1d 1a.c9},sL:1c(){1d 1a.3R},a6:1c(){1d 1a.i4},wZ:1c(o){1a.i4=o},cc:1c(){1d 1a.6X},uB:1c(o){1a.6X=o}};1e.1Z(d,"1e.1i.k3",1e.1i.wT);1b g=a.oq=1c(o){1o.2u(g,1a,[o]);1a.5z=1u};g.1n={5z:1c(){1a.5z=1m},dN:1c(){1d 1a.5z}};1e.1Z(g,"1e.1i.oq",1e.1i.k3);1b e=a.uq=1c(o){1o.2u(e,1a);if(o.2w!==1v){1a.2w=o.2w}if(o.3x!==1v){1a.3x=o.3x}if(o.kK!==1v){1a.kK=o.kK}if(o.3R!==1v){1a.3R=o.3R}if(o.kM!==1v){1a.kM=o.kM}1a.i4=1u};e.1n={Wz:1c(){1d 1a.2w},g1:1c(){1d 1a.3x},cC:1c(o){1a.3x=o},WD:1c(){1d 1a.kK},sL:1c(){1d 1a.3R},WH:1c(){1d 1a.kM},a6:1c(){1d 1a.i4},wZ:1c(o){1a.i4=o}};1e.1Z(e,"1e.1i.uq",1e.dV);1b j=a.xm=1c(o){1o.2u(j,1a);1a.4x=o};j.1n={nD:1c(){1d 1a.4x}};1e.1Z(j,"1e.1i.xm",1e.dV);1b b=a.vd=1c(p,o){1o.2u(b,1a,[p]);1a.pc=o};b.1n={WI:1c(){1d 1a.pc},cc:1c(){1d 1a.6X},uB:1c(o){1a.6X=o},5z:1c(){1a.kd=1m},dN:1c(){1d 1a.kd}};1e.1Z(b,"1e.1i.vd",1e.1i.xm)})(1e.1i);1e.1i.1S={uY:"uY",t7:"t7",tw:"tw",tu:"tu",tk:"tk",t1:"t1",sM:"sM",ow:"ow",sO:"sO",sW:"sW",t0:"t0",sZ:"sZ",sU:"sU",sS:"sS",oF:"oF",u8:"u8",tZ:"tZ",um:"um",uc:"uc",ub:"ub",tF:"tF",tI:"tI",qg:"qg",sv:"sv",tK:"tK",qf:"qf",qq:"qq",qo:"qo",tW:"tW",tL:"tL",tQ:"tQ",5Y:"5Y",qh:"qh",i2:"i2",tN:"tN",tS:"tS",tB:"tB",dW:"dW",ty:"ty",lR:"lR",tH:"tH",u1:"u1",u2:"u2",om:"om",u0:"u0",wh:"wh",wg:"wg",sV:"sV",sK:"sK",tj:"tj",tn:"tn",tg:"tg",t5:"t5",t2:"t2",tc:"tc",td:"td",te:"te"};(1c(a){1b d=1e.1z.5t;1b b=1e.1z.2O;1b c=a.vt=1c(e){1o.2u(c,1a,[e]);1a.5D();1a.8T()};c.1n={8T:1c(){1b e=1a.5J();1a.x=e.x;1a.y=e.y},ii:1c(f){if(!1a.8r(f)){1d}if(1a.1C.1t!=1j){1a.1C.1t.ta()}1b e=1a.1C;if(e.6d){e.iv();e.1t.Gz(e)}1l{e.vp();e.1t.Gw(e)}if(1a.1C.1t!=1j){1a.1C.1t.iz()}},8r:1c(e){1d 1a.b2().2M(e)},5J:1c(){1b e=1a.1C;1b f=d.3h(e.1t.2o);1b g=e.1w.4e();1d b.9N(e.1w.2y()+f,g.y-2*f,e.1w.2y()+5*f,g.y+2*f)},b2:1c(){1b f=1a.5J();if(1a.1C.2f!=0){1b j=[];j.1h(f.5a());j.1h(f.a7());j.1h(f.9Z());j.1h(f.aR());a.1A.cU(j,a.1A.5C(1a.1C.1w),1a.1C.2f);1b e=1s.2b(j[0].x,1s.2b(j[1].x,1s.2b(j[2].x,j[3].x)));1b k=1s.2b(j[0].y,1s.2b(j[1].y,1s.2b(j[2].y,j[3].y)));1b h=1s.1U(j[0].x,1s.1U(j[1].x,1s.1U(j[2].x,j[3].x)));1b g=1s.1U(j[0].y,1s.1U(j[1].y,1s.1U(j[2].y,j[3].y)));1d b.9N(e,k,h,g)}1d f},vB:1c(f,g){f.1V="9D";1a.2H=[f];1b h=f.y+f.1p/2;1b e=1g 1e.1z.gE(f.x+g,h,f.2y()-g,h);1a.2H.1h(e)},GG:1c(g,h){1a.vB(g,h);1b e=g.x+g.1q/2;1b f=1g 1e.1z.gE(e,g.y+h,e,g.2V()-h);1a.2H.1h(f)},5D:1c(){1b f=d.3h(1a.1C.1t.2o);1b e=1a.5J();e.x=e.y=0;if(1a.1C.6d){1a.vB(e,f)}1l{1a.GG(e,f)}}};1e.1Z(c,"1e.1i.vt",a.eU)})(1e.1i);(1c(b){1b c=1e.1z.2O;1b a=b.vG=1c(d){1a.1H=d};a.1n.Xd=1c(){1b d=1g b.5m(1a.1H);if(6y.1f==1){d.3g(6y[0])}1l{if(6y.1f==4){d.3g(c.oz(6y))}}1a.1H.54(d);1d d};a.1n.Xe=1c(){1b d=1g b.cg(1a.1H);if(6y.1f==1){d.3g(6y[0])}1l{if(6y.1f==4){d.3g(c.oz(6y))}}1a.1H.54(d);1d d};a.1n.Xf=1c(){1b d=1g b.3V(1a.1H);if(6y.1f==1){d.3g(6y[0])}1l{if(6y.1f==4){d.3g(c.oz(6y))}}1a.1H.54(d);1d d};a.1n.Xa=1c(){1b d=1g b.ix(1a.1H);if(6y.1f==1){d.3g(6y[0])}1l{if(6y.1f==4){d.3g(c.oz(6y))}}1a.1H.54(d);1d d};a.1n.Xc=1c(e,d){1b f=1g b.3G(1a.1H,e,d);1a.1H.54(f);1d f};1e.1Z(a,"1e.1i.vG")})(1e.1i);(1c(a){1b f=1e.1z.5t;1b c=1e.1z.2O;1b d=1e.1z.nv;1b e=1e.1z.gE;1b b=a.Em=1c(g){1o.2u(b,1a,[g]);1a.5D();1a.8T()};b.1n={8T:1c(){1b g=1a.5J();1a.x=g.x;1a.y=g.y},ii:1c(h){if(!1a.8r(h)){1d}1b g=1a.1C;if(g.1t.9z()){g.1t.3H.jj();g.1t.3H.9S(1g a.u3(1a,g));g.1t.3H.js()}1l{g.jl(!g.gu())}if(g.gu()){g.Ij(g)}1l{g.If(g)}},8r:1c(g){1d 1a.b2().2M(g)&&a.1A.ry(g,1a.5P())},5J:1c(){1b j=1a.1C;1b l=f.3h(j.1t.2o);1b g=j.cN();1b k=l;if(k>g/4){k=g/4}1b h=j.1w.1J();h.1p=g;h.x=h.2y()-g;h.1q=g;h=h.5B(-k,-k);1d h},b2:1c(){1b h=1a.5J();if(1a.1C.2f!=0){1b l=[];l.1h(h.5a());l.1h(h.a7());l.1h(h.9Z());l.1h(h.aR());a.1A.cU(l,a.1A.5C(1a.1C.1w),1a.1C.2f);1b g=1s.2b(l[0].x,1s.2b(l[1].x,1s.2b(l[2].x,l[3].x)));1b n=1s.2b(l[0].y,1s.2b(l[1].y,1s.2b(l[2].y,l[3].y)));1b k=1s.1U(l[0].x,1s.1U(l[1].x,1s.1U(l[2].x,l[3].x)));1b j=1s.1U(l[0].y,1s.1U(l[1].y,1s.1U(l[2].y,l[3].y)));1d c.9N(g,n,k,j)}1d h},5P:1c(){1b g=1a.5J();1b h=[];h.1h(g.5a());h.1h(g.a7());h.1h(g.9Z());h.1h(g.aR());a.1A.cU(h,a.1A.5C(1a.1C.1w),1a.1C.2f);1d h},5D:1c(){1b k=1a.1C;1b l=f.3h(k.1t.2o);1b g=3*l/4;1b z=1a.5J();z.x=z.y=0;1b h=1g d(z);h.2j="cA";h.1V="9D";1a.2H=[h];1b j=z.1q/5;1b n=z.x+z.1q/2;1b A=z.y+z.1p/2-j/2;1b s=l/2;1b v=j-s;1b w=A+s;1b u=z.y+z.1p/2+j/2;1b r=u-s;if(!k.6w){1b t=1g e(n,A,n-j,A+j);t.2j="cA";1a.2H.1h(t);1b q=1g e(n,A,n+j,A+j);q.2j="cA";1a.2H.1h(q);if(v>0){1b p=1g e(n,w,n-v,w+v);p.2j="cA";1a.2H.1h(p);1b o=1g e(n,w,n+v,w+v);o.2j="cA";1a.2H.1h(o)}}1l{1b t=1g e(n,u,n-j,u-j);t.2j="cA";1a.2H.1h(t);1b q=1g e(n,u,n+j,u-j);q.2j="cA";1a.2H.1h(q);if(v>0){1b p=1g e(n,r,n-v,r-v);p.2j="cA";1a.2H.1h(p);1b o=1g e(n,r,n+v,r-v);o.2j="cA";1a.2H.1h(o)}}}};1e.1Z(b,"1e.1i.Em",a.eU)})(1e.1i);(1c(b){1b a=1e.1z.5t;1b h=1e.1z.5k;1b d=1e.1z.2O;1b c=1e.1z.gp;1b j=1e.1i.iQ;1b l=b.aF=1c(n){1o.2u(l,1a,[n]);1a.1r=[];1a.2W=1g 1e.1z.bX();1a.5K={1C:1a,5P:1c(){1d 1a.1C.2W}};1a.1K.gG=1m;1a.1K.4a=b.3q.4H;1a.1K.4p=b.3q.4H};l.1n={Xk:1c(){1d 1a.6M},Xl:1c(n){if(1a.6M!=n){1a.6M=n;1a.1F()}},hM:1c(){1d 1a.1r},oQ:1c(n){if(1a.1r!=n){1a.1r=n;1a.4k()}},1J:1c(){1b n=1o.2a(l,1a,"1J",[]);n.6M=1a.6M;n.1r=g(1a.1r);n.hs();1d n},2k:1c(){1b n=1o.2a(l,1a,"2k",[]);n.6M=1a.6M;n.1r=f(1a.1r);1d n},2E:1c(n){1o.2a(l,1a,"2E",[n]);1a.6M=n.6M;1a.1r=k(n.1r);1a.hs()},4f:1c(o,n){1o.2a(l,1a,"4f",[o,n]);1a.6M=n.3U("Gt",o);1a.1r=k(n.7W("hv",o));1a.hs()},4E:1c(o,n){1o.2a(l,1a,"4E",[o,n]);n.3O(1a.6M,"Gt",o);n.aW(f(1a.1r),"hv",o)},eW:1c(){1b p=1a.4n.2H=[];1b o=1a.1w;1b n=1a.gr();if(1a.6M){1b q={1V:n,dE:j.l4};1a.eN(p,q);if(q.1V){n=q.1V}}if(1a.6M){1a.2W.1V=n}1l{1a.2W.1V=1j}1a.2W.2j=1a.aI();1a.2W.2v=1;1a.2W.3f=1a.bz();1a.2W.aK=1a.dA();p.1h(1a.2W);if(1a.6M){1a.eN(p,{dE:j.k4})}1a.1K.2i=1a.c8();1a.1K.2j=1a.9R();1a.1K.3P=1a.gB();1a.1K.2v=1a.iL();1a.1K.3g(o,(1a.8x)?1a.2f:0);p.1h(1a.1K);1a.oc(p);if(1a.dD){1a.dD(1a)}},7k:1c(v){if(v.4X==b.3z.4Y){1b w=v.cW.1J();1a.1r.1h(w);1a.2W.6V(w.x,w.y)}if(v.4X==b.3z.7q&&1o.1Y(b.eQ,v.3J)){1a.m4=1a.1r.6t();1b o=v.3J;1b s=1s.2b(1a.1w.1q/6,1s.2b(1a.1w.1p/6,1a.1t.g2));1a.oM=[];1b n=1a.1r[o.1y];1k(1b q=-1;q<=1;q+=2){1k(1b r=o.1y+q;1m;r+=q){1b t=r%1a.1r.1f;if(t<0){t=1a.1r.1f+t}if(t==o.1y){1a.oM=[];1Q}1b z=1a.1r[t];1b u=h.5E(n,z);if(u>s){1Q}1a.oM[t]=u}}}1o.2a(l,1a,"7k",[v])},eP:1c(s){if(s.4X==b.3z.4Y){1b z=1a.1r[1a.1r.1f-1];1b q=s.6R;if(!z.hh(q)){1b t=q.1J();1a.1r.1h(t);1a.2W.3D(t.x,t.y);1a.4k(1u,1u)}1d}if(s.4X==b.3z.7q&&1o.1Y(b.eQ,s.3J)){1b n=s.3J;1b p=n.1y;1b B=s.6R.x-1a.m4[p].x;1b A=s.6R.y-1a.m4[p].y;1k(1b o=0;o<1a.oM.1f;o++){1b w=1a.oM[o];if(w===1v){2t}1b u=1a.m4[o].1J();1b r=a.CR(w,a.Xi,1a.1t.2o);r=1s.1U(r/2,1);u.x+=B/(r*r);u.y+=A/(r*r);1a.1r[o]=u}1a.1r[p]=s.6R.1J();if(!1a.eu().hh(1a.1w)){1a.4k(1m,1u)}1a.hs();1a.1F();1d}1o.2a(l,1a,"eP",[s])},hP:1c(n){1o.2a(l,1a,"hP",[n]);if(n.4X==b.3z.4Y){if(h.5E(n.6R,1a.1r[0])<1a.1t.fZ){1a.6M=1m;1a.2W.hT();1a.1F()}}},5z:1c(n){if(n.4X==b.3z.7q&&1o.1Y(b.eQ,n.3J)){1a.1r=1a.m4.6t();1a.4k(1u,1m)}1o.2a(l,1a,"5z",[n])},eu:1c(p){if(p===1v){p=1a.1r}1b q=1j;1k(1b o=0;o<p.1f;o++){1b n=p[o];if(q==1j){q=1g d(n.x,n.y,0,0)}1l{q=e(q,n)}}1d q!=1j?q:d.7s},4k:1c(n,o){if(n===1v){n=1m}if(o===1v){o=1m}1a.mc=1m;1a.3g(1a.eu(),n,n);1a.mc=1u;if(o){1a.hs()}},hs:1c(){1a.2W=1g 1e.1z.bX();1k(1b o=0;o<1a.1r.1f;o++){1b n=1a.1r[o];if(o==0){1a.2W.6V(n.x,n.y)}1l{1a.2W.3D(n.x,n.y)}}if(1a.6M){1a.2W.hT()}},lT:1c(){1o.2a(l,1a,"lT",[]);if(1a.mc){1d}1b o=1a.eu();if(o.hh(1a.1w)){1d}1b n=1a.1w.1q;1b p=1a.1w.1p;1b s=a.3h(1a.1t.2o);if(n>s&&p>s){if(n!=o.1q||p!=o.1p){1b r=1g c();r.uN(n/o.1q,p/o.1p,1a.1w);r.lZ(1a.1r)}1b q=1g c();o=1a.eu();q.8f(1a.1w.x-o.x,1a.1w.y-o.y);q.lZ(1a.1r);1a.hs()}},8c:1c(n){1b o=1a.P5(n,4*a.3h(1a.1t.2o));if(o!==1j){1d 1g b.eQ(1a,o)}1d 1o.2a(l,1a,"8c",[n])},P5:1c(n,q){1b o=3W.5s;1b t=1j;1k(1b p=0;p<1a.1r.1f;p++){1b r=1a.1r[p];if(1s.3j(r.x-n.x)>q||1s.3j(r.y-n.y)>q){2t}1b s=h.5E(n,r);if(s<o){t=p;o=s}}1d t},2M:1c(n){1d b.5m.1n.2M.3F(1a,[n])},lm:1c(q){1o.2a(l,1a,"lm",[q]);1b o=1a.fL();q.8D();q.7i=1/q.7w;q.6U="8k";q.8Q="Xj";1k(1b p=0;p<1a.1r.1f;p++){1b n=1a.1r[p];q.ck();q.cJ(n.x,n.y,o/4,0,2*1s.PI);q.hy();q.3P()}q.8N()},5P:1c(){1d g(1a.1r)},e3:1c(n){1d 1o.2a(l,1a,"e3",[n])},7u:1c(o,p){1b n=p.3E["3b:aF"];if(n){if(o.3F(n)){1d n}}1d 1o.2a(l,1a,"7u",[o,p])},9f:1c(){1b n=1o.2a(l,1a,"9f",[]);n.6M=1a.6M;n.1r=g(1a.1r);1d n},a2:1c(n){1a.mc=1m;1o.2a(l,1a,"a2",[n]);1a.mc=1u;1a.6M=n.6M;1a.1r=g(n.1r);1a.hs()},vk:1c(r,u){1b B=1a.2s();1b z=1j;1b v=3W.5s;1b A=20*a.3h(1a.1t.2o);1b C=1g b.5m(1a.1t);C.3g(B);1k(1b t=0;t<r.1f;t++){1b w=r[t];C.4P(w);1b n=C.5P();1b s=0;1k(1b q=0;q<1a.1r.1f;q++){1b D=1a.1r[q];1b o=b.1A.lW(D,n,n.1f);s+=o}s/=1a.1r.1f;if(s<v){z=w;v=s}}C.4P(v<A?z:u);1d C},8v:1c(){if(!fP){fP=1g 1e.5b(l.1n,1j,1a)}1l{fP.5c(1a)}1d fP}};l.bi=1c(n){if(!fP){fP=1g 1e.5b(l.1n,n)}1l{fP.5c(1j)}1d fP};fP=1j;1e.1Z(l,"1e.1i.aF",b.2Z);b.eQ=1c(o,n){1a.2w=o;1a.1y=n};1e.1Z(b.eQ,"1e.1i.eQ");1c e(o,n){if(o.2M(n)){1d o}1d d.9N(1s.2b(o.3M(),n.x),1s.2b(o.3Z(),n.y),1s.1U(o.2y(),n.x),1s.1U(o.2V(),n.y))}1c g(o){1b p=[];1k(1b n=0;n<o.1f;n++){p[n]=o[n].1J()}1d p}1c f(o){1b p="";1k(1b n=0;n<o.1f;n++){if(n>0){p+=","}p+=o[n].x.4Q();p+=",";p+=o[n].y.4Q()}1d p}1c k(t){1b r=[];1b s=t.f3(",");1k(1b p=0;p<s.1f;p+=2){1b o=s[p];1b q=s[p+1];1b n=1g h(3W(o),3W(q));r.1h(n)}1d r}})(1e.1i);(1c(b){1b c=1e.1z.5k;1b d=1e.1z.5t;1b a=b.mp={P2:1c(l,t){1b k=b.6G;1b z=b.fI;1b g=t.2s();1b f=t.9u();1b r=t.t9();1b n=t.lp();1b u=t.3o();1b h=t.fL();1b v=u.uG;if(v===1v){v=0}if(f){l=b.1A.6A(l,g.4e(),-f)}if(r==z.mg||r==z.wz){1d g.2M(l)&&(n&k.cO)!=0?{2w:t,1y:8}:1j}1b q=d.3h(u.2o);if(r==z.md||r==z.va||r==z.ly||r==z.vU||r==z.vX){1b A=a.im(g,q);if(r==z.ly&&(l.5E(A[8])<1.5*h)){1d 1j}1k(1b p=0;p<10;++p){if(1s.3j(A[p].x-l.x)<=(h/2+v)&&1s.3j(A[p].y-l.y)<=(h/2+v)&&(n&(1<<p))!=0){1d{2w:t,1y:p}}}if(r==z.ly&&g.2M(l)&&(n&k.cO)!=0){1d{2w:t,1y:8}}g=g.5B(h/2);if(r==z.va&&g.2M(l)&&(n&k.cO)!=0){g=g.5B(-h);1d!g.2M(l)?{2w:t,1y:8}:1j}}1l{1b o=a.im(g,q);1k(1b p=0;p<4;++p){if(1s.3j(o[p].x-l.x)<=(h/2)&&1s.3j(o[p].y-l.y)<=(h/2)&&(n&(1<<p))!=0){1d{2w:t,1y:p}}}1b j=q/2;g=g.5B(j);if(g.2M(l)){g=g.5B(-j);if(1s.3j(g.3Z()-l.y)<=(h/2)&&(n&k.wj)!=0){1d{2w:t,1y:4}}if(1s.3j(g.2y()-l.x)<=(h/2)&&(n&k.wE)!=0){1d{2w:t,1y:5}}if(1s.3j(g.2V()-l.y)<=(h/2)&&(n&k.ww)!=0){1d{2w:t,1y:6}}if(1s.3j(g.3M()-l.x)<=(h/2)&&(n&k.wA)!=0){1d{2w:t,1y:7}}}1b e=o[9];if(1s.3j(e.x-l.x)<=(h/2)&&1s.3j(e.y-l.y)<=(h/2)&&(n&k.ce)!=0){1d{2w:t,1y:9}}1b s=g.1J();1b w=t.cN?t.cN():0;if(w!=0){s.1p=w}1l{s=s.5B(-h*2)}if((s.1q<q||s.1p<q)&&g.2M(l)){s=s.5B(h)}if(s.2M(l)&&(n&k.cO)!=0){1d{2w:t,1y:8}}}1d 1j},lR:1c(f,p){1b n=b.6G;1b g=b.fI;1b k=p.3o();1b l=p.t9();1b h=p.2s();1b q=p.fL();1b j=d.3h(k.2o);if(f.hN){f.hN([])}if(l==g.OS||l==g.wz){1d}if(l==g.md||l==g.OT||l==g.ly){a.w6(f,p);1d}if(l==g.vU||l==g.vX){a.Px(f,p);1d}1b e=h.4e();if(l==g.OZ){a.Pu(f,h,j);if((p.lp()&n.ce)!=0){a.mt(f,p)}1d}if(l==g.OX){a.we(f,h,a.w0(),q);if((p.lp()&n.ce)!=0){a.mt(f,p)}1d}if(l==g.va||l==g.OY||l==g.vR||l==g.mg){1b o=l==g.vR||l==g.mg?a.Pl():a.w0();a.we(f,h,o,q);if(l==g.mg){1d}a.w6(f,p);1d}},w6:1c(j,v){1b s=b.6G;1b k=b.fI;1b e=v.2s();1b o=v.3o();1b r=o.w7();1b f=e.4e();1b z=v.fL();1b u=z/2;1b g=v.t9();1b w=v.lp();1b l=d.3h(o.2o);1b q=a.im(e,l);j.8Q=b.1A.7g(j,o.ma,o.2s());j.6U="8k";j.7i=1/j.7w;if((w&s.ce)!=0){a.mt(j,v)}1k(1b p=0;p<9;p++){1b n=(w&(1<<p))==0;if(n&&!r){2t}1b t=q[p];if(p==8){if(g==k.ly){a.lV(j,t,z);2t}if(g!=k.md){2t}}j.iT(t.x-u,t.y-u,z,z);j.ls(t.x-u,t.y-u,z,z)}},Px:1c(g,t){1b q=b.6G;1b e=t.2s();1b l=t.3o();1b p=l.w7();1b f=e.4e();1b v=t.fL();1b s=v/2;1b u=t.lp();1b j=d.3h(l.2o);1b o=a.im(e,j);g.8Q=b.1A.7g(g,l.ma,l.2s());g.6U="8k";g.7i=1/g.7w;if((u&q.ce)!=0){a.mt(g,t)}1k(1b n=0;n<9;n++){1b k=(u&(1<<n))==0;if(k&&!p){2t}1b r=o[n];if(n<4){a.lV(g,r,s*1.2)}1l{g.iT(r.x-s,r.y-s,v,v);g.ls(r.x-s,r.y-s,v,v)}}},Pu:1c(e,f,h){e.7i=1/e.7w;if(e.hN){e.6U="9D";e.ls(f.x,f.y,f.1q,f.1p);1b g=e.X7();e.hN([2*h]);e.6U="8k";e.ls(f.x,f.y,f.1q,f.1p);e.hN(g)}1l{e.6U="cA";e.ck();a.lI(e,f.5a(),f.a7(),2*h);a.lI(e,f.a7(),f.9Z(),2*h);a.lI(e,f.9Z(),f.aR(),2*h);a.lI(e,f.aR(),f.5a(),2*h);e.3P()}},lI:1c(e,n,l,g){1b j=1s.6i(n.5E(l)/g);1b p=(l.x-n.x)/j;1b o=(l.y-n.y)/j;e.6V(n.x,n.y);1b k=n.x,h=n.y;1k(1b f=0;f<j;f++){k+=p;h+=o;if(f%2==0){e.6V(k,h)}1l{e.3D(k,h)}}if(f%2==0){e.6V(l.x,l.y)}1l{e.3D(l.x,l.y)}},we:1c(f,g,j,e){1b k=f.7w;f.8D();f.3A(1/k,1/k);1b h=f.sN(j,"eB");f.6U=h;f.7i=k*e/2;f.ls(k*g.x,k*g.y,k*g.1q,k*g.1p);f.8N()},mt:1c(g,n){1b j=n.3o();1b h=d.3h(j.2o);1b e=n.2s();1b o=e.5a();1b f=e.4e();1b l=1g c(f.x,o.y-6*h);1b k=1.4*n.fL()/2;g.7i=1/g.7w;g.6U="cA";g.ck();a.lI(g,l,e.Pg(),h);g.3P();g.8Q=b.1A.7g(g,j.ma,j.2s());g.6U="8k";a.lV(g,l,k)},im:1c(j,k){1b g=j.5a();1b h=j.9Z();1b e=j.4e();1b f=[];f.1h(g);f.1h(j.a7());f.1h(h);f.1h(j.aR());f.1h(1g c(e.x,g.y));f.1h(1g c(h.x,e.y));f.1h(1g c(e.x,h.y));f.1h(1g c(g.x,e.y));f.1h(e);f.1h(1g c(e.x,g.y-6*k));1d f},lV:1c(g,f,e){g.ck();g.cJ(f.x,f.y,e,0,2*1s.PI,1u);g.Mi();g.hy();g.3P()},w0:1c(){if(!a.sC){a.sC=a.sN([1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1])}1d a.sC},Pl:1c(){if(!a.sH){a.sH=a.sN([1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1])}1d a.sH},sN:1c(n){1b k=3p.dj("Md");k.1q=8;k.1p=8;1b g=k.sL("2d");g.8Q="u7(k6,k6,k6)";g.iT(0,0,8,8);1b h=g.X5(1,1);1b j=h.7x;j[0]=0;j[1]=0;j[2]=0;j[3]=k6;1k(1b l=0;l<8;l++){1k(1b e=0;e<8;e++){1b f=8*l+e;if(n[f]){g.X6(h,e,l)}}}1d k},sC:1j,sH:1j}})(1e.1i);(1c(a){1b b=a.9Q=1c(d,e,f,c){1a.4B=d;1a.4X=e;1a.3J=f;1a.cW=c;1a.cv=1g 1e.2T.8u()};b.1n={tz:1c(){1a.ip=1g 1e.2T.dZ();1a.4B.9w(1a);1a.4B.1t.9w(1a.ip);if(1a.4X===a.3z.4Y&&1a.4B.1t){1a.4B.1t.Ok(1a.4B)}1a.4B.7k(1a);1a.O9=1a.3J==1j?1g 1e.1z.5k(0,0):1a.4B.mV(1a.3J.1y)},kb:1c(c){1a.6R=c;if(1a.4X===a.3z.7q){if(!a.4A.5u){a.4A.5u=1g a.4A(1a)}1a.4B.eP(1a);if(a.4A.5u.bD==1a){a.4A.5u.gX();a.4A.5u=1j}}1l{1a.4B.eP(1a)}},Ol:1c(e){1b c=1a.4B.1t;1a.6R=e;1a.4B.hP(1a);if(1a.4X===a.3z.4Y){1b d=c.sF(1a.4B);if(d!=1a.4B){c.c3(1a.4B);1a.4B=d;c.54(1a.4B)}c.xy(1a.4B)}if(1a.4X===a.3z.7q){c.wF(1a.4B,e,1a.3J.1y)}},6X:1c(c){if(1a.4B!=1j){1a.4B.5z(1a);if(1a.4X===a.3z.4Y){c.c3(1a.4B)}1a.4B=1j}},wk:1c(c){1b d=1a.4B;if(1a.4X===a.3z.4Y){1d d.1t.uV(d,1a)&&d.hE(1a)}if(1a.4X===a.3z.7q){1d d.1t.Oq(d,1a)&&d.hE(1a)}1d 1m},ne:1c(){1a.5z=1m},dN:1c(){1d 1a.5z},Oc:1c(c){if(1a.ip&&!1a.ip.2c(c)){1a.ip.3u(c)}},Od:1c(c){1d 1a.ip&&1a.ip.2c(c)},ws:1c(){1d a.1A.d4(1a.6R,1a.O9)}};1e.1Z(b,"1e.1i.9Q")})(1e.1i);(1c(c){1b a=1e.2T.5i;1b f=1e.2T.8u;1b e=1e.2T.dZ;1b d=1e.1z.2O;1b b=c.jA={c5:1c(k,n){1b l=n.jy(k.ie,k.8h,k.tU);l.fR=n.2s();if(k.tU){b.Qy(l)}1b j=k.ji?l.mx():[l];1b h=k.7M+n.1w.x;1b g=k.7M+n.1w.y;if(n.2R!==1v){g+=n.2R}a.1B(j,1c(p){1b q=1e.3N.gg;1b r=b.Oh(p);if(k.c5(p)===$iu){1d}1b o=b.Og(p,k,h,g,r,n);if(k.9X==q.7U){h+=o.1q+k.7M}1l{g+=o.1p+k.7M}});l.$OQ.1B(1c(o){o.vw()});l.$OO.1B(1c(p,o){o.1B(1c(q){q.1N=p.1N;q.ui()})})},Oh:1c(h){1b g=1g f();h.2g.1B(1c(n){1b l=n.5j;if(l){1b j=l.ve();1b k=l.yu();g.2p(l,{i8:j,ic:k})}});1d{6P:g}},Og:1c(n,k,h,g,o,l){1b j=b.Qx(n,l.1w);n.2q.1B(1c(q){if(q.5j){if(k.8h){1b s=q.x-q.1q/2;1b r=q.y-q.1p/2;if(!(k.fr&&k.fr())){q.5j.yq(s+h-j.x,r+g-j.y,1m,1m)}1l{q.5j.yq(s,r,1m,1m)}}1l{1b p=k.tU?1u:1m;if(!(k.fr&&k.fr())){q.5j.yr(q,h-j.x,g-j.y,1m,p)}1l{q.5j.yr(q,0,0,1m,p)}}}});if(!k.kq){b.QB(l.3L)}1l{n.2g.1B(1c(q){1b p=q.5j;if(p){if(k.mf&&k.mf()){p.4P(c.4q.a5)}if(!(k.fr&&k.fr())){p.lq(q.1r,h-j.x,g-j.y,!k.hR)}1l{p.lq(q.1r,0,0,!k.hR)}if(k.hR){p.4k()}p.OJ()}})}n.2g.1B(1c(r){1b q=r.5j;if(q){if(k.6P==1e.3N.gS.OH){1b s=q.1E.fD(q.1r[0],q,1u);1b t=q.1x.fD(q.1r[q.1r.1f-1],q,1m);q.yb(s.1y);q.yc(t.1y)}1l{if(k.6P==1e.3N.gS.OI){if(o&&o.6P){1b p=o.6P.1G(q);if(p){if(p.i8||p.i8===0){q.yb(p.i8)}if(p.ic||p.ic===0){q.yc(p.ic)}}}}}}});1d j},jy:1c(g,n,p,h,s,j){1b r=1g 1e.3N.mL();1b k=r.$OQ=1g a();1b q=r.$OO=1g f();if(p){h.1B(1c(t){1b u=r.gl(t.2s(),t);u.OM=t.6g();u.8q=t.ye();t.e0=u});1d r}1b l=1g f();1b o=1g f();c.jA.Qs(h,l,o,n,j);l.1B(1c(u){1b t=b.QA(l.1G(u));1b v=r.gl(t,u);v.OM=u.6g();v.8q=u.ye();u.e0=v});a.1B(s,1c(w){if(w.jW()){1d}if(!o.2c(w.1E)){1d}if(!o.2c(w.1x)){1d}1b u=o.1G(w.1E);1b z=o.1G(w.1x);if(g){if(w.1E==w.1x){k.1h(w)}if(u==z){1d}}1b t;if(g&&(t=u.e0.y6(z.e0))!=1j){if(!q.2c(t.5j)){q.2p(t.5j,1g a())}q.1G(t.5j).1h(w);1d}if(w.1E!=w.1x&&u==z){1d}1b v=r.ge(u.e0,z.e0,w)});1d r},Qt:1c(n,l,h){1b k=n;1b o=k.ua(l);1b g=1g a();g.1h(k);2L(o!=1j&&o!=h){k=o;if(g.2c(k)){1b j=1u;a.1B(g,1c(p){if(p.jW()){j=1m;1d $1Q}});if(j){4R 1g 5h("W0 Qw W1 W2 kS VJ on VK VL VG VH VI VM or VQ VR to VS 3n Qw VN VO.")}1d n}g.1h(k);o=k.ua(l)}1d k},uh:1c(j,k,g,h){k.3u(j);g.1h(j);if(h){a.1B(j.oo(),1c(l){if(l.jW()){1d}b.uh(l,k,g,h)})}if(j.3B){a.1B(j.3B,1c(l){if(l.jW()){1d}b.uh(l,k,g,h)})}},Qs:1c(j,k,l,n,h){1b g=1g a();a.1B(j,1c(p){if(g.2c(p)){1d}1b o=b.Qt(p,n,h);if(o.jW()){1d}1b q=1g e();b.uh(o,q,g,n);k.2p(o,q);q.1B(1c(r){l.2p(r,o)})})},QA:1c(g){if(g.q2()==0){1d d.7s}1b h=1j;g.1B(1c(j){h=j.1w.9I(h)});1d h},QB:1c(g){a.1B(g,1c(h){h.ui()})},Qx:1c(j,g){if(j.2q.1f==0){1d g}1b h=1j;j.2q.1B(1c(k){h=d.cK(k).9I(h)});1d h},Qy:1c(g){g.2q.1B(1c(j){1b h=j.5j;if(1o.1Y(c.3V,h)){j.y9=h.cN()}1b k=h.ua(1m);if(k){1b l=k.e0;j.bD=l;if(l.dR==1j){l.dR=[]}l.dR.1h(j)}})}}})(1e.1i);(1c(a){1b d=1e.1z.2O;1b g=1e.1z.5k;1b e=1e.1z.BW;1b f=1e.1z.aX;1b c=1e.1i.Qm;1b b=a.nq=1c(h,j){1a.2h=h;1a.1K=1g 1e.1z.aX(j||"",1g d(0,0,1,1));1a.1K.Qk="3Z";1a.1K.3K=1g e(0,0,0,0);1a.ay=a.3q.4H;1a.aE=a.3q.ek;1a.aN=c.sX;1a.1y=0;1a.9n=0.5;1a.aO=0;1a.3K=1g e(2,2,2,2);1a.dM=1u;1a.aQ=3W.5s;1a.9O=d.7s;1a.a9=1u};b.1n={2E:1c(h){1a.1K=1g 1e.1z.aX(h.1K||"",1g d(0,0,1,1));1a.1K.Qk="3Z";1a.1K.3K=1g e(0,0,0,0);1a.aN=h.aN;1a.1y=h.1y;1a.9n=h.9n;1a.aO=h.aO;if(5G h.3K=="ik"){1a.3K=1g e(h.3K,h.3K,h.3K,h.3K)}1l{1a.3K=e.bC(h.3K)}1a.ay=h.ay;1a.aE=h.aE;1a.dM=h.dM;if(h.aQ){1a.aQ=h.aQ}if(h.2i){1a.oE(8t.bC(h.2i))}if(h.2D){1a.dS(h.2D)}1a.QK(h.a9);if(h.1V!=1v){1a.4y(h.1V)}},2k:1c(){1b h={1K:1a.1K.1K,aN:1a.aN,1y:1a.1y,9n:1a.9n,aO:1a.aO,3K:1a.3K,ay:1a.ay,aE:1a.aE,dM:1a.dM,aQ:1a.aQ==3W.5s?1v:1a.aQ,a9:1a.a9,2i:1a.2i,2D:1a.2D,1V:1a.1V};1d h},4E:1c(j,h){j.2X("ew","2");h.aW(1a.6g(),"aX",j);h.3m(1a.aN,"Qi",j);h.3m(1a.1y,"cb",j);h.4W(1a.9n,"Qj",j);h.4W(1a.aO,"Qq",j);h.zC(1a.3K,"rv",j);h.3m(1a.ay,"Qr",j);h.3m(1a.aE,"Qp",j);h.3O(1a.dM,"Qn",j);h.4W(1a.aQ,"Qo",j);h.6I(1a.2D,"hl",j);h.6I(1a.1V,"cR",j);h.pY(1a.2i,"8t",j);h.3O(1a.a9,"QM",j)},4f:1c(j,h){1a.6Q(h.7W("aX",j));1a.aN=h.2Q("Qi",j);1a.1y=h.2Q("cb",j);1a.9n=h.4G("Qj",j);1a.aO=h.4G("Qq",j);1a.3K=h.zN("rv",j);1a.ay=h.2Q("Qr",j);1a.aE=h.2Q("Qp",j);1a.dM=h.3U("Qn",j);1a.aQ=h.4G("Qo",j);1a.2D=h.6p("hl",j);1a.1V=h.6p("cR",j);1a.2i=h.pN("8t",j);1a.a9=h.3U("QM",j)},1J:1c(){1b h=1g 1a.4L(1a.2h);h.1K=1a.1K.1J();h.aN=1a.aN;h.1y=1a.1y;h.9n=1a.9n;h.aO=1a.aO;h.3K=e.bC(1a.3K);h.ay=1a.ay;h.aE=1a.aE;h.dM=1a.dM;h.aQ=1a.aQ;h.a9=1a.a9;h.2i=(1a.2i)?8t.bC(1a.2i):1v,h.1V=1a.1V;h.2D=1a.2D;1d h},Wm:1c(k,j,h){1a.aN=c.z5;1a.1y=k;1a.9n=j;1a.aO=h;1a.1F()},Wn:1c(k,j,h){1a.aN=c.z6;1a.1y=k;1a.9n=j;1a.aO=h;1a.1F()},Wo:1c(h){1a.aN=c.sX;1a.9n=h;1a.1F()},i5:1c(){if(1a.9O!=d.7s){1d 1a.9O}1b j=1a.QD();1b k=(1a.2i!=1v)?1a.2i:1a.2h.c8();1b n=1a.2h.1t.9r(1a.1K.1K,k,1g d(0,0,3W.5s,1));if(1a.dM&&1a.aQ!=3W.5s){n=1a.2h.1t.9r(1a.1K.1K,k,1g d(0,0,1a.aQ,n.1p));n.1q=f.Ar(1a.1K.1K,1a.1K.2i,1a.2h.1t.3R,1a.2h.1t.3A);1a.1K.gG=1m}1b l=/\\r|\\n/.Wk(1a.1K.1K);if(l){1a.1K.gG=1m}1b h=0;56(1a.ay){1T a.3q.c0:h=j.x+1a.3K.3M;1Q;1T a.3q.4H:h=j.x-n.1q/2;1Q;1T a.3q.ek:h=j.x-n.1q-1a.3K.2y;1Q}1b o=0;56(1a.aE){1T a.3q.c0:o=j.y+1a.3K.3Z;1Q;1T a.3q.4H:o=j.y-n.1p/2;1Q;1T a.3q.ek:o=j.y-n.1p-1a.3K.2V;1Q}1a.9O=1g d(h,o,n.1q,n.1p);1a.1K.3g(1a.9O,0);1d 1a.9O},QD:1c(){56(1a.aN){1T c.z5:1b k=1a.1y;if(k<0){k=1s.1U(0,1a.2h.e9()+k)}1l{k=1s.2b(k,1a.2h.e9()-1)}1b j=1a.2h.QH(k);1b l=1a.ze(0.5,j);1d 1g g(l.x+1a.9n,l.y+1a.aO);1T c.z6:1b h=1a.1y;if(h<0){h=1s.1U(0,1a.2h.1r.1f+h)}1l{h=1s.2b(h,1a.2h.1r.1f-1)}1b l=1a.2h.1r[h];1d 1g g(l.x+1a.9n,l.y+1a.aO);1T c.sX:1d 1a.ze(1a.9n);aL:1d 1g g()}},ze:1c(k,n){if(n==1v){n=1a.2h.zd(20)}1b h=k*1a.QI(n);1b s=0;1k(1b l=0;l<n.1f-1;++l){1b q=n[l];1b p=n[l+1];1b j=q.5E(p);if(s+j>h){1b t=(p.x-q.x)/j;1b r=(p.y-q.y)/j;1b o=h-s;1d 1g g(q.x+t*o,q.y+r*o)}s+=j}1d n[0]},QI:1c(h){1b n=0;1k(1b k=0;k<h.1f-1;++k){1b l=h[k];1b j=h[k+1];n+=l.5E(j)}1d n},eE:1c(){1a.9O=d.7s},1F:1c(){if(1a.2h&&1a.2h.1t&&1a.2h.1t.sI){1a.2h.1t.sD()}1l{1a.9O=d.7s}},sE:1c(h){1a.9O.wv(1g g(h.x-1a.9O.1q/2,h.y-1a.9O.1p/2));1a.1K.3g(1a.9O,0);1d 1a.9O},h2:1c(){1d 1a.1K.1K},eC:1c(){1d 1a.i5()},nm:1c(h){1a.6Q(h)},jZ:1c(){1d 1a.2h},Wl:1c(){1d 1a.a9},QK:1c(h){if(1a.a9!=h){1a.a9=h;if(1a.a9==1m){1a.2h.1t.sI=1m}1a.1F()}},dS:1c(h){1a.2D=h;1a.1K.2j=h;1a.1F()},e2:1c(){1d 1a.2D},oE:1c(h){1a.2i=h;1a.1K.2i=h;1a.1F()},q1:1c(){1d 1a.2i},6Q:1c(h){if(1a.1K.1K!=h){1a.1K.1K=h;1a.1F()}},6g:1c(){1d 1a.1K.1K},Wp:1c(h){if(1a.ay!=h){1a.ay=h;1a.1F()}},Wt:1c(){1d 1a.ay},Wu:1c(h){if(1a.aE!=h){1a.aE=h;1a.1F()}},Wv:1c(){1d 1a.aE},Wq:1c(h){if(1a.3K!=h){1a.3K=h;1a.1F()}},Wr:1c(){1d 1a.3K},4y:1c(h){if(1a.1V!==h){1a.1V=h;if(1a.2h&&1a.2h.1t){1a.2h.1t.1F()}}},7g:1c(){1d 1a.1V}};1e.1Z(b,"1e.1i.nq")})(1e.1i);(1c(b){1b c=1e.bf.aV;1b a=b.fX=1c(f,d,e){1o.2u(a,1a,[f]);1a.tf=d;1a.PO=e||1c(j,h,g){1d 1g b.3G(j,h,g)}};a.1n={iq:1c(o){1b l;1b g=1j;1b e=1a.1H.go(o,1m,1m);if(e!=1j&&e.nu(1m)){1b k=1a.t6(e,o);g={2w:k,1y:k.1r.1f-1};l=1g b.9Q(k,b.3z.4Y,g,o);1a.1H.54(k)}1l{1b n=1a.1H.no()?1a.1H.yK():1;1b f=1a.1H.no()?1a.1H.yL():1;1b d=1a.tq();1b j=1a.1H.ti(d,o,b.6G.tv);d.3g(1g 1e.1z.2O(j.x,j.y,n,f));g={2w:d,1y:2};l=1g b.9Q(d,b.3z.4Y,g,o);1a.1H.54(d)}1d l},bP:1c(d,e){1b f=1a.1H.3i.8c(d);if(f){1d 1a.k9(d,f)}1b h=1a.1H.hG(d);if(h){1d 1a.k9(d,h)}1b g=1a.1H.go(d,1m,1m);if(g!=1j&&g.nu(1m)){1d 1a.bp(c.tp)}1d 1a.bp(c.9j)},tq:1c(){1d 1a.tf(1a.1H)},t6:1c(e,d){1b f=1a.PO(1a.1H,e,d);f.2r.ny(d);1d f}};1e.1Z(a,"1e.1i.fX",b.ei)})(1e.1i);(1c(c){1b e=1e.1z.5t;1b b=1e.1z.gp;1b a=1e.2T.5i;1b d=c.xc=1c(f){1o.2u(d,1a);1a.3a=1a.4L.8s;1a.2h=f;1a.yX();1a.4C=1g b();1a.4a=3q.c0;1a.4p=3q.c0};d.1n={aA:1c(){1d 1a.3a},1J:1c(){1b f=1g d(1a.2h);f.4C=1a.4C.1J();f.4a=1a.4a;f.4p=1a.4p;1d f},l6:1c(f){f.8D();1b g=1a.o6?1:f.7w;f.2i=1a.2i.4Q(g);f.8Q=1a.2j;if(1a.3P){f.6U=1e.1i.1A.7g(f,1a.3P,1a.1w,1m)}f.qZ="3M";f.O3="3Z";1k(1b k=0;k<1a.en.1f;++k){1b j=1a.en[k];if(j.1f==0){2t}1b l=1u;1b h=1a.9L[k];1b n=1a.9G[k].1J();if(!1a.o6){if(f.wK){n=f.wK.AK(n)}f.Ws(1,0,0,1,0,0);f.7i=f.7i*g}if(h&&h!==0){f.8D();1b o=1g b();o.8f(n.x,n.y);o.Dy(h);o.8f(-n.x,-n.y);f.4C.3F(f,o.qu())}if(1a.2h.6L==c.ey.yT){f.8Q=1a.2h.1t?1e.1i.1A.7g(f,1a.2h.1t.jI(),n):"9D";1b p=n.h1();p.1q+=e.3h(1a.2h.1t.2o);p.1p+=e.3h(1a.2h.1t.2o);if(1a.4a==3q.4H){f.iT(n.x-p.1q/2,n.y,p.1q,p.1p);f.8Q=1a.2j;1a.hn(j,n.x-p.1q/2,n.y,f,g)}1l{f.iT(n.x,n.y,n.1q,n.1p);f.8Q=1a.2j;1a.hn(j,n.x,n.y,f,g)}}1l{1a.hn(j,n.x,n.y,f,g)}if(h&&h!==0){f.8N()}}f.8N()},hn:1c(o,l,j,f,g){1b p=o.f3("\\n");1b k=p.1f;1b n=1a.2i.cE*g;1k(1b h=0;h<k;h++){if(p[h]){if(1a.3P){f.W9(p[h],l,j+n*h)}f.O1(p[h],l,j+n*h)}}},yX:1c(){1a.9G=1g a();1a.9L=1g a();1a.en=1g a()}};1e.1Z(d,"1e.1i.xc")})(1e.1i);(1c(a){1b b=a.v8=1c(d,c){1o.2u(b,1a,[d])};b.1n={6H:1c(c){1a.1H.1F()},5R:1c(c){1a.1H.1F()},6j:1c(c){1a.1H.1F()},};1e.1Z(b,"1e.1i.v8",a.ei)})(1e.1i);(1c(b){1b a=1e.1i.v5;1b a=b.v5=1c(d,c){1o.2u(a,1a);1a.bj=b.eM.gF;1a.e6=b.eM.xl;1a.uU=b.eM.ff};a.1n={PV:1c(){1d 1a.bj},PT:1c(c){1a.bj=c},Wa:1c(){1d 1a.e6},Wb:1c(c){1a.e6=c},W6:1c(){1d 1a.uU},W7:1c(c){1a.uU=c},k5:1c(c,d){if((1a.bj==c)&&(d.W8)){1d 1m}if((1a.e6==c)&&(d.Wc)){1d 1m}if((1a.uU==c)&&(d.Wg)){1d 1m}1d 1u}};1e.1Z(a,"1e.1i.v5")})(1e.1i);(1c(a){1b c=1e.bf.aV;1b b=a.wN=1c(d){1o.2u(b,1a,[d])};b.1n={iq:1c(d){1d 1g a.9Q(1a.1H.3i,a.3z.4Y,1j,d)},bP:1c(d,e){1b f=1a.1H.3i.8c(d);if(f){if(1o.1Y(a.2Z,f.2w)&&f.1y<8){1d 1a.bp(1a.PA(f.1y))}1l{1d 1a.bp(c.cO)}}1b g=1a.1H.hG(d);if(g){1d 1a.k9(d,g)}1d 1a.bp(c.9j)}};1e.1Z(b,"1e.1i.wN",a.ei)})(1e.1i);(1c(d){1b b=1e.2T.5i;1b e=1e.1z.2O;1b a=1e.1z.9t;1b f=1e.1z.5t;1b g=1e.1z.8t;1b c=d.nA=1c(h){1o.2u(c,1a,[h]);1a.1w=1g e(0,0,h.1q,h.1p);1a.2o=1e.1z.5t.Ml;1a.3T=1m;1a.1R=[];1a.5U=[];1a.c1=[];1a.5I=5;1a.8U=1g a(24,24);1a.ch=1g a(24,24);1a.7l=1g 1e.1z.8t("nN-nt",12);1a.8P="6h";1a.eK=1m;1a.nR=1o.nS();1a.6Z=d.bd.vc;1a.6f="";1a.Qa=1o.3t(1a,1a.Q8)};c.1n={bo:1c(){1o.2a(c,1a,"bo");1b h=1a.2e();1o.5N(h,{xM:1o.3t(1a,1a.6H)});1a.kY=1o.3t(1a,1a.5R);1o.5N(3p,{jn:1a.kY});1a.jp=1o.3t(1a,1a.6j);1o.5N(3p,{jr:1a.jp});h.6b("PB",1o.3t(1a,1a.pV),1u);h.6b("PJ",1o.3t(1a,1a.pS),1u);h.6b("PK",1o.3t(1a,1a.ks),1u);h.6b("PH",1o.3t(1a,1a.ks),1u);1a.2l(d.1S.dW)},hA:1c(){1o.d3(3p,"jn",1a.kY);1o.d3(3p,"jr",1a.jp);1o.2a(c,1a,"hA")},wW:1c(k){1b j=3p.hS(k);if(j){1b h=j.wY;if(h){h.6b("wL",1o.3t(1a,1o.rj(1a.jO,{id:k})))}}},jO:1c(j,h){1b k=3p.hS(h.id);if(k){k.6T=d.1A.PF(1a.2k())}},2E:1c(k){1a.kc();if(k>""){1b n=1o.2E(k);if(!1a.jT&&n.6f!=1j&&n.6f!=""){1a.uM(n.6f);1a.jT=k;1d}if(n.8U!=1j){if(n.8U.PG){1a.8U=1j}1l{1a.8U=n.8U}}if(n.ch!=1j){if(n.ch.PG){1a.ch=1j}1l{1a.ch=n.ch}}1a.5I=n.5I;1a.jw(n.3T);1a.wP(n.2o);if(n.bJ!==1v){1a.p6(n.bJ)}if(n.6Z!==1v){1a.xI(n.6Z)}1a.2F(d.1S.dW,n.wI);1a.2F(d.1S.i2,n.PW);if(n.1R mN ke){1k(1b j=0;j<n.1R.1f;j++){if(n.1R[j]){1b l=1a.i6(n.1R[j],j);1b h="";if(n.c1 mN ke){h=n.c1[j]||""}1a.Q9(l,h)}}}}1a.2l(d.1S.dW);1a.1F()},i6:1c(l,h){1b j=1o.e7(l.nz||l.3a);if(!j){1d 1j}if(1o.ia(j,d.2Z)){1b k=1g j(1a);k.2E(l);1d k}},2k:1c(){1b k=1a.2e().3C;1b j=1o.2s(k);1b h={id:1a.2e().id,1q:j.1q,1p:j.1p,1R:1a.uC(),c1:1a.Qb(),8U:1a.8U==1j?1g a(0,0):1a.8U,ch:1a.ch==1j?1g a(0,0):1a.ch,3T:1a.3T,2o:1a.2o,5I:1a.5I,6Z:1a.6Z};1d 1o.2k(h)},uC:1c(){1b h=[];1k(1b n=0,j=1a.1R.1f;n<j;n++){1b k=1a.1R[n].2k();h.1h(k)}1d h},Qb:1c(){1b h=[];1k(1b k=0,j=1a.c1.1f;k<j;k++){1b n=1a.c1[k].1K;h.1h(n)}1d h},2l:1c(h,j){1b k=1o.h3(1a,h);if(k!=1j){k(1a,j)}},kc:1c(){1a.1R=[];1a.lE=[];1a.c1=[];1a.x3()},5Y:1c(){1a.2e().1q=1a.2e().1q;1a.3R.8D();1b j=1g 1e.1z.gp();j.3A(1a.3A,1a.3A);1a.3R.wK=j;1a.3R.4C.3F(1a.3R,j.qu());1a.3R.7i=1/1a.3A;1a.3R.7w=1a.3A;1k(1b k=0,h=1a.lE.1f;k<h;k++){1a.lE[k].l6(1a.3R)}1a.3R.8N();if(1a.wM){jV(1a.wM);1a.wM=1j}},uu:1c(){1b n=0;if(1a.c1.1f>0){1k(1b k=0,h=1a.c1.1f;k<h;k++){1b p=1a.eg(1a.9r(1a.c1[k].1K,1a.7l));n=1s.1U(n,p)}}1b o=1a.eg(1o.2s(1a.2e().3C));1b p=(1a.eg(1a.x0())+n+1a.5I*3)*1a.3A;1b j=1s.1U(p,o)-2;1a.eg(1a.2e(),j);1k(1b k=0,h=1a.5U.1f;k<h;k++){1a.eg(1a.5U[k],j)}1a.x3()},eE:1c(){if(!1a.nx){1a.nx=j7(1a.Qa,20)}},Q8:1c(){1b p=1g a(0,0);1k(1b n=0,j=1a.1R.1f;n<j;n++){1b k=1a.8U!=1j?1a.8U:1a.1R[n].2s().h1();1a.1R[n].lG();1a.kE(1a.5U[n]);1a.kE(1a.1R[n].1K);1b h=e.wX(1a.uO(1a.5I+(1a.eA(p)+n*1a.5I*2),1a.5I),k);1a.1R[n].3g(h);1b o=e.wX(1a.uO(1a.5I+(1a.eA(p)+n*1a.5I*2),1a.eg(k)+1a.5I*2),1a.xO(1a.eA(k),1a.eg(1a.2e())-(1a.eg(k)+1a.5I)));1a.c1[n].3g(o);1b h=e.wX(1a.uO((1a.eA(p)+n*1a.5I*2),0),1a.xO(1a.eA(k)+1a.5I*2,1a.eg(1a.2e())));1a.5U[n].x=h.x;1a.5U[n].y=h.y;1a.5U[n].1q=h.1q;1a.5U[n].1p=h.1p;1a.1R[n].lz();1a.hI(1a.5U[n]);1a.hI(1a.1R[n].1K);p.1q+=k.1q;p.1p+=k.1p}1a.uu();if(1a.nx){jV(1a.nx);1a.nx=1j}},x3:1c(){1b h=(1a.8U!=1j)?1a.1R.1f*1a.3A*(1a.eA(1a.8U)+2*1a.5I):1a.3A*(1a.eA(1a.x0())+1a.1R.1f*2*1a.5I);1a.eA(1a.2e(),h);1a.1F()},x0:1c(){1b k=1g a(0,0);1k(1b j=0,h=1a.1R.1f;j<h;j++){1b n=1a.1R[j].2s();k.1p+=n.1p;k.1q+=n.1q}1d k},Q9:1c(k,h){if(k!=1v){b.3u(1a.1R,k);k.1t=1a;k.lz();1b j=1g e();j.1V={3a:"bv",3s:"4l"};j.2j="4l";1a.5U.1h(j);1a.hI(j);1b l=k.1K.1J();l.1K=(h!=1v)?h:"";l.2i=1a.7l;if(1a.6Z==d.bd.7U){l.4a=d.3q.4H;l.4p=d.3q.c0}1l{l.4a=d.3q.c0;l.4p=d.3q.4H}l.gG=1m;b.3u(1a.c1,l);1a.hI(l);1a.eE()}},uO:1c(h,j){1d 1a.6Z==d.bd.7U?{x:h,y:j}:{x:j,y:h}},xO:1c(h,j){1d 1a.6Z==d.bd.7U?{1q:h,1p:j}:{1q:j,1p:h}},eA:1c(h,j){if(j===1v){1d 1a.6Z==d.bd.7U?h.1q:h.1p}1l{if(1a.6Z==d.bd.7U){h.1q=j}1l{h.1p=j}}},eg:1c(h,j){if(j===1v){1d 1a.6Z==d.bd.7U?h.1p:h.1q}1l{if(1a.6Z==d.bd.7U){h.1p=j}1l{h.1q=j}}},xv:1c(h){1k(1b j=0;j<1a.5U.1f;j++){if(1a.5U[j].2M(h)){1d 1a.5U[j]}}},go:1c(h){1b k=1a.xv(h);1b j=b.6r(1a.5U,k);1d 1a.1R[j]},xx:1c(k){1k(1b j=0,h=1a.5U.1f;j<h;j++){if(1a.5U[j]===k){1a.ib=1a.1R[j].1J();3p.cS.1P.ez="xo";1a.5U[j].2j="#Wh";1a.5U[j].1V={3a:"bv",3s:"aM(51,102,qr,0.2)"}}1l{1a.5U[j].2j="4l";1a.5U[j].1V={3a:"bv",3s:"4l"}}}1a.1F()},Wi:1c(k){1b h=b.6r(1a.1R,k);1b j=1a.5U[h];1a.xx(j);1a.2l(d.1S.i2,1g d.4M({1C:k}))},Qf:1c(){1d 1a.1R},Wd:1c(h){1a.ch=h;1a.eE();1a.1F()},We:1c(){1d 1a.ch},Wf:1c(h){1a.8U=h;1a.eE();1a.1F()},Yu:1c(){1d 1a.8U},xI:1c(h){1a.6Z=h;1a.eE();if(1a.6Z==d.bd.7U){1a.2e().3C.1P.Q7="nh";1a.2e().3C.1P.Q0="y0"}1l{1a.2e().3C.1P.Q7="y0";1a.2e().3C.1P.Q0="nh"}1a.1F()},Q1:1c(){1d 1a.6Z},PZ:1c(h){1a.5I=h;1a.eE();1a.1F()},Q5:1c(){1d 1a.5I},jI:1c(){1d 1a.5V},jw:1c(h){1a.3T=h},yM:1c(){1d 1a.3T},LV:1c(){1d 1a.bJ},p6:1c(h){1a.bJ=h;1a.2e().3C.1P.LS=1a.bJ},uM:1c(j){if(1a.6f!=j){1a.6f=j;if(1a.6f!=1j&&1a.6f!=""){Q6{d.1D.7T=1m;1g d.lC().4f(1a.6f,1o.3t(1a,1a.us),1o.3t(1a,1a.ur))}Q4(h){d.1D.7T=1u;4R h}}1l{d.1D.7T=1u}}},Q2:1c(){1d 1a.6f},us:1c(){1a.2E(1a.jT);4m 1a.jT;d.1D.7T=1u;1a.1F()},gj:1c(h){d.1D.7T=1u;b.1B(1a.1R,1c(j){if(j.hZ){j.hZ()}})},ur:1c(){1a.2E(1a.jT);4m 1a.jT;d.1D.7T=1u;1a.1F()},6H:1c(h){if(!1a.3T){1d}if(h.5S===0){1a.xz(h)}},xz:1c(k){1b l=1e.1i.1A.7t(k,1a.2e());1a.ib=1j;1b j=1a.xv(1a.7B(l));if(j){1a.xx(j);1b h=b.6r(1a.5U,j);1a.2l(d.1S.i2,1g d.4M({1C:1a.1R[h]}));k.hV()}1a.1F()},xF:1c(j){if(j.q0.ov===1){if(j.q0.id){1b h=1o.lB(j.q0.id);if(h!=1j){if(1o.1Y(d.4c,h)){1d h}}}}1d 1j},5R:1c(n){if(!1a.3T){1d}1b o=1e.1i.1A.7t(n,1a.2e());1b h=1a.7B(o);1b k=1a.ib;if(k!=1j){1b l=1a.xF(n);if(l!=1j){l.uv=1m;1b o=1e.1i.1A.7t(n,l.2e());1b h=l.7B(o);if(!l.uV(k,{6R:h,ne:1g nK()})||!l.uW(k,h)){l.2e().1P.ez="cB-Yv"}1l{l.2e().1P.ez="xo"}}3p.cS.1P.ez="xo";1b j=1o.lB(1a.2e().id+"xr");if(!j){j=1a.Mf()}1b p=d.1A.xs(n);j.2e().1P.3M=p.x+5+"px";j.2e().1P.3Z=p.y-20+"px"}1l{3p.cS.1P.ez="aL";1a.vn()}},vn:1c(){1b h=1o.lB(1a.2e().id+"xr");if(h){h.2e().3C.kH(h.2e());h.hA()}},Mf:1c(){1b l=1g e(0,0,20,20);1b h=3p.dj("Md");h.id=1a.2e().id+"xr";h.1q=l.1q;h.1p=l.1p;h.1P.5d="i3";h.1P.cj=Mb;3p.cS.cL(h);1b j=1o.oX(1e.1z.oW,1j,1j,1j,h);j.3A=1;j.5Y=1a.5Y;j.3g(l);1b k=1a.ib.1J();k.4t="4l";k.1t=j;k.3g(l);k.lz();j.5Y();1d j},6j:1c(h){if(!1a.3T){1d}if(h.5S===0){1a.nn(h)}},nn:1c(n){if(1a.ib==1j){1d}1b l=1a.xF(n);if(l!=1j){1b k=1a.ib;1a.Mg(k,l);1a.Mk(k,l);1b j=1a.ch;if(j==1j){j=k.2s().h1()}1b o=1e.1i.1A.7t(n,l.2e());1b h=l.7B(o);if(l.uW(k,h)&&l.uV(k,{6R:h,ne:1g nK()})){k.3g(e.Yw(h,j));k.fV(l);if(k.7b){k.7b.5D();k.7b.8T()}if(k.3k){k.3k.5D();k.3k.8T()}if(k.b7){k.b7.5D();k.b7.8T()}l.54(k);l.xy(k);l.xA(k,h);l.1F()}l.2e().1P.ez="aL"}3p.cS.1P.ez="aL";1a.ib=1j;1a.vn()},Mg:1c(j,k){if(j.2i){if(j.2i.cE){1b h=(j.2i.cE*f.fK(k.2o));j.2i.cE=h}}1l{if(j.1P){if(j.1P.6q){1b h=(j.1P.6q*f.fK(k.2o));j.2i=1g g(j.1P.6J||"nN-nt",h,1u,1u)}}}},Mk:1c(h,j){if(h.1P){if(h.1P.2v){h.1P.2v=f.CR(h.1P.2v,j.2o,f.Ml)}}},ku:1c(n){1b p=1a.2e().3C;1b j=1o.2s(p);1b o=4O.Yr;1b l=4O.Ys;1b k=n.k0;1b h={5S:0,pT:k[0].pT-o,pU:k[0].pU-l};1d h},pV:1c(j){1b h=j.k0;if(1a.eK&&1a.nj){1a.8l=1a.ku(j);1a.xz(1a.8l);j.hV()}},pS:1c(j){1b h=j.k0;if(1a.eK&&1a.nj){1a.8l=1a.ku(j);1a.5R(1a.8l);j.hV()}},ks:1c(h){if(1a.eK&&1a.nj){1a.8l.q0=1a.nj;1a.nn(1a.8l);1a.8l=1g bZ()}},Yt:1c(h){1a.nj=h},2F:1c(j,h){if(!h||h==""){1d}1b k=1g nK("7C","7c","1d "+h+"(7C, 7c)");1a.6b(j,k)},6b:1c(h,j){1o.nT(1a,h,j)}};1e.1i.nA.yN=1c(h){1d 1o.oX(1e.1i.nA,1j,1j,1j,h)};1e.1i.nA.mF=1c(h,j){1d 1o.lB(h,j)};1e.1Z(c,"1e.1i.nA",1e.1z.oW)})(1e.1i);(1c(a){1b d=1e.2T.8u;1b c=1e.2T.dZ;1b b=a.4A=1c(e){1a.bD=e};b.1n={M1:1c(e,f){if(!1a.cI){1a.cI=1g d()}1a.cI.2p(e,f)},qL:1c(e){1d 1a.cI&&1a.cI.2c(e)},M2:1c(e){if(!1a.nQ){1a.nQ=1g c()}1a.nQ.3u(e)},gX:1c(){if(1a.nQ){1a.nQ.1B(1c(g){1b f=g.de();1b e=g.d7();1b h=1a.cI&&f&&e&&1a.cI.2c(f)&&1a.cI.2c(e)&&1a.LY(f,e);if(h){a.1A.YB(g.1r,g.1r,1a.cI.1G(f));g.4k(1u)}1l{g.gm()}},1a)}},LY:1c(f,e){1b j=1e.1z.5t;1b k=j.3h(f.1t.2o)/YC;1b h=1a.cI.1G(f);1b g=1a.cI.1G(e);1d 1s.3j(h.x-g.x)<k&&1s.3j(h.y-g.y)<k}};b.5u=1j;1e.1Z(b,"1e.1i.4A")})(1e.1i);(1c(b){1b a=1e.2T.5i;1b c=b.nH=1c(d){1o.2u(c,1a,[d]);1a.3T=1m;1a.jE="";1a.bJ="#h4";1a.nG=1;1a.nR=1o.nS()};c.1n={bo:1c(){1o.2a(c,1a,"bo");1a.kY=1o.3t(1a,1a.5R);1o.5N(3p,{jn:1a.kY});1a.jp=1o.3t(1a,1a.6j);1o.5N(3p,{jr:1a.jp});1a.jt=1o.3t(1a,1a.nB);1o.5N(4O,{mi:1a.jt});1o.5N(1a.2e(),{jn:1o.3t(1a,1a.5R)});1o.5N(1a.2e(),{xM:1o.3t(1a,1a.6H)});1o.5N(1a.2e(),{jr:1o.3t(1a,1a.6j)})},hA:1c(){1o.d3(3p,"jn",1a.kY);1o.d3(3p,"jr",1a.jp);1o.d3(4O,"mi",1a.jt);1o.2a(c,1a,"hA")},wW:1c(f){1b e=3p.hS(f);if(e){1b d=e.wY;if(d){d.6b("wL",1o.3t(1a,1o.rj(1a.jO,{id:f})))}}},MF:1c(d){1a.1H=d;if(d){1a.jE=d.2e().id;d.6b(b.1S.5Y,1o.3t(1a,1a.xi));d.6b(b.1S.qh,1o.3t(1a,1a.nB));1a.8v()}},jO:1c(e,d){1b f=3p.hS(d.id);if(f){f.6T=1a.2k()}},2E:1c(d){if(d>""){1b e=1o.2E(d);if(e.wJ){1a.jE=e.wJ;1a.LC(e.ju);1a.p6(e.bJ);1a.jw(e.3T);1a.2F(b.1S.dW,e.wI);1b f=1a;j7(1c(){1d f.MH()},100)}}},MH:1c(){1a.MF(b.4c.mF(1a.jE));1a.1H.1F();1a.1F()},2k:1c(){1b f=1a.2e().3C;1b e=1o.2s(f);1b d={id:1a.2e().id,1q:e.1q,1p:e.1p,3T:1a.3T,wJ:1a.jE,ju:1a.ju,bJ:1a.bJ};1d 1o.2k(d)},8v:1c(){if(1a.1H==1j){1d}1b g=3p.hS(1a.jE).3C;1b j=1o.2s(g);1b f=1o.2s(1a.1H.Yi());1a.1w=1g 1e.1z.2O(1a.1H.1w.x,1a.1H.1w.y,f.1q/1a.1H.3A,f.1p/1a.1H.3A);f.1q=f.1q*100/1a.1H.hx;f.1p=f.1p*100/1a.1H.hx;1b k=1g 1e.1z.9t(1a.2e().3C.Yj,1a.2e().3C.Mw);1b d=1a.Lv(f.1q,f.1p,k.1q,k.1p);1b e=1a.2e();e.1q=d.1q;e.1p=d.1p;e.1P.1q=d.1q+"px";e.1P.1p=d.1p+"px";e.1P.Ye=(k.1q-d.1q)/2+"px";e.1P.Yf=(k.1p-d.1p)/2+"px";1a.nG=1s.2b(k.1q/f.1q,k.1p/f.1p);1b h=g.P6-g.Mw;1b l={1q:(j.1q-h)/1a.1H.3A,1p:(j.1p-h)/1a.1H.3A};1a.7n=1g 1e.1z.2O(0,0,l.1q,l.1p);1a.7n.1V={3a:"bv",3s:"aM(qr,qr,qr,0.2)"};1a.7n.2j="#4T";1o.5N(1a.1H.jN(),{nF:1o.3t(1a,1a.jF)});1a.x8();1a.xi(1a.1H);1a.2l(b.1S.dW)},xi:1c(e,d){1a.3A=1/1e.1z.5t.fK(e.2o)*1a.nG;1a.lE=1a.Ls=a.1J(e.xg());if(1a.7n){1a.lE.1h(1a.7n)}1a.1F()},2l:1c(d,e){1b f=1o.h3(1a,d);if(f!=1j){f(1a,e)}},6H:1c(h){if(!1a.3T){1d}1b j=b.1A.7t(h,1a.2e());1b g=1a.7B(j);if(1a.7n&&1a.7n.2M(g)){1a.Lu=g.x-1a.7n.x;1a.Ly=g.y-1a.7n.y;1a.7k=1m;h.hV()}1l{1b f=1s.6i(g.x-1a.7n.1q/2);1b k=1s.6i(g.y-1a.7n.1p/2);1a.qd(f,k);1b d=1a.xd();if(1a.1H){1a.1H.jN().6s=d.x;1a.1H.jN().6m=d.y}}},5R:1c(g){if(!1a.3T){1d}if(1a.7n){1b h=b.1A.7t(g,1a.2e());1b f=1a.7B(h);if(1a.7k){1a.qd(f.x-1a.Lu,f.y-1a.Ly);1b d=1a.xd();if(1a.1H){1a.1H.jN().6s=d.x;1a.1H.jN().6m=d.y}1d 1u}}},Yo:1c(d){if(!1a.3T){1d}1a.7k=1u},jF:1c(d){if(!1a.3T){1d}if(!1a.7k){1a.x8()}},6j:1c(d){if(!1a.3T){1d}1a.7k=1u},nB:1c(d){if(1a.7n){1a.8v();1a.1F()}},Lv:1c(d,g,l,h){1b k=0;1b j=0;1b f=0;j=(l/d);f=(h/g);k=(f<j)?f:j;1b n=1s.6i(d*k);1b e=1s.6i(g*k);1d 1g 1e.1z.9t(n,e)},x8:1c(){if(!1a.1H){1d}1b e=1a.1H.jN();1b d=1g 1e.1z.5k(e.6s/1a.1H.3A,e.6m/1a.1H.3A);if(!mz(d.x)&&!mz(d.y)){d.x+=1a.1w.x;d.y+=1a.1w.y;1a.qd(1s.6i(d.x),1s.6i(d.y))}},qd:1c(d,e){1a.7n.x=1s.1U(1a.1w.x,1s.2b(d,1a.1w.1q+1a.1w.x-1a.7n.1q));1a.7n.y=1s.1U(1a.1w.y,1s.2b(e,1a.1w.1p+1a.1w.y-1a.7n.1p));1a.1F()},xd:1c(){1d 1g 1e.1z.5k((1a.7n.x-1a.1w.x)*1a.1H.3A,(1a.7n.y-1a.1w.y)*1a.1H.3A)},jI:1c(){if(1a.1H){1d 1a.1H.jI!=1j?1a.1H.jI():1a.1H.5V}1d 1a.ju},y4:1c(){if(1a.1H){1d 1a.1H.y4()}1d 1j},LP:1c(){if(1a.1H){if(1a.1H.7Q){1d 1g 1e.1z.9t(1a.1H.7Q.1q*1a.nG,1a.1H.7Q.1p*1a.nG)}}1d 1g 1e.1z.9t(0,0)},yU:1c(){if(1a.1H){1d 1a.1H.yU()}1d 1e.1i.cH.4H},2F:1c(e,d){if(!d||d==""){1d}1b f=1g nK("7C","7c","1d "+d+"(7C, 7c)");1a.6b(e,f)},6b:1c(d,e){1o.nT(1a,d,e)},LV:1c(){1d 1a.bJ},p6:1c(d){1a.bJ=d;1a.2e().3C.1P.LS=1a.bJ},YV:1c(){1d 1a.ju},LC:1c(d){1a.ju=d},jw:1c(d){1a.3T=d},yM:1c(){1d 1a.3T}};1e.1i.nH.yN=1c(d){1d 1o.oX(1e.1i.nH,1j,1j,1j,d)};1e.1i.nH.mF=1c(d,e){1d 1o.lB(d,e)};1e.1Z(c,"1e.1i.nH",1e.1z.oW)})(1e.1i);(1c(a){1b b=a.pw=1c(d,c){1o.2u(b,1a,[d])};b.1n={6H:1c(c){1a.mH={x:c.LH,y:c.NF};1a.yQ=1a.1H.yR();1a.yP=1u;1d 1m},5R:1c(d){if(1a.mH==1j){1d}1b g={x:d.LH,y:d.NF};1b c=1a.1H.lH();1b h=1a.yQ.x-1a.1H.NG(g.x-1a.mH.x);1b f=1a.yQ.y-1a.1H.NG(g.y-1a.mH.y);1a.1H.yO(h,f,c);1a.yP=1m},6j:1c(c){1a.mH=1j;if(!1a.yP&&1a.1H.zg(c)){1a.1H.pp(c)}},bP:1c(c,d){1a.6o=1e.bf.aV.ff;1d 1a.6o},zf:1c(){1d 1u}};1e.1Z(b,"1e.1i.pw",a.ei)})(1e.1i);(1c(n){1b g=1e.2T.5i;1b L=1e.cd;1b w=1e.3N.mL;1b B=1e.1z.5t;1b v=1e.1z.2O;1b j=1e.2T.dZ;1b u=n.yB=1c(b){1a.1H=b};u.1n={fp:1c(l){1b b=1a.z7(l);l.lq(b,0,0,1u)},e4:1c(b){1k(1b l=0;l<b.1f;l++){1b r=b[l];r.pm=1a.z7(r)}1a.NB(b);1k(1b l=0;l<b.1f;l++){1b r=b[l];r.lq(r.pm,0,0,1u);4m r.pm}},z7:1c(t){A=1a.1H.mO;1b W=t.de().6N();1b aa=t.fF();1b an=t.d7().6N();1b V=t.bq();1b Y=W.4e();1b aj=an.4e();1b ae=-[0,90,8j,z3][d(Y,aj)];if(ae!=0){W=P(W,Y,ae);aa=n.1A.6A(aa,Y,ae);an=P(an,Y,ae);V=n.1A.6A(V,Y,ae)}1b al=G(W,aa)+G(an,V);1b ah=h[al](W,aa,an,V);if(ae!=0){n.1A.cU(ah,Y,-ae)}1b ac=O(1a.1H,t,ah);if(ac.1f>0){1b r=[];1b Z=D(ac);1k(1b ai=0;ai<ah.1f-1;++ai){1b ag=[];1b l=ah[ai];1b b=ah[ai+1];g.1B(Z,1c(ap){g.bg(ag,S(l,b,ap,ai))});ag.5q(1c(ar,ap){1b at=L.5E(l,ar);1b aq=L.5E(l,ap);if(at<aq){1d-1}if(at>aq){1d 1}1d 0});g.bg(r,ag)}1b ao=[];1k(1b ai=0;ai<r.1f;++ai){1b ak=r[ai];1k(1b af=ai+1;af<r.1f;++af){1b U=r[af];if(U.1C==ak.1C){ao.1h(ak);ao.1h(U);ai=af;1Q}}}if(ao.1f>0){1b am=[];1b X=-1;1k(1b ab=0;ab<ao.1f-1;ab+=2){1b ak=ao[ab];1b ad=ao[ab+1];2L(X!=ak.zb){am.1h(ah[++X])}c(am,ak.1C,ak,ad);X=ad.zb}2L(X!=ah.1f-1){am.1h(ah[++X])}ah=am}k(t,ac);I(ah,ac)}1d ah},Nz:1c(r){1b b=[];1k(1b l=0;l<r.1f-1;l++){1b t={1y:l,1r:r,pc:1c(){1d 1a.1r[1a.1y].y==1a.1r[1a.1y+1].y},yn:1c(){1b V=1a.1r[1a.1y].x;1b U=1a.1r[1a.1y+1].x;1d V<U?[V,U]:[U,V]},yo:1c(){1b V=1a.1r[1a.1y].y;1b U=1a.1r[1a.1y+1].y;1d V<U?[V,U]:[U,V]}};b.1h(t)}1d b},NB:1c(b){1k(1b l=0;l<b.1f;l++){1b r=b[l];r.Ny=1a.Nz(r.pm)}1a.z4(b,1m);1a.z4(b,1u)},z4:1c(r,al){1b ad=[];1k(1b ah=0;ah<r.1f;ah++){1b Y=r[ah];1b ab=Y.Ny;1k(1b af=0;af<ab.1f;af++){1b l=ab[af];if(l.pc()==al){ad.1h(l)}}}ad.5q(al?o:p);1b an=-(3W.5s-1);1b ao=[];1b X=ad.1f;1k(1b ah=0;ah<=X;++ah){1b l=ah<X?ad[ah]:1j;if(l==1j||q(l,al)!=an){if(ao.1f>1){1b b=f(ao,al);1k(1b aj=0;aj<b.1f;aj++){1b Z=b[aj];if(Z.1f<2){2t}1b U=q(Z[0],al);Z.5q(al?z:s);1b ae=U-A/2;1b ag=U+A/2;1b ai=A/8;1b ac=(ae+ag)/2;1b ak=1s.2b((ag-ae)/2,(Z.1f-1)*3*ai);1b W=ak/(Z.1f-1);1b V=U-ak/2>=ae+W?U-ak/2:ac-ak/2;1k(1b am=0;am<Z.1f;am++){1b aa=Z[am];1b t=V-q(aa,al);if(al){aa.1r[aa.1y].y=V;aa.1r[aa.1y+1].y=V}1l{aa.1r[aa.1y].x=V;aa.1r[aa.1y+1].x=V}V+=W}}}ao.1f=0}if(l!=1j){an=q(l,al);if(l.1y>0&&l.1y<l.1r.1f-1){ao.1h(l)}}}}};1b A=8;1b h={rl:1c(l,U,b,t){1b r=M(K(l),N(b));1d[U,{x:r,y:U.y},{x:r,y:t.y},t]},rt:1c(l,U,b,t){if(U.y<H(b)-A){1d[U,{x:t.x,y:U.y},t]}1b r=M(K(l),N(b));1d[U,{x:r,y:U.y},{x:r,y:H(b)-A},{x:t.x,y:H(b)-A},t]},rb:1c(l,U,b,t){if(U.y>Q(b)+A){1d[U,{x:t.x,y:U.y},t]}1b r=M(K(l),N(b));1d[U,{x:r,y:U.y},{x:r,y:Q(b)+A},{x:t.x,y:Q(b)+A},t]},rr:1c(l,U,b,t){if(U.y<H(b)-A||U.y>Q(b)+A){1d[U,{x:K(b)+A,y:U.y},{x:K(b)+A,y:t.y},t]}1b r=M(K(l),N(b));1d[U,{x:r,y:U.y},{x:r,y:Q(b)+A},{x:K(b)+A,y:Q(b)+A},{x:K(b)+A,y:t.y},t]},bl:1c(l,U,b,t){if(Q(l)<t.y-A){1d[U,{x:U.x,y:t.y},t]}1b r=M(K(l),N(b));1d[U,{x:U.x,y:Q(l)+A},{x:r,y:Q(l)+A},{x:r,y:t.y},t]},bt:1c(r,V,l,U){if(Q(r)<H(l)-2*A){1b b=M(Q(r),H(l));1d[V,{x:V.x,y:b},{x:U.x,y:b},U]}1b t=M(K(r),N(l));1d[V,{x:V.x,y:Q(r)+A},{x:t,y:Q(r)+A},{x:t,y:H(l)-A},{x:U.x,y:H(l)-A},U]},bb:1c(r,U,l,t){1b b=1s.1U(Q(r),Q(l))+A;1d[U,{x:U.x,y:b},{x:t.x,y:b},t]},br:1c(r,U,l,t){1b b=Q(r)<H(l)-2*A?M(Q(r),H(l)):1s.1U(Q(r),Q(l))+A;1d[U,{x:U.x,y:b},{x:K(l)+A,y:b},{x:K(l)+A,y:t.y},t]},tl:1c(l,U,b,t){if(t.y<H(l)-A){1d[U,{x:U.x,y:t.y},t]}1b r=M(K(l),N(b));1d[U,{x:U.x,y:H(l)-A},{x:r,y:H(l)-A},{x:r,y:t.y},t]},tt:1c(l,U,b,t){1b r=1s.2b(H(l),H(b));1d[U,{x:U.x,y:r-A},{x:t.x,y:r-A},t]},tb:1c(r,V,l,U){if(H(r)>Q(l)+2*A){1b b=M(H(r),Q(l));1d[V,{x:V.x,y:b},{x:U.x,y:b},U]}1b t=M(K(r),N(l));1d[V,{x:V.x,y:H(r)-A},{x:t,y:H(r)-A},{x:t,y:Q(l)+A},{x:U.x,y:Q(l)+A},U]},tr:1c(r,U,l,t){1b b=H(r)>Q(l)+2*A?M(H(r),Q(l)):1s.2b(H(r),H(l))-A;1d[U,{x:U.x,y:b},{x:K(l)+A,y:b},{x:K(l)+A,y:t.y},t]},ll:1c(l,U,b,t){if(H(l)>t.y+A||Q(l)<t.y-A){1d[U,{x:N(l)-A,y:U.y},{x:N(l)-A,y:t.y},t]}1b r=M(K(l),N(b));1d[U,{x:N(l)-A,y:U.y},{x:N(l)-A,y:H(l)-A},{x:r,y:H(l)-A},{x:r,y:t.y},t]},lt:1c(r,V,l,U){if(Q(r)<H(l)-2*A){1b b=M(Q(r),H(l));1d[V,{x:N(r)-A,y:V.y},{x:N(r)-A,y:b},{x:U.x,y:b},U]}1b t=1s.2b(H(r),H(l));1d[V,{x:N(r)-A,y:V.y},{x:N(r)-A,y:t-A},{x:U.x,y:t-A},U]},lb:1c(t,V,r,U){if(H(t)>Q(r)+2*A){1b l=M(H(t),Q(r));1d[V,{x:N(t)-A,y:V.y},{x:N(t)-A,y:l},{x:U.x,y:l},U]}1b b=1s.1U(Q(t),Q(r));1d[V,{x:N(t)-A,y:V.y},{x:N(t)-A,y:b+A},{x:U.x,y:b+A},U]},lr:1c(r,U,l,t){1b b=0;if(H(r)>Q(l)+2*A){b=M(H(r),Q(l))}1l{if(Q(r)<H(l)-2*A){b=M(Q(r),H(l))}1l{b=1s.2b(H(r),H(l))-A}}1d[U,{x:N(r)-A,y:U.y},{x:N(r)-A,y:b},{x:K(l)+A,y:b},{x:K(l)+A,y:t.y},t]}};1c G(V,Y){1b r=V.lu();1b W=[];1b b=["t","r","b","l"];1b U="t";1k(1b l=0;l<4;++l){1b t=1g 1e.1z.Z0(Y,r[l],r[(l+1)%4]);W.1h(t.YH())}1b X=3W.5s;1k(1b l=0;l<4;++l){if(W[l]<X){X=W[l];U=b[l]}}1d U}1c d(r,l){1b b=l.x-r.x;1b t=l.y-r.y;if(1s.3j(b)>1s.3j(t)&&b>=0){1d 0}if(1s.3j(b)>1s.3j(t)&&b<0){1d 2}if(t>0){1d 1}1d 3}1c P(aa,W,ab){1b X=aa.lu();n.1A.cU(X,W,ab);1b V=1s.2b(X[0].x,1s.2b(X[1].x,X[2].x));1b Y=1s.2b(X[0].y,1s.2b(X[1].y,X[2].y));1b Z=1s.1U(X[0].x,1s.1U(X[1].x,X[2].x));1b U=1s.1U(X[0].y,1s.1U(X[1].y,X[2].y));1d v.9N(V,Y,Z,U)}1c F(l,b,t,r){1b X=b.x-l.x;1b W=b.y-l.y;1b V=r.x-t.x;1b U=r.y-t.y;if(X==0&&V==0){1d 1j}if(W==0&&U==0){1d 1j}if(V==0&&T(t.x,l.x,b.x)&&E(l.y,t.y,r.y)){1d{x:t.x,y:l.y}}if(X==0&&E(l.x,t.x,r.x)&&T(t.y,l.y,b.y)){1d{x:l.x,y:t.y}}1d 1j}1c S(Y,X,r,V){1b W=r.fk;1b l=[];1b U=W.lu();1k(1b t=0;t<4;++t){1b b=F(Y,X,U[t],U[(t+1)%4]);if(b){b.1C=r;b.zb=V;b.mP=t;l.1h(b);r.pe++}}1d l}1c E(l,U,t){1b r=1s.2b(U,t);1b b=1s.1U(U,t);1d r<l&&l<b}1c T(l,U,t){1b r=1s.2b(U,t);1b b=1s.1U(U,t);1d r<=l&&l<=b}1c O(l,t,r){1b b=[];1b U=v.YJ(r);l.3n.1B(1c(W){if(W==t.de()||W==t.d7()){1d}if(!W.zc()){1d}if(W.j3){if(W.j3(t.de())||W.j3(t.d7())){1d}}1b V=n.1A.5B(W.6N(),A,A);W.fk=V;W.pe=0;if(V.bc(U)){b.1h(W)}});1d b}1c k(r,b){1b l=[];l.1h(r.de());if(r.de()!=r.d7()){l.1h(r.d7())}g.1B(l,1c(U){if(!U.zc()){1d}1b t=n.1A.5B(U.6N(),A,A);U.fk=t;U.pe=0;b.1h(U)})}1c D(t){if(t.1f==1){1d t}1b b=[];1b X=1g w;g.1B(t,1c(Y){Y.pv=X.gl(1j,Y)});1k(1b V=0;V<t.1f-1;++V){1b r=t[V];1k(1b U=V+1;U<t.1f;++U){1b l=t[U];if(r.fk.bc(l.fk.5B(-A/4))){X.ge(r.pv,l.pv)}}}1b W=X.mx();g.1B(W,1c(Y){if(Y.2q.1f==1){b.1h(Y.2q[0].5j)}1l{1b Z=1j;Y.2q.1B(1c(aa){Z=aa.5j.fk.9I(Z)});b.1h({fk:Z,pe:0})}});g.1B(t,1c(Y){4m Y.pv});1d b}1c c(t,U,X,l){1b b=U.fk.lu();1b W=[];W.1h(X);1b r=X.mP;2L(r!=l.mP){r=(r+1)%4;W.1h(b[r])}W.1h(l);1b V=[];V.1h(X);1b r=X.mP;2L(r!=l.mP){V.1h(b[r]);r=r-1;if(r<0){r=3}}V.1h(l);if(W.1f<V.1f){g.bg(t,W)}1l{if(W.1f>V.1f){g.bg(t,V)}1l{g.bg(t,J(W)<J(V)?W:V)}}}1c J(r){1b b=0;1k(1b l=0;l<r.1f-1;++l){b+=L.5E(r[l],r[l+1])}1d b}1c N(b){1d b.x}1c H(b){1d b.y}1c K(b){1d b.x+b.1q}1c Q(b){1d b.y+b.1p}1c M(l,b){1d(l+b)/2}1c C(l,b){1d b[l].y==b[l+1].y}1c e(l,b){1b t=b[l];1b r=b[l+1];if(t.x==r.x){1d r.y-t.y}1l{1d r.x-t.x}}1c R(Y,X,l){1k(1b r=0;r<l.1f;++r){1b t=l[r];1b W=t.fk.5B(-A/8);if(W.2M(Y)&&W.2M(X)){1d 1m}1b V=W.lu();1k(1b U=0;U<4;++U){1b b=F(Y,X,V[U],V[(U+1)%4]);if(b){1d 1m}}}1d 1u}1c I(aa,l){1k(1b U=1;U<aa.1f-4;++U){1b V=U;1b t=U+1;1b ab=U+2;1b Y=e(V,aa);1b b=e(ab,aa);1b X=C(V,aa);1b Z=C(t,aa);1b r=C(ab,aa);if(X!=Z&&X==r&&Y*b<0){if(1s.3j(Y)<1s.3j(b)){1b W=X?{x:aa[V].x,y:aa[ab].y}:{x:aa[ab].x,y:aa[V].y};if(!R(aa[V],W,l)){aa.8O(V,3,W);U=1s.1U(1,U-2)}}1l{1b W=X?{x:aa[ab+1].x,y:aa[V].y}:{x:aa[V].x,y:aa[ab+1].y};if(!R(W,aa[ab+1],l)){aa.8O(t,3,W);U=1s.1U(1,U-2)}}}}}1c p(l,b){1b t=l.1r[l.1y];1b r=b.1r[b.1y];if(t.x<r.x){1d-1}if(t.x>r.x){1d 1}1d 0}1c o(l,b){1b t=l.1r[l.1y];1b r=b.1r[b.1y];if(t.y<r.y){1d-1}if(t.y>r.y){1d 1}1d 0}1c s(Y,W){1b Z=Y.1r[0];1b X=W.1r[0];if(Z.x<X.x){1d-1}if(Z.x>X.x){1d 1}1b V=Y.1r[Y.1y];1b U=W.1r[W.1y];1b l=Y.1r[Y.1y+1];1b b=W.1r[W.1y+1];1b t=V.y>l.y;1b r=U.y>b.y;if(t&&r){if(V.y<U.y){1d-1}if(V.y>U.y){1d 1}}if(!t&&!r){if(V.y<U.y){1d 1}if(V.y>U.y){1d-1}}if(t&&!r){1d-1}if(!t&&r){1d 1}1d 0}1c z(l,b){1b t=l.1r[0];1b r=b.1r[0];if(t.y<r.y){1d-1}if(t.y>r.y){1d 1}1d 0}1c q(r,l){1b b=r.1r[r.1y];1d l?b.y:b.x}1c f(V,b){1b ad=1g 1e.3N.mL();1b Z=[];1k(1b U=0;U<V.1f;U++){1b Y=V[U];1b X=ad.gl(1j,Y);Z.1h(X)}1k(1b U=0;U<V.1f-1;U++){1k(1b t=U+1;t<V.1f;t++){1b r=b?V[U].yn():V[U].yo();1b l=b?V[t].yn():V[t].yo();if(a(r,l)){ad.ge(Z[U],Z[t])}}}1b W=ad.mx();1b ae=[];1k(1b U=0;U<W.1f;U++){1b aa=W[U];1b ac=[];1k(1b ab=0;ab<aa.2q.1f;ab++){1b X=aa.2q[ab];ac.1h(X.5j)}ae.1h(ac)}1d ae}1c a(l,b){if(l[0]>=b[1]){1d 1u}if(b[0]>=l[1]){1d 1u}1d 1m}1e.1Z(u,"1e.1i.yB")})(1e.1i);(1c(a){1b d=1e.bf.aV;1b c=1e.1z.5t;1b b=a.C8=1c(e,f){1o.2u(b,1a,[e]);1a.ir=f;1a.2A=1a.1C.4S(1a.ir);1a.MI=1a.2A.1p};b.1n={8r:1c(e){1d 1u},lJ:1c(e){1d 1m},bP:1c(f){if(1a.1C.9u()!=0){1b e=1a.1C.9u();if(e>=-8j&&e<-lP){1d d.ga}1l{if(e>=-lP&&e<-90){1d d.dF}1l{if(e>=-90&&e<-45){1d d.gc}1l{if(e>=-45&&e<0){1d d.dH}1l{if(e>=0&&e<45){1d d.ga}1l{if(e>=45&&e<90){1d d.dF}1l{if(e>=90&&e<lP){1d d.gc}1l{1d d.dH}}}}}}}}1d d.dH},lO:1c(e){if(1a.1C.9u()!=0){1d a.1A.6A(e,1a.1C.1w.4e(),-1a.1C.9u())}1d e.1J()},6H:1c(f){1a.9d=1m;1b e=1a.lO(f);1a.7y=1a.a3=e.y},5R:1c(j){if(!1a.9d){1d}1b f=1a.lO(j);1a.7y=f.y;1b e=1a.1C.3o();if(!1a.7K){if(1s.3j(1a.7y-1a.a3)>=c.3h(e.2o)){1a.7K=1m;if(e.9z()){1a.lN=1g a.uk(e,1a.1C,1a.2A)}}}if(1a.7K){1b h=1a.2A.1p;1a.1C.jP(1a.ir,1s.1U(c.3h(e.2o),1a.2A.1p+(1a.7y-1a.a3)));1b g={6T:1v};if(!e.N6(1a.1C,1a.ir,j,0,g)){1a.1C.jP(1a.ir,h)}if(g.6T){1a.6X()}if(h!=1a.2A.1p){1a.a3=1a.7y}}},6j:1c(f){if(1a.7K){1b e=1a.1C.3o();if(e.9z()){e.3H.9S(1a.lN)}e.Nl(1a.1C,1a.ir,f,0)}1a.9d=1u;1a.7K=1u},6X:1c(){if(1a.7K){1a.9d=1u;1a.7K=1u;1a.1C.jP(1a.ir,1a.MI);1a.lN=1j}}};1e.1Z(b,"1e.1i.C8",a.eU)})(1e.1i);(1c(a){1b e=1e.1z.5t;1b c=1e.1z.bX;1b b=1e.1z.2O;1b d=a.C9=1c(f){1o.2u(d,1a,[f]);1a.5D();1a.8T()};d.1n={lJ:1c(g){1b f=1a.yx(1a.1C);1d f!=1j&&f.2M(g)},6H:1c(f){1a.9d=1m},5R:1c(f){if(!1a.9d){1d}1a.1C.jz(1a.O5(f))},6j:1c(f){1a.9d=1u},6X:1c(){1a.9d=1u},8T:1c(){1b f=1a.5J();1a.x=f.x;1a.y=f.y},ii:1c(l){1b h=1a.b2();if(!h.2M(l)){1d}1b g=1a.1C;1b k=e.3h(g.1t.2o);1b f=4*k;1b j=1g a.ml(1a,g);if(l.y<h.y+f){g.Ca()}if(l.y>h.2V()-f){g.Cd()}if(g.1t.9z()){g.1t.3H.9S(j)}},8r:1c(f){1d 1a.b2().2M(f)},5J:1c(){1b h=1a.1C;1b j=e.3h(h.1t.2o);1b g=h.1w;1b f=h.cN();1d 1g b(g.2y()-5*j,g.y+f,5*j,g.1p-f)},b2:1c(){1b g=1a.5J();if(1a.1C.2f!=0){1b k=[];k.1h(g.5a());k.1h(g.a7());k.1h(g.9Z());k.1h(g.aR());a.1A.cU(k,a.1A.5C(1a.1C.1w),1a.1C.2f);1b f=1s.2b(k[0].x,1s.2b(k[1].x,1s.2b(k[2].x,k[3].x)));1b l=1s.2b(k[0].y,1s.2b(k[1].y,1s.2b(k[2].y,k[3].y)));1b j=1s.1U(k[0].x,1s.1U(k[1].x,1s.1U(k[2].x,k[3].x)));1b h=1s.1U(k[0].y,1s.1U(k[1].y,1s.1U(k[2].y,k[3].y)));1d b.9N(f,l,j,h)}1d g},5D:1c(){1b g=1a.1C;1b k=1a.NW||1e.1i.1A.7N(ho,ho,ho,0.5);1b j=1a.YQ||g.aI();1b h=e.3h(g.1t.2o);1b n=4*h;1b f=3*h/4;1b l=1a.5J();l.x=l.y=0;l.1V=k;l.2j=1v;1a.2H=[l];1b o=1g c();o.6V(l.1q/2,f);o.3D(l.1q-f,n-f);o.3D(f,n-f);o.hT();o.st();o.4y(j);1a.2H.1h(o);1b o=1g c();o.6V(l.1q/2,l.1p-f);o.3D(l.1q-f,l.1p-n+f);o.3D(f,l.1p-n+f);o.hT();o.st();o.4y(j);1a.2H.1h(o);1b p=1a.yx(g,l);if(p){p.2j=1v;p.1V=j;1a.2H.1h(p)}},yx:1c(h,o){if(!o){o=1a.5J()}if(h.2U.1f>0){1b f=h.2U[0].1p;1b g=f*h.2U.1f;if(g>o.1p){1b j=e.3h(h.1t.2o);1b p=4*j;1b k=o.1p-2*p;1b l=1s.1U(4*j,k*o.1p/g);k-=l;1b n=k*h.4U/h.2U.1f;1b q=o.1J();q.1p=l;q.y+=p+n;1d q}}1d 1j},O5:1c(r){1b j=1a.1C;if(j.2U.1f>0){1b f=j.2U[0].1p;1b h=f*j.2U.1f;1b p=1a.5J();if(h>p.1p){1b k=e.3h(j.1t.2o);1b q=4*k;1b l=p.1p-2*q;1b n=1s.1U(4*k,l*p.1p/h);l-=n;1b o=r.y-p.y-q;1b g=5v(j.2U.1f*o/l);g=1s.1U(0,g);g=1s.2b(g,j.2U.1f-1);1d g}}1d 0}};1e.1Z(d,"1e.1i.C9",a.eU)})(1e.1i);(1c(b){1b e=1e.1z.5t;1b d=1e.1z.bX;1b c=1e.1z.2O;1b a=b.Ce=1c(f){1o.2u(a,1a,[f]);1a.5D();1a.8T()};a.1n={8T:1c(){1b f=1a.5J();1a.x=f.x;1a.y=f.y},ii:1c(j){1b g=1a.b2();if(!g.2M(j)){1d}1b f=1a.1C;1b h=1g b.ml(1a,f);if(j.y<g.4e().y){f.Ca()}1l{f.Cd()}if(f.1t.9z()){f.1t.3H.9S(h)}},8r:1c(f){1d 1a.b2().2M(f)},5J:1c(){1b g=1a.1C;1b h=e.3h(g.1t.2o);1b f=g.1w.1J();1d 1g c(f.2y()-5*h,f.y,5*h,g.cN())},b2:1c(){1b g=1a.5J();if(1a.1C.2f!=0){1b k=[];k.1h(g.5a());k.1h(g.a7());k.1h(g.9Z());k.1h(g.aR());b.1A.cU(k,b.1A.5C(1a.1C.1w),1a.1C.2f);1b f=1s.2b(k[0].x,1s.2b(k[1].x,1s.2b(k[2].x,k[3].x)));1b l=1s.2b(k[0].y,1s.2b(k[1].y,1s.2b(k[2].y,k[3].y)));1b j=1s.1U(k[0].x,1s.1U(k[1].x,1s.1U(k[2].x,k[3].x)));1b h=1s.1U(k[0].y,1s.1U(k[1].y,1s.1U(k[2].y,k[3].y)));1d c.9N(f,l,j,h)}1d g},5D:1c(){1b k=1a.1C;1b n=k.9R();1b f=k.aI();1b o=1e.1i.1A.7N(100,100,100,0.2);1b l=e.3h(k.1t.2o);1b h=3*l/4;1b p=1a.5J();p.x=p.y=0;p.2j=f;1a.2H=[p];1b j=p.1J();j.2j=n;j.1p=p.1p/2;if(!k.OU()){j.1V=o;1a.2H.1h(j)}1b j=j.1J();j.2j=n;j.y+=p.1p/2;if(!k.OW()){j.1V=o;1a.2H.1h(j)}1b g=n;1b q=1g d();q.6V(p.1q/2,h);q.3D(p.1q-h,p.1p/2-h);q.3D(h,p.1p/2-h);q.hT();q.st();q.4y(g);1a.2H.1h(q);1b q=1g d();q.6V(p.1q/2,p.1p-h);q.3D(p.1q-h,p.1p/2+h);q.3D(h,p.1p/2+h);q.hT();q.st();q.4y(g);1a.2H.1h(q)}};1e.1Z(a,"1e.1i.Ce",b.eU)})(1e.1i);(1c(a){1b b=a.vf=1c(d,c){1o.2u(b,1a,[d])};b.1n={iq:1c(c){1d 1g a.9Q(1a.1H.3i,a.3z.4Y,1j,c)},mQ:1c(c,d){1d 1g a.9Q(1a.1H.3i,a.3z.4Y,1j,c)},};1e.1Z(b,"1e.1i.vf",a.ei)})(1e.1i);(1c(b){1b c=1e.1z.2O;1b e=1e.2T.8u;1b a=1e.2T.5i;1b d=b.fj=1c(f){1o.2u(d,1a,[f]);1a.1R=[];1a.3n=[];1a.3L=[];1a.w9=1m;1a.1w=1g c(0,0,0,0)};d.1n={9w:1c(f){a.1B(1a.1R,1c(g){g.9w(f)})},7k:1c(g){1o.2a(d,1a,"7k",[g]);if(g.4X===b.3z.4Y){1a.hJ=1g c(g.cW.x,g.cW.y,1,1);1a.hJ.2j="uj";1a.hJ.1V="aM(ho,ho,ho,0.5)";1a.1t.hI(1a.hJ)}1l{if(g.4X===b.3z.7q){1b k=g.3J;1b o=1o.1Y(b.eQ,k);1b j=!o&&k.1y===8&&1o.1Y(b.2Z,k.2w);1b n=j||!1a.1t.ef||1o.1Y(b.3G,k.2w)||o;if(1a.1R.1f>1&&n){g.3J={2w:1a,1y:8}}1k(1b h=0,f=1a.3n.1f;h<f;h++){1a.3n[h].7k(g)}}}1a.Mc=1a.1w},eP:1c(h){if(h.4X===b.3z.4Y){b.1A.YL(1a.hJ,c.ea(h.cW,h.6R));1a.1t.1F()}1l{if(h.4X===b.3z.7q){1b n=b.4A.5u;1b o=b.1A.d4(h.6R,h.cW);1b f=1a.Mc.5a().d5(o);1a.1w.wv(f);1k(1b j=0,g=1a.3n.1f;j<g;j++){1b k=1a.3n[j];if(!n||!n.qL(k)){k.eP(h)}}}}},hP:1c(g){if(g.4X===b.3z.4Y){1b j=c.ea(g.cW,g.6R);1a.1t.kE(1a.hJ);1a.Mm(j);1a.1t.1F()}1l{if(g.4X===b.3z.7q){1k(1b h=0,f=1a.3n.1f;h<f;h++){1a.3n[h].hP(g)}1a.1t.Pi()}}},hE:1c(g){1k(1b h=0,f=1a.3n.1f;h<f;h++){1b j=1a.3n[h];if(!j.hE(g)){1d 1u}}1d 1m},5z:1c(g){if(g.4X===b.3z.7q){1k(1b h=0,f=1a.3n.1f;h<f;h++){1a.3n[h].5z(g)}}if(g.4X===b.3z.4Y){1a.1t.kE(1a.hJ);1a.1t.1F()}},54:1c(f){if(!f){1d}1a.wa(f);1a.1t.8M=f},wa:1c(f){if(f.d9()){1d}1a.1R.1h(f);f.qE(1m);if(1o.1Y(b.2Z,f)){1a.3n.1h(f);f.f2()}1l{1a.3L.1h(f)}1a.1w=b.1A.YM(1a.1w,f.6N());1a.1t.Qc(f)},c3:1c(f){if(!1a.Qg(f)){1d 1u}if(!1a.1t.8M.d9()){1a.1t.8M=(1a.1R.1f>0)?1a.1R[0]:1j}1d 1m},Qg:1c(f){if(1a.w8(f)){a.3l(1a.1R,f);if(1o.1Y(b.2Z,f)){a.3l(1a.3n,f)}1l{a.3l(1a.3L,f)}f.qE(1u);if(1o.1Y(b.2Z,f)){f.f2()}1a.1t.w5(f);1d 1m}1d 1u},qK:1c(){1a.n9();1a.1t.8M=1j},n9:1c(){1k(1b g=0,f=1a.1R.1f;g<f;g++){1a.1R[g].qE(1u);1a.1t.w5(1a.1R[g]);if(1o.1Y(b.2Z,1a.1R[g])){1a.1R[g].f2()}}1a.1R=[];1a.3n=[];1a.3L=[]},YN:1c(f){1a.n9();1a.1R.1h(f);f.1F()},w8:1c(g){1k(1b f=0;f<1a.1R.1f;f++){if(1a.1R[f]===g){1d 1m}}1d 1u},Mm:1c(j){1a.n9();1b g=[];1a.1t.j8(j,g,1a.w9,1m);1k(1b h=0,f=g.1f;h<f;h++){1a.wa(g[h])}if(1a.1R.1f===0){1a.1t.8M=1j}1l{if(1a.1t.8M==1j||!1a.1t.8M.d9()){1a.1t.8M=1a.1R[0]}}},ok:1c(){},NS:1c(j){1b f=[];1k(1b h=0,g=1a.1R.1f;h<g;h++){if(1o.1Y(b.2Z,1a.1R[h])){1b k=1a.1R[h].1J();if(1a.1R[h].2N!=1j&&j.2c(1a.1R[h].2N)){k.2N=j.1G(1a.1R[h].2N)}if(1a.1R[h].7Y!=1j&&j.2c(1a.1R[h].7Y)){k.7Y=j.1G(1a.1R[h].7Y)}j.2p(1a.1R[h],k);f.1h(k)}}1d f},N1:1c(k){1b f=[];1k(1b h=0,g=1a.1R.1f;h<g;h++){if(1o.1Y(b.3G,1a.1R[h])){1b j=1a.1R[h];1b n=j.1J();if(1a.1R[h].1E!=1j&&k.2c(1a.1R[h].1E)){n.1E=k.1G(1a.1R[h].1E)}1l{n.1E=1j}if(1a.1R[h].1x!=1j&&k.2c(1a.1R[h].1x)){n.1x=k.1G(1a.1R[h].1x)}1l{n.1x=1j}n.vQ(j.2r.1J(n,n.1E==1j?1g b.9o():n.1E));n.vN(j.2x.1J(n,n.1x==1j?1g b.9o():n.1x));f.1h(n)}}1d f},2k:1c(){1b q=[];1b n=1g e();1b f=1a.NS(n);1b o=1a.N1(n);1b j=0;1k(1b h=0,g=f.1f;h<g;h++){f[h].7Z=j++}1k(1b h=0,g=f.1f;h<g;h++){1b p=f[h].2k();q.1h(p)}1k(1b h=0,g=o.1f;h<g;h++){1b k=o[h];k.7Z=j++;1b p=k.2k();q.1h(p)}1d 1o.2k({1R:q})},mV:1c(f){if(1o.1Y(b.2Z,1a.1t.8M)){1d 1a.1t.8M.mV(f)}1d 1a.1w.5a()},8c:1c(f){if(1a.1R.1f<=1){1d 1j}1b g=1a.1t;1b j=g.hG(f,1m);if(j){if(g.ef&&1o.1Y(b.2Z,j.2w)){1d j}1d{2w:1a,1y:8}}1b h=1a.1t.f4(f);if(h!=1j&&h.d9()){1d{2w:1a,1y:8}}1d 1j}};1e.1Z(d,"1e.1i.fj",b.8A)})(1e.1i);(1c(c){1b d=1e.1z.bX;1b b=1e.1z.gp;1b e=1e.1z.5k;1b a=1e.2T.5i;1b f=c.1D=1c(j,h){if(!j){j={}}1a.2Y=j;if(!1a.2Y.5f){1a.2Y.5f="q7"}if(j.id){1a.id=j.id;if(h!==1m){g[j.id]=1a}}if(h===1m){1a.6K=1m}};1b g=f.f9=[];ro=1u;f.7T=1u;f.1I=1c(h){if(f.7T){1d f.Ng(h)}if(!ro){f.wy()}1d g[h]};f.Ng=1c(h){1d 1g f({id:h,1L:"M0,0 1O,0 1O,100 L0,100 L0,0"},1m)};f.ND=1c(h){if(!h||!h.id){1d}if(!ro){f.wy()}g[h.id]=h};f.wy=1c(){ro=1m;1b k={};1b h=[];h.1h(k={id:"Bc",1L:"3v,20 2G,10,10,1.lx,7.XK,0 5X,20 XL,25,5,4.MJ,6.2J,0 7H,60 kT,60 kT,30 r8,30 r8,100 MO,100 MO,65 MS,65 MS,100 MR,100 MR,30 n0,30 n0,60 6a,60 6a,25 XM,25,5,3.DF,4.MJ,0 1W,20"});h.1h(k={id:"Bd",1L:"M0,100 1W,0 1O,100 L0,100"});h.1h(k={id:"oh",5f:"7v",1L:"",2P:"mX,95 1W,0 9i,95"});h.1h(k={id:"Bi",1L:"cw,50 L0,0 3Q,0 1O,50 3Q,100 L0,100 4Z,50"});h.1h(k={id:"Bn",1L:"M0,0 6a,0 6a,40 3Q,40 3Q,0 1O,50 3Q,100 3Q,60 6a,60 6a,100 L0,100 L0,0"});h.1h(k={id:"Bo",1L:"M0,30 3Q,30 3Q,0 1O,50 3Q,100 3Q,70 L0,70 L0,30"});h.1h(k={id:"Bp",1L:"M0,30 3Q,30 3Q,0 1O,50 3Q,100 3Q,70 L0,70 6e,50 L0,30"});h.1h(k={id:"Bm",1L:"vz,30 5T,0 L0,50 5T,100 5T,70 5X,70 5X,100 1O,50 5X,0 5X,30 5T,30"});h.1h(k={id:"Bj",1L:"M0,100 Pz,66,50,33,0,0 1O,50 L0,100"});h.1h(k={id:"Bk",1L:"M0,0 5X,0 1O,50 5X,100 L0,100 L0,0"});h.1h(k={id:"Bl",1L:"cw,0 4Z,35 L0,0 L0,100 4Z,65 4Z,100 1O,50 4Z,0",2P:"cw,35 4Z,65"});h.1h(k={id:"Ba",1L:"M0,0 5T,50 L0,100 1O,50 L0,0"});h.1h(k={id:"pk",5f:"7v",1L:"",2P:"rf,-37 bm,37"});h.1h(k={id:"AZ",1L:"M0,25 L0,25 L0,100 1O,100 1O,25 7H,0 6a,0 L0,25"});h.1h(k={id:"oV",1L:"3v,0 XH,95 3Q,75 3Q,95 4Z,95 4Z,75 L6,95 1W,0"});h.1h(k={id:"B0",1L:"3v,0 1O,50 1W,100 L0,50 1W,0",4h:[{2W:"dG,45 s4,45 6a,32 n0,25 8H,38 8H,20 8g,20 8g,38 kT,25 7H,32 n7,45 4N,45 4N,55 n7,55 7H,68 kT,75 8g,62 8g,80 8H,80 8H,62 n0,75 6a,68 s4,55 6e,55 6e,45"}]});h.1h(k={id:"B1",1L:"3v,0 1O,50 1W,100 L0,50 1W,0",4h:[{2W:"mR,50 l9,26 n8,26 1W,40 kC,26 e8,26 8g,50 e8,74 kC,74 1W,60 n8,74 l9,74 8H,50"}]});h.1h(k={id:"AY",1L:"3e,50 2G,50,50,0,6.2J,0",4h:[{2W:"mR,50 lh,28 ld,23 1W,45 rm,23 rp,28 8g,50 rp,73 rm,78 1W,55 ld,78 lh,73 8H,50"},{2W:"3e,50 2G,50,50,0,6.2J,0 5p,50 2G,50,40,0,6.2J,0 1O,50",5f:"7v"}]});h.1h(k={id:"AV",1L:"3e,50 2G,50,50,0,6.2J,0",4h:[{2W:"MV,50 1W,30 1W,70 dK,50"},{2W:"MW,50 5F,30 5F,70 Nq,50"},{2W:"3e,50 2G,50,50,0,6.2J,0 5p,50 2G,50,40,0,6.2J,0 1O,50",5f:"7v"}]});h.1h(k={id:"AW",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"NV,23 3Q,65 n8,45 lh,77 4Z,35 kC,55 8K,23"},{2W:"3e,50 2G,50,50,0,6.2J,0 5p,50 2G,50,40,0,6.2J,0 1O,50",5f:"7v"}]});h.1h(k={id:"AX",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"dG,35 8K,35 8K,20 n4,50 8K,80 8K,65 6e,65 6e,35"},{2W:"3e,50 2G,50,50,0,6.2J,0 5p,50 2G,50,40,0,6.2J,0 1O,50",5f:"7v"}]});h.1h(k={id:"B2",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0 wx,30 5F,30 5F,70 cr,70 cr,30 1W,50 5F,30",4h:[{2W:"3e,50 2G,50,50,0,6.2J,0 5p,50 2G,50,40,0,6.2J,0 1O,50",5f:"7v"}]});h.1h(k={id:"B7",1L:"3e,50 2G,50,50,0,6.XI,0",4h:[{2W:"wu,31 1W,12 bk,31 5F,31 kD,50 5F,69 bk,69 1W,88 bu,69 n3,69 nc,50 cr,31 bu,31"},{2W:"3e,50 2G,50,50,0,6.2J,0 5p,50 2G,50,40,0,6.2J,0 1O,50",5f:"7v"}]});h.1h(k={id:"B8",1L:"3e,50 2G,50,50,0,6.2J,0",4h:[{2W:"mS,50 2G,50,30,0,6.2J,0"},{2W:"3e,50 2G,50,50,0,6.2J,0 5p,50 2G,50,40,0,6.2J,0 1O,50",5f:"7v"}]});h.1h(k={id:"B9",1L:"3v,0 1O,50 1W,100 L0,50 1W,0",2P:"mS,50 2G,50,30,0,6.2J,0 n1,50 2G,50,20,0,6.2J,0",4h:[{2W:"XJ,41 1W,32 ri,41 DT,41 bk,50 DT,59 ri,59 1W,68 s8,59 gx,59 bu,50 gx,41 s8,41"}]});h.1h(k={id:"B6",1L:"3v,0 1O,50 1W,100 L0,50 1W,0",4h:[{2W:"mS,50 2G,50,30,0,6.2J,0 5X,50 2G,50,20,0,6.2J,0 4N,50",5f:"7v"}]});h.1h(k={id:"B3",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"mR,50 lh,28 ld,23 1W,45 rm,23 rp,28 8g,50 rp,73 rm,78 1W,55 ld,78 lh,73 8H,50"}]});h.1h(k={id:"B4",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"MV,50 1W,30 1W,70 dK,50"},{2W:"MW,50 5F,30 5F,70 Nq,50"}]});h.1h(k={id:"B5",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"NV,23 3Q,65 n8,45 lh,77 4Z,35 kC,55 8K,23"}]});h.1h(k={id:"zH",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"dG,35 8K,35 8K,20 n4,50 8K,80 8K,65 6e,65 6e,35"}]});h.1h(k={id:"zI",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0 wx,30 5F,30 5F,70 cr,70 cr,30 1W,50 5F,30"});h.1h(k={id:"zJ",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"wu,31 1W,12 bk,31 5F,31 kD,50 5F,69 bk,69 1W,88 bu,69 n3,69 nc,50 cr,31 bu,31"}]});h.1h(k={id:"zG",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0",4h:[{2W:"NZ,20 7H,20 7H,80 6a,80 6a,20",1V:"#h4"},{2W:"mR,30 8g,30 8g,31 8H,31 8H,30",1V:"aM(bM,bM,li,0)",2j:{1V:"#4T",du:0,1q:1}},{2W:"cw,47 3Q,47 3Q,48 4Z,48 4Z,47",1V:"aM(bM,bM,li,0)",2j:{1V:"#4T",du:0,1q:1}},{2W:"cw,65 3Q,65 3Q,66 4Z,66 4Z,65",1V:"aM(bM,bM,li,0)",2j:{1V:"#4T",du:0,1q:1}}]});h.1h(k={id:"zD",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"a1,50 2G,50,40,0,6.2J,0 mS,50 2G,50,30,0,6.2J,0 dG,50 5T,50 rx,35 5T,39 rz,24 bu,30 3v,20 1W,30 rq,24 bk,30 rk,35 5X,39 n1,50 4N,50 rk,65 5X,61 rq,76 bk,70 3v,70 1W,80 rx,65 5T,61 rz,76 bu,70 3v,50 su,24 3v,50 e8,50"});h.1h(k={id:"zE",1L:"3v,0 1O,50 1W,100 L0,50 1W,0",4h:[{2W:"dG,45 8H,45 8H,20 8g,20 8g,45 4N,45 4N,55 8g,55 8g,80 8H,80 8H,55 6e,55 6e,45"}]});h.1h(k={id:"zF",1L:"3e,50 2G,50,50,0,6.2J,0",4h:[{2W:"dG,35 8K,35 8K,20 n4,50 8K,80 8K,65 6e,65 6e,35"}]});h.1h(k={id:"zK",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"wx,30 5F,30 5F,70 cr,70 cr,30 1W,50 5F,30"});h.1h(k={id:"zP",1L:"3e,50 2G,50,50,0,6.2J,0",4h:[{2W:"wu,31 1W,12 bk,31 5F,31 kD,50 5F,69 bk,69 1W,88 bu,69 n3,69 nc,50 cr,31 bu,31"}]});h.1h(k={id:"zQ",1L:"3e,50 2G,50,50,0,6.2J,0",4h:[{2W:"NZ,20 7H,20 7H,80 6a,80 6a,20",1V:"#h4"},{2W:"mR,30 8g,30 8g,31 8H,31 8H,30",1V:"aM(bM,bM,li,0)",2j:{1V:"#4T",du:0,1q:1}},{2W:"cw,47 3Q,47 3Q,48 4Z,48 4Z,47",1V:"aM(bM,bM,li,0)",2j:{1V:"#4T",du:0,1q:1}},{2W:"cw,65 3Q,65 3Q,66 4Z,66 4Z,65",1V:"aM(bM,bM,li,0)",2j:{1V:"#4T",du:0,1q:1}}]});h.1h(k={id:"zR",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"mS,50 2G,50,30,0,6.2J,0 dG,50 5T,50 rx,35 5T,39 rz,24 bu,30 3v,20 1W,30 rq,24 bk,30 rk,35 5X,39 n1,50 4N,50 rk,65 5X,61 rq,76 bk,70 3v,70 1W,80 rx,65 5T,61 rz,76 bu,70 3v,50 su,24 3v,50 e8,50"});h.1h(k={id:"aJ",5f:"7v",1L:"3e,50 2G,50,50,0,6.2J,0"});h.1h(k={id:"zO",1L:"Xx,0 Xy,2,61,7,60,19 Xz,11,51,8,43,14 Xu,19,40,25,41,33 OD,24,27,13,13,21 Ea,25,7,29,15,44 C5,47,0,50,0,63 C3,74,17,72,27,71 Xv,77,14,93,27,100 Xw,100,52,93,55,78 hL,93,81,87,88,80 Y3,69,87,63,79,57 P0,52,100,43,100,24 Y4,7,77,0,67,0"});h.1h(k={id:"zL",1L:"3e,100 L0,100 1O,0 L0,0 1O,100"});h.1h(k={id:"zM",1L:"M0,80 C6,94,30,100,50,100 hL,100,94,94,100,80 1W,0 L0,80",2P:"M0,80 Ea,65,30,60,50,60 hL,60,90,65,100,80"});h.1h(k={id:"zr",1L:"M0,80 C6,94,30,100,50,100 hL,100,94,94,100,80 1W,0 L0,80"});h.1h(k={id:"zs",1L:"M0,10 4Z,50 L0,90 6S,100 1W,60 5p,100 1O,90 3Q,50 1O,10 5p,0 1W,40 6S,0 L0,10"});h.1h(k={id:"zq",1L:"M0,100 1O,100 1O,0 L0,0 L0,100",2P:"M0,15 1O,15 M0,85 1O,85"});h.1h(k={id:"jX",1L:"cw,40 4Z,0 3Q,0 3Q,40 1O,40 1O,60 3Q,60 3Q,100 4Z,100 4Z,60 L0,60 L0,40 4Z,40"});h.1h(k={id:"zn",1L:"n1,100 5X,100 L0,100 L0,30 5X,30 L0,30 5T,0 1O,0 5X,30 1O,0 1O,70 5X,100 5X,30 5X,100"});h.1h(k={id:"zo",1L:"3e,20 1O,80 6Y,95,70,100,50,100 f1,100,0,95,0,80 L0,20 C0,5,30,0,50,0 hL,0,100,5,100,20",2P:"3e,20 6Y,35,70,40,50,40 f1,40,0,35,0,20"});h.1h(k={id:"zp",1L:"3e,20 1O,80 6Y,95,70,100,50,100 f1,100,0,95,0,80 L0,20 C0,5,30,0,50,0 hL,0,100,5,100,20",2P:"3e,20 6Y,35,70,40,50,40 f1,40,0,35,0,20 3e,30 6Y,45,70,50,50,50 f1,50,0,45,0,30 3e,40 6Y,55,70,60,50,60 f1,60,0,55,0,40"});h.1h(k={id:"zu",1L:"f0,100 7F,100 1O,50 7F,0 aH,0 L0,50 aH,100"});h.1h(k={id:"zz",1L:"M0,100 e8,100 r3,100,100,75,100,50 6Y,25,85,0,67,0 L0,0 mW,0,33,25,33,50 l8,75,15,100,0,100"});h.1h(k={id:"uA",1L:"3v,0 1O,50 1W,100 L0,50 1W,0"});h.1h(k={id:"zA",1L:"M0,50 6a,100 7H,100 1O,50 7H,0 6a,0 L0,50"});h.1h(k={id:"pi",5f:"7v",1L:"",2P:"rf,111 bm,37"});h.1h(k={id:"zB",1L:"M0,0 1W,0 PE,0,100,30,100,50 6Y,70,80,100,50,100 L0,100 L0,0"});h.1h(k={id:"zx",1L:"M0,100 1O,100 r3,100,67,75,67,50 Y5,25,85,0,100,0 L0,0 mW,0,33,25,33,50 l8,75,15,100,0,100"});h.1h(k={id:"zS",1L:"e1,0 5p,0 rg.Mz,0,100,22.vh,100,50 6Y,77.r4,95.Mz,100,90,100 6S,100 C4.Y0,100,1.Y1-15,77.r4,0,50.Y2 C0,22.Y6,4.Ya,7.Yb-15,9.Yc,0",2P:"e1,0 mW.PY,0,20,22.vh,20,50 Y7,77.r4,15.PY,100,10,100"});h.1h(k={id:"Ae",1L:"3e,20 1O,80 6Y,95,70,100,50,100 f1,100,0,95,0,80 L0,20 C0,5,30,0,50,0 hL,0,100,5,100,20",2P:"3e,20 6Y,35,70,40,50,40 f1,40,0,35,0,20 3e,30 6Y,45,70,50,50,50 f1,50,0,45,0,30"});h.1h(k={id:"Af",1L:"cw,100 mW,100,0,70,0,50 C0,30,15,0,40,0 7F,0 6Y,20,100,30,100,50 6Y,70,100,80,85,100 4Z,100"});h.1h(k={id:"Ag",1L:"e1,100 5p,100 rg,100,100,95,100,90 1O,10 6Y,5,95,0,90,0 6S,0 C5,0,0,5,0,10 L0,90 C0,95,5,100,10,100",2P:"M0,15 1O,15"});h.1h(k={id:"Ad",1L:"M0,100 1O,100 1O,0 L0,0 L0,100",2P:"M0,15 1O,15"});h.1h(k={id:"Aa",1L:"M0,90 L0,0 1O,0 1O,90 vI,80,66,80,50,90 l8,100,16,100,0,90"});h.1h(k={id:"pq",1L:"3v,0 bm,95 1W,95 bm,PC 9i,PC 1W,95 1W,95 9i,95 1W,0"});h.1h(k={id:"Ab",1L:"Oi,100 e8,100 PE,100,100,75,100,50 6Y,25,85,0,67,0 l9,0 mW,0,0,25,0,50 C0,75,15,100,33,100"});h.1h(k={id:"nv",1L:"3e,50 2G,50,50,0,6.2J,0"});h.1h(k={id:"Ac",1L:"3e,75 1O,0 L0,0 L0,75 6a,100 7H,100 1O,75"});h.1h(k={id:"Ah",1L:"M0,0 1O,0 1O,100 L0,100 L0,0",2P:"e1,0 L0,10 a1,0 1O,10 a1,100 1O,90 M0,90 6S,100"});h.1h(k={id:"Am",1L:"3v,0 1O,50 1W,100 L0,50 1W,0",2P:"cw,10 3Q,10 cw,90 3Q,90 e1,40 6S,60 a1,40 5p,60"});h.1h(k={id:"An",1L:"M0,0 L0,100 1O,100 1O,30 5X,0 L0,0",2P:"n1,0 5X,30 1O,30"});h.1h(k={id:"Ao",1L:"M0,0 1O,0 1O,100 L0,100 L0,0",2P:"M5,5 QP,5 QP,95 L5,95 L5,5"});h.1h(k={id:"Al",1L:"M6.QS-15,0 QR.QF,0,100,22.vh,100,50 6Y,77.r4,55.QF,100,6.QS-15,100 M0,100 QR,75,55,25,0,0"});h.1h(k={id:"Ai",1L:"3v,20 Pz,5,65,0,75,0 r3,0,100,10,100,25 6Y,50,67,75,50,100 l8,75,0,50,0,25 C0,10,15,0,25,0 OD,0,50,5,50,20"});h.1h(k={id:"Aj",1L:"XO,100 L0,70 6S,25 1W,0 5p,25 1O,70 kD,100 ld,100"});h.1h(k={id:"Ak",1L:"M0,0 5T,50 L0,100 1O,100 5X,50 1O,0 L0,0"});h.1h(k={id:"A9",1L:"M0,100 L0,100 1O,100 1O,0 L0,40 L0,100"});h.1h(k={id:"zX",1L:"M0,100 1O,100 1O,0 L0,0 L0,100",2P:"M0,15 1O,15 f0,0 aH,100"});h.1h(k={id:"zY",1L:"M0,0 L0,100 1O,50 1O,100 1O,0 1O,50 L0,0"});h.1h(k={id:"zT",1L:"M0,0 L0,100 4N,50 4N,20 1O,0 4N,20 4N,80 3Q,100 4N,80 4N,50 L0,0"});h.1h(k={id:"zU",1L:"M0,0 7H,0 1O,50 7H,100 L0,100 6a,50 L0,0"});h.1h(k={id:"zV",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"f0,15 7F,85 ra,15 aH,85"});h.1h(k={id:"A1",1L:"vz,0 5T,0 aH,40 8H,40 5T,100 kF,30 l9,27 ri,0 5T,0"});h.1h(k={id:"A6",1L:"M0,90 L0,0 1O,0 1O,90 vI,80,66,80,50,90 l8,100,16,100,0,90",2P:"f0,0 aH,96"});h.1h(k={id:"A7",1L:"3e,0 L0,0 6e,100 4N,100 1O,0"});h.1h(k={id:"A8",1L:"M0,0 1O,0 1W,100 L0,0"});h.1h(k={id:"A2",1L:"M0,100 1O,100 4N,50 1O,0 L0,0 L0,100"});h.1h(k={id:"A4",1L:"3e,100 6e,100 L0,50 6e,0 1O,0 1O,100"});h.1h(k={id:"Bq",1L:"M0,90 L0,10 XT,20,33,20,50,10 OP,0,83,0,100,10 1O,90 vI,80,66,80,50,90 l8,100,16,100,0,90"});h.1h(k={id:"CS",1L:"M0,100 1W,74 1O,100 1O,0 1W,25 L0,0 L0,100"});h.1h(k={id:"CT",1L:"M0,100 4N,75 1O,85 1O,15 4N,25 L0,0 L0,100"});h.1h(k={id:"CQ",1L:"M0,92 L0,20 6S,20 6S,10 6e,10 6e,0 1O,0 1O,72 rg,69,90,69,90,69 5p,82 r3,79,80,79,80,79 4N,92 OP,84,53,84,39,92 XY,100,13,100,0,92",2P:"e1,20 4N,20 4N,79 dG,10 5p,10 5p,69"});h.1h(k={id:"CN",1L:"M0,100 4N,100 4N,90 5p,90 5p,80 1O,80 1O,0 6e,0 6e,10 6S,10 6S,20 L0,20 L0,100",2P:"e1,20 4N,20 4N,90 dG,10 5p,10 5p,80"});h.1h(k={id:"CO",1L:"Oi,100 L0,67 L0,33 l9,0 e8,0 1O,33 1O,67 e8,100 l9,100"});h.1h(k={id:"CP",1L:"M0,0 1W,100 1O,0 L0,0",2P:"e1,20 5p,20"});h.1h(k={id:"CU",1L:"M0,0 1W,0 1O,50 1W,100 L0,100 L0,0"});h.1h(k={id:"CZ",1L:"M0,70 L0,0 1O,0 1O,70 1W,100 L0,70"});h.1h(k={id:"Or",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"3v,0 1W,100 M0,50 1O,50"});h.1h(k={id:"D0",1L:"3v,0 L0,50 aH,100 7F,100 1O,50 1W,0"});h.1h(k={id:"ps",1L:"3v,0 bm,37 bm,95 9i,95 9i,37 1W,0"});h.1h(k={id:"pr",1L:"3v,0 bm,95 1W,60 9i,95 1W,0"});h.1h(k={id:"D1",1L:"M0,100 1O,100 4N,50 1O,0 L0,0 L0,100",2P:"f0,0 aH,100"});h.1h(k={id:"CY",1L:"3e,100 6e,100 L0,50 6e,0 1O,0 1O,100",2P:"ra,0 7F,100"});h.1h(k={id:"CV",1L:"M0,0 1O,0 1O,100 L0,100 L0,0",2P:"f0,0 aH,100 ra,0 7F,100"});h.1h(k={id:"CW",1L:"M0,0 1O,0 1O,100 L0,100 L0,0",2P:"f0,0 aH,100"});h.1h(k={id:"CX",1L:"3v,0 1O,20 1O,80 1W,100 1W,100 L0,80 L0,20 1W,0",2P:"M0,20 1W,40 1W,100 3v,40 1O,20"});h.1h(k={id:"CM",1L:"M0,100 L0,100 L0,30 5T,0 1O,0 1O,100 L0,100"});h.1h(k={id:"CB",1L:"3v,100 1O,80 1W,0 L0,80 1W,100",2P:"M0,80 1W,60 3v,0 1W,60 3e,80 1W,60"});h.1h(k={id:"CC",1L:"3v,100 1O,80 1W,0 L0,80 1W,100",2P:"3v,0 1W,100"});h.1h(k={id:"pd",1L:"3v,0 bm,37 bm,95 1W,58 9i,95 9i,37 1W,0"});h.1h(k={id:"6h",1L:"M0,0 1O,0 1O,100 L0,100 L0,0"});h.1h(k={id:"py",5f:"7v",1L:"",2P:"mX,0 1W,95 9i,0"});h.1h(k={id:"pn",1L:"mX,0 1W,95 9i,0 bm,0"});h.1h(k={id:"pl",5f:"7v",1L:"XZ,Oj XU,Oj,37,0,6.2J,0",2P:"mX,0 1W,95 9i,0"});h.1h(k={id:"ph",5f:"7v",1L:"",2P:"mX,0 1W,95 9i,0 rf,110 bm,110"});h.1h(k={id:"oZ",1L:"3v,0 5F,55 1W,100 cr,55 1W,0"});h.1h(k={id:"iy",1L:"U0,0,100,100,2.5"});h.1h(k={id:"CD",1L:"vz,100 1O,100 5X,0 L0,0 5T,100"});h.1h(k={id:"CA",1L:"M0,100 6a,0 1O,0 7H,100 L0,100"});h.1h(k={id:"pj",5f:"7v",1L:"",2P:"rf,37 bm,-37"});h.1h(k={id:"Cx",1L:"3v,0 1O,50 1W,100 L0,50 1W,0",2P:"M0,50 1O,50"});h.1h(k={id:"Cy",1L:"3e,50 2G,50,50,0,6.2J,0",2P:"3v,0 XV,25,25,75,50,100"});h.1h(k={id:"Cz",1L:"3v,0 1W,0 4Z,33 L0,30 5T,50 aH,100 1W,60 7F,100 e8,50 1O,30 3Q,33 1W,0"});h.1h(k={id:"CE",1L:"f0,100 C5,100,0,75,0,50 C0,25,5,0,15,0 7F,0 rg,0,100,25,100,50 6Y,75,95,100,85,100 aH,100",2P:"f0,0 aH,100 ra,0 7F,100"});h.1h(k={id:"CJ",1L:"3v,100 2G,50,50,1.lx,7.XW,0 11c,93.g7 1O,93.g7 1O,100 1W,100"});h.1h(k={id:"CK",1L:"dG,100 4N,100 P0,100,100,75,100,50 6Y,25,90,0,80,0 6e,0 Ea,0,0,25,0,50 C0,75,10,100,20,100"});h.1h(k={id:"oY",1L:"3v,0 5F,80 1W,100 cr,80 1W,0"});h.1h(k={id:"CL",1L:"RA,90 1O,100 1O,0 L0,0 L0,90 3Q,90"});h.1h(k={id:"ou",1L:"3v,0 bm,95 9i,95 1W,0"});h.1h(k={id:"CF",1L:"M0,0 1O,100 L0,100 L0,0"});h.1h(k={id:"CG",1L:"3e,50 5p.l1,80.Pj kF.l1,100 gx.l2,100 L9.l2,80.Pj L0,50 L9.l2,19.Oa gx.l2,0.Op kF.l1,0.Op 5p.l1,19.Oa 1O,50"});h.1h(k={id:"CH",1L:"e1,0 5p,0 1O,100 L0,100 6S,0"});h.1h(k={id:"D2",1L:"3v,0 r8.r2,35.r1 1O,50 r8.r2,64.r2 1W,100 OA.r1,64.r2 L0,50 OA.r1,35.r1 1W,0"});h.1h(k={id:"Dn",1L:"3v,0 3Q.XX,35.LJ XP.XN,34.l2 e8.XS,55.Qh XR.XQ,90.l1 1W,68 6e.Y9,90.l1 n0.Y8,55.Qh L2.Xt,34.l2 bu.Xp,35.LJ 1W,0"});h.1h(k={id:"Do",1L:"3v,0 NH,36.O2 qA.g7,25 DT,50 qA.g7,75 NH,63.NA 1W,100 qx,63.NA L6.kV,75 gx,50 L6.kV,25 qx,36.O2 1W,0"});h.1h(k={id:"Dp",1L:"3v,0 ri.Xo,35.Mh hF.Xn,18.Mv kF.Xs,46.Lq DS.Xr,61.LM n7.Xq,59.NQ XG.XC,95.N8 1W,66 ld.XB,95.N8 DU.XA,59.NQ L1.XF,61.LM gx.XE,46.Lq 6S.XD,18.Mv n8.Yd,35.Mh 1W,0"});h.1h(k={id:"Dj",1L:"3v,0 kC.qJ,10.qz sw.gL,3.gb kD.qH,16.qy 7F.bY,14.bs 5F.qF,27.qD sc.gw,30.g9 hF.qG,42.qw 1O,50 hF.qG,57.qJ sc.gw,69.gL 5F.qF,72.qH 7F.bY,85.bY kD.qH,83.qF sw.gL,96.gw kC.qJ,89.qG 1W,100 qx.qw,89.qG 5T.g9,96.gw nc.qD,83.qF dK.bs,85.bY OL.qy,72.qH L3.gb,69.gL 6S.qz,57.qJ L0,50 6S.qz,42.qw L3.gb,30.g9 OL.qy,27.qD dK.bs,14.bs nc.qD,16.qy 5T.g9,3.gb qx.qw,10.qz 1W,0"});h.1h(k={id:"Dk",1L:"3v,0 8g.qS,10.s6 n7.qP,1.sd kF.qM,13.sj 7H,6.kV P1.qO,18.se 7F.bY,14.bs OV.qY,25.sf qA.g7,25 Pk.r0,34.sk DS.qU,37.si hF.qV,44.s7 1O,50 hF.qV,55.qS DS.qU,62.qP Pk.r0,65.qM qA.g7,75 OV.qY,74.qO 7F.bY,85.bY P1.qO,81.qY 7H,93.g7 kF.qM,86.r0 n7.qP,98.qU 8g.qS,89.qV 1W,100 s8.s7,89.qV DU.si,98.qU gx.sk,86.r0 6a,93.g7 6a.sf,81.qY dK.bs,85.bY n3.se,74.qO L6.kV,75 9i.sj,65.qM L1.sd,62.qP 6S.s6,55.qS L0,50 6S.s6,44.s7 L1.sd,37.si 9i.sj,34.sk L6.kV,25 n3.se,25.sf dK.bs,14.bs 6a.sf,18.se 6a,6.kV gx.sk,13.sj DU.si,1.sd s8.s7,10.s6 1W,0"});h.1h(k={id:"Dl",1L:"3v,0 su.rI,10.rX LU.rN,0.rR bk.rP,11.rY sw.gL,3.gb kT.rM,14.s2 8K.rK,8.s0 7H.sq,19.rF 7F.bY,14.bs 4N.ss,24.rG LQ.sp,22.s1 7F.sn,31.rZ sc.gw,30.g9 n4.sy,38.s3 Ll.sA,40.rS hF.sx,46.rU 1O,50 hF.sx,53.rI Ll.sA,59.rN n4.sy,61.rP sc.gw,69.gL 7F.sn,68.rM LQ.sp,77.rK 4N.ss,75.sq 7F.bY,85.bY 7H.sq,80.ss 8K.rK,91.sp kT.rM,85.sn sw.gL,96.gw bk.rP,88.sy LU.rN,99.sA su.rI,89.sx 1W,100 N7.rU,89.sx 4Z.rS,99.sA s4.s3,88.sy 5T.g9,96.gw N4.rZ,85.sn Nd.s1,91.sp Nb.rG,80.ss dK.bs,85.bY Ne.rF,75.sq L8.s0,77.rK dK.s2,68.rM L3.gb,69.gL No.rY,61.rP L0.rR,59.rN 6S.rX,53.rI L0,50 6S.rX,46.rU L0.rR,40.rS No.rY,38.s3 L3.gb,30.g9 dK.s2,31.rZ L8.s0,22.s1 Ne.rF,24.rG dK.bs,14.bs Nb.rG,19.rF Nd.s1,8.s0 N4.rZ,14.s2 5T.g9,3.gb s4.s3,11.rY 4Z.rS,0.rR N7.rU,10.rX 1W,0"});h.1h(k={id:"Dq",1L:"3e,50 2G,50,50,0,6.2J,0 YP,50 2G,50,24,0,-6.2J,1"});h.1h(k={id:"Dv",1L:"e1,0 5p,0 Nn,0,10,3.DF,1.lx,1 1O,90 Nn,100,10,-1.lx,-3.DF,1 6S,100 A0,100,10,0,-1.lx,1 L0,10 A0,0,10,1.lx,0,1"});1k(1b j=0;j<h.1f;j++){1g f(h[j])}};f.1n={4f:1c(u,h){1a.2Y={};1a.2Y.id=1a.id=u.3c("id");1b j=u.3c("hy-Nf");if(j=="YO"){1a.2Y.5f="7v"}1l{1a.2Y.5f="q7"}1b t=h.9x("1L",u);if(t){1a.2Y.1L=1a.po(t,h)}1b n=h.9x("DO",u);if(n){1a.2Y.2P=1a.po(n,h)}1b s=h.9x("1N-DO",u);if(s&&s.dc.1f>0){1a.2Y.4h=[];1k(1b o=0;o<s.dc.1f;o++){1b l=s.dc[o];if(l.ov!==1){2t}1b r=h.9x("DO",l);1b q={};q.2W=1a.po(r,h);1b p=h.9x("1V",l);if(p){q.1V=h.sR(p)}1b k=h.9x("2j",l);if(k){q.2j=h.pQ("2j",l)}q.5f="q7";1b v=h.9x("hy-Nf",l);if(v&&v.YK=="0"){q.5f="7v"}1a.2Y.4h.1h(q)}}},po:1c(q,h){1b r=[];1k(1b p=0;p<q.dc.1f;p++){1b k=q.dc[p];if(k.ov!==1){2t}1b o=1a.MQ(k);if(o[0]!="Ns"){r.1h(o)}}1b s=1j;1b l="";1k(1b p=0;p<r.1f;p++){1b o=r[p];if(o[0]mN YG){1k(1b n=0;n<o.1f;n++){l+=1a.E4(o[n]);l+=" "}}1l{l+=1a.E4(o);if(p==0&&o[0]=="mG"&&l.h8(0,1)!="M"){l="M"+o[1]+","+o[2]+" "+l}l+=" "}}1d l.YF()},E4:1c(j){1b h="";56(j[0]){1T"cJ":if(1a.pt==1j||1a.pt.x!=j[7]||1a.pt.y!=j[8]){h+="M"+j[7]+","+j[8]+" "}h+="A"+j[1]+","+j[2]+","+j[3]+","+j[4]+","+j[5]+","+j[6];1a.pt=1a.AG(j[1],j[2],j[3],j[5]);1Q;1T"AI":if(1a.pt==1j||1a.pt.x!=j[1]||1a.pt.y!=j[2]){h+="M"+j[1]+","+j[2]+" L"+j[3]+","+j[4]}1l{h+="L"+j[3]+","+j[4]}1a.pt={x:j[3],y:j[4]};1Q;1T"mG":if(1a.pt==1j||1a.pt.x!=j[1]||1a.pt.y!=j[2]){h+="M"+j[1]+","+j[2]+" "}h+="C"+j[3]+","+j[4]+","+j[5]+","+j[6]+","+j[7]+","+j[8];1a.pt={x:j[7],y:j[8]};1Q;1T"YE":if(1a.pt==1j||1a.pt.x!=j[1]||1a.pt.y!=j[2]){h+="M"+j[1]+","+j[2]+" "}h+="Q"+j[3]+","+j[4]+","+j[5]+","+j[6];1a.pt={x:j[5],y:j[6]};1Q;1T"nP":if(1a.pt==1j||1a.pt.x!=j[1]||1a.pt.y!=j[2]){h+="M"+j[1]+","+j[2]+" "}h+="U"+j[1]+","+j[2]+","+j[3]+","+j[4]+","+j[5];1a.pt={x:j[4],y:j[5]};1Q;aL:1Q}1d h},MQ:1c(o){56(o.YI){1T"cJ":1b A=4J(o.3c("x"));1b u=5v(o.3c("y"));1b B=4J(o.3c("cJ-1q"));1b p=4J(o.3c("cJ-1p"));1b z=4J(o.3c("tz"));1b C=4J(o.3c("YZ"));1d 1a.Nr(A,u,B,p,z,C);1T"AI":1b D=o.4K("4r");1b n=4J(D[0].3c("x"));1b l=4J(D[1].3c("x"));1b v=4J(D[0].3c("y"));1b t=4J(D[1].3c("y"));1d["AI",n,v,l,t];1T"mG":1b D=o.4K("4r");1b n=4J(D[0].3c("x"));1b l=4J(D[1].3c("x"));1b k=4J(D[2].3c("x"));1b E=4J(D[3].3c("x"));1b v=4J(D[0].3c("y"));1b t=4J(D[1].3c("y"));1b s=4J(D[2].3c("y"));1b q=4J(D[3].3c("y"));1d["mG",n,v,l,t,k,s,E,q];1T"b1-YY":1b A=4J(o.3c("x"));1b u=4J(o.3c("y"));1b B=4J(o.3c("w"));1b p=4J(o.3c("h"));1b j=4J(o.3c("r"));1d["nP",A,u,A+B,u+p,j];aL:1d["Ns"]}},Nr:1c(u,s,v,r,t,z){1b o=v/2;1b l=r/2;if(o==l){1b n=1a.AG(u+v/2,s+r/2,o,c.1A.mK(t));1d["cJ",u+o,s+l,o,c.1A.mK(t),c.1A.mK(t+z),z<0?1:0,n.x,n.y]}1b A=c.1A.Z3(u,s,v,r,t,z);1b B=[];1k(1b q=0,k=0;q<A.1f;k++){B.1h(["mG"]);1k(1b p=0;p<4;p++){if(A[q+p]==1j){2t}B[k].1h(A[q+p].x);B[k].1h(A[q+p].y)}q+=4}1d B},AG:1c(h,l,k,j){1d{x:1s.b1(h+1s.mq(j)*k),y:1s.b1(l+1s.dT(j)*k)}},3F:1c(h){h.9s=1g d(1a.2Y.1L||"");h.9s.5o(1a.2Y.8w||"#4T");h.9s.4y(1a.2Y.7O||"#pO");h.fl=1g d(1a.2Y.2P||"");h.fl.5o(1a.2Y.gU||"#4T");h.fl.4y(1a.2Y.jk||"4l");h.fm=1g d(1a.2Y.Z2||"");h.fm.5o(1a.2Y.nO||"#4T");h.fm.4y(1a.2Y.nM||"#4T")},hU:1c(l,k,o){if(k.1q===0||k.1p===0){1d}1b n=1a.qi;1b h=k.1q/n.1q;1b p=k.1p/n.1p;1b j=1g b();j.8f(k.x-k.1q/2,k.y-k.1p/2);j.3A(h,p);j.8f(k.1q/h-n.x-n.1q/2,k.1p/p-n.y-n.1p/2);if(1a.fC>0){j.cz(1a.fC,n.x+n.1q/2,n.y+n.1p/2)}if(o!==0){j.cz(o,n.x+n.1q/2,n.y+n.1p/2)}l.9s.4C=j.1J();l.fl.4C=j.1J();l.fm.4C=j.1J()},lz:1c(j,k,h){if(h!=1j){if(!j.9s.7s()){a.fo(k,h,j.9s)}if(!j.fl.7s()){a.fo(k,h+1,j.fl)}if(!j.fm.7s()){a.fo(k,h+2,j.fm)}}1l{if(!j.9s.7s()){a.3u(k,j.9s)}if(!j.fl.7s()){a.3u(k,j.fl)}if(!j.fm.7s()){a.3u(k,j.fm)}}},lG:1c(h,j){a.3l(j,h.9s);a.3l(j,h.fl);a.3l(j,h.fm)},1J:1c(){1b h=1g f();h.id=1a.id;h.2Y=1a.2Y;1d h},pg:1c(){1d 1a.id},AH:1c(){1b j=1g d(1a.2Y.1L);1b h=j.Z1;if(h[0]=="A"){if(h[7]==0&&h[9]==6.DG){1d 1m}}1d 1u},hm:1c(){1d 1a.6K===1m},id:"",fC:0,qi:1g 1e.1z.2O(0,0,100,100)};1e.1Z(f,"1e.1i.1D")})(1e.1i);(1c(c){1b d=1e.1i.1D;1b a=1e.2T.5i;1b b=c.lC=1c(e){1a.f9=[];if(e){1k(1b f in e){1a.f9.1h(f)}}};b.gj=1c(){if(!3p){1d}1b e=3p.4K("YX");if(!e){1d}a.1B(e,1c(f){1b g=1e.mF(f.id);if(g&&g.gj){g.gj()}})};b.1n={4f:1c(e,g,h){1b f=1a;1b j=1g AR();j.NI=1c(){if(j.YT==4&&j.AP==ho){1b p=j.NM;1b n=1g c.o7(f,p);f.f9=[];1b k=p.4K("f9")[0];if(!k){1d}1b l=k.YS;if(!l){1d}2L(l!=1j){if(l.ov==1){1b o=1g d();o.4f(l,n);d.ND(o);f.f9.1h(o)}l=l.YR}b.gj(1m);if(g){g(f)}}1l{if(iw&&iw.mI){iw.mI("5h 2L AN lC AO. "+j.AP+" "+j.LG)}b.gj(1u);if(h){h(f)}}};j.NE=1c(){if(iw&&iw.mI){iw.mI("5h 2L AN lC AO. "+j.AP+" "+j.LG)}b.gj(1u);if(h){h(f)}};j.AE("LI",e);j.LK="3p";j.At()},YW:1c(){if(!1a.f9){1a.f9=[]}1d 1a.f9}};1e.1Z(b,"1e.1i.lC")})(1e.1i);(1c(c){1b b=1e.2T.5i;1b g=1e.1z.5t;1b a=1e.1i.LF;1b e=1e.1z.aX;1b d=1e.1i.iQ;1b f=c.5m=1c(h){c.4c.6z=1m;1o.2u(f,1a,[h]);1a.2f=0;if(c.8A.nJ===1u){1a.dS("8k")}1a.1K.gG=1m;1a.9a="";1a.3w=1j;1a.6W=c.cH.Au;1a.8x=1m;1a.8C=1m;if(h&&c.8A.nJ===1u){1a.2j=h.ht;1a.1V=h.fd}1a.4P(h&&h.8P?h.8P:"iy");1a.6x(c.3q.4H);1a.6F(c.3q.4H);1a.4l=1u;c.4c.6z=1u};f.1n={1J:1c(){c.4c.6z=1m;1b h=1o.2a(f,1a,"1J",[]);h.4P(1a.1N.id);h.gd(1a.9a);h.qe(1a.4l);h.j0(1a.6W);h.q5(1a.8x);h.q3(1a.8C);h.cM(1a.bF);h.gR(1a.dz());c.4c.6z=1u;1d h},2k:1c(){1b h=1o.2a(f,1a,"2k",[]);if(1a.bF){if(1a.1t.jK){h.jv=1a.1t.jK(1a.bF)}1l{h.jq=1a.bF}}h.1N=1a.1N.id;h.9a=1a.9a||"";h.4l=1a.4l;h.6W=1a.6W;h.8x=1a.8x;h.8C=1a.8C;h.cu=1a.dz();1d h},2E:1c(h){1o.2a(f,1a,"2E",[h]);1a.4P(1e.1i.1D.1I(h.1N)||"iy");if(h.jv!=1v){1a.cM(1a.1t.97[h.jv])}if(h.jq!=1v){1a.cM(h.jq)}1a.gd(h.9a);1a.qe(h.4l);1a.j0(h.6W);1a.q5(h.8x);1a.q3(h.8C);1a.gR(h.cu)},4f:1c(k,j){1o.2a(f,1a,"4f",[k,j]);1a.gR(j.3U("sY",k));1a.4P(j.hX("1D",k));if(1a.1N==1j){1a.4P("6h")}1a.8x=j.3U("LB",k,1a.8x);1b h=j.o3("Im",k);if(h){1a.6x(h.nY);1a.6F(h.4p)}1l{1a.6x(j.2Q("gk",k));1a.6F(j.2Q("gh",k))}1a.6W=j.2Q("cH",k);1a.cM(j.pF("c6",k));1a.8C=j.3U("LA",k,1a.8C);1a.4l=j.3U("LD",k)},4E:1c(j,h){1o.2a(f,1a,"4E",[j,h]);h.3O(1a.dz(),"sY",j);h.hW(1a.gz(),"1D",j);h.3O(1a.8x,"LB",j);h.3m(1a.8F(),"gk",j);h.3m(1a.9c(),"gh",j);h.3m(1a.6W,"cH",j);h.pX(1a.oL(),"c6",j);h.3O(1a.8C,"LA",j);h.3O(1a.4l,"LD",j)},q5:1c(h){if(1a.8x!=h){1a.8x=h;1a.1F()}},YU:1c(){1d 1a.8x},q3:1c(h){if(1a.8C!=h){1a.8C=h;1a.1F()}},Yn:1c(){1d 1a.8C},pW:1c(h){if(!h){1a.3w=1j}1l{1a.3w=1g 1e.1z.c6(1a.1w);1a.3w.3w=h;1a.3w.qb=1m}1a.1F()},pZ:1c(){if(!1a.3w){1d 1j}1d 1a.3w.3w},j0:1c(h){if(1a.6W!=h){1a.6W=h;if(1a.3w){1a.1F()}1l{1a.3Y()}}},kr:1c(){if(1a.6W===1v){1d c.cH.Au}1d 1a.6W},qe:1c(h){if(1a.4l!=h){1a.4l=h;1a.1F()}},Ym:1c(){1d 1a.4l},Av:1c(h){if(h.1f===0){1d}1a.1t=h[0]},LL:1c(){1d 1a.4L.LN.8s},2M:1c(h){1b j=1a.6N();if(!j.2M(h)){1d 1u}if(c.1A.ry(h,1a.5P())){1d 1m}if(1a.6B&&1a.8c(h)){1d 1m}1d 1u},hZ:1c(){1a.4n.f5=1a},eW:1c(){1b n=1a.4n.2H=[];if(1a.1N.hm()&&!c.1D.7T){1a.1N=c.1D.1I(1a.1N.id);if(1a.5K){1a.5K.4P(1a.1N)}}1b l=1a.1w;if(!1a.4l){1b j=1a.gr();1b q={1V:j,dE:d.l4};1a.eN(n,q);if(q.1V){j=q.1V}}if(!1a.5K){1a.5K=1g c.b8(1a.1N)}1a.5K.hU(1a.1w,1a.2f);if(!1a.4l){1a.5K.7O=1a.gr();1a.5K.8w=1a.aI();1a.5K.2v=1a.9k();1a.5K.3f=1a.bz();1a.5K.aK=1a.dA();n.1h(1a.5K)}1b o=1a.3w;if(o&&o.qb){1b p=g.fK(1a.1t.2o);if(o.BS){1b h={x:o.1w.1q*p,y:o.1w.1p*p};if(1a.8C){o.2f=1a.2f}}1l{1b h={x:o.3w.1q*p,y:o.3w.1p*p}}1b k=c.1A.Pv(l,h,1a.6W);if(1a.4l){1a.5K.hU(1a.1w,1a.2f)}o.AL=1a.5K.5P();o.3g(k,(1a.8C)?1a.2f:0);n.1h(o)}if(!1a.4l){1a.eN(n,{dE:d.k4})}1a.1K.2i=1a.c8();1a.1K.2j=1a.9R();1a.1K.3P=1a.gB();1a.1K.2v=1a.iL();1a.1K.3g(l,(1a.8x)?1a.2f:0);n.1h(1a.1K);1a.oc(n);if(1a.dD){1a.dD(1a)}},4P:1c(h){if(5G h=="bB"){h=c.1D.1I(h)}if(1a.1N!=h){1a.1N=h;if(1a.5K){1a.5K.4P(1a.1N)}1a.1F()}},gz:1c(){1d 1a.1N},gd:1c(h){if(1a.9a!=h){1a.9a=h;if(h){1a.3w=1g 1e.1z.c6(1a.1w);1o.5N(1a.3w.3w,{kv:1o.3t(1a,1a.eI)});1a.3w.3w.kk=h}1a.3Y()}},oB:1c(){1d 1a.9a},cM:1c(j){if(1a.bF!=j){1a.bF=j;if(j){1a.3w=1g 1e.1z.c6(1a.1w);1o.5N(1a.3w.3w,{kv:1o.3t(1a,1a.eI)});1b h="7x:3w/LO;BQ,"+1a.bF;1a.3w.3w.kk=h}1a.3Y()}},oL:1c(){1d 1a.bF},eI:1c(){1a.3w.qb=1m;if(1a.1t){1a.1F()}},gR:1c(h){if(1a.1K.cu!=h){1a.1K.cu=h;1a.1F()}},dz:1c(){1d 1a.1K.cu},5P:1c(){if(1a.4n.f5){1a.eW();1a.4n.f5=1j}1b h=c.1A.Ln();1a.5K.5P().hd(h);1d h.Lj()},7u:1c(j,k){1b h=k.3E["3b:5m"];if(h){if(j.3F(h)){1d h}}1d 1o.2a(f,1a,"7u",[j,k])},Yl:1c(u){if(1a.1K==1v||1a.1K==""){1d 1u}if(u==1v){u=a.Aq}1b z=g.3h(1a.1t.2o);1b v=1a.1w.1J();1a.aG.Yq(v);1b t=c.1A.Yp(1a.1t.2o);1b s=t;1b l=1a.1K.1K;1b o=1a.c8();1b w=1a.dz();if(u==a.Lh){1b p=1a.1t.9r(l,o,v,w);v.1p=p.1p;1a.aG.AB(v);1a.3g(v,1m,1m)}1l{if(u==a.Lw){if(w){v.1q=3W.5s;1b p=1a.1t.9r(l,o,v,w);v.1q=p.1q}1l{1b r=v.1J();r.1q=3W.5s;1b k=1a.1t.9r(l,o,r,w);1b p=1a.1t.9r(l,o,v,w);1b n=e.Ar(l,o,1a.1t.3R,1a.1t.3A);if(v.1q<n){1b A=n-v.1q;v.1q=n}if(p.1p>v.1p){2L(p.1p>v.1p&&v.1q<k.1q){v.1q+=t;p=1a.1t.9r(l,o,v,w);if(v.1q<n){1Q}}}1l{2L(p.1p<v.1p){v.1q-=t;p=1a.1t.9r(l,o,v,w);if(v.1q<n){1Q}}v.1q+=t}}1a.aG.AB(v);1a.3g(v,1m,1m)}1l{if(u==a.Aq){1b q=v.1q/v.1p;1b C=v.1p/v.1q;if(q<C){C=1/q;q=1}1l{q=1/C;C=1}t=q*t;s=C*s;1b j=0;1b h=0;1b B=1a.1w.1J();1b p=1a.1t.9r(l,o,v,w);1b n=w?20*z:e.Ar(l,o,1a.1t.3R,1a.1t.3A);if(B.1q<n){1b A=n-v.1q;B.1q=n;B.1p=v.1p+A}if(p.1p<v.1p){do{j-=t;h-=s;v=B.1J();v=c.1A.5B(v,j,h);p=1a.1t.9r(l,o,v,w);if(v.1q<n){1Q}}2L(p.1p<v.1p);j+=t;h+=s;v=B.1J();v=c.1A.5B(v,j,h)}1l{1b p=1a.1t.9r(l,o,v,w);2L(p.1p>v.1p){j+=t;h+=s;v=1a.1w.1J();v=c.1A.5B(v,j,h);1b p=1a.1t.9r(l,o,v,w);if(v.1q>z*ng){1Q}}}1a.aG.AB(v);1a.3g(v,1m,1m)}}}1a.1F();1d 1m},9f:1c(){1b h=1o.2a(f,1a,"9f",[]);h.1N=1a.1N;h.9a=1a.9a;h.4l=1a.4l;h.6W=1a.6W;h.8x=1a.8x;h.8C=1a.8C;1d h},a2:1c(h){1o.2a(f,1a,"a2",[h]);1a.4P(h.1N);1a.gd(h.9a);1a.qe(h.4l);1a.j0(h.6W);1a.q5(h.8x);1a.q3(h.8C)},8v:1c(){if(!fc){fc=1g 1e.5b(f.1n,1j,1a)}1l{fc.5c(1a)}1d fc}};f.bi=1c(h){if(!fc){fc=1g 1e.5b(f.1n,h)}1l{fc.5c(1j)}1d fc};fc=1j;1e.1Z(f,"1e.1i.5m",c.2Z)})(1e.1i);(1c(b){1b g=1e.1i.1D;1b a=1e.1z.gp;1b e=1e.1z.Yk;1b c=1e.1z.2O;1b d=1e.1z.bX;1b h=b.b8=1c(j){1a.1N=j;1a.4C=1j;1a.8w="#4T";1a.7O="#pO";1a.gU="#4T";1a.jk="4l";1a.nO="#4T";1a.nM="#4T";1a.3f=1v;1a.2v=0;1a.h0="Yg";1a.8d=f.4D;1a.Az=1g c(0,0,100,100);1a.Bb=1u;1a.AD()};h.1n={AD:1c(){if(1a.1N.2Y.1L){1a.eu=1a.qm();1a.Bf=[]}if(1a.1N.2Y.2P){1a.ql=1a.qm();1a.Bg=[]}if(1a.1N.2Y.4h){1a.nU=[];1a.pI=[];1k(1b j=0;j<1a.1N.2Y.4h.1f;j++){1a.nU.1h(1a.qm());1a.pI.1h([])}}1a.M9()},LX:1c(){4m 1a.eu;4m 1a.Bf;4m 1a.ql;4m 1a.Bg;4m 1a.nU;4m 1a.pI;1a.AD()},l6:1c(l,j){1a.8d=f.4D;if(1a.1N.2Y.1L){1a.8d=f.h5;l.8D();1a.hd(l);if(1a.aK&&j!=1u){1a.aK.3F(l)}l.8Q=1a.Mx(l);l.hy(1a.1N.2Y.5f);l.8N();l.6U=1a.MA(l);l.7i=1a.2v/l.7w;1e.1z.hH.3F(l,1a.3f);l.h0=1a.h0;l.3P()}if(1a.1N.2Y.2P){1a.8d=f.ha;l.8D();1a.hd(l);l.8Q=1a.M7(l);l.hy(1a.1N.2Y.5f);l.8N();l.6U=1a.M4(l);l.7i=1a.2v/l.7w;1e.1z.hH.3F(l,1a.3f);l.h0=1a.h0;l.3P()}if(1a.1N.2Y.4h){1k(1b k=0;k<1a.1N.2Y.4h.1f;k++){1b n=1a.1N.2Y.4h[k];1a.Mt(n,l,k)}}1a.8d=f.4D},Mt:1c(l,k,j){1a.8d=f.h9+j;k.8D();1a.hd(k);k.8Q=1a.M8(k,j);k.hy(l.5f||"q7");k.8N();k.6U=1a.Ma(k,j);k.7i=1a.2v/k.7w;1e.1z.hH.3F(k,(l.2j?l.2j.du:1a.3f));k.h0=1a.h0;k.3P();1a.8d=f.4D},Ms:1c(j){if(1a.aK){j.8D();1a.8d=f.ky;1a.hd(j);1a.aK.3F(j);j.8Q=1a.aK.3s;j.hy(1a.1N.2Y.5f);j.8N();1a.8d=f.4D}},nE:1c(j){1a.5P().4y(1a.7O);1a.9s.5o(1a.8w);1a.9s.2v=1a.2v;1a.9s.l6(j)},hd:1c(n,k){if(k==1u){n.8D()}if(1a.4C){n.4C.3F(n,1a.4C.qu())}n.ck();1b j=1a.eG();if(j){1k(1b l=0;l<j.1f;l++){if(j[l].eJ=="nP"){1a.Mu(n,j[l])}1l{n[j[l].eJ].3F(n,j[l].7c)}}}if(k==1u){n.8N()}},Mu:1c(o,n){o.8D();o.4C.3F(o,1a.MG.qu());1b q=1a.Az;1b l=q.x+q.1q*n.7c[0]/100;1b r=q.y+q.1p*n.7c[1]/100;1b p=q.1q*n.7c[2]/100;1b k=q.1p*n.7c[3]/100;1b j=n.7c[4];o.6V(l,r+j);o.3D(l,r+k-j);o.kp(l,r+k,l+j,r+k);o.3D(l+p-j,r+k);o.kp(l+p,r+k,l+p,r+k-j);o.3D(l+p,r+j);o.kp(l+p,r,l+p-j,r);o.3D(l+j,r);o.kp(l,r,l,r+j);o.8N()},AA:1c(j,r,n){if(j.1q===0||j.1p===0){1d}1b p=1a.1N.qi;1b q=b.1A.d4(r,n);1b o=90+b.1A.Yh(1s.YA(q.y,q.x));1b l=b.1A.d4(r,j.5a());1b k=j.1q/100;1b s=1g a();s.8f(r.x,r.y);s.3A(k,k);s.8f(-50,0);if(o!==0){s.cz(o,50,l.y)}1a.4C=s.1J();1a.5P().4C=s.1J()},hU:1c(l,p){if(l.1q===0||l.1p===0){1d}1b n=1a.1N.qi;1b j=l.1q/n.1q;1b o=l.1p/n.1p;1b k=1g a();k.8f(l.x-l.1q/2,l.y-l.1p/2);k.3A(j,o);k.8f(l.1q/j-n.x-n.1q/2,l.1p/o-n.y-n.1p/2);if(1a.1N.fC>0){k.cz(1a.1N.fC,n.x+n.1q/2,n.y+n.1p/2)}if(p!==0){k.cz(p,n.x+n.1q/2,n.y+n.1p/2)}1a.4C=k.1J();1a.5P().4C=k.1J();if(1a.Bb){1b k=1g a();k.3A(1/j,1/o);1a.MG=k;1a.Az=1g c(0,0,l.1q,l.1p)}1a.aK=1j;1a.8w=1a.8w||1a.1N.2Y.8w||"#4T";1a.7O=1a.7O||1a.1N.2Y.7O||"#pO";1a.gU=1a.gU||1a.1N.2Y.gU||"#4T";1a.jk=1a.jk||1a.1N.2Y.jk||"4l";1a.nO=1a.1N.2Y.nO||"#4T";1a.nM=1a.1N.2Y.nM||"#4T"},pB:1c(j){if(j!=1j){1b n=["M","L","B","Q","A","Z","C","E","R","U"];1b l=0;2L(l<n.1f){1b k=n[l];j=j.Yz(1g Yy(k,"g"),":"+k);l++}1b o=j.f3(":");1d o.MC(YD)}1d[]},5P:1c(){if(!1a.9s){1a.Be()}1d 1a.9s},Be:1c(){1a.9s=1g d(1a.1N.2Y.1L||"")},2s:1c(j){1b k;56(j){1T f.4D:1d 1j;1T f.ky:1T f.h5:k=1a.eu;1Q;1T f.ha:k=1a.ql;1Q;aL:k=1a.nU[j-f.h9];1Q}1d 1g c(k.nW,k.nV,k.pK-k.nW,k.pJ-k.nV)},qm:1c(){1d{nW:3W.5s,nV:3W.5s,pK:0,pJ:0}},bE:1c(j,n){1b l=1j;56(1a.8d){1T f.4D:1d;1T f.ky:1T f.h5:l=1a.eu;1Q;1T f.ha:l=1a.ql;1Q;aL:1b k=1a.8d-f.h9;l=1a.nU[k];1Q}if(!l){1d}l.nW=1s.2b(l.nW,j);l.nV=1s.2b(l.nV,n);l.pK=1s.1U(l.pK,j);l.pJ=1s.1U(l.pJ,n)},eG:1c(){56(1a.8d){1T f.4D:1d 1j;1T f.ky:1T f.h5:1d 1a.Bf;1T f.ha:1d 1a.Bg;aL:1d 1a.pI[1a.8d-f.h9]}},Mx:1c(j){1d 1e.1i.1A.7g(j,1a.7O||"#pO",1a.2s(f.h5))},MA:1c(j){1d 1e.1i.1A.7g(j,1a.8w||"#4T",1a.2s(f.h5),1m)},M7:1c(j){1d 1e.1i.1A.7g(j,1a.jk||"4l",1a.2s(f.ha))},M4:1c(j){1d 1e.1i.1A.7g(j,1a.gU||"#4T",1a.2s(f.ha),1m)},M8:1c(k,j){1d 1e.1i.1A.7g(k,1a.1N.2Y.4h[j].1V||1a.nM||"#4T",1a.2s(f.h9+j))},Ma:1c(k,j){1d 1e.1i.1A.7g(k,(1a.1N.2Y.4h[j].2j?1a.1N.2Y.4h[j].2j.1V:(1a.nO||"#4T")),1a.2s(f.h9+j),1m)},M9:1c(){1a.8d=f.4D;if(1a.1N.2Y.1L){1a.8d=f.h5;1a.kl(1a.pB(1a.1N.2Y.1L))}if(1a.1N.2Y.2P){1a.8d=f.ha;1a.kl(1a.pB(1a.1N.2Y.2P))}if(1a.1N.2Y.4h){1k(1b j=0;j<1a.1N.2Y.4h.1f;j++){1a.8d=f.h9+j;1a.kl(1a.pB(1a.1N.2Y.4h[j].2W))}}},4P:1c(j){1a.1N=j;1a.LX();1a.Be()},kl:1c(j){e.kl(j,1a)},6V:1c(j,l){1b k=1a.eG();if(!k){1d}k.1h({eJ:"6V",7c:[j,l]});1a.bE(j,l)},3D:1c(j,l){1b k=1a.eG();if(!k){1d}k.1h({eJ:"3D",7c:[j,l]});1a.bE(j,l)},Es:1c(o,q,l,p,j,n){1b k=1a.eG();if(!k){1d}k.1h({eJ:"Yx",7c:[o,q,l,p,j,n]});1a.bE(o,q);1a.bE(l,p);1a.bE(j,n)},E2:1c(k,s,j,o,n,q){1b l=1a.eG();if(!l){1d}l.1h({eJ:"cJ",7c:[k,s,j,o,n,q]});1b p=+j;1a.bE(+k-p,+s-p);1a.bE(+k+p,+s+p)},kp:1c(l,n,j,o){1b k=1a.eG();if(!k){1d}k.1h({eJ:"kp",7c:[l,n,j,o]});1a.bE(l,n);1a.bE(j,o)},nP:1c(n,p,l,o,j){1b k=1a.eG();if(!k){1d}k.1h({eJ:"nP",7c:[n,p,l,o,j]});1a.Bb=1m;1a.bE(n,p);1a.bE(l,o)},hT:1c(){1b j=1a.eG();if(!j){1d}j.1h({eJ:"Mi",7c:1j})}};1e.1Z(h,"1e.1i.b8");1b f={4D:-1,ky:0,h5:1,ha:2,h9:3}})(1e.1i);1e.1i.1M=1c(){};1e.1i.1M.Bc=1c(){1d 1e.1i.1D.1I("Bc")};1e.1i.1M.Bd=1c(){1d 1e.1i.1D.1I("Bd")};1e.1i.1M.oh=1c(){1d 1e.1i.1D.1I("oh")};1e.1i.1M.Bi=1c(){1d 1e.1i.1D.1I("Bi")};1e.1i.1M.Bn=1c(){1d 1e.1i.1D.1I("Bn")};1e.1i.1M.Bo=1c(){1d 1e.1i.1D.1I("Bo")};1e.1i.1M.Bp=1c(){1d 1e.1i.1D.1I("Bp")};1e.1i.1M.Bm=1c(){1d 1e.1i.1D.1I("Bm")};1e.1i.1M.Bj=1c(){1d 1e.1i.1D.1I("Bj")};1e.1i.1M.Bk=1c(){1d 1e.1i.1D.1I("Bk")};1e.1i.1M.Bl=1c(){1d 1e.1i.1D.1I("Bl")};1e.1i.1M.Ba=1c(){1d 1e.1i.1D.1I("Ba")};1e.1i.1M.pk=1c(){1d 1e.1i.1D.1I("pk")};1e.1i.1M.AZ=1c(){1d 1e.1i.1D.1I("AZ")};1e.1i.1M.oV=1c(){1d 1e.1i.1D.1I("oV")};1e.1i.1M.B0=1c(){1d 1e.1i.1D.1I("B0")};1e.1i.1M.B1=1c(){1d 1e.1i.1D.1I("B1")};1e.1i.1M.AY=1c(){1d 1e.1i.1D.1I("AY")};1e.1i.1M.AV=1c(){1d 1e.1i.1D.1I("AV")};1e.1i.1M.AW=1c(){1d 1e.1i.1D.1I("AW")};1e.1i.1M.AX=1c(){1d 1e.1i.1D.1I("AX")};1e.1i.1M.B2=1c(){1d 1e.1i.1D.1I("B2")};1e.1i.1M.B7=1c(){1d 1e.1i.1D.1I("B7")};1e.1i.1M.B8=1c(){1d 1e.1i.1D.1I("B8")};1e.1i.1M.B9=1c(){1d 1e.1i.1D.1I("B9")};1e.1i.1M.B6=1c(){1d 1e.1i.1D.1I("B6")};1e.1i.1M.B3=1c(){1d 1e.1i.1D.1I("B3")};1e.1i.1M.B4=1c(){1d 1e.1i.1D.1I("B4")};1e.1i.1M.B5=1c(){1d 1e.1i.1D.1I("B5")};1e.1i.1M.zH=1c(){1d 1e.1i.1D.1I("zH")};1e.1i.1M.zI=1c(){1d 1e.1i.1D.1I("zI")};1e.1i.1M.zJ=1c(){1d 1e.1i.1D.1I("zJ")};1e.1i.1M.zG=1c(){1d 1e.1i.1D.1I("zG")};1e.1i.1M.zD=1c(){1d 1e.1i.1D.1I("zD")};1e.1i.1M.zE=1c(){1d 1e.1i.1D.1I("zE")};1e.1i.1M.zF=1c(){1d 1e.1i.1D.1I("zF")};1e.1i.1M.zK=1c(){1d 1e.1i.1D.1I("zK")};1e.1i.1M.zP=1c(){1d 1e.1i.1D.1I("zP")};1e.1i.1M.zQ=1c(){1d 1e.1i.1D.1I("zQ")};1e.1i.1M.zR=1c(){1d 1e.1i.1D.1I("zR")};1e.1i.1M.aJ=1c(){1d 1e.1i.1D.1I("aJ")};1e.1i.1M.zO=1c(){1d 1e.1i.1D.1I("zO")};1e.1i.1M.zL=1c(){1d 1e.1i.1D.1I("zL")};1e.1i.1M.zM=1c(){1d 1e.1i.1D.1I("zM")};1e.1i.1M.zr=1c(){1d 1e.1i.1D.1I("zr")};1e.1i.1M.zs=1c(){1d 1e.1i.1D.1I("zs")};1e.1i.1M.zq=1c(){1d 1e.1i.1D.1I("zq")};1e.1i.1M.jX=1c(){1d 1e.1i.1D.1I("jX")};1e.1i.1M.zn=1c(){1d 1e.1i.1D.1I("zn")};1e.1i.1M.zo=1c(){1d 1e.1i.1D.1I("zo")};1e.1i.1M.zp=1c(){1d 1e.1i.1D.1I("zp")};1e.1i.1M.zu=1c(){1d 1e.1i.1D.1I("zu")};1e.1i.1M.zz=1c(){1d 1e.1i.1D.1I("zz")};1e.1i.1M.uA=1c(){1d 1e.1i.1D.1I("uA")};1e.1i.1M.zA=1c(){1d 1e.1i.1D.1I("zA")};1e.1i.1M.pi=1c(){1d 1e.1i.1D.1I("pi")};1e.1i.1M.zB=1c(){1d 1e.1i.1D.1I("zB")};1e.1i.1M.zx=1c(){1d 1e.1i.1D.1I("zx")};1e.1i.1M.zS=1c(){1d 1e.1i.1D.1I("zS")};1e.1i.1M.Ae=1c(){1d 1e.1i.1D.1I("Ae")};1e.1i.1M.Af=1c(){1d 1e.1i.1D.1I("Af")};1e.1i.1M.Ag=1c(){1d 1e.1i.1D.1I("Ag")};1e.1i.1M.Ad=1c(){1d 1e.1i.1D.1I("Ad")};1e.1i.1M.Aa=1c(){1d 1e.1i.1D.1I("Aa")};1e.1i.1M.pq=1c(){1d 1e.1i.1D.1I("pq")};1e.1i.1M.Ab=1c(){1d 1e.1i.1D.1I("Ab")};1e.1i.1M.nv=1c(){1d 1e.1i.1D.1I("nv")};1e.1i.1M.Ac=1c(){1d 1e.1i.1D.1I("Ac")};1e.1i.1M.Ah=1c(){1d 1e.1i.1D.1I("Ah")};1e.1i.1M.Am=1c(){1d 1e.1i.1D.1I("Am")};1e.1i.1M.An=1c(){1d 1e.1i.1D.1I("An")};1e.1i.1M.Ao=1c(){1d 1e.1i.1D.1I("Ao")};1e.1i.1M.Al=1c(){1d 1e.1i.1D.1I("Al")};1e.1i.1M.Ai=1c(){1d 1e.1i.1D.1I("Ai")};1e.1i.1M.Aj=1c(){1d 1e.1i.1D.1I("Aj")};1e.1i.1M.Ak=1c(){1d 1e.1i.1D.1I("Ak")};1e.1i.1M.A9=1c(){1d 1e.1i.1D.1I("A9")};1e.1i.1M.zX=1c(){1d 1e.1i.1D.1I("zX")};1e.1i.1M.zY=1c(){1d 1e.1i.1D.1I("zY")};1e.1i.1M.zT=1c(){1d 1e.1i.1D.1I("zT")};1e.1i.1M.zU=1c(){1d 1e.1i.1D.1I("zU")};1e.1i.1M.zV=1c(){1d 1e.1i.1D.1I("zV")};1e.1i.1M.A1=1c(){1d 1e.1i.1D.1I("A1")};1e.1i.1M.A6=1c(){1d 1e.1i.1D.1I("A6")};1e.1i.1M.A7=1c(){1d 1e.1i.1D.1I("A7")};1e.1i.1M.A8=1c(){1d 1e.1i.1D.1I("A8")};1e.1i.1M.A2=1c(){1d 1e.1i.1D.1I("A2")};1e.1i.1M.A4=1c(){1d 1e.1i.1D.1I("A4")};1e.1i.1M.Bq=1c(){1d 1e.1i.1D.1I("Bq")};1e.1i.1M.CS=1c(){1d 1e.1i.1D.1I("CS")};1e.1i.1M.CT=1c(){1d 1e.1i.1D.1I("CT")};1e.1i.1M.CQ=1c(){1d 1e.1i.1D.1I("CQ")};1e.1i.1M.CN=1c(){1d 1e.1i.1D.1I("CN")};1e.1i.1M.CO=1c(){1d 1e.1i.1D.1I("CO")};1e.1i.1M.CP=1c(){1d 1e.1i.1D.1I("CP")};1e.1i.1M.CU=1c(){1d 1e.1i.1D.1I("CU")};1e.1i.1M.CZ=1c(){1d 1e.1i.1D.1I("CZ")};1e.1i.1M.Or=1c(){1d 1e.1i.1D.1I("Or")};1e.1i.1M.D0=1c(){1d 1e.1i.1D.1I("D0")};1e.1i.1M.ps=1c(){1d 1e.1i.1D.1I("ps")};1e.1i.1M.pr=1c(){1d 1e.1i.1D.1I("pr")};1e.1i.1M.D1=1c(){1d 1e.1i.1D.1I("D1")};1e.1i.1M.CY=1c(){1d 1e.1i.1D.1I("CY")};1e.1i.1M.CV=1c(){1d 1e.1i.1D.1I("CV")};1e.1i.1M.CW=1c(){1d 1e.1i.1D.1I("CW")};1e.1i.1M.CX=1c(){1d 1e.1i.1D.1I("CX")};1e.1i.1M.CM=1c(){1d 1e.1i.1D.1I("CM")};1e.1i.1M.CB=1c(){1d 1e.1i.1D.1I("CB")};1e.1i.1M.CC=1c(){1d 1e.1i.1D.1I("CC")};1e.1i.1M.pd=1c(){1d 1e.1i.1D.1I("pd")};1e.1i.1M.6h=1c(){1d 1e.1i.1D.1I("6h")};1e.1i.1M.py=1c(){1d 1e.1i.1D.1I("py")};1e.1i.1M.pn=1c(){1d 1e.1i.1D.1I("pn")};1e.1i.1M.pl=1c(){1d 1e.1i.1D.1I("pl")};1e.1i.1M.ph=1c(){1d 1e.1i.1D.1I("ph")};1e.1i.1M.oZ=1c(){1d 1e.1i.1D.1I("oZ")};1e.1i.1M.iy=1c(){1d 1e.1i.1D.1I("iy")};1e.1i.1M.CD=1c(){1d 1e.1i.1D.1I("CD")};1e.1i.1M.CA=1c(){1d 1e.1i.1D.1I("CA")};1e.1i.1M.pj=1c(){1d 1e.1i.1D.1I("pj")};1e.1i.1M.Cx=1c(){1d 1e.1i.1D.1I("Cx")};1e.1i.1M.Cy=1c(){1d 1e.1i.1D.1I("Cy")};1e.1i.1M.Cz=1c(){1d 1e.1i.1D.1I("Cz")};1e.1i.1M.CE=1c(){1d 1e.1i.1D.1I("CE")};1e.1i.1M.CJ=1c(){1d 1e.1i.1D.1I("CJ")};1e.1i.1M.CK=1c(){1d 1e.1i.1D.1I("CK")};1e.1i.1M.oY=1c(){1d 1e.1i.1D.1I("oY")};1e.1i.1M.CL=1c(){1d 1e.1i.1D.1I("CL")};1e.1i.1M.ou=1c(){1d 1e.1i.1D.1I("ou")};1e.1i.1M.CF=1c(){1d 1e.1i.1D.1I("CF")};1e.1i.1M.CG=1c(){1d 1e.1i.1D.1I("CG")};1e.1i.1M.CH=1c(){1d 1e.1i.1D.1I("CH")};1e.1i.1M.D2=1c(){1d 1e.1i.1D.1I("D2")};1e.1i.1M.Dn=1c(){1d 1e.1i.1D.1I("Dn")};1e.1i.1M.Do=1c(){1d 1e.1i.1D.1I("Do")};1e.1i.1M.Dp=1c(){1d 1e.1i.1D.1I("Dp")};1e.1i.1M.Dj=1c(){1d 1e.1i.1D.1I("Dj")};1e.1i.1M.Dk=1c(){1d 1e.1i.1D.1I("Dk")};1e.1i.1M.Dl=1c(){1d 1e.1i.1D.1I("Dl")};1e.1i.1M.Dq=1c(){1d 1e.1i.1D.1I("Dq")};1e.1i.1M.Dv=1c(){1d 1e.1i.1D.1I("Dv")};1e.1i.1M.1n={};1e.1Z(1e.1i.1M,"1e.1i.1M");(1c(b){1b a=b.1X=1c(d){1o.2u(a,1a);if(d){1a.1V=d.1V;1a.5V=d.5V;1a.3P=d.3P;1a.2v=d.2v;1a.3f=d.3f;1a.2D=d.2D;1a.6J=d.6J;1a.6q=d.6q;1a.9B=d.9B;1a.4t=d.4t;1a.2I=[];if(d.2I){1a.2I=d.2I.6t(0)}if(d.5e){1k(1b e=0,c=d.5e.1f;e<c;e++){if(d.5e[e]==1j){1a.2I.1h(1j);2t}1b g=1o.e7(d.5e[e].lg);if(g){1b f=1g g(1a);f.2E(d.5e[e]);1a.2I.1h(f)}}}}};a.1n={aA:1c(){1d 1a.4L.8s},2E:1c(e){1a.1V=e.1V;1a.5V=e.5V;1a.3P=e.3P;1a.2v=e.2v;1a.3f=e.3f;1a.2D=e.2D;1a.6J=e.6J;1a.6q=e.6q;1a.9B=e.9B;1a.4t=e.4t;1a.2I=[];if(e.5e){1k(1b d=0,c=e.5e.1f;d<c;d++){if(e.5e[d]==1j){1a.2I.1h(1j);2t}1b g=1o.e7(e.5e[d].lg);if(g){1b f=1g g(1a);f.2E(e.5e[d]);1a.2I.1h(f)}}}},2k:1c(){1b e={1V:1a.1V,5V:1a.5V,3P:1a.3P,2v:1a.2v,3f:1a.3f,2D:1a.2D,6J:1a.6J,6q:1a.6q,9B:1a.9B,4t:1a.4t};1b f=[];if(1a.2I){1k(1b d=0,c=1a.2I.1f;d<c;d++){if(1a.2I[d]==1j){f.1h(1j)}1l{f.1h(1a.2I[d].2k())}}}e.5e=f;1d e},4E:1c(e,d){if(1a.Dd()){1b c=d.2m("cD",e);c.2X("b4","Dw");d.aW(1a.6J,"8J",c).2X("6n","1")}if(1a.BL()){1b c=d.2m("cD",e);c.2X("b4","Dx");d.4W(1a.6q,"8J",c).2X("6n","6")}if(1a.BN()){1b c=d.2m("cD",e);c.2X("b4","Du");d.3m(1a.9B,"8J",c).2X("6n","8")}if(1a.u5()){1b c=d.2m("cD",e);c.2X("b4","cR");1a.6I(1a.1V,c,d).2X("6n","100")}if(1a.Dt()){1b c=d.2m("cD",e);c.2X("b4","sQ");1a.6I(1a.3P,c,d).2X("6n","100")}if(1a.Di()){1b c=d.2m("cD",e);c.2X("b4","sP");d.4W(1a.2v,"8J",c).2X("6n","6")}if(1a.D3()){1b c=d.2m("cD",e);c.2X("b4","lU");d.3m(1a.3f,"8J",c).2X("6n","8")}if(1a.BH()){1b c=d.2m("cD",e);c.2X("b4","sT");1a.6I(1a.4t,c,d).2X("6n","100")}if(1a.D4()){1b c=d.2m("cD",e);c.2X("b4","hl");1a.6I(1a.2D,c,d).2X("6n","100")}if(1a.ue()){1b c=d.2m("cD",e);c.2X("b4","fY");1a.uF(c,d)}},4f:1c(g,f){1b h=g.4K("cD");1k(1b e=0;e<h.1f;e++){1b c=h[e];1b d=c.3c("b4");56(d){1T"Dw":1a.6J=f.7W("8J",c);1Q;1T"Dx":1a.6q=f.4G("8J",c);1Q;1T"Du":1a.9B=f.2Q("8J",c);1Q;1T"cR":1a.1V=1a.6p(c,f);1Q;1T"sQ":1a.3P=1a.6p(c,f);1Q;1T"sP":1a.2v=f.4G("8J",c);1Q;1T"lU":1a.3f=f.2Q("8J",c);1Q;1T"sT":1a.4t=1a.6p(c,f);1Q;1T"hl":1a.2D=1a.6p(c,f);1Q;1T"fY":1a.uQ(c,f);1Q}}},6I:1c(c,e,d){1b f=d.2m("8J",e);d.6I(c,"cR",f);1d f},6p:1c(d,c){1b e=c.9x("8J",d);1d c.6p("cR",e)},uF:1c(j,g){1b f=g.2m("8J",j).2X("6n","105");1b h=g.2m("Wj",f);1k(1b e=0;e<1a.2I.1f;e++){1b d=g.2m("ih",h);1b k=g.2m("8J",d).2X("6n","103");1b c=1a.2I[e];g.uD(c,"g0",k)}},uQ:1c(g,f){1a.2I=[];1b e=f.9x("8J",g);1b h=e.4K("g0");1k(1b d=0;d<h.1f;d++){1b c=h[d];1a.2I.1h(f.vb(c))}},1J:1c(){1b c=1g 1a.4L();c.1V=1a.1V;c.5V=1a.5V;c.3P=1a.3P;c.2v=1a.2v;c.3f=1a.3f;c.2D=1a.2D;c.6J=1a.6J;c.6q=1a.6q;c.9B=1a.9B;c.4t=1a.4t;if(1a.2I){c.2I=1a.2I.6t(0)}1d c},7g:1c(){1d 1a.1V},4y:1c(c){1a.1V=c},u5:1c(){1d 1a.1V?1m:1u},Ds:1c(){1d 1a.5V},tJ:1c(c){1a.5V=c},VP:1c(){1d 1a.5V?1m:1u},j9:1c(){1d 1a.3P},Co:1c(c){1a.3P=c},Dt:1c(){1d 1a.3P?1m:1u},j6:1c(){1d 1a.2v},Cn:1c(c){1a.2v=c},Di:1c(){1d 1a.2v?1m:1u},D8:1c(){1d 1a.3f},Qz:1c(c){1a.3f=c},D3:1c(){1d 1a.3f!==1v&&1a.3f!==1j},e2:1c(){1d 1a.2D},dS:1c(c){1a.2D=c},D4:1c(){1d 1a.2D?1m:1u},iD:1c(){1d 1a.6J},mC:1c(c){1a.6J=c},Dd:1c(){1d 1a.6J?1m:1u},il:1c(){1d 1a.6q},n2:1c(c){1a.6q=c},BL:1c(){1d 1a.6q?1m:1u},ON:1c(){1d 1a.9B},W5:1c(c){1a.9B=c},BN:1c(){1d 1a.9B!==1v&&1a.9B!==1j},BK:1c(){1d 1a.4t},Cm:1c(c){1a.4t=c},BH:1c(){1d 1a.4t!==1v?1m:1u},uf:1c(){1d 1a.2I},W4:1c(c){1a.2I=c},ue:1c(){1d 1a.2I?1m:1u},8v:1c(){if(!fx){fx=1g 1e.5b(a.1n,1j,1a)}1l{fx.5c(1a)}1d fx}};a.bi=1c(c){if(!fx){fx=1g 1e.5b(a.1n)}1l{fx.5c(1j)}1d fx};fx=1j;1e.1Z(a,"1e.1i.1X")})(1e.1i);(1c(a){1b h=1e.2T.5i;1b c=1e.1z.gE;1b f=1e.1z.5k;1b b=1e.1z.2O;1b d=1e.1z.8t;1b g=1e.1i.iQ;1b e=1e.1i.1A;1b k=a.ix=1c(l){a.4c.6z=1m;1o.2u(k,1a,[l]);a.4c.6z=1u};k.1n={1J:1c(){a.4c.6z=1m;1b l=1o.2a(k,1a,"1J",[]);l.tR(1a.BR());a.4c.6z=1u;1d l},2k:1c(){1b l=1o.2a(k,1a,"2k",[]);1b n=1a.BR();if(n){if(n.bK){if(1a.1t.BI){l.BJ=1a.1t.BI(n.bK)}1l{l.BU=n.bK}}1l{l.BO=n.fu}}1d l},2E:1c(l){1o.2a(k,1a,"2E",[l]);1b n=1g 1e.1i.tV();if(l.BJ!=1v){n.bK=1a.1t.aT[l.BJ]}1l{if(l.BO){n.fu=l.BO}1l{if(l.BU){n.bK=l.BU}}}1a.tR(n)},4f:1c(n,l){1o.2a(k,1a,"4f",[n,l]);1b o=1g 1e.1i.tV();1b p=l.IT("BV",n);if(p){o.bK=e.Ov.W3(p)}1b q=l.7W("Oe",n);if(q){o.fu=q}1a.tR(o)},4E:1c(n,l){1o.2a(k,1a,"4E",[n,l]);if(1a.2H.bK){l.VZ(e.Ov.VV(1a.2H.bK),"BV",n)}if(1a.2H.fu){l.aW(1a.2H.fu,"Oe",n)}},tR:1c(n){if(1a.2H!=n){1a.2H=n;if(n){1a.3w=1g 1e.1z.c6(1a.1w);1a.3w.BS=1m;1a.3w.3w.1q=100;1a.3w.3w.1p=100;1o.5N(1a.3w.3w,{kv:1o.3t(1a,1a.eI)});if(1a.2H.bK){1b l="7x:3w/BS+BP;BQ,"+1a.2H.bK;1a.3w.3w.kk=l}1l{if(1a.2H.fu){1a.3w.3w.kk=1a.2H.fu}}}1a.3Y()}},BR:1c(){1d 1a.2H},gd:1c(l){},oB:1c(){1d 1j},8v:1c(){if(!fs){fs=1g 1e.5b(k.1n,1j,1a)}1l{fs.5c(1a)}1d fs}};k.bi=1c(l){if(!fs){fs=1g 1e.5b(k.1n,l)}1l{fs.5c(1j)}1d fs};fs=1j;1e.1Z(k,"1e.1i.ix",a.5m);1b j=a.tV=1c(){};j.1n={kl:1c(l){1a.fu=l},VU:1c(l){1a.bK=l},fu:1j,bK:1j};1e.1Z(j,"1e.1i.tV")})(1e.1i);(1c(a){1b c=1e.1z.5k;1b b=a.Cf=1c(f,e,d,g){1o.2u(b,1a,[f,e,d]);1a.3a=1a.4L.8s;1a.1C=f;1a.2h=e;1a.9W=d;1a.3d={1y:-1,4r:1g 1e.1z.5k(0,0)};if(g===1v){g=-1}1a.2A=g;if(g>-1){1a.3d.2A=f.4S(g)}};b.1n={cx:1c(){if(!1a.3d.2A){if(1a.9W){1a.1C.BG(1a.2h)}1l{1a.1C.Bv(1a.2h)}}1l{if(1a.9W){1a.1C.P9(1a.2A,1a.2h)}1l{1a.1C.P8(1a.2A,1a.2h)}}},cp:1c(){if(!1a.3d.2A){if(1a.9W){1a.1C.Bw(1a.2h)}1l{1a.1C.Bx(1a.2h)}1d}if(1a.9W){1a.1C.Pa(1a.2A,1a.2h)}1l{1a.1C.Pc(1a.2A,1a.2h)}},9H:1c(){1b d=1a.9W?1a.2h.bq():1a.2h.fF();1b g=1a.1C.2f;if(g!==0){1b e=a.1A.5C(1a.1C.1w);d=a.1A.6A(d,e,-g)}1b f=1a.3d.2A?1a.1C.fU(1a.2A):1a.1C.1w;1a.a0=a.1A.jo(d,f)},e3:1c(e){1b h=1a.1C.7J!=a.m9.Bu?1a.1C.uL(e):-1;if(h==-1){1d 1o.2a(b,1a,"e3",[e])}1a.2A=h;1b f=1a.1C.fU(h);1b d=f.x+f.1q/2;1b j=f.y+f.1p/2;1b g={2A:1a.1C.4S(h),4r:e.x>d?1g c(f.2y(),j):1g c(f.3M(),j),6v:e.x>d?1g c(100,50):1g c(0,50),1y:-1};1d g},mb:1c(d){if(1a.3d&&1a.3d.2A){1b f=1a.1C.2s();1b e=1a.1C.fU(1a.2A).4e();if(d.x<e.x){1a.3d.4r=1g c(f.x,e.y)}1l{1a.3d.4r=1g c(f.2y(),e.y)}}1l{1o.2a(b,1a,"mb",[d])}},ug:1c(e,d){if(e==1a.1C){1d 1a.1C.uL(d)!=1a.2A}1d 1o.2a(b,1a,"ug",[e,d])},VT:1c(){if(1a.3d&&1a.3d.2A){1d 1a.3d.2A}1d 1j},dI:1c(){1d 1a.3d.2A?1a.1C.fU(1a.2A).4e():1o.2a(b,1a,"dI",[])},bN:1c(f,e){1b d=1a.1C;if(1a.2A!=-1){1d d.Pb(1a.2A,f,e)}1d d.bN(f,e)},bq:1c(){1b h=1a.a0;1b f=1a.3d.2A?1a.1C.fU(1a.2A):1a.1C.1w;1b d=a.1A.iB(h,f);d.x=1s.2b(d.x,1a.1C.1w.2y());d.y=1s.2b(d.y,1a.1C.1w.2V());1b g=1a.1C.2f;if(g!==0){1b e=a.1A.5C(1a.1C.1w);d=a.1A.6A(d,e,g)}1d d},cZ:1c(e,d){if(1a.2A!=e){if(d){1a.cp()}1a.2A=e;1a.3d.2A=1a.1C.4S(e);if(d){1a.cx();if(1a.9W){1a.2h.Br()}1l{1a.2h.Bt()}}}}};1e.1Z(b,"1e.1i.Cf",a.u9)})(1e.1i);(1c(b){1b l=1e.2T.5i;1b f=1e.1z.gE;1b g=1e.1z.VY;1b j=1e.1z.5k;1b c=1e.1z.2O;1b h=1e.1z.8t;1b a=1e.1z.5t;1b e=1e.1z.bX;1b k=1e.1i.iQ;1b d=b.cg=1c(n){b.4c.6z=1m;1o.2u(d,1a,[n]);1a.2R=6;1a.1K.gG=1m;1a.1K.4p=b.3q.4H;1a.2C=1g 1e.2T.mr(1,1);1a.2U=[1a.uZ()];1a.4g=[1a.v2()];1a.4U=0;1a.7J=b.m9.BA;b.4c.6z=1u;1a.8i=b.io.Cp;1a.aC=1u;1a.aP=1u};d.1n={1J:1c(){b.4c.6z=1m;1b s=1o.2a(d,1a,"1J",[]);s.2R=1a.2R;s.4U=1a.4U;s.7J=1a.7J;s.7V=1a.7V;s.7l=1a.7l;s.oT(1a.kO());s.1N=1a.1N;s.8i=1a.8i;s.gR(1a.dz());s.aC=1a.aC;s.aP=1a.aP;s.2C=1a.2C.1J();s.2U=1a.2U.6t(0);1k(1b o=0;o<s.2U.1f;o++){1b p=s.2U[o];if(p){s.2U[o]=1a.Cl(p)}}s.4g=1a.4g.6t(0);1k(1b q=0;q<s.4g.1f;q++){1b n=s.4g[q];if(n){s.4g[q]=1a.ts(n)}}b.4c.6z=1u;1d s},2k:1c(){1b n=1o.2a(d,1a,"2k",[]);n.2R=1a.2R;n.4U=1a.4U;n.7J=1a.7J;n.7V=1a.7V;n.7l=1a.7l;n.v9=1a.kO();n.8i=1a.8i;n.cu=1a.dz();n.aC=1a.C2();n.aP=1a.Ch();n.1N=1a.1N;n.2U=[];1k(1b p=0;p<1a.2C.2U;p++){1b q=1a.4S(p);n.2U[p]={1p:q.1p}}n.4g=[];1k(1b s=0;s<1a.2C.4g;s++){1b o=1a.6c(s);n.4g[s]=1a.ts(o)}n.2C=[];1k(1b p=0;p<1a.2C.2U;p++){1k(1b s=0;s<1a.2C.4g;s++){n.2C.1h(1a.8p(s,p).2k())}}1d n},2E:1c(o){1o.2a(d,1a,"2E",[o]);1a.2R=o.2R;1a.4U=o.4U;1a.7J=o.7J;1a.7V=o.7V;if(o.7l){1a.7l=h.bC(o.7l)}1a.oT(o.v9);if(o.8i!==1v){1a.8i=o.8i}1a.gR(o.cu);if(o.aC){1a.uT(o.aC)}if(o.aP){1a.v0(o.aP)}if(o.1N){1a.4P(o.1N)}1a.2U=[];1k(1b p=0;p<o.2U.1f;p++){1a.2U[p]=1a.Cl(o.2U[p])}1a.4g=[];1k(1b q=0;q<o.4g.1f;q++){1a.4g[q]=1a.ts(o.4g[q])}1a.2C=1g 1e.2T.mr(o.4g.1f,o.2U.1f);1b n=0;1k(1b p=0;p<1a.2C.2U;p++){1k(1b q=0;q<1a.2C.4g;q++){1a.8p(q,p).2E(o.2C[n++])}}},4f:1c(v,n){1o.2a(d,1a,"4f",[v,n]);if(1a.6g()==""){1a.6Q(n.7W("IW",v))}1a.gR(n.3U("sY",v));1a.2R=n.4G("ru",v);1a.7V=n.6p("Ou",v);1b w=n.o3("J6",v);if(w){1a.6x(w.nY);1a.6F(w.4p)}1l{1a.6x(n.2Q("gk",v));1a.6F(n.2Q("gh",v))}1a.1N=n.2Q("1D",v,b.dt.6h);1a.7J=n.2Q("m9",v,1a.7J);1a.8i=n.2Q("io",v,1a.8i);1a.4U=n.2Q("Ot",v);1a.oT(n.3U("Om",v));1a.uT(n.3U("Oo",v));1a.v0(n.3U("On",v));1b p=v.4K("Pn");1b t=v.4K("q6");1b o=v.4K("d2");if(p.1f*t.1f!=o.1f){4R 1g VX("eS ik of 5y lE Da cB VW h7 ik of 2U Ww 4g in h7 7f.")}1a.Pr(t.1f,p.1f);1k(1b r=0;r<p.1f;++r){1a.4S(r).1p=n.4G("Pm",p[r])}1k(1b r=0;r<t.1f;++r){1a.6c(r).1q=n.4G("D7",t[r]);1a.6c(r).aD=n.2Q("hO",t[r])}1b s=0;1k(1b r=0;r<p.1f;++r){1k(1b q=0;q<t.1f;++q){1b u=1a.8p(q,r);u.4f(o[s++],n)}}},4E:1c(A,o){1o.2a(d,1a,"4E",[A,o]);o.3O(1a.dz(),"sY",A);o.4W(1a.2R,"ru",A);o.6I(1a.7V,"Ou",A);o.3m(1a.8F(),"gk",A);o.3m(1a.9c(),"gh",A);o.3m(1a.1N,"1D",A);o.3m(1a.7J,"m9",A);o.3m(1a.8i,"io",A);o.3m(1a.4U,"Ot",A);o.3O(1a.kO(),"Om",A);o.3O(1a.C2(),"Oo",A);o.3O(1a.Ch(),"On",A);1b u=o.2m("X4",A);1k(1b t=0;t<1a.2U.1f;t++){1k(1b r=0;r<1a.4g.1f;r++){1b w=o.2m("d2",u);1b z=1a.8p(r,t);z.4E(w,o)}}1b v=o.2m("BA",A);1k(1b t=0;t<1a.2U.1f;t++){1b s=o.2m("Pn",v);1b B=1a.4S(t);o.4W(B.1p,"Pm",s)}1b n=o.2m("X9",A);1k(1b t=0;t<1a.4g.1f;t++){1b p=o.2m("q6",n);1b q=1a.6c(t);o.4W(q.1q,"D7",p);o.3m(q.aD,"hO",p)}},8p:1c(o,p){1b n=1a.2C.1G(o,p);if(!n){n=1a.Pe();1a.2C.2p(o,p,n)}1d n},Pe:1c(){1b n=1g b.d2();n.1t=1a;1d n},4S:1c(o){if(o>=1a.2U.1f){1d 1v}1b n=1a.2U[o];if(!n){n=1a.uZ();1a.2U[o]=n}1d n},jP:1c(o,n){1b p;if(5G o==="ik"){p=o;o=1a.4S(o)}if(o.1p==n){1d}o.1p=n;1a.me(p||l.6r(1a.2U,o));1a.1F()},uZ:1c(){1d{1p:6,8B:[],8y:[]}},Cl:1c(n){1d{1p:n.1p,8B:[],8y:[]}},6c:1c(n){1b o=1a.4g[n];if(!o){o=1a.v2();1a.4g[n]=o}1d o},jC:1c(n,o){if(5G n==="ik"){n=1a.6c(n)}if(n.1q==o){1d}n.1q=o;1a.m7();1a.1F()},mm:1c(n,o){if(5G n==="ik"){n=1a.6c(n)}if(n.aD==o){1d}n.aD=o;1a.m7();1a.1F()},v2:1c(){1d{1q:18,aD:b.hO.Ci}},ts:1c(n){1d{1q:n.1q,aD:n.aD}},fV:1c(o){1a.1t=o;1k(1b n=0;n<1a.2C.2U;n++){1k(1b p=0;p<1a.2C.4g;p++){1a.8p(p,n).1t.1t=o}}},2M:1c(n){1b o=1a.6N();if(!o.2M(n)){1d 1u}if(b.1A.ry(n,1a.5P())){1d 1m}if(1a.6B&&1a.8c(n)){1d 1m}1d 1u},5P:1c(){if(1a.4n.f5){1a.eW();1a.4n.f5=1j}1b n=[];n.1h(1a.1w.5a());n.1h(1a.1w.a7());n.1h(1a.1w.9Z());n.1h(1a.1w.aR());b.1A.cU(n,b.1A.5C(1a.1w),1a.2f);1d n},eW:1c(){if(1a.mh){1a.mh=1u;if(1a.3k){1a.3k.5D()}}1b w=1a.4n.2H=[];1b L=1a.aI();1b F=1a.9k();1b U=1a.bz();1b X=1a.gr();1b p={1V:X,dE:k.l4};1a.eN(w,p);if(p.1V){X=p.1V}1a.4n.2f=1a.2f;1a.4n.IP=1a.1w.4e();1b N=1a.1w.1J();1b n=N;if(1a.1N==b.dt.ln){1b B=a.3h(1a.1t.2o);1b Y=B*2.5;n=1g e();n.IL(N,Y)}1b K=n.1J();K.2j=1j;K.1V=X;K.aK=1a.dA();w.1h(K);N=N.1J();N.1p=1a.2R;if(1a.7V){1b Z=N.1J();Z.1V=1a.7V;Z.2j=1j;if(1a.1N==b.dt.ln){1b z=1g 1e.1z.jc();z.iU=n;z.2H.1h(Z);w.1h(z)}1l{w.1h(Z)}}1a.eN(w,{dE:k.k4});1a.1K.3g(N,0);1a.1K.2i=1a.7l?1a.7l:1a.c8();1a.1K.2j=1a.9R();1a.1K.3P=1a.gB();1a.1K.2v=1a.iL();1a.1K.o6=1a.2f!=0;w.1h(1a.1K);1b H=1g 1e.1z.jc();H.iU=n;w.1h(H);1b aa=1a.2C.2U;1b E=1a.2C.4g;1b R=N.2V();1b C=1u;1b V=1a.dz();1a.m7();1k(1b W=1a.4U;W<aa;W++){1b s=1a.4S(W).1p;1b I=W==aa-1||R+s>1a.1w.2V();1b S=N.x;1k(1b ac=0;ac<E;ac++){1b D=ac==E-1;1b M=1a.8p(ac,W);1b J=1a.6c(ac).1q;if(J<=0){2t}1b T=M.9p>1||M.8Y>1;if(T&&!C){1a.Cc();C=1m}if(D){J+=N.2y()-(S+J)}1b O=1g c(S,R,J,s);if(T){1b v=1a.Bh(ac,W);O.1q=v.1q;O.1p=v.1p}S+=J;1b ab=!(C&&M.Cb);if(ab){if(M.1V){1b G=O.1J();G.2j=1j;G.1V=M.1V;H.2H.1h(G)}1b t=M.3w;if(t){1b P=a.fK(1a.1t.2o);1b Q={x:t.3w.1q*P,y:t.3w.1p*P};1b q=b.1A.Pv(O,Q,M.kr());t.3g(q,0);H.2H.1h(t)}if(M.1K){M.1K.3g(O);M.1K.2i=M.2i?M.2i:1a.c8();M.1K.gG=1m;M.1K.2j=M.2D?M.2D:1a.9R();M.1K.3P=1a.gB();M.1K.2v=1a.iL();M.1K.o6=1a.2f!=0;M.1K.cu=V;M.1K.X8=V;H.2H.1h(M.1K)}if(1a.8i==b.io.Cp){if(!D){1b o=1g f(O.2y(),O.y,O.2y(),O.2V());o.5o(L);o.3f=U;H.2H.1h(o)}1b ad=1g f(O.x,O.2V(),O.2y(),O.2V());ad.5o(L);ad.3f=U;H.2H.1h(ad)}if(1a.8i==b.io.BY){1b A=1g g(O);H.2H.1h(A)}}if(S>N.2y()){1Q}}R+=s;if(R>1a.1w.2V()){1Q}}n.2j=L;n.2v=F;n.3f=U;n.1V=1j;w.1h(n);N=1a.1w;if(1a.2R>0&&1a.2R<N.1p){1b R=N.y+1a.2R;1b u=1g f(N.x,R,N.2y(),R);u.5o(L);u.2v=F;u.3f=U;if(1a.1N==b.dt.ln&&(R<Y||R>N.1p-Y)){u.AL=n}w.1h(u)}1a.oc(w);if(1a.dD){1a.dD(1a)}},4P:1c(n){if(1a.1N!=n){1a.1N=n;1a.1F()}},gz:1c(){if(1a.1N===1v){1d b.dt.6h}1d 1a.1N},IF:1c(n){if(1a.2R!=n){1a.2R=n;1a.1F()}},cN:1c(){1d 1a.2R},X3:1c(n){if(1a.8i!=n){1a.8i=n;1a.1F()}},WZ:1c(){1d 1a.8i},WY:1c(n){if(1a.7J!=n){1a.7J=n;1a.1F()}},WX:1c(){1d 1a.7J},Pr:1c(n,o){if(o<1a.2U.1f){1a.BZ(o,1a.2U.1f-1)}1a.2C.mi(n,o);1a.2U.1f=o;1a.4g.1f=n;1a.mh=1m;1a.1F()},Pt:1c(n){1a.2C.Pt(n);1a.4g.8O(n,1);1a.1F()},C7:1c(n){1b o=1a.v2();1a.2C.C7(n);1a.4g.8O(n,0,o);1a.1F();1d o},Ps:1c(n){if(n>=1a.2U.1f){1d}1a.BZ(n,n);1a.2C.Ps(n);1a.2U.8O(n,1);1a.Cg(n);1a.me(n);1a.1F()},BX:1c(o){1b n=1a.uZ();1a.2C.BX(o);1a.2U.8O(o,0,n);1a.Cg(o);1a.me(o);1a.mh=1m;1a.1F();1d n},X2:1c(){1d 1a.C7(1a.2C.X1)},X0:1c(){1d 1a.BX(1a.2C.2U)},BZ:1c(t,s){if(1a.1t){1b n=[];1k(1b p=t;p<=s;p++){1b q=1a.2U[p];if(!q){2t}1a.mn(q.8B,n);1a.mn(q.8y,n)}1b o=1a.1t;l.1B(n,1c(r){o.c3(r)})}},kO:1c(){1d 1a.3k?1m:1u},oT:1c(o){1b n=1a.kO();if(n==o){1d}if(o){1a.3k=1a.Gi?1g b.C9(1a):1g b.Ce(1a);1a.oO(1a.3k)}1l{1a.oR(1a.3k);4m 1a.3k}1a.1F()},OU:1c(){1d 1a.4U>0},OW:1c(){1d 1a.4U<1a.2C.2U-1},lT:1c(){1o.2a(d,1a,"lT",[]);if(1a.3k){1a.3k.5D()}},lL:1c(q,n,o,p){1b s=p?1v:1a.uL(n);1b r=1g b.Cf(1a,q,o,s);if(r.3d.2A){r.9H()}1l{r.3d.4d=1a.4d;r.3d.4r=n}1d r},P9:1c(q,p){1b o=1a.4S(q);if(!o){1d}1b n=o.8B;if(!l.2c(n,p)){n.1h(p)}},P8:1c(q,p){1b o=1a.4S(q);if(!o){1d}1b n=o.8y;if(!l.2c(n,p)){n.1h(p)}},Pa:1c(q,p){1b o=1a.4S(q);if(!o){1d}1b n=o.8B;l.3l(n,p)},Pc:1c(q,p){1b o=1a.4S(q);if(!o){1d}1b n=o.8y;l.3l(n,p)},mn:1c(o,n){l.1B(o,1c(p){if(!l.2c(n,p)){n.1h(p)}})},da:1c(n){1o.2a(d,1a,"da",[n]);1k(1b o=0;o<1a.2U.1f;o++){1b p=1a.4S(o);1a.mn(p.8B,n)}},db:1c(n){1o.2a(d,1a,"db",[n]);1k(1b o=0;o<1a.2U.1f;o++){1b p=1a.4S(o);1a.mn(p.8y,n)}},fU:1c(q){1b p=1a.1w.1J();if(q<1a.4U){p.1p=1a.2R;1d p}1b n=1a.1w.y;n+=1a.2R;1k(1b o=1a.4U;o<q;o++){n+=1a.4S(o).1p}1d 1g c(p.x,n,p.1q,1a.4S(q).1p)},uL:1c(n){1b q=n.y-1a.1w.y;if(q<1a.2R||1a.1w.1p<q||1a.2U.1f==0){1d-1}1b p=1a.2R;1k(1b o=1a.4U;o<1a.2U.1f;++o){p+=1a.4S(o).1p;if(q<p){1d o}}1d-1},Pb:1c(p,r,n){1b q=1a.fU(p).4e();1b o=1g j((n.x+r.x)/2,(n.y+r.y)/2);q.x=q.x<o.x?1a.1w.2y():1a.1w.3M();1d q},me:1c(p){1k(1b n=p;n<1a.2U.1f;++n){1b o=1a.4S(n);l.1B(o.8B,1c(q){q.gm();if(q.5Z){q.fp()}});l.1B(o.8y,1c(q){q.gm();if(q.5Z){q.fp()}})}},Cg:1c(p){1k(1b n=p;n<1a.2U.1f;++n){1b o=1a.4S(n);l.1B(o.8B,1c(q){q.2x.2A=n});l.1B(o.8y,1c(q){q.2r.2A=n})}},jz:1c(n){if(n<0){1d}if(n>=1a.2U.1f){1d}1a.4U=n;if(1a.3k){1a.3k.5D()}1a.me(0);1a.mh=1m;1a.1F()},Cd:1c(){1a.jz(1a.4U+1);1a.1F()},Ca:1c(){1a.jz(1a.4U-1);1a.1F(1a)},m7:1c(){1b o=0;1b n=0;1k(1b s=0;s<1a.4g.1f;s++){1b q=1a.6c(s);1b p=q.aD;if(p==b.hO.l3){o++}1l{n+=q.1q}}if(o==0){1d}1b r=(1a.1w.1q-n)/o;1k(1b s=0;s<1a.4g.1f;s++){1b q=1a.6c(s);if(q.aD==b.hO.l3){q.1q=r}}},Cc:1c(){1b u=1a.2C.4g;1b z=1a.2C.2U;1k(1b n=z-1;n>=0;n--){1k(1b s=u-1;s>=0;s--){1b w=1a.8p(s,n);1b q=w.9p;if(!q){q=1}1b t=w.8Y;if(!t){t=1}w.Cb=1u;if(q<=1&&t<=1){2t}1k(1b p=n;p<n+t;p++){1k(1b o=s;o<s+q;o++){if(n==p&&s==o){2t}1b v=1a.8p(o,p);v.Cb=1m}}}}},Bh:1c(p,z){1b u=1a.8p(p,z);1b w=u.9p;if(!w){w=1}1b o=0;1k(1b q=p;q<p+w;q++){o+=1a.6c(q).1q}if(q==1a.2C.4g){1b t=0;1k(1b q=0;q<1a.2C.4g;q++){t+=1a.6c(q).1q}o+=1a.1w.1q-t}1b s=u.8Y;if(!s){s=1}1b v=0;1k(1b n=z;n<z+s;n++){v+=1a.4S(n).1p}1d{1q:o,1p:v}},Gp:1c(C){C=1a.P7(C);1b z=1a.1w.1J();z.1p=1a.2R;1b G=1a.2C.2U;1b w=1a.2C.4g;1b v=z.2V();1b t=1u;1a.m7();1k(1b o=1a.4U;o<G;o++){1b p=1a.4S(o).1p;1b F=o==G-1||v+p>1a.1w.2V();1b A=z.x;1k(1b u=0;u<w;u++){1b E=u==w-1;1b D=1a.8p(u,o);1b s=1a.6c(u).1q;if(s<=0){2t}1b n=D.9p>1||D.8Y>1;if(n&&!t){1a.Cc();t=1m}if(E){s+=z.2y()-(A+s)}1b B=1g c(A,v,s,p);if(n){1b q=1a.Bh(u,o);B.1q=q.1q;B.1p=q.1p}A+=s;if(B.2M(C)){1d{5y:D,Gq:B,3y:u,2A:o}}if(A>z.2y()){1Q}}v+=p;if(v>1a.1w.2V()){1Q}}1d 1j},ni:1c(n){1b o=1a.Gp(n);if(o){1d 1g b.v3(1a,o)}1d 1a},eC:1c(n){1b p=1a.1w.1J();p.1p=1a.2R;if(1a.2f==0){1d p}1l{1b o=1a.iK(1a.1w.1J());1d o.AK(p)}},Xh:1c(n){if(1a.7V!==n){1a.7V=n;1a.1F()}},Xm:1c(){1d 1a.7V},Xg:1c(n){if(1a.7l!==n){1a.7l=n;1a.1F()}},Xb:1c(){1d 1a.7l},gR:1c(n){if(1a.1K.cu!=n){1a.1K.cu=n;1a.1F()}},dz:1c(){1d 1a.1K.cu},7u:1c(o,p){1b n=p.3E["3b:cg"];if(n){if(o.3F(n)){1d n}}1d 1o.2a(d,1a,"7u",[o,p])},GF:1c(o){1b q=1a.1w.1J();if(o>=1a.4g.1f){1d q}1b n=q.3M();1k(1b p=0;p<o;++p){1b r=1a.6c(p);n+=r.1q}q.x=n;q.1q=1a.6c(o).1q;1d q},dr:1c(w){1b u=1o.2a(d,1a,"dr",[w]);if(u!=1j){1d u}1b n=b.1A.oG(1a.1w);1b o=a.3h(1a.1t.2o)*(1a.8i==b.io.BY?2:1);if(1a.9u()!=0){w=b.1A.6A(w,1a.1w.4e(),-1a.9u())}if(1a.aC){1k(1b q=0;q<1a.2C.4g-1;q++){1b r=1a.GF(q);if(r.3M()>=n.2y()){1Q}1b v=r.1J();v.1q=o;v.x=r.2y()-v.1q/2;v.y+=1a.cN();1b s=0;1k(1b p=1a.2U.1f-1;p>=0;p--){s=1a.fU(p).2V();if(s!=0){1Q}}if(s!=0){v.1p=1s.2b(r.2V(),s)-v.y}if(v.2M(w)){1d 1g b.C1(1a,q)}}}if(1a.aP){1k(1b q=1a.4U;q<1a.2C.2U;q++){1b t=1a.fU(q);if(t.3Z()>=n.2V()){1Q}1b v=t.1J();v.1p=o;v.y=t.2V()-v.1p/2;if(v.2M(w)){1d 1g b.C8(1a,q)}}}1d 1j},C2:1c(){1d 1a.aC},uT:1c(n){if(n!=1a.aC){1a.aC=n}},Ch:1c(){1d 1a.aP},v0:1c(n){if(n!=1a.aP){1a.aP=n}},9f:1c(){1b n=1o.2a(d,1a,"9f",[]);n.2R=1a.2R;n.4U=1a.4U;n.7J=1a.7J;n.7V=1a.7V;n.7l=1a.7l;n.v9=1a.kO();n.aC=1a.aC;n.aP=1a.aP;n.2C=1a.2C.1J();1d n},a2:1c(n){1o.2a(d,1a,"a2",[n]);1a.2R=n.2R;1a.4U=n.4U;1a.7J=n.7J;1a.7V=n.7V;1a.7l=n.7l;1a.oT(n.v9);1a.uT(n.aC);1a.v0(n.aP);1a.2C=n.2C},Gi:1u,8v:1c(){if(!ft){ft=1g 1e.5b(d.1n,1j,1a)}1l{ft.5c(1a)}1d ft}};d.bi=1c(n){if(!ft){ft=1g 1e.5b(d.1n,n)}1l{ft.5c(1j)}1d ft};ft=1j;1e.1Z(d,"1e.1i.cg",b.2Z)})(1e.1i);(1c(a){1b d=1e.2T.8u;1b b=a.hc=1c(){1o.2u(b,1a);1a.3E={}};b.1n={2E:1c(h){if(h.Cs){1b k=1g a.1X(h.Cs);1a.3E["3b:3G"]=k}if(h.Cr){1b f=1g a.1X(h.Cr);1a.3E["3b:2Z"]=f}if(h.Cq){1b n=1g a.1X(h.Cq);1a.3E["3b:3V"]=n}if(h.Ct){1b l=1g a.1X(h.Ct);1a.3E["3b:5m"]=l}if(h.Cw){1b e=1g a.1X(h.Cw);1a.3E["3b:cg"]=e}if(h.Cv){1b j=1g a.1X(h.Cv);1a.3E["3b:aF"]=j}if(h.Cu){1b g=1g a.1X(h.Cu);1a.3E["3b:4c"]=g}},2k:1c(){1d{Cs:1a.3E["3b:3G"]?1a.3E["3b:3G"].2k():1j,Cr:1a.3E["3b:2Z"]?1a.3E["3b:2Z"].2k():1j,Cq:1a.3E["3b:3V"]?1a.3E["3b:3V"].2k():1j,Ct:1a.3E["3b:5m"]?1a.3E["3b:5m"].2k():1j,Cw:1a.3E["3b:cg"]?1a.3E["3b:cg"].2k():1j,Cv:1a.3E["3b:aF"]?1a.3E["3b:aF"].2k():1j,Cu:1a.3E["3b:4c"]?1a.3E["3b:4c"].2k():1j}},4E:1c(g,f){1k(1b h in 1a.3E){if(1a.3E.WG(h)){1b e=f.2m("1X",g);e.2X("FT",h);f.uR(e,1a.3E[h],h+"1X")}}},4f:1c(h,g){1a.3E={};1k(1b f=0;f<h.dc.1f;f++){1b e=h.dc[f];if(e.ov!==1){2t}1b k=e.3c("FT");1b j=g.H0(e);1a.3E[k]=j}}};(1c c(){b.9j=1g b();1b h=b.9j.3E;1b o="9D";1b q="8k";1b f="u7(FY, FY, k6)";1b g="u7(8j, FW, FW)";1b e="u7(Ge, Ge, ho)";1b k=1g a.1X();k.4y(o);k.Co(q);k.Cn(0);k.dS(q);k.mC("nN-nt");k.n2(4);k.Cm("uj");1b j=1g a.1X(k);h["3b:3G"]=j;1b s=1g a.1X(k);h["3b:2Z"]=s;1b r=1g a.1X(k);h["3b:3V"]=r;1b n=1g a.1X(k);n.4y(f);h["3b:5m"]=n;1b l=1g a.1X(k);l.4y(f);h["3b:aF"]=l;1b p=1g a.1X(k);p.4y(g);h["3b:cg"]=p;1b t=1g a.1X(k);t.tJ(e);h["3b:4c"]=t})();1e.1Z(b,"1e.1i.hc")})(1e.1i);(1c(b){1b g=1e.1z.5k;1b c=1e.1z.2O;1b a=1e.1z.5t;1b f=1e.1z.8t;1b l=1e.1z.BW;1b d=1e.1z.9t;1b h=1e.2T.8u;1b j=b.o7=1c(o,n){1a.1H=o;1a.3p=n;1a.1R=[];1a.BD=[];1a.97=[];1a.3E=[];1a.aT=[];1a.5e=[];1a.BE=1g h();1a.ux=1g h();1a.Dc=1g h();1a.Dr=1g h();1a.De=1g h()};j.1n={BB:1c(q,r,o){1b p=1a.3p.dj(o);r.cL(p);1b n=q.4L.i9;if(n!=1j){p.2X("i1",n.ex);p.2X("Id",q.7Z.4Q());p.2X("ew",n.hQ.4Q());q.4E(p,1a)}1l{4R 1g 5h("ih kS be GZ FS it Da cB EI EK().")}},2m:1c(n,o,q){1b p=1a.3p.dj(n);o.cL(p);if(k(q)){p.cL(1a.3p.WF(q))}1d p},BC:1c(s,p){1b q=1a.1H.G6[s];if(!q){4R 1g 5h("ih ex ["+s+"] is cB WE.")}if(1o.ia(q,b.2Z)){1b r=1g q(1a.1H)}1l{if(q==b.3G||1o.ia(q,b.3G)){1b u=p.4K("Ga")[0];1b t=p.4K("G9")[0];1b n=1a.1R[5v(u.3c("Id"))];1b o=1a.1R[5v(t.3c("Id"))];1b r=1g q(1a.1H,n,o)}}r.fV(1a.1H);1d r},EN:1c(o){56(o){1T"3b:kI":1b n=1g b.kI();1Q;1T"3b:lo":1b n=1g b.lo();1Q;aL:1d 1j}1d n},Bz:1c(o){1b q=o.3c("i1");1b r=5v(o.3c("Id"));1b n=5v(o.3c("ew"));if(1a.1R[r]!==1v){1b p=1a.1R[r]}1l{1b p=1a.BC(q,o);1a.1R[r]=p}1a.hQ=n;p.4f(o,1a);1d p},iC:1c(r,o,p){if(r==1j){1d 1j}1b q=1a.2m(o,p);q.2X("Id",r.7Z.4Q());1b n=r.4L.i9;q.2X("Hf",n.ex);q.2X("ew",n.hQ.4Q());1d q},rA:1c(n){1b q=5v(n.3c("Id"));1b o=1a.1R[q];if(o){1d o}1b p=n.3c("Hf");1b o=1a.BC(p,n);1a.1R[q]=o;1d o},Hj:1c(n){if(!1a.er){1b o=1a.2m("Hh",n);1a.Ha(o);1a.GQ(o);1a.uF(o);1a.GU(o);1a.EY(o)}},Hi:1c(n){1b o=e("Hh",n);if(o){1a.H9(o);1a.GP(o);1a.uQ(o);1a.H2(o);1a.EO(o)}},oU:1c(p,n,o,q,t){if(p==1j){1d 1j}1b s=1a.2m(n,o);if(1a.er){q.3F(1a,[s,p]);1d s}1b r=t.q2();if(t.2c(p)){r=t.1G(p)}1l{t.2p(p,r)}s.2X("Id",r.4Q());1d s},Ha:1c(n){if(1a.er){1d}1b o=1a.2m("BF",n);1a.BE.1B(1c(p,r){1b q=1a.2m("cR",o);q.2X("cb",r);1a.By(q,p)},1a)},H9:1c(n){1b s=e("BF",n);if(!s){4R 1g 5h("BF GR cB GI.")}1b t=s.4K("cR");1k(1b r=0;r<t.1f;r++){1b q=t[r];1b p=5v(q.3c("cb"));1b o=1a.sR(q);1a.BD[p]=o}},6I:1c(p,n,o){1d 1a.oU(p,n,o,1a.By,1a.BE)},6p:1c(n,p,o){1b r=e(n,p);if(!r){1d o}if(!r.D9("Id")||1a.er){1d 1a.sR(r)}1b q=5v(r.3c("Id"));1d 1a.BD[q]},By:1c(r,q){if(q.3a==="bv"||5G q==="bB"){r.2X("6n","Hb");1a.dC(q.3a==="bv"?q.3s:q,"i0",r)}1l{if(q.3a==="eb"){r.2X("6n","Bs");1a.4W(q.gT,"Ht",r);if(q.5H.1f==2){1a.dC(q.5H[0].3s,"Ho",r);1a.dC(q.5H[1].3s,"H7",r)}1l{1b n=1a.2m("Hu",r);1b p=[],o=[];1k(1b s=0;s<q.5H.1f;s++){5d[s]=q.5H[s].5d;p[s]=q.5H[s].3s}1a.Ew(o,"Hn","Hm",n);1a.Fz(p,"Hq","i0",n)}}}},sR:1c(o){1b t="aM(k6, 0, 0, 0.4)";1b u=o.3c("6n");56(u){1T"Hb":t=1a.dv("i0",o);1Q;1T"Bs":t={3a:"eb",5H:[]};t.gT=1a.4G("Ht",o);1b v=e("Hu",o);if(v){1b s=1a.Ev("Hn","Hm",v);1b n=1a.Fy("Hq","i0",v);if(s&&n){1k(1b r=0;r<s.1f;r++){t.5H.1h({5d:s[r],3s:n[r]})}}}1l{1b q=1a.dv("Ho",o);1b p=1a.dv("H7",o);t.5H.1h({5d:0,3s:q});t.5H.1h({5d:1,3s:p})}1Q}1d t},GQ:1c(n){if(1a.er){1d}1b o=1a.2m("BT",n);o.2X("lY",1a.ux.q2());1a.ux.1B(1c(r,p){1b q=1a.2m("c6",o,r);q.2X("cb",p.4Q())},1a)},GP:1c(n){1b q=e("BT",n);if(!q){4R 1g 5h("BT GR cB GI.")}1b r=q.4K("c6");1k(1b p=0;p<r.1f;p++){1b t=r[p];1b o=5v(t.3c("cb"));1b s=1a.cV(t);if(s){1a.97[o]=s}}},pX:1c(p,n,o){1d 1a.oU(p,n,o,1a.WJ,1a.ux)},pF:1c(n,o){1b q=e(n,o);if(!q){1d 1j}1b p=5v(q.3c("Id"));1d 1a.97[p]},GU:1c(n){if(1a.er){1d}1b o=1a.2m("H1",n);1a.Dc.1B(1c(r,q){1b p=1a.2m("1X",o);if(q>=0){p.2X("cb",q.4Q())}1a.uR(p,r)},1a)},H2:1c(p){1b s=e("H1",p);if(!s){1d}1b o=s.4K("1X");1k(1b r=0;r<o.1f;r++){1b n=o[r];1b q=5v(n.3c("cb"));1b t=1g b.1X();t.4f(n,1a);1a.3E[q]=t}},BM:1c(p,n,o,q){if(p!=1j){p.ex=q}1d 1a.oU(p,n,o,1a.uR,1a.Dc)},Db:1c(n,o){1b q=e(n,o);if(!q){1d 1v}1b p=5v(q.3c("Id"));1d 1a.3E[p]},uR:1c(n,o,p){if(!p){p=o.ex}n.2X("i1",p);n.2X("ew","1");o.4E(n,1a)},H0:1c(n){1b o=1g b.1X();o.4f(n,1a);1d o},uF:1c(n){if(1a.er){1d}1b o=1a.2m("fY",n);1a.De.1B(1c(r,q){1b p=1a.2m("g0",o);if(q>=0){p.2X("cb",q.4Q())}1a.Dh(p,r)},1a)},uQ:1c(n){1b r=e("fY",n);if(!r){1d}1b t=r.4K("g0");1k(1b q=0;q<t.1f;q++){1b p=t[q];1b o=5v(p.3c("cb"));1b s=1a.D6(p);if(s){1a.5e[o]=s}}},uD:1c(p,n,o){if(p==1j){1d 1a.2m(n,o)}1d 1a.oU(p,n,o,1a.Dh,1a.De)},vb:1c(o){if(!o.D9("Id")||1a.er){1d 1a.D6(o)}1b n=5v(o.3c("Id"));if(1a.5e.1f<=n){1d 1j}1d 1a.5e[n]},Dh:1c(o,p){1b n=p.4L.i9;if(n){o.2X("i1",n.ex);o.2X("ew",n.hQ);p.4E(o,1a)}1l{4R 1g 5h("g0 kS be GZ FS it Da cB EI EK().")}},D6:1c(n){if(!n.D9("i1")){1d 1j}1b p=n.3c("i1");1b o=1a.EN(p);if(!o){1d 1j}o.4f(n,1a);1d o},pQ:1c(n,o){1b q=e(n,o);if(!q){1d 1v}1b p=1a.6p("cR",q);if(!p){p=1a.dv("i0",q)}1b s=1a.2Q("hH",q);1b r=1a.4G("D7",q);1d{1V:p,du:s,1q:r}},EY:1c(n){if(1a.er){1d}1b o=1a.2m("EQ",n);o.2X("lY",1a.Dr.q2());1a.Dr.1B(1c(p,q){1b r=1a.2m("ES",o);if(q>=0){r.WA("cb",q.4Q())}1a.ER(r,p)},1a)},EO:1c(o){1b s=e("EQ",o);if(!s){1d}1b n=s.4K("ES");1k(1b r=0;r<n.1f;r++){1b t=n[r];1b q=5v(t.3c("cb"));1b p=1a.Ey(t);1a.aT[q]=p}},ER:1c(o,n){o.cL(1a.3p.WT(n.WS,1m))},Ey:1c(n){if(n.3B.1f==0){1d 1j}1d n.Ex},o3:1c(n,o){1b q=e(n,o);if(!q){1d 1v}1b r=1a.2Q("3q",q);1b p=1a.2Q("WR",q);1d{nY:r,4p:p}},aW:1c(o,n,p){1d 1a.2m(n,p,o)},7W:1c(n,p,o){if(o===1v){o=""}1b q=e(n,p);if(!q){1d o}1d 1a.cV(q)},4W:1c(p,n,o){1d 1a.2m(n,o,p.4Q())},4G:1c(n,p,o){if(o===1v){o=0}1b q=e(n,p);if(!q){1d o}1d 4J(1a.cV(q))},3m:1c(p,n,o){1b q=p.4Q();if(q.6r(".")!=-1){q=1s.b1(p).4Q()}1d 1a.2m(n,o,q)},2Q:1c(n,p,o){if(o===1v){o=0}1b q=e(n,p);if(!q){1d o}1d 5v(1a.cV(q))},3O:1c(p,n,o){if(5G p==="1v"||p===1j){p=1u}1d 1a.2m(n,o,p.4Q())},3U:1c(n,p,o){if(o===1v){o=1u}1b q=e(n,p);if(!q){1d o}1d 1a.cV(q).Eu()=="1m"},Ew:1c(p,n,s,o){if(p==1j){1d 1j}1b r=1a.2m(n,o);1k(1b q=0;q<p.1f;q++){1a.4W(p[q],s,r)}1d r},Ev:1c(o,s,p){1b r=e(o,p);if(!r){1d 1j}1b n=r.4K(s);1b t=[];1k(1b q=0;q<n.1f;q++){t[q]=4J(1a.cV(n[q]))}1d t},Fz:1c(s,n,r,o){if(s==1j){1d 1j}1b q=1a.2m(n,o);1k(1b p=0;p<s.1f;p++){1a.dC(s[p],r,q)}1d q},Fy:1c(o,s,p){1b r=e(o,p);if(!r){1d 1j}1b n=r.4K(s);1b t=[];1k(1b q=0;q<n.1f;q++){t[q]=1a.Dm(n[q],"9D")}1d t},dC:1c(p,n,o){1d 1a.2m(n,o,b.1A.WW(p))},dv:1c(n,p,o){if(o===1v){o="8k"}1b q=e(n,p);if(!q){1d o}1d 1a.Dm(q,o)},Dm:1c(q,p){1b t=1a.cV(q);if(t.1f!=9){1d p}if(t[0]!="#"){1d p}1b w=t.h8(1,3);if(w=="FF"){1d"#"+t.h8(3)}1b o=5v(w,16)/FN;1b v=5v(t.h8(3,5),16);1b u=5v(t.h8(5,7),16);1b n=5v(t.h8(7,9),16);1d b.1A.7N(v,u,n,o)},pY:1c(p,n,o){1b q=1a.2m(n,o);if(p){1a.aW(p.g6,"b4",q);1a.4W(p.cE,"9t",q);1a.3O(p.WU,"A3",q);1a.3O(p.WK,"zW",q);1a.3O(p.WP,"zZ",q)}1d q},pN:1c(v,t){1b p=e(v,t);if(!p){1d 1v}1b n=1a.7W("b4",p);if(n==""){1d 1v}1b u=1a.4G("9t",p);1b s=1a.2Q("WO",p);if(s!=0){u=a.CR(u,s,1a.1H.2o)}1b r=1a.3U("A3",p);1b q=1a.3U("zW",p);1b o=1a.3U("zZ",p);1d 1g f(n,u,r,q,o)},K5:1c(u,v,s){if(u==1j){1d 1j}1b p=1a.2m(v,s);p.2X("Id",(5G u.eH=="bB")?u.eH:"");if(!u.eH){1b o=1a.2m("hv",p);o.2X("lY",u.1r.1f);1k(1b q=0;q<u.1r.1f;q++){1b r=u.1r[q];1b t=1a.2m("hw",o);1b n=r.4L.i9;if(n){t.2X("i1",n.ex);t.2X("ew",n.hQ)}r.4E(t,1a)}}},JA:1c(z,v,o){1b q=e(z,v);if(!q){1d 1j}1b t=q.3c("Id");if(t==""||o){1b s=1g b.fa();1b n=e("hv",q);if(!n){1d 1j}1b r=n.4K("hw");1k(1b p=0;p<r.1f;p++){1b w=r[p];1b u=1g b.hw(0,0);u.fb=1a.3U("KO",w);u.fe=1a.3U("KR",w);u.3s=1a.dv("i0",w);u.jG=1a.2Q("q6",w);u.hj=1a.2Q("d8",w);u.3x=1a.oa(u,"jB",w);u.x=1a.4G("X",w);u.y=1a.4G("Y",w);s.1r.1h(u)}1d s}1l{1d b.fa.1I(t)}},hW:1c(p,n,o){if(p==1j){1d 1j}1b q=1a.2m(n,o);q.2X("Id",p.id?p.id:"6h");1d q},hX:1c(n,o){1b p=e(n,o);if(!p){1d 1v}1d p.11D.11E("Id").6T||"iy"},oe:1c(n,o){1b p=["4D","oh","ou","aJ","oY","oZ","oV","pr","ps","pq","py","pn","pd","ph","pl","pk","pj","pi"];1b q=1a.2Q(n,o);1d p[q]},cV:1c(n){if(n.dc.1f==0){1d""}1d n.dc[0].Ky},Jh:1c(p,n,o){1b q=p.1q.4Q()+", "+p.1p.4Q();1d 1a.2m(n,o,q)},Jg:1c(n,o){1b p=e(n,o);if(!p){1d 1v}1b r=1a.cV(p);1b q=r.f3(",");1d 1g d(4J(q[0]),4J(q[1]))},sb:1c(p,n,o){1b q="0, 0, 1, 1";if(p){q=p.x.4Q()+", "+p.y.4Q()+", "+p.1q.4Q()+", "+p.1p.4Q()}1d 1a.2m(n,o,q)},zt:1c(n,o){1b q=e(n,o);if(!q){1d 1v}1b s=1a.cV(q);1b r=s.f3(",");1k(1b p=0;p<r.1f;p++){r[p]=4J(r[p])}1d c.oz(r)},zC:1c(p,n,o){1b q="0, 0, 0, 0";if(p){q=p.3M.4Q()+", "+p.3Z.4Q()+", "+p.2y.4Q()+", "+p.2V.4Q()}1d 1a.2m(n,o,q)},zN:1c(n,o){1b q=e(n,o);if(!q){1d 1g l(0,0,0,0)}1b s=1a.cV(q);1b r=s.f3(",");1k(1b p=0;p<r.1f;p++){r[p]=4J(r[p])}1d 1g l(r[0],r[1],r[2],r[3])},rW:1c(o,n,p){1b q="0, 0";if(o){q=o.x.4Q()+", "+o.y.4Q()}1d 1a.2m(n,p,q)},I9:1c(o){1b q=o.dc[0].Ky;1b p=q.f3(",");1k(1b n=0;n<p.1f;n++){p[n]=4J(p[n])}1d 1g g(p[0],p[1])},KD:1c(r,n,o){if(r==1j){1d 1j}1b q=1a.2m(n,o);1k(1b p=0;p<r.1f;p++){1a.rW(r[p],"5k",q)}1d q},I6:1c(n,o){1b r=e(n,o);if(!r){1d[]}1b q=r.4K("5k");1b s=[];1k(1b p=0;p<q.1f;p++){s.1h(1a.I9(q[p]))}1d s},I3:1c(q,n,o){if(q==1j){1d 1j}1b p=1a.2m(n,o);1a.Ic(p,q);1d p},Ic:1c(n,o){o.4E(n,1a)},In:1c(n,o){1b p=e(n,o);if(p==1j){1d 1j}1d 1a.Iq(p)},Iq:1c(n){1b o=1g b.hc();o.4f(n,1a);1d o},Ip:1c(n,o){1d e(o,n)},11d:1c(r,o){1b q=[];1b n=1a.3p.11l(r,o,1j,11k.11i,1j);1b p=n.HG();2L(p){q.1h(p);p=n.HG()}1d q},HF:1c(s,n,p){if(!s==1j){1d 1j}1b q=1a.2m(n,p);1a.iC(s.Aw,"116",q);1c o(A,D,t,B){if(!A){1d}1k(1b v=0;v<A.1f;v++){1b C=A[v];1b z=D.2m("HP",t);D.iC(C,"ih",z);D.3m(0,"6n",z);D.3m(0,"11j",z);D.aW("0, 0, 0, 0","11m",z);if(B){1b u=D.2m("HO",z);1b w=D.2m("112",u);w.2X("10M","1");D.2m("10Z",w,"3b:10R:11C");D.2m("8J",w,"11z").2X("6n","2")}}}1b r=1a.2m("HQ",q);o(s.ig,1a,r,1u);o(s.3B,1a,r,1m);1a.3O(1m,"AC",q);1a.sb(s.Aw.2s(),"11B",q);1d q},HL:1c(A,v){1b q=e(A,v);if(!q){1d 1j}1b o=e("HQ",q);if(!q){1d 1j}1b u={3B:[],ig:[]};1b z=q.4K("HP");1k(1b r=0;r<z.1f;r++){1b s=z[r];1b n=e("ih",s);if(n){1b w=1a.rA(n);1b p=e("HO",s);1b t=p?u.3B:u.ig;t.1h(w)}}1d u},J4:1c(p,n,o,s){if(p==1j){1d 1j}1b r=0,q=1j;if(5G p==="bB"){if(p.1f===1){r=4}1l{r=1}1a.aW(p,n,o)}1l{if(5G p==="11G"){r=2;1a.3O(p,n,o)}1l{if(5G p==="ik"){if(b.1A.11r(p)){r=6;1a.4W(p,n,o)}1l{r=9;1a.3m(p,n,o)}}}}if(q!=1j){q.2X("6n",r)}1d q},IV:1c(n,o){1b p=e(n,o);if(!p){1d 1j}1b q=5v(p.3c("6n"));if(q==1){1d 1a.7W(n,o)}if(q==2){1d 1a.3U(n,o)}if(q==3){1d 1a.2Q(n,o)}if(q==4){1d 1a.7W(n,o)}if(q==5){1d 1a.2Q(n,o)}if(q==6){1d 1a.4G(n,o)}if(q==7){1d 1a.2Q(n,o)}if(q==8){1d 1a.2Q(n,o)}if(q==9){1d 1a.2Q(n,o)}if(q==10){1d 1a.2Q(n,o)}if(q==11){1d 1a.4G(n,o)}if(q==12){1d 1a.2Q(n,o)}if(q==13){1d 1a.2Q(n,o)}if(q==14){1d 1a.2Q(n,o)}1d 1j},nZ:1c(q,s,n,o){if(s==1j){1d 1j}1b p=1a.2m(n,o);1b r=1u;if(1a.1H){r=1a.1H.J5({2w:q,3x:s,kM:n,kK:p,3R:1a})}if(!r){o.kH(p);1a.J4(s,n,o,1u)}1d p},oa:1c(q,n,o){1b p=e(n,o);if(!p){1d 1j}1b s={2w:q,3x:1j,kM:n,kK:p,3R:1a};1b r=1a.1H.J3(s);if(!r){1d 1a.IV(n,o)}1d s.3x},IT:1c(n,o){1b q=e(n,o);if(!q){1d 1j}1b p=5v(q.3c("Id"));1d 1a.aT[p]},9x:e};1c e(n,o){1b p=o.4K(n);if(p.1f<1){1d 1j}if(p[0].3C!=o){1d 1j}1d p[0]}1c k(n){1d(5G n!="1v")&&n!==1j}1e.1Z(j,"1e.1i.o7")})(1e.1i);(1c(b){1b j=1e.2T.5i;1b e=1e.1z.gE;1b g=1e.2T.8u;1b a=1e.1z.5t;1b c=1e.1z.2O;1b h=1e.1i.iQ;1b f=1e.1z.bX;1b d=b.3V=1c(k){b.4c.6z=1m;1o.2u(d,1a,[k]);1a.2R=6;1a.1K.gG=1m;1a.3B=[];1a.3K=3;1a.7E=1m;1a.7a=1m;1a.7I=[];1a.by=1m;d.gJ=1m;1a.4n.11x=1o.rj(1a.Iz,1a);b.4c.6z=1u};d.1n={1J:1c(){b.4c.6z=1m;1b k=1o.2a(d,1a,"1J",[]);k.2R=1a.2R;k.1N=1a.1N;k.7E=1a.7E;k.7a=1a.7a;k.3K=1a.3K;k.ot(1a.jH());k.jl(1a.gu());k.7S=1a.7S;k.1N=1a.1N;b.4c.6z=1u;1d k},2k:1c(){1b k=1o.2a(d,1a,"2k",[]);k.2R=1a.2R;k.7E=1a.7E;k.7a=1a.7a;k.3K=1a.3K;k.by=1a.by;k.qn=1a.jH();k.6w=1a.gu();k.7S=1a.7S;k.1N=1a.1N;1d k},2E:1c(k){1o.2a(d,1a,"2E",[k]);1a.2R=k.2R;1a.7E=k.7E;1a.7a=k.7a;1a.3K=k.3K;if(k.by!=1v){1a.by=k.by}1a.ot(k.qn);1a.jl(k.6w);if(k.6w){1a.3g(1g c(k.1w.x,k.1w.y,k.1w.1q,k.1w.1p))}if(k.7S){1a.7S=1e.1z.9t.bC(k.7S)}if(k.1N){1a.4P(k.1N)}},4f:1c(n,l){1o.2a(d,1a,"4f",[n,l]);if(1a.6g()==""){1a.6Q(l.7W("IW",n))}1a.2R=l.4G("ru",n);1b k=l.o3("J6",n);if(k){1a.6x(k.nY);1a.6F(k.4p)}1l{1a.6x(l.2Q("gk",n));1a.6F(l.2Q("gh",n))}1a.3K=l.4G("rv",n);1a.6w=l.3U("Jf",n);1a.ot(l.3U("Jj",n));1a.7S=l.Jg("Jd",n);1a.1N=l.2Q("1D",n,b.dt.6h);1a.7E=l.3U("J9",n,1m);1a.7a=l.3U("Jb",n,1m);1a.by=l.3U("Ja",n,1m)},4E:1c(l,k){1o.2a(d,1a,"4E",[l,k]);k.4W(1a.2R,"ru",l);k.3m(1a.8F(),"gk",l);k.3m(1a.9c(),"gh",l);k.4W(1a.3K,"rv",l);k.3O(1a.6w,"Jf",l);k.3O(1a.jH(),"Jj",l);if(1a.7S){k.Jh(1a.7S,"Jd",l)}k.3m(1a.gz(),"1D",l);k.3O(1a.7E,"J9",l);k.3O(1a.7a,"Jb",l);k.3O(1a.by,"Ja",l)},3u:1c(l){if(l.j3&&l.j3(1a)){1d}1b k=l.AT();if(k){if(k==1a){1d}k.AQ(l)}k=1a.AT();if(k==l){1d}if(l.2N){if(l.2N==1a){1d}l.2N.3l(l)}1a.3B.1h(l);l.2N=1a;1a.3Y()},3l:1c(l,k){if(j.3l(1a.3B,l)){1a.3Y();4m l.2N;if(k){1a.HE(l)}if(1a.1t){1a.1t.oI()}}},Iz:1c(p,k,s,r){if(r.6w){1d}p.8D();1b q=r.by?r.Iy():1j;if(q){q.hd(p,1u);p.iU()}1k(1b o=0,n=r.7I.1f;o<n;o++){1b t=r.7I[o];if(t.bV()&&!t.9b()){t.4n.l6(p,k,s)}}p.8N()},8r:1c(n,l,o,k){if(1a.1t!=1j&&!1a.1t.kU(1a)){1d 1j}if(!1a.6w){1k(1b p=1a.7I.1f-1;p>=0;p--){1b r=1a.7I[p];if(o&&1o.1Y(b.3G,r)){2t}1b q=r.8r(n,l,o,k);if(q!=1j){1d q}}}1d 1o.2a(d,1a,"8r",[n,l,o,k])},Iy:1c(){1b o=1a.1w.1J();o.y+=1a.2R;o.1p-=1a.2R;1b n=1g f();if(o.1q>0&&o.1p>0){n.df(o.x,o.y,o.1q,o.1p);1b p=1a.9u();if(p!=0){1b k=1a.5C();1b l=1g 1e.1z.gp();l.cz(p,k.x,k.y);n.4C=l}}1l{n.df(1a.1w.x,1a.1w.y,0,0)}1d n},118:1c(){1d 1a.by},11a:1c(k){if(1a.by!==k){1a.by=k;1a.3Y()}},AF:1c(k){1a.7I.1h(k);k.AS(1u)},IB:1c(){1a.7I=[];1a.It();1a.7I.5q(1a.Ix)},Ix:1c(l,k){1d l.AM()-k.AM()},It:1c(){1b o=1a.3B;1k(1b p=0,k=o.1f;p<k;p++){1a.AF(o[p])}1b n=1g g();1a.qt(n);n.1B(1c(l){if(n.1G(l)==3){1a.AF(l)}},1a)},qt:1c(w){1b n=1a.3B;1k(1b s=0,q=n.1f;s<q;s++){1b o=n[s];1b t=[];o.db(t);1k(1b r=0;r<t.1f;r++){1b u=0;if(w.2c(t[r])){u=w.1G(t[r])}w.2p(t[r],u+1)}1b p=[];o.da(p);1k(1b r=0;r<p.1f;r++){1b u=0;if(w.2c(p[r])){u=w.1G(p[r])}w.2p(p[r],u+1)}if(1o.1Y(d,o)){1b v=1g g();o.qt(v);v.1B(1c(k){if(w.2c(k)){w.2p(k,w.1G(k)+v.1G(k))}1l{w.2p(k,v.1G(k))}})}}w.1B(1c(k){if(w.1G(k)>=2){w.2p(k,w.1G(k)+1)}})},j8:1c(r,s,u,q){if(1a.6w||!1a.1t.kU(1a)){1d}1b p=b.1A.oG(r);if(q){1k(1b o=0,k=1a.7I.1f;o<k;o++){1b t=1a.7I[o];if(!t.aB()&&t.bQ(r)){s.1h(t);if(!u){1d}if(1o.1Y(d,t)){if(t.bQ(r)){t.j8(r,s,u,q)}}}}}1l{1k(1b o=0,k=1a.7I.1f;o<k;o++){1b t=1a.7I[o];1b n=t.6N();if(!t.aB()&&p.2c(n)){s.1h(t);if(!u){1d}if(1o.1Y(d,t)){if(t.bQ(r)){t.j8(r,s,u,q)}}}}}},la:1c(s,t,v,r){if(1a.6w||!1a.1t.kU(1a)){1d}1b q=0;1b p=b.1A.oG(s);if(r){1k(1b o=0,k=1a.7I.1f;o<k;o++){1b u=1a.7I[o];if(!u.aB()&&u.bQ(s)){q+=1;if(1o.1Y(d,u)){if(u.bQ(s)){q+=u.la(s,t,v,r)}}}}}1l{1k(1b o=0,k=1a.7I.1f;o<k;o++){1b u=1a.7I[o];1b n=u.6N();if(!u.aB()&&p.2c(n)){q+=1;if(1o.1Y(d,u)){if(u.bQ(s)){q+=u.la(s,t,v,r)}}}}}},2M:1c(k){1b l=1a.6N();if(!l.2M(k)){1d 1u}if(b.1A.ry(k,1a.5P())){1d 1m}if(1a.6B&&1a.8c(k)){1d 1m}1d 1u},5P:1c(){if(1a.4n.f5){1a.eW();1a.4n.f5=1j}1b k=[];k.1h(1a.1w.5a());k.1h(1a.1w.a7());k.1h(1a.1w.9Z());k.1h(1a.1w.aR());b.1A.cU(k,b.1A.5C(1a.1w),1a.2f);1d k},eW:1c(){1b p=1a.4n.2H=[];1b u=1a.aI();1b t=1a.9k();1b w=1a.bz();1b q=1a.gr();1b n={1V:q,dE:h.l4};1a.eN(p,n);if(n.1V){q=n.1V}1a.4n.2f=1a.2f;1a.4n.IP=1a.1w.4e();1b s=1a.1w.1J();1b k=s;if(1a.1N==b.dt.ln){1b l=a.3h(1a.1t.2o);1b o=l*2.5;k=1g f();k.IL(s,o)}k.1V=q;k.2j=u;k.2v=t;k.3f=w;k.aK=1a.dA();p.1h(k);1a.eN(p,{dE:h.k4});if(1a.2R>0&&1a.2R<s.1p){1b r=s.y+1a.2R;1b v=1g e(s.x,r,s.2y(),r);v.5o(u);v.2v=t;v.3f=w;if(1a.1N==b.dt.ln&&(r<o||r>s.1p-o)){v.AL=k}p.1h(v)}s=s.1J();s.1p=1a.2R;if(1a.b7){s.1q-=1a.2R}1a.1K.3g(s,0);1a.1K.2i=1a.c8();1a.1K.2j=1a.9R();1a.1K.3P=1a.gB();1a.1K.2v=1a.iL();1a.1K.o6=1a.2f!=0;p.1h(1a.1K);1a.oc(p);if(1a.dD){1a.dD(1a)}},4P:1c(k){if(1a.1N!=k){1a.1N=k;1a.1F()}},gz:1c(){if(1a.1N===1v){1d b.dt.6h}1d 1a.1N},eC:1c(k){1b n=1a.1w.1J();n.1p=1a.2R;if(1a.2f==0){1d n}1l{1b l=1a.iK(1a.1w.1J());1d l.AK(n)}},IF:1c(k){if(1a.2R!==k){1a.2R=k;1a.1F()}},cN:1c(){1d 1a.2R},9w:1c(k){1o.2a(d,1a,"9w",[k]);j.1B(1a.3B,1c(l){l.9w(k)})},7k:1c(k){1o.2a(d,1a,"7k",[k]);j.1B(1a.3B,1c(l){l.7k(k)})},5z:1c(k){1o.2a(d,1a,"5z",[k]);j.1B(1a.3B,1c(l){l.5z(k)})},qB:1c(k,l){1o.2a(d,1a,"qB",[k,l]);j.1B(1a.3B,1c(n){if(!k.qL(n)){n.3g(b.1A.qX(n.2s(),l),1m,1m)}})},IJ:1c(l){1b k=1u;if(l){1b n=[];j.1B(l,1c(o){if(o.2N!=1a){1a.3u(o);if(o.2N==1a){k=1m;n.1h(o)}}},1a);if(k){1a.qs()}j.1B(n,1c(o){1a.HA(o)},1a)}1d k},j3:1c(k){1d k.2N==1a||k.2N&&1a.j3(k.2N)},AJ:1c(o){if(o.2N==1a){1d 1m}1b k=[];if(1o.1Y(b.fj,o)){1b l=o;if(1a.6B){1d 1u}j.1B(l.3n,1c(p){if(!j.2c(1a.3B,p)){k.1h(p)}},1a)}1l{if(1o.1Y(b.2Z,o)){1b n=o;if(!j.2c(1a.3B,n)){if(n.2N==1a){1d 1m}k.1h(n)}}}if(1a.7E&&k.1f>0){1a.1t.9w(1a);if(1a.IJ(k)){1d 1m}}1d 1u},kX:1c(k,r,p){if(!1a.6w&&1a.1t!=1j&&1a.1t.kU(1a)){1k(1b n=1a.7I.1f-1;n>=0;n--){1b o=1a.7I[n];if(1o.1Y(b.2Z,o)){if(p==o){2t}if(o!=1j&&1a.1t.s9(o)&&o.2M(k)){if(1o.1Y(b.3V,o)){1b l=o.kX(k,r,p);if(l){1d 1m}}1b q=r(o,p);if(q){1d 1m}}}}}1d 1u},Ee:1c(l){d.Ef=1m;if(!1a.7E){1d 1u}1b k=1g b.4M({1C:l,2N:1a});1a.1t.2l(b.1S.sv,k);if(k.cc()){1d 1u}if(1o.1Y(b.2Z,l)||1o.1Y(b.fj,l)){1a.1t.1F();1d 1m}},IO:1c(k){1a.1t.Is();1a.1t.1F()},lQ:1c(n){1b l=1j;1b k=1g g();j.1B(1a.3B,1c(o){l=l?l.9I(o.6N()):o.6N();if(n){j.1B(o.kQ(),1c(p){if(!k.2c(p)){k.2p(p,1)}1l{k.2p(p,k.1G(p)+1)}})}});if(n){k.1B(1c(p,o){if(o==2){l=l.9I(p.2s())}})}1d l},IA:1c(){1b l=a.3h(1a.1t.2o);1b k=1a.1w.1J();k.1p=1a.2R;k.1q=50*l;1d k},qs:1c(n,l){1b k=1a.lQ(1m);if(!k){1d}if(l===1v){l=1a.3K}k=k.5B(l);k.y-=1a.2R;k.1p+=1a.2R;if(!n){k=k.9I(1a.1w)}1a.3g(k,1m,1u);if(1a.2N){1a.2N.Ej(1a,0)}},Ej:1c(p,q){if(q==8){1b n=1a.1w;1b o=p.6N();1b l=!p.d9()||p.1t==1j||p.1t.3i.3n.1f==1;if(l&&!n.2c(o)&&!n.bc(o)){if(1a.7a){1a.3l(p,1m)}}1l{if(!l&&p.d9()){1b r=p.1t.3i.1w;if(1a.7a&&!n.2c(r)&&!r.bc(n)){1a.3l(p,1m)}}}}1b k=!p.d9()||p.1t==1j||p==p.1t.3i.3n[p.1t.3i.3n.1f-1];if(k){1a.qs()}},jH:1c(){1d 1a.b7?1m:1u},ot:1c(l){1b k=1a.jH();if(k==l){1d}if(l){1a.b7=1g b.Em(1a);1a.oO(1a.b7)}1l{1a.oR(1a.b7);4m 1a.b7}1a.1F()},gu:1c(){1d 1a.6w?1m:1u},jl:1c(k){if(1a.gu()==k){1d}if(k){1a.u6()}1l{1a.tY()}},u6:1c(){1a.7S=1a.1w.h1();1a.DI();1a.6w=1m;1a.3g(1a.IA(),1m,1u);1a.p9();if(1a.b7){1a.b7.5D()}},tY:1c(){1a.6w=1u;1b k=1g c(1a.1w.x,1a.1w.y,1a.7S.1q,1a.7S.1p);1a.3g(k,1m,1u);1a.p8();if(1a.b7){1a.b7.5D()}},DI:1c(){j.1B(1a.3B,1c(l){l.oJ(1u);1b k=1a.J8();j.1B(k,1c(n){n.oJ(1u)},1a);if(l.3B){j.1B(l.3B,1c(n){if(1o.1Y(d,n)){n.DI()}n.oJ(1u)},1a)}},1a)},Dz:1c(){1b k=[];j.1B(1a.3B,1c(l){if(1o.1Y(d,l)){k=k.IS(l.Dz())}k.1h(l)},1a);1d k},J8:1c(){1b s=[];1b r=1a.Dz();1k(1b u=0,p=r.1f;u<p;u++){1b o=[];r[u].da(o);1k(1b q=0,n=o.1f;q<n;q++){if(j.6r(r,o[q].1E)>-1){s.1h(o[q])}}1b t=[];r[u].db(t);1k(1b q=0,n=t.1f;q<n;q++){if(j.6r(r,t[q].1x)>-1){s.1h(t[q])}}}1d s},p8:1c(){j.1B(1a.3B,1c(l){1b k=[];d.od(k,l);j.1B(k,1c(n){n.gm()});if(l.p8){l.p8()}},1a)},p9:1c(){j.1B(1a.3B,1c(l){1b k=[];d.od(k,l);j.1B(k,1c(n){if(n.de().2N!=1a||n.d7().2N!=1a){n.gm()}},1a);if(l.p9){l.p9()}},1a)},10Q:1c(){1d 1a.7E},10S:1c(k){if(1a.7E!==k){1a.7E=k;1a.3Y()}},10U:1c(){1d 1a.7a},10T:1c(k){if(1a.7a!==k){1a.7a=k;1a.3Y()}},ok:1c(){1o.2a(d,1a,"ok",[]);if(1a.3B){j.1B(1a.3B,1c(k){4m k.2N})}},HA:1c(l){if(!1a.1t){1d}1b k=1g b.4M({1C:l,2N:1a});1a.1t.2l(b.1S.qg,k);1d k.a6()},HE:1c(l){if(!1a.1t){1d}1b k=1g b.4M({1C:l,2N:1a});1a.1t.2l(b.1S.qf,k);1d k.a6()},Ij:1c(){if(!1a.1t){1d}1b k=1g b.4M({1C:1a,2N:1a});1a.1t.2l(b.1S.qq,k);1d k.a6()},If:1c(){if(!1a.1t){1d}1b k=1g b.4M({1C:1a,2N:1a});1a.1t.2l(b.1S.qo,k);1d k.a6()},7u:1c(l,n){1b k=n.3E["3b:3V"];if(k){if(l.3F(k)){1d k}}1d 1o.2a(d,1a,"7u",[l,n])},DR:1c(){1b l=[];1b k=1g g();1a.qt(k);k.1B(1c(n){if(k.1G(n)==3){l.1h(n)}},1a);1d l},jy:1c(n,l,k){1d b.jA.jy(n,l,k,1a.3B,1a.3L?1a.3L:1a.DR(),1a)},c5:1c(l){1a.3L=1a.DR();1b k=b.jA.c5(l,1a);4m 1a.3L;1a.qs(1m,l.7M);1d k},9f:1c(){1b k=1o.2a(d,1a,"9f",[]);k.2R=1a.2R;k.7E=1a.7E;k.7a=1a.7a;k.3K=1a.3K;k.qn=1a.jH();k.6w=1a.6w;k.7S=1a.7S||1a.1w.h1();k.3B=j.1J(1a.3B);1d k},a2:1c(k){1o.2a(d,1a,"a2",[k]);1a.2R=k.2R;1a.7E=k.7E;1a.7a=k.7a;1a.3K=k.3K;1a.7S=k.7S;1a.ot(k.qn);1a.jl(k.6w);j.1B(1a.3B,1c(l){1a.3l(l)},1a);j.1B(k.3B,1c(l){1a.3u(l)},1a)},8v:1c(){if(!es){es=1g 1e.5b(d.1n,1j,1a)}1l{es.5c(1a)}1d es}};d.bi=1c(k){if(!es){es=1g 1e.5b(d.1n,k)}1l{es.5c(1j)}1d es};es=1j;d.od=1c(k,l){l.da(k);l.db(k);if(l.od){1d}if(l.9V){j.1B(l.oo(),1c(n){d.od(k,n)})}};d.eq=1c(l){1b k=l.2N;if(k){if(k.gu()){1d k}1d d.eq(k)}1d 1j};1e.1Z(d,"1e.1i.3V",b.2Z)})(1e.1i);(1c(b){1b a=1e.2T.5i;1b c=1e.1z.2O;1b e=1e.1z.8t;1b d=b.d2=1c(){1a.1K=1g 1e.1z.aX("",1g c(0,0,1,1));1a.1K.4p=b.3q.4H};d.1n={1J:1c(){1b f=1g 1a.4L();f.1t=1a.1t;f.1K=1a.1K.1J();f.2i=1a.2i;f.1V=1a.1V;f.2D=1a.2D;f.8Y=1a.8Y;f.9p=1a.9p;f.9a=1a.9a;f.cM(1a.bF);f.6W=1a.6W;if(1a.3w){f.pW(1a.pZ())}f.cC(1a.g1());1d f},2k:1c(){1b f={1K:1a.6g(),4a:1a.8F(),4p:1a.9c(),9a:1a.oB(),6W:1a.kr(),1V:1a.1V,2D:1a.2D,8Y:1a.8Y,9p:1a.9p,2i:1a.2i,3x:1a.3x||1j};if(1a.bF){if(1a.1t.1t.jK){f.jv=1a.1t.1t.jK(1a.bF)}1l{f.jq=1a.bF}}1d f},2E:1c(f){1a.6Q(f.1K);1a.6x(f.4a);1a.6F(f.4p);1a.gd(f.9a);1a.j0(f.6W);1a.1V=f.1V;1a.2D=f.2D;1a.8Y=f.8Y;1a.9p=f.9p;if(f.2i){1a.2i=e.bC(f.2i)}if(f.jv!=1v){1a.cM(1a.1t.1t.97[f.jv])}if(f.jq!=1v){1a.cM(f.jq)}1a.cC(f.3x)},4f:1c(h,g){1a.2i=g.pN("8t",h);1a.2D=g.6p("hl",h);1a.6Q(g.7W("aX",h));1a.9p=g.2Q("Ib",h);1a.8Y=g.2Q("Kw",h);1b f=g.o3("Im",h);if(f){1a.6x(f.nY);1a.6F(f.4p)}1l{1a.6x(g.2Q("gk",h));1a.6F(g.2Q("gh",h))}1a.6W=g.2Q("cH",h);1a.cM(g.pF("c6",h))},4E:1c(g,f){f.pY(1a.2i,"8t",g);f.6I(1a.2D,"hl",g);f.aW(1a.6g(),"aX",g);f.3m(1a.Kr(),"Ib",g);f.3m(1a.Ks(),"Kw",g);f.3m(1a.8F(),"gk",g);f.3m(1a.9c(),"gh",g);f.3m(1a.kr(),"cH",g);f.pX(1a.oL(),"c6",g)},6Q:b.8A.1n.6Q,6g:b.8A.1n.6g,6x:b.8A.1n.6x,8F:b.8A.1n.8F,6F:b.8A.1n.6F,9c:b.8A.1n.9c,pW:b.5m.1n.pW,pZ:b.5m.1n.pZ,gd:b.5m.1n.gd,oB:b.5m.1n.oB,cM:b.5m.1n.cM,oL:b.5m.1n.oL,eI:b.5m.1n.eI,j0:b.5m.1n.j0,kr:b.5m.1n.kr,oE:1c(f){if(1a.2i!==f){1a.2i=f;1a.1F()}},q1:1c(){1d 1a.2i},4y:1c(f){if(1a.1V!==f){1a.1V=f;1a.1F()}},7g:1c(){1d 1a.1V},dS:1c(f){if(1a.2D!==f){1a.2D=f;1a.1F()}},e2:1c(){1d 1a.2D},11v:1c(f){if(1a.9p!=f){1a.9p=f;1a.1F()}},Kr:1c(){if(1a.9p===1v){1d 1}1d 1a.9p},11s:1c(f){if(1a.8Y!=f){1a.8Y=f;1a.1F()}},Ks:1c(){if(1a.8Y===1v){1d 1}1d 1a.8Y},cC:1c(f){if(1a.3x!==f){1a.3x=f}},g1:1c(){1d 1a.3x},1F:1c(){if(1a.1t){1a.1t.1F()}},3Y:1c(){if(1a.1t){1a.1t.3Y()}}};1e.1Z(d,"1e.1i.d2")})(1e.1i);(1c(a){1b k=1e.2T.5i;1b f=1e.1z.bX;1b b=1e.1z.gp;1b c=1e.1z.2O;1b h=1e.1i.1A;1b j=1e.1i.iQ;1b d=1e.1i.Kg;1b g=a.kI=1c(){1o.2u(g,1a);1a.3a=d.DY;1a.bL="9D";1a.bx="9D"};g.1n={2E:1c(l){1a.3a=l.3a;1a.bL=l.bL;1a.cs=l.cs;1a.bx=l.bx},2k:1c(){1b l={lg:1a.4L.8s,3a:1a.3a,bL:1a.bL,cs:1a.cs,bx:1a.bx};1d l},4E:1c(n,l){l.3m(1a.3a,"6n",n);l.dC(1a.bL,"Kh",n);l.3O(1a.cs,"Kj",n);l.dC(1a.bx,"Ko",n)},4f:1c(n,l){1a.3a=l.2Q("6n",n);1a.bL=l.dv("Kh",n);1a.cs=l.3U("Kj",n);1a.bx=l.dv("Ko",n)},1J:1c(){1b l=1g 1a.4L();l.3a=1a.3a;l.bL=1a.bL;l.cs=1a.cs;l.bx=1a.bx;1d l},uX:1c(p){1b q=1g c(0,0,100,100);1b o=p.2s();1b l=o.1q/q.1q;1b r=o.1p/q.1p;1b n=1g b();n.8f(o.x-o.1q/2,o.y-o.1p/2);n.3A(l,r);n.8f(o.1q/l-q.x-q.1q/2,o.1p/r-q.y-q.1p/2);if(p.fC>0){n.cz(p.fC,q.x+q.1q/2,q.y+q.1p/2)}if(p.2f!==0){n.cz(p.2f,q.x+q.1q/2,q.y+q.1p/2)}1d n},KE:1c(n){if(n.5K){1d n.5K.5P()}1l{1b o=1g f();1b l=n.2s();o.df(l.x,l.y,l.1q,l.1p);1d o}},3F:1c(O,R,X){if(X.dE==j.k4){1b U=1g c(0,0,100,100);1b B=O.2s();if(O.5K){1b M=O.5K.5P()}1l{1b M=1g f();M.df(U.x,U.y,U.1q,U.1p)}1b H=1g 1e.1z.jc();H.iU=1a.KE(O);1b S=1a.uX(O);1b Z=h.iS((X.cs)?O.Zz():1a.bL);1b v=h.7N(Z.7P,Z.7R,Z.6O,0.7);1b q=h.7N(Z.7P,Z.7R,Z.6O,0);1b p=h.7N(Z.7P,Z.7R,Z.6O,0.5);1b o=h.7N(Z.7P,Z.7R,Z.6O,0.2);1b n=h.7N(Z.7P,Z.7R,Z.6O,0.1);Z=h.7N(Z.7P,Z.7R,Z.6O);1b G=h.iS(1a.bx);1b Q=h.7N(G.7P,G.7R,G.6O,0.3);1b N=h.7N(G.7P,G.7R,G.6O,0);1b L=h.7N(G.7P,G.7R,G.6O,0.5);G=h.7N(G.7P,G.7R,G.6O);if(1a.3a==d.DY){1b aa=1g f();aa.E2(50,100,50,0,6.DG/2,1);1b E={3a:"mk",9M:v,9A:q,y1:100,y2:100,KN:50};aa.4y(E);aa.5o(q);aa.4C=S.1J();k.3u(H.2H,aa);1b P=U.x;1b I=U.y;1b K=U.2y();1b Y=U.y+U.1p*35/100;1b F=K-P;1b T=Y-I;1b D=1g f();if(X.KH){D.Zt(U.x+U.1q/2,U.y+((U.1p*70/100)/2)-U.1p*20/100,U.1q,U.1p*70/100)}1l{D.3D(P,I,K,I);D.3D(K,I,K,Y);D.3D(K,Y,P+F/2,Y);D.3D(P+F/2,Y);D.Es(P+F/3,Y,P,Y,P,I+T/2);D.3D(P,I+T/2,P,I)}1b z={3a:"bv",3s:Q};D.4y(z);D.5o(N);D.4C=S.1J();k.3u(H.2H,D)}1l{if(1a.3a==d.KP){1b aa=1g f();aa.df(U.x,U.y+U.1p/2,U.1q,U.1p/2);1b E={3a:"eb",x1:50,y1:49.5,x2:50,y2:101.5,9M:q,9A:Z};aa.4y(E);aa.5o(q);aa.4C=S.1J();k.3u(H.2H,aa);1b D=1g f();D.df(U.x,U.y,U.1q,U.1p/3);1b z={3a:"eb",x1:50,y1:33.5,x2:50,y2:0,9M:q,9A:p};D.4y(z);D.5o(q);D.4C=S.1J();k.3u(H.2H,D);1b P=U.x;1b I=U.y;1b K=U.2y();1b Y=U.y+U.1p*40/100;1b F=K-P;1b T=Y-I;1b C=1g f();C.3D(P,I,K,I);C.3D(K,I,K,Y);C.3D(K,I,K,Y);C.3D(K,Y);C.Es(K-F/3,Y-T/4,P+F/3,Y-T/4,P,Y);C.3D(P,Y,P,I);1b u={3a:"bv",3s:Q};C.4y(u);C.5o(N);C.4C=S.1J();k.3u(H.2H,C)}1l{if(1a.3a==d.KM){1b aa=1g f();aa.E2(50,100,100,0,6.DG/2,1);1b E={3a:"mk",9M:v,9A:q,y1:100,y2:100,Zw:50,KN:100};aa.4y(E);aa.5o(q);aa.4C=S.1J();k.3u(H.2H,aa);1b D=1g f();D.df(U.x,U.y,U.1q,U.1p/4);1b z={3a:"eb",x1:50,y1:0,x2:50,y2:25.5,9M:L,9A:N};D.4y(z);D.5o(N);D.4C=S.1J();k.3u(H.2H,D);1b C=M.1J();1b A=1g c(B.x,B.y,B.1q,B.1p/4);1b W=1g 1e.1z.jc();W.iU=A;1b u={3a:"eb",x1:50,y1:0,x2:50,y2:100,9M:G,9A:N};C.4y("4l");C.5o(u);1b J=1-(((O.9k()||1)/O.1t.3A)/100);1b V=S.1J();V.uN(J,J,U);C.4C=V.1J();k.3u(W.2H,C);k.3u(H.2H,W)}1l{if(1a.3a==d.JI){1b aa=1g f();aa.df(U.x,U.y,U.1q,U.1p/2);1b E={3a:"eb",x1:50,y1:0,x2:50,y2:50.5,9M:L,9A:Q};E.5H=[];E.5H.1h({5d:0,3s:N});E.5H.1h({5d:0.2,3s:Q});E.5H.1h({5d:0.4,3s:L});aa.4y(E);aa.5o(N);aa.4C=S.1J();k.3u(H.2H,aa);1b D=1g f();D.df(U.x,U.y,U.1q,U.1p);1b z={3a:"eb",9M:Z,9A:Z};z.5H=[];z.5H.1h({5d:0,3s:o});z.5H.1h({5d:0.Zd,3s:n});z.5H.1h({5d:0.Zf,3s:q});z.5H.1h({5d:0.4,3s:n});z.5H.1h({5d:0.Ze,3s:q});z.5H.1h({5d:0.Za,3s:n});z.5H.1h({5d:1,3s:o});D.4y(z);D.5o(N);D.4C=S.1J();k.3u(H.2H,D)}}}}k.3u(R,H)}},aA:1c(){1d 1a.3a},Z6:1c(l){1a.3a=l},Z5:1c(){1d 1a.bL},Z9:1c(l){1a.bL=l},Z8:1c(){1d 1a.cs},Zg:1c(l){1a.cs=l},Zo:1c(){1d 1a.bx},Zn:1c(l){1a.bx=l}};1e.1Z(g,"1e.1i.kI");1b e=a.lo=1c(){1o.2u(e,1a);1a.9P=0.4;1a.bS="8k";1a.ci="9D"};e.1n={2E:1c(l){1a.9P=l.9P;1a.bS=l.bS;1a.ci=l.ci},2k:1c(){1b l={lg:1a.4L.8s,9P:1a.9P,bS:1a.bS,ci:1a.ci};1d l},4E:1c(n,l){l.4W(1a.9P,"JO",n);l.dC(1a.bS,"Fg",n);l.dC(1a.ci,"Fd",n)},4f:1c(n,l){1a.9P=l.4G("JO",n);1a.bS=l.dv("Fg",n);1a.ci=l.dv("Fd",n)},1J:1c(){1b l=1g 1a.4L();l.9P=1a.9P;l.bS=1a.bS;l.ci=1a.ci;1d l},uX:1c(p){1b q=1g c(0,0,100,100);1b o=p.2s();1b l=o.1q/q.1q;1b r=o.1p/q.1p;1b n=1g b();n.8f(o.x-o.1q/2,o.y-o.1p/2);n.3A(l,r);n.8f(o.1q/l-q.x-q.1q/2,o.1p/r-q.y-q.1p/2);if(p.fC>0){n.cz(p.fC,q.x+q.1q/2,q.y+q.1p/2)}if(p.2f!==0){n.cz(p.2f,q.x+q.1q/2,q.y+q.1p/2)}1d n},3F:1c(q,A,s){1b u=1g c(0,0,100,100);1b l=q.2s();if(q.5K){1b C=q.5K.5P()}1l{1b C=1g f();C.df(u.x,u.y,u.1q,u.1p)}1b n=1g 1e.1z.jc();1b D=1a.uX(q);1b z=s.Fj;1b v=z*3;1b B=s.1V;if(s.dE==j.l4){if(5G(s.1V)=="bB"){B={3a:"bv",3s:h.iS(s.1V)}}1l{if(B.3a=="bv"){B.3s=h.iS(B.3s)}}if(B.3a=="eb"||B.3a=="mk"){B.9M=h.iS(B.9M);B.9A=h.iS(B.9A)}if(B.3a=="bv"){B.3s=h.7N(B.3s.7P,B.3s.7R,B.3s.6O,1a.9P)}1l{if(B.3a=="eb"||B.3a=="mk"){B.9M=h.7N(B.9M.7P,B.9M.7R,B.9M.6O,1a.9P);B.9A=h.7N(B.9A.7P,B.9A.7R,B.9A.6O,1a.9P)}}s.1V=B;1b p=C.1J();p.4y("4l");1b o=h.iS(1a.bS);1b r=D.1J();r.uN(1.Fn,1.Fn,u);1b F=15;1k(1b w=10;w>=0;w-=2){kW=p.1J();kW.h0="b1";kW.5o(h.7N(o.7P,o.7R,o.6O,0.1));F-=3;kW.2v=F;kW.4C=r.1J();k.3u(n.2H,kW)}k.3u(A,n);1d}1b p=C.1J();p.4y("4l");p.5o(1a.ci);p.2v=q.9k()+v;1b E=D.1J();E.uN(0.99,0.99,u);p.4C=E.1J();k.3u(n.2H,p);k.3u(A,n)},Zh:1c(){1d 1a.9P},Zl:1c(l){1a.9P=l},ZP:1c(){1d 1a.bS},10s:1c(l){1a.bS=l},10t:1c(){1d 1a.ci},10A:1c(l){1a.ci=l}};1e.1Z(e,"1e.1i.lo")})(1e.1i);(1c(b){1b a=1e.2T.5i;1b c=b.tD=1c(d){1o.2u(c,1a,[d]);1a.iJ=[];1a.g6="tD"};c.1n={d1:1c(){a.1B(1a.iJ,1c(d){d.d1()},1a)},9Y:1c(){1k(1b d=1a.iJ.1f-1;d>=0;d--){1a.iJ[d].9Y()}},9T:1c(){a.1B(1a.iJ,1c(d){d.9T()},1a)},10E:1c(){1d 1a.iJ}};1e.1Z(c,"1e.1i.tD",b.e5)})(1e.1i);(1c(b){1b a=b.th=1c(c,d){1o.2u(a,1a,[c]);1a.2w=d;1a.g6="th"};a.1n={d1:1c(){1a.1H.ms(1a.2w)},9Y:1c(){1a.1H.lX(1a.2w,1u)},9T:1c(){1a.1H.ms(1a.2w)}};1e.1Z(a,"1e.1i.th",b.e5)})(1e.1i);(1c(a){1b b=a.sG=1c(c,d){1o.2u(b,1a,[c]);1a.2w=d;1a.g6="sG"};b.1n={d1:1c(){1a.1H.lX(1a.2w)},9Y:1c(){1a.1H.ms(1a.2w)},9T:1c(){1a.1H.lX(1a.2w)}};1e.1Z(b,"1e.1i.sG",a.e5)})(1e.1i);(1c(b){1b a=b.kB=1c(c,d){1o.2u(a,1a,[c]);1a.eL=d.9f();1a.2w=d};a.1n={9Y:1c(){1a.DW()},9T:1c(){1a.DW()},d1:1c(){},DW:1c(){1b c=1a.2w.9f();1a.2w.a2(1a.eL);1a.eL=c}};1e.1Z(a,"1e.1i.kB",b.e5)})(1e.1i);(1c(a){1b b=a.u3=1c(d,c){1o.2u(b,1a,[d]);1a.2N=c;1a.6w=1a.2N.6w;1a.g6="u3"};b.1n={d1:1c(){1a.2N.jl(!1a.2N.gu())},9Y:1c(){if(1a.6w){1a.2N.u6()}1l{1a.2N.tY()}},9T:1c(){if(!1a.6w){1a.2N.u6()}1l{1a.2N.tY()}}};1e.1Z(b,"1e.1i.u3",a.e5)})(1e.1i);(1c(a){1b b=a.ml=1c(c,d){1o.2u(b,1a,[c]);1a.7f=d;1a.ET=d.4U;1a.g6="ml"};b.1n={d1:1c(){1a.EW=1a.7f.4U},9Y:1c(){1a.7f.jz(1a.ET)},9T:1c(){1a.7f.jz(1a.EW)}};1e.1Z(b,"1e.1i.ml",a.e5)})(1e.1i);(1c(b){1b a=b.ul=1c(c,e,d){1o.2u(a,1a,[c]);1a.7f=e;1a.3y=d;1a.EU=1a.3y.1q;1a.EV=1a.3y.aD;1a.g6="ul"};a.1n={d1:1c(){1a.EE=1a.3y.1q;1a.EF=1a.3y.aD},9Y:1c(){1a.7f.jC(1a.3y,1a.EU);1a.7f.mm(1a.3y,1a.EV)},9T:1c(){1a.7f.mm(1a.3y,1a.EF);1a.7f.jC(1a.3y,1a.EE)}};1e.1Z(a,"1e.1i.ul",b.e5)})(1e.1i);(1c(b){1b a=b.uk=1c(c,d,e){1o.2u(a,1a,[c]);1a.7f=d;1a.2A=e;1a.EM=1a.2A.1p;1a.g6="uk"};a.1n={d1:1c(){1a.GX=1a.2A.1p},9Y:1c(){1a.7f.jP(1a.2A,1a.EM)},9T:1c(){1a.7f.jP(1a.2A,1a.GX)}};1e.1Z(a,"1e.1i.uk",b.e5)})(1e.1i);(1c(a){1b b=a.tP=1c(c){1a.1H=c;1a.hk=[];1a.d0=-1;1a.gf=1j;1a.tT=0};b.1n={9S:1c(c){c.d1();if(1a.gf==1j){1a.Ei(c)}1l{1a.gf.iJ.1h(c)}},Ei:1c(c){if(1a.d0<1a.hk.1f-1){1a.hk.8O(1a.d0+1,1a.hk.1f-1a.d0-1)}1a.hk.1h(c);++1a.d0;1a.1H.m6()},jj:1c(){if(1a.gf==1j){1a.gf=1g a.tD(1a.1H)}1a.tT++;1d 1a.gf},js:1c(c){1a.tT--;if(1a.tT==0){if(c!=1u){1a.Ei(1a.gf)}1a.gf=1j}},9Y:1c(){if(1a.tM()){1b d=1a.hk[1a.d0];d.9Y();--1a.d0;1a.1H.m6()}},9T:1c(){if(1a.tO()){++1a.d0;1b d=1a.hk[1a.d0];d.9T();1a.1H.m6()}},tM:1c(){1d 1a.d0>=0},tO:1c(){1d 1a.d0<1a.hk.1f-1}};1e.1Z(b,"1e.1i.tP")})(1e.1i);1e.Ap("1e.jU");1e.jU.9F={E0:0,DV:1,DJ:2,Hw:3,E7:4,Gf:5,Eq:6,iN:7};1e.jU.ka={Ed:0,H8:1,Hc:2,GK:3};(1c(a){1b b=a.ID=1c(f,d,c,e){1a.2w=f;1a.gH=ng;1a.g5=1j;1a.ev=1j;1a.bU=a.9F.E0;1a.7G=1j;1a.gI=a.ka.Ed;1a.eB=1u;1a.bh=1u;1a.m5=1o.3t(1a,c||1a.Fs);1a.GC=1o.3t(1a,e||1a.GD);if(d){if(d.gH!=1j){1a.gH=d.gH}if(d.g5!=1j){1a.g5=d.g5}if(d.ev!=1j){1a.ev=d.ev}if(d.bU){1a.bU=d.bU}if(d.7G!=1j){1a.7G=d.7G}1l{if(1a.bU==a.9F.DV){1a.7G=2}1l{if(1a.bU==a.9F.E7){1a.7G=1.5}1l{if(1a.bU==a.9F.Eq){1a.7G=0.5}1l{if(1a.bU==a.9F.DJ){1a.7G=10}}}}}if(d.gI){1a.gI=d.gI}if(d.eB!=1j){1a.eB=d.eB}if(d.bh!=1j){1a.bh=d.bh}}1a.Ec=0;1a.cF=0;1a.je=1j;1a.nR=1o.nS();1o.ZZ(1a)};b.1n={hA:1c(){1a.DC()},6b:1c(c,d){1o.nT(1a,c,d)},qk:1c(c,d){1o.d3(1a,c,d)},2l:1c(c,d){1b e=1o.h3(1a,c);if(e!=1j){e(1a,d)}},tz:1c(){1a.E6=1g bZ().En();1a.je=b.uw(1a.kb.up(1a))},DC:1c(){if(1a.je!=1j){b.DP(1a.je);1a.je=1j;1a.2l(a.1S.As,1e.dV.lD)}},Hl:1c(){1d 1a.je!=1j},106:1c(){if(1a.Hl()){1d 1a.cF}1d 0},Er:1c(e){if(e===0){1d 0}if(e===1){1d 1}56(1a.bU){1T a.9F.E0:1d e;1T a.9F.DV:1d 1s.5O(e,1a.7G);1T a.9F.DJ:1d(1s.5O(1s.E,1a.7G*e)-1)/(1s.5O(1s.E,1a.7G)-1);1T a.9F.Hw:1d 1-1s.dT(1s.10d(e));1T a.9F.E7:1d 1s.5O(e,2)*((1a.7G+1)*e-1a.7G);1T a.9F.Gf:1b d=0,c=1;2L(1m){if(e>=(7-4*d)/11){1d-1s.5O((11-6*d-11*e)/4,2)+1s.5O(c,2)}d+=c;c/=2}1T a.9F.Eq:1d 1s.5O(2,10*(e-1))*1s.mq(20*1s.PI*1a.7G*e);1T a.9F.iN:1d 1a.GC(e,1a.7G)}},GD:1c(d,c){1d d},u4:1c(c){1d 1a.Er(c)},tx:1c(c){1d 1-1a.Er(1-c)},Hr:1c(c){if(c<=0.5){1d 1a.u4(c*2)/2}1l{1d 1a.tx((c-0.5)*2)/2+0.5}},GM:1c(c){if(c<=0.5){1d 1a.tx(c*2)/2}1l{1d 1a.u4((c-0.5)*2)/2+0.5}},kb:1c(){1a.je=b.uw(1a.kb.up(1a));1a.Ec=1g bZ().En();1a.cF=(1a.Ec-1a.E6)/1a.gH;if(1a.cF>=1){1a.cF=1}56(1a.gI){1T a.ka.Ed:1a.m5(1a,1a.u4(1a.cF));1Q;1T a.ka.H8:1a.m5(1a,1a.tx(1a.cF));1Q;1T a.ka.Hc:1a.m5(1a,1a.Hr(1a.cF));1Q;1T a.ka.GK:1a.m5(1a,1a.GM(1a.cF));1Q}if(1a.cF==1){if(1a.eB){1a.cF=0;1a.E6=1g bZ().En()}1l{1a.DC()}if(1a.bh){1b c=1a.ev;1a.ev=1a.g5;1a.g5=c}}},Fs:1c(d,c){if(d.2w.rc){d.2w.rc(d,c)}},S9:1c(){1d 1a.gH},Sa:1c(c){if(1a.gH!=c){1a.gH=c}},np:1c(){1d 1a.g5},Sq:1c(c){if(1a.g5!=c){1a.g5=c}},DZ:1c(){1d 1a.ev},Si:1c(c){if(1a.ev!=c){1a.ev=c}},RT:1c(){1d 1a.bU},RQ:1c(c){if(1a.bU!=c){1a.bU=c}},RR:1c(){1d 1a.7G},S5:1c(c){if(1a.7G!=c){1a.7G=c}},S4:1c(){1d 1a.gI},S7:1c(c){if(1a.gI!=c){1a.gI=c}},S6:1c(){1d 1a.eB},S3:1c(c){if(1a.eB!=c){1a.eB=c}},S0:1c(){1d 1a.bh},RZ:1c(c){if(1a.bh!=c){1a.bh=c}}};b.uw=(1c(){if(5G 4O==="1v"){1d}1b c=4O.uw||4O.S2||4O.S1||4O.QZ||4O.QU||1c(d){1d 4O.j7(d,ng/60)};1d c.up(4O)})();b.DP=(1c(){if(5G 4O==="1v"){1d}1b c=4O.DP||4O.R2||4O.R1||4O.UW||4O.Vb||1c(d){4O.jV(d)};1d c.up(4O)})();1e.1Z(b,"1e.jU.ID",1j,"V5.U4")})(1e.jU);1e.jU.1S={As:"As"};1e.Ap("1e.1i.4j");1e.1i.4j.ec={Eb:0,hq:1};(1c(a){1b b=a.d2=1c(c){1o.2u(b,1a);1a.1t=c;1a.1P=1g a.1X();1a.1K=""};b.1n={HU:1c(c,d){1a.3y=c;1a.2A=d},ni:1c(){1d 1a},h2:1c(){1d 1a.6g()},eC:1c(c){1d 1a.nl()},gY:1c(c,d){1d 1g 1e.1i.k3({5y:1a,c9:c,ca:d,3y:1a.3y,2A:1a.2A})},nm:1c(c){1a.6Q(c)},jZ:1c(){1d 1j},2E:1c(c){if(c.1P){1a.1P.2E(c.1P)}1a.1K=c.1K},2k:1c(){1b c={1P:1a.1P.2k(),1K:1a.1K};1d c},cG:1c(){1d 1a.1P},iR:1c(c){if(!c){4R 1g 5h("eS 1P of a 5y kS be 1j.")}if(1a.1P===c){1d}1a.1P=c;1a.1t.5w.1F()},6g:1c(){1d 1a.1K},6Q:1c(c){if(1a.1K===c){1d}1a.1K=c;1a.1t.5w.1F()},nl:1c(){1d 1a.kz},nk:1c(c){1a.kz=c}};1e.1Z(b,"1e.1i.4j.d2")})(1e.1i.4j);(1c(b){1b a=b.DH=1c(d,c,h,f,g){1o.2u(a,1a);1a.5w=d;1b j=1a;1b e=1c(){j.h6=1u;j.5w.qk(b.1S.f7,e)};1a.5w.6b(b.1S.f7,e);1a.ep=c;1a.he=h;1a.gW=f;1a.iW=g;1a.h6=1m};a.1n={cG:1c(){if(!1a.h6){4R 1g 5h("dY kw or kx h7 eL of a 5y ki kj hu kh 5w\'s kf kg kn.")}1d 1g b.Ay(1a)},iR:1c(e){if(!1a.h6){4R 1g 5h("dY kw or kx h7 eL of a 5y ki kj hu kh 5w\'s kf kg kn.")}1k(1b f=1a.ep;f<=1a.he;f++){1k(1b d=1a.gW;d<=1a.iW;d++){1a.5w.1G(f,d).iR(e)}}},6g:1c(){if(!1a.h6){4R 1g 5h("dY kw or kx h7 eL of a 5y ki kj hu kh 5w\'s kf kg kn.")}1d 1a.5w.1G(1a.ep,1a.he).6g()},6Q:1c(e){if(!h6){4R 1g T5("dY kw or kx h7 eL of a 5y ki kj hu kh 5w\'s kf kg kn.")}1k(1b f=1a.ep;f<=1a.he;f++){1k(1b d=1a.gW;d<=1a.iW;d++){1a.5w.1G(f,d).6Q(e)}}},A5:1c(){1d 1a.ep},zw:1c(){1d 1a.he},zy:1c(){1d 1a.gW},AU:1c(){1d 1a.iW}};1e.1Z(a,"1e.1i.4j.DH")})(1e.1i.4j);(1c(b){1b a=b.Ay=1c(g,c,f,d,e){1o.2u(a,1a);1a.Ax=g;1a.5w=g.5w;1a.ep=g.ep;1a.he=g.he;1a.gW=g.gW;1a.iW=g.iW};a.1n={8W:1c(c){if(!1a.Ax.h6){4R 1g 5h("dY kw or kx h7 eL of a 5y ki kj hu kh 5w\'s kf kg kn.")}1d c.3F(1a.5w.1G(1a.ep,1a.gW).cG())},8X:1c(g,e){if(!1a.Ax.h6){4R 1g 5h("dY kw or kx h7 eL of a 5y ki kj hu kh 5w\'s kf kg kn.")}1k(1b f=1a.ep;f<=1a.he;f++){1k(1b d=1a.gW;d<=1a.iW;d++){g.3F(1a.5w.1G(f,d).cG(),[e])}}},uz:1c(){1d 1a.8W(b.1X.1n.uz)},DD:1c(c){1a.8X(b.1X.1n.DD,c)},uE:1c(){1d 1a.8W(b.1X.1n.uE)},DE:1c(c){1a.8X(b.1X.1n.DE,c)},tX:1c(){1d 1a.8W(b.1X.1n.tX)},tC:1c(c){1a.8X(b.1X.1n.tC,c)},tG:1c(){1d 1a.8W(b.1X.1n.tG)},DB:1c(c){1a.8X(b.1X.1n.DB,c)},pG:1c(){1d 1a.8W(b.1X.1n.pG)},pH:1c(c){1a.8X(b.1X.1n.pH,c)},pE:1c(){1d 1a.8W(b.1X.1n.pE)},DA:1c(c){1a.8X(b.1X.1n.DA,c)},qp:1c(){1d 1a.8W(b.1X.1n.qp)},p3:1c(c){1a.8X(b.1X.1n.p3,c)},p0:1c(){1d 1a.8W(b.1X.1n.p0)},DK:1c(c){1a.8X(b.1X.1n.DK,c)},qv:1c(){1d 1a.8W(b.1X.1n.qv)},rV:1c(c){1a.8X(b.1X.1n.rV,c)},e2:1c(){1d 1a.8W(b.1X.1n.e2)},dS:1c(c){1a.8X(b.1X.1n.dS,c)},iD:1c(){1d 1a.8W(b.1X.1n.iD)},mC:1c(c){1a.8X(b.1X.1n.mC,c)},il:1c(){1d 1a.8W(b.1X.1n.il)},n2:1c(c){1a.8X(b.1X.1n.n2,c)},8F:1c(){1d 1a.8W(b.1X.1n.8F)},6x:1c(c){1a.8X(b.1X.1n.6x,c)},9c:1c(){1d 1a.8W(b.1X.1n.9c)},6F:1c(c){1a.8X(b.1X.1n.6F,c)}};1e.1Z(a,"1e.1i.4j.Ay")})(1e.1i.4j);(1c(a){1b b=a.zv=1c(c){1o.2u(b,1a);1a.5w=c;1a.7x=[[]];1a.dU=0;1a.et=0};b.1n={2E:1c(e){1a.7x=[];1a.dU=e.dU;1a.et=e.et;1b f;1k(1b d=0;d<e.7x.1f;d++){if(d%1a.dU===0){if(f){1a.7x.1h(f)}f=[]}1b c=1g a.d2(1a);c.2E(e.7x[d]);f.1h(c)}if(e.7x.1f>0){1a.7x.1h(f)}},2k:1c(){1b c={7x:1a.Ie(),dU:1a.dU,et:1a.et};1d c},Ie:1c(){1b d=[];1k(1b h=0,e=1a.et;h<e;h++){1k(1b f=0,g=1a.dU;f<g;f++){d.1h(1a.7x[h][f].2k())}}1d d},JV:1c(e,h){if(h<=0){1d}1b d=1a.cm();1k(1b j=0;j<h;j++){1b f=[];1k(1b g=0;g<d;g++){f.1h(1g a.d2(1a))}1a.7x.8O(e+j,0,f)}1a.et+=h},Gv:1c(d,f){if(f<=0){1d}1b g=1a.b3();1k(1b h=0;h<g;h++){1k(1b e=0;e<f;e++){1a.7x[h].8O(d+e,0,1g a.d2(1a))}}1a.dU+=f},FO:1c(c,d){if(d<=0){1d}1a.7x.8O(c,d);1a.et-=d},Gj:1c(d,e){if(e<=0){1d}1b f=1a.b3();1k(1b g=0;g<f;g++){1a.7x[g].8O(d,e)}1a.dU-=e},1G:1c(c,d){1d 1a.7x[c][d]},b3:1c(){1d 1a.et},cm:1c(){1d 1a.dU}};1e.1Z(b,"1e.1i.4j.zv")})(1e.1i.4j);1e.1i.4j.1S={f7:"f7"};(1c(e){1b b=1e.1z.2O;1b d=1e.1z.5k;1b c=1e.2T.8u;1b a=e.mr=1c(f){1o.2u(a,1a);1a.1t=f;1a.4I=1g e.uy(1a,1u);1a.4i=1g e.uy(1a,1m);1a.8E=0;1a.8L=0;1a.b6=10;1a.gQ="";1a.eD=1u;1a.ej=1m;1a.cX=1m;1a.el=1m;1a.b9=[];1a.aZ=[];1a.2C=1g e.zv(1a);1a.1P=1g e.1X();1a.1P.tC(1);1a.1P.pH(1);1a.1P.p3(1);1a.1P.rV(1);1a.1P.6x(1e.1i.3q.4H);1a.1P.6F(1e.1i.3q.4H);1a.nR=1o.nS()};a.1n={2E:1c(f){1a.4I.2E(f.4I);1a.4i.2E(f.4i);1a.8E=f.8E;1a.8L=f.8L;1a.b6=f.b6;1a.gQ=f.gQ;1a.cX=f.cX;1a.el=f.el;1a.b9=f.b9;1a.aZ=f.aZ;if(f.ej!=1v){1a.ej=f.ej}if(f.1P){1a.1P.2E(f.1P)}1a.2C.2E(f.2C);1a.2l(e.1S.f7,1e.dV.lD)},2k:1c(){1b f={4I:1a.4I.2k(),4i:1a.4i.2k(),8E:1a.8E,8L:1a.8L,b6:1a.b6,gQ:1a.gQ,cX:1a.cX,el:1a.el,b9:1a.b9,aZ:1a.aZ,ej:1a.ej,1P:1a.1P.2k(),2C:1a.2C.2k()};1d f},6b:1c(f,g){1o.nT(1a,f,g)},qk:1c(f,g){1o.d3(1a,f,g)},2l:1c(f,g){1b h=1o.h3(1a,f);if(h){h(1a,g)}},MU:1c(k,j,f){if(k.3o()){4R 1g 5h("dY 3u a 4x to FA EB EG 1t 4x at a ED.")}if(!j){j=1a.4I}if(!j.cn()){4R 1g 5h("eS p5 4x is cB a 3y 4x.")}1b h=j;2L(h){if(k===h){4R 1g 5h("dY 3u a 4x to EH or as a Gb or G3 jQ to jJ of hu 3B.")}h=h.1t}k.fV(j);1b g=j.2n();if(!f){g.1h(k)}1l{g.8O(f,0,k)}1a.Jy(k);1a.1F()},Jy:1c(h){1b f=1a.bG(h);1b g=h.c2();if(h.3o().2n().1f===1){if(h.3o()!==1a.4I){g-=1}}1a.2C.JV(f,g);if(h.3o().2n().1f===1){h.mo(1s.1U(1a.b6,h.3o().5l()))}1l{h.mo(1a.b6)}if(h.4V()===0){h.1p=20}1a.2l(e.1S.f7,1e.dV.lD)},Df:1c(j){1b h=j.3o();if(!h){1d}if(!j.cn()){4R 1g 5h("eS p5 4x is cB a 3y 4x.")}1b g=h.2n();1b f=g.6r(j);1a.FR(j);j.fV();g.8O(f,1);1a.1F()},FR:1c(h){1b f=1a.bG(h);1b g=h.c2();if(h.3o().2n().1f===1){if(h.3o()!==1a.4I){g-=1}}if(h.3o().2n().1f===1&&h.3o()!==1a.4I){h.3o().gv(h.5l())}h.E5();h.E3();1a.2C.FO(f,g);1a.2l(e.1S.f7,1e.dV.lD)},N2:1c(k,j,f){if(k.3o()){4R 1g 5h("dY 3u a 4x to FA EB EG 1t 4x at a ED.")}if(!j){j=1a.4i}if(!j.a8()){4R 1g 5h("eS p5 4x is cB a 2A 4x.")}1b h=j;2L(h){if(k===h){4R 1g 5h("dY 3u a 4x to EH or as a Gb or G3 jQ to jJ of hu 3B.")}h=h.1t}k.fV(j);1b g=j.2n();if(mz(f)||f<0||f>g.1f){g.1h(k)}1l{g.8O(f,0,k)}1a.GE(k);1a.1F()},GE:1c(h){1b f=1a.bG(h);1b g=h.c2();if(h.3o().2n().1f===1){if(h.3o()!==1a.4i){g-=1}}1a.2C.Gv(f,g);if(h.3o().2n().1f===1){h.v4(1s.1U(1a.b6,h.3o().4V()))}1l{h.v4(1a.b6)}if(h.5l()===0){h.1q=20}1a.2l(e.1S.f7,1e.dV.lD)},Dg:1c(j){1b h=j.3o();if(!h){1d}if(!j.a8()){4R 1g 5h("eS p5 4x is cB a 2A 4x.")}1b g=h.2n();1b f=g.6r(j);1a.Gn(j);j.fV();g.8O(f,1);1a.1F()},Gn:1c(h){1b f=1a.bG(h);1b g=h.c2();if(h.3o().2n().1f===1){if(h.3o()!==1a.4i){g-=1}}if(h.3o().2n().1f===1&&h.3o()!==1a.4i){h.3o().hi(h.4V())}h.E5();h.E3();1a.2C.Gj(f,g);1a.2l(e.1S.f7,1e.dV.lD)},Tw:1c(f){1d 1a.pu(1a.4I.2n(),f)},Tv:1c(f){1d 1a.pu(1a.4i.2n(),f)},pu:1c(j,h){1k(1b g=0;g<j.1f;g++){1b k=j[g];if(k.DM()==h){1d k}1b f=1a.pu(k.2n(),h);if(f){1d f}}},bG:1c(f){if(!f.3o()){1d 0}1d 1a.bG(f.3o())+1a.P3(f)},P3:1c(k){1b g=0;1k(1b h=0,f=k.3o().2n().1f;h<f;h++){1b j=k.3o().2n()[h];if(j===k){1Q}g+=j.c2()}1d g},Tt:1c(f){1d 1a.pf(1a.4i.2n(),f,0)},Tu:1c(f){1d 1a.pf(1a.4I.2n(),f,0)},pf:1c(j,l,h){if(l===h){1d j.1f}if(l<h){1d 0}1b g=0;1k(1b f=0;f<j.1f;f++){1b k=j[f];g+=1a.pf(k.2n(),l,h+1)}1d g},Eg:1c(f){1d 1a.gK(1a.4i.2n(),f)},Et:1c(f){1d 1a.gK(1a.4I.2n(),f)},gK:1c(j,f){if(j.1f===0){1d 0}if(j.1f===1){if(j[0]===f){1d 0}}1b h=0;1k(1b g=0;g<j.1f;g++){1b k=j[g];if(k===f){2t}h=1s.1U(h,1a.gK(k.2n(),f))}1d h+1},DQ:1c(l,k,o){if(k.1f<=o){k.1h(0)}1b j=0;1b g=1u;if(o<1a.aZ.1f){1b f=1a.aZ[o];if(f>0){g=1m;j=f}}1b h;if(!g){j=k[o];1k(h=0;h<l.1f;h++){1b n=l[h];if(j<n.4V()){j=n.4V()}}}1k(h=0;h<l.1f;h++){1a.DQ(l[h].2n(),k,o+1)}k[o]=j},Qe:1c(k,f){1b j=[];1a.Ck(1a.4I.2n(),k,f,j,0);1b h=0;1k(1b g=0;g<j.1f;g++){h+=j[g]}1d h},Ck:1c(h,l,g,n,f){if(n.1f<=f){n.1h(0)}1b p=0;1b o=1u;1b q;if(f<1a.aZ.1f){q=1a.aZ[f];if(q>0){o=1m;p=q}}1b j;if(!o){p=n[f];1k(j=0;j<h.1f;j++){1b k=h[j];q=k.4V();if(k===l){q=g}if(p<q){p=q}}}1k(j=0;j<h.1f;j++){1a.Ck(h[j].2n(),l,g,n,f+1)}n[f]=p},E1:1c(l,j,o){if(j.1f<=o){j.1h(0)}1b h=0;1b k=1u;if(o<1a.b9.1f){1b g=1a.b9[o];if(g>0){k=1m;h=g}}1b f;if(!k){h=j[o];1k(f=0;f<l.1f;f++){1b n=l[f];if(h<n.5l()){h=n.5l()}}}1k(f=0;f<l.1f;f++){1a.E1(l[f].2n(),j,o+1)}j[o]=h},Os:1c(k,h){1b j=[];1a.Cj(1a.4i.2n(),k,h,j,0);1b f=0;1k(1b g=0;g<j.1f;g++){f+=j[g]}1d f},Cj:1c(h,o,p,j,f){if(j.1f<=f){j.1h(0)}1b q=0;1b n=1u;1b g;if(f<1a.b9.1f){g=1a.b9[f];if(g>0){n=1m;q=g}}1b k;if(!n){q=j[f];1k(k=0;k<h.1f;k++){1b l=h[k];g=l.5l();if(l===o){g=p}if(q<g){q=g}}}1k(k=0;k<h.1f;k++){1a.Cj(h[k].2n(),o,p,j,f+1)}j[f]=q},gK:1c(g){if(g.1f===0){1d 0}1b h=0;1k(1b f=0;f<g.1f;f++){h=1s.1U(h,1a.gK(g[f].2n()))}1d h+1},Eo:1c(n,k,j){if(!k){if(n<1a.aZ.1f){1b f=1a.aZ[n];if(f>0){1d f}}k=1a.4I.2n()}if(!j){j=0}1b h=0;1b g;if(n===j){1k(g=0;g<k.1f;g++){1b l=k[g];if(h<l.4V()){h=l.4V()}}1d h}1k(g=0;g<k.1f;g++){h=1s.1U(h,1a.Eo(n,k[g].2n(),j+1))}1d h},Eh:1c(n,k,j){if(!k){if(n<1a.b9.1f){1b g=1a.b9[n];if(g>0){1d g}}k=1a.4i.2n()}if(!j){j=0}1b h=0;1b f;if(n===j){1k(f=0;f<k.1f;f++){1b l=k[f];if(h<l.5l()){h=l.5l()}}1d h}1k(f=0;f<k.1f;f++){h=1s.1U(h,1a.Eh(n,k[f].2n(),j+1))}1d h},QE:1c(h,f,g){if(h===g.4x){g.1w=f}1l{if(g.Qu){if(h.E8(g.4x)){g.1w=f.9I(g.1w)}}}},rQ:1c(g){if(g.2n().1f===0){1d}1b f=g.2n()[g.2n().1f-1];if(f.2n().1f===0){if(g.cn()){1a.Df(f)}1l{1a.Dg(f)}1a.D5(g);1d}1a.rQ(f)},D5:1c(g){if(g.2n().1f>0){1d}1b f=g.3o();if(!f){1d}if(g.a8()){1a.Dg(g)}1l{1a.Df(g)}1a.D5(f)},CI:1c(n,g){1b h={4x:n,Qu:g};1b l=1a;1b k=1c(q,o,p){l.QE(q,o,p)};1b f=0;1b j=0;if(1a.cX&&1a.1t.gA&&1a.1t.gy){f=1a.1t.gA();j=1a.1t.gy()}1a.qN(k,f,j,h);1a.qT(k,f,j,h);1d h.1w},TH:1c(){1d 1a.CI(1a.4I,1m)},TO:1c(){1d 1a.CI(1a.4i,1m)},SI:1c(w){1b h=-1;1b t=-1;1b k=-1;1b p=-1;if(w.A5&&w.zw&&w.zy&&w.AU){h=w.A5();t=w.zw();k=w.zy();p=w.AU()}1l{1k(1b q=0,v=1a.2C.b3();q<v;q++){1k(1b f=0,o=1a.2C.cm();f<o;f++){if(1a.2C.1G(q,f)==w){h=q;t=q;k=f;p=f;1Q}}if(h!==-1){1Q}}}if(h!==-1){1b u=1a.8E+1a.em();1b s=1a.8L+1a.dO();1b g=0;1b z=0;1b n;1b l;1k(n=0;n<h;n++){u+=1a.6c(n).5l()}1k(l=0;l<k;l++){s+=1a.4S(l).4V()}1k(n=h;n<=t;n++){g+=1a.6c(n).5l()}1k(l=k;l<=p;l++){z+=1a.4S(l).4V()}1d 1g b(u,s,g,z)}1d b.7s},Tc:1c(){1d 1a.4I.2n()},Vc:1c(){1d 1a.4i.2n()},b3:1c(){1b h=0;1b j=1a.4I.2n();1k(1b g=0,f=j.1f;g<f;g++){1b k=j[g];h+=k.c2()}1d h},Vx:1c(h){if(h<0){1d}1b j=1a.b3();if(h===j){1d}if(h>j){1k(1b g=0;g<h-j;g++){1a.MU(1g e.kG(),1a.4I)}}if(h<j){1b f=j-h;2L(f>0){1a.rQ(1a.4I);f--}}},cm:1c(){1b h=0;1b j=1a.4i.2n();1k(1b g=0,f=j.1f;g<f;g++){1b k=j[g];h+=k.c2()}1d h},Vy:1c(j){if(j<0){1d}1b f=1a.cm();if(j==f){1d}if(j>f){1k(1b g=0;g<j-f;g++){1a.N2(1g e.kG(),1a.4i)}}if(j<f){1b h=f-j;2L(h>0){1a.rQ(1a.4i);h--}}},1G:1c(h,n){if(!mz(h)&&!mz(n)){1d 1a.2C.1G(h,n)}if(n&&n.2n&&n.2n().1f===0&&h&&h.2n&&h.2n().1f===0){1b g=1a.bG(h);1b o=1a.bG(n);1d 1a.2C.1G(g,o)}1l{if(!h||!h.2n){h=1a.4I}if(!n||!n.2n){n=1a.4i}1b l=1a.bG(h);1b j=l+h.c2()-1;1b k=1a.bG(n);1b f=k+n.c2()-1;1d 1g e.DH(1a,l,j,k,f)}},Vz:1c(){1d 1a.8E},Vu:1c(f){if(1a.8E===f){1d}1a.8E=f;1a.1F()},VE:1c(){1d 1a.8L},VA:1c(f){if(1a.8L===f){1d}1a.8L=f;1a.1F()},OE:1c(){1d 1a.b6},VB:1c(h){if(h<=0){1d}if(1a.b6===h){1d}1a.b6=h;1k(1b g=0,f=1a.4I.2n().1f;g<f;g++){1b j=1a.4I.2n()[g];j.mo(1a.b6)}},dO:1c(){1b h=[];1a.DQ(1a.4I.2n(),h,0);1b g=0;1k(1b f=0;f<h.1f;f++){g+=h[f]}1d g},em:1c(){1b h=[];1a.E1(1a.4i.2n(),h,0);1b f=0;1k(1b g=0;g<h.1f;g++){f+=h[g]}1d f},Et:1c(){1d 1a.gK(1a.4I.2n())},Eg:1c(){1d 1a.gK(1a.4i.2n())},Vi:1c(){1d 1a.eh},Vj:1c(f){if(1a.eh===f){1d}1a.eh=f;1a.1F()},O7:1c(){1d 1a.gQ},Vk:1c(f){if(1a.gQ===f){1d}1a.gQ=f;1a.1F()},Vr:1c(){1d 1a.cX},Vs:1c(f){if(1a.cX===f){1d}1a.cX=f;1a.1F()},Vt:1c(){1d 1a.el},Vo:1c(f){if(1a.el===f){1d}1a.el=f;1a.1F()},Vq:1c(){1d 1a.b9},US:1c(f){if(!f){4R 1g 5h("eS 2A Na N9 kS be 1j.")}1a.b9=f;1a.1F()},Uk:1c(){1d 1a.aZ},Ui:1c(f){if(!f){4R 1g 5h("eS 2A Na N9 kS be 1j.")}1a.aZ=f;1a.1F()},qT:1c(g,v,u,F){1b r=1a.dO();1b B=1a.em();1b I=1a.Et();1b n=1a.8L;1b t=[];1b z=1g c();1b C;1k(1b D=0,w=1a.4I.2n().1f;D<w;D++){C=1a.4I.2n()[D];t.1h(C);z.2p(C,n)}1b f=0;2L(t.1f>0){1b o=1a.8E+B;1b G=1a.Eo(f);1b s=[];1b H=1g c();1k(1b D=0;D<t.1f;D++){1b C=t[D];if(C.2n().1f===0){if(f!==I-1){s.1h(C);H.2p(C,z.1G(C));o+=C.5l();2t}}1b q=o;1b p=z.1G(C);1b k=1g 1e.1z.2O(q,p,C.5l(),n+G-p);k.y+=u;g(C,k,F);o+=C.5l();1k(1b A=0,E=C.2n().1f;A<E;A++){1b h=C.2n()[A];s.1h(h);H.2p(h,n+G)}}n+=G;f++;t=s;z=H}},qN:1c(g,w,v,G){1b s=1a.dO();1b C=1a.em();1b I=1a.Eg();1b p=1a.8E;1b u=[];1b A=1g c();1b D;1k(1b E=0,z=1a.4i.2n().1f;E<z;E++){1b D=1a.4i.2n()[E];u.1h(D);A.2p(D,p)}1b f=0;2L(u.1f>0){1b o=1a.8L+s;1b k=1a.Eh(f);1b t=[];1b H=1g c();1k(1b E=0;E<u.1f;E++){1b D=u[E];if(D.2n().1f===0){if(f!==I-1){t.1h(D);H.2p(D,A.1G(D));o+=D.4V();2t}}1b r=A.1G(D);1b q=o;1b n=1g 1e.1z.2O(r,q,p+k-r,D.4V());n.x+=w;g(D,n,G);o+=D.4V();1k(1b B=0,F=D.2n().1f;B<F;B++){1b h=D.2n()[B];t.1h(h);H.2p(h,p+k)}}p+=k;f++;u=t;A=H}},Ua:1c(f){1a.Lk(f);if(!1a.el){1a.El(f)}},U6:1c(f){if(1a.el){1a.El(f)}},El:1c(g){1b h={3R:g};1b l=1a;1b k=1c(p,n,o){l.LR(p,n,o)};1b f=0;1b j=0;if(1a.cX&&1a.1t.gA&&1a.1t.gy){f=1a.1t.gA();j=1a.1t.gy()}1a.qT(k,f,j,h);1a.qN(k,f,j,h);if(1a.2C.b3()>0&&1a.2C.cm()>0){1a.O8(g,f,j)}},O8:1c(h,n,l){1b j=1a.dO();1b q=1a.em();1b f=1g 1e.1z.2O(1a.8E+n,1a.8L+l,q,j);if(1a.eh){1a.rn(h,f,1a.eh)}1b g=1a.l5(1a.eh);1b r=1a.hK(1a.eh);1b p=1a.9R(1a.eh);1b o=1a.rs(1a.eh);1b k=1a.rw(1a.eh);1a.hn(h,1a.O7(),g,r,o,k,p,f,1u)},rn:1c(k,f,g){1b h=1e.1i.1A.7g(k,1a.PM(g),f);if(h){k.8Q=h;k.iT(f.x,f.y,f.1q,f.1p)}1b l=1a.Qd(g);1b o=1a.Me(g);if(l&&o){k.ck();k.6V(f.3M(),f.3Z());k.3D(f.3M(),f.2V());k.6U=l;k.7i=o/k.7w;k.3P()}1b p=1a.LW(g);1b s=1a.LE(g);if(p&&s){k.ck();k.6V(f.3M(),f.3Z());k.3D(f.2y(),f.3Z());k.6U=p;k.7i=s/k.7w;k.3P()}1b n=1a.Nm(g);1b r=1a.Np(g);if(n&&r){k.ck();k.6V(f.2y(),f.3Z());k.3D(f.2y(),f.2V());k.6U=n;k.7i=r/k.7w;k.3P()}1b q=1a.Ni(g);1b j=1a.MN(g);if(q&&j){k.ck();k.6V(f.3M(),f.2V());k.3D(f.2y(),f.2V());k.6U=q;k.7i=j/k.7w;k.3P()}},hn:1c(h,s,t,j,z,g,u,n,w){if(!s){1d}h.8D();h.sg(n.x,n.y,n.1q,n.1p);h.iU();1b B=0;if(w){if(n.1q<n.1p){B=1s.1U(n.1q,n.1p)/2}1l{B=1s.2b(n.1q,n.1p)/2}h.8f(n.x+B,n.y+B);h.Dy(3*1s.PI/2);h.8f(-n.x-B,-n.y-B)}h.8Q=u;h.O3="3Z";h.2i=j+"px "+t;1b l=n.1q;1b q=n.1p;if(w){l=n.1p;q=n.1q}1b k=j;1b f=1a.Nw(h,s,l);if(f){1b p=n.x;1b o=n.y;h.qZ="3M";if(z==1e.1i.3q.4H){if(w){p=n.x+B}1l{p=n.x+n.1q/2}h.qZ="4e"}if(z==1e.1i.3q.ek){if(w){p=n.x+2*B}1l{p=n.x+n.1q}h.qZ="2y"}1b A=f.1f*k;if(A<q){if(g==1e.1i.3q.4H){o+=(q-A)/2}if(g==1e.1i.3q.ek){o+=q-A}}1k(1b v=0;v<f.1f;v++){1b r=f[v];h.O1(r,p,o);o+=k}}h.8N()},Nw:1c(g,l,k){1b p=l.f3("\\n");if(k==3W.5s){1d p}1b o=[];1k(1b h=0;h<p.1f;h++){1b j=p[h].f3(" ");1b n="";1k(1b h=0;h<j.1f;h++){1b f=j[h];m=g.U7(n+f).1q;if(m<k){if(h===0){n+=f}1l{n+=" "+f}}1l{if(n!=""){o.1h(n)}n=f}if(h===j.1f-1){o.1h(n);1Q}}}1d o},LR:1c(j,f,q){1b o=q;1b h=q.3R;1a.rn(h,f,j.cG());1b p=j.cG();1b g=1a.l5(p);1b r=1a.hK(p);1b n=1a.9R(p);1b l=1a.rs(p);1b k=1a.rw(p);1a.hn(h,j.DM(),g,r,l,k,n,f,j.Mj())},Lk:1c(j){1b u=1a.dO();1b A=1a.em();1b t=1a.8E+A;1k(1b D=0;D<1a.b3();D++){1b l=1a.6c(D);1b o=l.5l();1b s=1a.8L+u;1k(1b z=0;z<1a.cm();z++){1b p=1a.4S(z);1b h=p.4V();1b g=1a.2C.1G(D,z);1b q=1g 1e.1z.2O(t,s,o,h);s+=p.4V();1b C=g.cG();1a.rn(j,q,C);1b v=g.6g();if(v){1b w=1a.l5(C);1b k=1a.hK(C);1b n=1a.9R(C);1b B=1a.rs(C);1b f=1a.rw(C);1a.hn(j,g.6g(),w,k,B,f,n,q,1u)}}t+=l.5l()}},mT:1c(g,h){1k(1b f=0;f<g.1f;f++){if(g[f].2B.1f==0){h.1h(g[f]);2t}1a.mT(g[f].2B,h)}},hY:1c(q,k){1b l=1a.dO();1b o=1a.Qe(q,k);1b n=[];1a.mT(1a.4i.2B,n);1b j=[];1a.mT(1a.4I.2B,j);if(o!=l){1b p=l-o;1b s=1a.b3();1b v=1a.cm();1b w=1a.8E+1a.em();1k(1b t=0;t<s;t++){1b u=1a.8L+1a.dO();1k(1b h=0;h<v;h++){1b z=1a.2C.1G(t,h);1b g=1g b(w,u,j[t].1q,n[h].1p);1b f=g;f.y-=p;u+=n[h].1p}w+=j[t].1q}}},jY:1c(p,k){1b l=1a.em();1b q=1a.Os(p,k);1b n=[];1a.mT(1a.4i.2B,n);1b j=[];1a.UF(1a.4I.2B,j);if(q!=l){1b o=l-q;1b s=1a.b3();1b v=1a.cm();1b w=1a.8E+1a.em();1k(1b t=0;t<s;t++){1b u=1a.8L+dO();1k(1b h=0;h<v;h++){1b z=1a.2C.1G(t,h);1b g=1g b(w,u,j[t].1q,n[h].1p);1b f=g;f.x-=o;u+=n[h].1p}w+=j[t].1q}}},8I:1c(f){if(1a.1t){1b g=1a.1t.1P;if(g&&f.3F(g)){1d g}1b j=1a.1t.9y;if(j){1b h=1a.7u(f,j);if(h){1d h}}}1d 1a.7u(f,1e.1i.hc.9j)},7u:1c(f,h){1b g=h.3E["3b:4c"];if(g){if(f.3F(g)){1d g}}1d 1j},8R:1c(j,f,h){1b k;if(j){k=f.3F(j);if(k!==1v){1d k}}if(1a.1P){k=f.3F(1a.1P);if(k!==1v){1d k}}if(h){1b g=1a.8I(h);if(g){1d h.3F(g)}}},PM:1c(f){1b g=1a.8R(f,e.1X.1n.uz,1e.1i.1X.1n.7g);if(g!==1v){1d g}1d"9D"},Qd:1c(f){1b g=1a.8R(f,e.1X.1n.uE,1e.1i.1X.1n.j9);if(g!==1v){1d g}1d"8k"},Me:1c(f){1b g=1a.8R(f,e.1X.1n.tX,1e.1i.1X.1n.j6);if(g!==1v){1d g}1d 0},LW:1c(f){1b g=1a.8R(f,e.1X.1n.tG,1e.1i.1X.1n.j9);if(g!==1v){1d g}1d"8k"},LE:1c(f){1b g=1a.8R(f,e.1X.1n.pG,1e.1i.1X.1n.j6);if(g!==1v){1d g}1d 0},Nm:1c(f){1b g=1a.8R(f,e.1X.1n.pE,1e.1i.1X.1n.j9);if(g!==1v){1d g}1d"8k"},Np:1c(f){1b g=1a.8R(f,e.1X.1n.qp,1e.1i.1X.1n.j6);if(g!==1v){1d g}1d 0},Ni:1c(f){1b g=1a.8R(f,e.1X.1n.p0,1e.1i.1X.1n.j9);if(g!==1v){1d g}1d"8k"},MN:1c(f){1b g=1a.8R(f,e.1X.1n.qv,1e.1i.1X.1n.j6);if(g!==1v){1d g}1d 0},l5:1c(f){1b g=1a.8R(f,e.1X.1n.iD,1e.1i.1X.1n.iD);if(g!==1v){1d g}1d"nN-nt"},hK:1c(f){1b g=1a.8R(f,e.1X.1n.il,1e.1i.1X.1n.il);if(g!==1v){1d g}1d 4},9R:1c(f){1b g=1a.8R(f,e.1X.1n.e2,1e.1i.1X.1n.e2);if(g!==1v){1d g}1d"8k"},rs:1c(f){1b g=1a.8R(f,e.1X.1n.8F);if(g!==1v){1d g}1d 3q.4H},rw:1c(f){1b g=1a.8R(f,e.1X.1n.9c);if(g!==1v){1d g}1d 3q.4H},6c:1c(f){1d 1a.nD(1a.4I.2n(),f)},4S:1c(f){1d 1a.nD(1a.4i.2n(),f)},MY:1c(h,f,g){if(f.2M(g.N0)){g.NX=h;g.9q=f}},MK:1c(g,k,h){if(!h){h=1g d(0,0)}1b j={N0:g};1b o=1a;1b n=1c(r,p,q){o.MY(r,p,q)};1b f=0;1b l=0;if(1a.cX&&h){f=h.x;l=h.y}1a.qT(n,f,l,j);1a.qN(n,f,l,j);if(k){k.9q=j.9q}1d j.NX},Nx:1c(o,n){1b l=o.x-1a.em()-1a.8E;1b k=o.y-1a.dO()-1a.8L;1b g=0;1b q=0;if(l<0||k<0){1d}1b h=-1;1b s=-1;1k(1b j=0,p=1a.2C.b3();j<p;j++){g=1a.6c(j).5l();l-=g;if(l<0){h=j;1Q}}1k(1b f=0;f<1a.2C.cm();f++){q=1a.4S(f).4V();k-=q;if(k<0){s=f;1Q}}if(h>=0&&s>=0){if(n){n.LT=1g 1e.1z.2O(o.x-l-g,o.y-k-q,g,q);n.3y=h;n.2A=s}1d 1a.2C.1G(h,s)}1d 1j},Sh:1c(f){1k(1b k=0,g=1a.b3();k<g;k++){1k(1b h=0,j=1a.cm();h<j;h++){if(1a.2C.1G(k,h)===f){1d k}}}1d-1},S8:1c(f){1k(1b k=0,g=1a.b3();k<g;k++){1k(1b h=0,j=1a.cm();h<j;h++){if(1a.2C.1G(k,h)===f){1d h}}}1d-1},Sc:1c(f){if(f.2n().1f>0){1d-1}if(f.a8()){1d-1}1d 1a.bG(f)},Sf:1c(f){if(f.2n().1f>0){1d-1}if(f.cn()){1d-1}1d 1a.bG(f)},nD:1c(j,f){1b h=0;1k(1b g=0;g<j.1f;g++){1b n=j[g];1b l=h;1b k=l+n.c2()-1;if(n.2n().1f===0){if(l<=f&&f<=k){1d n}}if(l<=f&&f<=k){1d 1a.nD(n.2n(),f-h)}h=k+1}1d 1j},1F:1c(f){if(1a.1t){1a.1t.1F();if(f===1v){f=1m}if(f&&1a.1t.2S){1a.1t.2S(1m)}}},cG:1c(){1d 1a.1P},DX:1c(){1d 1a.eD},DL:1c(f){1a.eD=f},Sg:1c(){1d 1a.ej},Se:1c(f){1a.ej=f}};1e.1Z(a,"1e.1i.4j.mr")})(1e.1i.4j);(1c(a){1b b=a.kG=1c(){1o.2u(b,1a);1a.2B=[];1a.1q=0;1a.1p=0;1a.jf=1e.1i.4j.ec.hq;1a.gn="";1a.hf=1u;1a.m2="#4T";1a.1P=1g a.1X()};b.1n={2E:1c(d){1a.2B=[];1k(1b c=0;c<d.2B.1f;c++){1b e=1g a.kG();e.2E(d.2B[c]);e.1t=1a;1a.2B.1h(e)}1a.1q=d.1q;1a.1p=d.1p;1a.jf=d.jf;1a.gn=d.gn;1a.hf=d.hf;1a.m2=d.m2;if(d.1P){1a.1P.2E(d.1P)}if(1a.4V()===0){1a.1p=20}},2k:1c(){1b c={2B:1a.Mq(),1q:1a.1q,1p:1a.1p,jf:1a.jf,gn:1a.gn,hf:1a.hf,m2:1a.m2,1P:1a.1P.2k()};1d c},Mq:1c(){1b c=[];1k(1b d=0;d<1a.2B.1f;d++){c.1h(1a.2B[d].2k())}1d c},E8:1c(c){if(1a.1t===c){1d 1m}if(!1a.1t){1d 1u}1d 1a.1t.E8(c)},fV:1c(c){1a.1t=c},My:1c(f,g){if(1a.2B.1f===0){1d}1b p=0;1b e=0;1k(1b h=0;h<1a.2B.1f;h++){1b j=1a.2B[h];if(j.fS()===1e.1i.4j.ec.hq){p++;e+=j.5l()}}1b c=1a.f8();if(f<g){if(p>0){1b o=g-f;1k(1b h=0;h<1a.2B.1f;h++){1b j=1a.2B[h];if(j.fS()===1e.1i.4j.ec.hq){j.lc(j.5l()+o*j.5l()/e)}}}1l{1b d=1a.2B[1a.2B.1f-1];d.lc(d.5l()+g-f)}}1l{1b l=0;if(p>0){1b n=f-g;1k(1b h=0;h<1a.2B.1f;h++){1b j=1a.2B[h];if(j.fS()===1e.1i.4j.ec.hq){1b k=j.5l()-n*j.5l()/e;if(k<c){l=c-k;k=c}j.lc(k)}}}1l{l=f-g}if(l>0){1k(1b h=1a.2B.1f-1;h>=0;h--){1b j=1a.2B[h];if(j.fS()===1e.1i.4j.ec.Eb){1b k=j.5l()-l;if(k<c){k=c}j.lc(k)}}}}},MB:1c(n,c){if(1a.2B.1f===0){1d}1b o=0;1b p=0;1k(1b g=0;g<1a.2B.1f;g++){1b h=1a.2B[g];if(h.fS()===1e.1i.4j.ec.hq){o++;p+=h.4V()}}1b e=1a.f8();if(n<c){if(o>0){1b l=c-n;1k(1b g=0;g<1a.2B.1f;g++){1b h=1a.2B[g];if(h.fS()===1e.1i.4j.ec.hq){h.le(h.4V()+l*h.4V()/p)}}}1l{1b f=1a.2B[1a.2B.1f-1];f.le(f.4V()+c-n)}}1l{1b j=0;if(o>0){1b k=n-c;1k(1b g=0;g<1a.2B.1f;g++){1b h=1a.2B[g];if(h.fS()===1e.1i.4j.ec.hq){1b d=h.4V()-k*h.4V()/p;if(d<e){j=e-d;d=e}h.le(d)}}}1l{j=n-c}if(j>0){1k(1b g=1a.2B.lY-1;g>=0;g--){1b h=1a.2B[g];if(h.fS()===1e.1i.4j.ec.Eb){1b d=h.4V()-j;if(d<e){d=e}h.le(d)}}}}},mo:1c(d){if(1a.2B.1f===0){if(1a.1q<d){1a.1q=d}}1l{1k(1b c=0;c<1a.2B.1f;c++){1a.2B[c].mo(d)}}},v4:1c(c){if(1a.2B.1f===0){if(1a.1p<c){1a.1p=c}}1l{1k(1b d=0;d<1a.2B.1f;d++){1a.2B[d].v4(c)}}},E5:1c(){1a.1q=0;1k(1b c=0;c<1a.2B.1f;c++){1a.2B[c].gv(0)}},E3:1c(){1a.1p=0;1k(1b c=0;c<1a.2B.1f;c++){1a.2B[c].hi(0)}},kN:1c(c){if(1a.1t){1a.1t.kN(c)}},lc:1c(e){if(1a.cn()){if(e<1a.f8()){e=1a.f8()}}1l{if(e<0){e=0}}if(1a.1q===e){1d}1b d=1a.1q;if(1a.2B.1f===0){1a.1q=e;1d}1b c=1a.5l();1a.1q=e;if(1a.cn()){1a.My(c,1a.1q)}if(1a.a8()){1a.jY(1a,d)}},le:1c(c){if(1a.a8()){if(c<1a.f8()){c=1a.f8()}}1l{if(c<0){c=0}}if(1a.1p===c){1d}1b e=1a.1p;if(1a.2B.1f===0){1a.1p=c;if(1a.cn()){1a.1t.hY(1a,e)}1d}1b d=1a.4V();1a.1p=c;if(1a.a8()){1a.MB(d,1a.1p)}if(1a.cn()){1a.hY(1a,e)}},hY:1c(d,c){1a.1t.hY(d,c)},jY:1c(d,c){1a.1t.jY(d,c)},3o:1c(){1d 1a.1t},2n:1c(){1d 1a.2B},c2:1c(){if(1a.2B.1f===0){1d 1}1b c=0;1k(1b d=0;d<1a.2B.1f;d++){c+=1a.2B[d].c2()}1d c},5l:1c(){if(1a.2B.1f===0){1d 1a.1q}if(1a.a8()){1d 1a.1q}1b c=0;1k(1b d=0;d<1a.2B.1f;d++){c+=1a.2B[d].5l()}if(c==0){1d 1a.1q}1d c},gv:1c(c){1a.lc(c)},4V:1c(){if(1a.2B.1f==0){1d 1a.1p}if(1a.cn()){1d 1a.1p}1b d=0;1k(1b c=0;c<1a.2B.1f;c++){d+=1a.2B[c].4V()}if(d==0){1d 1a.1p}1d d},hi:1c(c){1a.le(c)},fS:1c(){1d 1a.jf},Rq:1c(c){1a.jf=c},DM:1c(){1d 1a.gn},Ru:1c(c){if(1a.gn===c){1d}1a.gn=c;1a.kN(1a)},Mj:1c(){1d 1a.hf},Rs:1c(c){if(1a.hf===c){1d}1a.hf=c;1a.kN(1a)},cG:1c(){1d 1a.1P},iR:1c(c){if(!c){1d}if(1a.1P===c){1d}1a.1P=c;1a.kN(1a)},cn:1c(){if(1a.1t){1d 1a.1t.cn()}1d 1u},a8:1c(){if(1a.1t){1d 1a.1t.a8()}1d 1u},f8:1c(){if(1a.1t){1d 1a.1t.f8()}1d 0}};1e.1Z(b,"1e.1i.4j.kG")})(1e.1i.4j);(1c(b){1b c=1e.1i.1A;1b d=1e.1z.5t;1b a=b.Ek=1c(e,h,g,f){1o.2u(a,1a,[e]);1a.4x=h;1a.eO=g;1a.Rl=1g 1e.1z.9t(0,0);1a.Re=1g 1e.1z.5k(0,0);1a.9q=f};a.1n={6H:1c(g){1a.9d=1m;1b h=c.7t(g,1a.1H.2e());1b f=1a.1H.7B(h);if(1a.eO){1a.7y=1a.a3=f.x}1l{1a.7y=1a.a3=f.y}},5R:1c(k){if(!1a.9d){1d}1b l=c.7t(k,1a.1H.2e());1b h=1a.1H.7B(l);if(1a.eO){1a.7y=h.x;1b g=1a.9q.1q;1b j=1s.1U(d.3h(1a.1H.2o),1a.9q.1q+(1a.7y-1a.a3));1a.gv(j);if(!1a.1H.DN(1a.4x,1a.eO)){1a.gv(g)}1l{1a.7K=1m}if(g!=1a.9q.1q){1a.a3=1a.7y}}1l{1a.7y=h.y;1b n=1a.9q.1p;1b f=1s.1U(d.3h(1a.1H.2o),1a.9q.1p+(1a.7y-1a.a3));1a.hi(f);if(!1a.1H.DN(1a.4x,1a.eO)){1a.hi(n)}1l{1a.7K=1m}if(n!=1a.9q.1p){1a.a3=1a.7y}}1a.1H.1F()},6j:1c(f){if(1a.7K){1a.1H.PS(1a.4x,1a.eO)}1a.9d=1u;1a.7K=1u},5z:1c(){},E9:1c(l){1b e=[];1b j=l.1t;if(j.1t){1k(1b h=0;h<j.1t.2B.1f;h++){1b f=j.1t.2B[h];1k(1b g=0;g<f.2B.1f;g++){e.1h(f.2B[g])}}}1l{1k(1b h=0;h<j.2B.1f;h++){e.1h(j.2B[h])}}1d e},hi:1c(e){if(1a.4x.a8()){1a.4x.hi(e)}1l{1b g=1a.E9(1a.4x);1k(1b f=0;f<g.1f;f++){g[f].hi(e)}}},gv:1c(f){if(1a.4x.a8()){1b g=1a.E9(1a.4x);1k(1b e=0;e<g.1f;e++){g[e].gv(f)}}1l{1a.4x.gv(f)}}};1e.1Z(a,"1e.1i.4j.Ek",1e.1i.gD)})(1e.1i.4j);(1c(b){1b a=b.uy=1c(c,d){1o.2u(a,1a);1a.5w=c;1a.4i=d};a.1n={2E:1c(c){1o.2a(a,1a,"2E",[c]);1a.4i=c.4i},2k:1c(){1b c=1o.2a(a,1a,"2k",[]);c.4i=1a.4i;1d c},kN:1c(c){if(1a.5w){1a.5w.1F()}},cn:1c(){1d!1a.4i},a8:1c(){1d 1a.4i},f8:1c(){1d 1a.5w.OE()},hY:1c(d,c){1a.5w.hY(d,c)},jY:1c(d,c){1a.5w.jY(d,c)}};1e.1Z(a,"1e.1i.4j.uy",b.kG)})(1e.1i.4j);(1c(b){1b a=b.1X=1c(){1o.2u(a,1a)};a.1n={2E:1c(c){1a.lS=c.lS;1a.jm=c.jm;1a.k1=c.k1||1;1a.k8=c.k8;1a.km=c.km||1;1a.jS=c.jS;1a.lA=c.lA||1;1a.lv=c.lv;1a.lw=c.lw||1;1a.2D=c.2D;1a.6J=c.6J;1a.6q=c.6q;1a.4a=c.4a;1a.4p=c.4p},2k:1c(){1b c={lS:1a.lS,jm:1a.jm,k1:1a.k1,k8:1a.k8,km:1a.km,jS:1a.jS,lA:1a.lA,lv:1a.lv,lw:1a.lw,2D:1a.2D,6J:1a.6J,6q:1a.6q,4a:1a.4a,4p:1a.4p};1d c},uz:1c(){1d 1a.lS},DD:1c(c){1a.lS=c},uE:1c(){1d 1a.jm},DE:1c(c){1a.jm=c},tX:1c(){1d 1a.k1},tC:1c(c){1a.k1=c},tG:1c(){1d 1a.k8},DB:1c(c){1a.k8=c},pG:1c(){1d 1a.km},pH:1c(c){1a.km=c},pE:1c(){1d 1a.jS},DA:1c(c){1a.jS=c},qp:1c(){1d 1a.lA},p3:1c(c){1a.lA=c},p0:1c(){1d 1a.lv},DK:1c(c){1a.lv=c},qv:1c(){1d 1a.lw},rV:1c(c){1a.lw=c},e2:1c(){1d 1a.2D},dS:1c(c){1a.2D=c},iD:1c(){1d 1a.6J},mC:1c(c){1a.6J=c},il:1c(){1d 1a.6q},n2:1c(c){1a.6q=c},8F:1c(){1d 1a.4a},6x:1c(c){1a.4a=c},9c:1c(){1d 1a.4p},6F:1c(c){1a.4p=c}};1e.1Z(a,"1e.1i.4j.1X")})(1e.1i.4j);',62,3951,"||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||this|var|function|return|MindFusion|length|new|push|Diagramming|null|for|else|true|prototype|mflayer|height|width|points|Math|parent|false|undefined|bounds|destination|index|Drawing|Utils|forEach|node|Shape|origin|invalidate|get|diagram|fromId|clone|text|outline|Shapes|shape|L100|style|break|items|Events|case|max|brush|L50|Style|isInstanceOfType|registerClass|||||||||||callBaseMethod|min|contains||get_element|rotationAngle|edges|link|font|pen|toJson|raiseEvent|addChildElement|getSubHeaders|measureUnit|set|vertices|originConnection|getBounds|continue|initializeBase|strokeThickness|item|destinationConnection|right|layers|row|subHeaders|cells|textColor|fromJson|prepareScriptEvent|A50|content|nodeEffects|283185307179586|gridPosition|while|containsPoint|container|Rect|decoration|readInt|captionHeight|setDirty|Collections|rows|bottom|path|setAttribute|params|DiagramNode|||||||||||type|std|getAttribute|anchorPointDetails|M100|strokeDashStyle|setBounds|getMillimeter|selection|abs|scroller|remove|writeInt|nodes|getParent|document|Alignment|labels|color|createDelegate|add|M50|image|tag|column|Action|scale|children|parentNode|lineTo|styles|apply|DiagramLink|undoManager|textRenderer|adjustmentHandle|margin|links|left|Graphs|writeBool|stroke|L60|context|outEdges|enabled|readBool|ContainerNode|Number|nodeDistance|setDiagramDirty|top|||||||||||textAlignment|mousePosition|Diagram|anchorPattern|center|loadFromXml|columns|shapeDecorations|rowHeader|Lanes|updateFromPoints|transparent|delete|graphicsContainer|headShapeRenderer|lineAlignment|LinkShape|point|LayoutDirection|shadowColor|baseShapeSize|headShape|headShapeSize|header|setBrush|direction|NodeUpdateMediator|modifiedItem|transform|None|saveToXml|textSize|readFloat|Center|columnHeader|parseFloat|getElementsByTagName|constructor|NodeEventArgs|L80|window|setShape|toString|throw|getRow|000000|currentScrollRow|getHeight|writeFloat|action|Create|L40|||||addItem||switch||||topLeft|Builder|setInstance|position|effects|fillMode|cascadeStartHorizontal|Error|ArrayList|owner|Point|getWidth|ShapeNode|baseShape|setPen|L90|sort|enabledHandles|MAX_VALUE|GraphicsUnit|Current|parseInt|grid|interaction|cell|cancelDrag|currentBehavior|inflate|getCenter|updateContent|distance|L83|typeof|colorStops|padding|getRect|shapeRenderer|shadowOffsetY|shadowOffsetX|addHandlers|pow|getOutline|baseShapeRenderer|onMouseMove|button|L30|boxes|backBrush|inplaceTextBox|L70|repaint|autoRoute|||||||||||L25|addEventListener|getColumn|expanded|L20|shapeLibraryLocation|getText|Rectangle|floor|onMouseUp|mouseButton|inEdges|scrollTop|Type|currentCursor|readBrush|fontSize|indexOf|scrollLeft|slice|interactionState|location|folded|setTextAlignment|arguments|suppressSetDirty|rotatePointAt|selected|isHorizontal|allowIncomingLinks|handlesStyle|setLineAlignment|AdjustmentHandles|onMouseDown|writeBrush|fontName|dummy|textStyle|closed|getRotatedBounds|blue|anchoring|setText|currentPoint|L10|value|strokeStyle|moveTo|imageAlign|cancel|C100|orientation|||||||||||allowRemoveChildren|expandButton|args|magnifierRenderer|Bezier|table|getBrush|radius|lineWidth|tooltip|startDrag|captionFont|tree|trackerRect|assistantPosition|allowOutgoingLinks|Modify|obstacle|empty|getCursorPos|resolveInheritedStyle|evenodd|_mf_scale|data|current|getOtherEnd|LinkEventArgs|clientToDoc|sender|dynamic|allowAddChildren|L85|param|L75|zOrder|connectionStyle|resizing|indexInLayer|margins|rgbToString|outlineBrush|red|backgroundImage|green|unfoldedSize|loadFromLibPending|Horizontal|captionBackBrush|readString|cartesianToPolarDegrees|masterNode|instanceId|||||||||||getMinDist|layer|handleAtPoint|currentPhase|ignoreLayout|translate|L55|keepGroupLayout|cellFrameStyle|180|black|lastTouch|offsetBranch|Left|hyperLink|getCell|weight|hitTest|__typeName|Font|Dictionary|init|outlinePen|rotateText|outgoingLinks|targetConnection|DiagramItem|incomingLinks|rotateImage|save|leftMargin|getTextAlignment|edge|L45|resolveEffectiveStyle|Value|L77|topMargin|activeItem|restore|splice|defaultShape|fillStyle|getEffectivePropertyValue|polarToCartesianDegrees|updateLocation|iconSize|headStrokeDashStyle|getPropertyValue|setPropertyValue|rowSpan|level||||||||images|||imageLocation|getTopLevel|getLineAlignment|mouseDown|autoHandlesItem|saveState|showGrid|linkBaseShape|L13|Default|getEffectiveStrokeThickness|magnifierShape|graph|horizontalOffset|DummyNode|columnSpan|headerBounds|measureString|outlinePath|Size|getRotationAngle|focusDiv|onStartInteraction|selectSingleNode|theme|getUndoEnabled|color2|fontStyle|headBrush|white|linkHeadShape|AnimationType|rectangles|saveEndRelative|union|baseBrush|pop|angles|color1|fromLTRB|cachedLayoutRect|opacity|InteractionState|getEffectiveTextColor|executeCommand|redo|treeLevels|attachments|incoming|multipleGraphsPlacement|undo|bottomRight|relativePosition|M90|restoreState|last|locked|Cascading|getHandled|topRight|isRowHeader|autoArrange|||||||||||||||||||||||||horizontalAlign|spTreeEdge|getType|notInteractive|allowResizeColumns|columnStyle|verticalAlign|FreeFormNode|textPadding|L15|getEffectiveStroke|Circle|shadow|default|rgba|relativeTo|verticalOffset|allowResizeRows|maxWidth|bottomLeft|headStroke|svgs|weights|MouseCursors|writeString|Text|360|columnHeights|gridSizeY|round|getRotatedRect|getColumnCount|Name|gridSizeX|minHeaderSize|folder|ShapeRenderer|rowWidths|headStrokeThickness||intersectsWith|Orientation||Controls|addRange|reverse|With|control|L61||L87|MouseButtonActions|initialize|setCurrentCursor|getEndPoint||64466||L39|SolidBrush|autoResize|reflectionColor|clipChildren|getEffectiveStrokeDashStyle|manipulators|string|copy|master|expandBounds|imageContent|getIndex|downNodes|expandOnIncoming|backColor|svgString|glowColor|242|getIntersection|alignToGrid|setMouseCursor|intersects|sqrt|shadeColor|expandable|animationType|getVisible|setVisible|Path|35534|Date|Near|captions|getDeepChildCount|removeItem|linkType|arrange|Image|magnifierEnabled|getEffectiveFont|oldText|newText|Index|getCancel|Geometry|Rotate|mouseDownPoint|TableNode|defaultNodeSize|innerOutlineColor|zIndex|beginPath|allowSelfLoops|getRowCount|isColumnHeader|levelDistance|removeLinkFromNode|assistantType|L17|usePenAsGlow|scrollZoneSize|enableStyledText|originalStates|M40|addLinkToNode|branchBounds|rotateAt|lightgray|not|setTag|Property|size|progress|getStyle|ImageAlign|movedNodes|arc|fromVertex|appendChild|setImageContent|getCaptionHeight|Move|backgroundImageAlign|TreeLayoutLinkType|Brush|body|anchorPointVisuals|rotatePointsAt|innerText|startPoint|hookHeaders|magnifierFrameThickness|setRow|undoIndex|execute|Cell|removeHandler|subtract|addVector|Right|getDestination|MarkStyle|getSelected|getAllIncomingLinks|getAllOutgoingLinks|childNodes|getBezierPt|getOrigin|addRect|linkShape|magnifierFactor|linkTextStyle|createElement|linkBrush|textStroke|magnifierSecondaryFrameColor|textStrokeThickness||magnifierWidth|magnifierHeight|hitTestManipulators|Straight|SimpleShape|dashStyle|readColor|allowUnconnectedLinks|||getEnableStyledText|createShadow|root|writeColor|onUpdateVisuals|phase|HorizontalResize|M20|VerticalResize|getInitialPoint|tooltipDelay|L14|gridOffsetY|enableWrap|shouldCancelDrag|getTotalColumnHeight|adjustmentHandlesSize|TreeMapLayoutBuilder|subordinates|setTextColor|sin|rowCount|EventArgs|controlLoaded|gridOffsetX|Cannot|Set|vertex|M10|getTextColor|getNearestBorderPoint|routeLinks|Command|shift|parseType|L67|getSegmentCount|fromPoints|LinearGradientBrush|ResizeType|TopToBottom|upNodes|allowMultipleResize|brth|topLeftAreaStyle|BehaviorBase|allowResizeHeaders|Far|headersOnTop|getTotalRowWidth|strings|keepRootPosition|columnStart|getFoldedContainer|inplaceResources|ContainerNodeBuilder|columnCount|outlineBounds|toValue|Version|classId|LinkTextStyle|cursor|len|repeat|getEditRect|allowInplaceEdit|invalidateLayout|freeFormTargets|getBuilder|patternId|loadImage|func|preventDefaultTouch|state|ModifierKeyAction|applyEffects|resizingHeaderWidth|updateDrag|FreeFormHandle|updateFromEndPoints|The|LinkCrossings|Manipulator|iKa|updateCanvasElements|BorderedTreeLayoutBuilder|SpringLayoutBuilder|linkCrossings|M15|C30|updateAnchorVisibility4|split|getItemAt|invalidParent|showDeleteButton|invalidated|getMinSize|shapes|AnchorPattern|allowIncoming|ShapeNodeBuilder|shapeBrush|allowOutgoing|Pan|DiagramLinkBuilder|replacementFor|LayeredLayoutBuilder|Selection|routeBounds|decorationPath|shapeDecorationPath|makeRect|insert|route|RightToLeft|isStatic|SvgNodeBuilder|TableNodeBuilder|fileName|getShadowOffsetY|getShadowOffsetX|StyleBuilder|dynamicLinks|FractalLayoutBuilder|behavior|linkBaseShapeSize|shapeOrientation|getNearestAnchor|linkHeadShapeSize|getStartPoint|autoScrollAmount|LeftToRight|HandlesStyle|magnifierFrameColor|getPixel|getEffectiveHandlesSize|roundedLinksRadius|autoScroll|laneGrid|FreeFormNodeBuilder|layoutTraits|layoutArea|getResizeType|crossingRadius|getRowRect|setParent|showDisabledHandles|LinkNodesBehavior|Effects|autoCloseDistance|Effect|getTag|freeFormAttractDistance|shadowsStyle|linkHitDistance|fromValue|name|30127|setHeadShape|86583|CounterDiagonalResize|806023|DiagonalResize|setImageLocation|createEdge|currentComposite|MultipleGraphsPlacement|TextVerticalAlignment|getZIndex|onShapeLibraryLoaded|TextAlignment|createVertex|updatePosFromOrgAndDest|title|getNodeAt|Matrix|virtualScroll|getEffectiveBrush|TreeLayoutBuilder|iLa|getFolded|setWidth|19398|L34|getScrollY|getShape|getScrollX|getEffectiveTextStroke|dummificationLevel|Interaction|Line|Select|fitInBounds|duration|easingType|usingContainerNodes|getDepth|13417|magnifierShading|DrawNodesBehavior|degreeToRadian|roundedLinks|topLeftAreaText|setEnableStyledText|Anchoring|angle|decorationPen|linkPen|rowStart|updateLinks|createEditArgs|buttonMappedTo|lineJoin|getSize|getTextToEdit|getHandler|FFFFFF|Outline|valid|the|substring|ShapeDecoration|Decoration|autoAnchorsNode|Theme|addToContext|columnEnd|rotateTitle|showAnchors|equals|setHeight|markStyle|undoHistory|TextBrush|isDummy|drawText|200|backgroundImageUrl|Proportional|modificationStart|updatePathFromPoints|shapePen|its|Points|AnchorPoint|zoomFactor|fill|createElements|dispose|leftButtonDownPos|showLaneGrid|delKeyAction|allowDrag|L89|getHandleAt|DashStyle|addElement|selectionRect|getEffectiveFontSize|C70|getPoints|setLineDash|ColumnStyle|endDrag|classVersion|setsLinkEndPoints|getElementById|close|updateData|preventDefault|writeShape|readShape|onColumnHeaderHeightChanged|onShapeLoaded|Color|Class|nodeSelected|absolute|handled|getLayoutRect|loadItem|removeAnchorPointVisuals|originAnchor|xmlInfo|inheritsFrom|draggedNode|destinationAnchor||requiresSimpleGraph||attachedNodes|Item|onClick|getLinkCrossings|number|getFontSize|getHandlePositions||CellFrameStyle|affectedItems|startDraw|rowIndex|||skipLayout|collapse|console|SvgNode|RoundRect|commitCompositeOperation|nodesIntersect|rectPtFromPercent|writeItemReference|getFontName|onLoad|getEffectiveHeadStroke|hoverTimeoutId|uLinkCount|idMap|commands|rotateRect|getEffectiveTextStrokeThickness|minDistances|Custom|inplaceObject|gridColor|EffectPhase|setStyle|parseColor|fillRect|clip|dLinkCount|rowEnd|getLayoutTraits|removeEdge|modifierKeyActions|setImageAlign|dPriority|uPriority|containsRecursively|setItemIndices|setBaseShape|getStrokeThickness|setTimeout|getIntersectingItems|getStroke|Polyline|backgroundImageContent|Container|AutoResize|animationId|resizeType|gridStyle|BottomToTop|requiresConnectedGraph|startComposite|decorationBrush|setFolded|leftBorderPen|mousemove|getRectPtPercent|mouseUpDelegate|imageData|mouseup|endComposite|resizeDelegate|dimColor|imageIndex|setEnabled|updateText|toGraph|setCurrScrollRow|LayoutUtils|Tag|setColumnWidth|treeLayoutAssistant|diagramId|onScroll|col|getFoldable|getEffectiveBackBrush|any|saveImage|updateAnchorVisibility|isAnchorPatternVisible|scrollElement|preparePostback|setRowHeight|child|setZIndex|rightBorderPen|json|Animations|clearTimeout|isFrozen|Cross|onRowHeaderWidthChanged|getDiagramItem|touches|leftBorderThickness|enableAssistants|CellEventArgs|AfterFill|getKeys|255|clientToDocOverflow|topBorderPen|setModfCursor|EasingType|update|clearAll|shouldCancel|Object|structure|has|underlying|cluster|after|src|parse|topBorderThickness|changed|setExpandable|quadraticCurveTo|setsLinkPoints|getImageAlign|onTouchEnd|updateIntersections|emulateMouse|load|query|modify|Shadow|inplaceEditBounds|nowEditing|ChangeItemCommand|L57|L72|removeElement|L65|Header|removeChild|GlassEffect|updateFromRoute|element|pointerPosition|propertyName|notifyHeaderChanged|getScrollable|0001|getAllLinks|isStraight|cannot|L68|isItemVisible|69873|epath2|visitNodes|mouseMoveDelegate|iterations|controlPoints|45085|54915|AutoWidth|BeforeFill|getEffectiveFontName|draw|changeVertex|C33|L33|countIntersectingItems||setWidthNoNotify|L28|setHeightNoNotify|placeSequence|typeName|L23|252|Ignore|_mf_linkCrossings||drawHandles|RoundedRectangle|AeroEffect|getEnabledHandles|copyPoints||strokeRect||getCornerPoints|bottomBorderPen|bottomBorderThickness|5707963267948966|EasyMove|addCanvasElements|rightBorderThickness|findControl|ShapeLibrary|Empty|elements|scrollTimeoutId|removeCanvasElements|getViewport|drawDashedLine|needsMouseMessages|uBaryCenter|createConnectionPoint|dBaryCenter|cmd|localPoint|135|getContentBounds|drawAdjustmentHandles|backgroundBrush|onUpdateBounds|StrokeDashStyle|drawCircle|distToPolyline|doRemoveItem|Count|transformPoints|setAutoHandlesItem|scrollTo|titleColor|customLinkType|originalPoints|onUpdateDelegate|updateCanUndo|calcAutoWidths|setZoomFactor|ConnectionStyle|handleBrush|alignEndPointToBorder|updateFlag|SquareHandles|updateLinksPos|requiresCascadingLinks|MoveOnly|updateScrollerContent|resize|customNodeType|RadialGradientBrush|ScrollTableCommand|setColumnStyle|copyLinks|ensureWidth|HandleUtils|cos|Grid|doAddItem|drawRotationHandle|setKeepGroupLayout|getKeepGroupLayout|toolTip|getConnectedComponents|manipulator|isNaN|countCrossings|degree|setFontName|setAnchoring|getAnchoring|find|bezier|screenPoint|log|autoScrDX|radians|Graph|startButton|instanceof|routeMargin|side|startInteraction|M45|M80|collectLeaves|setMinDist|getHandlePosition|C15|M87|initialTemperature|temperature|L32|M70|setFontSize|L18|L88|changeOrigin|linkToNodeMap|L62|L43|clearInternal|nodeLeftClass|nodeRightClass|L27|deleteItem|cancelNow|diagramBounds|1000|auto|getObjectToEdit|targetView|setInplaceEditBounds|getInplaceEditBounds|setEditedText|onMouseLeftButtonUp|getAlignToGrid|getFromValue|LinkLabel|docToClientOverflow||serif|acceptLinks|Ellipse|setLinkHeadShape|updateLayoutId|chooseBestAnchorPoint|__type|NodeListView|onResize|leftButtonDownPosDev|getHeader|drawOutline|scroll|scaleFactor|Overview|autoScrDY|useStyles|Function|subtractPadding|shapeDecorationBrush|sans|shapeDecorationPen|roundRect|linksToUpdate|eventHandlers|eventHandlerList|addHandler|shapeDecorationBounds|minY|minX|saveLocationState|alignment|writeTag|visible|raiseDoubleClicked|ShowAnchors|readStringFormat|getAutoAnchorsNode|getLocation|ignoreTransform|XmlPersistContext|resetCrossings|pointsValid|readTag|updateRelatedPoints|addManipulatorVisuals|getLinksToContainedNodes|readArrowheadV13||linkRouter|Arrow|getLocked|baseShapeBounds|onRemove|headShapeBounds|createEditControl||getAttachedNodes|drawLines|CellValidationEventArgs||raiseClicked|setFoldable|Triangle|nodeType|linkPointed|setRotationAngle|containerId|fromArgs|setBaseBrush|getImageLocation|getDummyNode|masterId|setFont|nodePointed|normalizeRect|InplaceEditEventArgs|invalidateZOrder|setSelected|treeEdge|getImageContent|attractedPoints|setHeadBrush|addManipulator|getAnchor|setPoints|removeManipulator|addVertexAndOutEdges|setScrollable|writeResource|BowArrow|Canvas|createControl|Tetragon|Rhombus|getBottomBorderPen|ItemEventArgs|onMouseButtonUp|setRightBorderThickness|Auto|specified|setBackColor|columnIndex|updateAllLinks|updateExternalLinks|getEffectiveHeadBrush|itemTestForDoubleClick|horizontal|Quill|routeIntersections|getLevelCount|getId|RevWithLine|DefaultFlow|Slash|BackSlash|RevWithCirc|_mf_route|RevTriangle|xmlCollectionToPath|handleClick|DoubleArrow|PointerArrow|PentagonArrow||findHeader|rvertex|PanBehavior||Reversed|getScrollbarSize|deleteButton|prepareCommands|endEdit|isRoot|getRightBorderPen|readImage|getTopBorderThickness|setTopBorderThickness|shapeDecorationBuilder|maxY|maxX|addAnchorPointVisuals|keyCode|readFont|A9A9A9|considerBounds|readPen|doSquarify|onTouchMove|clientX|clientY|onTouchStart|setImage|writeImage|writeFont|getImage|target|getFont|getCount|setRotateImage|DelKeyAction|setRotateText|Column|nonzero|Magnify|ManipulatorInteraction|collapsedSet|loaded|doubleClick|tryMoveTracker|setTransparent|containerChildRemoved|containerChildAdded|sizeChanged|defaultBounds|tooltipDiv|removeEventListener|decorationBounds|getEmptyBounds|foldable|containerUnfolded|getRightBorderThickness|containerFolded|204|resizeToFitChildren|getLinksInScope|matrix|getBottomBorderThickness|19639|L42|74121|76859|L93|translateDependencies|NEGATIVE_INFINITY|77719|setSelectedState|25878|23141|22281|branchCircles|80361|clear|alreadyMoved|30733|processRowHeaders|35046|94095|containerPadding|getRoundedLinks|22105|processColumnHeaders|29629|65779|POSITIVE_INFINITY|offset|73413|textAlign|95518|85786|14214|C85|61423749153967|Edge|alignFirstCascadingSegment|approximateBezier|L64|cutEdge|M85||updateAnimation|setHeadShapeSize|refineStage|M13|C95|Vertex|L56|createCallback|M76||L73|drawRectangle|defaultShapesDefined|L78|M65||getEffectiveTextAlignment||CaptionHeight|Margin|getEffectiveLineAlignment|M24|pointInPolygon|M35|readItemReference|layerDistance|searchCounter|setNodeDistance|siftingRounds|07958|62427|restoreLocationState|92068|saveEffects|77851|loadEffects|85587|75452|getNodeDistance|61139|removeLastChildDeep|960736|24548|setMultipleGraphsPlacement|07932|setBottomBorderThickness|writePointF|19261|72239|14413|426519|22149|72315|38861|L38|getMultipleGraphsPlacement|34221|77895|L44|isItemInteractive|addEdge|writeRectangleF|L96|703709|26587|64954|rect|squarify|05905|04482|69266|finalizeRoute|calcDownData|27685|calcUpData|57348|37573|Bounds|92042|done|L53|containerChildAdding|L69|80739|27761|nodesExpandable|03926|DummyConnectionPoint|hatchFill|invalidateLabelLayout|updateRect|replaceNewItem|RemoveItemCommand|patternFill|labelsAutoArrange|resizeToFitItem|tableColumnResized|getContext|linkModified|createPattern|linkTextEdited|StrokeThickness|Stroke|readBrushContent|nodeModified|ShadowBrush|nodeDoubleClicked|tableColumnResizing|nodeClicked|LinkLength|EnableStyledText|nodeDeleted|nodeCreated|linkDoubleClicked|headerStartResizing|stopAutoScroll|clipboardData|linkPasted|createLink|initializeNode|handlesSize|getHandlesStyle|startTotalChange||headerResized|itemAdded|itemRemoved|nodeConstructor|nodePasted|AddItemCommand|alignResize|tableRowResizing|linkDeleted|||tableRowResized||Pointer|createNode||copyColumn||linkCreated|ResizeTopLeft|linkClicked|easeOut|hitTestAdjustmentHandles|start|getShowLaneGrid|linkDeselected|setLeftBorderThickness|CompositeCommand|gridPointSize|nodeDeleting|getTopBorderPen|clicked|nodeModifying|setBackBrush|containerChildRemoving|treeCollapsed|canUndo|nodeDeselected|canRedo|UndoManager|selectionModifying|setContent|linkSelected|startCompositeCounter|requiresHierarchyInfo|SvgContent|treeExpanded|getLeftBorderThickness|doUnfold|linkCreating|cellTextEdited|enterInplaceEditMode|leaveInplaceEditMode|FoldContainerCommand|easeIn|hasBrush|doFold|rgb|nodeTextEdited|ConnectionPoint|getLayoutMaster|nodeCreating|linkModifying|Behavior|hasNodeEffects|getNodeEffects|linkChanges|collectGroup|resetLink|gray|ResizeTableRowCommand|ResizeTableColumnCommand|linkDeleting|startCompositeOperation|invisible|bind|SerializeTagEventArgs|onShapeLibraryError|onShapeLibraryLoad|leftButtonActions|updateCanvasSize|stopCursorChange|requestAnimationFrame|imagesMap|MasterHeader|getBackgroundBrush|Decision|setCancel|serializeItems|writeEffect|getLeftBorderPen|writeEffects|touchThreshold|middleButtonActions|setTextPadding|getLaneGrid|rightButtonActions|rowFromPoint|setShapeLibraryLocation|scaleAtCenter|listCoords|cancelCompositeOperation|readEffects|writeStyleContent|SaveToStringFormat|setAllowResizeColumns|alt|raiseCreating|onItemDragging|getTransform|initializeLink|createRow|setAllowResizeRows|labelLayoutInvalid|createColumn|CellEditor|ensureHeight|ModifierKeyActions|setLinkBaseShape|setDefaultShape|MagnifyBehavior|scrollable|HatchHandles|readEffect|Vertical|HeaderResizeEventArgs|getOriginAnchor|SelectOnlyBehavior|Arcs|38576250846033|arrangeCascadingSegments|ShadowsStyle|standardShapeReplacement|clearRuntimeData|layOutArea|removeDragShape|nodesInLongLink|expand|serverRegistered|intersect|test3EdgeConnectivity|ExpandButton|minimizeCrossingsDir|moveToEpsilonCircle|setLoopShape|arrangeCircles|destinationIndex|M30|evalPos|drawMinus|multiplyScalar|maxDiagonalDistance|nodeToLinkMap|invalidateDefaultShapes|Factory|originIndex|C83|attraction|mapVirtualNode|putEndPointsAtNodeBorders|alignLastCascadingSegment|setupDestConnection|getEnds|dfsConnectivity|setupOriginConnection|HatchHandles3|placeRight|getCommonEdges|RoundAndSquare|balance|rightSibling|RoundAndSquare2|leftSibling|forEachValue|getHatchFill|getRoundedLinksRadius|labelFromPoint|setMagnifierShape|getNeighbors|raiseDeselected|drawSquareHandles|getShowDisabledHandles|itemInSelection|allowMultipleSelection|addItemInternal|drawLink|getLinksFromZ|placeLeft|drawHatchFrame|processed|deserializeTag|laneGridCellTextEdited|topLevel|ResizeTopCenter|isAllowed|unshift|centerY|drawRoundedPolyline|setId|moveLeft|centerDelta|getOriginIndex|delta|00001|M39|setLocation|ResizeBottomCenter|M17|initializeDefault|InvisibleMove|ResizeMiddleLeft|moveRight|getDestinationIndex|crossedLinksToInvalidate|ResizeMiddleRight|raiseModified|computeClasses|layoutLayer|controlLoadedScript|diagramView|_mf_transform|submit|repaintId|ModifyBehavior|tooltipTimeoutId|setMeasureUnit|canResizeLaneHeader|DontChange|updateAnchorPositions2|CancelEventArgs|setLinkBrush|calcAnchorVisibility|registerForSubmit|fromPositionAndSize|form|setHandled|getItemsSize|||updateSize|rightButtonDownPos|reassignLevels|setBaseShapeSize|lastClick|setTrackerPosition|LinkBaseShape|onItemRemoved|LinkHeadShape|LinkTextRenderer|scrollPosFromTracker|DeleteSelectedItems|setLinkBaseShapeSize|getZOrder|setLinkHeadShapeSize|onDiagramRepaint|updateLabelLayout|checkMouseMoved|OverrideBehavior|HeaderEventArgs|setShapeBrush|pointer|undoEnabled|DoNothingBehavior|_shapeCanvas|getClientPos|setAllowOutgoingLinks|setAllowIncomingLinks|getBoxAt|setObstacle|selectBox|raiseCreated|onMouseLeftButtonDown|onItemDropped|getAdjustmentHandle|SelectionEventArgs|getMouseButton|DrawLinksBehavior|targetAsDiagram|getMousePosition|DiagramEventArgs|setOrientation|onHide|beginEdit|arrangeSquare|mousedown|setLinkShape|listSize|setBackgroundImageContent|div|attachTo|setAnchorPattern|Xml|backgroundImageIndex|getPointsBounds|setEnabledHandles|assignInstanceIds|onShow|getEffectiveNodeEffects|hidden|||fromXmlDocument|getBackgroundImage|getEffectiveHeadStrokeThickness|getCommonEdge|setBehavior|setPatternId|headerSize|LinkShapes|setOriginAnchor|setDestinationAnchor|getRotatedBounds1|getWeight|getHeadStrokeThickness|TopLeft|setShowDeleteButton|Draw|DeleteButton|measureCircles|getAnchorFromIndex|vertexCopyToOrigMap|xint|yint|BaseShape|move|setCenterAndSize|cartesianToPolar|HeadShape|getDestinationAnchor|fileVersion|getEffectiveHeadStrokeDashStyle|getThumbRect|calcWeights|HeadStrokeDashStyle|getHeadStrokeDashStyle|Router|centerX|convertToShape|routeLinksAt|evalRatio|getDirection|alignPointToGrid|setDirection|AssistantPosition|getGridSizeX|getGridSizeY|getEnabled|create|scrollStayInDoc|mouseMoved|panPoint|getScrollPosition|deleteSelection|OverLongestSegment|getBackgroundImageAlign|rightButtonDownPosDev|lastMouseUp|clearLayout|getHeadStroke|arrangeSiblings|500|isNodeType|isLinkType|270|splitPaths|Segment|ControlPoint|routeInternal|scrollDelegate|Cancel|keyDownDelegate|segment|getObstacle|getPolyLine|pointAlongLength|supportsAutoScroll|isClick|sizeDocForItems|overflow|clearHandlers|setTextStyle|onAutoScroll|ModificationStart|Cube|Cylinder|Database|CreateRequest|ConeUp|ConnectedIssues|readRectangleF|DataTransmition|CellMatrix|getColumnEnd|DInDelay|getRowStart|DDelay|Decision2|Delay|writeThickness|BpmnIntermediateTimer|BpmnParallelFork|BpmnStartLink|BpmnIntermediateRule|BpmnIntermediateLink|BpmnIntermediateMessage|BpmnIntermediateMultiple|BpmnStartMessage|Collate|ConeDown|readThickness|Cloud|BpmnStartMultiple|BpmnStartRule|BpmnStartTimer|DirectAccessStorage|Interrupt2|IsoProcess|Junction|Italic|InternalStorage|Interrupt|Underline||Lightning|MessageFromUser|Bold|MessageToUser|getColumnStart|LinedDocument|ManualOperation|Merge|Input|Document|DOutDelay|EndLoop|DividedProcess|DiskStorage|Display|DividedEvent|ExternalOrganization|Heart|Heptagon|Hourglass|Gate|ExternalProcess|File|FramedRectangle|registerNamespace|KeepRatio|getMinWidth|animationComplete|send|Fit|validateParams|mainItem|cellCluster|CellClusterStyle|targetBounds|updateArrowHeadData|addToRect|Visible|build|open|addToZOrder|getArcPoint|isElliptic|line|onDropOver|transformRect|clipPath|getRuntimeIndex|getting|XML|status|detachSub|XMLHttpRequest|setTopLevel|getMasterNode|getRowEnd|BpmnEndCompensation|BpmnEndError|BpmnEndLink|BpmnEndCancel|BeginLoop|BpmnComplex|BpmnDataBasedXor|BpmnEndMessage|BpmnIntermediateCancel|BpmnIntermediateCompensation|BpmnIntermediateError|BpmnInclusive|BpmnEndMultiple|BpmnEndTerminate|BpmnEventBasedXor|Arrow9|setShapeTransform|Actor|Alternative|updateOutline|outlineBuilder|decorationBuilder|getSpanningCellSize|Arrow1|Arrow6|Arrow7|Arrow8|Arrow5|Arrow2|Arrow3|Arrow4|Microform|updateDestinationIntersection|Gradient|updateOriginIntersection|Node|addOutgoingLink|removeIncomingLink|removeOutgoingLink|writeBrushContent|loadItemFromXml|Rows|saveItemToXml|instantiateItem|brushes|brushesMap|Brushes|addIncomingLink|hasShadowColor|saveSVG|svgIndex|getShadowColor|hasFontSize|writeStyle|hasFontStyle|contentFile|xml|base64|getContent|svg|Images|svgData|Content|Thickness|insertRow|System3D|deleteRowLinks||ColumnResizer|getAllowResizeColumns|||||insertColumn|RowResizer|ScrollBar|scrollUp|covered|markCoveredCells|scrollDown|Scroller|TableConnectionPoint|updateLinksIndices|getAllowResizeRows|FixedWidth|collectWidthsIf|collectHeightsIf|copyRow|setShadowColor|setStrokeThickness|setStroke|Simple|containerStyle|nodeStyle|linkStyle|shapeStyle|diagramStyle|freeformStyle|tableStyle|Sort|Sphere|Star|Save|PyramidDown|PyramidUp|RSave|Start|RightTriangle|Decagon|Trapezoid|getHeaderBounds|Tape|Terminator|TransmittalTape|PunchedCard|MultiProc|Octagon|OfflineStorage|MultiDocument|convert|MicroformProcessing|MicroformRecording|OffpageConnection|Procedure|Process|Prysm|PrimitiveToCall|OffpageReference|Pentagon|PrimitiveFromCall|Star4Pointed|hasStrokeDashStyle|hasTextColor|ensureNonEmpty|readEffectContent|Width|getStrokeDashStyle|hasAttribute|does|readStyle|stylesMap|hasFontName|effectsMap|removeColumnHeader|removeRowHeader|writeEffectContent|hasStrokeThickness|Star16Pointed|Star24Pointed|Star32Pointed|readColorValue|Star5Pointed|Star6Pointed|Star7Pointed|Donut|svgsMap|getBackBrush|hasStroke|FontStyle|Plaque|FontFamily|FontSize|rotate|getDescendantNodes|setRightBorderPen|setTopBorderPen|stop|setBackgroundBrush|setLeftBorderPen|141592653589793|28318530717959|CellCluster|deselectContainedItems|Exponential|setBottomBorderPen|setAllowInplaceEdit|getTitle|raiseHeaderResizing|decorations|cancelAnimationFrame|collectHeights|getChildLinks|L98|L66|L37|Power|exchangeStates|getAllowInplaceEdit|Type1|getToValue|Linear|collectWidths|arcTo|zeroHeight|processPathString|zeroWidth|startTimeStamp|BackBow|isDescendantOf|getHeadersOnLevel|C10|Fixed|ellapsedTime|EaseIn|onDragOver|containerHit|getRowDepth|getRowLevelWidth|addToHistory|onChildModified|LaneGridInteraction|drawHeaders|Folder|getTime|getColumnLevelHeight|rarrange|Elastic|animationProgress|bezierTo|getColumnDepth|toLowerCase|readFloatArray|writeFloatArray|innerHTML|readSvgContent|trackMouseMovement|setExpanded|than|setLinkHitDistance|time|newWidth|newStyle|one|itself|implement|onHover|getXmlInfo|DeleteActiveItem|oldHeight|instantiateEffect|readSvgs|clearTooltip|Svgs|writeSvgContent|Svg|oldRow|oldWidth|oldStyle|newRow|setAutoResize|writeSvgs|setRightButtonActions|LinkBaseShapeSize|DefaultShape|onContextMenu|LinkHeadShapeSize|trackMouseHover|setMiddleButtonActions|onItemAdded|setMagnifierSecondaryFrameColor|dirty|ShapeBrush|AllowSelfLoops|setLeftButtonActions|startHoverTimer|InnerOutlineColor|LinkStyle|LinkBrush|ShadeColor|arrangeLinkLabel|doArrangeLinkLabels|unitsPerPixel|getShadowsStyle|setUndoEnabled|oncontextmenu|01|pointVisual|apt|setAutoScrollAmount|setScrollZoneSize|onUpdate|raisePasted|setMagnifierEnabled|copyToClipboard|setAutoScroll|handleMouseMove|readColorArray|writeColorArray|more|AllDirections|getEffectiveEffects|setMagnifierFactor|attach||setMagnifierFrameThickness|getAbsoluteMaster|setMagnifierFrameColor|setMagnifierShading|detach|mf_clipboard|setMagnifierWidth|256|removeColumns|setMagnifierHeight|__currentSearch|onColumnHeaderRemoved|because|TargetType|onDoubleClicked|LinkFreeForms|160|DrawFreeForms|220|LinkSvgNodes|DrawContainers|LinkContainers|SelectOnly|indirect|DrawSvgNodes|LinkFreeShapes|xmlClassMap|mouseClickCount|setGridSizeX|Destination|Origin|direct|setShowGrid|DrawFreeShapes|170|Bounce|setGridColor|setAlignToGrid|useScrollBars|removeRows|updateFocusable|setAutoHandles|releaseCapture|onRowHeaderRemoved|setCapture|cellFromPoint|cellRect|updateDependencies|setAutoAnchorsNode|Closed|setShowAnchors|insertRows|raiseTreeExpanded|DrawShapes|DrawLinks|raiseTreeCollapsed|DrawTables|LinkTables|onCustomFunctionDelegate|onCustomFunction|onRowHeaderAdded|getColumnRect|drawPlus|DoNothing|found|setCustomNodeType|EaseOutIn|setCustomLinkType|easeOutIn|DistanceSq|onDragOverNode|readImages|writeImages|section|setTheme|onDropOverNode|writeStyles|getNewText|getOldText|newHeight|getItem|serialized|readStyleContent|Styles|readStyles|onKeyDown|zoomToRect|resetVirtualScroll|setVirtualScroll|Color2|EaseOut|readBrushes|writeBrushes|Solid|EaseInOut|setGridOffsetY|setGridOffsetX|ClassId|setGridSizeY|Resources|readResources|writeResources|setGridStyle|isRunning|Pos|Positions|Color1|setRouteLinks|Colors|easeInOut|setModificationStart|Angle|ColorBlend|isNumber|Circular|Obstacle|AllowIncomingLinks|AllowOutgoingLinks|raiseChildAdded|recalcVirtualScroll|RotationAngle|Expanded|raiseChildRemoved|writeGroup|iterateNext|Expandable|EnabledHandles|SubordinateGroup|lastCursorPos|readGroup|getBaseBrush|getHeadShapeSize|Traits|Attachment|Attachments|raiseDeleting|removeFromCollection|All|setIndex|getHeadShape|getBaseShapeSize|removeFromZOrder|getBaseShape|checkKeepInsideParent|05|raiseHitTestAdjustmentHandles|updateRectMove|writeTheme|alignMove|nonRotatedHandlePosition|readPoints|sign|MiddleSegmentRotated|readPointValue|1px|ColumnSpan|writeThemeContent||serializeData|raiseUnfolded|inplaceKeyUp|focus|focusInput|raiseFolded|deleteLinks|solid|TextFormat|readTheme|onInplaceKeyUp|selectNode|readThemeContent|fit|updateContainersZOrder|visitChildren|getNearPoint|getFarPoint|newWithOffset|sortByIndex|getContentPath|drawChildren|getFoldedBounds|updateZOrder|setHeadStrokeDashStyle|Animation|getSegmentCenter|setCaptionHeight|nextToLastDifferent|getCrossingRadius|pointEqualEpsilon|addNodes|nextToFirstDifferent|addRoundRect|getLongestSegment|getSegmentLength|onDragOut|pivot|setBackgroundImageUrl|removeAt|concat|readSvg|setHeadStroke|readObject|Caption|setShapePen|setDelKeyAction|getHeadBrush|getEffectiveBaseBrush|drawWithCrossings|getCrossings|raiseDeserializeTag|writeObject|raiseSerializeTag|CaptionFormat|magnifierFrameDashStops|getDescendantLinks|AllowAddChildren|ClipChildren|AllowRemoveChildren|setHeadStrokeThickness|UnfoldedSize|alignCascadingSegments|Folded|readSizeF|writeSizeF|setLinkPen|Foldable|getTextPadding|getY|newRect|firstElementChild|nextElementSibling|toXmlDocument|Nodes|ShadowOffsetX|ToolTip|IgnoreLayout|Links|ShadowOffsetY|getMarkStyle|getX|onColumnHeaderAdded|getEffectiveFontStyle|readAnchorPattern|setProperty|getAdjustmentHandlesSize|getEffectiveShadowColor|createAnchorPointVisual|raiseDeleted|saveToString|Json|Type4|setShadowOffsetY|setShadowOffsetX|TextPadding|MeasureUnit|docToClient|Opacity|pointsAlongVector|Always|saveProperties|BackgroundImage|onTooltip|raiseMouseHover|insertColumns|negate|Selected|divideScalar|getShowAnchors|getColor|updateAnchorVisibility3|HyperLink|tooltipPoint|Locked|writeAnchorPattern|ZIndex|loadProperties|endItemChange|startItemChange|updateAnchorVisibility2|Properties|ActiveItem|getNearestNode|updateTargetConnection|border|GlassEffectType|GlowColor|autoSnapDistance|UsePenAsGlow|ResizeTopRight|Label|Labels|getTextStyle|ReflectionColor|setControlPoints|sortHandles|getColumnSpan|getRowSpan|setDestination|MiddleSegment|Follow|RowSpan|setOrigin|nodeValue|getAllowIncoming|getAllowOutgoing|updateNodeCollections|doRoute|writePointCollection|getClip|OriginAnchor|updateManipulators|isEllipse|DestinationRow|OriginRow|DestinationAnchor|tooltipY|Type3|radius2|AllowIncoming|Type2|tooltipX|AllowOutgoing|Dynamic|raiseDrawAdjustmentHandles|HeadStroke|BaseBrush|ResizeBottomRight|ResizeBottomLeft|HeadStrokeThickness|HeadBrush|||||CascadeStartHorizontal|||AutoRoute|||getExpandable|BaseShapeSize|HeadShapeSize|TextStyle|TreeLayout|minNodeSize|placeSingle|KeepWidth|setLinkType|transformAndGetPoints|drawCells|L99|combineSequences|getApproximatingContext|layoutRow|adjustDirections|43967|setKeepRootPosition|cachedZOrder|getKeepRootPosition|startX|shrinkToFit|KeepHeight|getLinkType|startY|getNeighborOnLayer|RotateImage|RotateText|setDimColor|Transparent|getEffectiveTopBorderThickness|FitSize|statusText|screenX|GET|43769|responseType|getBaseType|12605|__baseType|png|getBackgroundImageSize|L91|drawHeader|backgroundColor|cellBounds|L59|getBackColor|getEffectiveTopBorderPen|rebuild|sameOffset|hasAssistants||registerMovedNode|registerLink|regIndex|getDecorationPen|||getDecorationBrush|getShapeDecorationBrush|parseAll|getShapeDecorationPen|9999|savedBounds|canvas|getEffectiveLeftBorderThickness|addDragShape|scaleFont|5845|closePath|getRotateTitle|scaleStrokeThickness|Pixel|selectItemsInRect|setLevelDistance|getLevelDistance|call|serializeSubHeaders|serializePoints|drawShadow|addShapeDecoration|drawRoundRect|82551|clientHeight|getOutlineBrush|setChildrenWidths|52284749830794|getOutlinePen|setChildrenHeights|filter|branchDistance|raiseValidateAnchorPoint|setDiagram|shapeTransform|prepare|startHeight|71238898038469|getHeaderFromPoint|dedummify|minimizeCrossings|getEffectiveBottomBorderThickness|L52|random|xmlElementToPath|L36|L48|TreeMapLayout|addColumnHeader|M14|M47|LayeredLayout|hitTestHeader|adjacentTo|testPoint|cloneLinks|addRowHeader|incidentWith|L31|swapPairs|raiseTableRowResizing|L46|04845|array|widths|L24|applyForce|L22|L19|mode|createDummyShape|repulsion|getEffectiveBottomBorderPen|calcRepulsionForce|calcSpringForce|raiseTableRowResized|getEffectiveRightBorderPen|A100|L11|getEffectiveRightBorderThickness|L47|addArc|none|BottomLeft|BottomRight|TopRight|wrapText|getCellFromPoint|_mf_segments|segmentsFromPoints|85641|pullLinksApart|MiddleRight|registerDefaultShape|onerror|screenY|clientToDocLength|L58|onload|TopCenter|BottomCenter|MiddleLeft|responseXML|setAllowIncoming|setColumn|setAllowOutgoing|97584|setMarkStyle|cloneNodes|setY|setX|M77|background|hitHeader|layout|M25|setSize|fillText|14359|textBaseline|setColor|calcScrollPos|dummify|getTopLeftAreaText|drawTopLeftArea|controlPointStart|0983|sweepAngle|registerAffectedItem|interactionStarted|SvgUrl|childCircles|applyLayout|prepareLayout|M33|147|raiseInitialize|commit|Scrollable|AllowResizeRows|AllowResizeColumns|000002414559|raiseModifying||getTotalRowWidthIf|CurrentScrollRow|CaptionBackBrush|Base64|edgeCopyToOrigMap|Normal|AssistantType|computeLeftClasses|L35|factory|computeRightClasses|C35|getMinHeaderSize|innerScroller|FractalLayout|Reassign|Keep|fixRowConnections|rotatePoint|L16|debugId|getFontStyle|repeatingLinks|C66|selfLoops|keys|Invisible|SquareHandles2|canScrollUp|L81|canScrollDown|HatchFrame|HatchHandles2|DashFrame|C90|L74|pointInHandle|getLocalIndex|symmetricPoint|nearestPointIndex|offsetHeight|removeRotation|addRowOutgoingLink|addRowIncomingLink|removeRowIncomingLink|getRowIntersection|removeRowOutgoingLink|BorderedTreeLayout|createCell|changeDestination|topMiddle|raiseTableColumnResizing|raiseSelectionMoved|9017|L86|getPatternFill|Height|Row|raiseTableColumnResized|assignCoordinates|checkAutoScroll|redimTable|deleteRow|deleteColumn|drawDashFrame|getImageRect|AutoHandles|drawRoundAndSquareHandles|isAutoScrolling|C50|getResizeCursor|touchstart|190|startWidth|C80|escapeHtml|isEmpty|touchcancel||touchmove|touchend|autoWidth|getEffectiveBackground|forReverse|linkConstructor|makeAcyclic|SelectedOnly|getNearestAnchorPoint|raiseHeaderResized|setControl|getCutPairs|getControl|nodeSelectedScript|compactAssistants|522847498307934|setPadding|overflowY|getOrientation|getShapeLibraryLocation|SpringLayout|catch|getPadding|try|overflowX|updateLayout|addNode|updateLayoutDelegate|serializeCaptions|raiseSelected|getEffectiveLeftBorderPen|getTotalColumnHeightIf|getNodes|removeItemInternal|56231|RelativeTo|HorizontalOffset|baseline|keydown|RelativeToLink|EnableWrap|MaxWidth|VerticalAlign|VerticalOffset|HorizontalAlign|buildNodeMap|getAbsoluteNodeMaster|includeSubHeaders|registerXmlTypes|that|getGraphBounds|collectHierarchyInfo|setStrokeDashStyle|getUnionBounds|resetLinks|placeLeftToRight|getPivotPoint|collectHeaderBounds|228474983079344|createFocusable|segmentToPolyline|getLength|placeRightToLeft|setAutoArrange|OneLevel|AutoArrange|GridStyle|RightAndDown|L95|0px|C55|123233995736766e|properties|msRequestAnimationFrame|getIterations|documentElement|createDocument|DOMParser|oRequestAnimationFrame|DiagramStyle|mozCancelAnimationFrame|webkitCancelAnimationFrame|Unable|ceil|parseFromString|application|Link|serializeToString|XMLSerializer|setIterations|implementation|setDynamicLinks|getRouteLinks|dragInitialPos|getDynamicLinks|getActiveItem|findBlockSeparationPairs|getModificationStart|getAutoHandlesItem|findBlockSeparationPairsB|dragOffset|setZoomFactorPivot|zoomToFit|offsetWidth|setLinkTextStyle|setResizeType|setScroll|setRotateTitle|setZoomLevel|setTitle|directTo|joins|createReverseEdge|setAllowMultipleResize|getAllowUnconnectedLinks|M60|getLinkTextStyle|getCommonVertex|setAllowUnconnectedLinks|reversed|getRouteMargin|setRouteMargin|get3EdgeConnectedComponents|getBiconnectedComponents|routeAllLinks|setRoot|getRoot|getSelection|getAllowMultipleResize|setScrollY|all|setAnimationType|getParam|edgeTo|getAnimationType|getContainerPadding|setLayoutArea|getDirty|setContainerPadding|300|setReverse|getReverse|mozRequestAnimationFrame|webkitRequestAnimationFrame|setRepeat|getEasingType|setParam|getRepeat|setEasingType|getCellRow|getDuration|setDuration|resizeToFitItems|getColumnIndex|setScrollX|setAllowResizeHeaders|getRowIndex|getAllowResizeHeaders|getCellColumn|setToValue|getData|setData|pasteFromClipboard|getLayoutArea|getSquarify|cutToClipboard|setSquarify|setFromValue|charAt|Decision1In3Out|decision1In3Out|Decision2In2Out|textarea|LeftInRightOut|leftInRightOut|onkeyup|getRegIndex|assignId|decision2In2Out|isRegistered|5C87B2|_tooltip|getinteractionState|radianToDegree|sameNode|getCellBounds|setinteractionState|display|block|onMagnify|NotAllowed|TopInBottomOut|topInBottomOut|visibility|getItemsAt|getNodesAt|getLinksAt|Spline|Crosses|Lines|Never|Split|updateScale|getLinkAt|checkIntersect|minDistToRect|identifier|ArgumentException|InvalidOperationException|allowLinkDirection|unique|must|getLinks|Cut|AfterOutline|getColumnHeaders|getItems|ZOrder|getNodeRect|setAllowSelfLoops|getLinkBaseShapeSize|getLinkHeadShapeSize|getBackgroundImageUrl|setBackgroundImageAlign|getAllowSelfLoops|getLinkPen|getLinkBrush|getShapePen|getLinkBaseShape|getLinkHeadShape|getLinkShape|onMouseOtherButtonUp|getRowLevelCount|getColumnLevelCount|findRow|findColumn|distToRectPoint|е|serializeTag|getBackgroundImageContent|clearInterval|setInterval|pointInRect|getShapeBrush|tabIndex|DIV|getColumnHeaderBounds|mac|getFactory|magnifyTimeoutId|Vector|800|canMoveLink|getRowHeaderBounds|150|8c8c96|platform|setFreeFormAttractDistance|getAutoCloseDistance|getFreeFormAttractDistance|127|navigator|getDefaultShape|getDelKeyAction|drawForeground||setAutoCloseDistance|getFreeFormTargets|setFreeFormTargets|IDisposable|linkDeselectedScript|drawLast|measureText|nodeDeselectedScript|linkSelectedScript|drawFirst|linkPointedScript|containerFoldedScript|containerUnfoldedScript|nodeDoubleClickedScript|linkDoubleClickedScript|nodePointedScript|cellTextEditedScript|setColumnHeadersHeights|repaintScript|getColumnHeadersHeights|nodeTextEditedScript|linkTextEditedScript|initializeLinkScript|treeExpandedScript|treeCollapsedScript|sizeChangedScript|selectionModifyingScript|initializeNodeScript|containerChildAddedScript|linkPastedScript|headerStartResizingScript|headerResizedScript|tableColumnResizedScript|tableRowResizedScript|nodePastedScript|POST|setRequestHeader|loadFromString|itemAddedScript|itemRemovedScript|ollectLeaves|containerChildRemovingScript|drawAdjustmentHandlesScript|hitTestAdjustmentHandlesScript|containerChildRemovedScript|MIN_VALUE|containerChildAddingScript|createEditControlScript|tableColumnResizingScript|tableRowResizingScript|clickedScript|enterInplaceEditScript|leaveInplaceEditScript|setRowHeadersWidths|getToolTip|nodeCreatedScript|nodeCreatingScript|oCancelAnimationFrame|nodeClickedScript|linkClickedScript|nodeModifyingScript|getPosition|Tooltip|linkCreatedScript|linkCreatingScript|nodeModifiedScript|Sys|Tile|Stretch|1023|512|128|msCancelAnimationFrame|getRowHeaders|setToolTip|MiddleCenter|Cursors|updatePointData|linkModifiedScript|getTopLeftAreaStyle|setTopLeftAreaStyle|setTopLeftAreaText|nodeDeletingScript|getLayerDistance|linkDeletedScript|setHeadersOnTop|linkDeletingScript|getRowHeadersWidths|getHookHeaders|setHookHeaders|getHeadersOnTop|setLeftMargin|setSiftingRounds|getSiftingRounds|setColumnCount|setRowCount|getLeftMargin|setTopMargin|setMinHeaderSize|setLayerDistance|linkModifyingScript|getTopMargin|nodeDeletedScript|cyclic|groups|which|operate|diagrams|with|contain|are|ignored|hasBackBrush|have|related|them|rowObject|parseSvg|decode|match|Exception|Border3D|writeSvg|Layouts|preserve|grouping|encode|setNodeEffects|setFontStyle|getAlt|setAlt|ctrlKey|strokeText|getShift|setShift|shiftKey|setDefaultNodeSize|getDefaultNodeSize|setIconSize|altKey|3366CC|selectItem|List|exec|getAutoArrange|setSegmentPosition|setControlPointPosition|setLinkLengthPosition|setHorizontalAlign|setMargin|getMargin|setTransform|getHorizontalAlign|setVerticalAlign|getVerticalAlign|and|getContainer|getLink|getObject|setAttibute|setAdjustmentHandle|getNode|getElement|registered|createTextNode|hasOwnProperty|getPropertyName|getHorizontal|writeImageContent|italic|getAnchorPointPos|getAnchorRect|Arc|Unit|underline|getSizeRect|LineAlignment|svgElement|importNode|bold|getEffects|colorStringToHex|getConnectionStyle|setConnectionStyle|getCellFrameStyle|addRow|collumns|addColumn|setCellFrameStyle|Cells|createImageData|putImageData|getLineDash|clipToBounds|Columns|createSvgNode|getCaptionFont|createDiagramLink|createShapeNode|createTableNode|createContainerNode|setCaptionFont|setCaptionBackBrush|Millimeter|yellow|getClosed|setClosed|getCaptionBackBrush|09158|94214|41986|5093|7464|59885|447174|C37|C21|C38|M67|C58|C49|4907|30581|69418|90843|40115|253604|L71|L94|1086523819801535|M44|853981633974483|A70|A30|55283|M28|L97|38926|L79|11902|C16|A47|C25|3303828583761845|58014|C26|M84|477152501692068|7763568394002505e|00000000000001|C91|C96|C67|38576250846034|C20|88098|61074|477152501692064|105427357601002e|999999999999998|05786|marginLeft|marginTop|miter|degrees|sizeElement|clientWidth|PathParser|resizeToFitText|getTransparent|getRotateImage|onMouseLeave|getFitTextStep|applyTo|pageXOffset|pageYOffset|setTargetView|getIconSize|allowed|fromCenterAndSize|bezierCurveTo|RegExp|replace|atan2|offsetPointCollection|10000|String|quad|trim|Array|distanceToSegment|tagName|boundingRect|textContent|setRect|unionRects|selectSingle|Alternate|M74|foreground|nextSibling|firstChild|readyState|getRotateText|getDimColor|getShapes|CANVAS|rectangle|sweep|DistanceToSegment|builder|shapeDecoration|arcToBezierCurves|stringFormat|getGlowColor|setType|drawImage|getUsePenAsGlow|setGlowColor|963|Pen|setTextStroke|037|857|143|setUsePenAsGlow|getOpacity|getRightButtonActions|getMiddleButtonActions|getLeftButtonActions|setOpacity|setShadowsStyle|setReflectionColor|getReflectionColor|setAdjustmentHandlesSize|arrangeLinkLabels|drawMagnifier|baseShapeObj|addEllipse|headShapeObj|Regular|raduis1|HeadPen|AutoSnapToNode|getEffectivePen|SegmentCount|OriginRelative|DestinationRelative|setLocked|getPen|setWeight|getTextStrokeThickness|getTextStroke|setTextStrokeThickness|setTooltip|setHyperLink|getHyperLink|getIgnoreLayout|getTooltip|setIgnoreLayout|getShadeColor|getNodesExpandable|getTheme|setNodesExpandable|setExpandOnIncoming|getExpandOnIncoming|getCustomNodeType|setTooltipDelay|getTooltipDelay|getVirtualScroll|registerDisposableObject|||||getCustomLinkType||getProgress|getGridColor|getGridOffsetX|getShowGrid|setShowDisabledHandles|getBehavior|getGridOffsetY|acos|setShowLaneGrid|setGridPointSize|getGridStyle|getGridPointSize|getMagnifierHeight|getMagnifierFrameThickness|getMagnifierWidth|getMagnifierEnabled|getMagnifierFactor|getMagnifierShading|getMagnifierSecondaryFrameColor|getModifierKeyActions|getMagnifierFrameColor|getMagnifierShape|setShadeColor|getInnerOutlineColor|setRoundedLinks|setRoundedLinksRadius|setCrossingRadius|getLinkHitDistance|setLinkCrossings|getAutoResize|setInnerOutlineColor|getAutoScrollAmount|getScrollZoneSize|getAutoScroll|getCommands|getControlPoints|setSegmentCount|addLabel|getExpanded|setOriginIndex|setDestinationIndex|getSegmentIntersection|IsTraits|getEllipseIntr|removeLabel|getCurvePoints|getAllowAddChildren|ContainmentKeys|setAllowAddChildren|setAllowRemoveChildren|getAllowRemoveChildren|getDynamic|setDynamic|setAutoRoute|getAutoRoute|Key|||Pair|getAllowOutgoingLinks|CardinalSpline|getOutgoingLinks|MainItem|getIncomingLinks|getClipChildren|defaultPoint|setClipChildren|getAllowIncomingLinks|M75|selectNodes|angleDelta|sameSize|setHandlesStyle|getPolygonIntersection|ORDERED_NODE_ITERATOR_TYPE|Data|XPathResult|evaluate|Percents|setStartPoint|iLr|iKr|setCenter|isFloat|setRowSpan|getClosestSegmentPoint|getLineHitTest|setColumnSpan|setEndPoint|drawCallback|getAnchorPattern|True|getShowDeleteButton|PrevRect|InContainer|attributes|getNamedItem|isConnected|boolean|AlignLastCascadingSegment|angleBetween".split("|"),0,{})),
define("MindFusion_Diagramming",["MindFusion_Common"],function(e){return function(){var t;return t||e.MindFusion_Diagramming}}(this)),function(){var e=MindFusion.AbstractionLayer,t=MindFusion.Drawing;KDFlowNode=function(t){e.initializeBase(KDFlowNode,this,[t]),this.setShape("RoundRect")},KDFlowNode.prototype={metaNodeInfo:null,draw:null,subImageName:[],subImageList:[],newitemname:"",graphicsContainer:{},fittingString:function(e,t,i){if(KD.isEmpty(this.canvasContext))return e;var a=this.canvasContext,n=a.measureText(e).width,o="…",r=a.measureText(o).width;if(t>=n||r>=n)return e;for(var s,l,d=e.length,c=e.length,h={};n>=t-r&&d-- >0;)s=e.substring(0,d),l=e.substring(d,c),n=a.measureText(s).width;return"wrap"==i?(h.currentstr=s,h.deletestr=l,s=h):s+=o,s},updateCanvasElements:function(i){e.callBaseMethod(KDFlowNode,this,"updateCanvasElements");var a=this.metaNodeInfo.Bounds.split(",");this.RefFlowElementId=this.metaNodeInfo.RefFlowElementId,this.setStrokeThickness(.2),this.setBrush("#F0F0F0"),this.setZIndex(KD.CONST.WorkflowChartZindex);var n=parseFloat(a[0])+10,o=parseFloat(a[1])+5,r=30,s=30,l=new t.Rect(n,o,r,s),d=this.metaNodeInfo.NodeImgKey;KD.IsNullOrWhiteSpace(this.metaNodeInfo.NodeImgKey)&&"False"==this.metaNodeInfo.Locked&&(d="wf:EndActivityNode"==this.metaNodeInfo.Class?"wf_End.png":"wf_Start.png");var c=KD.getUrlRoot()+"/images/silverlight/default/workflowDesigner/"+d;this.setMainNodeImageLocation(c,l),this.graphicsContainer.content=this.graphicsContainer.content?this.graphicsContainer.content:[],this.nodeImage&&this.graphicsContainer.content.push(this.nodeImage);var h=new t.Font("sans-serif",13,!0,!1),u=new t.Text(this.metaNodeInfo.ItemName,new t.Rect(this.bounds.x+45,this.bounds.y+20,this.bounds.width-40,35));u.font=h,u.fitInBounds=!1,u.pen="#2D899E";var p,g;if(p=KD.isIeBrowser()||KD.isFirefox()?15:0,"undefined"!=typeof this.metaNodeInfo.ActionEventControls?(g=this.fittingString(this.metaNodeInfo.ItemName,this.bounds.width-80-p,"wrap"),this.metaNodeInfo.ItemName=g.currentstr||g):this.metaNodeInfo.ItemName=this.fittingString(this.metaNodeInfo.ItemName,this.bounds.width-80-p,"nowrap"),g&&g.deletestr&&(this.newitemname=g.deletestr),this.graphicsContainer.content.push(u),this.setTag(this.metaNodeInfo.ItemName),this.activebackgroundColor&&(this.setBrush(this.activebackgroundColor),u.pen="#FFFFFF"),this.newitemname&&"undefined"!=typeof this.metaNodeInfo.ActionEventControls){var f=new t.Text(this.metaNodeInfo.newlineItemName,new t.Rect(this.bounds.x+45,this.bounds.y+34,this.bounds.width-40,35));f.font=h,f.fitInBounds=!1,f.pen=u.pen,this.metaNodeInfo.newlineItemName=this.fittingString(this.newitemname,this.bounds.width-80-p,"nowrap"),this.graphicsContainer.content.push(f),this.setTag(this.metaNodeInfo.newlineItemName)}if("wf:StartActivityNode"!=this.metaNodeInfo.Class.toString()){var m=new t.Path("M "+(this.bounds.x+5).toString()+","+(this.bounds.y+37).toString()+" L "+(this.bounds.x+5+this.bounds.width-10).toString()+","+(this.bounds.y+37).toString());if(m.setBrush("#C4C4C4"),this.graphicsContainer.content.push(m),this.metaNodeInfo.ActionEventControls&&(this.subImageName=this.getSubImages(this.metaNodeInfo.ActionEventControls)),this.subImageName)for(var v=0;v<this.subImageName.length;v++){var y=this.subImageName[v].imageKey,b=KD.getUrlRoot()+"/images/silverlight/default/workflowDesigner/"+y,n=parseFloat(a[0])+20+30*v,o=parseFloat(a[1])+45,r=15,s=15,D=new t.Rect(n,o,r,s),k=this.setSubNodeImage(b,D,this.subImageName[v]);this.subImageList.push(k)}if(this.subImageList)for(var v=0;v<this.subImageList.length;v++)this.graphicsContainer.content.push(this.subImageList[v])}},getSubImages:function(e){var t=this,i=[];if(""===e.length)return null;for(var a=e.split(";"),n=0;n<a.length;n++){var o=a[n].split(","),r={refFlowElementId:o[0],subItemName:o[1],imageKey:t.IsPicture(o[2])?o[2]:"wf_defaultState.png"};i.push(r)}return i},IsPicture:function(e){var t=".jpeg|.gif|.jpg|.png|.bmp|.pic|";if(e.indexOf(".")>-1){var i=e.lastIndexOf("."),a=e.substring(i)+"|";if(a=a.toLowerCase(),t.indexOf(a)>-1)return!0}return!1},getTitle:function(){return this.title},setTitle:function(e){this.title!==e&&(this.title=e)},getFullName:function(){return this.fullName},setFullName:function(e){this.fullName!==e&&(this.fullName=e)},getNodeImageLocation:function(){return this.nodeImageLocation},setMainNodeImageLocation:function(i,a){this.nodeImageLocation!=i&&(this.nodeImageLocation=i,i&&(this.nodeImage=new t.Image(a),e.addHandlers(this.nodeImage.image,{load:e.createDelegate(this,this.loadNodeImage)}),this.nodeImage.image.src=i))},setSubNodeImage:function(e,i,a){var n=new t.Image(i);return n.image.src=e,n},loadNodeImage:function(){if(this.nodeImage.loaded=!0,this.subImageList)for(var e=0;e<this.subImageList.length;e++)this.subImageList[e].loaded=!0;this.parent&&this.invalidate()}},e.registerClass(KDFlowNode,"KDFlowNode",MindFusion.Diagramming.ShapeNode)}(),define("KDFlowNode",["MindFusion_Diagramming"],function(e){return function(){var t;return t||e.KDFlowNode}}(this)),function(){var e=MindFusion.AbstractionLayer;MindFusion.Drawing;OrgChartNode=function(t){e.initializeBase(OrgChartNode,this,[t]),this.setShape("Rectangle"),this.setText("node text")},OrgChartNode.prototype={loadFromOrgJosn:function(e){}},e.registerClass(OrgChartNode,"OrgChartNode",MindFusion.Diagramming.ShapeNode)}(),define("MindFusion_OrgChartNode",["MindFusion_Diagramming"],function(e){return function(){var t;return t||e.MindFusion_OrgChartNode}}(this)),eval(function(e,t,i,a,n,o){if(n=function(e){return(t>e?"":n(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;i--;)o[n(i)]=a[i]||n(i);a=[function(e){return o[e]}],n=function(){return"\\w+"},i=1}for(;i--;)a[i]&&(e=e.replace(new RegExp("\\b"+n(i)+"\\b","g"),a[i]));return e}("(8($){9 v=($.1A.2j&&$.1A.2k<7);9 w=$(1B.1C);9 y=$(y);9 z=F;$.3d.13=8(b){G 5.1Y(8(){9 a=5.3e.3f();A(a=='a'){Q 13(5,b)}})};13=8(g,h){9 j=2l;j=$(g).1D(\"13\");A(j)G j;9 k=5;9 l=$.1E({},$.13.2m,h||{});k.3g=g;g.1p=$(g).R('1p');g.1F=F;g.3h=F;g.1u=F;g.1h=F;g.1b={};g.2n=2l;g.14={};g.1G=F;$(g).D({'3i-1i':'1v','3j-3k':'1v'});9 m=$(\"3l:3m(0)\",g);g.V=$(g).R('V');g.1Z=m.R('V');9 n=($.1w(g.V).Y>0)?g.V:g.1Z;9 p=Q 2o(m);9 q=Q 2p();9 r=Q 2q();9 s=Q 2r();9 t=Q 2s();$(g).1H('2t',8(e){e.2u();G F});9 u=['20','1c','1j','1q'];A($.3n($.1w(l.H),u)<0){l.H='20'}$.1E(k,{21:8(){A($(\".L\",g).Y==0){g.L=$('<Z/>').1I('L');m.3o(g.L)}A(l.H=='1j'){l.15=p.w;l.16=p.h}A($(\".22\",g).Y==0){q.S()}A($(\".23\",g).Y==0){r.S()}A($(\".2v\",g).Y==0){t.S()}A(l.24||l.H=='1c'||l.1J){k.1K()}k.2w()},2w:8(){A(l.H=='1c'){$(\".L\",g).3p(8(){g.1G=17});$(\".L\",g).3q(8(){g.1G=F});1B.1C.3r=8(){G F};$(\".L\",g).D({1L:'1r'});$(\".22\",g).D({1L:'3s'})}A(l.H=='1j'){$(\".1M\",g).D({1L:'3t'})}$(\".L\",g).1H('3u 3v',8(a){m.R('V','');$(g).R('V','');g.1F=17;p.1s();A(g.1h){k.25(a)}1k{k.1K()}});$(\".L\",g).1H('3w',8(a){k.2x()});$(\".L\",g).1H('3x',8(e){A(e.26>p.E.r||e.26<p.E.l||e.27<p.E.t||e.27>p.E.b){q.1N();G F}g.1F=17;A(g.1h&&!$('.23',g).3y(':2y')){k.25(e)}A(g.1h&&(l.H!='1c'||(l.H=='1c'&&g.1G))){q.1l(e)}});9 c=Q 2z();9 i=0;9 d=Q 2z();d=$('a').3z(8(){9 a=Q 3A(\"3B[\\\\s]*:[\\\\s]*'\"+$.1w(g.1p)+\"'\",\"i\");9 b=$(5).R('1p');A(a.3C(b)){G 5}});A(d.Y>0){9 f=d.3D(0,1);d.3E(f)}d.1Y(8(){A(l.24){9 a=$.1E({},1O(\"(\"+$.1w($(5).R('1p'))+\")\"));c[i]=Q 28();c[i].1d=a.1x;i++}$(5).2t(8(e){A($(5).3F('29')){G F}d.1Y(8(){$(5).3G('29')});e.2u();k.2A(5);G F})})},1K:8(){A(g.1h==F&&g.1u==F){9 a=$(g).R('2B');g.1u=17;s.2C(a)}},25:8(e){3H(g.2n);q.T();r.T()},2x:8(e){1P(l.H){1t'1c':W;1r:m.R('V',g.1Z);$(g).R('V',g.V);A(l.1J){q.1N()}1k{r.O();q.O()}W}g.1F=F},2A:8(a){g.1u=F;g.1h=F;9 b=Q 3I();b=$.1E({},1O(\"(\"+$.1w($(a).R('1p'))+\")\"));A(b.1Q&&b.1x){9 c=b.1Q;9 d=b.1x;$(a).1I('29');$(g).R('2B',d);m.R('1d',c);q.O();r.O();k.1K()}1k{2a('2D :: 2E 2F 1R 1x 2G 1Q.');2b'2D :: 2E 2F 1R 1x 2G 1Q.';}G F}});A(m[0].3J){p.1s();A($(\".L\",g).Y==0)k.21()}8 2o(c){9 d=5;5.6=c[0];5.2H=8(){9 a=0;a=c.D('2c-B-P');M='';9 b=0;b=c.D('2c-C-P');K='';A(a){1R(i=0;i<3;i++){9 x=[];x=a.1S(i,1);A(2I(x)==F){M=M+''+a.1S(i,1)}1k{W}}}A(b){1R(i=0;i<3;i++){A(!2I(b.1S(i,1))){K=K+b.1S(i,1)}1k{W}}}d.M=(M.Y>0)?1O(M):0;d.K=(K.Y>0)?1O(K):0};5.1s=8(){d.2H();d.w=c.P();d.h=c.12();d.1m=c.3K();d.1e=c.3L();d.E=c.1f();d.E.l=c.1f().C+d.K;d.E.t=c.1f().B+d.M;d.E.r=d.w+d.E.l;d.E.b=d.h+d.E.t;d.2J=c.1f().C+d.1m;d.3M=c.1f().B+d.1e};5.6.2K=8(){2a('1T 1U 1V X.');2b'1T 1U 1V X.';};5.6.2L=8(){d.1s();A($(\".L\",g).Y==0)k.21()};G d};8 2s(){9 a=5;5.S=8(){5.6=$('<Z/>').1I('2v').D('2d','2M').2N(l.2O);$('.L',g).S(5.6)};5.T=8(){5.6.B=(p.1e-5.6.12())/2;5.6.C=(p.1m-5.6.P())/2;5.6.D({B:5.6.B,C:5.6.C,11:'18',2d:'2y'})};5.O=8(){5.6.D('2d','2M')};G 5}8 2p(){9 d=5;5.6=$('<Z/>').1I('22');5.S=8(){$('.L',g).S($(5.6).O());A(l.H=='1q'){5.X=Q 28();5.X.1d=p.6.1d;$(5.6).2e().S(5.X)}};5.2P=8(){5.6.w=(1W((l.15)/g.1b.x)>p.w)?p.w:(1W(l.15/g.1b.x));5.6.h=(1W((l.16)/g.1b.y)>p.h)?p.h:(1W(l.16/g.1b.y));5.6.B=(p.1e-5.6.h-2)/2;5.6.C=(p.1m-5.6.w-2)/2;5.6.D({B:0,C:0,P:5.6.w+'I',12:5.6.h+'I',11:'18',1g:'1v',2f:1+'I'});A(l.H=='1q'){5.X.1d=p.6.1d;$(5.6).D({'2g':1});$(5.X).D({11:'18',1g:'1y',C:-(5.6.C+1-p.K)+'I',B:-(5.6.B+1-p.M)+'I'})}};5.1N=8(){5.6.B=(p.1e-5.6.h-2)/2;5.6.C=(p.1m-5.6.w-2)/2;5.6.D({B:5.6.B,C:5.6.C});A(l.H=='1q'){$(5.X).D({11:'18',1g:'1y',C:-(5.6.C+1-p.K)+'I',B:-(5.6.B+1-p.M)+'I'})}s.1l()};5.1l=8(e){g.14.x=e.26;g.14.y=e.27;9 b=0;9 c=0;8 2Q(a){G g.14.x-(a.w)/2<p.E.l}8 2R(a){G g.14.x+(a.w)/2>p.E.r}8 2S(a){G g.14.y-(a.h)/2<p.E.t}8 2T(a){G g.14.y+(a.h)/2>p.E.b}b=g.14.x+p.K-p.E.l-(5.6.w+2)/2;c=g.14.y+p.M-p.E.t-(5.6.h+2)/2;A(2Q(5.6)){b=p.K-1}1k A(2R(5.6)){b=p.w+p.K-5.6.w-1}A(2S(5.6)){c=p.M-1}1k A(2T(5.6)){c=p.h+p.M-5.6.h-1}5.6.C=b;5.6.B=c;5.6.D({'C':b+'I','B':c+'I'});A(l.H=='1q'){A($.1A.2j&&$.1A.2k>7){$(5.6).2e().S(5.X)}$(5.X).D({11:'18',1g:'1y',C:-(5.6.C+1-p.K)+'I',B:-(5.6.B+1-p.M)+'I'})}s.1l()};5.O=8(){m.D({'2g':1});5.6.O()};5.T=8(){A(l.H!='1j'&&(l.2U||l.H=='1c')){5.6.T()}A(l.H=='1q'){m.D({'2g':l.2V})}};5.2h=8(){9 o={};o.C=d.6.C;o.B=d.6.B;G o};G 5};8 2q(){9 b=5;5.6=$(\"<Z 1z='23'><Z 1z='1M'><Z 1z='1X'></Z><Z 1z='2i'></Z></Z></Z>\");5.U=$('<2W 1z=\"3N\" 1d=\"3O:\\'\\';\" 3P=\"0\" 3Q=\"0\" 3R=\"2X\" 3S=\"3T\" 3U=\"0\" ></2W>');5.1l=8(){5.6.1n=0;5.6.1o=0;A(l.H!='1j'){1P(l.11){1t\"C\":5.6.1n=(p.E.l-p.K-J.N(l.19)-l.15>0)?(0-l.15-J.N(l.19)):(p.1m+J.N(l.19));5.6.1o=J.N(l.1a);W;1t\"B\":5.6.1n=J.N(l.19);5.6.1o=(p.E.t-p.M-J.N(l.1a)-l.16>0)?(0-l.16-J.N(l.1a)):(p.1e+J.N(l.1a));W;1t\"2X\":5.6.1n=J.N(l.19);5.6.1o=(p.E.t-p.M+p.1e+J.N(l.1a)+l.16<2Y.12)?(p.1e+J.N(l.1a)):(0-l.16-J.N(l.1a));W;1r:5.6.1n=(p.2J+J.N(l.19)+l.15<2Y.P)?(p.1m+J.N(l.19)):(0-l.15-J.N(l.19));5.6.1o=J.N(l.1a);W}}5.6.D({'C':5.6.1n+'I','B':5.6.1o+'I'});G 5};5.S=8(){$('.L',g).S(5.6);5.6.D({11:'18',1g:'1v',2Z:3V});A(l.H=='1j'){5.6.D({1L:'1r'});9 a=(p.K==0)?1:p.K;$('.1M',5.6).D({2f:a+'I'})}$('.1M',5.6).D({P:J.30(l.15)+'I',2f:a+'I'});$('.2i',5.6).D({P:'31%',12:J.30(l.16)+'I'});$('.1X',5.6).D({P:'31%',11:'18'});$('.1X',5.6).O();A(l.V&&n.Y>0){$('.1X',5.6).2N(n).T()}b.1l()};5.O=8(){1P(l.32){1t'3W':5.6.3X(l.33,8(){});W;1r:5.6.O();W}5.U.O()};5.T=8(){1P(l.34){1t'3Y':5.6.35();5.6.35(l.36,8(){});W;1r:5.6.T();W}A(v&&l.H!='1j'){5.U.P=5.6.P();5.U.12=5.6.12();5.U.C=5.6.1n;5.U.B=5.6.1o;5.U.D({1g:'1y',11:\"18\",C:5.U.C,B:5.U.B,2Z:3Z,P:5.U.P+'I',12:5.U.12+'I'});$('.L',g).S(5.U);5.U.T()}}};8 2r(){9 c=5;5.6=Q 28();5.2C=8(a){t.T();5.40=a;5.6.1i.11='18';5.6.1i.2c='37';5.6.1i.1g='1v';5.6.1i.C='-41';5.6.1i.B='37';1B.1C.42(5.6);5.6.1d=a};5.1s=8(){9 a=$(5.6);9 b={};5.6.1i.1g='1y';c.w=a.P();c.h=a.12();c.E=a.1f();c.E.l=a.1f().C;c.E.t=a.1f().B;c.E.r=c.w+c.E.l;c.E.b=c.h+c.E.t;b.x=(c.w/p.w);b.y=(c.h/p.h);g.1b=b;1B.1C.43(5.6);$('.2i',g).2e().S(5.6);q.2P()};5.6.2K=8(){2a('1T 1U 1V 38 39 X.');2b'1T 1U 1V 38 39 X.';};5.6.2L=8(){c.1s();t.O();g.1u=F;g.1h=17;A(l.H=='1c'||l.1J){q.T();r.T();q.1N()}};5.1l=8(){9 a=-g.1b.x*(q.2h().C-p.K+1);9 b=-g.1b.y*(q.2h().B-p.M+1);$(5.6).D({'C':a+'I','B':b+'I'})};G 5};$(g).1D(\"13\",k)};$.13={2m:{H:'20',15:3a,16:3a,19:10,1a:0,11:\"44\",24:17,2O:'45 46',V:17,2U:17,2V:0.4,1J:F,34:'T',32:'O',36:'47',33:'48'},3b:8(a){9 b=$(a).1D('13');b.3b();G F},3c:8(a){9 b=$(a).1D('13');b.3c();G F},49:8(a){z=17},4a:8(a){z=F}}})(4b);",62,260,"|||||this|node||function|var|||||||||||||||||||||||||||if|top|left|css|pos|false|return|zoomType|px|Math|bleft|zoomPad|btop|abs|hide|width|new|attr|append|show|ieframe|title|break|image|length|div||position|height|jqzoom|mousepos|zoomWidth|zoomHeight|true|absolute|xOffset|yOffset|scale|drag|src|oh|offset|display|largeimageloaded|style|innerzoom|else|setposition|ow|leftpos|toppos|rel|reverse|default|fetchdata|case|largeimageloading|none|trim|largeimage|block|class|browser|document|body|data|extend|zoom_active|mouseDown|bind|addClass|alwaysOn|load|cursor|zoomWrapper|setcenter|eval|switch|smallimage|for|substr|Problems|while|loading|parseInt|zoomWrapperTitle|each|imagetitle|standard|create|zoomPup|zoomWindow|preloadImages|activate|pageX|pageY|Image|zoomThumbActive|alert|throw|border|visibility|empty|borderWidth|opacity|getoffset|zoomWrapperImage|msie|version|null|defaults|timer|Smallimage|Lens|Stage|Largeimage|Loader|click|preventDefault|zoomPreload|init|deactivate|visible|Array|swapimage|href|loadimage|ERROR|Missing|parameter|or|findborder|isNaN|rightlimit|onerror|onload|hidden|html|preloadText|setdimensions|overleft|overright|overtop|overbottom|lens|imageOpacity|iframe|bottom|screen|zIndex|round|100|hideEffect|fadeoutSpeed|showEffect|fadeIn|fadeinSpeed|0px|the|big|300|disable|enable|fn|nodeName|toLowerCase|el|zoom_disabled|outline|text|decoration|img|eq|inArray|wrap|mousedown|mouseup|ondragstart|move|crosshair|mouseenter|mouseover|mouseleave|mousemove|is|filter|RegExp|gallery|test|splice|push|hasClass|removeClass|clearTimeout|Object|complete|outerWidth|outerHeight|bottomlimit|zoomIframe|javascript|marginwidth|marginheight|align|scrolling|no|frameborder|5001|fadeout|fadeOut|fadein|99|url|5000px|appendChild|removeChild|right|Loading|zoom|slow|2000|disableAll|enableAll|jQuery".split("|"),0,{})),define("jqzoom-core-pack",["jqueryk3cloudex"],function(e){return function(){var t;return t||e.jqzoom-core-pack}}(this));var ResManager=ResManager||{};ResManager.Language="",ResManager.setLanguage=function(e){ResManager.Language=e},ResManager.getLanguage=function(){if(KD.storage&&KD.storage.getItem)var e=KD.storage.getItem("k3cloudloginInfo")||"{}";else var e=Getk3cloudloginInfo("k3cloudloginInfo");var t=JSON.parse(e);t&&t.lan&&t.lan.length>0?ResManager.Language=t.lan:ResManager.Language="2052"},ResManager.hasLanguageRes=function(e){var t=ResFactoryProxy.getRegisterType(ResManager.Language);return!!t},ResManager.LoadKDString=function(e,t){0==ResManager.Language.length&&ResManager.getLanguage();var i=ResFactoryProxy.getRegisterType(ResManager.Language);if(null==i)return e;var a=i.LangRes[t];return null!=a&&a.length>0?a:e};var ResFactoryProxy=ResFactoryProxy||{};ResFactoryProxy.res=ResFactoryProxy.res||{},ResFactoryProxy.registerType=function(e,t){ResFactoryProxy.res[e]=t},ResFactoryProxy.getRegisterType=function(e){return ResFactoryProxy.res[e]},define("ResManager",["jqueryk3cloudex"],function(e){return function(){var t;return t||e.ResManager}}(this));var MlResource2052=MlResource2052||{};MlResource2052.LangRes={};var ResFactoryProxy=ResFactoryProxy||{};ResFactoryProxy.res=ResFactoryProxy.res||{},ResFactoryProxy.registerType=function(e,t){ResFactoryProxy.res[e]=t},ResFactoryProxy.getRegisterType=function(e){return ResFactoryProxy.res[e]},ResFactoryProxy.registerType("2052",MlResource2052),define("MlResource_2052",["ResManager"],function(e){return function(){var t;return t||e.MlResource_2052}}(this));var KDMessageBox=KDMessageBox||{};KDMessageBox.show=function(e){var t=e.sourceClass?e.sourceClass+"."+e.sourceMethod+"()":"",i=$.extend(new Error,{name:e.name||ResManager.LoadKDString("金蝶提示","099002000000002"),message:(t?t+":":"")+e.msg,mestype:e.type||KDMessageBox.KDMesBoxType.Ok,number:e.number,button:e.button||KDMessageBox.KDMessageBoxButtons.Ok,description:e.description,callback:e.callback,callbackentity:e.callbackentity,args:e.args}),a=!0,n=$("#wholemessage");1==n.length&&(n.parent().remove(),n.length=0);var o=i.description&&i.description!=i.message;o&&!i.message&&(i.message=ResManager.LoadKDString("请求发生错误:请点击更多查看详细内容!","099002000000003"));var r="",s="";switch(i.mestype){case KDMessageBox.KDMesBoxType.Ok:r="content/themes/images/icon_ok.png",s="k-info-colored";break;case KDMessageBox.KDMesBoxType.Normal:r="content/themes/images/icon_normal.png",s="k-info-colored";break;case KDMessageBox.KDMesBoxType.Warning:r="content/themes/images/icon_warn.png",s="k-error-colored";break;case KDMessageBox.KDMesBoxType.Error:r="content/themes/images/icon_error.png",s="k-error-colored";break;case KDMessageBox.KDMesBoxType.Question:r="content/themes/images/icon_question.png",s="k-info-colored";break;default:r="content/themes/images/icon_normal.png",s="k-info-colored"}if(r=KD.getUrlRoot()+"/"+KD.getSubPath()+"/"+r,0==n.length){var l=kendo.format('<div id="wholemessage" style="z-index:99;" data-role="messagebox"><div id="MessageBoxContent" class="k-block {0}"',s)+' style="margin: 15px 18px 15px 15px;overflow:auto;max-height:300px;min-height:30px;">';l+='<div style="position: relative;">',i.mestype!=KDMessageBox.KDMesBoxType.None?(l+='<img src="'+r+'" style="margin-left:10px;float:left;margin-top: -8px;position: absolute;top: 50%" />',l+='<span role="kdtitlespan" style="padding:2px 2px 2px 30px;line-height:18px;word-break:break-word;display:block;word-wrap:break-word;">'+(a?"":KD.convertToHtmlString(i.message+" "))+"</span>"):l+='<span role="kdtitlespan" style="padding:2px;line-height:18px;word-break:break-word;display:block;word-wrap:break-word; ">'+(a?"":KD.convertToHtmlString(i.message+" "))+"</span>",l+="</div>",o&&(l+='<a role="kdmsgMorelink" style="font-size:12px" href="#">更多</a><br /><div role="kdcontent" style="margin:1px 1px 1px 10px;display:none;line-height:18px"><span></span></div>'),l+="</div>";var d='<div style="width:auto;text-align:center;margin-bottom:10px;">';if(d){var c='<button role="kdmsgBtton" autofocus="autofocus" name={btname} class="k-button" style="width:auto;min-width:70px;height:30px;margin:auto;margin-left:8px;margin-right:8px;">{bttext}</button>';switch(i.button){case KDMessageBox.KDMessageBoxButtons.OkCancel:d+=c.replace("{btname}","Ok").replace("{bttext}",ResManager.LoadKDString("确定","099002000000004")),d+=c.replace("{btname}","Cancel").replace("{bttext}",ResManager.LoadKDString("取消","099002000000007"));break;case KDMessageBox.KDMessageBoxButtons.YesNo:d+=c.replace("{btname}","Yes").replace("{bttext}",ResManager.LoadKDString("是","099002000000005")),d+=c.replace("{btname}","No").replace("{bttext}",ResManager.LoadKDString("否","099002000000006"));break;case KDMessageBox.KDMessageBoxButtons.YesNoCancel:d+=c.replace("{btname}","Yes").replace("{bttext}",ResManager.LoadKDString("是","099002000000005")),d+=c.replace("{btname}","No").replace("{bttext}",ResManager.LoadKDString("否","099002000000006")),d+=c.replace("{btname}","Cancel").replace("{bttext}",ResManager.LoadKDString("取消","099002000000007"));break;case KDMessageBox.KDMessageBoxButtons.ExitNotexit:d+=c.replace("{btname}","Exit").replace("{bttext}",ResManager.LoadKDString("继续退出","00215181000007048")),d+=c.replace("{btname}","NotExit").replace("{bttext}",ResManager.LoadKDString("不退出","00215181000007049"));break;default:d+=c.replace("{btname}","Ok").replace("{bttext}",ResManager.LoadKDString("确定","099002000000004"))}d+="</div>",l+=d}l+="</div>",n=$(l),e.extraEl&&n.find("#MessageBoxContent").append(e.extraEl),d&&n.find("[role=kdmsgBtton]").click(function(e){var t,a=$(this)[getPropName()]("name");switch(a){case"Ok":t=KDMessageBox.KDDialogResult.Ok;break;case"Yes":t=KDMessageBox.KDDialogResult.Yes;break;case"No":t=KDMessageBox.KDDialogResult.No;break;case"Cancel":t=KDMessageBox.KDDialogResult.Cancel;break;case"Exit":t=KDMessageBox.KDDialogResult.Exit;break;case"NotExit":t=KDMessageBox.KDDialogResult.NotExit}i.callback&&$.isFunction(i.callback)&&(KD.isEmpty(i.callbackentity)?i.callback(t):i.callback.call(i.callbackentity,t,i.args)),e.preventDefault(),n.data("kendoWindow").close()}),a&&n.find("[role=kdtitlespan]").text(i.message),o&&(n.find("[role=kdmsgMorelink]").click(function(){var e=n.find("[role=kdcontent]").css("display");"none"==e||""==e?n.find("[role=kdcontent]").css({display:"block"}):n.find("[role=kdcontent]").css({display:"none"})}),a?n.find("[role=kdcontent] span:first").text(i.description):n.find("[role=kdcontent] span:first").html(i.description)),n.appendTo($(document.body))}if(n.kendoWindow){var h={title:e.name||ResManager.LoadKDString("金蝶提示","099002000000002"),maxWidth:1200,minWidth:220,width:420,height:"auto",minHeight:0,resizable:!0,modal:!0,pinned:!0,animation:{},close:function(e){}};if(e.actions&&(h.actions=e.actions),i.button==KDMessageBox.KDMessageBoxButtons.Ok){for(var u=h.actions||[],p=[],g=0;g<u.length;g++)"Close"!=u[g]&&p.push(u[g]);h.actions=p}if(n.kendoWindow(h),n.data("kendoWindow").center(),n.find("[role=kdmsgBtton]").focus(),KD.CONST.isStartNewUserUtilityWizards){var f=n.data("kendoWindow");f.wrapper?f.wrapper.addClass("kd-guidepromptintro-outer"):f.element.addClass("kd-guidepromptintro-outer")}}else ClientAppProxy&&ClientAppProxy.Current?alert(i.message+i.description):alert(e.msg)},KDMessageBox.remove=function(){var e=$("body").find('div[data-role="messagebox"]');e.length&&e.data("kendoWindow")&&e.data("kendoWindow").wrapper&&e.data("kendoWindow").wrapper.remove()},KDMessageBox.KDMesBoxType={None:0,Normal:0,Warning:1,Ok:2,Question:3,Error:4},KDMessageBox.KDMessageBoxButtons={Ok:0,OkCancel:1,YesNo:2,YesNoCancel:3,ExitNotexit:4},KDMessageBox.KDDialogResult={None:0,Ok:1,Cancel:2,Abort:3,Retry:4,Ignore:5,Yes:6,No:7,Exit:8,NotExit:9},define("KDMessageBox",["jqueryk3cloudex"],function(e){return function(){var t;return t||e.KDMessageBox}}(this)),Function.__typeName="Function",Function.__class=!0,Function.createCallback=function(e,t){return function(){var i=arguments.length;if(i>0){for(var a=[],n=0;i>n;n++)a[n]=arguments[n];return a[i]=t,e.apply(this,a)}return e.call(this,t)}},Function.createDelegate=function(e,t){return function(){return t.apply(e,arguments)}},Function.emptyFunction=Function.emptyMethod=function(){},Function.validateParameters=function(e,t,i){return Function._validateParams(e,t,i)},Function._validateParams=function(e,t,i){var a,n=t.length;if(i=i||"undefined"==typeof i,a=Function._validateParameterCount(e,t,i))return a.popStackFrame(),a;for(var o=0,r=e.length;r>o;o++){var s=t[Math.min(o,n-1)],l=s.name;if(s.parameterArray)l+="["+(o-n+1)+"]";else if(!i&&o>=n)break;if(a=Function._validateParameter(e[o],s,l))return a.popStackFrame(),a}return null},Function._validateParameterCount=function(e,t,i){var a,n,o=t.length,r=e.length;if(o>r){var s=o;for(a=0;o>a;a++){var l=t[a];(l.optional||l.parameterArray)&&s--}s>r&&(n=!0)}else if(i&&r>o)for(n=!0,a=0;o>a;a++)if(t[a].parameterArray){n=!1;break}if(n){var d=Error.parameterCount();return d.popStackFrame(),d}return null},Function._validateParameter=function(e,t,i){var a,n=t.type,o=!!t.integer,r=!!t.domElement,s=!!t.mayBeNull;if(a=Function._validateParameterType(e,n,o,r,s,i))return a.popStackFrame(),a;var l=t.elementType,d=!!t.elementMayBeNull;if(n===Array&&"undefined"!=typeof e&&null!==e&&(l||!d))for(var c=!!t.elementInteger,h=!!t.elementDomElement,u=0;u<e.length;u++){var p=e[u];if(a=Function._validateParameterType(p,l,c,h,d,i+"["+u+"]"))return a.popStackFrame(),a}return null},Function._validateParameterType=function(e,t,i,a,n,o){var r,s;if("undefined"==typeof e)return n?null:(r=Error.argumentUndefined(o),r.popStackFrame(),r);if(null===e)return n?null:(r=Error.argumentNull(o),r.popStackFrame(),r);if(t&&t.__enum){if("number"!=typeof e)return r=Error.argumentType(o,Object.getType(e),t),r.popStackFrame(),r;if(e%1===0){var l=t.prototype;if(t.__flags&&0!==e){var d=e;for(s in l){var c=l[s];if(0!==c&&((c&e)===c&&(d-=c),0===d))return null}}else for(s in l)if(l[s]===e)return null}return r=Error.argumentOutOfRange(o,e,String.format(Sys.Res.enumInvalidValue,e,t.getName())),r.popStackFrame(),r}return!a||Sys._isDomElement(e)&&3!==e.nodeType?t&&!Sys._isInstanceOfType(t,e)?(r=Error.argumentType(o,Object.getType(e),t),r.popStackFrame(),r):t===Number&&i&&e%1!==0?(r=Error.argumentOutOfRange(o,e,Sys.Res.argumentInteger),r.popStackFrame(),r):null:(r=Error.argument(o,Sys.Res.argumentDomElement),r.popStackFrame(),r)},Error.__typeName="Error",Error.__class=!0,Error.create=function(e,t){var i=new Error(e);if(i.message=e,t)for(var a in t)i[a]=t[a];return i.popStackFrame(),i},Error.argument=function(e,t){var i="Sys.ArgumentException: "+(t?t:Sys.Res.argument);e&&(i+="\n"+String.format(Sys.Res.paramName,e));var a=Error.create(i,{name:"Sys.ArgumentException",paramName:e});return a.popStackFrame(),a},Error.argumentNull=function(e,t){var i="Sys.ArgumentNullException: "+(t?t:Sys.Res.argumentNull);e&&(i+="\n"+String.format(Sys.Res.paramName,e));var a=Error.create(i,{name:"Sys.ArgumentNullException",paramName:e});return a.popStackFrame(),a},Error.argumentOutOfRange=function(e,t,i){var a="Sys.ArgumentOutOfRangeException: "+(i?i:Sys.Res.argumentOutOfRange);e&&(a+="\n"+String.format(Sys.Res.paramName,e)),"undefined"!=typeof t&&null!==t&&(a+="\n"+String.format(Sys.Res.actualValue,t));var n=Error.create(a,{name:"Sys.ArgumentOutOfRangeException",paramName:e,actualValue:t});return n.popStackFrame(),n},Error.argumentType=function(e,t,i,a){var n="Sys.ArgumentTypeException: ";n+=a?a:t&&i?String.format(Sys.Res.argumentTypeWithTypes,t.getName(),i.getName()):Sys.Res.argumentType,e&&(n+="\n"+String.format(Sys.Res.paramName,e));var o=Error.create(n,{name:"Sys.ArgumentTypeException",paramName:e,actualType:t,expectedType:i});return o.popStackFrame(),o},Error.argumentUndefined=function(e,t){var i="Sys.ArgumentUndefinedException: "+(t?t:Sys.Res.argumentUndefined);e&&(i+="\n"+String.format(Sys.Res.paramName,e));var a=Error.create(i,{name:"Sys.ArgumentUndefinedException",paramName:e});return a.popStackFrame(),a},Error.format=function(e){var t="Sys.FormatException: "+(e?e:Sys.Res.format),i=Error.create(t,{name:"Sys.FormatException"});return i.popStackFrame(),i},Error.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e?e:Sys.Res.invalidOperation),i=Error.create(t,{name:"Sys.InvalidOperationException"});return i.popStackFrame(),i},Error.notImplemented=function(e){var t="Sys.NotImplementedException: "+(e?e:Sys.Res.notImplemented),i=Error.create(t,{name:"Sys.NotImplementedException"});return i.popStackFrame(),i},Error.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e?e:Sys.Res.parameterCount),i=Error.create(t,{name:"Sys.ParameterCountException"});return i.popStackFrame(),i},Error.prototype.popStackFrame=function(){if("undefined"!=typeof this.stack&&null!==this.stack&&"undefined"!=typeof this.fileName&&null!==this.fileName&&"undefined"!=typeof this.lineNumber&&null!==this.lineNumber){for(var e=this.stack.split("\n"),t=e[0],i=this.fileName+":"+this.lineNumber;"undefined"!=typeof t&&null!==t&&-1===t.indexOf(i);)e.shift(),t=e[0];var a=e[1];if("undefined"!=typeof a&&null!==a){var n=a.match(/@(.*):(\d+)$/);"undefined"!=typeof n&&null!==n&&(this.fileName=n[1],this.lineNumber=parseInt(n[2]),e.shift(),this.stack=e.join("\n"))}}},Object.__typeName="Object",Object.__class=!0,Object.getType=function(e){var t=e.constructor;return t&&"function"==typeof t&&t.__typeName&&"Object"!==t.__typeName?t:Object},Object.getTypeName=function(e){return Object.getType(e).getName()},String.__typeName="String",String.__class=!0,String.prototype.endsWith=function(e){return this.substr(this.length-e.length)===e},String.prototype.startsWith=function(e){return this.substr(0,e.length)===e},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.trimEnd=function(){return this.replace(/\s+$/,"")},String.prototype.trimStart=function(){return this.replace(/^\s+/,"")},String.format=function(){return String._toFormattedString(!1,arguments)},String._toFormattedString=function(e,t){for(var i="",a=t[0],n=0;!0;){var o=a.indexOf("{",n),r=a.indexOf("}",n);if(0>o&&0>r){i+=a.slice(n);break}if(r>0&&(o>r||0>o))i+=a.slice(n,r+1),n=r+2;else if(i+=a.slice(n,o),n=o+1,"{"!==a.charAt(n)){if(0>r)break;var s=a.substring(n,r),l=s.indexOf(":"),d=parseInt(0>l?s:s.substring(0,l),10)+1,c=0>l?"":s.substring(l+1),h=t[d];("undefined"==typeof h||null===h)&&(h=""),i+=h.toFormattedString?h.toFormattedString(c):e&&h.localeFormat?h.localeFormat(c):h.format?h.format(c):h.toString(),n=r+1}else i+="{",n++}return i},Boolean.__typeName="Boolean",Boolean.__class=!0,Boolean.parse=function(e){var t=e.trim().toLowerCase();return"false"===t?!1:"true"===t?!0:void 0},Date.__typeName="Date",Date.__class=!0,Number.__typeName="Number",Number.__class=!0,RegExp.__typeName="RegExp",RegExp.__class=!0,window||(this.window=this),window.Type=Function,Type.prototype.callBaseMethod=function(e,t,i){var a=Sys._getBaseMethod(this,e,t);return i?a.apply(e,i):a.apply(e)},Type.prototype.getBaseMethod=function(e,t){return Sys._getBaseMethod(this,e,t)},Type.prototype.getBaseType=function(){return"undefined"==typeof this.__baseType?null:this.__baseType},Type.prototype.getInterfaces=function(){for(var e=[],t=this;t;){var i=t.__interfaces;if(i)for(var a=0,n=i.length;n>a;a++){var o=i[a];Array.contains(e,o)||(e[e.length]=o)}t=t.__baseType}return e},Type.prototype.getName=function(){return"undefined"==typeof this.__typeName?"":this.__typeName},Type.prototype.implementsInterface=function(e){this.resolveInheritance();var t=e.getName(),i=this.__interfaceCache;if(i){var a=i[t];if("undefined"!=typeof a)return a}else i=this.__interfaceCache={};for(var n=this;n;){var o=n.__interfaces;if(o&&-1!==Array.indexOf(o,e))return i[t]=!0;n=n.__baseType}return i[t]=!1},Type.prototype.inheritsFrom=function(e){this.resolveInheritance();for(var t=this.__baseType;t;){if(t===e)return!0;t=t.__baseType}return!1},Type.prototype.initializeBase=function(e,t){return this.resolveInheritance(),this.__baseType&&(t?this.__baseType.apply(e,t):this.__baseType.apply(e)),e},Type.prototype.isImplementedBy=function(e){if("undefined"==typeof e||null===e)return!1;var t=Object.getType(e);return!(!t.implementsInterface||!t.implementsInterface(this))},Type.prototype.isInstanceOfType=function(e){return Sys._isInstanceOfType(this,e)},Type.prototype.registerClass=function(e,t,i){if(this.prototype.constructor=this,this.__typeName=e,this.__class=!0,t&&(this.__baseType=t,this.__basePrototypePending=!0),Sys.__upperCaseTypes[e.toUpperCase()]=this,i){this.__interfaces=[];for(var a=2,n=arguments.length;n>a;a++){var o=arguments[a];this.__interfaces.push(o)}}return this},Type.prototype.registerInterface=function(e){return Sys.__upperCaseTypes[e.toUpperCase()]=this,this.prototype.constructor=this,this.__typeName=e,this.__interface=!0,this},Type.prototype.resolveInheritance=function(){if(this.__basePrototypePending){var e=this.__baseType;e.resolveInheritance();for(var t in e.prototype){var i=e.prototype[t];this.prototype[t]||(this.prototype[t]=i)}delete this.__basePrototypePending}},Type.getRootNamespaces=function(){return Array.clone(Sys.__rootNamespaces)},Type.isClass=function(e){return"undefined"==typeof e||null===e?!1:!!e.__class},Type.isInterface=function(e){return"undefined"==typeof e||null===e?!1:!!e.__interface},Type.isNamespace=function(e){return"undefined"==typeof e||null===e?!1:!!e.__namespace},Type.parse=function(typeName,ns){var fn;return ns?(fn=Sys.__upperCaseTypes[ns.getName().toUpperCase()+"."+typeName.toUpperCase()],fn||null):typeName?(Type.__htClasses||(Type.__htClasses={}),fn=Type.__htClasses[typeName],fn||(fn=eval(typeName),Type.__htClasses[typeName]=fn),fn):null},Type.registerNamespace=function(e){for(var t=window,i=e.split("."),a=0;a<i.length;a++){var n=i[a],o=t[n];o||(o=t[n]={}),o.__namespace||(0===a&&"Sys"!==e&&(Sys.__rootNamespaces[Sys.__rootNamespaces.length]=o),o.__namespace=!0,o.__typeName=i.slice(0,a+1).join("."),o.getName=function(){return this.__typeName}),t=o}},Type._checkDependency=function(e,t){var i=Type._registerScript._scripts,a=i?!!i[e]:!1;
if("undefined"!=typeof t&&!a)throw Error.invalidOperation(String.format(Sys.Res.requiredScriptReferenceNotIncluded,t,e));return a},Type._registerScript=function(e,t){var i=Type._registerScript._scripts;if(i||(Type._registerScript._scripts=i={}),i[e])throw Error.invalidOperation(String.format(Sys.Res.scriptAlreadyLoaded,e));if(i[e]=!0,t)for(var a=0,n=t.length;n>a;a++){var o=t[a];if(!Type._checkDependency(o))throw Error.invalidOperation(String.format(Sys.Res.scriptDependencyNotFound,e,o))}},Type.registerNamespace("Sys"),Sys.__upperCaseTypes={},Sys.__rootNamespaces=[Sys],Sys._isInstanceOfType=function(e,t){if("undefined"==typeof t||null===t)return!1;if(t instanceof e)return!0;var i=Object.getType(t);return!(i!==e)||i.inheritsFrom&&i.inheritsFrom(e)||i.implementsInterface&&i.implementsInterface(e)},Sys._getBaseMethod=function(e,t,i){var a=e.getBaseType();if(a){var n=a.prototype[i];return n instanceof Function?n:null}return null},Sys._isDomElement=function(e){var t=!1;if("number"!=typeof e.nodeType){var i=e.ownerDocument||e.document||e;if(i!=e){var a=i.defaultView||i.parentWindow;t=a!=e}else t="undefined"==typeof i.body}return!t},Array.__typeName="Array",Array.__class=!0,Array.add=Array.enqueue=function(e,t){e[e.length]=t},Array.addRange=function(e,t){e.push.apply(e,t)},Array.clear=function(e){e.length=0},Array.clone=function(e){return 1===e.length?[e[0]]:Array.apply(null,e)},Array.contains=function(e,t){return Sys._indexOf(e,t)>=0},Array.dequeue=function(e){return e.shift()},Array.forEach=function(e,t,i){for(var a=0,n=e.length;n>a;a++){var o=e[a];"undefined"!=typeof o&&t.call(i,o,a,e)}},Array.indexOf=function(e,t,i){return Sys._indexOf(e,t,i)},Array.insert=function(e,t,i){e.splice(t,0,i)},Array.parse=function(value){return value?eval(value):[]},Array.remove=function(e,t){var i=Sys._indexOf(e,t);return i>=0&&e.splice(i,1),i>=0},Array.removeAt=function(e,t){e.splice(t,1)},Sys._indexOf=function(e,t,i){if("undefined"==typeof t)return-1;var a=e.length;if(0!==a){i-=0,isNaN(i)?i=0:(isFinite(i)&&(i-=i%1),0>i&&(i=Math.max(0,a+i)));for(var n=i;a>n;n++)if("undefined"!=typeof e[n]&&e[n]===t)return n}return-1},Type._registerScript._scripts={"MicrosoftAjaxCore.js":!0,"MicrosoftAjaxGlobalization.js":!0,"MicrosoftAjaxSerialization.js":!0,"MicrosoftAjaxComponentModel.js":!0,"MicrosoftAjaxHistory.js":!0,"MicrosoftAjaxNetwork.js":!0,"MicrosoftAjaxWebServices.js":!0},Sys.IDisposable=function(){},Sys.IDisposable.prototype={},Sys.IDisposable.registerInterface("Sys.IDisposable"),Sys.StringBuilder=function(e){this._parts="undefined"!=typeof e&&null!==e&&""!==e?[e.toString()]:[],this._value={},this._len=0},Sys.StringBuilder.prototype={append:function(e){this._parts[this._parts.length]=e},appendLine:function(e){this._parts[this._parts.length]="undefined"==typeof e||null===e||""===e?"\r\n":e+"\r\n"},clear:function(){this._parts=[],this._value={},this._len=0},isEmpty:function(){return 0===this._parts.length?!0:""===this.toString()},toString:function(e){e=e||"";var t=this._parts;this._len!==t.length&&(this._value={},this._len=t.length);var i=this._value;if("undefined"==typeof i[e]){if(""!==e)for(var a=0;a<t.length;)"undefined"==typeof t[a]||""===t[a]||null===t[a]?t.splice(a,1):a++;i[e]=this._parts.join(e)}return i[e]}},Sys.StringBuilder.registerClass("Sys.StringBuilder"),Sys.Browser={},Sys.Browser.InternetExplorer={},Sys.Browser.Firefox={},Sys.Browser.Safari={},Sys.Browser.Opera={},Sys.Browser.agent=null,Sys.Browser.hasDebuggerStatement=!1,Sys.Browser.name=navigator.appName,Sys.Browser.version=parseFloat(navigator.appVersion),Sys.Browser.documentMode=0,navigator.userAgent.indexOf(" MSIE ")>-1?(Sys.Browser.agent=Sys.Browser.InternetExplorer,Sys.Browser.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]),Sys.Browser.version>=8&&document.documentMode>=7&&(Sys.Browser.documentMode=document.documentMode),Sys.Browser.hasDebuggerStatement=!0):navigator.userAgent.indexOf(" Firefox/")>-1?(Sys.Browser.agent=Sys.Browser.Firefox,Sys.Browser.version=parseFloat(navigator.userAgent.match(/Firefox\/(\d+\.\d+)/)[1]),Sys.Browser.name="Firefox",Sys.Browser.hasDebuggerStatement=!0):navigator.userAgent.indexOf(" AppleWebKit/")>-1?(Sys.Browser.agent=Sys.Browser.Safari,Sys.Browser.version=parseFloat(navigator.userAgent.match(/AppleWebKit\/(\d+(\.\d+)?)/)[1]),Sys.Browser.name="Safari"):navigator.userAgent.indexOf("Opera/")>-1&&(Sys.Browser.agent=Sys.Browser.Opera),Sys.EventArgs=function(){},Sys.EventArgs.registerClass("Sys.EventArgs"),Sys.EventArgs.Empty=new Sys.EventArgs,Sys.CancelEventArgs=function(){Sys.CancelEventArgs.initializeBase(this),this._cancel=!1},Sys.CancelEventArgs.prototype={get_cancel:function(){return this._cancel},set_cancel:function(e){this._cancel=e}},Sys.CancelEventArgs.registerClass("Sys.CancelEventArgs",Sys.EventArgs),Type.registerNamespace("Sys.UI"),Sys._Debug=function(){},Sys._Debug.prototype={_appendConsole:function(e){"undefined"!=typeof Debug&&Debug.writeln&&Debug.writeln(e),window.console&&window.console.log&&window.console.log(e),window.opera&&window.opera.postError(e),window.debugService&&window.debugService.trace(e)},_appendTrace:function(e){var t=document.getElementById("TraceConsole");t&&"TEXTAREA"===t.tagName.toUpperCase()&&(t.value+=e+"\n")},assert:function(e,t,i){e||(t=i&&this.assert.caller?String.format(Sys.Res.assertFailedCaller,t,this.assert.caller):String.format(Sys.Res.assertFailed,t),confirm(String.format(Sys.Res.breakIntoDebugger,t))&&this.fail(t))},clearTrace:function(){var e=document.getElementById("TraceConsole");e&&"TEXTAREA"===e.tagName.toUpperCase()&&(e.value="")},fail:function(message){this._appendConsole(message),Sys.Browser.hasDebuggerStatement&&eval("debugger")},trace:function(e){this._appendConsole(e),this._appendTrace(e)},traceDump:function(e,t){this._traceDump(e,t,!0)},_traceDump:function(e,t,i,a,n){if(t=t?t:"traceDump",a=a?a:"",null===e)return void this.trace(a+t+": null");switch(typeof e){case"undefined":this.trace(a+t+": Undefined");break;case"number":case"string":case"boolean":this.trace(a+t+": "+e);break;default:if(Date.isInstanceOfType(e)||RegExp.isInstanceOfType(e)){this.trace(a+t+": "+e.toString());break}if(n){if(Array.contains(n,e))return void this.trace(a+t+": ...")}else n=[];if(Array.add(n,e),e==window||e===document||window.HTMLElement&&e instanceof HTMLElement||"string"==typeof e.nodeName){var o=e.tagName?e.tagName:"DomElement";e.id&&(o+=" - "+e.id),this.trace(a+t+" {"+o+"}")}else{var r=Object.getTypeName(e);if(this.trace(a+t+("string"==typeof r?" {"+r+"}":"")),""===a||i){a+="    ";var s,l,d,c;if(Array.isInstanceOfType(e))for(l=e.length,s=0;l>s;s++)this._traceDump(e[s],"["+s+"]",i,a,n);else for(d in e)c=e[d],Function.isInstanceOfType(c)||this._traceDump(c,d,i,a,n)}}Array.remove(n,e)}}},Sys._Debug.registerClass("Sys._Debug"),Sys.Debug=new Sys._Debug,Sys.Debug.isDebug=!1,Type.prototype.registerEnum=function(e,t){Sys.__upperCaseTypes[e.toUpperCase()]=this;for(var i in this.prototype)this[i]=this.prototype[i];this.__typeName=e,this.parse=Sys$Enum$parse,this.__string=this.toString(),this.toString=Sys$Enum$toString,this.__flags=t,this.__enum=!0},Type.isEnum=function(e){return"undefined"==typeof e||null===e?!1:!!e.__enum},Type.isFlags=function(e){return"undefined"==typeof e||null===e?!1:!!e.__flags},Sys.CollectionChange=function(e,t,i,a,n){this.action=e,t&&(t instanceof Array||(t=[t])),this.newItems=t||null,"number"!=typeof i&&(i=-1),this.newStartingIndex=i,a&&(a instanceof Array||(a=[a])),this.oldItems=a||null,"number"!=typeof n&&(n=-1),this.oldStartingIndex=n},Sys.CollectionChange.registerClass("Sys.CollectionChange"),Sys.NotifyCollectionChangedAction=function(){throw Error.notImplemented()},Sys.NotifyCollectionChangedAction.prototype={add:0,remove:1,reset:2},Sys.NotifyCollectionChangedAction.registerEnum("Sys.NotifyCollectionChangedAction"),Sys.NotifyCollectionChangedEventArgs=function(e){this._changes=e,Sys.NotifyCollectionChangedEventArgs.initializeBase(this)},Sys.NotifyCollectionChangedEventArgs.prototype={get_changes:function(){return this._changes||[]}},Sys.NotifyCollectionChangedEventArgs.registerClass("Sys.NotifyCollectionChangedEventArgs",Sys.EventArgs),Sys.Observer=function(){},Sys.Observer.registerClass("Sys.Observer"),Sys.Observer.makeObservable=function(e){var t=e instanceof Array,i=Sys.Observer;return e.setValue===i._observeMethods.setValue?e:(i._addMethods(e,i._observeMethods),t&&i._addMethods(e,i._arrayMethods),e)},Sys.Observer._addMethods=function(e,t){for(var i in t)e[i]=t[i]},Sys.Observer._addEventHandler=function(e,t,i){Sys.Observer._getContext(e,!0).events._addHandler(t,i)},Sys.Observer.addEventHandler=function(e,t,i){Sys.Observer._addEventHandler(e,t,i)},Sys.Observer._removeEventHandler=function(e,t,i){Sys.Observer._getContext(e,!0).events._removeHandler(t,i)},Sys.Observer.removeEventHandler=function(e,t,i){Sys.Observer._removeEventHandler(e,t,i)},Sys.Observer.raiseEvent=function(e,t,i){var a=Sys.Observer._getContext(e);if(a){var n=a.events.getHandler(t);n&&n(e,i)}},Sys.Observer.addPropertyChanged=function(e,t){Sys.Observer._addEventHandler(e,"propertyChanged",t)},Sys.Observer.removePropertyChanged=function(e,t){Sys.Observer._removeEventHandler(e,"propertyChanged",t)},Sys.Observer.beginUpdate=function(e){Sys.Observer._getContext(e,!0).updating=!0},Sys.Observer.endUpdate=function(e){var t=Sys.Observer._getContext(e);if(t&&t.updating){t.updating=!1;var i=t.dirty;if(t.dirty=!1,i){if(e instanceof Array){var a=t.changes;t.changes=null,Sys.Observer.raiseCollectionChanged(e,a)}Sys.Observer.raisePropertyChanged(e,"")}}},Sys.Observer.isUpdating=function(e){var t=Sys.Observer._getContext(e);return t?t.updating:!1},Sys.Observer._setValue=function(e,t,i){for(var a,n,o=e,r=t.split("."),s=0,l=r.length-1;l>s;s++){var d=r[s];a=e["get_"+d],e="function"==typeof a?a.call(e):e[d];var c=typeof e;if(null===e||"undefined"===c)throw Error.invalidOperation(String.format(Sys.Res.nullReferenceInPath,t))}var h,u=r[l];if(a=e["get_"+u],n=e["set_"+u],h="function"==typeof a?a.call(e):e[u],"function"==typeof n?n.call(e,i):e[u]=i,h!==i){var p=Sys.Observer._getContext(o);if(p&&p.updating)return void(p.dirty=!0);Sys.Observer.raisePropertyChanged(o,r[0])}},Sys.Observer.setValue=function(e,t,i){Sys.Observer._setValue(e,t,i)},Sys.Observer.raisePropertyChanged=function(e,t){Sys.Observer.raiseEvent(e,"propertyChanged",new Sys.PropertyChangedEventArgs(t))},Sys.Observer.addCollectionChanged=function(e,t){Sys.Observer._addEventHandler(e,"collectionChanged",t)},Sys.Observer.removeCollectionChanged=function(e,t){Sys.Observer._removeEventHandler(e,"collectionChanged",t)},Sys.Observer._collectionChange=function(e,t){var i=Sys.Observer._getContext(e);if(i&&i.updating){i.dirty=!0;var a=i.changes;a?a.push(t):i.changes=a=[t]}else Sys.Observer.raiseCollectionChanged(e,[t]),Sys.Observer.raisePropertyChanged(e,"length")},Sys.Observer.add=function(e,t){var i=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[t],e.length);Array.add(e,t),Sys.Observer._collectionChange(e,i)},Sys.Observer.addRange=function(e,t){var i=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,t,e.length);Array.addRange(e,t),Sys.Observer._collectionChange(e,i)},Sys.Observer.clear=function(e){var t=Array.clone(e);Array.clear(e),Sys.Observer._collectionChange(e,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.reset,null,-1,t,0))},Sys.Observer.insert=function(e,t,i){Array.insert(e,t,i),Sys.Observer._collectionChange(e,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[i],t))},Sys.Observer.remove=function(e,t){var i=Array.indexOf(e,t);return-1!==i?(Array.remove(e,t),Sys.Observer._collectionChange(e,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[t],i)),!0):!1},Sys.Observer.removeAt=function(e,t){if(t>-1&&t<e.length){var i=e[t];Array.removeAt(e,t),Sys.Observer._collectionChange(e,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[i],t))}},Sys.Observer.raiseCollectionChanged=function(e,t){Sys.Observer.raiseEvent(e,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(t))},Sys.Observer._observeMethods={add_propertyChanged:function(e){Sys.Observer._addEventHandler(this,"propertyChanged",e)},remove_propertyChanged:function(e){Sys.Observer._removeEventHandler(this,"propertyChanged",e)},addEventHandler:function(e,t){Sys.Observer._addEventHandler(this,e,t)},removeEventHandler:function(e,t){Sys.Observer._removeEventHandler(this,e,t)},get_isUpdating:function(){return Sys.Observer.isUpdating(this)},beginUpdate:function(){Sys.Observer.beginUpdate(this)},endUpdate:function(){Sys.Observer.endUpdate(this)},setValue:function(e,t){Sys.Observer._setValue(this,e,t)},raiseEvent:function(e,t){Sys.Observer.raiseEvent(this,e,t)},raisePropertyChanged:function(e){Sys.Observer.raiseEvent(this,"propertyChanged",new Sys.PropertyChangedEventArgs(e))}},Sys.Observer._arrayMethods={add_collectionChanged:function(e){Sys.Observer._addEventHandler(this,"collectionChanged",e)},remove_collectionChanged:function(e){Sys.Observer._removeEventHandler(this,"collectionChanged",e)},add:function(e){Sys.Observer.add(this,e)},addRange:function(e){Sys.Observer.addRange(this,e)},clear:function(){Sys.Observer.clear(this)},insert:function(e,t){Sys.Observer.insert(this,e,t)},remove:function(e){return Sys.Observer.remove(this,e)},removeAt:function(e){Sys.Observer.removeAt(this,e)},raiseCollectionChanged:function(e){Sys.Observer.raiseEvent(this,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(e))}},Sys.Observer._getContext=function(e,t){var i=e._observerContext;return i?i():t?(e._observerContext=Sys.Observer._createContext())():null},Sys.Observer._createContext=function(){var e={events:new Sys.EventHandlerList};return function(){return e}},Date._appendPreOrPostMatch=function(e,t){for(var i=0,a=!1,n=0,o=e.length;o>n;n++){var r=e.charAt(n);switch(r){case"'":a?t.append("'"):i++,a=!1;break;case"\\":a&&t.append("\\"),a=!a;break;default:t.append(r),a=!1}}return i},Date._expandFormat=function(e,t){t||(t="F");var i=t.length;if(1===i)switch(t){case"d":return e.ShortDatePattern;case"D":return e.LongDatePattern;case"t":return e.ShortTimePattern;case"T":return e.LongTimePattern;case"f":return e.LongDatePattern+" "+e.ShortTimePattern;case"F":return e.FullDateTimePattern;case"M":case"m":return e.MonthDayPattern;case"s":return e.SortableDateTimePattern;case"Y":case"y":return e.YearMonthPattern;default:throw Error.format(Sys.Res.formatInvalidString)}else 2===i&&"%"===t.charAt(0)&&(t=t.charAt(1));return t},Date._expandYear=function(e,t){var i=new Date,a=Date._getEra(i);if(100>t){var n=Date._getEraYear(i,e,a);t+=n-n%100,t>e.Calendar.TwoDigitYearMax&&(t-=100)}return t},Date._getEra=function(e,t){if(!t)return 0;for(var i,a=e.getTime(),n=0,o=t.length;o>n;n+=4)if(i=t[n+2],null===i||a>=i)return n;return 0},Date._getEraYear=function(e,t,i,a){var n=e.getFullYear();return!a&&t.eras&&(n-=t.eras[i+3]),n},Date._getParseRegExp=function(e,t){if(e._parseRegExp){if(e._parseRegExp[t])return e._parseRegExp[t]}else e._parseRegExp={};var i=Date._expandFormat(e,t);i=i.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var a,n=new Sys.StringBuilder("^"),o=[],r=0,s=0,l=Date._getTokenRegExp();null!==(a=l.exec(i));){var d=i.slice(r,a.index);if(r=l.lastIndex,s+=Date._appendPreOrPostMatch(d,n),s%2!==1){switch(a[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":n.append("(\\D+)");break;case"tt":case"t":n.append("(\\D*)");break;case"yyyy":n.append("(\\d{4})");break;case"fff":n.append("(\\d{3})");break;case"ff":n.append("(\\d{2})");break;case"f":n.append("(\\d)");break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":n.append("(\\d\\d?)");break;case"zzz":n.append("([+-]?\\d\\d?:\\d{2})");break;case"zz":case"z":n.append("([+-]?\\d\\d?)");break;case"/":n.append("(\\"+e.DateSeparator+")")}Array.add(o,a[0])}else n.append(a[0])}Date._appendPreOrPostMatch(i.slice(r),n),n.append("$");var c=n.toString().replace(/\s+/g,"\\s+"),h={regExp:c,groups:o};return e._parseRegExp[t]=h,h},Date._getTokenRegExp=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},Date.parseLocale=function(e){return Date._parse(e,Sys.CultureInfo.CurrentCulture,arguments)},Date.parseInvariant=function(e){return Date._parse(e,Sys.CultureInfo.InvariantCulture,arguments)},Date._parse=function(e,t,i){var a,n,o,r,s,l=!1;for(a=1,n=i.length;n>a;a++)if(r=i[a],r&&(l=!0,o=Date._parseExact(e,r,t)))return o;if(!l)for(s=t._getDateTimeFormats(),a=0,n=s.length;n>a;a++)if(o=Date._parseExact(e,s[a],t))return o;return null},Date._parseExact=function(e,t,i){e=e.trim();var a=i.dateTimeFormat,n=Date._getParseRegExp(a,t),o=new RegExp(n.regExp).exec(e);if(null===o)return null;for(var r,s=n.groups,l=null,d=null,c=null,h=null,u=null,p=0,g=0,f=0,m=0,v=null,y=!1,b=0,D=s.length;D>b;b++){var k=o[b+1];if(k)switch(s[b]){case"dd":case"d":if(h=parseInt(k,10),1>h||h>31)return null;break;case"MMMM":if(c=i._getMonthIndex(k),0>c||c>11)return null;break;case"MMM":if(c=i._getAbbrMonthIndex(k),0>c||c>11)return null;break;case"M":case"MM":if(c=parseInt(k,10)-1,0>c||c>11)return null;break;case"y":case"yy":if(d=Date._expandYear(a,parseInt(k,10)),0>d||d>9999)return null;break;case"yyyy":if(d=parseInt(k,10),0>d||d>9999)return null;break;case"h":case"hh":if(p=parseInt(k,10),12===p&&(p=0),0>p||p>11)return null;break;case"H":case"HH":if(p=parseInt(k,10),0>p||p>23)return null;break;case"m":case"mm":if(g=parseInt(k,10),0>g||g>59)return null;break;case"s":case"ss":if(f=parseInt(k,10),0>f||f>59)return null;break;case"tt":case"t":var C=k.toUpperCase();if(y=C===a.PMDesignator.toUpperCase(),!y&&C!==a.AMDesignator.toUpperCase())return null;break;case"f":if(m=100*parseInt(k,10),0>m||m>999)return null;break;case"ff":if(m=10*parseInt(k,10),0>m||m>999)return null;break;case"fff":if(m=parseInt(k,10),0>m||m>999)return null;break;case"dddd":if(u=i._getDayIndex(k),0>u||u>6)return null;break;case"ddd":if(u=i._getAbbrDayIndex(k),0>u||u>6)return null;break;case"zzz":var x=k.split(/:/);if(2!==x.length)return null;if(r=parseInt(x[0],10),-12>r||r>13)return null;var w=parseInt(x[1],10);if(0>w||w>59)return null;v=60*r+(k.startsWith("-")?-w:w);break;case"z":case"zz":if(r=parseInt(k,10),-12>r||r>13)return null;v=60*r;break;case"g":case"gg":var K=k;if(!K||!a.eras)return null;K=K.toLowerCase().trim();for(var S=0,I=a.eras.length;I>S;S+=4)if(K===a.eras[S+1].toLowerCase()){l=S;break}if(null===l)return null}}var P,F=new Date,T=a.Calendar.convert;if(T&&(P=T.fromGregorian(F)),T||(P=[F.getFullYear(),F.getMonth(),F.getDate()]),null===d?d=P[0]:a.eras&&(d+=a.eras[(l||0)+3]),null===c&&(c=P[1]),null===h&&(h=P[2]),T){if(F=T.toGregorian(d,c,h),null===F)return null}else{if(F.setFullYear(d,c,h),F.getDate()!==h)return null;if(null!==u&&F.getDay()!==u)return null}if(y&&12>p&&(p+=12),F.setHours(p,g,f,m),null!==v){var _=F.getMinutes()-(v+F.getTimezoneOffset());F.setHours(F.getHours()+parseInt(_/60,10),_%60)}return F},Date.prototype.format=function(e){return this._toFormattedString(e,Sys.CultureInfo.InvariantCulture)},Date.prototype.localeFormat=function(e){return this._toFormattedString(e,Sys.CultureInfo.CurrentCulture)},Date.prototype._toFormattedString=function(e,t){function i(e){return 10>e?"0"+e:e.toString()}function a(e){return 10>e?"00"+e:100>e?"0"+e:e.toString()}function n(e){return 10>e?"000"+e:100>e?"00"+e:1e3>e?"0"+e:e.toString()}function o(){return g||f?g:(g=y.test(e),f=!0,g)}function r(e,t){if(m)return m[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate()}}var s=t.dateTimeFormat,l=s.Calendar.convert;if(!e||!e.length||"i"===e){if(t&&t.name.length){if(l)return this._toFormattedString(s.FullDateTimePattern,t);var d=new Date(this.getTime()),c=Date._getEra(this,s.eras);return d.setFullYear(Date._getEraYear(this,s,c)),d.toLocaleString()}return this.toString()}var h=s.eras,u="s"===e;e=Date._expandFormat(s,e);var p,g,f,m,v=new Sys.StringBuilder,y=/([^d]|^)(d|dd)([^d]|$)/g,b=0,D=Date._getTokenRegExp();for(!u&&l&&(m=l.fromGregorian(this));!0;){var k=D.lastIndex,C=D.exec(e),x=e.slice(k,C?C.index:e.length);if(b+=Date._appendPreOrPostMatch(x,v),!C)break;if(b%2!==1)switch(C[0]){case"dddd":v.append(s.DayNames[this.getDay()]);break;case"ddd":v.append(s.AbbreviatedDayNames[this.getDay()]);break;case"dd":g=!0,v.append(i(r(this,2)));break;case"d":g=!0,v.append(r(this,2));break;case"MMMM":v.append(s.MonthGenitiveNames&&o()?s.MonthGenitiveNames[r(this,1)]:s.MonthNames[r(this,1)]);break;case"MMM":v.append(s.AbbreviatedMonthGenitiveNames&&o()?s.AbbreviatedMonthGenitiveNames[r(this,1)]:s.AbbreviatedMonthNames[r(this,1)]);break;case"MM":v.append(i(r(this,1)+1));break;case"M":v.append(r(this,1)+1);break;case"yyyy":v.append(n(m?m[0]:Date._getEraYear(this,s,Date._getEra(this,h),u)));break;case"yy":v.append(i((m?m[0]:Date._getEraYear(this,s,Date._getEra(this,h),u))%100));break;case"y":v.append((m?m[0]:Date._getEraYear(this,s,Date._getEra(this,h),u))%100);break;case"hh":p=this.getHours()%12,0===p&&(p=12),v.append(i(p));break;case"h":p=this.getHours()%12,0===p&&(p=12),v.append(p);break;case"HH":v.append(i(this.getHours()));break;case"H":v.append(this.getHours());break;case"mm":v.append(i(this.getMinutes()));break;case"m":v.append(this.getMinutes());break;case"ss":v.append(i(this.getSeconds()));break;case"s":v.append(this.getSeconds());break;case"tt":v.append(this.getHours()<12?s.AMDesignator:s.PMDesignator);break;case"t":v.append((this.getHours()<12?s.AMDesignator:s.PMDesignator).charAt(0));break;case"f":v.append(a(this.getMilliseconds()).charAt(0));break;case"ff":v.append(a(this.getMilliseconds()).substr(0,2));break;case"fff":v.append(a(this.getMilliseconds()));break;case"z":p=this.getTimezoneOffset()/60,v.append((0>=p?"+":"-")+Math.floor(Math.abs(p)));break;case"zz":p=this.getTimezoneOffset()/60,v.append((0>=p?"+":"-")+i(Math.floor(Math.abs(p))));break;case"zzz":p=this.getTimezoneOffset()/60,v.append((0>=p?"+":"-")+i(Math.floor(Math.abs(p)))+":"+i(Math.abs(this.getTimezoneOffset()%60)));break;case"g":case"gg":s.eras&&v.append(s.eras[Date._getEra(this,h)+1]);break;case"/":v.append(s.DateSeparator)}else v.append(C[0])}return v.toString()},String.localeFormat=function(){return String._toFormattedString(!0,arguments)},Number.parseLocale=function(e){return Number._parse(e,Sys.CultureInfo.CurrentCulture)},Number.parseInvariant=function(e){return Number._parse(e,Sys.CultureInfo.InvariantCulture)},Number._parse=function(e,t){if(e=e.trim(),e.match(/^[+-]?infinity$/i))return parseFloat(e);if(e.match(/^0x[a-f0-9]+$/i))return parseInt(e);var i=t.numberFormat,a=Number._parseNumberNegativePattern(e,i,i.NumberNegativePattern),n=a[0],o=a[1];""===n&&1!==i.NumberNegativePattern&&(a=Number._parseNumberNegativePattern(e,i,1),n=a[0],o=a[1]),""===n&&(n="+");var r,s,l=o.indexOf("e");0>l&&(l=o.indexOf("E")),0>l?(s=o,r=null):(s=o.substr(0,l),r=o.substr(l+1));var d,c,h=s.indexOf(i.NumberDecimalSeparator);0>h?(d=s,c=null):(d=s.substr(0,h),c=s.substr(h+i.NumberDecimalSeparator.length)),d=d.split(i.NumberGroupSeparator).join("");var u=i.NumberGroupSeparator.replace(/\u00A0/g," ");i.NumberGroupSeparator!==u&&(d=d.split(u).join(""));var p=n+d;if(null!==c&&(p+="."+c),null!==r){var g=Number._parseNumberNegativePattern(r,i,1);""===g[0]&&(g[0]="+"),p+="e"+g[0]+g[1]}return p.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?parseFloat(p):Number.NaN},Number._parseNumberNegativePattern=function(e,t,i){var a=t.NegativeSign,n=t.PositiveSign;switch(i){case 4:a=" "+a,n=" "+n;case 3:if(e.endsWith(a))return["-",e.substr(0,e.length-a.length)];if(e.endsWith(n))return["+",e.substr(0,e.length-n.length)];break;case 2:a+=" ",n+=" ";case 1:if(e.startsWith(a))return["-",e.substr(a.length)];if(e.startsWith(n))return["+",e.substr(n.length)];break;case 0:if(e.startsWith("(")&&e.endsWith(")"))return["-",e.substr(1,e.length-2)]}return["",e]},Number.prototype.format=function(e){return this._toFormattedString(e,Sys.CultureInfo.InvariantCulture)},Number.prototype.localeFormat=function(e){return this._toFormattedString(e,Sys.CultureInfo.CurrentCulture)},Number.prototype._toFormattedString=function(e,t){function i(e,t,i){for(var a=e.length;t>a;a++)e=i?"0"+e:e+"0";return e}function a(e,t,a,n,o){var r=a[0],s=1,l=Math.pow(10,t),d=Math.round(e*l)/l;isFinite(d)||(d=e),e=d;var c,h=e.toString(),u="",p=h.split(/e/i);h=p[0],c=p.length>1?parseInt(p[1]):0,p=h.split("."),h=p[0],u=p.length>1?p[1]:"";c>0?(u=i(u,c,!1),h+=u.slice(0,c),u=u.substr(c)):0>c&&(c=-c,h=i(h,c+1,!0),u=h.slice(-c,h.length)+u,h=h.slice(0,-c)),t>0?(u=u.length>t?u.slice(0,t):i(u,t,!1),u=o+u):u="";for(var g=h.length-1,f="";g>=0;){if(0===r||r>g)return f.length>0?h.slice(0,g+1)+n+f+u:h.slice(0,g+1)+u;f=f.length>0?h.slice(g-r+1,g+1)+n+f:h.slice(g-r+1,g+1),g-=r,s<a.length&&(r=a[s],s++)}return h.slice(0,g+1)+n+f+u}if(!e||0===e.length||"i"===e)return t&&t.name.length>0?this.toLocaleString():this.toString();var n=["n %","n%","%n"],o=["-n %","-n%","-%n"],r=["(n)","-n","- n","n-","n -"],s=["$n","n$","$ n","n $"],l=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],d=t.numberFormat,c=Math.abs(this);e||(e="D");var h=-1;e.length>1&&(h=parseInt(e.slice(1),10));var u;switch(e.charAt(0)){case"d":case"D":u="n",-1!==h&&(c=i(""+c,h,!0)),0>this&&(c=-c);break;case"c":case"C":u=0>this?l[d.CurrencyNegativePattern]:s[d.CurrencyPositivePattern],-1===h&&(h=d.CurrencyDecimalDigits),c=a(Math.abs(this),h,d.CurrencyGroupSizes,d.CurrencyGroupSeparator,d.CurrencyDecimalSeparator);break;case"n":case"N":u=0>this?r[d.NumberNegativePattern]:"n",-1===h&&(h=d.NumberDecimalDigits),c=a(Math.abs(this),h,d.NumberGroupSizes,d.NumberGroupSeparator,d.NumberDecimalSeparator);break;case"p":case"P":u=0>this?o[d.PercentNegativePattern]:n[d.PercentPositivePattern],-1===h&&(h=d.PercentDecimalDigits),c=a(100*Math.abs(this),h,d.PercentGroupSizes,d.PercentGroupSeparator,d.PercentDecimalSeparator);break;default:throw Error.format(Sys.Res.formatBadFormatSpecifier)}for(var p=/n|\$|-|%/g,g="";!0;){var f=p.lastIndex,m=p.exec(u);if(g+=u.slice(f,m?m.index:u.length),!m)break;switch(m[0]){case"n":g+=c;break;case"$":g+=d.CurrencySymbol;break;case"-":/[1-9]/.test(c)&&(g+=d.NegativeSign);break;case"%":g+=d.PercentSymbol}}return g},Sys.CultureInfo=function(e,t,i){this.name=e,this.numberFormat=t,this.dateTimeFormat=i},Sys.CultureInfo.prototype={_getDateTimeFormats:function(){if(!this._dateTimeFormats){var e=this.dateTimeFormat;this._dateTimeFormats=[e.MonthDayPattern,e.YearMonthPattern,e.ShortDatePattern,e.ShortTimePattern,e.LongDatePattern,e.LongTimePattern,e.FullDateTimePattern,e.RFC1123Pattern,e.SortableDateTimePattern,e.UniversalSortableDateTimePattern]}return this._dateTimeFormats},_getIndex:function(e,t,i){var a=this._toUpper(e),n=Array.indexOf(t,a);return-1===n&&(n=Array.indexOf(i,a)),n},_getMonthIndex:function(e){return this._upperMonths||(this._upperMonths=this._toUpperArray(this.dateTimeFormat.MonthNames),this._upperMonthsGenitive=this._toUpperArray(this.dateTimeFormat.MonthGenitiveNames)),this._getIndex(e,this._upperMonths,this._upperMonthsGenitive)},_getAbbrMonthIndex:function(e){return this._upperAbbrMonths||(this._upperAbbrMonths=this._toUpperArray(this.dateTimeFormat.AbbreviatedMonthNames),this._upperAbbrMonthsGenitive=this._toUpperArray(this.dateTimeFormat.AbbreviatedMonthGenitiveNames)),this._getIndex(e,this._upperAbbrMonths,this._upperAbbrMonthsGenitive)},_getDayIndex:function(e){return this._upperDays||(this._upperDays=this._toUpperArray(this.dateTimeFormat.DayNames)),Array.indexOf(this._upperDays,this._toUpper(e))},_getAbbrDayIndex:function(e){return this._upperAbbrDays||(this._upperAbbrDays=this._toUpperArray(this.dateTimeFormat.AbbreviatedDayNames)),Array.indexOf(this._upperAbbrDays,this._toUpper(e))},_toUpperArray:function(e){for(var t=[],i=0,a=e.length;a>i;i++)t[i]=this._toUpper(e[i]);return t},_toUpper:function(e){return e.split(" ").join(" ").toUpperCase()}},Sys.CultureInfo.registerClass("Sys.CultureInfo"),Sys.CultureInfo._parse=function(e){var t=e.dateTimeFormat;return t&&!t.eras&&(t.eras=e.eras),new Sys.CultureInfo(e.name,e.numberFormat,t)},Sys.CultureInfo.InvariantCulture=Sys.CultureInfo._parse({name:"",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!0,CurrencyGroupSizes:[3],NumberGroupSizes:[3],PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"¤",NaNSymbol:"NaN",CurrencyNegativePattern:0,NumberNegativePattern:1,PercentPositivePattern:0,PercentNegativePattern:0,NegativeInfinitySymbol:"-Infinity",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"Infinity",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"‰",NativeDigits:["0","1","2","3","4","5","6","7","8","9"],DigitSubstitution:1},dateTimeFormat:{AMDesignator:"AM",Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!0},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",LongDatePattern:"dddd, dd MMMM yyyy",LongTimePattern:"HH:mm:ss",MonthDayPattern:"MMMM dd",PMDesignator:"PM",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",ShortDatePattern:"MM/dd/yyyy",ShortTimePattern:"HH:mm",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"yyyy MMMM",AbbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ShortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],DayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],AbbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],IsReadOnly:!0,NativeCalendarName:"Gregorian Calendar",AbbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""]},eras:[1,"A.D.",null,0]}),"object"==typeof __cultureInfo?(Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse(__cultureInfo),delete __cultureInfo):Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse({name:"en-US",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!1,CurrencyGroupSizes:[3],NumberGroupSizes:[3],PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"$",NaNSymbol:"NaN",CurrencyNegativePattern:0,NumberNegativePattern:1,PercentPositivePattern:0,PercentNegativePattern:0,NegativeInfinitySymbol:"-Infinity",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"Infinity",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"‰",NativeDigits:["0","1","2","3","4","5","6","7","8","9"],DigitSubstitution:1},dateTimeFormat:{AMDesignator:"AM",Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!1},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"dddd, MMMM dd, yyyy h:mm:ss tt",LongDatePattern:"dddd, MMMM dd, yyyy",LongTimePattern:"h:mm:ss tt",MonthDayPattern:"MMMM dd",PMDesignator:"PM",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",ShortDatePattern:"M/d/yyyy",ShortTimePattern:"h:mm tt",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"MMMM, yyyy",AbbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ShortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],
DayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],AbbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],IsReadOnly:!1,NativeCalendarName:"Gregorian Calendar",AbbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""]},eras:[1,"A.D.",null,0]}),Type.registerNamespace("Sys.Serialization"),Sys.Serialization.JavaScriptSerializer=function(){},Sys.Serialization.JavaScriptSerializer.registerClass("Sys.Serialization.JavaScriptSerializer"),Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs=[],Sys.Serialization.JavaScriptSerializer._charsToEscape=[],Sys.Serialization.JavaScriptSerializer._dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g"),Sys.Serialization.JavaScriptSerializer._escapeChars={},Sys.Serialization.JavaScriptSerializer._escapeRegEx=new RegExp('["\\\\\\x00-\\x1F]',"i"),Sys.Serialization.JavaScriptSerializer._escapeRegExGlobal=new RegExp('["\\\\\\x00-\\x1F]',"g"),Sys.Serialization.JavaScriptSerializer._jsonRegEx=new RegExp("[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]","g"),Sys.Serialization.JavaScriptSerializer._jsonStringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',"g"),Sys.Serialization.JavaScriptSerializer._serverTypeFieldName="__type",Sys.Serialization.JavaScriptSerializer._init=function(){var e=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f"];Sys.Serialization.JavaScriptSerializer._charsToEscape[0]="\\",Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs["\\"]=new RegExp("\\\\","g"),Sys.Serialization.JavaScriptSerializer._escapeChars["\\"]="\\\\",Sys.Serialization.JavaScriptSerializer._charsToEscape[1]='"',Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs['"']=new RegExp('"',"g"),Sys.Serialization.JavaScriptSerializer._escapeChars['"']='\\"';for(var t=0;32>t;t++){var i=String.fromCharCode(t);Sys.Serialization.JavaScriptSerializer._charsToEscape[t+2]=i,Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs[i]=new RegExp(i,"g"),Sys.Serialization.JavaScriptSerializer._escapeChars[i]=e[t]}},Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder=function(e,t){t.append(e.toString())},Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder=function(e,t){if(!isFinite(e))throw Error.invalidOperation(Sys.Res.cannotSerializeNonFiniteNumbers);t.append(String(e))},Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder=function(e,t){if(t.append('"'),Sys.Serialization.JavaScriptSerializer._escapeRegEx.test(e))if(0===Sys.Serialization.JavaScriptSerializer._charsToEscape.length&&Sys.Serialization.JavaScriptSerializer._init(),e.length<128)e=e.replace(Sys.Serialization.JavaScriptSerializer._escapeRegExGlobal,function(e){return Sys.Serialization.JavaScriptSerializer._escapeChars[e]});else for(var i=0;34>i;i++){var a=Sys.Serialization.JavaScriptSerializer._charsToEscape[i];-1!==e.indexOf(a)&&(e=Sys.Browser.agent===Sys.Browser.Opera||Sys.Browser.agent===Sys.Browser.FireFox?e.split(a).join(Sys.Serialization.JavaScriptSerializer._escapeChars[a]):e.replace(Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs[a],Sys.Serialization.JavaScriptSerializer._escapeChars[a]))}t.append(e),t.append('"')},Sys.Serialization.JavaScriptSerializer._serializeWithBuilder=function(e,t,i,a){var n;switch(typeof e){case"object":if(e)if(Number.isInstanceOfType(e))Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder(e,t);else if(Boolean.isInstanceOfType(e))Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder(e,t);else if(String.isInstanceOfType(e))Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder(e,t);else if(Array.isInstanceOfType(e)){for(t.append("["),n=0;n<e.length;++n)n>0&&t.append(","),Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(e[n],t,!1,a);t.append("]")}else{if(Date.isInstanceOfType(e)){t.append('"\\/Date('),t.append(e.getTime()),t.append(')\\/"');break}var o=[],r=0;for(var s in e)s.startsWith("$")||(s===Sys.Serialization.JavaScriptSerializer._serverTypeFieldName&&0!==r?(o[r++]=o[0],o[0]=s):o[r++]=s);i&&o.sort(),t.append("{");var l=!1;for(n=0;r>n;n++){var d=e[o[n]];"undefined"!=typeof d&&"function"!=typeof d&&(l?t.append(","):l=!0,Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(o[n],t,i,a),t.append(":"),Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(d,t,i,a))}t.append("}")}else t.append("null");break;case"number":Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder(e,t);break;case"string":Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder(e,t);break;case"boolean":Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder(e,t);break;default:t.append("null")}},Sys.Serialization.JavaScriptSerializer.serialize=function(e){var t=new Sys.StringBuilder;return Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(e,t,!1),t.toString()},Sys.Serialization.JavaScriptSerializer.deserialize=function(data,secure){if(0===data.length)throw Error.argument("data",Sys.Res.cannotDeserializeEmptyString);try{var exp=data.replace(Sys.Serialization.JavaScriptSerializer._dateRegEx,"$1new Date($2)");if(secure&&Sys.Serialization.JavaScriptSerializer._jsonRegEx.test(exp.replace(Sys.Serialization.JavaScriptSerializer._jsonStringRegEx,"")))throw null;return eval("("+exp+")")}catch(a){throw Error.argument("data",Sys.Res.cannotDeserializeInvalidJson)}},Type.registerNamespace("Sys.UI"),Sys.EventHandlerList=function(){this._list={}},Sys.EventHandlerList.prototype={_addHandler:function(e,t){Array.add(this._getEvent(e,!0),t)},addHandler:function(e,t){this._addHandler(e,t)},_removeHandler:function(e,t){var i=this._getEvent(e);i&&Array.remove(i,t)},removeHandler:function(e,t){this._removeHandler(e,t)},getHandler:function(e){var t=this._getEvent(e);return t&&0!==t.length?(t=Array.clone(t),function(e,i){for(var a=0,n=t.length;n>a;a++)t[a](e,i)}):null},_getEvent:function(e,t){if(!this._list[e]){if(!t)return null;this._list[e]=[]}return this._list[e]}},Sys.EventHandlerList.registerClass("Sys.EventHandlerList"),Sys.CommandEventArgs=function(e,t,i){Sys.CommandEventArgs.initializeBase(this),this._commandName=e,this._commandArgument=t,this._commandSource=i},Sys.CommandEventArgs.prototype={_commandName:null,_commandArgument:null,_commandSource:null,get_commandName:function(){return this._commandName},get_commandArgument:function(){return this._commandArgument},get_commandSource:function(){return this._commandSource}},Sys.CommandEventArgs.registerClass("Sys.CommandEventArgs",Sys.CancelEventArgs),Sys.INotifyPropertyChange=function(){},Sys.INotifyPropertyChange.prototype={},Sys.INotifyPropertyChange.registerInterface("Sys.INotifyPropertyChange"),Sys.PropertyChangedEventArgs=function(e){Sys.PropertyChangedEventArgs.initializeBase(this),this._propertyName=e},Sys.PropertyChangedEventArgs.prototype={get_propertyName:function(){return this._propertyName}},Sys.PropertyChangedEventArgs.registerClass("Sys.PropertyChangedEventArgs",Sys.EventArgs),Sys.INotifyDisposing=function(){},Sys.INotifyDisposing.prototype={},Sys.INotifyDisposing.registerInterface("Sys.INotifyDisposing"),Sys.Component=function(){Sys.Application&&Sys.Application.registerDisposableObject(this)},Sys.Component.prototype={_id:null,_initialized:!1,_updating:!1,get_events:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},get_id:function(){return this._id},set_id:function(e){this._id=e},get_isInitialized:function(){return this._initialized},get_isUpdating:function(){return this._updating},add_disposing:function(e){this.get_events().addHandler("disposing",e)},remove_disposing:function(e){this.get_events().removeHandler("disposing",e)},add_propertyChanged:function(e){this.get_events().addHandler("propertyChanged",e)},remove_propertyChanged:function(e){this.get_events().removeHandler("propertyChanged",e)},beginUpdate:function(){this._updating=!0},dispose:function(){if(this._events){var e=this._events.getHandler("disposing");e&&e(this,Sys.EventArgs.Empty)}delete this._events,Sys.Application.unregisterDisposableObject(this),Sys.Application.removeComponent(this)},endUpdate:function(){this._updating=!1,this._initialized||this.initialize(),this.updated()},initialize:function(){this._initialized=!0},raisePropertyChanged:function(e){if(this._events){var t=this._events.getHandler("propertyChanged");t&&t(this,new Sys.PropertyChangedEventArgs(e))}},updated:function(){}},Sys.Component.registerClass("Sys.Component",null,Sys.IDisposable,Sys.INotifyPropertyChange,Sys.INotifyDisposing);var $create=Sys.Component.create=function(e,t,i,a,n){var o=n?new e(n):new e,r=Sys.Application,s=r.get_isCreatingComponents();if(o.beginUpdate(),t&&Sys$Component$_setProperties(o,t),i)for(var l in i)o["add_"+l](i[l]);return o.get_id()&&r.addComponent(o),s?(r._createdComponents[r._createdComponents.length]=o,a?r._addComponentToSecondPass(o,a):o.endUpdate()):(a&&Sys$Component$_setReferences(o,a),o.endUpdate()),o};Sys.UI.MouseButton=function(){throw Error.notImplemented()},Sys.UI.MouseButton.prototype={leftButton:0,middleButton:1,rightButton:2},Sys.UI.MouseButton.registerEnum("Sys.UI.MouseButton"),Sys.UI.Key=function(){throw Error.notImplemented()},Sys.UI.Key.prototype={backspace:8,tab:9,enter:13,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:127},Sys.UI.Key.registerEnum("Sys.UI.Key"),Sys.UI.Point=function(e,t){this.x=e,this.y=t},Sys.UI.Point.registerClass("Sys.UI.Point"),Sys.UI.Bounds=function(e,t,i,a){this.x=e,this.y=t,this.height=a,this.width=i},Sys.UI.Bounds.registerClass("Sys.UI.Bounds"),Sys.UI.DomEvent=function(e){var t=e,i=this.type=t.type.toLowerCase();if(this.rawEvent=t,this.altKey=t.altKey,"undefined"!=typeof t.button&&(this.button="undefined"!=typeof t.which?t.button:4===t.button?Sys.UI.MouseButton.middleButton:2===t.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton),"keypress"===i?this.charCode=t.charCode||t.keyCode:t.keyCode&&46===t.keyCode?this.keyCode=127:this.keyCode=t.keyCode,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.target=t.target?t.target:t.srcElement,!i.startsWith("key"))if("undefined"!=typeof t.offsetX&&"undefined"!=typeof t.offsetY)this.offsetX=t.offsetX,this.offsetY=t.offsetY;else if(this.target&&3!==this.target.nodeType&&"number"==typeof t.clientX){var a=Sys.UI.DomElement.getLocation(this.target),n=Sys.UI.DomElement._getWindow(this.target);this.offsetX=(n.pageXOffset||0)+t.clientX-a.x,this.offsetY=(n.pageYOffset||0)+t.clientY-a.y}this.screenX=t.screenX,this.screenY=t.screenY,this.shiftKey=t.shiftKey},Sys.UI.DomEvent.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1)},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0)}},Sys.UI.DomEvent.registerClass("Sys.UI.DomEvent");var $addHandler=Sys.UI.DomEvent.addHandler=function(e,t,i,a){e._events||(e._events={});var n=e._events[t];n||(e._events[t]=n=[]);var o;if(e.addEventListener?(o=function(t){return i.call(e,new Sys.UI.DomEvent(t))},e.addEventListener(t,o,!1)):e.attachEvent&&(o=function(){var t={};try{t=Sys.UI.DomElement._getWindow(e).event}catch(a){}return i.call(e,new Sys.UI.DomEvent(t))},e.attachEvent("on"+t,o)),n[n.length]={handler:i,browserHandler:o,autoRemove:a},a){var r=e.dispose;r!==Sys.UI.DomEvent._disposeHandlers&&(e.dispose=Sys.UI.DomEvent._disposeHandlers,"undefined"!=typeof r&&(e._chainDispose=r))}},$addHandlers=Sys.UI.DomEvent.addHandlers=function(e,t,i,a){for(var n in t){var o=t[n];i&&(o=Function.createDelegate(i,o)),$addHandler(e,n,o,a||!1)}},$clearHandlers=Sys.UI.DomEvent.clearHandlers=function(e){Sys.UI.DomEvent._clearHandlers(e,!1)};Sys.UI.DomEvent._clearHandlers=function(e,t){if(e._events){var i=e._events;for(var a in i)for(var n=i[a],o=n.length-1;o>=0;o--){var r=n[o];(!t||r.autoRemove)&&$removeHandler(e,a,r.handler)}e._events=null}},Sys.UI.DomEvent._disposeHandlers=function(){Sys.UI.DomEvent._clearHandlers(this,!0);var e=this._chainDispose,t=typeof e;"undefined"!==t&&(this.dispose=e,this._chainDispose=null,"function"===t&&this.dispose())};var $removeHandler=Sys.UI.DomEvent.removeHandler=function(e,t,i){Sys.UI.DomEvent._removeHandler(e,t,i)};Sys.UI.DomEvent._removeHandler=function(e,t,i){for(var a=null,n=e._events[t],o=0,r=n.length;r>o;o++)if(n[o].handler===i){a=n[o].browserHandler;break}e.removeEventListener?e.removeEventListener(t,a,!1):e.detachEvent&&e.detachEvent("on"+t,a),n.splice(o,1)},Sys.UI.DomElement=function(){},Sys.UI.DomElement.registerClass("Sys.UI.DomElement"),Sys.UI.DomElement.addCssClass=function(e,t){Sys.UI.DomElement.containsCssClass(e,t)||(""===e.className?e.className=t:e.className+=" "+t)},Sys.UI.DomElement.containsCssClass=function(e,t){return Array.contains(e.className.split(" "),t)},Sys.UI.DomElement.getBounds=function(e){var t=Sys.UI.DomElement.getLocation(e);return new Sys.UI.Bounds(t.x,t.y,e.offsetWidth||0,e.offsetHeight||0)};var $get=Sys.UI.DomElement.getElementById=function(e,t){if(!t)return document.getElementById(e);if(t.getElementById)return t.getElementById(e);for(var i=[],a=t.childNodes,n=0;n<a.length;n++){var o=a[n];1==o.nodeType&&(i[i.length]=o)}for(;i.length;){if(o=i.shift(),o.id==e)return o;for(a=o.childNodes,n=0;n<a.length;n++)o=a[n],1==o.nodeType&&(i[i.length]=o)}return null};document.documentElement.getBoundingClientRect?Sys.UI.DomElement.getLocation=function(e){if(e.self||9===e.nodeType)return new Sys.UI.Point(0,0);var t=e.getBoundingClientRect();if(!t)return new Sys.UI.Point(0,0);var i=e.ownerDocument.documentElement,a=Math.floor(t.left+.5)+i.scrollLeft,n=Math.floor(t.top+.5)+i.scrollTop;if(Sys.Browser.agent===Sys.Browser.InternetExplorer){try{var o=e.ownerDocument.parentWindow.frameElement||null;if(o){var r="0"===o.frameBorder||"no"===o.frameBorder?2:0;a+=r,n+=r}}catch(s){}if(Sys.Browser.version<=7){var l,d,c,h=document.createElement("div");h.style.cssText="position:absolute !important;left:0px !important;right:0px !important;height:0px !important;width:1px !important;display:hidden !important";try{d=document.body.childNodes[0],document.body.insertBefore(h,d),c=h.getBoundingClientRect(),document.body.removeChild(h),l=c.right-c.left}catch(s){}l&&1!==l&&(a=Math.floor(a/l),n=Math.floor(n/l))}(document.documentMode||0)<8&&(a-=2,n-=2)}return new Sys.UI.Point(a,n)}:Sys.Browser.agent===Sys.Browser.Safari?Sys.UI.DomElement.getLocation=function(e){if(e.window&&e.window===e||9===e.nodeType)return new Sys.UI.Point(0,0);var t,i,a=0,n=0,o=null,r=null;for(t=e;t;o=t,r=i,t=t.offsetParent){i=Sys.UI.DomElement._getCurrentStyle(t);var s=t.tagName?t.tagName.toUpperCase():null;!t.offsetLeft&&!t.offsetTop||"BODY"===s&&r&&"absolute"===r.position||(a+=t.offsetLeft,n+=t.offsetTop),o&&Sys.Browser.version>=3&&(a+=parseInt(i.borderLeftWidth),n+=parseInt(i.borderTopWidth))}i=Sys.UI.DomElement._getCurrentStyle(e);var l=i?i.position:null;if(!l||"absolute"!==l)for(t=e.parentNode;t;t=t.parentNode){s=t.tagName?t.tagName.toUpperCase():null,"BODY"!==s&&"HTML"!==s&&(t.scrollLeft||t.scrollTop)&&(a-=t.scrollLeft||0,n-=t.scrollTop||0),i=Sys.UI.DomElement._getCurrentStyle(t);var d=i?i.position:null;if(d&&"absolute"===d)break}return new Sys.UI.Point(a,n)}:Sys.UI.DomElement.getLocation=function(e){if(e.window&&e.window===e||9===e.nodeType)return new Sys.UI.Point(0,0);var t,i=0,a=0,n=null,o=null,r=null;for(t=e;t;n=t,o=r,t=t.offsetParent){var s=t.tagName?t.tagName.toUpperCase():null;r=Sys.UI.DomElement._getCurrentStyle(t),(t.offsetLeft||t.offsetTop)&&("BODY"!==s||o&&"absolute"===o.position)&&(i+=t.offsetLeft,a+=t.offsetTop),null!==n&&r&&("TABLE"!==s&&"TD"!==s&&"HTML"!==s&&(i+=parseInt(r.borderLeftWidth)||0,a+=parseInt(r.borderTopWidth)||0),"TABLE"!==s||"relative"!==r.position&&"absolute"!==r.position||(i+=parseInt(r.marginLeft)||0,a+=parseInt(r.marginTop)||0))}r=Sys.UI.DomElement._getCurrentStyle(e);var l=r?r.position:null;if(!l||"absolute"!==l)for(t=e.parentNode;t;t=t.parentNode)s=t.tagName?t.tagName.toUpperCase():null,"BODY"!==s&&"HTML"!==s&&(t.scrollLeft||t.scrollTop)&&(i-=t.scrollLeft||0,a-=t.scrollTop||0,r=Sys.UI.DomElement._getCurrentStyle(t),r&&(i+=parseInt(r.borderLeftWidth)||0,a+=parseInt(r.borderTopWidth)||0));return new Sys.UI.Point(i,a)},Sys.UI.DomElement.isDomElement=function(e){return Sys._isDomElement(e)},Sys.UI.DomElement.removeCssClass=function(e,t){var i=" "+e.className+" ",a=i.indexOf(" "+t+" ");a>=0&&(e.className=(i.substr(0,a)+" "+i.substring(a+t.length+1,i.length)).trim())},Sys.UI.DomElement.resolveElement=function(e,t){var i=e;return i?("string"==typeof i&&(i=Sys.UI.DomElement.getElementById(i,t)),i):null},Sys.UI.DomElement.raiseBubbleEvent=function(e,t){for(var i=e;i;){var a=i.control;if(a&&a.onBubbleEvent&&a.raiseBubbleEvent)return void Sys.UI.DomElement._raiseBubbleEventFromControl(a,e,t);i=i.parentNode}},Sys.UI.DomElement._raiseBubbleEventFromControl=function(e,t,i){e.onBubbleEvent(t,i)||e._raiseBubbleEvent(t,i)},Sys.UI.DomElement.setLocation=function(e,t,i){var a=e.style;a.position="absolute",a.left=t+"px",a.top=i+"px"},Sys.UI.DomElement.toggleCssClass=function(e,t){Sys.UI.DomElement.containsCssClass(e,t)?Sys.UI.DomElement.removeCssClass(e,t):Sys.UI.DomElement.addCssClass(e,t)},Sys.UI.DomElement.getVisibilityMode=function(e){return e._visibilityMode===Sys.UI.VisibilityMode.hide?Sys.UI.VisibilityMode.hide:Sys.UI.VisibilityMode.collapse},Sys.UI.DomElement.setVisibilityMode=function(e,t){Sys.UI.DomElement._ensureOldDisplayMode(e),e._visibilityMode!==t&&(e._visibilityMode=t,Sys.UI.DomElement.getVisible(e)===!1&&(e._visibilityMode===Sys.UI.VisibilityMode.hide?e.style.display=e._oldDisplayMode:e.style.display="none"),e._visibilityMode=t)},Sys.UI.DomElement.getVisible=function(e){var t=e.currentStyle||Sys.UI.DomElement._getCurrentStyle(e);return t?"hidden"!==t.visibility&&"none"!==t.display:!0},Sys.UI.DomElement.setVisible=function(e,t){t!==Sys.UI.DomElement.getVisible(e)&&(Sys.UI.DomElement._ensureOldDisplayMode(e),e.style.visibility=t?"visible":"hidden",t||e._visibilityMode===Sys.UI.VisibilityMode.hide?e.style.display=e._oldDisplayMode:e.style.display="none")},Sys.UI.DomElement._ensureOldDisplayMode=function(e){if(!e._oldDisplayMode){var t=e.currentStyle||Sys.UI.DomElement._getCurrentStyle(e);if(e._oldDisplayMode=t?t.display:null,!e._oldDisplayMode||"none"===e._oldDisplayMode)switch(e.tagName.toUpperCase()){case"DIV":case"P":case"ADDRESS":case"BLOCKQUOTE":case"BODY":case"COL":case"COLGROUP":case"DD":case"DL":case"DT":case"FIELDSET":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HR":case"IFRAME":case"LEGEND":case"OL":case"PRE":case"TABLE":case"TD":case"TH":case"TR":case"UL":e._oldDisplayMode="block";break;case"LI":e._oldDisplayMode="list-item";break;default:e._oldDisplayMode="inline"}}},Sys.UI.DomElement._getWindow=function(e){var t=e.ownerDocument||e.document||e;return t.defaultView||t.parentWindow},Sys.UI.DomElement._getCurrentStyle=function(e){if(3===e.nodeType)return null;var t=Sys.UI.DomElement._getWindow(e);e.documentElement&&(e=e.documentElement);var i=t&&e!==t&&t.getComputedStyle?t.getComputedStyle(e,null):e.currentStyle||e.style;if(!i&&Sys.Browser.agent===Sys.Browser.Safari&&e.style){var a=e.style.display,n=e.style.position;e.style.position="absolute",e.style.display="block";var o=t.getComputedStyle(e,null);e.style.display=a,e.style.position=n,i={};for(var r in o)i[r]=o[r];i.display="none"}return i},Sys.IContainer=function(){},Sys.IContainer.prototype={},Sys.IContainer.registerInterface("Sys.IContainer"),Sys.ApplicationLoadEventArgs=function(e,t){Sys.ApplicationLoadEventArgs.initializeBase(this),this._components=e,this._isPartialLoad=t},Sys.ApplicationLoadEventArgs.prototype={get_components:function(){return this._components},get_isPartialLoad:function(){return this._isPartialLoad}},Sys.ApplicationLoadEventArgs.registerClass("Sys.ApplicationLoadEventArgs",Sys.EventArgs),Sys._Application=function(){Sys._Application.initializeBase(this),this._disposableObjects=[],this._components={},this._createdComponents=[],this._secondPassComponents=[],this._unloadHandlerDelegate=Function.createDelegate(this,this._unloadHandler),Sys.UI.DomEvent.addHandler(window,"unload",this._unloadHandlerDelegate),this._domReady()},Sys._Application.prototype={_creatingComponents:!1,_disposing:!1,_deleteCount:0,get_isCreatingComponents:function(){return this._creatingComponents},get_isDisposing:function(){return this._disposing},add_init:function(e){this._initialized?e(this,Sys.EventArgs.Empty):this.get_events().addHandler("init",e)},remove_init:function(e){this.get_events().removeHandler("init",e)},add_load:function(e){this.get_events().addHandler("load",e)},remove_load:function(e){this.get_events().removeHandler("load",e)},add_unload:function(e){this.get_events().addHandler("unload",e)},remove_unload:function(e){this.get_events().removeHandler("unload",e)},addComponent:function(e){this._components[e.get_id()]=e},beginCreateComponents:function(){this._creatingComponents=!0},dispose:function(){if(!this._disposing){this._disposing=!0,this._timerCookie&&(window.clearTimeout(this._timerCookie),delete this._timerCookie),this._endRequestHandler&&(Sys.WebForms.PageRequestManager.getInstance().remove_endRequest(this._endRequestHandler),delete this._endRequestHandler),this._beginRequestHandler&&(Sys.WebForms.PageRequestManager.getInstance().remove_beginRequest(this._beginRequestHandler),delete this._beginRequestHandler),window.pageUnload&&window.pageUnload(this,Sys.EventArgs.Empty);var e=this.get_events().getHandler("unload");e&&e(this,Sys.EventArgs.Empty);for(var t=Array.clone(this._disposableObjects),i=0,a=t.length;a>i;i++){var n=t[i];"undefined"!=typeof n&&n.dispose()}if(Array.clear(this._disposableObjects),Sys.UI.DomEvent.removeHandler(window,"unload",this._unloadHandlerDelegate),Sys._ScriptLoader){var o=Sys._ScriptLoader.getInstance();o&&o.dispose()}Sys._Application.callBaseMethod(this,"dispose")}},disposeElement:function(e,t){if(1===e.nodeType){for(var i=e.getElementsByTagName("*"),a=i.length-1;a>=0;a--)this._disposeElementInternal(i[a]);t||this._disposeElementInternal(e)}},endCreateComponents:function(){for(var e=this._secondPassComponents,t=0,i=e.length;i>t;t++){var a=e[t].component;Sys$Component$_setReferences(a,e[t].references),a.endUpdate()}this._secondPassComponents=[],this._creatingComponents=!1},findComponent:function(e,t){return t?Sys.IContainer.isInstanceOfType(t)?t.findComponent(e):t[e]||null:Sys.Application._components[e]||null},getComponents:function(){var e=[],t=this._components;for(var i in t)e[e.length]=t[i];return e},initialize:function(){if(!this.get_isInitialized()&&!this._disposing){if(Sys._Application.callBaseMethod(this,"initialize"),this._raiseInit(),this.get_stateString){Sys.WebForms&&Sys.WebForms.PageRequestManager&&(this._beginRequestHandler=Function.createDelegate(this,this._onPageRequestManagerBeginRequest),Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(this._beginRequestHandler),this._endRequestHandler=Function.createDelegate(this,this._onPageRequestManagerEndRequest),Sys.WebForms.PageRequestManager.getInstance().add_endRequest(this._endRequestHandler));var e=this.get_stateString();e!==this._currentEntry?this._navigate(e):this._ensureHistory()}this.raiseLoad()}},notifyScriptLoaded:function(){},registerDisposableObject:function(e){if(!this._disposing){var t=this._disposableObjects,i=t.length;t[i]=e,e.__msdisposeindex=i}},raiseLoad:function(){var e=this.get_events().getHandler("load"),t=new Sys.ApplicationLoadEventArgs(Array.clone(this._createdComponents),!!this._loaded);this._loaded=!0,e&&e(this,t),window.pageLoad&&window.pageLoad(this,t),this._createdComponents=[]},removeComponent:function(e){var t=e.get_id();t&&delete this._components[t]},unregisterDisposableObject:function(e){if(!this._disposing){var t=e.__msdisposeindex;if("number"==typeof t){var i=this._disposableObjects;if(delete i[t],delete e.__msdisposeindex,++this._deleteCount>1e3){for(var a=[],n=0,o=i.length;o>n;n++)e=i[n],"undefined"!=typeof e&&(e.__msdisposeindex=a.length,a.push(e));this._disposableObjects=a,this._deleteCount=0}}}},_addComponentToSecondPass:function(e,t){this._secondPassComponents[this._secondPassComponents.length]={component:e,references:t}},_disposeComponents:function(e){if(e)for(var t=e.length-1;t>=0;t--){var i=e[t];"function"==typeof i.dispose&&i.dispose()}},_disposeElementInternal:function(e){var t=e.dispose;if(t&&"function"==typeof t)e.dispose();else{var i=e.control;i&&"function"==typeof i.dispose&&i.dispose()}var a=e._behaviors;a&&this._disposeComponents(a),a=e._components,a&&(this._disposeComponents(a),e._components=null)},_domReady:function(){function e(){i.initialize()}var t,i=this,a=function(){Sys.UI.DomEvent.removeHandler(window,"load",a),e()};if(Sys.UI.DomEvent.addHandler(window,"load",a),document.addEventListener)try{document.addEventListener("DOMContentLoaded",t=function(){document.removeEventListener("DOMContentLoaded",t,!1),e()},!1)}catch(n){}else if(document.attachEvent)if(window==window.top&&document.documentElement.doScroll){var o,r=document.createElement("div");t=function(){try{r.doScroll("left")}catch(i){return void(o=window.setTimeout(t,0))}r=null,e()},t()}else document.attachEvent("onreadystatechange",t=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),e())})},_raiseInit:function(){var e=this.get_events().getHandler("init");e&&(this.beginCreateComponents(),e(this,Sys.EventArgs.Empty),this.endCreateComponents())},_unloadHandler:function(){this.dispose()}},Sys._Application.registerClass("Sys._Application",Sys.Component,Sys.IContainer),Sys.Application=new Sys._Application;var $find=Sys.Application.findComponent;Sys.UI.Behavior=function(e){Sys.UI.Behavior.initializeBase(this),this._element=e;var t=e._behaviors;t?t[t.length]=this:e._behaviors=[this]},Sys.UI.Behavior.prototype={_name:null,get_element:function(){return this._element},get_id:function(){var e=Sys.UI.Behavior.callBaseMethod(this,"get_id");return e?e:this._element&&this._element.id?this._element.id+"$"+this.get_name():""},get_name:function(){if(this._name)return this._name;var e=Object.getTypeName(this),t=e.lastIndexOf(".");return-1!==t&&(e=e.substr(t+1)),this.get_isInitialized()||(this._name=e),e},set_name:function(e){this._name=e},initialize:function(){Sys.UI.Behavior.callBaseMethod(this,"initialize");var e=this.get_name();e&&(this._element[e]=this)},dispose:function(){Sys.UI.Behavior.callBaseMethod(this,"dispose");var e=this._element;if(e){var t=this.get_name();t&&(e[t]=null);var i=e._behaviors;Array.remove(i,this),0===i.length&&(e._behaviors=null),delete this._element}}},Sys.UI.Behavior.registerClass("Sys.UI.Behavior",Sys.Component),Sys.UI.Behavior.getBehaviorByName=function(e,t){var i=e[t];return i&&Sys.UI.Behavior.isInstanceOfType(i)?i:null},Sys.UI.Behavior.getBehaviors=function(e){return e._behaviors?Array.clone(e._behaviors):[]},Sys.UI.Behavior.getBehaviorsByType=function(e,t){var i=e._behaviors,a=[];if(i)for(var n=0,o=i.length;o>n;n++)t.isInstanceOfType(i[n])&&(a[a.length]=i[n]);return a},Sys.UI.VisibilityMode=function(){throw Error.notImplemented()},Sys.UI.VisibilityMode.prototype={hide:0,collapse:1},Sys.UI.VisibilityMode.registerEnum("Sys.UI.VisibilityMode"),Sys.UI.Control=function(e){Sys.UI.Control.initializeBase(this),this._element=e,e.control=this;var t=this.get_role();t&&e.setAttribute("role",t)},Sys.UI.Control.prototype={_parent:null,_visibilityMode:Sys.UI.VisibilityMode.hide,get_element:function(){return this._element},get_id:function(){return this._element?this._element.id:""},set_id:function(){throw Error.invalidOperation(Sys.Res.cantSetId)},get_parent:function(){if(this._parent)return this._parent;if(!this._element)return null;for(var e=this._element.parentNode;e;){if(e.control)return e.control;e=e.parentNode}return null},set_parent:function(e){this._parent=e},get_role:function(){return null},get_visibilityMode:function(){return Sys.UI.DomElement.getVisibilityMode(this._element)},set_visibilityMode:function(e){Sys.UI.DomElement.setVisibilityMode(this._element,e)},get_visible:function(){return Sys.UI.DomElement.getVisible(this._element)},set_visible:function(e){Sys.UI.DomElement.setVisible(this._element,e)},addCssClass:function(e){Sys.UI.DomElement.addCssClass(this._element,e)},dispose:function(){Sys.UI.Control.callBaseMethod(this,"dispose"),this._element&&(this._element.control=null,delete this._element),this._parent&&delete this._parent},onBubbleEvent:function(){return!1},raiseBubbleEvent:function(e,t){this._raiseBubbleEvent(e,t)},_raiseBubbleEvent:function(e,t){for(var i=this.get_parent();i;){if(i.onBubbleEvent(e,t))return;i=i.get_parent()}},removeCssClass:function(e){Sys.UI.DomElement.removeCssClass(this._element,e)},toggleCssClass:function(e){Sys.UI.DomElement.toggleCssClass(this._element,e)}},Sys.UI.Control.registerClass("Sys.UI.Control",Sys.Component),Sys.HistoryEventArgs=function(e){Sys.HistoryEventArgs.initializeBase(this),this._state=e},Sys.HistoryEventArgs.prototype={get_state:function(){return this._state}},Sys.HistoryEventArgs.registerClass("Sys.HistoryEventArgs",Sys.EventArgs),Sys.Application._appLoadHandler=null,Sys.Application._beginRequestHandler=null,Sys.Application._clientId=null,Sys.Application._currentEntry="",Sys.Application._endRequestHandler=null,Sys.Application._history=null,Sys.Application._enableHistory=!1,Sys.Application._historyFrame=null,Sys.Application._historyInitialized=!1,Sys.Application._historyPointIsNew=!1,Sys.Application._ignoreTimer=!1,Sys.Application._initialState=null,Sys.Application._state={},Sys.Application._timerCookie=0,Sys.Application._timerHandler=null,Sys.Application._uniqueId=null,Sys._Application.prototype.get_stateString=function(){var e=null;if(Sys.Browser.agent===Sys.Browser.Firefox){var t=window.location.href,i=t.indexOf("#");return e=-1!==i?t.substring(i+1):""}return e=window.location.hash,e.length>0&&"#"===e.charAt(0)&&(e=e.substring(1)),e},Sys._Application.prototype.get_enableHistory=function(){return this._enableHistory},Sys._Application.prototype.set_enableHistory=function(e){this._enableHistory=e},Sys._Application.prototype.add_navigate=function(e){this.get_events().addHandler("navigate",e)},Sys._Application.prototype.remove_navigate=function(e){this.get_events().removeHandler("navigate",e)},Sys._Application.prototype.addHistoryPoint=function(e,t){this._ensureHistory();var i=this._state;for(var a in e){var n=e[a];null===n?"undefined"!=typeof i[a]&&delete i[a]:i[a]=n}var o=this._serializeState(i);this._historyPointIsNew=!0,this._setState(o,t),this._raiseNavigate()},Sys._Application.prototype.setServerId=function(e,t){this._clientId=e,this._uniqueId=t},Sys._Application.prototype.setServerState=function(e){this._ensureHistory(),this._state.__s=e,this._updateHiddenField(e)},Sys._Application.prototype._deserializeState=function(e){var t={};e=e||"";var i=e.indexOf("&&");-1!==i&&i+2<e.length&&(t.__s=e.substr(i+2),e=e.substr(0,i));for(var a=e.split("&"),n=0,o=a.length;o>n;n++){var r=a[n],s=r.indexOf("=");if(-1!==s&&s+1<r.length){var l=r.substr(0,s),d=r.substr(s+1);t[l]=decodeURIComponent(d)}}return t},Sys._Application.prototype._enableHistoryInScriptManager=function(){this._enableHistory=!0},Sys._Application.prototype._ensureHistory=function(){if(!this._historyInitialized&&this._enableHistory){Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.documentMode<8&&(this._historyFrame=document.getElementById("__historyFrame"),
this._ignoreIFrame=!0),this._timerHandler=Function.createDelegate(this,this._onIdle),this._timerCookie=window.setTimeout(this._timerHandler,100);try{this._initialState=this._deserializeState(this.get_stateString())}catch(e){}this._historyInitialized=!0}},Sys._Application.prototype._navigate=function(e){this._ensureHistory();var t=this._deserializeState(e);if(this._uniqueId){var i=this._state.__s||"",a=t.__s||"";if(a!==i)return this._updateHiddenField(a),__doPostBack(this._uniqueId,a),void(this._state=t)}this._setState(e),this._state=t,this._raiseNavigate()},Sys._Application.prototype._onIdle=function(){delete this._timerCookie;var e=this.get_stateString();e!==this._currentEntry?this._ignoreTimer||(this._historyPointIsNew=!1,this._navigate(e)):this._ignoreTimer=!1,this._timerCookie=window.setTimeout(this._timerHandler,100)},Sys._Application.prototype._onIFrameLoad=function(e){this._ensureHistory(),this._ignoreIFrame||(this._historyPointIsNew=!1,this._navigate(e)),this._ignoreIFrame=!1},Sys._Application.prototype._onPageRequestManagerBeginRequest=function(){this._ignoreTimer=!0},Sys._Application.prototype._onPageRequestManagerEndRequest=function(e,t){var i=t.get_dataItems()[this._clientId],a=document.getElementById("__EVENTTARGET");a&&a.value===this._uniqueId&&(a.value=""),"undefined"!=typeof i?(this.setServerState(i),this._historyPointIsNew=!0):this._ignoreTimer=!1;var n=this._serializeState(this._state);n!==this._currentEntry&&(this._ignoreTimer=!0,this._setState(n),this._raiseNavigate())},Sys._Application.prototype._raiseNavigate=function(){var e=this.get_events().getHandler("navigate"),t={};for(var i in this._state)"__s"!==i&&(t[i]=this._state[i]);var a=new Sys.HistoryEventArgs(t);e&&e(this,a);try{Sys.Browser.agent!==Sys.Browser.Firefox||!window.location.hash||window.frameElement&&!window.top.location.hash||window.history.go(0)}catch(n){}},Sys._Application.prototype._serializeState=function(e){var t=[];for(var i in e){var a=e[i];if("__s"===i)var n=a;else t[t.length]=i+"="+encodeURIComponent(a)}return t.join("&")+(n?"&&"+n:"")},Sys._Application.prototype._setState=function(e,t){if(this._enableHistory&&(e=e||"",e!==this._currentEntry)){if(window.theForm){var i=window.theForm.action,a=i.indexOf("#");window.theForm.action=(-1!==a?i.substring(0,a):i)+"#"+e}if(this._historyFrame&&this._historyPointIsNew){this._ignoreIFrame=!0;var n=this._historyFrame.contentWindow.document;n.open("javascript:'<html></html>'"),n.write("<html><head><title>"+(t||document.title)+'</title><script type="text/javascript">parent.Sys.Application._onIFrameLoad('+Sys.Serialization.JavaScriptSerializer.serialize(e)+");</script></head><body></body></html>"),n.close()}if(this._ignoreTimer=!1,this._currentEntry=e,this._historyFrame||this._historyPointIsNew){var o=this.get_stateString();e!==o&&(window.location.hash=e,this._currentEntry=this.get_stateString(),"undefined"!=typeof t&&null!==t&&(document.title=t))}this._historyPointIsNew=!1}},Sys._Application.prototype._updateHiddenField=function(e){if(this._clientId){var t=document.getElementById(this._clientId);t&&(t.value=e)}},window.XMLHttpRequest||(window.XMLHttpRequest=function(){for(var e=["Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],t=0,i=e.length;i>t;t++)try{return new ActiveXObject(e[t])}catch(a){}return null}),Type.registerNamespace("Sys.Net"),Sys.Net.WebRequestExecutor=function(){this._webRequest=null,this._resultObject=null},Sys.Net.WebRequestExecutor.prototype={get_webRequest:function(){return this._webRequest},_set_webRequest:function(e){this._webRequest=e},get_started:function(){throw Error.notImplemented()},get_responseAvailable:function(){throw Error.notImplemented()},get_timedOut:function(){throw Error.notImplemented()},get_aborted:function(){throw Error.notImplemented()},get_responseData:function(){throw Error.notImplemented()},get_statusCode:function(){throw Error.notImplemented()},get_statusText:function(){throw Error.notImplemented()},get_xml:function(){throw Error.notImplemented()},get_object:function(){return this._resultObject||(this._resultObject=Sys.Serialization.JavaScriptSerializer.deserialize(this.get_responseData())),this._resultObject},executeRequest:function(){throw Error.notImplemented()},abort:function(){throw Error.notImplemented()},getResponseHeader:function(){throw Error.notImplemented()},getAllResponseHeaders:function(){throw Error.notImplemented()}},Sys.Net.WebRequestExecutor.registerClass("Sys.Net.WebRequestExecutor"),Sys.Net.XMLDOM=function(e){if(window.DOMParser)try{var t=new window.DOMParser;return t.parseFromString(e,"text/xml")}catch(i){}else for(var a=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"],n=0,o=a.length;o>n;n++)try{var r=new ActiveXObject(a[n]);return r.async=!1,r.loadXML(e),r.setProperty("SelectionLanguage","XPath"),r}catch(i){}return null},Sys.Net.XMLHttpExecutor=function(){Sys.Net.XMLHttpExecutor.initializeBase(this);var e=this;this._xmlHttpRequest=null,this._webRequest=null,this._responseAvailable=!1,this._timedOut=!1,this._timer=null,this._aborted=!1,this._started=!1,this._onReadyStateChange=function(){if(4===e._xmlHttpRequest.readyState){try{if("undefined"==typeof e._xmlHttpRequest.status)return}catch(t){return}e._clearTimer(),e._responseAvailable=!0;try{e._webRequest.completed(Sys.EventArgs.Empty)}finally{null!=e._xmlHttpRequest&&(e._xmlHttpRequest.onreadystatechange=Function.emptyMethod,e._xmlHttpRequest=null)}}},this._clearTimer=function(){null!=e._timer&&(window.clearTimeout(e._timer),e._timer=null)},this._onTimeout=function(){e._responseAvailable||(e._clearTimer(),e._timedOut=!0,e._xmlHttpRequest.onreadystatechange=Function.emptyMethod,e._xmlHttpRequest.abort(),e._webRequest.completed(Sys.EventArgs.Empty),e._xmlHttpRequest=null)}},Sys.Net.XMLHttpExecutor.prototype={get_timedOut:function(){return this._timedOut},get_started:function(){return this._started},get_responseAvailable:function(){return this._responseAvailable},get_aborted:function(){return this._aborted},executeRequest:function(){this._webRequest=this.get_webRequest();var e=this._webRequest.get_body(),t=this._webRequest.get_headers();this._xmlHttpRequest=new XMLHttpRequest,this._xmlHttpRequest.onreadystatechange=this._onReadyStateChange;var i=this._webRequest.get_httpVerb();if(this._xmlHttpRequest.open(i,this._webRequest.getResolvedUrl(),!0),this._xmlHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),t)for(var a in t){var n=t[a];"function"!=typeof n&&this._xmlHttpRequest.setRequestHeader(a,n)}"post"===i.toLowerCase()&&(null!==t&&t["Content-Type"]||this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),e||(e=""));var o=this._webRequest.get_timeout();o>0&&(this._timer=window.setTimeout(Function.createDelegate(this,this._onTimeout),o)),this._xmlHttpRequest.send(e),this._started=!0},getResponseHeader:function(e){var t;try{t=this._xmlHttpRequest.getResponseHeader(e)}catch(i){}return t||(t=""),t},getAllResponseHeaders:function(){return this._xmlHttpRequest.getAllResponseHeaders()},get_responseData:function(){return this._xmlHttpRequest.responseText},get_statusCode:function(){var e=0;try{e=this._xmlHttpRequest.status}catch(t){}return e},get_statusText:function(){return this._xmlHttpRequest.statusText},get_xml:function(){var e=this._xmlHttpRequest.responseXML;if(e&&e.documentElement)-1!==navigator.userAgent.indexOf("MSIE")&&e.setProperty("SelectionLanguage","XPath");else if(e=Sys.Net.XMLDOM(this._xmlHttpRequest.responseText),!e||!e.documentElement)return null;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI&&"parsererror"===e.documentElement.tagName?null:e.documentElement.firstChild&&"parsererror"===e.documentElement.firstChild.tagName?null:e},abort:function(){this._aborted||this._responseAvailable||this._timedOut||(this._aborted=!0,this._clearTimer(),this._xmlHttpRequest&&!this._responseAvailable&&(this._xmlHttpRequest.onreadystatechange=Function.emptyMethod,this._xmlHttpRequest.abort(),this._xmlHttpRequest=null,this._webRequest.completed(Sys.EventArgs.Empty)))}},Sys.Net.XMLHttpExecutor.registerClass("Sys.Net.XMLHttpExecutor",Sys.Net.WebRequestExecutor),Sys.Net._WebRequestManager=function(){this._defaultTimeout=0,this._defaultExecutorType="Sys.Net.XMLHttpExecutor"},Sys.Net._WebRequestManager.prototype={add_invokingRequest:function(e){this._get_eventHandlerList().addHandler("invokingRequest",e)},remove_invokingRequest:function(e){this._get_eventHandlerList().removeHandler("invokingRequest",e)},add_completedRequest:function(e){this._get_eventHandlerList().addHandler("completedRequest",e)},remove_completedRequest:function(e){this._get_eventHandlerList().removeHandler("completedRequest",e)},_get_eventHandlerList:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},get_defaultTimeout:function(){return this._defaultTimeout},set_defaultTimeout:function(e){this._defaultTimeout=e},get_defaultExecutorType:function(){return this._defaultExecutorType},set_defaultExecutorType:function(e){this._defaultExecutorType=e},executeRequest:function(webRequest){var executor=webRequest.get_executor();if(!executor){var failed=!1;try{var executorType=eval(this._defaultExecutorType);executor=new executorType}catch(a){failed=!0}webRequest.set_executor(executor)}if(!executor.get_aborted()){var evArgs=new Sys.Net.NetworkRequestEventArgs(webRequest),handler=this._get_eventHandlerList().getHandler("invokingRequest");handler&&handler(this,evArgs),evArgs.get_cancel()||executor.executeRequest()}}},Sys.Net._WebRequestManager.registerClass("Sys.Net._WebRequestManager"),Sys.Net.WebRequestManager=new Sys.Net._WebRequestManager,Sys.Net.NetworkRequestEventArgs=function(e){Sys.Net.NetworkRequestEventArgs.initializeBase(this),this._webRequest=e},Sys.Net.NetworkRequestEventArgs.prototype={get_webRequest:function(){return this._webRequest}},Sys.Net.NetworkRequestEventArgs.registerClass("Sys.Net.NetworkRequestEventArgs",Sys.CancelEventArgs),Sys.Net.WebRequest=function(){this._url="",this._headers={},this._body=null,this._userContext=null,this._httpVerb=null,this._executor=null,this._invokeCalled=!1,this._timeout=0},Sys.Net.WebRequest.prototype={add_completed:function(e){this._get_eventHandlerList().addHandler("completed",e)},remove_completed:function(e){this._get_eventHandlerList().removeHandler("completed",e)},completed:function(e){var t=Sys.Net.WebRequestManager._get_eventHandlerList().getHandler("completedRequest");t&&t(this._executor,e),t=this._get_eventHandlerList().getHandler("completed"),t&&t(this._executor,e)},_get_eventHandlerList:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},get_url:function(){return this._url},set_url:function(e){this._url=e},get_headers:function(){return this._headers},get_httpVerb:function(){return null===this._httpVerb?null===this._body?"GET":"POST":this._httpVerb},set_httpVerb:function(e){this._httpVerb=e},get_body:function(){return this._body},set_body:function(e){this._body=e},get_userContext:function(){return this._userContext},set_userContext:function(e){this._userContext=e},get_executor:function(){return this._executor},set_executor:function(e){this._executor=e,this._executor._set_webRequest(this)},get_timeout:function(){return 0===this._timeout?Sys.Net.WebRequestManager.get_defaultTimeout():this._timeout},set_timeout:function(e){this._timeout=e},getResolvedUrl:function(){return Sys.Net.WebRequest._resolveUrl(this._url)},invoke:function(){Sys.Net.WebRequestManager.executeRequest(this),this._invokeCalled=!0}},Sys.Net.WebRequest._resolveUrl=function(e,t){if(e&&-1!==e.indexOf("://"))return e;if(!t||0===t.length){var i=document.getElementsByTagName("base")[0];t=i&&i.href&&i.href.length>0?i.href:document.URL}var a=t.indexOf("?");if(-1!==a&&(t=t.substr(0,a)),a=t.indexOf("#"),-1!==a&&(t=t.substr(0,a)),t=t.substr(0,t.lastIndexOf("/")+1),!e||0===e.length)return t;if("/"===e.charAt(0)){var n=t.indexOf("://"),o=t.indexOf("/",n+3);return t.substr(0,o)+e}var r=t.lastIndexOf("/");return t.substr(0,r+1)+e},Sys.Net.WebRequest._createQueryString=function(e,t,i){t=t||encodeURIComponent;var a,n,o,r=0,s=new Sys.StringBuilder;if(e)for(o in e)a=e[o],"function"!=typeof a&&(n=Sys.Serialization.JavaScriptSerializer.serialize(a),r++&&s.append("&"),s.append(o),s.append("="),s.append(t(n)));return i&&(r&&s.append("&"),s.append(i)),s.toString()},Sys.Net.WebRequest._createUrl=function(e,t,i){if(!t&&!i)return e;var a=Sys.Net.WebRequest._createQueryString(t,null,i);return a.length?e+(e&&e.indexOf("?")>=0?"&":"?")+a:e},Sys.Net.WebRequest.registerClass("Sys.Net.WebRequest"),Sys._ScriptLoaderTask=function(e,t){this._scriptElement=e,this._completedCallback=t},Sys._ScriptLoaderTask.prototype={get_scriptElement:function(){return this._scriptElement},dispose:function(){this._disposed||(this._disposed=!0,this._removeScriptElementHandlers(),Sys._ScriptLoaderTask._clearScript(this._scriptElement),this._scriptElement=null)},execute:function(){this._addScriptElementHandlers(),document.getElementsByTagName("head")[0].appendChild(this._scriptElement)},_addScriptElementHandlers:function(){this._scriptLoadDelegate=Function.createDelegate(this,this._scriptLoadHandler),Sys.Browser.agent!==Sys.Browser.InternetExplorer?(this._scriptElement.readyState="loaded",$addHandler(this._scriptElement,"load",this._scriptLoadDelegate)):$addHandler(this._scriptElement,"readystatechange",this._scriptLoadDelegate),this._scriptElement.addEventListener&&(this._scriptErrorDelegate=Function.createDelegate(this,this._scriptErrorHandler),this._scriptElement.addEventListener("error",this._scriptErrorDelegate,!1))},_removeScriptElementHandlers:function(){if(this._scriptLoadDelegate){var e=this.get_scriptElement();Sys.Browser.agent!==Sys.Browser.InternetExplorer?$removeHandler(e,"load",this._scriptLoadDelegate):$removeHandler(e,"readystatechange",this._scriptLoadDelegate),this._scriptErrorDelegate&&(this._scriptElement.removeEventListener("error",this._scriptErrorDelegate,!1),this._scriptErrorDelegate=null),this._scriptLoadDelegate=null}},_scriptErrorHandler:function(){this._disposed||this._completedCallback(this.get_scriptElement(),!1)},_scriptLoadHandler:function(){if(!this._disposed){var e=this.get_scriptElement();("loaded"===e.readyState||"complete"===e.readyState)&&this._completedCallback(e,!0)}}},Sys._ScriptLoaderTask.registerClass("Sys._ScriptLoaderTask",null,Sys.IDisposable),Sys._ScriptLoaderTask._clearScript=function(e){Sys.Debug.isDebug||e.parentNode.removeChild(e)},Type.registerNamespace("Sys.Net"),Sys.Net.WebServiceProxy=function(){},Sys.Net.WebServiceProxy.prototype={get_timeout:function(){return this._timeout||0},set_timeout:function(e){if(0>e)throw Error.argumentOutOfRange("value",e,Sys.Res.invalidTimeout);this._timeout=e},get_defaultUserContext:function(){return"undefined"==typeof this._userContext?null:this._userContext},set_defaultUserContext:function(e){this._userContext=e},get_defaultSucceededCallback:function(){return this._succeeded||null},set_defaultSucceededCallback:function(e){this._succeeded=e},get_defaultFailedCallback:function(){return this._failed||null},set_defaultFailedCallback:function(e){this._failed=e},get_enableJsonp:function(){return!!this._jsonp},set_enableJsonp:function(e){this._jsonp=e},get_path:function(){return this._path||null},set_path:function(e){this._path=e},get_jsonpCallbackParameter:function(){return this._callbackParameter||"callback"},set_jsonpCallbackParameter:function(e){this._callbackParameter=e},_invoke:function(e,t,i,a,n,o,r){return n=n||this.get_defaultSucceededCallback(),o=o||this.get_defaultFailedCallback(),(null===r||"undefined"==typeof r)&&(r=this.get_defaultUserContext()),Sys.Net.WebServiceProxy.invoke(e,t,i,a,n,o,r,this.get_timeout(),this.get_enableJsonp(),this.get_jsonpCallbackParameter())}},Sys.Net.WebServiceProxy.registerClass("Sys.Net.WebServiceProxy"),Sys.Net.WebServiceProxy.invoke=function(e,t,i,a,n,o,r,s,l,d){function c(){null!==D&&(D=null,y=new Sys.Net.WebServiceError(!0,String.format(Sys.Res.webServiceTimedOut,t)),b.dispose(),delete Sys[p],o&&o(y,r,t))}function h(e,i){null!==D&&(window.clearTimeout(D),D=null),b.dispose(),delete Sys[p],p=null,"undefined"!=typeof i&&200!==i?o&&(y=new Sys.Net.WebServiceError(!1,e.Message||String.format(Sys.Res.webServiceFailedNoMsg,t),e.StackTrace||null,e.ExceptionType||null,e),y._statusCode=i,o(y,r,t)):n&&n(e,r,t)}function u(e){if(e.get_responseAvailable()){var i=e.get_statusCode(),a=null;try{var s=e.getResponseHeader("Content-Type");a=s.startsWith("application/json")?e.get_object():s.startsWith("text/xml")?e.get_xml():e.get_responseData()}catch(l){}var d=e.getResponseHeader("jsonerror"),c="true"===d;c?a&&(a=new Sys.Net.WebServiceError(!1,a.Message,a.StackTrace,a.ExceptionType,a)):s.startsWith("application/json")&&(a=a&&"undefined"!=typeof a.d?a.d:a),200>i||i>=300||c?o&&(a&&c||(a=new Sys.Net.WebServiceError(!1,String.format(Sys.Res.webServiceFailedNoMsg,t))),a._statusCode=i,o(a,r,t)):n&&n(a,r,t)}else{var h;h=e.get_timedOut()?String.format(Sys.Res.webServiceTimedOut,t):String.format(Sys.Res.webServiceFailedNoMsg,t),o&&o(new Sys.Net.WebServiceError(e.get_timedOut(),h,"",""),r,t)}}var p,g=l!==!1?Sys.Net.WebServiceProxy._xdomain.exec(e):null,f=g&&3===g.length&&(g[1]!==location.protocol||g[2]!==location.host);i=f||i,f&&(d=d||"callback",p="_jsonp"+Sys._jsonp++),a||(a={});var m=a;i&&m||(m={});var v,y,b,D=null,k=null,C=Sys.Net.WebRequest._createUrl(t?e+"/"+encodeURIComponent(t):e,m,f?d+"=Sys."+p:null);if(f)return v=document.createElement("script"),v.src=C,b=new Sys._ScriptLoaderTask(v,function(e,i){(!i||p)&&h({Message:String.format(Sys.Res.webServiceFailedNoMsg,t)},-1)}),Sys[p]=h,s=s||Sys.Net.WebRequestManager.get_defaultTimeout(),s>0&&(D=window.setTimeout(c,s)),b.execute(),null;var x=new Sys.Net.WebRequest;return x.set_url(C),x.get_headers()["Content-Type"]="application/json; charset=utf-8",i||(k=Sys.Serialization.JavaScriptSerializer.serialize(a),"{}"===k&&(k="")),x.set_body(k),x.add_completed(u),s&&s>0&&x.set_timeout(s),x.invoke(),x},Sys.Net.WebServiceProxy._generateTypedConstructor=function(e){return function(t){if(t)for(var i in t)this[i]=t[i];this.__type=e}},Sys._jsonp=0,Sys.Net.WebServiceProxy._xdomain=/^\s*([a-zA-Z0-9\+\-\.]+\:)\/\/([^?#\/]+)/,Sys.Net.WebServiceError=function(e,t,i,a,n){this._timedOut=e,this._message=t,this._stackTrace=i,this._exceptionType=a,this._errorObject=n,this._statusCode=-1},Sys.Net.WebServiceError.prototype={get_timedOut:function(){return this._timedOut},get_statusCode:function(){return this._statusCode},get_message:function(){return this._message},get_stackTrace:function(){return this._stackTrace||""},get_exceptionType:function(){return this._exceptionType||""},get_errorObject:function(){return this._errorObject||null}},Sys.Net.WebServiceError.registerClass("Sys.Net.WebServiceError"),Type.registerNamespace("Sys"),Sys.Res={argumentInteger:"Value must be an integer.",invokeCalledTwice:"Cannot call invoke more than once.",webServiceFailed:"The server method '{0}' failed with the following error: {1}",argumentType:"Object cannot be converted to the required type.",argumentNull:"Value cannot be null.",scriptAlreadyLoaded:"The script '{0}' has been referenced multiple times. If referencing Microsoft AJAX scripts explicitly, set the MicrosoftAjaxMode property of the ScriptManager to Explicit.",scriptDependencyNotFound:"The script '{0}' failed to load because it is dependent on script '{1}'.",formatBadFormatSpecifier:"Format specifier was invalid.",requiredScriptReferenceNotIncluded:"'{0}' requires that you have included a script reference to '{1}'.",webServiceFailedNoMsg:"The server method '{0}' failed.",argumentDomElement:"Value must be a DOM element.",invalidExecutorType:"Could not create a valid Sys.Net.WebRequestExecutor from: {0}.",cannotCallBeforeResponse:"Cannot call {0} when responseAvailable is false.",actualValue:"Actual value was {0}.",enumInvalidValue:"'{0}' is not a valid value for enum {1}.",scriptLoadFailed:"The script '{0}' could not be loaded.",parameterCount:"Parameter count mismatch.",cannotDeserializeEmptyString:"Cannot deserialize empty string.",formatInvalidString:"Input string was not in a correct format.",invalidTimeout:"Value must be greater than or equal to zero.",cannotAbortBeforeStart:"Cannot abort when executor has not started.",argument:"Value does not fall within the expected range.",cannotDeserializeInvalidJson:"Cannot deserialize. The data does not correspond to valid JSON.",invalidHttpVerb:"httpVerb cannot be set to an empty or null string.",nullWebRequest:"Cannot call executeRequest with a null webRequest.",eventHandlerInvalid:"Handler was not added through the Sys.UI.DomEvent.addHandler method.",cannotSerializeNonFiniteNumbers:"Cannot serialize non finite numbers.",argumentUndefined:"Value cannot be undefined.",webServiceInvalidReturnType:"The server method '{0}' returned an invalid type. Expected type: {1}",servicePathNotSet:"The path to the web service has not been set.",argumentTypeWithTypes:"Object of type '{0}' cannot be converted to type '{1}'.",cannotCallOnceStarted:"Cannot call {0} once started.",badBaseUrl1:"Base URL does not contain ://.",badBaseUrl2:"Base URL does not contain another /.",badBaseUrl3:"Cannot find last / in base URL.",setExecutorAfterActive:"Cannot set executor after it has become active.",paramName:"Parameter name: {0}",nullReferenceInPath:"Null reference while evaluating data path: '{0}'.",cannotCallOutsideHandler:"Cannot call {0} outside of a completed event handler.",cannotSerializeObjectWithCycle:"Cannot serialize object with cyclic reference within child properties.",format:"One of the identified items was in an invalid format.",assertFailedCaller:"Assertion Failed: {0}\r\nat {1}",argumentOutOfRange:"Specified argument was out of the range of valid values.",webServiceTimedOut:"The server method '{0}' timed out.",notImplemented:"The method or operation is not implemented.",assertFailed:"Assertion Failed: {0}",invalidOperation:"Operation is not valid due to the current state of the object.",breakIntoDebugger:"{0}\r\n\r\nBreak into debugger?"},define("MicrosoftAjax",function(e){return function(){var t;return t||e.MicrosoftAjax}}(this));var KD=KD||{};!function(e){e.CONST={k3CloudQBoardSimplePortKey:"k3CloudQBoardSimplePortKey",k3CloudLoginInfoKey:"k3cloudloginInfo",LocalConfigurationKey:"LocalConfiguration",SimulateMacAddress:"SimulateMacAddress",SimulateIpAddress:"SimulateIpAddress",WorkflowChartZindex:2e4,ItemContainerOtherWidth:32,ItemContainerGalaxy:40,GalaxyFormThemeName:"Galaxy",TabMaxItemCout:15,BrowsType:{Chrome:"chrome",IE:"ie",FireFox:"firefox",Safari:"safari",Opera:"opera"},FloatingPlacementType:{BottomLeftToRight:"BottomLeftToRight",BottomRightToLeft:"BottomRightToLeft",MainMenuBottomRightToLeft:"MainMenuBottomRightToLeft"},FormSizeToContent:{Manual:0,Width:1,Height:2,WidthAndHeight:3},DataMaskModel:{Normal:0,Closed:1,Locked:2},newFileUpSec:"Kingdee.BOS.Util.PathUtils",newFileUpHeaderSec:{typ:"JWT",alg:"HS256"},DateShortCodeComparsionList:void 0,ClientType:"Html5",MaxCardsCount:17,MinClientHeight:595,MinClientWidth:1004,IsBillHeadFloat:void 0,IsEnableMinClientHeight:!0,EnableSmallScreenCriticalValue:768,isStartNewUserUtilityWizards:!1,isHasLoginByCloudAccountName:"isHasLoginByCloudAccount",CurrentDragUploadfileEventInfomationCache:void 0,IsEnableNewStyleOfTipbar:void 0,ScrollBarHeight:void 0,FooterMainPanelHeight:66,IsMobileTerminalPlatform:void 0,UnCommunitySolutionSearchMode:!1,F5RefreshEventParameterName:"F5RefreshEventParameter",IsSingleMode:void 0,MainConsoleFormIdForSingleMode:void 0,SetEnableShowCVPAllFieldData:"SetEnableShowCVPAllFieldData",MessageConcentratorGetProKey:"_GetMessage_"},e.CONST.CustomEventName={FieldEditorFocued:"FieldEditorFocued",KDMesconcentratorGetCustomEvent:"Kingdee.BOS.KDMesconcentratorGet",KDMesconcentratorConteClick:"Kingdee.BOS.MesageContentClick.ContentClick",KDMesconcentratorMoreClick:"Kingdee.BOS.MesageContentClick.MoreClick",KDMesconcentratorCloseClick:"Kingdee.BOS.MesageContentClick.CloseClick",KDScanTextChangedCustomEvent:"Kingdee.BOS.KDScanTextChangedCustomEvent",KDEntityBlockPastingAutoAssign:"EntityBlockPastingAutoAssign",KDEntityBlockPasting:"EntityBlockPasting",KDErrorSolutionsUnStand:"Kingdee.BOS.MesTips.ErrorSolutionsUnStand",KDSearchTextFieldCustomEvent:"Kingdee.BOS.KDSearchTextFieldCustomEvent",ShowCVPFieldData:"ShowCVPFieldData",PutUserBehavior:"Kingdee.BOS.PutUserBehavior",FluidDashBoardChanged:"FluidDashBoardChanged",WebbrowserMessage:"Kingdee.BOS.WebbrowserMessage",ShowCVPAllFieldData:"ShowCVPAllFieldData"},e.CONST.ShortCutKeyToggle={Digit0:"D0",Digit1:"D1",Digit2:"D2",Digit3:"D3",Digit4:"D4",Digit5:"D5",Digit6:"D6",Digit7:"D7",Digit8:"D8",Digit9:"D9",Numpad0:"NumPad0",Numpad1:"NumPad1",Numpad2:"NumPad2",Numpad3:"NumPad3",Numpad4:"NumPad4",Numpad5:"NumPad5",Numpad6:"NumPad6",Numpad7:"NumPad7",Numpad8:"NumPad8",Numpad9:"NumPad9",ArrowUp:"Up",ArrowDown:"Down",ArrowRight:"Right",ArrowLeft:"Left"}}(KD),define("KD.CONST",function(e){return function(){var t;return t||e.KD.CONST}}(this)),function(){stringBuilder=function(e){this._strArray=new Array,e&&this.append(e)},stringBuilder.prototype.append=function(e){this._strArray.push(e)},stringBuilder.prototype.appendLine=function(e){this._strArray.push(e),this._strArray.push("\r\n")},stringBuilder.prototype.toString=function(e){return this._strArray.join(e||"")}}(),define("stringBuilder",function(){}),function(e){"use strict";function t(e){for(var t=e.length;--t>=0;)e[t]=0}function i(e,t,i,a,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=a,this.max_length=n,this.has_stree=e&&e.length}function a(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function n(e,t,i,a,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=a,this.func=n}function o(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=it,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*ht),this.dyn_dtree=new Uint16Array(2*(2*dt+1)),this.bl_tree=new Uint16Array(2*(2*ct+1)),_t(this.dyn_ltree),_t(this.dyn_dtree),_t(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(ut+1),this.heap=new Uint16Array(2*lt+1),_t(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*lt+1),_t(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function l(e){this.options=fi.assign({level:Li,method:Ei,chunkSize:16384,windowBits:15,memLevel:8,strategy:Mi},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ki,this.strm.avail_out=0;var i=hi.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==_i)throw new Error(Ae[i]);if(t.header&&hi.deflateSetHeader(this.strm,t.header),t.dictionary){var a;if(a="string"==typeof t.dictionary?wi.string2buf(t.dictionary):"[object ArrayBuffer]"===Si.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=hi.deflateSetDictionary(this.strm,a),i!==_i)throw new Error(Ae[i]);this._dict_set=!0}}function d(e,t){var i=new l(t);if(i.push(e,!0),i.err)throw i.msg||Ae[i.err];return i.result}function c(e,t){return t=t||{},t.gzip=!0,d(e,t)}var h=4,u=0,p=1,g=2,f=0,m=1,v=2,y=3,b=258,D=29,k=256,C=k+1+D,x=30,w=19,K=2*C+1,S=15,I=16,P=7,F=256,T=16,_=17,A=18,L=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),M=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),E=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),B=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R=512,N=new Array(2*(C+2));t(N);var H=new Array(2*x);t(H);var O=new Array(R);t(O);var V=new Array(b-y+1);t(V);var j=new Array(D);t(j);var z=new Array(x);t(z);var U,q,G,$=function(e){return 256>e?O[e]:O[256+(e>>>7)]},W=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},J=function(e,t,i){e.bi_valid>I-i?(e.bi_buf|=t<<e.bi_valid&65535,W(e,e.bi_buf),e.bi_buf=t>>I-e.bi_valid,e.bi_valid+=i-I):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},Q=function(e,t,i){J(e,i[2*t],i[2*t+1])},X=function(e,t){var i=0;do i|=1&e,e>>>=1,i<<=1;while(--t>0);return i>>>1},Y=function(e){16===e.bi_valid?(W(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},Z=function(e,t){var i,a,n,o,r,s,l=t.dyn_tree,d=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,f=0;for(o=0;S>=o;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;K>i;i++)a=e.heap[i],o=l[2*l[2*a+1]+1]+1,o>g&&(o=g,f++),l[2*a+1]=o,a>d||(e.bl_count[o]++,r=0,a>=p&&(r=u[a-p]),s=l[2*a],e.opt_len+=s*(o+r),h&&(e.static_len+=s*(c[2*a+1]+r)));if(0!==f){do{for(o=g-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[g]--,f-=2}while(f>0);for(o=g;0!==o;o--)for(a=e.bl_count[o];0!==a;)n=e.heap[--i],n>d||(l[2*n+1]!==o&&(e.opt_len+=(o-l[2*n+1])*l[2*n],l[2*n+1]=o),a--)}},ee=function(e,t,i){var a,n,o=new Array(S+1),r=0;for(a=1;S>=a;a++)o[a]=r=r+i[a-1]<<1;for(n=0;t>=n;n++){var s=e[2*n+1];0!==s&&(e[2*n]=X(o[s]++,s))}},te=function(){var e,t,a,n,o,r=new Array(S+1);for(a=0,n=0;D-1>n;n++)for(j[n]=a,e=0;e<1<<L[n];e++)V[a++]=n;for(V[a-1]=n,o=0,n=0;16>n;n++)for(z[n]=o,e=0;e<1<<M[n];e++)O[o++]=n;for(o>>=7;x>n;n++)for(z[n]=o<<7,e=0;e<1<<M[n]-7;e++)O[256+o++]=n;for(t=0;S>=t;t++)r[t]=0;for(e=0;143>=e;)N[2*e+1]=8,e++,r[8]++;for(;255>=e;)N[2*e+1]=9,e++,r[9]++;for(;279>=e;)N[2*e+1]=7,e++,r[7]++;for(;287>=e;)N[2*e+1]=8,e++,r[8]++;for(ee(N,C+1,r),e=0;x>e;e++)H[2*e+1]=5,H[2*e]=X(e,5);U=new i(N,L,k+1,C,S),q=new i(H,M,0,x,S),G=new i(new Array(0),E,0,w,P)},ie=function(e){var t;for(t=0;C>t;t++)e.dyn_ltree[2*t]=0;for(t=0;x>t;t++)e.dyn_dtree[2*t]=0;for(t=0;w>t;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*F]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},ae=function(e){e.bi_valid>8?W(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},ne=function(e,t,i,a){ae(e),a&&(W(e,i),W(e,~i)),e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i},oe=function(e,t,i,a){var n=2*t,o=2*i;return e[n]<e[o]||e[n]===e[o]&&a[t]<=a[i]},re=function(e,t,i){for(var a=e.heap[i],n=i<<1;n<=e.heap_len&&(n<e.heap_len&&oe(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!oe(t,a,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=a},se=function(e,t,i){var a,n,o,r,s=0;if(0!==e.last_lit)do a=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],n=e.pending_buf[e.l_buf+s],s++,0===a?Q(e,n,t):(o=V[n],Q(e,o+k+1,t),r=L[o],0!==r&&(n-=j[o],J(e,n,r)),a--,o=$(a),Q(e,o,i),r=M[o],0!==r&&(a-=z[o],J(e,a,r)));while(s<e.last_lit);Q(e,F,t)},le=function(e,t){var i,a,n,o=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,d=-1;for(e.heap_len=0,e.heap_max=K,i=0;l>i;i++)0!==o[2*i]?(e.heap[++e.heap_len]=d=i,
e.depth[i]=0):o[2*i+1]=0;for(;e.heap_len<2;)n=e.heap[++e.heap_len]=2>d?++d:0,o[2*n]=1,e.depth[n]=0,e.opt_len--,s&&(e.static_len-=r[2*n+1]);for(t.max_code=d,i=e.heap_len>>1;i>=1;i--)re(e,o,i);n=l;do i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],re(e,o,1),a=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=a,o[2*n]=o[2*i]+o[2*a],e.depth[n]=(e.depth[i]>=e.depth[a]?e.depth[i]:e.depth[a])+1,o[2*i+1]=o[2*a+1]=n,e.heap[1]=n++,re(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Z(e,t),ee(o,d,e.bl_count)},de=function(e,t,i){var a,n,o=-1,r=t[1],s=0,l=7,d=4;for(0===r&&(l=138,d=3),t[2*(i+1)+1]=65535,a=0;i>=a;a++)n=r,r=t[2*(a+1)+1],++s<l&&n===r||(d>s?e.bl_tree[2*n]+=s:0!==n?(n!==o&&e.bl_tree[2*n]++,e.bl_tree[2*T]++):10>=s?e.bl_tree[2*_]++:e.bl_tree[2*A]++,s=0,o=n,0===r?(l=138,d=3):n===r?(l=6,d=3):(l=7,d=4))},ce=function(e,t,i){var a,n,o=-1,r=t[1],s=0,l=7,d=4;for(0===r&&(l=138,d=3),a=0;i>=a;a++)if(n=r,r=t[2*(a+1)+1],!(++s<l&&n===r)){if(d>s){do Q(e,n,e.bl_tree);while(0!==--s)}else 0!==n?(n!==o&&(Q(e,n,e.bl_tree),s--),Q(e,T,e.bl_tree),J(e,s-3,2)):10>=s?(Q(e,_,e.bl_tree),J(e,s-3,3)):(Q(e,A,e.bl_tree),J(e,s-11,7));s=0,o=n,0===r?(l=138,d=3):n===r?(l=6,d=3):(l=7,d=4)}},he=function(e){var t;for(de(e,e.dyn_ltree,e.l_desc.max_code),de(e,e.dyn_dtree,e.d_desc.max_code),le(e,e.bl_desc),t=w-1;t>=3&&0===e.bl_tree[2*B[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t},ue=function(e,t,i,a){var n;for(J(e,t-257,5),J(e,i-1,5),J(e,a-4,4),n=0;a>n;n++)J(e,e.bl_tree[2*B[n]+1],3);ce(e,e.dyn_ltree,t-1),ce(e,e.dyn_dtree,i-1)},pe=function(e){var t,i=4093624447;for(t=0;31>=t;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return u;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return p;for(t=32;k>t;t++)if(0!==e.dyn_ltree[2*t])return p;return u},ge=!1,fe=function(e){ge||(te(),ge=!0),e.l_desc=new a(e.dyn_ltree,U),e.d_desc=new a(e.dyn_dtree,q),e.bl_desc=new a(e.bl_tree,G),e.bi_buf=0,e.bi_valid=0,ie(e)},me=function(e,t,i,a){J(e,(f<<1)+(a?1:0),3),ne(e,t,i,!0)},ve=function(e){J(e,m<<1,3),Q(e,F,N),Y(e)},ye=function(e,t,i,a){var n,o,r=0;e.level>0?(e.strm.data_type===g&&(e.strm.data_type=pe(e)),le(e,e.l_desc),le(e,e.d_desc),r=he(e),n=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,n>=o&&(n=o)):n=o=i+5,n>=i+4&&-1!==t?me(e,t,i,a):e.strategy===h||o===n?(J(e,(m<<1)+(a?1:0),3),se(e,N,H)):(J(e,(v<<1)+(a?1:0),3),ue(e,e.l_desc.max_code+1,e.d_desc.max_code+1,r+1),se(e,e.dyn_ltree,e.dyn_dtree)),ie(e),a&&ae(e)},be=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(V[i]+k+1)]++,e.dyn_dtree[2*$(t)]++),e.last_lit===e.lit_bufsize-1},De=fe,ke=me,Ce=ye,xe=be,we=ve,Ke={_tr_init:De,_tr_stored_block:ke,_tr_flush_block:Ce,_tr_tally:xe,_tr_align:we},Se=function(e,t,i,a){for(var n=65535&e|0,o=e>>>16&65535|0,r=0;0!==i;){r=i>2e3?2e3:i,i-=r;do n=n+t[a++]|0,o=o+n|0;while(--r);n%=65521,o%=65521}return n|o<<16|0},Ie=Se,Pe=function(){for(var e,t=[],i=0;256>i;i++){e=i;for(var a=0;8>a;a++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t},Fe=new Uint32Array(Pe()),Te=function(e,t,i,a){var n=Fe,o=a+i;e^=-1;for(var r=a;o>r;r++)e=e>>>8^n[255&(e^t[r])];return-1^e},_e=Te,Ae={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Le={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Me=Ke._tr_init,Ee=Ke._tr_stored_block,Be=Ke._tr_flush_block,Re=Ke._tr_tally,Ne=Ke._tr_align,He=Le.Z_NO_FLUSH,Oe=Le.Z_PARTIAL_FLUSH,Ve=Le.Z_FULL_FLUSH,je=Le.Z_FINISH,ze=Le.Z_BLOCK,Ue=Le.Z_OK,qe=Le.Z_STREAM_END,Ge=Le.Z_STREAM_ERROR,$e=Le.Z_DATA_ERROR,We=Le.Z_BUF_ERROR,Je=Le.Z_DEFAULT_COMPRESSION,Qe=Le.Z_FILTERED,Xe=Le.Z_HUFFMAN_ONLY,Ye=Le.Z_RLE,Ze=Le.Z_FIXED,et=Le.Z_DEFAULT_STRATEGY,tt=Le.Z_UNKNOWN,it=Le.Z_DEFLATED,at=9,nt=15,ot=8,rt=29,st=256,lt=st+1+rt,dt=30,ct=19,ht=2*lt+1,ut=15,pt=3,gt=258,ft=gt+pt+1,mt=32,vt=42,yt=69,bt=73,Dt=91,kt=103,Ct=113,xt=666,wt=1,Kt=2,St=3,It=4,Pt=3,Ft=function(e,t){return e.msg=Ae[t],t},Tt=function(e){return(e<<1)-(e>4?9:0)},_t=function(e){for(var t=e.length;--t>=0;)e[t]=0},At=function(e,t,i){return(t<<e.hash_shift^i)&e.hash_mask},Lt=At,Mt=function(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},Et=function(e,t){Be(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Mt(e.strm)},Bt=function(e,t){e.pending_buf[e.pending++]=t},Rt=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Nt=function(e,t,i,a){var n=e.avail_in;return n>a&&(n=a),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),i),1===e.state.wrap?e.adler=Ie(e.adler,t,n,i):2===e.state.wrap&&(e.adler=_e(e.adler,t,n,i)),e.next_in+=n,e.total_in+=n,n)},Ht=function(e,t){var i,a,n=e.max_chain_length,o=e.strstart,r=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-ft?e.strstart-(e.w_size-ft):0,d=e.window,c=e.w_mask,h=e.prev,u=e.strstart+gt,p=d[o+r-1],g=d[o+r];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do if(i=t,d[i+r]===g&&d[i+r-1]===p&&d[i]===d[o]&&d[++i]===d[o+1]){o+=2,i++;do;while(d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&u>o);if(a=gt-(u-o),o=u-gt,a>r){if(e.match_start=t,r=a,a>=s)break;p=d[o+r-1],g=d[o+r]}}while((t=h[t&c])>l&&0!==--n);return r<=e.lookahead?r:e.lookahead},Ot=function(e){var t,i,a,n,o,r=e.w_size;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-ft)){e.window.set(e.window.subarray(r,r+r),0),e.match_start-=r,e.strstart-=r,e.block_start-=r,i=e.hash_size,t=i;do a=e.head[--t],e.head[t]=a>=r?a-r:0;while(--i);i=r,t=i;do a=e.prev[--t],e.prev[t]=a>=r?a-r:0;while(--i);n+=r}if(0===e.strm.avail_in)break;if(i=Nt(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=i,e.lookahead+e.insert>=pt)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Lt(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Lt(e,e.ins_h,e.window[o+pt-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<pt)););}while(e.lookahead<ft&&0!==e.strm.avail_in)},Vt=function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Ot(e),0===e.lookahead&&t===He)return wt;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var a=e.block_start+i;if((0===e.strstart||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,Et(e,!1),0===e.strm.avail_out))return wt;if(e.strstart-e.block_start>=e.w_size-ft&&(Et(e,!1),0===e.strm.avail_out))return wt}return e.insert=0,t===je?(Et(e,!0),0===e.strm.avail_out?St:It):e.strstart>e.block_start&&(Et(e,!1),0===e.strm.avail_out)?wt:wt},jt=function(e,t){for(var i,a;;){if(e.lookahead<ft){if(Ot(e),e.lookahead<ft&&t===He)return wt;if(0===e.lookahead)break}if(i=0,e.lookahead>=pt&&(e.ins_h=Lt(e,e.ins_h,e.window[e.strstart+pt-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-ft&&(e.match_length=Ht(e,i)),e.match_length>=pt)if(a=Re(e,e.strstart-e.match_start,e.match_length-pt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=pt){e.match_length--;do e.strstart++,e.ins_h=Lt(e,e.ins_h,e.window[e.strstart+pt-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Lt(e,e.ins_h,e.window[e.strstart+1]);else a=Re(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(Et(e,!1),0===e.strm.avail_out))return wt}return e.insert=e.strstart<pt-1?e.strstart:pt-1,t===je?(Et(e,!0),0===e.strm.avail_out?St:It):e.last_lit&&(Et(e,!1),0===e.strm.avail_out)?wt:Kt},zt=function(e,t){for(var i,a,n;;){if(e.lookahead<ft){if(Ot(e),e.lookahead<ft&&t===He)return wt;if(0===e.lookahead)break}if(i=0,e.lookahead>=pt&&(e.ins_h=Lt(e,e.ins_h,e.window[e.strstart+pt-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=pt-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-ft&&(e.match_length=Ht(e,i),e.match_length<=5&&(e.strategy===Qe||e.match_length===pt&&e.strstart-e.match_start>4096)&&(e.match_length=pt-1)),e.prev_length>=pt&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-pt,a=Re(e,e.strstart-1-e.prev_match,e.prev_length-pt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=Lt(e,e.ins_h,e.window[e.strstart+pt-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!==--e.prev_length);if(e.match_available=0,e.match_length=pt-1,e.strstart++,a&&(Et(e,!1),0===e.strm.avail_out))return wt}else if(e.match_available){if(a=Re(e,0,e.window[e.strstart-1]),a&&Et(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return wt}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=Re(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<pt-1?e.strstart:pt-1,t===je?(Et(e,!0),0===e.strm.avail_out?St:It):e.last_lit&&(Et(e,!1),0===e.strm.avail_out)?wt:Kt},Ut=function(e,t){for(var i,a,n,o,r=e.window;;){if(e.lookahead<=gt){if(Ot(e),e.lookahead<=gt&&t===He)return wt;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=pt&&e.strstart>0&&(n=e.strstart-1,a=r[n],a===r[++n]&&a===r[++n]&&a===r[++n])){o=e.strstart+gt;do;while(a===r[++n]&&a===r[++n]&&a===r[++n]&&a===r[++n]&&a===r[++n]&&a===r[++n]&&a===r[++n]&&a===r[++n]&&o>n);e.match_length=gt-(o-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=pt?(i=Re(e,1,e.match_length-pt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=Re(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(Et(e,!1),0===e.strm.avail_out))return wt}return e.insert=0,t===je?(Et(e,!0),0===e.strm.avail_out?St:It):e.last_lit&&(Et(e,!1),0===e.strm.avail_out)?wt:Kt},qt=function(e,t){for(var i;;){if(0===e.lookahead&&(Ot(e),0===e.lookahead)){if(t===He)return wt;break}if(e.match_length=0,i=Re(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(Et(e,!1),0===e.strm.avail_out))return wt}return e.insert=0,t===je?(Et(e,!0),0===e.strm.avail_out?St:It):e.last_lit&&(Et(e,!1),0===e.strm.avail_out)?wt:Kt},Gt=[new n(0,0,0,0,Vt),new n(4,4,8,4,jt),new n(4,5,16,8,jt),new n(4,6,32,32,jt),new n(4,4,16,16,zt),new n(8,16,32,32,zt),new n(8,16,128,128,zt),new n(8,32,128,256,zt),new n(32,128,258,1024,zt),new n(32,258,258,4096,zt)],$t=function(e){e.window_size=2*e.w_size,_t(e.head),e.max_lazy_match=Gt[e.level].max_lazy,e.good_match=Gt[e.level].good_length,e.nice_match=Gt[e.level].nice_length,e.max_chain_length=Gt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=pt-1,e.match_available=0,e.ins_h=0},Wt=function(e){if(!e||!e.state)return Ft(e,Ge);e.total_in=e.total_out=0,e.data_type=tt;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?vt:Ct,e.adler=2===t.wrap?0:1,t.last_flush=He,Me(t),Ue},Jt=function(e){var t=Wt(e);return t===Ue&&$t(e.state),t},Qt=function(e,t){return e&&e.state?2!==e.state.wrap?Ge:(e.state.gzhead=t,Ue):Ge},Xt=function(e,t,i,a,n,r){if(!e)return Ge;var s=1;if(t===Je&&(t=6),0>a?(s=0,a=-a):a>15&&(s=2,a-=16),1>n||n>at||i!==it||8>a||a>15||0>t||t>9||0>r||r>Ze)return Ft(e,Ge);8===a&&(a=9);var l=new o;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=a,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=n+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+pt-1)/pt),l.window=new Uint8Array(2*l.w_size),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<n+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new Uint8Array(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=r,l.method=i,Jt(e)},Yt=function(e,t){return Xt(e,t,it,nt,ot,et)},Zt=function(e,t){var i,a;if(!e||!e.state||t>ze||0>t)return e?Ft(e,Ge):Ge;var n=e.state;if(!e.output||!e.input&&0!==e.avail_in||n.status===xt&&t!==je)return Ft(e,0===e.avail_out?We:Ge);n.strm=e;var o=n.last_flush;if(n.last_flush=t,n.status===vt)if(2===n.wrap)e.adler=0,Bt(n,31),Bt(n,139),Bt(n,8),n.gzhead?(Bt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Bt(n,255&n.gzhead.time),Bt(n,n.gzhead.time>>8&255),Bt(n,n.gzhead.time>>16&255),Bt(n,n.gzhead.time>>24&255),Bt(n,9===n.level?2:n.strategy>=Xe||n.level<2?4:0),Bt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Bt(n,255&n.gzhead.extra.length),Bt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=_e(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=yt):(Bt(n,0),Bt(n,0),Bt(n,0),Bt(n,0),Bt(n,0),Bt(n,9===n.level?2:n.strategy>=Xe||n.level<2?4:0),Bt(n,Pt),n.status=Ct);else{var r=it+(n.w_bits-8<<4)<<8,s=-1;s=n.strategy>=Xe||n.level<2?0:n.level<6?1:6===n.level?2:3,r|=s<<6,0!==n.strstart&&(r|=mt),r+=31-r%31,n.status=Ct,Rt(n,r),0!==n.strstart&&(Rt(n,e.adler>>>16),Rt(n,65535&e.adler)),e.adler=1}if(n.status===yt)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=_e(e.adler,n.pending_buf,n.pending-i,i)),Mt(e),i=n.pending,n.pending!==n.pending_buf_size));)Bt(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=_e(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=bt)}else n.status=bt;if(n.status===bt)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=_e(e.adler,n.pending_buf,n.pending-i,i)),Mt(e),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Bt(n,a)}while(0!==a);n.gzhead.hcrc&&n.pending>i&&(e.adler=_e(e.adler,n.pending_buf,n.pending-i,i)),0===a&&(n.gzindex=0,n.status=Dt)}else n.status=Dt;if(n.status===Dt)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=_e(e.adler,n.pending_buf,n.pending-i,i)),Mt(e),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Bt(n,a)}while(0!==a);n.gzhead.hcrc&&n.pending>i&&(e.adler=_e(e.adler,n.pending_buf,n.pending-i,i)),0===a&&(n.status=kt)}else n.status=kt;if(n.status===kt&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&Mt(e),n.pending+2<=n.pending_buf_size&&(Bt(n,255&e.adler),Bt(n,e.adler>>8&255),e.adler=0,n.status=Ct)):n.status=Ct),0!==n.pending){if(Mt(e),0===e.avail_out)return n.last_flush=-1,Ue}else if(0===e.avail_in&&Tt(t)<=Tt(o)&&t!==je)return Ft(e,We);if(n.status===xt&&0!==e.avail_in)return Ft(e,We);if(0!==e.avail_in||0!==n.lookahead||t!==He&&n.status!==xt){var l=n.strategy===Xe?qt(n,t):n.strategy===Ye?Ut(n,t):Gt[n.level].func(n,t);if((l===St||l===It)&&(n.status=xt),l===wt||l===St)return 0===e.avail_out&&(n.last_flush=-1),Ue;if(l===Kt&&(t===Oe?Ne(n):t!==ze&&(Ee(n,0,0,!1),t===Ve&&(_t(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Mt(e),0===e.avail_out))return n.last_flush=-1,Ue}return t!==je?Ue:n.wrap<=0?qe:(2===n.wrap?(Bt(n,255&e.adler),Bt(n,e.adler>>8&255),Bt(n,e.adler>>16&255),Bt(n,e.adler>>24&255),Bt(n,255&e.total_in),Bt(n,e.total_in>>8&255),Bt(n,e.total_in>>16&255),Bt(n,e.total_in>>24&255)):(Rt(n,e.adler>>>16),Rt(n,65535&e.adler)),Mt(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Ue:qe)},ei=function(e){if(!e||!e.state)return Ge;var t=e.state.status;return t!==vt&&t!==yt&&t!==bt&&t!==Dt&&t!==kt&&t!==Ct&&t!==xt?Ft(e,Ge):(e.state=null,t===Ct?Ft(e,$e):Ue)},ti=function(e,t){var i=t.length;if(!e||!e.state)return Ge;var a=e.state,n=a.wrap;if(2===n||1===n&&a.status!==vt||a.lookahead)return Ge;if(1===n&&(e.adler=Ie(e.adler,t,i,0)),a.wrap=0,i>=a.w_size){0===n&&(_t(a.head),a.strstart=0,a.block_start=0,a.insert=0);var o=new Uint8Array(a.w_size);o.set(t.subarray(i-a.w_size,i),0),t=o,i=a.w_size}var r=e.avail_in,s=e.next_in,l=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,Ot(a);a.lookahead>=pt;){var d=a.strstart,c=a.lookahead-(pt-1);do a.ins_h=Lt(a,a.ins_h,a.window[d+pt-1]),a.prev[d&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=d,d++;while(--c);a.strstart=d,a.lookahead=pt-1,Ot(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=pt-1,a.match_available=0,e.next_in=s,e.input=l,e.avail_in=r,a.wrap=n,Ue},ii=Yt,ai=Xt,ni=Jt,oi=Wt,ri=Qt,si=Zt,li=ei,di=ti,ci="pako deflate (from Nodeca project)",hi={deflateInit:ii,deflateInit2:ai,deflateReset:ni,deflateResetKeep:oi,deflateSetHeader:ri,deflate:si,deflateEnd:li,deflateSetDictionary:di,deflateInfo:ci},ui=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},pi=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!==r(i))throw new TypeError(i+"must be non-object");for(var a in i)ui(i,a)&&(e[a]=i[a])}}return e},gi=function(e){for(var t=0,i=0,a=e.length;a>i;i++)t+=e[i].length;for(var n=new Uint8Array(t),o=0,r=0,s=e.length;s>o;o++){var l=e[o];n.set(l,r),r+=l.length}return n},fi={assign:pi,flattenChunks:gi},mi=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(vi){mi=!1}for(var yi=new Uint8Array(256),bi=0;256>bi;bi++)yi[bi]=bi>=252?6:bi>=248?5:bi>=240?4:bi>=224?3:bi>=192?2:1;yi[254]=yi[254]=1;var Di=function(e){var t,i,a,n,o,r=e.length,s=0;for(n=0;r>n;n++)i=e.charCodeAt(n),55296===(64512&i)&&r>n+1&&(a=e.charCodeAt(n+1),56320===(64512&a)&&(i=65536+(i-55296<<10)+(a-56320),n++)),s+=128>i?1:2048>i?2:65536>i?3:4;for(t=new Uint8Array(s),o=0,n=0;s>o;n++)i=e.charCodeAt(n),55296===(64512&i)&&r>n+1&&(a=e.charCodeAt(n+1),56320===(64512&a)&&(i=65536+(i-55296<<10)+(a-56320),n++)),128>i?t[o++]=i:2048>i?(t[o++]=192|i>>>6,t[o++]=128|63&i):65536>i?(t[o++]=224|i>>>12,t[o++]=128|i>>>6&63,t[o++]=128|63&i):(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63,t[o++]=128|i>>>6&63,t[o++]=128|63&i);return t},ki=function(e,t){if(65534>t&&e.subarray&&mi)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var i="",a=0;t>a;a++)i+=String.fromCharCode(e[a]);return i},Ci=function(e,t){var i,a,n=t||e.length,o=new Array(2*n);for(a=0,i=0;n>i;){var r=e[i++];if(128>r)o[a++]=r;else{var s=yi[r];if(s>4)o[a++]=65533,i+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&n>i;)r=r<<6|63&e[i++],s--;s>1?o[a++]=65533:65536>r?o[a++]=r:(r-=65536,o[a++]=55296|r>>10&1023,o[a++]=56320|1023&r)}}}return ki(o,a)},xi=function(e,t){t=t||e.length,t>e.length&&(t=e.length);for(var i=t-1;i>=0&&128===(192&e[i]);)i--;return 0>i?t:0===i?t:i+yi[e[i]]>t?i:t},wi={string2buf:Di,buf2string:Ci,utf8border:xi},Ki=s,Si=Object.prototype.toString,Ii=Le.Z_NO_FLUSH,Pi=Le.Z_SYNC_FLUSH,Fi=Le.Z_FULL_FLUSH,Ti=Le.Z_FINISH,_i=Le.Z_OK,Ai=Le.Z_STREAM_END,Li=Le.Z_DEFAULT_COMPRESSION,Mi=Le.Z_DEFAULT_STRATEGY,Ei=Le.Z_DEFLATED;l.prototype.push=function(e,t){var i,a,n=this.strm,o=this.options.chunkSize;if(this.ended)return!1;for(a=t===~~t?t:t===!0?Ti:Ii,"string"==typeof e?n.input=wi.string2buf(e):"[object ArrayBuffer]"===Si.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(o),n.next_out=0,n.avail_out=o),(a===Pi||a===Fi)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=hi.deflate(n,a),i===Ai)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=hi.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===_i;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){e===_i&&(this.result=fi.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Bi=c;e.ziblib_plugin={gzip:Bi}}(window),define("gzipcompressor",function(){});var KD=KD||{currentWin:window};KD.enumerables=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"],KD.EnumGolbalOperation={NormalBiz:0,CloseRootClick:1,DoLogout:2},KD.CONST=KD.CONST||{SimulateMacAddress:"SimulateMacAddress",SimulateIpAddress:"SimulateIpAddress"},KD.NotClearCacheKeys=[KD.CONST.SimulateMacAddress,KD.CONST.SimulateIpAddress],KD.isLoginByValidationCode=function(){var e=$("#grid_VelidationCode");if(0==e.length)return!1;var t=$("#grid_VelidationCode:visible");return t.length>0},KD.getAspNetSessionId=function(){return KD.getConnectConfig().aspNetSessionId||KD.cookie.read("ASP.NET_SessionId")||""},KD.getKDSessionId=function(){var e=KD.getConnectConfig().kdSessionId||KD.cookie.read("kdservice-sessionid")||KD.getQueryString("kdsid","")||"";return e},KD.getSSOArgs=function(){var e=KD.getConnectConfig().ssoResponseArguments||{};return e},KD.getEntryRoleConfig=function(){var e=$("#roleResConfig").val(),t=KD.parseObject(e);return t||{}},KD.isKDScriptBusy=function(e){return void 0!==e&&(KD.__kdScriptingRunningCount=(KD.__kdScriptingRunning||0)+(e?1:-1)),(KD.__kdScriptingRunning||0)>0},KD.GolbalOperation=KD.EnumGolbalOperation.NormalBiz,KD.IsHtml5LoginForSilverlight=!1,KD.getIsHtml5LoginForSilverlight=function(){var e=$("#IsHtml5LoginForSilverlight");return e.length&&e.length>0},KD.isGalaxyFormTheme=function(e){var t=e==KD.CONST.GalaxyFormThemeName;return t},KD.getRandomNum=function(e,t){var i=t-e,a=Math.random();return e+Math.round(a*i)},KD.getLocalValue=function(e,t){var i="",a=e||ClientAppProxy.Current.defaultLocalId||2052;if(t)if(KD.isArray(t))for(var n in t){var o=t[n];if(o.Key==a){i=o.Value;break}}else i=t;return i},KD.delayInvoke=function(e,t,i,a){return t&&t>50&&1e3>t&&(t=void 0),i?KD.delayInvoke.syncQueue.push({action:e,timeout:t,args:a}):KD.delayInvoke.queue.push({action:e,timeout:t,args:a}),KD.delayInvokeDoNext(),0},$.extend(KD.delayInvoke,{running:!1,queue:[],syncQueue:[]}),KD.delayInvokeDoNext=function(){if(KD.delayInvoke.queue.length>0&&0==KD.delayInvoke.running){var e=KD.delayInvoke.queue[0];KD.delayInvoke.queue.splice(0,1),KD.delayInvokeCore(e.action,e.timeout,!1,e.args)}if(KD.delayInvoke.syncQueue.length>0){var e=KD.delayInvoke.syncQueue[0];KD.delayInvoke.syncQueue.splice(0,1),KD.delayInvokeCore(e.action,e.timeout,!0,e.args)}},KD.delayInvokeCore=function(e,t,i,a){i||(KD.delayInvoke.running=!0);var n=e,o=a,r=setTimeout(function(){try{clearTimeout(r),n&&n(o)}catch(e){KD.writeLog(e.message,e.stack,!0)}finally{n=void 0,o=void 0,KD.delayInvoke.running=!1,clearTimeout(r),delete r,KD.delayInvokeDoNext()}},t||5)},KD.debounce=function(e,t){var i=null;return function(a){var n=this;clearTimeout(i),i=setTimeout(function(){e&&e.call(n,a)},t||0)}},KD.throttle=function(e,t){var i=null;return function(a){if(!i){var n=this;i=setTimeout(function(){e&&e.call(n,a),i=null},t||0)}}},KD.isCoveredInElement=function(e,t){if(!KD.isEmpty(e)&&!KD.isEmpty(t)&&(e=e instanceof jQuery?e:e instanceof HTMLElement?$(e):null,t=t instanceof jQuery?t:t instanceof HTMLElement?$(t):null,null!==e&&null!==t&&0!=e.length&&0!=t.length)){var i=e.offset(),a=t.offset(),n=e.width(),o=e.height(),r=t.outerWidth(),s=t.outerHeight();if(a.left>=i.left&&a.left<i.left+n){if(a.top>=i.top&&a.top<i.top+o)return!0;if(a.top<i.top&&a.top+s>i.top)return!0}else if(a.left+r>=i.left&&a.left+r<i.left+n){if(a.top>=i.top&&a.top<i.top+o)return!0;if(a.top<i.top&&a.top+s>i.top)return!0}else if(a.left<=i.left&&a.left+r>=i.left+n&&a.top<=i.top&&a.top+s>=i.top)return!0;return!1}},KD.setInterval=function(e,t,i){var a=0;return a=setInterval(e,t),i&&KD.writeLog("setInterval",i+"::"+(KD.isString(e)?e:"function"),!0),a},KD.printAllControls=function(){if(KD.isDebug()){var e={k3cloudmin:"k3cloud.min",k3jquerymin:"k3jquery.min",json2:"thirdpart/json2",jqueryk3cloudex:"thirdpart/jquery/jqueryk3cloudex",jsxcompressor:"thirdpart/jsxcompressor.min",jqxml2JSON:"thirdpart/jquery/jquery.xml2JSON",svg:"thirdpart/svg/svg",mfAjax:"thirdpart/mindfusionWorkFlow/MicrosoftAjax",mfMD:"thirdpart/mindfusionWorkFlow/MindFusion.Diagramming",mfFN:"thirdpart/mindfusionWorkFlow/FlowNode",mfOCN:"thirdpart/mindfusionWorkFlow/OrgChartNode",fullcalendarmonent:"thirdpart/fullcalendar/moment.min",fullcalendar:"thirdpart/fullcalendar/fullcalendar.min",fullcalendarLang:"thirdpart/fullcalendar/lang/lang.min","jqzoom-core-pack":"thirdpart/jquery.jqzoom-core-pack",fusioncharts:"thirdpart/fusioncharts/fusioncharts",fusioncharts_charts:"thirdpart/fusioncharts/fusioncharts.charts",fusioncharts_theme_zune:"thirdpart/fusioncharts/themes/fusioncharts.theme.zune"},t=getKDResConfig().paths,i=(KDControlFactoryProxy.types,[]);$.each(t,function(a){var n=t[a];if(!e[a]){var o={key:a,path:n,xtype:""},r=window[a];r&&$.extend(o,{xtype:r.xtype||""}),i.push(o)}});var a="<table><THead><tr><th>SEQ</th><th>XTYPE</th><th>KEY</th><th>Remark</th></tr></THead><TBody>",n=0;$.each(i,function(e){var t=i[e];n++,a=a+"<tr><td>H5Kendo-"+n+"</td><td>"+(t.xtype||"")+"</td><td>"+t.key+"</td><td>"+t.path+"</td></tr>"}),a+="</tbody></table>",KD.writeLog("All Controls",a,!0)}},KD.showMessage=function(e){var t="body form div:eq(0)",i=$("#printMessage"),a=function(){window.print_th=setTimeout(function(){"true"!=$("#printMessage").attr("data-ismouseon")&&(window.print_th&&clearTimeout(window.print_th),window.print_th=void 0,$("#printMessage").remove())},5e3)};if(i&&i.length)i.text(e);else{var n="padding: 8px 40px;background:url(../images/error.png) no-repeat 5px 8px;",o="padding:border:1px lightgray; font-size:1em;";$('<div style="'+n+'" id="printMessage"><span style="'+o+'">'+e+"</span></div>").insertBefore($(t)),$("#printMessage").mouseover(function(e){$(this).attr("data-ismouseon",!0)}).mouseout(function(e){$(this).attr("data-ismouseon",!1),a()})}a()},KD.getWaitToDevelop=function(e){return'<div style="color:gray;font-size:16px;text-align:center;top:25%;position:relative;">'+e+ResManager.LoadKDString("研发中! <br>如急需使用请转用桌面GUI客户端或<br>Silverlight浏览器端使用相关功能.","099002000000013")+"</div>"},function(e){e.keyBoard={isFuncKey:function(e){var t=!(e>=48&&57>=e||e>=65&&90>=e||e>=96&&111>=e||32==e||13==e||8==e);return t}}}(KD),function(e){e.dock={None:0,Top:1,Bottom:2,Left:3,Right:4,Fill:5,FieldSet:6},e.layout={existChildDock:function(t){var i=!1,a=t.items;if($.isArray(a))for(var n=0;n<a.length;n++){i=a[n]&&a[n].dock!=e.dock.None;break}return i},isFillDock:function(t){var i=t.dock&&t.dock==e.dock.Fill;return i},isVerDock:function(t){var i=t.dock&&(t.dock==e.dock.Fill||t.dock==e.dock.Left||t.dock==e.dock.Right);return i},isHorDock:function(t){var i=t.dock&&(t.dock==e.dock.Fill||t.dock==e.dock.Top||t.dock==e.dock.Bottom);return i},isDock:function(t){var i=t.dock&&t.dock!=e.dock.None;return i},isFieldSet:function(t){var i=t.dock&&t.dock==e.dock.FieldSet;return i},getInlineStyle:function(e){var t={},i=e.InlineStyle||e.inlineStyle||{};return i.MarginLeft&&$.extend(t,{"margin-left":parseInt(i.MarginLeft)}),i.MarginRight&&$.extend(t,{"margin-right":parseInt(i.MarginRight)}),t},kdRangeSize2HTMLRangeSize:function(e){if(!e)return e;var t=(e||"").split(","),i="";if(t.length>1){for(var a=1;a<t.length;a++)i+=t[a]+",";i+=t[0]}return 1==t.length&&(i=t[0]+","+t[0]+","+t[0]+","+t[0]),i},getRangeSizeStyleValue:function(t,i){var a={},n=e.layout.getRangeSize(i);switch(n.defindedCount){case 1:a[t]=n.top+"px";break;case 2:a[t]=n.top+"px "+n.right+"px";break;case 4:a[t]=n.top+"px "+n.right+"px "+n.bottom+"px "+n.left+"px"}return a},getRangeSize:function(e){var t={top:0,right:0,bottom:0,left:0};if(e){var i=(e||"").replace(/px/g,"").split(/[\s\,]/);switch(t.defindedCount=i.length,i.length){case 1:var a=parseInt(i[0]);isNaN(a)||$.extend(t,{top:a,right:a,bottom:a,left:a});break;case 2:var n=parseInt(i[0]),o=parseInt(i[1]);isNaN(n)||isNaN(o)||$.extend(t,{top:n,right:o,bottom:n,left:o});break;case 4:var n=parseInt(i[0]),o=parseInt(i[1]),r=parseInt(i[2]),s=parseInt(i[3]);isNaN(n)||isNaN(o)||isNaN(r)||isNaN(s)||$.extend(t,{top:n,right:o,bottom:r,left:s})}}return t},getTargetRangeProp:function(t,i){var a="";if(t&&i)if(e.isChrome())a=t.css(i);else switch(i){case"margin":case"padding":a=t.css(i+"-top")+","+t.css(i+"-right")+","+t.css(i+"-bottom")+","+t.css(i+"-left");break;case"border":case"border-width":a=t.css("border-top-width")+","+t.css("border-right-width")+","+t.css("border-bottom-width")+","+t.css("border-left-width")}return a},isPixelValue:function(t){return!e.isNaN(parseInt(t||"").toString().replace("px",""))},setCtOrientation:function(e,t){e&&(e.ctOrientation=t)},setOrientation:function(e,t,i){e&&(e.orientation=t,i&&(e.fixedSize=i))},setAbsolute:function(t,i){var a={};if("kdform"==i.xtype){var n=e.layout.getInlineStyle(i);t.css(n)}if(i.isNoneAbsPosition||KDFlowlayoutProxy.isFlowlayoutChild(i)){if(KDFlowlayoutProxy.getCtOrientation(i)||$.extend(a,{"float":"left"}),i.height){var o=KDFlowlayoutProxy.getHeight(t,i);a.height=o,KDFlowlayoutProxy.isInVertical(i)&&(i.isNeedAutoHeight=!0)}i.width&&(a.width=KDFlowlayoutProxy.getItemWidth(t,i)),"kdform"==i.xtype&&(i.width>a.width&&(a.width=i.width),i.height>a.height&&(a.height=i.height))}else i.dock&&i.dock!=e.dock.None||($.extend(a,{position:"absolute",display:"inline-block","float":"left"}),i.dock!=e.dock.FieldSet&&i.xtype&&"kditemcontainer"==i.xtype&&(a.display="inline-flex"),void 0!=i.height&&(a.height=i.height),void 0!=i.width&&(a.width=i.width),void 0!=i.x&&(a.left=e.layout.getZoomInPx(i.x)),void 0!=i.y&&(a.top=e.layout.getZoomInPx(i.y)));var n=e.layout.getInlineStyle(i);$.extend(a,n),a.width>0&&"kditemcontainer"==i.xtype&&i.dock==e.dock.None&&i.width>0&&(a["max-width"]=a.width,delete a.width),t.css(a)},getZoomInPx:function(e){if(void 0===e)return e;var t=parseInt($(document.body).css("font-size"));return t=isNaN(t)?12:t,(e||0)*(t/12)},getStyleSize:function(e){var t=e instanceof jQuery?e[0]:e;return t?{height:t.style.height,width:t.style.width}:{height:"0px",width:"0px"}},getActualSize:function(t){var i={width:e.layout.getActualWidth(t),height:e.layout.getActualHeight(t)};return i},isRelativeWidth:function(t){if(!t||!$.isFunction(t.css))return!0;var i=e.layout.getStyleSize(t).width;return"0px"==i||i.indexOf("%")>0||"auto"==i||""==i},getCssWidth:function(t,i){if(!t||!$.isFunction(t.css))return"";var a=t.css("width"),n=parseInt(i)||0;return e.layout.isRelativeWidth(t)||(a=t.width()+n+"px"),a},isRelativeHeight:function(t){if(!t||!$.isFunction(t.css))return!0;var i=e.layout.getStyleSize(t).height;return"0px"==i||"auto"==i||i.indexOf("%")>0},getCssHeight:function(t,i){if(!t||!$.isFunction(t.css))return"";var a=t.css("height"),n=parseInt(i)||0;return e.layout.isRelativeHeight(t)||(a=t.height()+n+"px"),a},getActualWidth:function(t){var i=0,a=t.parent();return i=a.length?e.layout.isRelativeWidth(t)?e.layout.getActualWidth(a):"tabPanel"==t[getPropName()]("ctrlrole")?e.layout.getActualWidth(a):t.outerWidth(!1)||e.layout.getActualWidth(a):t.width()},getActualHeight:function(t){var i=0,a=t.parent();return i=a.length?e.layout.isRelativeHeight(t)?e.layout.getActualHeight(t.parent()):"tabPanel"==t[getPropName()]("ctrlrole")?e.layout.getActualHeight(t.parent()):t.outerHeight(!1)||e.layout.getActualHeight(t.parent()):t.height()},getInnerSize:function(t){var i={},a=e.layout.getActualSize(t),n=e.layout.getRangeSize(e.layout.getTargetRangeProp(t,"padding"));return i={width:a.width-n.left-n.right,height:a.height-n.top-n.bottom}},getChildSize:function(t,i){var a={},n=t==i,o={left:0,right:0,top:0,bottom:0},r=e.layout.getActualSize(t);if(!n&&i&&i.length){var s=o;t&&t.length&&(s=e.layout.getRangeSize(e.layout.getTargetRangeProp(t,"padding")));
var l=e.layout.getRangeSize(e.layout.getTargetRangeProp(i,"margin")),d=e.layout.getRangeSize(e.layout.getTargetRangeProp(i,"padding")),c={height:s.top+s.bottom+d.top+d.bottom+l.top+l.bottom,width:s.left+s.right+d.left+d.right+l.left+l.right},h={width:r.width-c.width,height:r.height-c.height},u={width:r.width,height:r.height};$.extend(a,{targetOption:h,containerOption:u})}else{var p={width:r.width,height:r.height};$.extend(a,{targetOption:p,containerOption:p})}return a},getRealStyleNumberProp:function(t,i,a,n){var n=n||"initial",o="height"==i?e.layout.isRelativeHeight(t):"width"==i?e.layout.isRelativeWidth(t):(t?t.css(i):"100%").indexOf("px")<1,r="height"==i?e.layout.getCssHeight(t):"width"==i?e.layout.getCssWidth(t):t?t.css(i):"100%";return r?o||(r=t[i]()-(a||0)):r=n,r},getDockFramework:function(t){var i=$('<div data-layouttype="DockFrameWork"></div>');KDLayout.isNeedFixed&&(i=$('<div data-layouttype="DockFrameWork" style="width:100%;height:100%"></div>')),i.fw={layoutConfig:{applyDefaultStyles:!1,panes:{resizeChildren:!1,resizerDblClickToggle:!1,autoResize:!1,resizerDragOpacity:1},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}}};for(var a in t.items){var n=t.items[a];if(n.dock==e.dock.Fill&&(i.fw[e.dock.Fill]=$('<div class="ui-layout-center" style="width:100%;height:100%"></div>').appendTo(i)),n.dock==e.dock.Top){var o=$('<div class="ui-layout-north" style="width:100%"></div>').appendTo(i);i.fw.layoutConfig.north.size=n.height,i.fw[e.dock.Top]=o}if(n.dock==e.dock.Bottom){var r=$('<div class="ui-layout-south" style="width:100%"></div>').appendTo(i);i.fw.layoutConfig.south.size=n.height,i.fw[e.dock.Bottom]=r}if(n.dock==e.dock.Left){var s=$('<div class="ui-layout-east" style="height:100%"></div>').appendTo(i);i.fw.layoutConfig.east.size=n.width,i.fw[e.dock.Left]=s}if(n.dock==e.dock.Right){var l=$('<div class="ui-layout-west" style="height:100%"></div>').appendTo(i);i.fw.layoutConfig.west.size=n.width,i.fw[e.dock.Right]=l}}return i.fw[e.dock.Fill]||(i.fw[e.dock.Fill]=$('<div class="ui-layout-center" style="width:100%;height:100%"></div>').appendTo(i)),i},setInnerDFormSize:function(t,i){var a=5,n=5,o=i||t.childForm;if(o){var r=o.getControl.call(o);ctEl=t.getControl.call(t);var s={},l=o.dformConfig;if(KDFlowlayoutProxy.isInVertical(l)){var d=e.layout.getRangeSize(e.layout.getTargetRangeProp(r,"margin")),c=e.layout.getRangeSize(e.layout.getTargetRangeProp(r,"border-width")),h=e.layout.getRangeSize(e.layout.getTargetRangeProp(ctEl,"padding")),u=e.layout.getActualWidth(t.el)-d.left-d.right-c.left-c.right-h.left-h.right;s={width:u}}else if(KDFlowlayoutProxy.isFlowlayoutChild(l))s={height:KDFlowlayoutProxy.getItemHeight(r,l),width:KDFlowlayoutProxy.getItemWidth(r,l),position:"relative","float":"none"};else if(!KDFlowlayoutProxy.isFlowlayoutChild(l)){var d=e.layout.getRangeSize(e.layout.getTargetRangeProp(r,"margin")),c=e.layout.getRangeSize(e.layout.getTargetRangeProp(r,"border-width")),h=e.layout.getRangeSize(e.layout.getTargetRangeProp(ctEl,"padding")),u=e.layout.getActualWidth(ctEl)-d.left-d.right-c.left-c.right-h.left-h.right,p=e.layout.getActualHeight(ctEl)-d.top-d.bottom-c.top-c.bottom-h.top-h.bottom;s={height:p-n,width:u-a}}r.css(s)}},getFluidColumnCount:function(){for(var t=e.lastWidth>1342?7:3,i=e.cookieLanguageId(),a={ranges:[{r:[300,780],n:1},{r:[780,1e3],n:2},{r:[1e3,1342],n:3},{r:[1342,1921],n:4},{r:[1921,2208],n:5},{r:[2208,2576],n:6},{r:[2576,9999],n:7}]},n={ranges:[{r:[300,780],n:1},{r:[780,1e3],n:2},{r:[1e3,1342],n:3},{r:[1342,9999],n:5}]},o=20521==i?n:a,r=0;r<o.ranges.length;r++){var s=o.ranges[r];if(e.lastWidth>s.r[0]&&e.lastWidth<s.r[1]){t=s.n;break}}return t},setParentTabControlInfo:function(e,t){e&&(e.parentTabControlKey=t.parentTabKey,e.parentTabItemKey=t.id,e.parentTabItemTitle=t.title)},setItemTabControlKey:function(e,t){e&&(e.parentTabKey=t)}}}(KD),KD.checkGolbalOperation=function(e){if(e||KD.GolbalOperation==KD.EnumGolbalOperation.DoLogout){KD.GolbalOperation=KD.EnumGolbalOperation.NormalBiz;var t=ClientAppProxy.Current.getLogoffPage();KD.redirection(t)}},KD.applyGolbalFontName=function(){var e=ClientAppProxy.Current.getGolbalFontName();e&&$(document.body).css({"font-family":e})},KD.setAttachmentData=function(e,t){var i="id:"+t.id+",xtype:"+t.xtype+",dock:"+t.dock+",zindex:"+KD.getValue(t,"zindex",0)+",tabIndex:"+KD.getValue(t,"tabIndex",0),a={id:t.id,xtype:t.xtype,dock:t.dock,zindex:KD.getValue(t,"zindex",0),tabIndex:KD.getValue(t,"tabIndex",0)};t.orientation&&(delete a.dock,KD.layout.setOrientation(a,t.orientation,t.fixedSize)),t.ctOrientation&&KD.layout.setCtOrientation(a,t.ctOrientation),i=KD.stringify(a),e["data-attdata"]=i,e[getPropName()]("data-attdata",i),e.attr&&!e.attr("data-attdata")&&e.attr("data-attdata",i)},KD.getAttachmentData=function(e){var t=void 0;try{var i=e[getPropName()]("data-attdata");t=KD.parseObject(i)}catch(a){t={}}return t},KD.getParentPosition=function(e){var t=e.parent(),i=t.css("position");return KD.isEmpty(i)||"initial"==i?KD.getParentPosition(t):i},KD.setPositionInitial=function(e){var t=this.clientPlatform;t.browser&&t.browser.ie>0?e.css({position:this.getParentPosition(e)}):e.css({position:"initial"})},KD.parseObject=function(str){var ret=[];try{if("string"==typeof str)if(JSON&&KD.isFunction(JSON.parse))try{ret=str?JSON.parse(str.replace(/\'/g,'"')):void 0}catch(ex){ret=str?eval("("+str+")"):void 0}else ret=str?eval("("+str+")"):void 0;else ret=str}catch(ex){var a=ex}return ret},KD.cloneObject=function(e){return KD.parseObject(KD.stringify(e))},KD.setHtml=function(e,t){KD.isThreatText(t)?(KD.delayInvoke(function(){var t="targetId="+e[getPropName()]("id");KD.writeLog("threat text",t)},2e3,!0),e.text(t)):e.html(t)},KD.isThreatText=function(e){return/\<\s{0,}script/g.test((e||"").toLowerCase())||/<.{1,}[a-z]{4,}.{1,}>/g.test((e||"").toLowerCase())||/\<\s{0,}iframe/g.test((e||"").toLowerCase())||/\<\s{0,}marquee/g.test((e||"").toLowerCase())||/\.cookie/g.test((e||"").toLowerCase())||/\<\s{0,}img/g.test((e||"").toLowerCase())},KD.stringify=function(e){var t=JSON.stringify(e);return t},KD.isValidProp=function(e,t){var i=KD.isEmpty(e)?!1:!(void 0===e[t]||null===e[t]);return i},KD.toReallyPrecision=function(e,t){var i=KD.isNumber(e)?e:parseFloat(e.replace(/,/g,"")),a=/[.0]0*$/;if(KD.isNaN(i))return(e||"").toString().indexOf(".")<0?e:(e||"").toString().replace(a,"");var n=KD.numInfo.formatNumber(i,t,"D");if(n.indexOf(".")<0)return n;var o=n.replace(a,"");return o},KD.ToGroupAggregateStr=function(e,t){return KD.toReallyPrecision(e,t)},KD.dateDiff=function(e,t,i){var a=KD.DateDiffCore(e,t),n=0;return n="H+"==i?KD.format("{0}:{1}:{2}.{3}",a.TotalHours,a.TotalMinutes,a.TotalSeconds,a.Milliseconds):"milliseconds"==i?a.Milliseconds:"second"==i?a.TotalSeconds:"minute"==i?a.TotalMinutes:"hour"==i?a.TotalHours:a.TotalSeconds},KD.DateDiffCore=function(e,t){var i={},a=Math.abs(e-t);return i.Days=parseInt(a/1e3/60/60/24),i.TotalHours=parseInt(a/1e3/60/60),i.Hours=i.TotalHours%24,i.TotalMinutes=parseInt(a/1e3/60),i.Minutes=i.TotalMinutes%60,i.TotalSeconds=parseInt(a/1e3),i.Seconds=i.TotalSeconds%60,i.TotalMilliseconds=a,i.Milliseconds=a%1e3,i},KD.getReqBETimeString=function(e){var t=new Date,i={},a="";try{var n="";if(e){var o=new Date,r=(KD.parseObject(e).time||"").replace(".",":").split(":");r.length>0&&o.setHours(r[0]),r.length>1&&o.setMinutes(r[1]),r.length>2&&o.setSeconds(r[2]),r.length>3&&o.setMilliseconds(r[3]),n=(KD.dateDiff(t,o,"H+")||"").replace(/NaN/g,"0")}i={time:KD.format("{0}:{1}:{2}.{3}",t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds().toString()),duration:n},KD.isEmpty(n)&&delete i.duration}catch(s){i=""}finally{a=KD.stringify(i)}return a},KD.arraySort=function(e,t,i){if(!KD.isArray(e))return e;var a=window[t||"parseInt"];return i=void 0===i||i,e.sort(function(e,t){return i?a(e)>a(t):a(e)<a(t)})},KD.quickSort=function(e,t){if(!(null==e||void 0==e||e.length<=0)){var i=0,a=e.length-1,n=function(t,i,a){if(t!=i){for(var o=e[t],r=t,s=i;i>t;){var l=e[i][a]||-1,d=o[a]||-1;if(l>=d)i--;else for(e[t]=e[i];i>++t;){var c=e[t][a]||-1;if(c>d){e[i]=e[t];break}}}if(r==t)return void n(++t,s,a);e[t]=o,n(r,t,a),n(i,s,a)}};return n(i,a,t),e}},KD.quickSortByType=function(e,t,i,a){if(!(null==e||void 0==e||e.length<=0)){var n=0,o=e.length-1,r=-1;"string"==i?r="":"number"==i?r=Number.NEGATIVE_INFINITY:"date"===i&&(r=Number.NEGATIVE_INFINITY);var s,l="";KD.isEmpty(a)||(l=KD.getValue(a,"fieldNameExtend",""),s=a.dataIndex);var d=function(e,t,a){var n;n=KD.isEmpty(l)?KD.getValue(e,t,a):KD.getValue(e,t+l,KD.getValue(e,t,a));var o=n;try{"string"==i?o=n+"":"number"==i&&(KD.isEmpty(n)||KD.isNumber(n)||KD.isString(n)?o=KD.isEmpty(n)?Number.NEGATIVE_INFINITY:n:KD.isEmpty(s)||(s=parseFloat(s),KD.isNaN(s)||(o=n[s])))}catch(r){KD.writeLog("GetValueByType erroe :",r,!0),o=n}return o},c=function(e,t){var a=!1,n=0;if("string"==i&&e&&e.localeCompare){e+="",t+="";var o=e.substring(0,1),r=t.substring(0,1);a=KD.checkChinese(o)&&KD.checkChinese(r),n=a?e.localeCompare(t,"zh-Hans-CN"):e>t?1:e==t?0:-1}else if("number"==i){var s=parseFloat(e),l=parseFloat(t);e=KD.isNaN(s)?Number.NEGATIVE_INFINITY:s,t=KD.isNaN(l)?Number.NEGATIVE_INFINITY:l,n=e>t?1:e==t?0:-1}else if("date"==i)try{if(e==Number.NEGATIVE_INFINITY)n=-1;else if(t==Number.NEGATIVE_INFINITY)n=1;else{var e=kendo.parseDate(e)||Number.NEGATIVE_INFINITY,t=kendo.parseDate(t)||Number.NEGATIVE_INFINITY;n=e>t?1:e==t?0:-1}}catch(d){KD.writeLog("KD.quickSortByType Date type error :",d,!0),n=-1}else n=e>t?1:e==t?0:-1;return n},h=function(t,i,a){if(t!=i){for(var n=e[t],o=t,s=i;i>t;){var l=d(e[i],a,r),u=d(n,a,r);if(c(l,u)>=0)i--;else for(e[t]=e[i];i>++t;){var p=d(e[t],a,r);if(c(p,u)>0){e[i]=e[t];break}}}if(o==t)return void h(++t,s,a);e[t]=n,h(o,t,a),h(i,s,a)}};return h(n,o,t),e}},KD.isUrl=function(e){var t="^((https|http|ftp|rtsp|mms)://)(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)",i=new RegExp(t);return i.test(e.toLowerCase())?!0:!1},KD.getVersion=function(){return(KD.getConnectConfig().resVer||"").replace(/\?ver=/gi,"")},KD.getActiveElement=function(e){var t=null;try{t=document.activeElement||(document.documentElement?document.documentElement.activeElement:null)}catch(i){t=null}return KD.isEmpty(e)||KD.isEmpty(e.relatedTarget)||(t=e.relatedTarget),t=KD.isEmpty(t)?null:$(t)},KD.getImageUrlByNameAndVersion=function(e){var t="";return e&&(t=KD.isUrl(e)?e+"?version="+KD.getVersion():"content/themes/images/"+e+"?version="+KD.getVersion()),t},KD.isFirefox=function(){if(void 0==KD.runInFirefox){var e=KD.getCurrentBrowsType();KD.runInFirefox=e.type==KD.CONST.BrowsType.FireFox}return KD.runInFirefox},KD.isChrome=function(){if(void 0==KD.runInChrome){var e=KD.getCurrentBrowsType();KD.runInChrome=e.type==KD.CONST.BrowsType.Chrome}return KD.runInChrome},KD.isX64=function(){var e=((navigator.userAgent.match(/x64/i)||[]).length||0)>0;return e},KD.isInnerWebBrowser=function(){var e=KD.equalsIgnoreCase(KD.getEntryRole(),"InnerWebBrowser");return e},KD.obj2str=function(e){if(void 0==e)return"";var t=[];if("string"==typeof e)return'"'+e.replace(/([\"\\])/g,"\\$1").replace(/(\n)/g,"\\n").replace(/(\r)/g,"\\r").replace(/(\t)/g,"\\t")+'"';if("object"==typeof e){if(e.sort){for(var i=0;i<e.length;i++)t.push(KD.obj2str(e[i]));t="["+t.join()+"]"}else{for(var i in e)t.push('"'+i+'":'+KD.obj2str(e[i]));document.all&&!/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(e.toString)&&t.push("toString:"+e.toString.toString()),t="{"+t.join()+"}"}return t}return e.toString().replace(/\"\:/g,'":""')},KD.override=function(e,t){if(e.$isClass)e.override(t);else if("function"==typeof e)KD.apply(e.prototype,t);else{var i,a,n=e.self;if(n&&n.$isClass)for(i in t)t.hasOwnProperty(i)&&(a=t[i],"function"==typeof a&&(n.$className&&(a.displayName=n.$className+"#"+i),a.$name=i,a.$owner=n,a.$previous=e.hasOwnProperty(i)?e[i]:callOverrideParent),e[i]=a);else KD.apply(e,t)}return e},KD.apply=function(e,t,i){if(i&&KD.apply(e,i),e&&t&&"object"==typeof t){var a,n,o;for(a in t)e[a]=t[a];var r=KD.enumerables;if(r)for(n=r.length;n--;)o=r[n],t.hasOwnProperty(o)&&(e[o]=t[o])}return e},KD.extend=function(){var e=Object.prototype.constructor,t=function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])};return function(i,a,n){KD.isObject(a)&&(n=a,a=i,i=n.constructor!==e?n.constructor:function(){a.apply(this,arguments)}),a||KD.Error.raise({sourceClass:"Jw",sourceMethod:"extend",msg:"Attempting to extend from a class which has not been loaded on the page."});var o,r=function(){},s=a.prototype;return r.prototype=s,o=i.prototype=new r,o.constructor=i,i.superclass=s,s.constructor===e&&(s.constructor=a),i.override=function(e){KD.override(i,e)},o.override=t,o.proto=o,i.override(n),i.extend=function(e){return KD.extend(i,e)},i}}(),KD.stopPropagation=function(e){window.event&&(window.event.cancelBubble=!0),e.stopPropagation&&e.stopPropagation()},KD.writeLog=function(e,t,i){if(KD.isDebug()&&!i)ClientAppProxy.Current.writeLog(e,t);else if(console&&console.error)return console.log(e+(t?","+t:"")),!0},KD.writeLogTime=function(e,t,i){var a=new Date,n=a.getMilliseconds(),o=a.getSeconds()+"."+n,r=a.getHours()+":"+a.getMinutes()+":"+o;return KD.writeLog(e+r,t,i)},KD.writeError=function(){var e=arguments&&arguments[0].message?arguments[0]:"",t=arguments?arguments[0]||"":"",i=arguments?arguments[1]||"":"";return e&&(t=e.message,i=e.stack),KD.isDebug(),console&&console.error?(t&&console.error(t+(i?"\r\n"+i:"")),!0):!1},KD.Error=function(){},KD.Error.raise=function(e){e.type&&e.type!=KDMessageBox.KDMesBoxType.Ok||(e.type=KDMessageBox.KDMesBoxType.Error),e.actions=[],KDMessageBox.show(e)},KD["debugger"]=function(e,t){KD.isDebug()&&void 0!==t&&t&&e&&KD.writeError({message:e})},KD.getFormUrl=function(e,t,i,a){var n="dform.aspx?formId="+e+"&formType="+t+"&pageId="+i+"&parentPageId="+a+"&usertoken="+KD.getUserToken();return n},KD.getUserToken=function(){var e=(ClientAppProxy.Current.CTX||{}).UserToken||$("#userToken").val()||KD.getConnectConfig().userToken||KD.getQueryString("usertoken","")||"";return e},KD.getDateShortCodeComparsionList=function(){return KD.CONST.DateShortCodeComparsionList=KD.CONST.DateShortCodeComparsionList||{Sun:ResManager.LoadKDString("周日","00214298000003878"),Mon:ResManager.LoadKDString("周一","00214298000004253"),Tue:ResManager.LoadKDString("周二","00214298000013594"),Wed:ResManager.LoadKDString("周三","00214298000003881"),Thu:ResManager.LoadKDString("周四","00214298000004256"),Fri:ResManager.LoadKDString("周五","00214298030033709"),Sat:ResManager.LoadKDString("周六","00214298030033710"),Sunday:ResManager.LoadKDString("周日","00214298000003878"),Monday:ResManager.LoadKDString("周一","00214298000004253"),Tuesday:ResManager.LoadKDString("周二","00214298000013594"),Wednesday:ResManager.LoadKDString("周三","00214298000003881"),Thursday:ResManager.LoadKDString("周四","00214298000004256"),Friday:ResManager.LoadKDString("周五","00214298030033709"),Saturday:ResManager.LoadKDString("周六","00214298030033710"),Jan:ResManager.LoadKDString("一月","00214298030033698"),Feb:ResManager.LoadKDString("二月","00214298000003873"),Mar:ResManager.LoadKDString("三月","00214298030033700"),Apr:ResManager.LoadKDString("四月","00214298000004249"),May:ResManager.LoadKDString("五月","00214298000003876"),Jun:ResManager.LoadKDString("六月","00214298000003877"),Jul:ResManager.LoadKDString("七月","00214298030033692"),Aug:ResManager.LoadKDString("八月","00214298000013581"),Sep:ResManager.LoadKDString("九月","00214298000003868"),Oct:ResManager.LoadKDString("十月","00214298000004243"),Nov:ResManager.LoadKDString("十一月","00214298000013584"),Dec:ResManager.LoadKDString("十二月","00214298030033697"),January:ResManager.LoadKDString("一月","00214298030033698"),February:ResManager.LoadKDString("二月","00214298000003873"),March:ResManager.LoadKDString("三月","00214298030033700"),April:ResManager.LoadKDString("四月","00214298000004249"),May:ResManager.LoadKDString("五月","00214298000003876"),June:ResManager.LoadKDString("六月","00214298000003877"),July:ResManager.LoadKDString("七月","00214298030033692"),August:ResManager.LoadKDString("八月","00214298000013581"),September:ResManager.LoadKDString("九月","00214298000003868"),October:ResManager.LoadKDString("十月","00214298000004243"),November:ResManager.LoadKDString("十一月","00214298000013584"),December:ResManager.LoadKDString("十二月","00214298030033697")},KD.CONST.DateShortCodeComparsionList},function(e){e.blocking=function(e){this.init(e)},e.blocking.prototype={init:function(e){this.progress=0,this.timeoutProcess,this.intervalProcess,this.targetId=e?e.id:"",this.text=e?e.text:""},getTarget:function(){var e=void 0;return this.targetId?(e=$("#"+this.targetId),e&&e.outerHeight(!0)||(e=$(document.body))):e=$(document.body),e},show:function(t){var i=this;i.init(t);var a=this.getTarget();if(!i.isExist(a)){var n=a.offset()||{left:0,top:0},o=a.outerHeight(!0)||$(document.body).outerHeight(!0),r=a.outerWidth(!0)||$(document.body).outerWidth(!0);loadingurl=e.getUrlRoot()+"/"+e.getSubPath()+"/content/themes/images/ui_loading.gif";var s=$('<div class="kd-ui-blockingExtention" style="left: '+n.left+"px; top: "+n.top+"px; width: "+r+"px; height: "+o+'px;">   <div class="kd-ui-blockingExtention-item kd-ui-blockingExtention-bg"></div>   <div class="kd-ui-blockingExtention-item">       <img src="'+loadingurl+'"></img>   </div></div>');a.hasClass("kdmainformbg")&&s.addClass("kd-ui-blockingExtention-fixed"),e.delayInvoke(function(e){i.isExist(a)||$(".kd-ui-blockingExtention").length>0||s.appendTo($(document.body)).show()},1)}},isExist:function(e){var t=e||this.getTarget(),i=t.find(".kd-ui-blockingExtention");return i.length>0?i:void 0},hide:function(t){var i=this;i.t=t,e.delayInvoke(function(e){i.doHideBlocking(i.t)},2)},doHideBlocking:function(t){var i=this;t||this.getTarget();e.delayInvoke(function(){var e=i.isExistAll.call(i,t);e||(e=$(".kd-ui-blockingExtention"),e.length>1),e&&e.remove()},500,!0)},isExistAll:function(e){var t=e||this.getTarget(),i=t.find(".kd-ui-blockingExtention");return 0==i.length&&(i=$(".kd-ui-blockingExtention")),i.length>0?i:void 0},text:function(e){},showDefault:function(e){var t=this;t.init(e),clearTimeout(t.timeoutProcess),clearInterval(t.intervalProcess),this.autoTimeout=setTimeout(function(){t.hideDefault.call(t)},1e4);var i=this.text||ResManager.LoadKDString("加载中，请稍候...","099002000002632");t.show({target:this.getTarget(),text:i})},__showTime:function(e){this.init(e);var t;0==this.progress?(t=this.text||ResManager.LoadKDString("加载中，请稍候... 30%","099002000000008"),this.text(this.getTarget(),t),progress=30):30==this.progress?(t=this.text||ResManager.LoadKDString("加载中，请稍候... 70%","0991733000004071"),this.text(this.getTarget(),t),progress=70):70==this.progress?(t=this.text||ResManager.LoadKDString("加载中，请稍候... 99%","0991733000004072"),this.text(this.getTarget(),t),progress=99):(this.hide(this.getTarget()),progress=0)},__showProgress:function(t){this.init(t),clearTimeout(this.timeoutProcess),clearInterval(this.intervalProcess);var i=this.text||ResManager.LoadKDString("加载中，请稍候... 0%","0991733000004073");this.show({target:this.getTarget(),text:i}),intervalProcess=e.setInterval("showTime()",2e3,"KD.blocking.__showProgress")},__hideDefault:function(){clearTimeout(this.autoTimeout),this.hide(this.getTarget())},__showTimeOut:function(e){var t=this;t.init(e),t.show({afterShow:function(){t.timeoutProcess=setTimeout(function(){clearTimeout(t.timeoutProcess),t.hide()},1e3)}})},__showSelfDefine:function(e){var t=this;t.init(e),clearTimeout(t.timeoutProcess),clearInterval(t.intervalProcess);var i=t.text||ResManager.LoadKDString("加载中，请稍候...","0991733000004074");t.show({target:t.getTarget(),addClass:"loading-indicator-bars",text:i,textTopOffest:-5})}}}(KD),KD.getRemoteXml=function(e,t){var i=document.createElement("iframe");i.src=e;var a=function(){KD.delayInvoke(function(){var e=$(i.contentDocument).text();t&&t(e),$(i).remove()})};i.attachEvent?i.attachEvent("onload",function(e){a(e)}):i.onload=function(e){a(e)},document.body.appendChild(i)},KD.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(e){for(var t,i=document.cookie,a=i?i.split(";"):[],n=0,o=a.length;o>n;n++)if(t=$.trim(a[n]).split("="),t[0]==e){var r="";try{r=decodeURIComponent(t[1])}catch(s){KD.writeError(s)}return r}return null},write:function(e,t,i){var a="",n="",o=!1,r=i||{},s=r.expires||null,l=$.type(s);"date"===l?n=s:"string"===l&&s>0&&(s=parseInt(s,10),l="number"),"number"===l&&(n=new Date,s>0?n.setDate(n.getDate()+s):(n.setFullYear(1970),o=!0)),n&&(a+=";expires="+(KD.isFunction(n.toUTCString)?n.toUTCString():n)),r.path&&(a+=";path="+r.path),r.domain&&(a+=";domain="+r.domain),r.secure&&(a+=";secure"),document.cookie=e+"="+(o?"":encodeURIComponent(t))+a},clear:function(e,t){var i=";",a=t||{};a.secure&&(i+="secure");var n=new Date;n.setSeconds(n.getSeconds()-60);var o=";expires="+n.toUTCString();document.cookie=e+"=v"+i+o+"; path=/",document.cookie=e+"=v"+i+o+";"},clearAll:function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)"ASP.NET_SessionId"!=e[t]&&KD.cookie.clear(e[t])}},$.cookie||($.cookie=function(e,t,i){var a=KD.cookie;if(null===t)a.clear(e);else{if(void 0===t)return a.read(e);a.write(e,t,i)}}),KD.stopBubble=function(e){e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0},KD.isObjectEmpty=function(e){return KD.IsNullOrWhiteSpace(KD.stringify(e).replace(/[{|}]/g,""))?!0:!1},KD.isSingleReq=function(){return KD.singleReq=KD.singleReq||KD.getQueryString("singlereq","",!0),"true"==(void 0===KD.singleReq?"false":KD.singleReq).toLowerCase()},KD.initClientParameters=function(){var e=KD.CONST.MinClientHeight,t=1024,i=$(window).height(),a=$(window).width();$.extend(KD,{clientAvailHeight:screen?screen.availHeight||e:e,clientAvailWidth:screen?screen.availWidth||t:t,clientVisualHeight:e>i?e:i,clientVisualWidth:t>a?t:a,clientMinHeight:e>i?e:i,clientMinWidth:t>a?t:a}),KD.clientDetaHeight=KD.clientMinHeight>700+KD.getBillHeadHeight()?KD.clientMinHeight-700-KD.getBillHeadHeight()-17:0,KD.setPluginsLogoffPage()},KD.getWindowHeight=function(e){var t=$(window).height();return KD.CONST.IsEnableMinClientHeight&&(window.screen.height<=KD.CONST.EnableSmallScreenCriticalValue||e)&&t<KD.CONST.MinClientHeight&&(t=KD.CONST.MinClientHeight),t},KD.getWindowWidth=function(e){var t=$(window).width();return e&&t<KD.CONST.MinClientWidth&&(t=KD.CONST.MinClientWidth),t},KD.isSingleMode=function(){return KD.isEmpty(KD.CONST.IsSingleMode)&&(KD.equalsIgnoreCase((KD.getConnectConfig().custParam||{}).OpenMode,"single")?KD.CONST.IsSingleMode=!0:KD.CONST.IsSingleMode=!1),KD.CONST.IsSingleMode},KD.isMainConsoleFormIdForSingleMode=function(e){var t=!1;return void 0==KD.CONST.MainConsoleFormIdForSingleMode&&(KD.CONST.MainConsoleFormIdForSingleMode=(KD.getConnectConfig().custParam||{}).FormId||""),KD.equalsIgnoreCase(KD.CONST.MainConsoleFormIdForSingleMode,e)&&(t=!0),t},KD.getMainConsoleBillFootHeight=function(){return 66},KD.getBillHeadHeight=function(e){var t=86;KD.equalsIgnoreCase((KD.getConnectConfig().custParam||{}).OpenMode,"single")&&(t=0);var i=2;if(!KD.mainConcleHeadAndMainTabTitleHeight&&ClientAppProxy&&ClientAppProxy.Current){var a=ClientAppProxy.Current.getMainTab();if(a){var n=a.component.children(".k-tabstrip-items");n&&n.length>0&&(KD.mainConcleHeadAndMainTabTitleHeight=n.height()+n.offset().top+i,KD.clientDetaHeight=KD.clientMinHeight>700+KD.mainConcleHeadAndMainTabTitleHeight?KD.clientMinHeight-700-KD.mainConcleHeadAndMainTabTitleHeight-17:0)}}var o=KD.mainConcleHeadAndMainTabTitleHeight||t;return 0==e&&KD.mainConcleHeadAndMainTabTitleHeight>0&&(o=KD.mainConcleHeadAndMainTabTitleHeight-i),o},KD.setPluginsLogoffPage=function(){try{var e=KD.getEntryRole(),t=KD.entryrolePlugins.getPlugin(e);t&&$.isFunction(t.setLogoffPage)&&t.setLogoffPage.call(t)}catch(i){KD.writeError(i)}},KD.checkhHtml5=function(){"undefined"==typeof Worker&&(alert(ResManager.LoadKDString("不支持HTML5，推荐你下载个chrome或者IE10+的浏览器","099002000000009")),KD.stopDOM())},KD.checkBrowser=function(){var e=!0,t="",i=KD.getCurrentBrowsType();try{if(this.browserConfig){var a=this.browserConfig.BrowserConfigItem.filter(function(e,t){return e.Title.toLowerCase()==i.type.toLowerCase()})[0];if(null==a&&(a=this.browserConfig.BrowserConfigItem.filter(function(e,t){return"default"==e.Title.toLowerCase()})[0]),i.mainVer<parseInt(a.Version)){var n=a.Download.filter(function(e,t){return e.Key.toLowerCase()==i.system.toLowerCase()})[0];null==n&&(n=a.Download.filter(function(e,t){return"default"==e.Key.toLowerCase()})[0]);var o=ResManager.LoadKDString("浏览器版本过低，请下载新版本！","0991732000001268");i.ieCompatible&&(o=ResManager.LoadKDString("当前IE浏览器可能加入了兼容模式，请去掉浏览器的兼容性设置，并设置完成后重启电脑后即可生效！{0}如果您不知如何设置兼容模式，请参考{1}","0991733000004788"),o=ResManager.LoadKDString("链接地址","0991733000004787"),o="当前IE浏览器可能加入了兼容模式,请去掉兼容模式试一试！",o=ResManager.LoadKDString("按当前IE浏览器设置无法在客户端显示当前内容。{0}原因说明：本功能基于跨技术平台的嵌套方式实现，对IE浏览器版本和兼容模式有要求。{0}解决办法：{0}1、微软官网下载并安装IE11；{0}2、请去掉浏览器的兼容性设置，并设置完成后重启电脑后即可；{0}如果您不知如何设置兼容模式，请参考{1}。{0} 注意：使用本功能要求必须使用IE11，对于一些家庭版的操作系统不能安装升级到IE11，则不能在客户端使用本功能，请在HTML5端使用。","0991733000005462")),KD.warning(o),KD.toBrowserrecommend(KD.mergeUrl(KD.getUrlRoot(),n.Value)),e=!1}}}catch(r){e=!1,this.browserConfig?(t=ResManager.LoadKDString("浏览器版本过低，请下载新版本！","0991732000001268"),i.ieCompatible&&(t="当前IE浏览器可能加入了兼容模式,请去掉兼容模式试一试！")):t="兼容浏览器配置未指定!",KD.warning(t+"    "+r.message.toString()),KD.toBrowserrecommend()}return e},KD.checkChinese=function(e){var t=new RegExp("[\\u4E00-\\u9FFF]+","g");return t.test(e)},KD.warning=function(e){try{document.getElementById("mainformWaitting").innerHTML="<div><span>"+e+"</div></span>"}catch(t){alert(e)}},KD.GetDefaultBrandName=function(lcid){var id=lcid||2052,name="";if(KD.Brand&&KD.Brand.DefaultName){var dename=eval("("+KD.Brand.DefaultName+")");dename&&(name=dename[id]||dename[2052]||dename[1033]||KD.Brand.DefaultName)}return name&&(KD.isManagementSite()?document.title=KD.format(ResManager.LoadKDString("{0} 管理中心","0022103000006671"),name):document.title=name),name},KD.GetServerCommonConfig=function(){if(!ClientAppProxy.serverConfig){var e={scope:$(document.body),callback:function(e){try{CheckShellByWinService();var t=KD.parseObject(e);ClientAppProxy.serverConfig=t,KD&&t&&t.brandresource&&(KD.Brand=t.brandresource,KD.Brand)}catch(i){KD.Error.raise({msg:""+e})}},errcallback:function(e){CheckShellByWinService();var t=this;t.err&&KD.Error.raise({msg:""+e})}},t=new ClienterServiceProxy;t.GetServerCommonConfig(e)}},KD.isStartAppVerify=function(){var e=($("#IsStartAppPlugIn").val()||"").toLowerCase(),t=KD.getQueryString("ud"),i=!!t&&"true"==e;return"true"!=e||i||(t=KD.getQueryString("custparam"),i=!!t&&"true"==e),i},KD.StartVerify=function(e,t){if(!ClientAppProxy.serverConfig){if(!KD.isStartAppVerify()&&e&&t){var i={ResultType:1};t.call(e,i)}var a={scope:$(document.body),callback:function(i){try{if(e&&t){var a=KD.parseObject(i);t.call(e,a)}}catch(n){e&&t&&t.call(e,null)}},errcallback:function(i){e&&t&&t.call(e,null)}},n=new StartAppServiceProxy,o=KD.getClientInfo();try{if(KD.isQBoard()&&KD.getQueryString("ud","",!1)){var r=KD.storage.getItem(KD.CONST.k3CloudQBoardSimplePortKey);KD.isEmpty(r)||(o.ClientParameters=KD.stringify({simpleport:r}))}}catch(s){console.log(s)}n.Verify(a,o)}},KD.setStartVerifyResult=function(e){KD.StartVerifyResultValue=e},KD.getStartVerifyResult=function(){return KD.StartVerifyResultValue},KD.buildsession=function(e){try{$("[data-kdid=loginLayout]",document).fadeOut("slow"),$(document.body).append('<div id="__waittingVerify" style="float:left;left:40%;top:30%;position:relative;z-index:9;"><span>'+ResManager.LoadKDString("等待验证","0991733000004075")+"</span></div>")}catch(t){}var i=function(){try{$("[data-kdid=loginLayout]",document).fadeIn("slow"),$("#__waittingVerify").remove()}catch(e){}},a=void 0===e.async?!1:e.async,n=KD.format("BuildSessionWithHtml5 - async={0}",a);KD.writeLog("KD.buildsession",n,!0);var o={scope:$(document.body),async:a,callback:function(t){try{var a=KD.parseObject(t);if(KD.isObject(a)&&1==a.returnValue&&a.KDSVCSessionId&&KDCookieManager.setKDSessionId(a.KDSVCSessionId),KD.isDebug(),e.callback)return void e.callback.call(e.scope,a);if(e.buildsessiononly)return;"True"==t||a&&1==a.returnValue?(e.target="_self",KD.openUrl(e)):KD.Error.raise({msg:ResManager.LoadKDString("自动登录失败","0991733000004076")})}catch(n){KD.Error.raise({msg:""+t})}finally{i()}},errcallback:function(t){var a=this;if(a.err){if(e.errcallback)return void e.errcallback.call(e.scope);if(e.buildsessiononly)return;KD.Error.raise({msg:""+t})}i()}},r=new UserServiceProxy;e.clientInfo=KD.getClientInfo(),KD.isDebug(),r.BuildSessionWithHtml5.call(r,o,e)},KD.supportActiveX=function(){return void 0!==(window.ActiveXObject&&window.ActiveXObject.prototype)},KD.supportWebSocket=function(){return KDLocalServices.hasSocket()},KD.rgbToHex=function(e){if(KD.isObject(e)){var t=function(e){var t=e.toString(16);return 1==t.length?"0"+t:t};return"#"+t(e.a||e.A)+t(e.r||e.R)+t(e.g||e.G)+t(e.b||e.B)}return KD.isString(e)?e:"transparent"},KD.initClientInfo=function(e){return KD.supportActiveX()&&KD.getClientInfo(),void 0!==window.clientInfo?void(KD.isFunction(e)&&e()):(KD.getConnectConfig()||{}).isManagementSite?void(KD.isFunction(e)&&e()):KD.isIeHttps()?void(KD.isFunction(e)&&e()):KD.isWinOS()?void KDLocalServiceClient.checkOrUpdateVersion(function(t,i){if(!i||!i.ReturnPacks)return void(KD.isFunction(e)&&e());if(0==i.IsSuccessful)return KD.isFunction(e)&&e(),KD.initClientInfo.failureTimes=(KD.initClientInfo.failureTimes||0)+1,KD.initClientInfo.failureTimes<10&&KD.delayInvoke(KD.initClientInfo,3e3),void KD.initSimulateClientInfo();KD.initClientInfo.failureTimes=0;var a=i.ReturnPacks||[],n=a.length>0?a[0]:{};if(KD.isEmpty(n)){var o=$.browserUtil&&$.browserUtil.userBrowser?$.browserUtil.userBrowser():"mozila";n={ipAddress:KD.getIpBySimulate(o),IpAddress:KD.getIpBySimulate(o),hostName:"",HostName:"",MacAddress:KD.getMacBySimulate("browser"),macAddress:KD.getMacBySimulate("browser"),IsDefaultInfo:!0,Gsid:"",TRLevel:0}}else n.IsDefaultInfo=!1;$.extend(n,{Version:"HTML5",ClientType:16,vH:KD.getClientInfoAvailableAreaHeight(),vW:document.body.clientWidth,AvailableAreaSize:{Height:KD.getClientInfoAvailableAreaHeight(),Width:document.body.clientWidth},ScreenSize:{Height:window.screen.height,Width:window.screen.width},EntryPageUrl:KD.getEntryPageUrl(),customArgs:KD.getQueryString("ud","",!1)});var r=KD.getCurrentBrowsType()||{};n.BrowserType=(r.system||"")+"|"+(r.type||"")+"|"+(r.ver||""),window.clientInfo=n,KD.writeLog("clientInfo::",KD.stringify(n),!0),KD.isFunction(e)&&e()},this):(KD.initSimulateClientInfo(),void(KD.isFunction(e)&&e()))},KD.getClientInfoAvailableAreaHeight=function(){var e=document.body.clientHeight;return e<KD.CONST.MinClientHeight&&(e=KD.CONST.MinClientHeight),e},KD.getClientInfo=function(){var e=window.clientInfo;return void 0==e&&(e=KD.getDefaultIPMac(),$.extend(e,{Version:"HTML5",ClientType:16,vH:KD.getClientInfoAvailableAreaHeight(),vW:document.body.clientWidth,AvailableAreaSize:{Height:KD.getClientInfoAvailableAreaHeight(),Width:document.body.clientWidth},ScreenSize:{Height:window.screen.height,Width:window.screen.width},EntryPageUrl:KD.getEntryPageUrl(),customArgs:KD.getQueryString("ud","",!1)}),0==e.IsDefaultInfo&&(window.clientInfo=e)),e.vH=document.body.clientHeight,e.vW=document.body.clientWidth,e.Gsid="",e.TRLevel=0,e},KD.getDefaultIPMac=function(){var e={};KD.supportActiveX()?(e.ipAddress="IE-trustless",e.macAddress="browser",e=KD.getIPMac()):(e.ipAddress=KD.getIpBySimulate($.browserUtil&&$.browserUtil.userBrowser?$.browserUtil.userBrowser():"mozila"),e.macAddress=KD.getMacBySimulate("browser")),e.hostName||(e.hostName=e.ipAddress),
e.IsDefaultInfo="browser"===KD.getMacBySimulate("browser")?void 0===e.IsDefaultInfo?!0:e.IsDefaultInfo:!1,e.IpAddress=e.ipAddress,e.MacAddress=e.macAddress,e.HostName=e.hostName,e.OperationSystem=e.OperationSystem||"";var t=KD.getCurrentBrowsType()||{};return e.BrowserType=(t.system||"")+"|"+(t.type||"")+"|"+(t.ver||""),e},KD.getIPMac=function(){var e={};if("False"==window.AllowWBEMActiveX)return e.ipAddress="WBEM Off",e.macAddress="browser",e.hostName="",e.OperationSystem="",e;try{var t=new ActiveXObject("WbemScripting.SWbemLocator"),i=t.ConnectServer("."),a=i.ExecQuery("SELECT MACAddress FROM Win32_NetworkAdapter WHERE NetConnectionStatus=2 AND PNPDeviceID LIKE 'PCI%'"),n=new Enumerator(a).item();n&&(e.macAddress=n.MACAddress(0)),void 0==e.macAddress&&(a=i.ExecQuery("SELECT MACAddress FROM Win32_NetworkAdapter WHERE NetConnectionStatus=2"),n=new Enumerator(a).item(),n&&(e.macAddress=n.MACAddress(0)));for(var o="SELECT DNSHostName,MACAddress,IPAddress FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled=True AND MACAddress='"+e.macAddress+"'",r=i.ExecQuery(o),s=new Enumerator(r);!s.atEnd();){var l=s.item();if(l){e.hostName=e.hostName||l.DNSHostName(0),e.macAddress=e.macAddress||l.MACAddress(0),e.ipAddress=e.ipAddress||l.IPAddress(0);break}s.moveNext()}var d="SELECT Name,Version FROM Win32_OperatingSystem",c=i.ExecQuery(d),h=new Enumerator(c).item();h&&(e.OperationSystem=h.Name(0)+" "+h.Version(0)),e.IsDefaultInfo=!1}catch(u){KD.supportActiveX()?(e.ipAddress="IE-trustless",e.macAddress="browser"):(e.ipAddress=KD.getIpBySimulate($.browserUtil&&$.browserUtil.userBrowser?$.browserUtil.userBrowser():"mozila"),e.macAddress=KD.getMacBySimulate("browser")),e.hostName="",e.OperationSystem=""}return e.IpAddress=e.ipAddress,e.MacAddress=e.macAddress,e.HostName=e.hostName,e.OperationSystem=e.OperationSystem,e},KD.initSimulateClientInfo=function(){var e=function(e){return(e+"0000").substr(0,4)},t=function(t){if(!t)return"";var i=t.split("."),a=["MAC","SIMU","BY","IP",i[0]+"A",i[1]+"A",i[2]+"A",i[3]+"A"];return e(a[0])+e(a[1])+"-"+e(a[2])+"-"+e(a[3])+"-"+e(a[4])+"-"+e(a[5])+e(a[6])+e(a[7])},i=function(e){try{var t=[],i=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection,a=new i({iceServers:[]});a.createDataChannel(""),a.onicecandidate=function(i){try{if(!i.candidate)return a.close(),void e(t);var n=/^candidate:.+ (\S+) \d+ typ/.exec(i.candidate.candidate)[1];-1==t.indexOf(n)&&t.push(n)}catch(o){KD.writeLog(o.message,o.description,!0)}},a.createOffer().then(function(e){a&&a.setLocalDescription&&a.setLocalDescription(e)},function(){})}catch(n){KD.writeLog(n.message,n.description,!0)}};KD.isEmpty(KD.getMacBySimulate())&&i(function(e){try{var i=(e||[]).join("").replace(/\.local/g,""),a=i.length>30?i:t(i);KD.storage.setItem(KD.CONST.SimulateMacAddress,a||""),KD.storage.setItem(KD.CONST.SimulateIpAddress,i||"")}catch(n){KD.writeLog(n.message,n.description,!0)}})},KD.getMacBySimulate=function(e){return KD.storage.getItem(KD.CONST.SimulateMacAddress)||e},KD.getIpBySimulate=function(e){return KD.storage.getItem(KD.CONST.SimulateIpAddress)||e},KD.openDebugger=function(){if(KD.isDebug()){KD.ShowHttpWatchWindow();var e=setTimeout(function(){clearTimeout(e),KD.printAllControls()},1e4)}},KD.redirection=function(e){KD.isDebug()?KD.openPage(e,"_self"):KD.openPage(e,"_self")},KD.openUrl=function(e){var t=KD.getUrlRoot()+"/"+KD.getSubPath()+"/dform.aspx?formId="+(e.FormId||e.formId||"")+(KD.isDebug()?"&isDebug=true":"")+"&pageId="+(e.PageId||e.pageId||"")+"&formType="+(e.FormType||e.formType||"")+"&pkId="+(e.PkId||e.pkId||"")+"&EntryRole="+(e.EntryRole||e.entryRole||"")+"&usertoken="+(e.UserToken||e.userToken||KD.getUserToken());KD.openPage(t,e.Target||e.target||"_blank",e.Features||e.features||"")},KD.openPage=function(e,t,i){var a,n=$("#opennewpagelink");if(n.length>0&&n.remove(),n=$("<a>").appendTo($(document.body)),!n[0].click||"_blank"!=t&&"_self"!=t&&i)a=window.open(e,t,i);else{n[getPropName()]("id","opennewpagelink"),n[getPropName()]("target",t),n[getPropName()]("href",e);var o=n[0];o.onclick=function(){if(!/msie/i.test(navigator.userAgent)){var e=document.createEvent("MouseEvent");e.initEvent("click",!1,!1)}},o.click()}return n.remove(),a},KD.getReponseHttpCodeTipMessage=function(e){e+="";var t=ResManager.LoadKDString("刚刚执行的操作不能完成，请稍后重试或者联系系统管理员！","0991733000003597");switch(e){case"RequestTimeout":case"408":case"Conflict":case"409":case"BadGateway":case"502":case"GatewayTimeout":case"504":case"ServiceUnavailable":case"503":t="",t+=ResManager.LoadKDString("刚刚执行的操作不能完成，可能当前网络状况不佳，请尝试下面办法：","0991733000004105"),t+="\r\n"+ResManager.LoadKDString("1）联系系统管理员在应用服务器下访问站点","0991733000005329")+"http://localhost/k3cloud；",t+="\r\n"+ResManager.LoadKDString("2）若无法访问，则应用服务器站点不可用，需系统管理员修复；","0991733000004101"),t+="\r\n"+ResManager.LoadKDString("3）若可以正常访问，则极可能是网络问题，建议排查网络情况","0991733000004103")}return t},function(e){$.extend(e,{IsLoginResultSuccessfull:function(t){switch(t){case e.LoginResultType.Success:case e.LoginResultType.DealWithForm:case e.LoginResultType.PWInvalid_Optional:case e.LoginResultType.Wanning:case e.LoginResultType.Activation:case e.LoginResultType.PWInvalid_Required:return!0;default:return!1}},LoginResultType:{Activation:-7,DealWithForm:-5,Wanning:-4,PWInvalid_Required:-3,PWInvalid_Optional:-2,Failure:-1,PWError:0,Success:1,EntryCloudUnBind:-6},AuthenticationType:{DomainAuthentication:0,PwdAuthentication:1,DynamicPwdAuthentication:2,CAAuthentication:3,XuntongAuthentication:4,WeixinPublicAuthentication:5,WeixinEntAuthentication:6,CloudEntryAuthentication:7,IDECloudEntryAuthentication:8,SimplePassportAuthentication:9,YunZhiJiaAuthentication:10,YunZhiJiaDynamicPwdAuthentication:11,YunZhiJiaQRCodeAuthentication:12,FaceAuthentication:13,YunZhiJiaPubAuthentication:14,UserTokenAuthentication:15,SAMLAuthentication:16}}),e.setLoginLang=function(){var t=parseInt(ResManager.Language);$("#indexDLChrome")[0].innerText=ResManager.LoadKDString("建议浏览器：","0991733030033749"),$("#linkServiceContact")[0].innerText=ResManager.LoadKDString("用户协议","014003030033142"),$("#linkPrivacyPolicy")[0].innerText=ResManager.LoadKDString("隐私政策","014003030033109");var i=this.getUrlSubRoot();if(i?$("#indexDLChrome").attr("href",i+"/help/browserrecommend.htm"):$("#indexDLChrome").attr("href","/help/browserrecommend.htm"),$("#loginback").css("background-image",e.getLoginBackBrush(ResManager.Language)),!e.isManagementSite()){var a=$('div[data-type="qrcode"] span').length>0;if(a){var n=$('#loginContainer .boxtitle[data-type="qrcode"]');"qrcode"==n.attr("datarole")?n.find("span")[0].innerText=ResManager.LoadKDString("密码登录","0991733000005696"):n.find("span")[0].innerText=ResManager.LoadKDString("扫码登录","0991733000006693"),$('#loginContainer div[data-type="account"] span')[0].innerText=ResManager.LoadKDString("金蝶云星空账号","0991733000005698"),$('#loginContainer div[data-type="cloudaccount"] span')[0].innerText=ResManager.LoadKDString("金蝶·云账号","0991733000005697"),$("#qrcode-loseeffect").html(e.format(ResManager.LoadKDString("二维码已失效{0}请点击刷新","0991733000008106"),"<br />")),$("#qrcode-populuarize").html(e.format(ResManager.LoadKDString("使用 {0} 扫描二维码","0991733000008107"),'<a href="http://www.yunzhijia.com/home/?m=open&amp;a=download">'+ResManager.LoadKDString("云之家APP","0991733000006714")+"</a>")),1033==t?$("#qrcode-loseeffect").addClass("qrcode-reload-en"):$("#qrcode-loseeffect").removeClass("qrcode-reload-en")}}$("#btnLogin")[0].innerText=ResManager.LoadKDString("登录","00214298000004485"),$("#user").attr("placeholder",ResManager.LoadKDString("用户名","099002000002724")),$("#password").attr("placeholder",ResManager.LoadKDString("密码","099002000002725")),$("#velidationCode").attr("placeholder",ResManager.LoadKDString("验证码","099002000002726")),$("#link_ChangeCode")[0].innerText=ResManager.LoadKDString("换一张","0991733000004020"),$("#link_ChangeCode").attr("title",ResManager.LoadKDString("换一张","0991733000004020")),$("#forgetpass .kd-text").text(ResManager.LoadKDString("忘记密码","002014000004304")),$("#forgetpass .kd-getpassword-tips .kd-login-tips-text").text(ResManager.LoadKDString("首次登录请点击“忘记密码”来设置密码","002014030033727")),$("#SMSVerificationContainer #kd-input-sms-verification").attr("placeholder",ResManager.LoadKDString("请输入短信验证码","00214298000005662")),$("#SMSVerificationContainer #kd-login-btn-sms").text(ResManager.LoadKDString("发送验证码","00214298000005663")),$("#capslockstate .kd-text").text(ResManager.LoadKDString("大写锁定已打开","0991733000014723")),$("#indexSuggest")[0].innerText=ResManager.LoadKDString("建议分辨率：1280x1024以上像素","0991733030033750"),$("#indexClearCache")[0].innerText=ResManager.LoadKDString("清除本地缓存","099002000002731"),$("#indexShowHttpwatcher")[0].innerText=ResManager.LoadKDString("查看http数据","099002000002730"),$("#pCopyRight")[0].innerText=e.format(ResManager.LoadKDString("{0}1993-{1} 金蝶国际软件集团有限公司版权所有","0991733000004763"),"©","2020"),$("#indexSRMSupplier")[0].innerText=ResManager.LoadKDString("供应商注册","0991733000007301");var o=$(".ADItem");$.each(o,function(e,i){var a=$(i).attr("src").split("/"),n=a[a.length-1],o=n.indexOf("_")>0?n.split("_")[0]:n.replace(".png",""),r="";switch(t){case 1033:r=$(i).attr("src").replace(n,o+"_1033.png"),$(i).attr("src",r),$("body").addClass("kd-body-enEnvironment");break;case 3076:r=$(i).attr("src").replace(n,o+"_3076.png"),$(i).attr("src",r),$("body").removeClass("kd-body-enEnvironment");break;case 2052:r=$(i).attr("src").replace(n,o+".png"),$(i).attr("src",r),$("body").removeClass("kd-body-enEnvironment")}});var r=$(".loginKDLogo"),s=e.getUrlSubRoot()+"/images/biz/International/kingdee_icon",l=e.getUrlSubRoot()+"/images/biz/International/kdcloud_login_bg",d=".png";switch(e.Brand&&e.Brand.Resource6&&(r.hasClass("kd-company-unified-style-icon")||(s=e.getUrlSubRoot()+"/"+e.Brand.Resource6.split(".")[0]),d="."+e.Brand.Resource6.split(".")[1]),t){case 2052:case 3076:imgPath=s+d,l+=d;break;case 1033:imgPath=s+"_1033"+d,l=l+"_1033"+d,r.width(260);break;default:imgPath=s+"_1033"+d,l=l+"_1033"+d,r.width(260)}e.GetDefaultBrandName(t);var c=e.getVersion();if(imgPath+="?v="+c,l+="?v="+c,r.hasClass("kd-company-unified-style-icon")){var h=ResManager.LoadKDString("金蝶云","00214298000004482"),u=e.checkChinese(h);u?$("#loopbanners .kd-desc-container").removeClass("kd-desc-container-en"):$("#loopbanners .kd-desc-container").addClass("kd-desc-container-en"),$("#loopbanners #divBarTitle").text(h),$("#loopbanners #divImgBg").css({"min-height":"40px"}).text(ResManager.LoadKDString("为企业成长而生","00214298000004483"));var p=$(window).width();p>=1366?$("#loopbanners .kd-desc-container").removeClass("kd-desc-container-small-W"):$("#loopbanners .kd-desc-container").addClass("kd-desc-container-small-W"),r.css({"background-image":"url("+imgPath+")"})}else r.css({"background-image":"url("+imgPath+")"});$("#loopbanners").css({"background-image":"url("+l+")"});var g=$("#watchersh");if(g&&g.length>0){var f=g.data("kendoWindow");f.title&&f.title(ResManager.LoadKDString("http数据监控","0025710000004015"))}var m=window._kdlogin?window._kdlogin.refreshDataCenter:void 0;e.isFunction(m)&&m.call(window._kdlogin)},e.getLoginBackBrush=function(t){var i=e.loginBackBrushs[t];i||(i=e.loginBackBrushs[2052]);var a=e.getUrlRoot()+i;return"url("+a+")"},e.loginBackBrushs={2052:"/"+e.getSubPath()+"/Content/themes/images/icon_login_simpleChinese.png",3076:"/"+e.getSubPath()+"/Content/themes/images/icon_login_traditionChinese.png",1033:"/"+e.getSubPath()+"/Content/themes/images/icon_login_english.png"},e.acceptCookieVerify=function(t){var i=parseInt(ResManager.Language),a=$(kendo.format('<div class="kd-cookieverify-form"><div class="kd-cookieverify-mask"></div><div class="kd-content-contain"><div class="kd-cookieform-content {3}">{0}<span class="kd-cookie-rule">{1}</span></div><div class="kd-cookieform-bottom"><span class="kd-acceptcookie-button">{2}</span></div></div></div>',ResManager.LoadKDString("欢迎使用金蝶云星空，为确保系统正常登录，我们将会在您的计算机或移动设备上存储Cookies等信息。此类信息仅用于实现会话保持，是登录系统所必需的，如不接受，将无法正常登录系统。请您确认接受后，继续访问金蝶云星空。如需了解更多有关我们使用的各种Cookies的信息，请查阅","00215181000007438"),ResManager.LoadKDString("《Cookies政策》","00215181000007439"),ResManager.LoadKDString("接受并继续","00215181000008654"),1033==i?"kd-cookieform-content-english":""));a.find(".kd-acceptcookie-button").click(function(){localStorage.setItem("acceptCookie",JSON.stringify(!0)),a.remove(),t&&$("#btnLogin").click()}),a.find(".kd-cookie-rule").click(function(){var t="http://open.kingdee.com/K3Cloud/Open/cookiespolicy_cn.html",i="http://open.kingdee.com/K3Cloud/Open/cookiespolicy_en.html",a=parseInt(ResManager.Language);2052==a||3076==a?e.openPage(ClientAppProxy.serverConfig.CookiePolicyUrlCn||t,"_blank"):e.openPage(ClientAppProxy.serverConfig.CookiePolicyUrlEn||i,"_blank")}),$("body").append(a)},e.isShowAcceptCookieForm=function(){return ClientAppProxy.isLoginVaildCookieTip()&&!JSON.parse(localStorage.getItem("acceptCookie"))}}(KD),KD.checkVideo==function(){if(document.createElement("video").canPlayType){var e=document.createElement("video");oggTest=e.canPlayType('video/ogg; codecs="theora, vorbis"'),oggTest?"probably"==oggTest?alert(ResManager.LoadKDString("支持HTML5！","099002000000011")):(alert(ResManager.LoadKDString("支持一部分html5，换个浏览器吧，比如Chrome，IE10+。","099002000000012")),KD.stopDOM()):(h264Test=e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),h264Test?"probably"==h264Test?alert(ResManager.LoadKDString("支持HTML5！","099002000000011")):(alert(ResManager.LoadKDString("支持一部分html5，换个浏览器吧，比如Chrome，IE10+。","099002000000012")),KD.stopDOM()):(alert(ResManager.LoadKDString("不支持HTML5，推荐你下载个chrome或者IE10+版本之上的浏览器","099002000000010")),KD.stopDOM()))}else alert(ResManager.LoadKDString("不支持HTML5，推荐你下载个chrome或者IE10+版本之上的浏览器","099002000000010")),KD.stopDOM()},KD.scrollTo=function(e,t,i){var a=$(e);if(0!=a.length){var n=$("html, body"),o=a.offset().top+(t?t.height||0:0);i&&(n=$(i),o=0==o?0:o+n.scrollTop()-n.offset().top),n.animate({scrollTop:o},500)}},KD.stopDOM=function(){window.stop?window.stop():document.execCommand("Stop")},KD.ShowHttpWatchWindow=function(e){var t=KD.getConnectConfig();if(0!=t.allowDebugMode||e){var i=ClientAppProxy.Current,a=KD.getQueryString("formId",""),n=KD.getQueryString("pageId",""),o=a+"_"+n;i.showWatcher.call(i,o)}},KD.ClearLocalCahce=function(e){var t=KD.storage.getLength(),i={};for(var a in KD.NotClearCacheKeys){var n=KD.NotClearCacheKeys[a],o=KD.storage.getItem(n);KD.isEmpty(o)||(i[n]=o)}KD.storage.clear();for(var a in KD.NotClearCacheKeys){var n=KD.NotClearCacheKeys[a],o=i[n];KD.isEmpty(o)||"null"===o||"undefined"===o||(t--,KD.storage.setItem(n,o))}e||KDMessageBox.show({sourceClass:"",sourceMethod:"",msg:t.toString()+ResManager.LoadKDString(" 项缓存被清除!","099002000002762")})},KD.DownLoadChrome=function(){window.open("http://rj.baidu.com/soft/detail/14744.html?ald")},KD.cleanup=function(){"object"==typeof xmlHttp&&$.isFunction(xmlHttp.abort)&&xmlHttp.abort()},KD.releaseHandler=function(e){var t=function(){try{if(window.hasReleased)return;window.hasReleased=!0,KD.circleInterval&&clearTimeout(KD.circleInterval);var e="dform.aspx?methodname=Release&usertoken="+KD.getUserToken()+"&pageId="+KD.getQueryString("pageId");$.ajax({type:"GET",async:!1,url:e,data:"",success:function(e){}})}catch(t){KD.writeError(t)}finally{return!1}};window.onkeydown=function(e){116==e.keyCode&&(e.returnValue=!1,e.cancel=!0,t(e),KD.delayInvoke(function(){window.location.reload()},1e3,!0))},window.onfocus=function(e){},window.onblur=function(e){},window.onbeforeunload=function(e){t(e)},window.onunload=function(e){t(e)},window.onpopstate=function(e){t(e)}},KD.Guid={guid:function(e){function t(e,t){if(t=t.replace(/\{|\(|\)|\}|-/g,""),t=t.toLowerCase(),32!=t.length||-1!=t.search(/[^0-9,a-f]/i))i(e);else for(var a=0;a<t.length;a++)e.push(t[a])}function i(e){for(var t=32;t--;)e.push("0")}function a(e,t){switch(t){case"N":return e.toString().replace(/,/g,"");case"D":var i=e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20,32);return i=i.replace(/,/g,"");case"B":var i=a(e,"D");return i="{"+i+"}";case"P":var i=a(e,"D");return i="("+i+")";default:return new guid}}var n=new Array;"string"==typeof e?t(n,e):i(n),this.Equals=function(e){return e&&e.IsGuid?this.ToString()==e.ToString():!1},this.IsGuid=function(){},this.ToString=function(e){return"string"==typeof e&&("N"==e||"D"==e||"B"==e||"P"==e)?a(n,e):a(n,"D")}},NewGuid:function(){for(var e="",t=32;t--;)e+=Math.floor(16*Math.random()).toString(16);return new this.guid(e)},Empty:function(){return new this.guid}},KD.KDWindowBase=function(){},KD.KDWindowBase.prototype={Title:"",MinWidth:200,MinHeight:100,Width:"auto",Height:"auto",Content:"<div></div>",ShowDialog:function(){var e=$(this.Content);return e.appendTo($(document.body)),e.kendoWindow&&e.kendoWindow({title:this.Title,showCollapseButton:!1,resizable:!0,pinned:!0,minHeight:this.MinHeight,minWidth:this.MinWidth,height:this.Height,width:this.Width,resizable:!1,modal:!0,close:function(t){var i=e.parent();return i.remove(),!0}}),e.data("kendoWindow").center(),e.data("kendoWindow")}},KD.OpenDeskApp=function(e){try{if(KD.isIeBrowser()){var t=document.getElementById("deskappActiveX"),i=t.GetDeskAppShellStatus();"1"==i?t.OpenDeskApp(e):t.OpenDeskApp(e)}else{var t=document.getElementById("deskappNPAPI");t.OpenDeskApp(e)}}catch(a){KD.OpenDeskAppByPage(e)}},KD.OpenDeskAppByPage=function(e){var t="iframe",i=KD.isIeBrowser();i&&(t="open");var a=document.getElementById("deskClientElement");if("iframe"==t&&null!=a)a.setAttribute("src",e);else{var n=!1;try{var o=window.open(e,"_blank");null==o?n=!0:i&&o.close()}catch(r){n=!0}if(n){var s=!1;try{var l=KD.CallWinService("OpenClient",e);s=0==l.code}catch(r){s=!1}}}},KD.CallWinService=function(){var e={code:0,description:""};if(0==arguments.length)e.code=-1,e.description="request forbidden:lack of service";else{try{var t=encodeURIComponent(KD.getUrlRoot()),i=encodeURIComponent(KD.getUserToken()),a="auth_server="+t+"&auth_token="+i,n="",o=!1;switch(arguments[0]){case"OpenClient":arguments.length<2?(e.code=-1,e.description="request forbidden:lack of arguments"):(o=!0,n="Client/"+arguments[0],a+="&manifest="+encodeURIComponent(arguments[1]));break;case"OpenRes":arguments.length<4?(e.code=-1,e.description="request forbidden:lack of arguments"):(o=!0,n="Local/"+arguments[0],a+="&filePath="+encodeURIComponent(arguments[1]),a+="&fileId="+encodeURIComponent(arguments[2]),a+="&targetFileName="+encodeURIComponent(arguments[3]),a+="&targetFolderName="+(arguments.length>4?encodeURIComponent(arguments[4]):""),a+="&targetApp="+(arguments.length>5?encodeURIComponent(arguments[5]):""),a+="&pageId="+(arguments.length>6?encodeURIComponent(arguments[6]):""));break;default:e.code=-1,e.description="request forbidden:service not found"}}catch(r){o=!1,e.code=-1,e.description="CallWinService exception:"+r.message}o&&KD.CheckProcessExists("Kingdee.BOS.DeskClient.WinService",function(){$.ajax({async:!1,url:"https://localhost:8022/"+n+"_jsonp.kcapi?"+a,type:"GET",dataType:"jsonp",cache:!1,jsonp:"clientproxycallback",timeout:500,success:function(e){1==e.code?KD.ShowTipsOfWinService():0!=e.code&&alert(e.description)},error:function(e){KD.ShowTipsOfWinService()}})},function(){KD.ShowTipsOfWinService()})}return e},KD.ShowTipsOfWinService=function(){KD.openCloudAppTipsWin("",ResManager.LoadKDString("金蝶云星空","00214298000004656"),"",ResManager.LoadKDString("系统检测到您本机运行金蝶云星空所需服务（K3CloudClienter）异常，需要正常运行任一客户端（GUI客户端、BOS设计器、万能报表设计器、BOS套打设计器），请通过以下步骤修复。","00214298000004655"),!0)},KD.isIeBrowser=function(){var e="Uon-IE",t=navigator.userAgent.toLowerCase();return(t.indexOf("msie")>-1||t.indexOf("trident")>-1&&t.indexOf("rv")>-1)&&(e="IE"),"IE"==e},KD.isEdgeBrowser=function(){var e=navigator.userAgent.toLowerCase(),t=/Edge\/(\S+)/.test(e);return t},KD.isWinOS=function(){var e=(navigator?navigator.platform:"").toLowerCase();return"win"==(e||"win").substr(0,3)},KD.isMacOS=function(){var e=(navigator?navigator.platform:"").toLowerCase();return"mac"==(e||"").substr(0,3)},KD.isMobileOS=function(){return KD.isEmpty(KD.CONST.IsMobileTerminalPlatform)&&(KD.CONST.IsMobileTerminalPlatform=!0,(KD.isWinOS()||KD.isMacOS())&&(KD.isMacOS()&&(navigator.maxTouchPoints>1||"ontouchstart"in document)?KD.CONST.IsMobileTerminalPlatform=!0:KD.CONST.IsMobileTerminalPlatform=!1)),KD.CONST.IsMobileTerminalPlatform},KD.isIeHttps=function(){var e=((document.location||{}).protocol||"").toLowerCase(),t="https:"==e?!0:!1;return t&&KD.isIeBrowser()},KD.isEdgeHttps=function(){var e=((document.location||{}).protocol||"").toLowerCase(),t="https:"==e?!0:!1;return t&&KD.isEdgeBrowser()},KD.isCombinationOrFunctionKey=function(e){var t=!1,i=e.key||e.keyCode||e.which,a=e.ctrlKey||e.metaKey,n=e.shiftKey,o=e.altKey;if(KD.isEmpty(i)||16==e.keyCode||17==e.keyCode||18==e.keyCode)return t;var r="F1|F2|F3|F4|F5|F6|F7|F8|F9|F10|F11|F12|",s=!1;KD.isString(i)&&i.indexOf("F")>-1&&(s=r.indexOf(i+"|")>-1?!0:!1);var l=new RegExp(/^[A-Za-z0-9]{1,}$/);return(s||(a||n||o)&&l.test(i))&&(t=!0),t};var isInstallShell="-1",installShellVerison="";KD.GetDeskShellStatus=function(){KD.InitDeskAppPlugIn(),CheckShellByWinService();var e="-1";if("-1"==isInstallShell){try{if(KD.isIeBrowser()){var t=document.getElementById("deskappActiveX");e=t.GetDeskAppShellStatus().toString()}else{var t=document.getElementById("deskappNPAPI");e=t.GetDeskAppShellStatus().toString()}}catch(i){e="-1"}"49"==e&&(e="1"),"48"==e&&(e="0")}else e=isInstallShell;return e},KD.GetDeskShellVesion=function(){"1"==isInstallShell&&$.ajax({async:!1,url:"https://localhost:8022/Version.kcapi",type:"GET",cache:!1,timeout:500,success:function(e){installShellVerison="",e&&e.Version&&(installShellVerison=e.Version)},error:function(e){}})},KD.CheckProcessExists=function(e,t,i){var a=function(){var e=function(e,t,i,a,n){$.ajax({async:!1,url:"https://localhost:"+e+"/RunningProcessCallback.kcapi?"+escape(t),type:"GET",dataType:"jsonp",jsonp:"clientproxycallback",cache:!1,timeout:n||500,success:function(t){isInstallShell="1",8022==e&&KD.GetDeskShellVesion(),t&&0==t.code||!a?i&&i(t):a()},error:function(e){a&&a()}})},t=function(t,i,a){e(8022,t,i,a)};return{call:function(e,i,a){t(e,i,a)}}};a().call(e,t,i)},KD.InitDeskAppPlugIn=function(){$(document.body).append('<div id="deskShellPlugInContainer" style="background:red; border:0 solid red;width:0px; height:0px; overflow: hidden;"><iframe id="deskClientElement" name="deskClientElement_Name" frameborder="0" style="position:fixed; visibility:hidden; z-index:100;"></iframe></div>');var e=document.getElementById("deskShellPlugInContainer");if(null!=e)if(KD.isIeBrowser()){if(null==document.getElementById("deskappActiveX")){var t=document.createElement("div");t.innerHTML='<object  id="deskappActiveX"  classid="CLSID:0CB07BD3-F372-47B2-8813-78F52D1AEC74" style="z-index:-999;width:1px;height:1px;visibility:hidden" />',e.appendChild(t)}}else if(null==document.getElementById("deskappNPAPI")){var t=document.createElement("div");t.innerHTML='<object id="deskappNPAPI"  type="application/npcloud" style="z-index:-999;width:1px;height:1px;visibility:hidden"  />',e.appendChild(t)}},KD.format=function(e){function t(e){if(!KD.isString(e))return!1;for(var t=["$&","$'","$`","$$"],i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return!0;return!1}var i=arguments,a=e||"";if(""!=a){for(var n=1;n<i.length;n++){var o="\\{"+(n-1)+"\\}",r=("{"+(n-1)+"}").length,s=new RegExp(o,"g"),l=void 0===i[n]?"":i[n];if(KD.isString(l)&&/[\{\}]/.test(l)&&(l=l.replace(/\{/g,"#lf_b#").replace(/\}/g,"#rg_b#")),t(l)){s=new RegExp(o);for(var d=s.exec(a);null!=d;)a=a.substr(0,d.index)+l+a.substr(d.index+r),s.lastIndex=d.index+l.length,d=s.exec(a)}else a=a.replace(s,l)}a=(a||"").replace(/#lf_b#/g,"{").replace(/#rg_b#/g,"}")}return a},function(e){function t(){var e=window.KDHtmlCoder;return e||(e=document.createElement("span"),window.KDHtmlCoder=e),e}e.htmlUtil={encode:function(e){var i=t();i.appendChild(document.createTextNode(e));var a=i.innerHTML;return i.innerHTML="",a},decode:function(e){var i=t();i.innerHTML=e;var a=i.innerText||i.extContent;return i.innerHTML="",a}}}(KD),KD.getCompressor=function(){return(window.ziblib_plugin||{}).gzip},KD.compress=function(e){var t=!0,i=KD.getCompressor();return t=i?KD.arrayToBase64(i(e)):e},KD.compressCore=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return KD.base64Encode(KD.utf8Encode(t))},KD.urlEncode=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return encodeURI(t)},KD.urlDecode=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return decodeURI(t)},KD.urlEncodeComponent=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return encodeURIComponent(t)},KD.urlDecodeComponent=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;try{return decodeURIComponent(t)}catch(i){return t}},KD.utf8Encode=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return JXG.Util.UTF8.encode(t)},KD.utf8Dncode=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return JXG.Util.UTF8.decode(t)},KD.base64Encode=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return JXG.Util.Base64.encode(t)},KD.base64Decode=function(e){var t=$.isPlainObject(e)?KD.stringify(e):e;return JXG.Util.Base64.decode(t)},KD.isBase64Str=function(e){var t=!1,i=/^([0-9a-zA-Z+\/]{4})*(([0-9a-zA-Z+\/]{2}==)|([0-9a-zA-Z+\/]{3}=))?$/;if(KD.isString(e)){var a=e.length>5e5?e.substr(0,5e5):e;t=i.test(a)}return t},KD.isSameUTimeZone=function(e){var t=!0,i=-1*(new Date).getTimezoneOffset();return e&&e.Context&&e.Context.UTimeZone&&(t=e.Context.UTimeZone.OffsetTicks/1e7/60==i),t},KD.isUseSmallScreenModel=function(e,t){var i=!1;e=e||{};var a=KD.CONST.EnableSmallScreenCriticalValue,n=window.screen.height;return i=a>=n,t&&e&&(i="ListService"==e.serviceName),i},KD.getTimeZoneName=function(){var e=new Date(Date.UTC(2017,6,30,0,0,0,0)),t=-1*e.getTimezoneOffset(),i=new Date(Date.UTC(2017,12,30,0,0,0,0)),a=-1*i.getTimezoneOffset();return-660==t&&-660==a?"Pacific/Midway":-600==t&&-600==a?"Pacific/Tahiti":-570==t&&-570==a?"Pacific/Marquesas":-540==t&&-600==a?"America/Adak":-540==t&&-540==a?"Pacific/Gambier":-480==t&&-540==a?"US/Alaska":-480==t&&-480==a?"Pacific/Pitcairn":-420==t&&-480==a?"US/Pacific":-420==t&&-420==a?"US/Arizona":-360==t&&-420==a?"US/Mountain":-360==t&&-360==a?"America/Guatemala":-360==t&&-300==a?"Pacific/Easter":-300==t&&-360==a?"US/Central":-300==t&&-300==a?"America/Bogota":-240==t&&-300==a?"US/Eastern":-240==t&&-240==a?"America/Caracas":-240==t&&-180==a?"America/Santiago":-180==t&&-240==a?"Canada/Atlantic":-180==t&&-180==a?"America/Montevideo":-180==t&&-120==a?"America/Sao_Paulo":-150==t&&-210==a?"America/St_Johns":-120==t&&-180==a?"America/Godthab":-120==t&&-120==a?"America/Noronha":-60==t&&-60==a?"Atlantic/Cape_Verde":0==t&&-60==a?"Atlantic/Azores":0==t&&0==a?"Africa/Casablanca":60==t&&0==a?"Europe/London":60==t&&60==a?"Africa/Algiers":60==t&&120==a?"Africa/Windhoek":120==t&&60==a?"Europe/Amsterdam":120==t&&120==a?"Africa/Harare":180==t&&120==a?"Europe/Athens":180==t&&180==a?"Africa/Nairobi":240==t&&180==a?"Europe/Moscow":240==t&&240==a?"Asia/Dubai":270==t&&210==a?"Asia/Tehran":270==t&&270==a?"Asia/Kabul":300==t&&240==a?"Asia/Baku":300==t&&300==a?"Asia/Karachi":330==t&&330==a?"Asia/Calcutta":345==t&&345==a?"Asia/Katmandu":360==t&&300==a?"Asia/Yekaterinburg":360==t&&360==a?"Asia/Colombo":390==t&&390==a?"Asia/Rangoon":420==t&&360==a?"Asia/Almaty":420==t&&420==a?"Asia/Bangkok":480==t&&420==a?"Asia/Krasnoyarsk":480==t&&480==a?"Beijin":540==t&&480==a?"Asia/Irkutsk":540==t&&540==a?"Asia/Tokyo":570==t&&570==a?"Australia/Darwin":570==t&&630==a?"Australia/Adelaide":600==t&&540==a?"Asia/Yakutsk":600==t&&600==a?"Australia/Brisbane":600==t&&660==a?"Australia/Sydney":630==t&&660==a?"Australia/Lord_Howe":660==t&&600==a?"Asia/Vladivostok":660==t&&660==a?"Pacific/Guadalcanal":690==t&&690==a?"Pacific/Norfolk":720==t&&660==a?"Asia/Magadan":720==t&&720==a?"Pacific/Fiji":720==t&&780==a?"Pacific/Auckland":765==t&&825==a?"Pacific/Chatham":780==t&&780==a?"Pacific/Enderbury":840==t&&840==a?"Pacific/Kiritimati":"US/Pacific"},KD.decompress=function(e){var t=e;try{t=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(e)).unzip()[0][0]}catch(i){}return t},KD.decompress_decode=function(e){var t=e;try{t=JXG.decompress(e)}catch(i){}return t},KD.equalsIgnoreCase=function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;var i=!1;try{i=e.toUpperCase()===t.toUpperCase()}catch(a){KD.writeLog(a.Message,"",!0)}return i},KD.getUTF8StrLeng=function(e){for(var t=0,i=(e||"").length,a=-1,n=0;i>n;n++)a=e.charCodeAt(n),t+=a>=0&&128>=a?1:3;return t},KD.getGBKStrLeng=function(e){for(var t=0,i=e.length,a=-1,n=0;i>n;n++)a=e.charCodeAt(n),t+=a>=0&&128>=a?1:2;return t},KD.utf8Decode=function(e){var t,i,a,n,o,r;for(t="",a=e.length,i=0;a>i;)switch(n=e.charCodeAt(i++),n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(i-1);break;case 12:case 13:o=e.charCodeAt(i++),t+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=e.charCodeAt(i++),r=e.charCodeAt(i++),t+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&r)<<0)}return t},KD.arrayToBase64=function(e){for(var t="",i=new Uint8Array(e),a=i.byteLength,n=0;a>n;n++)t+=String.fromCharCode(i[n]);return window.btoa(t)},KD.getHexColor=function(e){var t=e;if((e||"").indexOf(",")>0){var i=e.split(",");t="#";for(var a=i.length-3;a<i.length;a++){var n=parseInt(i[a]||"0").toString(16);t+=n.length>1?n:"0"+n}}return t},KD.interceptColorStr=function(e){return 0==e.indexOf("#")&&e.length>7?"#"+e.substr(3,6):e},KD.getEnumSource=function(e){var t=[];if(e)for(var i=0;i<e.length;i++){var a=e[i];t.push({alias:a[1],value:a[0]})}return t},function(e){e.isLoginRenderByPlugins=function(){var t=!e.equalsIgnoreCase("HTML5",e.getConnectConfig().entryRole),i=e.getEntryRoleConfig(),a=i.jsPlugins,n=t&&a&&a.Items?a.Items.length>0:!1;return n},e.entryrolePlugins=e.entryrolePlugins||{plugins:{},pluginsCache:{},register:function(t,i){if(t&&i&&$.isFunction(i)){var a=t.toLowerCase();delete e.entryrolePlugins.pluginsCache[a],e.entryrolePlugins.plugins[a]=i}},getPlugin:function(t){var i=t?t.toLowerCase():"__def",a=e.entryrolePlugins.pluginsCache[i];if(a)return a;var n=e.entryrolePlugins.plugins[i];return n||(n=e.entryrolePluginBase),a=new n,e.entryrolePlugins.pluginsCache[i]=a,a}},function(e){e.entryrolePluginBase=function(){},e.entryrolePluginBase.prototype={acctoundId:"",languageId:2052,getLogOffUrl:function(){},setLogoffPage:function(){},initLoginPanel:function(){},initLoginUI:function(){},loginUIReady:function(){},isUseQRCode:function(){return!0},isUseDefaultLoginUI:function(){return!0},isBuildSession:function(){return!1},isDefaultLogoff:function(){return!0},isInitDataCenterList:function(){return!0},getLogininfo:function(e){return e},beforeSaveCookies:function(e){},afterLoadCookies:function(e){},getUserServiceProxy:function(){}}}(e),$.extend(e,{doPlugInsLogin:function(t){var i=function(e){KDMessageBox.show({type:KDMessageBox.KDMesBoxType.Warning,sourceClass:"",sourceMethod:"",msg:e.message,description:e.stack,callback:function(e){var i=t.getLogOffUrl.call(t)||document.location.href;document.location.href=i}})},a={sessionkey:KDCookieManager.getKDSessionId(),scope:t,response_error:function(t){var a=e.parseObject(t.substr(t.indexOf("{"))),n={message:a.Message,stack:a.Source+"\r\n"+a.StackTraceString};i(n)},callback:function(t){try{var a="string"==typeof t?e.parseObject(t):t;if(KDCookieManager.updateSessionId(a),e.IsLoginResultSuccessfull(a.LoginResultType))if(a.LoginResultType!=e.LoginResultType.Success||a.Message)KDMessageBox.show({type:KDMessageBox.KDMesBoxType.Warning,msg:a.Message,callback:function(t){a.LoginResultType=e.LoginResultType.Success;var i=a.UserToken||a.Context&&a.Context.UserToken;loadMainForm(i,null)}});else{var n=a.UserToken||a.Context&&a.Context.UserToken;loadMainForm(n,null)}else{var o={message:a.Message,stack:""};i(o)}}catch(r){var o={message:r.Message,stack:r.stack};i(o)}finally{}},errcallback:function(e){var t={message:"request error!",stack:e};i(t)}},n=new HTMLFormHandlerProxy,o=new LoginInfo;$.extend(o,{EncyptType:1,PasswordIsEncrypted:!1,AcctID:"xxx",AuthenticateType:e.AuthenticationType.PwdAuthentication,
ClientInfo:e.getClientInfo()}),o=t.getLogininfo.call(t,o),n.ValidateUser.call(n,a,o)},getDataCenterList:function(t){var i=target=t.scope,a=t.requested,n=t.dataLoaded,o=t.error,r={scope:i,callback:function(t){var a=e.parseObject(t);i.data=a,e.isFunction(n)&&n(i,{sender:target})},errcallback:function(t){var i=this;e.isFunction(o)&&o(i,{sender:target})}},s=new AccountClientProxy;s.getDataCenterList.call(s,r,1),e.isFunction(a)&&a(i,{sender:target})},initDataCenterList:function(t){if(!e||!e.autologin){var i=t.scope,a=target=t.target,n=t.defaultId,o=t.changed,r=t.requested,s=t.dataLoaded,l=t.rendered,d={scope:i,callback:function(t){var r=this;try{var d=e.parseObject(t);i.data=d;for(var c=[],h=null,u=0,p=0;p<d.length;p++){var h=d[p];$.each(h.LocaleValueName,function(e,t){t.Key==ResManager.Language&&c.push([h.Id,t.Value])}),h.Id==n&&(u=p)}var g=e.getEnumSource(c),f={dataSource:g,popup:{origin:"bottom right",position:"top right"},dataTextField:"alias",dataValueField:"value",height:350,autoWidth:!0,valueTemplate:'<span title="#: alias #" class="toolTip"> #: alias #</span>',noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490"),animation:{close:{effects:"fadeOut zoom:out",duration:300},open:{effects:"fadeIn zoom:in",duration:300}},change:function(t){e.isFunction(o)&&o(r,t)},dataBound:function(t){e.isFunction(l)&&l(r,t)}};g&&g.length>=8&&(f.filter="contains",f.minLength=1,f.delay=0),a.kendoDropDownList(f),a.data("kendoDropDownList").select(u),a.data("kendoDropDownList").trigger("change"),e.isFunction(s)&&s(r,{sender:target})}catch(m){r.err({msg:ResManager.LoadKDString("初始数据中心列表失败!","0991733000004012"),description:t})}},errcallback:function(e){var t=this;t.err&&t.err({msg:ResManager.LoadKDString("初始数据中心列表失败!","0991733000004012"),description:e})}},c=new AccountClientProxy;c.getDataCenterList.call(c,d,1),e.isFunction(r)&&r(scope,{sender:target})}},initDCLanguageList:function(t){var i=t.scope,a=target=t.target,n=0,o=t.defaultId,r=t.accountId,s=t.accountList||[],l=t.changed,d=t.requested,c=t.dataLoaded,h=t.rendered;try{for(var u=0;u<s.length;u++){var p=s[u];p.Id==r&&(n=u)}var g=s[n];ResManager.Language}catch(f){e.Error.raise({msg:ResManager.LoadKDString("初始认证列表失败!_datacenter_kendo_changed","0991733000004014"),description:f.stack})}var m={scope:i,response_error:function(t){e.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:t})},callback:function(t){try{for(var i=this,n=e.parseObject(t),r=0,s=[],d=0;d<n.length;d++){var u=n[d],p=u.LocaleName;p&&p.replace&&p.indexOf&&p.indexOf("/中国")>0&&(p=p.replace("/中国","")),s.push([u.LocaleId,p]),u.LocaleId.toString()==o&&(r=d)}var g=e.getEnumSource(s),f=a.kendoDropDownList({dataSource:g,popup:{origin:"bottom right",position:"top right"},dataTextField:"alias",dataValueField:"value",autoWidth:!0,noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490"),valueTemplate:'<span title="#: alias #" class="toolTip"> #: alias #</span>',change:function(t){e.isFunction(l)&&l(i,t)},dataBound:function(t){e.isFunction(h)&&h(i,t)}}).data("kendoDropDownList");f.select(r),ResManager.Language=s[r][0],e.isFunction(c)&&c(i,{sender:target})}catch(m){e.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:m.stack})}},errcallback:function(t){var i=this;i.err&&e.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:t})}},v=new AccountClientProxy;v.getDataCenterLoginLanguages.call(v,m,"zh-CN",1,g.Id,g.DBType),e.isFunction(d)&&d(scope,{sender:target})},updateDCLanguage:function(t){var i=[],a=t.scope,n=t.target,o=t.callback;try{for(var r=0,s=0;s<a.data.length;s++){var l=a.data[s];l.Id==n.data("kendoDropDownList").value()&&(r=s);var d=e.isEmpty(l.Name)?"":l.Name;$.each(l.LocaleValueName,function(e,t){t.Key==ResManager.Language&&(d=t.Value)}),i.push([l.Id,d])}var c=(a.data[r],new kendo.data.DataSource({data:e.getEnumSource(i)})),h=n.data("kendoDropDownList");h.setDataSource(c),h.select(r),o&&o(a,{sender:n})}catch(u){e.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013")+e.stringify(ins.currentTarget.data[0]),description:u.stack})}}})}(KD),KD.GridSelectedType={SingleRow:1,MultiRow:2,Cell:3},KD.resetAppSize=function(){if(!KD.isKDScriptBusy()){KD.isKDScriptBusy(!0);try{var e=18,t=21,i=KD.CONST.MinClientHeight,a=KD.CONST.MinClientWidth,n=$(window).innerHeight(),o=$(window).innerWidth();i>n&&(n=i),a>o&&(o=a),void 0===KD.lastHeight&&(KD.lastHeight=n),void 0===KD.lastWidth&&(KD.lastWidth=o);var r=n-KD.lastHeight,s=o-KD.lastWidth,l=!1,d=!1;(r>t||-1*t>r)&&"100%"!=KD.lastHeight&&(l=!0),(s>e||-1*e>s)&&"100%"!=KD.lastWidth&&(d=!0),KD.lastWidth==a&&KD.lastHeight==i&&(i>=n||a>=o)&&(l=!1,d=!1);var c=$("#MainPanel"),h=document.rootForm,u=h.getControl.call(h),p=!1;l&&d?(p=!0,c.css({"min-height":n,width:o,"min-width":o}),u.css({height:n,width:o}),$(document.body).css({"min-height":n>i?n:i}),KD.lastWidth=o,KD.lastHeight=n):l?(p=!0,$(document.body).css({"min-height":n>i?n:i}),c.css({"min-height":n}),u.css({height:n}),KD.lastHeight=n):d&&(p=!0,c.css({width:o,"min-width":o}),u.css({width:o}),KD.lastWidth=o),p&&(KD.lastDetaHeight=r,KD.lastDetaWidth=s,KD.writeLogTime("KD.resetAppSize Begin: ","(dH="+r+",dW="+s+"),change:"+p,!0),KD.initClientParameters(),h.doLayout&&h.doLayout.call(h)),p&&KD.writeLogTime("KD.resetAppSize End  : ","(h="+n+",w="+o+"),change:"+p,!0)}finally{KD.delayInvoke(function(){KD.isKDScriptBusy(!1)}),KD.resetAppSize.actionName="KD.resetAppSize",KD.circleInterval=KD.delayInvoke(KD.resetAppSize,3e3,!0)}}},window.onerror=function(e,t,i,a,n){KD.writeLog(e+"+++++++++"+t,n,!1),console.error&&(console.error("错误信息：",e),console.error("出错文件：",t),console.error("错误详情：",n))},KD.getK3CloudLoginInfo=function(){var e=void 0;return"function"==typeof ClientAppProxy&&(e=ClientAppProxy.Current?ClientAppProxy.Current.CTX:void 0),e?{username:e.UserName,userid:e.UserId,dbid:e.DBid,usertoken:e.UserToken}:{}},KD.generateUserHashID=function(){var e=KD.getK3CloudLoginInfo();return"C_"+e.username+"_"+e.userid+"_"+e.dbid},KD.resetLocalConfiguration=function(){delete KD.__localSettings,KD.storage.removeItem(KD.CONST.LocalConfigurationKey)},KD.getLocalConfiguration=function(e){var t=KD.__localSettings=KD.__localSettings||KD.parseObject(KD.storage.getItem(KD.CONST.LocalConfigurationKey)||"{}"),i={MessageDisTime:3,SelectRowBackground:"#E0E8FF",DefaultRowBackground:"#E0E8FF",MinusNumColor:"#E74C3C",FontSize:"12px",PrintNoPrompt:!1,UseClientPrinterSetting:!1,FixedTableSelectColumns:!1,IsReadOnlyTextWrap:!1,ThemeChooser:"standard",NotShowUtcOffset:!1},a="";return a=e&&e.Context&&e.Context.UserId?"C_"+e.Context.UserName+"_"+e.Context.UserId+"_"+e.Context.DBid:KD.generateUserHashID(),$.extend(i,t[a])},KD.convertToPX=function(e){var t=parseInt(KD.getLocalConfiguration().FontSize||12);return e*t},KD.setAsynchronousFilter=function(e){e=$(e),e&&e.length>0&&KD.getCurrentBrowsType().type!=KD.CONST.BrowsType.Chrome&&e.unbind("compositionend").bind("compositionend",function(e){var t=jQuery.Event("keydown");t.keyCode=17,$(this).trigger(t)})},KD.converToJqId=function(e){var t=e;return KD.isString(t)&&(t=t.replace(/\@/g,"_a_").replace(/\$/g,"_s_")),t},KD.getCurrentFontsize=function(){var e=KD.getLocalConfiguration().FontSize||12;return parseInt(e)},KD.convertToHtmlString=function(e,t){e=e||"";var i;return e.replace&&$.isFunction(e.replace)?(i=e.replace(/\r\n|\n/g,"<br/>"),(void 0==t||1==t)&&(i=i.replace(new RegExp(" ","g"),"&nbsp;"))):i=e,i},KD.extendObject=function(e,t){return $.extend(e,t),e},KD.GetWinServiceIsInstalled=function(e){var t=!1,i=function(e){t=e};return $.ajax({async:!1,url:"https://localhost:8022/RunningProcess.kcapi?Kingdee.BOS.DeskClient.WinService",success:function(e){var t=!1;if(e.ProcessCount){var a=e.ProcessCount;"1"==a&&(t=!0)}i(t)},error:function(e){i(!1)}}),t},KD.checkDeskShellStatus=function(){try{var e=KD.GetDeskShellStatus(),t=null;switch(e){case"1":case"49":case"Installed":t=!0;break;case"0":case"48":case"NotInstalled":t=!1;break;default:t=null}return t}catch(i){return null}},KD.openK3CloudApp=function(e,t,i,a,n){var o=e.indexOf("from=yzj")>=0,r=n?!1:KD.checkDeskShellStatus();o&&!r&&(r=KD.GetWinServiceIsInstalled()),1==r?KD.OpenDeskApp(e):KD.openCloudAppTipsWin(e,t,i,a,o)},KD.openCloudAppTipsWin=function(e,t,i,a,n){win=KD.genDisplayWindow(t,a),win.Width=540,win.Height="auto",KD.IsNullOrWhiteSpace(a)||win.Content.find(".kd-window-des").addClass("k3cloudapp-run-state-des"),win.Content.css({padding:"20px 25px 15px 25px"});var o=KD.genClientDownloadPanel(e,i,win);n&&(o=KD.genYZJClientDownloadPanel(e,i,win)),$(win.Content).append(o),windowData=win.ShowDialog(),$(".windowColseHandle",win.Content).off("click").on("click",function(t){$(this).hasClass("k3cloudapp-configure-btn")?windowData.close():(KD.OpenDeskApp(e),KD.delayInvoke(function(e){windowData.close()},900))}),KD.isMacOS()&&win.Content.find(".kd-setup-download-handle").off("click").on("click",function(e){e.preventDefault(),KDMessageBox.show({name:ResManager.LoadKDString("金蝶提示","099002000000002"),msg:ResManager.LoadKDString("该应用是windows应用，系统不支持。","0025372030032766"),type:KDMessageBox.KDMesBoxType.Warning,button:KDMessageBox.KDMessageBoxButtons.Ok})})},KD.genDisplayWindow=function(e,t){var i=new KD.KDWindowBase;i.Title=e,i.MinWidth=250,i.MinHeight=100;var a=$('<div style="padding:35px 78px"></div>');if(!KD.IsNullOrWhiteSpace(t)){var n=$('<div class="kd-window-des" style="margin-left:10px;display:inline-block;"></div>');n.html(t),a.append(n)}return i.Content=a,i},KD.genHyperLinkButton=function(e,t,i){return"<a href="+t+' class="windowColseHandle" target="_blank">'+(e||ResManager.LoadKDString("点击打开","0991733000003988"))+"</a>"},KD.genClientDownloadPanel=function(e,t,i){var a=(e.toString().replace(/'/g,'"'),KD.format('<a class="k3cloudapp-configure-step-link" href="{helper}" target="_blank">{0}</a>',ResManager.LoadKDString("说明文档","0991733000008469"))),n=(KD.format('<a class="k3cloudapp-configure-step-link kd-setup-download-handle" href="{setupZipProgram}" target="_blank">{0}</a>',ResManager.LoadKDString("压缩包","0991733000003995")),KD.format('<a class="k3cloudapp-configure-step-link kd-setup-download-handle" href="https://localhost:8022/Version.kcapi" target="_blank">{0}</a>',ResManager.LoadKDString("点击这里","0991733000003554"))),o='<div class="k3cloudapp-configure"><div class="k3cloudapp-title">'+ResManager.LoadKDString("请通过以下步骤完成操作","0991733000008496")+'</div><div class="k3cloudapp-configure-container"><div class="k3cloudapp-configure-step-index">1</div><div style="margin-left: 70px;"><a class="k3cloudapp-configure-step kd-setup-download-handle" href="{setupProgram}" target="_blank">'+ResManager.LoadKDString("下载并安装引导程序","0991733000003991")+(1==KD.checkDeskShellStatus()?'<span style="font-size:9pt;color:green;">'+ResManager.LoadKDString("(已安装)","0991733000008391")+"</span>":"")+'</a><div class="k3cloudapp-configure-step-des">'+kendo.format(ResManager.LoadKDString("如果已安装可直接执行第二步，也可根据{0}手工配置。","0991733000003556"),a)+"<br/>"+kendo.format(ResManager.LoadKDString("如果反复出现该对话框，请{0}对https证书访问进行授权，可解决反复弹框问题。","0991733000003557"),n)+'</div></div></div><div class="k3cloudapp-configure-container"><div class="k3cloudapp-configure-step-index">2</div><div style="margin-left: 70px;"><a id="openDeskAppLink" class="windowColseHandle k3cloudapp-configure-step" attrUrl="'+e+'" target="_blank" >'+t+'</a></div></div><div class="k3cloudapp-configure-btn windowColseHandle">'+ResManager.LoadKDString("我知道了","0025710030032401")+"</div></div>";return o=o.replace("{setupProgram}","/K3Cloud/Clientbin/K3CloudClientPortal.exe").replace("{helper}","/K3Cloud/Help/ClientHelp.htm").replace("{setupZipProgram}","/K3Cloud/Clientbin/K3CloudClientPortal.zip")},KD.genYZJClientDownloadPanel=function(e,t,i){var a=!KD.isEmpty(e)&&!KD.isEmpty(t),n=(e.toString().replace(/'/g,'"'),"K3CloudClienter"),o=KD.format('<a class="k3cloudapp-configure-step-link kd-setup-download-handle" href="{setupZipProgram}" target="_blank">{0}</a>',ResManager.LoadKDString("压缩包","0991733000003995")),r='<div class="k3cloudapp-configure"><div class="k3cloudapp-title">&nbsp;</div><div class="k3cloudapp-configure-container"><div class="k3cloudapp-configure-step-index">1</div><div style="margin-left: 70px;"><a class="k3cloudapp-configure-step kd-setup-download-handle" href="{setupProgram}" target="_blank">'+ResManager.LoadKDString("下载并安装金蝶云星空服务","00214298000005382")+(1==KD.checkDeskShellStatus(),"")+'</a><div class="k3cloudapp-configure-step-des">'+kendo.format(ResManager.LoadKDString("第一次下载并安装完成后，请在弹窗填写访问金蝶云星空的服务器地址（如https://kingdee.ik3cloud.com/K3cloud/）并运行客户端；如已经安装请按提示检查其他步骤；如果无法直接下载并安装，可将{0}下载到本地，解压后执行安装即可。","00215181030035315"),o)+'</div></div></div><div class="k3cloudapp-configure-container"><div class="k3cloudapp-configure-step-index">2</div><div style="margin-left: 70px;"><div class="k3cloudapp-configure-step" style="cursor:default;text-decoration:none;color:inherit;">'+kendo.format(ResManager.LoadKDString("检查并启用服务({0})","00214298000005384"),n)+'</div><div class="k3cloudapp-configure-step-des">'+(a?kendo.format(ResManager.LoadKDString("确认已经安装该服务，Windows的任务管理器查看服务({0})是否启用，没有启用则点击启用；如果已经启用服务，请执行第三步更新服务。","00214298000005385"),n):kendo.format(ResManager.LoadKDString("确认已经安装该服务，Windows的任务管理器查看服务({0})是否启用，没有启用则点击启用。","00214298000004653"),n))+"</div></div></div>";return a&&(r=r+'<div class="k3cloudapp-configure-container"><div class="k3cloudapp-configure-step-index">3</div><div style="margin-left: 70px;"><a id="openDeskAppLink" class="windowColseHandle k3cloudapp-configure-step" attrUrl="'+e+'" target="_blank" >'+t+'</a><div class="k3cloudapp-configure-step-des">'+kendo.format(ResManager.LoadKDString("确认已经安装并且已经启用服务({0})，点击会自动更新服务，并且更新完成后自动登录云之家。","00214298000005386"),n)+"</div></div></div>"),r=r+'<div class="k3cloudapp-configure-btn windowColseHandle">'+ResManager.LoadKDString("我知道了","0025710030032401")+"</div></div>",r=r.replace("{setupProgram}","/K3Cloud/Clientbin/K3CloudClientPortal.exe").replace("{helper}","/K3Cloud/Help/ClientHelp.htm").replace("{setupZipProgram}","/K3Cloud/Clientbin/K3CloudClientPortal.zip")},KD.isClientUrl=function(e){return KD.IsNullOrWhiteSpace(e)?!1:e.toLowerCase().startsWith("k3cloud://")||-1!=e.indexOf("ExeType=WPFRUNTIME")||-1!=e.indexOf("ExeType=RPTIDE")||-1!=e.indexOf("ExeType=NOTEDESIGNER")||-1!=e.indexOf("ExeType=BOSIDE")},KD.getTipsConfiguration=function(){var e=KD.parseObject(KD.storage.getItem("TipsConfiguration")||"{}"),t={showConsoleTips:!0,showBillDashBoardTips:!0};return e[KD.generateUserHashID()]||t},KD.writeSecureLog=function(){console&&console.log&&(console.log("%c  金蝶警告！","font-size:50px;color:red;-webkit-text-fill-color:red;-webkit-text-stroke: 1px black;"),console.log("%c禁止在此粘贴执行任何内容，这可能会导致你的账号受到攻击！","font-size:14px;"))},KD.QingDesktop=function(){qing&&!qing.isGalaxyDesktop&&(qing.use("desktop-remote",{timeout:2e4,saas:!1,error:function(e){console.log(e)}}),qing.isGalaxyDesktop=!0)},KD.DynaLoadJS=function(e,t){var i=$("head");e&&i.remove("#"+e),t&&$("<script charset='utf-8' async></script>").attr({src:t,type:"text/javascript",id:e}).appendTo(i)},KD.formatHtmlColor=function(e){if(KD.IsNullOrWhiteSpace(e))return e;if(e=e.trim(),!(e.length>7))return e.toUpperCase();var t;return e.indexOf("#00")>-1?void(t=""):e.replace("#FF","#").toUpperCase()},KD.dynamicResAddin=function(e,t){var i=$(KD.format("#{0}",e||t));0!=i.length||KD.isEmpty(t)||$("<script charset='utf-8' async></script>").attr({src:t,type:"text/javascript",id:e}).appendTo($("head"))},KD.newFileUpSecByCryptoJS=function(e){function t(e){var t=CryptoJS.enc.Base64.stringify(e),i=new RegExp("/","g");return t=t.replace(/=+$/,"").replace(/\+/g,"-").replace(i,"_")}if(KD.isEmpty(e))return"";var i=JSON.stringify(KD.CONST.newFileUpHeaderSec),a=JSON.stringify(e),n=t(CryptoJS.enc.Utf8.parse(i))+"."+t(CryptoJS.enc.Utf8.parse(a)),o=t(CryptoJS.HmacSHA256(n,KD.CONST.newFileUpSec));return n+"."+o},KD.getDataMaskTextTips=function(){var e=kendo.format("{0}&#10;{1}&#10;{2}",ResManager.LoadKDString("一键切换明文显示：Ctrl+Alt+K","00215181000007584"),ResManager.LoadKDString("一键切换脱敏显示：Ctrl+Alt+P","00215181000008804"),ResManager.LoadKDString("管理员可以通过“隐私中心-脱敏方案配置”进行设置","00215181000007586"));return e},KD.dataURLToBlob=function(e,t){var i=e.split(",");if(!t){var a=i[0].match(/:(.*?);/);t=a&&a.length>1?a[1]:""}for(var n=i.length>1?window.atob(i[1]):"",o=n.length,r=new ArrayBuffer(o),s=new Uint8Array(r);o--;)s[o]=n.charCodeAt(o);return new Blob([r],{type:t})},KD.imgCompress=function(e){if(!KD.isObject(e))return!1;var t=e.file||void 0,i=e.successful;e.fail;if(!t)return!1;!function(e){var t=new Image,i=new FileReader;i.onload=function(e){t.src=e.target&&e.target.result},i.readAsDataURL(e),t.onload=function(){a(t)}}(t);var a=function(e){var a=1;if(null!=t.size){t.size>1e6&&t.size<3e6?a=.8:t.size>3e6&&t.size<5e6?a=.4:t.size>5e6&&t.size<1e7?a=.1:t.size>1e7&&(a=.01);var n=a;a=1e6/t.size,a=Math.floor(100*Math.sqrt(a))/100,(a>.8||n>a)&&(a=n);var o=document.createElement("canvas"),r=o.getContext("2d"),s=e.width,l=e.height,d=s*a,c=l*a;o.width=d,o.height=c,r.clearRect(0,0,d,c),r.drawImage(e,0,0,d,c);var h=t.type,u=o.toDataURL(h,a),p=KD.dataURLToBlob(u,h),g=new window.File([p],t.name,{type:h,lastModified:t.lastModified});g&&KD.isFunction(i)&&i(g)}}},!function(e){e.fly=function(t,i){var a={version:"1.0.0",autoPlay:!0,vertex_Rtop:20,speed:1.2,start:{},end:{},onEnd:e.noop},n=this,o=e(t);n.init=function(e){this.setOptions(e),!!this.settings.autoPlay&&this.play()},n.setOptions=function(t){this.settings=e.extend(!0,{},a,t);var i=this.settings,n=i.start,r=i.end;o.css({marginTop:"0px",marginLeft:"0px",position:"fixed"}).appendTo("body"),null!=r.width&&null!=r.height&&e.extend(!0,n,{width:o.width(),height:o.height()});var s=Math.min(n.top,r.top)-Math.abs(n.left-r.left)/3;s<i.vertex_Rtop&&(s=Math.min(i.vertex_Rtop,Math.min(n.top,r.top)));var l=Math.sqrt(Math.pow(n.top-r.top,2)+Math.pow(n.left-r.left,2)),d=Math.ceil(Math.min(Math.max(Math.log(l)/.05-75,30),100)/i.speed),c=n.top==s?0:-Math.sqrt((r.top-s)/(n.top-s)),h=(c*n.left-r.left)/(c-1),u=r.left==h?0:(r.top-s)/Math.pow(r.left-h,2);e.extend(!0,i,{count:-1,steps:d,vertex_left:h,vertex_top:s,curvature:u})},n.play=function(){this.move()},n.move=function(){var t=this.settings,i=t.start,a=t.count,n=t.steps,r=t.end,s=i.left+(r.left-i.left)*a/n,l=0==t.curvature?i.top+(r.top-i.top)*a/n:t.curvature*Math.pow(s-t.vertex_left,2)+t.vertex_top;if(null!=r.width&&null!=r.height){var d=n/2,c=r.width-(r.width-i.width)*Math.cos(d>a?0:(a-d)/(n-d)*Math.PI/2),h=r.height-(r.height-i.height)*Math.cos(d>a?0:(a-d)/(n-d)*Math.PI/2);o.css({width:c+"px",height:h+"px","font-size":Math.min(c,h)+"px"})}o.css({left:s+"px",top:l+"px"}),t.count++;var u=window.requestAnimationFrame(e.proxy(this.move,this));a==n&&(window.cancelAnimationFrame(u),t.onEnd.apply(this))},n.destroy=function(){o.remove()},n.init(i)},e.fn.fly=function(t){return this.each(function(){void 0==e(this).data("fly")&&e(this).data("fly",new e.fly(this,t))})}}(jQuery),$.prototype.height=function(e){return function(){var t=this,i=arguments.length>0,a=i?arguments[0]:null;return i&&"function"==typeof e?e.call(t,a):a=e.call(t),!i&&0==a&&KD.isIeBrowser()&&t.is&&t.is(":visible")&&t.innerHeight&&(a=t.innerHeight()),i?t:a}}($.prototype.height),$.prototype.unload=function(e){return function(){var e=this,t=arguments.length>0,i=t?arguments[0]:null;return e.off("unload").on("unload",function(t){"function"==typeof i&&i.call(e,t)}),e}}(),function(){var e=KD.bizTipsUtils=KD.bizTipsUtils||{},t="BizTipsNumber",i="MasterId",a="CommunitySolutionCode";e.ToError=function(e){var n=ClientAppProxy.Current.defaultLocalId,o=KD.getLocalValue(n,e.Message),r=KD.getLocalValue(n,e.Description),s={};if(s.errorType=e.ErrorType,s.errorTitle=o,s.errorInfo=e.IsShowDetail?r:"",s[i]=e.MasterId,s[t]=e.Number,s[a]=e.CommunitySolutionCode,e.MsgInnerInfos&&KD.isArray(e.MsgInnerInfos)){var l=[];s.msgcontrol=l;for(var d in e.MsgInnerInfos)l.push(d)}return s},e.ToWanning=function(t){var i=e.ToMessage(t);return i},e.ToMessage=function(e){var n=ClientAppProxy.Current.defaultLocalId,o=KD.getLocalValue(n,e.Message);o||(o="[No Message]");var r=KD.getLocalValue(n,e.Description),s={};if(s.title=o,s.msg=e.IsShowDetail?r:"",s.moretext=e.IsShowDetail?r:"",s.option=e.MsgButtons,s.msgType=e.MsgType,s.id=e.CallBackActionId,s[i]=e.MasterId,s[t]=e.Number,s[a]=e.CommunitySolutionCode,e.MsgInnerInfos&&KD.isArray(e.MsgInnerInfos)){var l=[];s.msgcontrol=l;for(var d in e.MsgInnerInfos)l.push(d)}return s}}(),function(){var e=[],t=function(e,t,i){if(!e)return"";var a=[];for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];o&&(_isTypeOf(o,"function")||(_isTypeOf(o,"date")?o=o.getTime():_isTypeOf(o,"array")?o=o.join(","):_isTypeOf(o,"object")&&(o=JSON.stringify(o)),i&&(o=encodeURIComponent(o)),a.push(encodeURIComponent(n)+"="+o)))}return a.join(t||",")};window._$postMessage=function(){var a="MSG|",n=function(e){var i={};return e=e||{},i.origin=e.origin||"",i.ref=location.href,i.self=e.source,i.data=JSON.stringify(e.data),a+t(i,"|",!0)};return function(t,a){window.postMessage?(a=a||{},t.postMessage(JSON.stringify(a.data),i(a.origin))):e.unshift({w:t,d:escape(n(a))})}}();var i=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){return t=t||"",e.test(t)?RegExp.$1:"*"}}(),a=function(e,t,i){window.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},n=function(e){e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},o=function(e){n(e);var t=e.data||"null";r({data:t,origin:i(e.origin)})},r=function(e){var t=e.data;e.origin;if("string"==typeof t)try{var i=JSON.parse(t),a=i.pageid;if(ClientAppProxy&&a){var n=ClientAppProxy.Current.getAliveForm(a);n&&n.fireCustomEventsNoData.call(n,"$$MessageCustomerEvent","$$MessageCustomerEvent",JSON.stringify(i.putdata),null)}}catch(o){}},s=function(){var t="MSG|",a=function(e,t){for(var i,a=_isTypeOf(t,"function")?t:function(e){return e===t},n=null,o=0,r=e.length-1;r>o;o++)i=e[o],a(i)&&(n=o);return null!=n?n:-1},n=function(){var t,i=function(e,i,n){a(t,e.w)<0&&(t.push(e.w),n.splice(i,1),e.w.name=e.d)};return function(){if(t=[],e&&e.length)for(var a,n=e.length;n--;n>=0)a=e[n],i(a,n,e);t=null}}(),o=function(){var e=unescape(window.name||"");if(e&&0==e.indexOf(t)){window.name="";for(var a=e.replace(t,""),n=a.split("|"),o=n.length,s={},l=0;o>l;l++){var d=n[l].split("=");if(!d||!d.length)return;var c=d.shift();if(!c)return;s[decodeURIComponent(c)]=decodeURIComponent(d.join("="))}a=s;var h=(a.origin||"").toLowerCase();h&&"*"!=h&&0!=location.href.toLowerCase().indexOf(h)||r({data:a.data||"null",origin:i(a.ref||document.referrer)})}};return function(){setInterval(n,100),setInterval(o,20)}}(),l=function(){window.postMessage?a(window,"message",o):s()};return l()}(),function(){window.getpostmessageargs=function(){var e="";return KD.isEmpty(window._$postmessageargs)||(e=window._$postmessageargs),e},window.clearpostmessageargs=function(){KD.isEmpty(window._$postmessageargs)||(window._$postmessageargs="")},window.doOpenerInvokeActions=function(e,t){try{if(KD.isEmpty(e))return;if(KD.isEmpty(t)&&(KD.isArray(e)||e.length>0)){var i=e;e=i[0],t=i[1]}var a=ClientAppProxy.Current.getAliveForm(e);if(!KD.isEmpty(a)){for(var n=KD.parseObject(t),o=[],r=0;r<n.length;r++){var s=n[r];o.push({actionname:s[0]||"",params:s[1]||null})}o.length>0&&a.doActions.call(a,o)}}catch(l){KD.writeLog("targetPageId = ",e),KD.writeLog("actsStr = ",t),KD.writeError(l)}},window.initFrameData=function(e){KD.writeLog("initFrameData::",KD.stringify(e))}}(),function(e){$(document.body).off("compositionstart").off("compositionend").on("compositionstart",function(){(e||{}).isImeInputing=!0,KD.isDebug()&&KD.writeLog("document.body.compositionstart","KD.isImeInputing = true",!0)}).on("compositionend",function(){(e||{}).isImeInputing=!1,KD.isDebug()&&KD.writeLog("document.body.compositionstart","KD.isImeInputing = false",!0)})}(KD),function(e){function t(t){try{if(t&&t.ctrlKey&&t.altKey){var i=t.keyCode||t.which||t.charCode;if(120==i){e.stopPropagation(t);var a=ClientAppProxy.Current.getRootForm();a&&a.onExecCommand.call(a,t)}}}catch(n){e.writeLog(n.message,"",!0)}}$(document.body).off("keyup",t).on("keyup",t)}(KD),define("KD",["KDMessageBox","ResManager","jqueryk3cloudex","MicrosoftAjax","KD.CONST","stringBuilder","gzipcompressor"],function(e){return function(){var t;return t||e.KD}}(this));var KDKeyNavigate=KDKeyNavigate||{initEnter2tab:function(e,t){if(!t||"kdmaintab"!=t.xtype&&"tabpanel"!=t.xtype){(e.is(":input")||e.is(":text"))&&e.addClass("kd_Enter2tab");var i=e.find(":input").length>0?e.find(":input"):e.find(":text");i&&i.length>0&&$(i[0]).addClass("kd_Enter2tab");var a=e.parent().find("span[tabindex=0]");a&&a.length>0&&a.addClass("kd_Enter2tab")}},onKeyNavigate:function(e,t,i){if(13==i.keyCode){if(t&&("kdmaintab"==t.xtype||"tabpanel"==t.xtype))return!0;var a=e,n=e.find(".kd_Enter2tab");return n&&n.length>0&&(a=$(n[0])),!a.is("textarea")&&!a.is("table")||i.ctrlKey||i.shiftKey||9===i.keyCode?a.is(".k-link")&&13==i.keyCode?!0:(this._goAfter(a,i.shiftKey),!1):!0}},_goAfter:function(e,t){var t=!!t,i=this._getAfter(e,t);i&&i.focus&&i.focus()},_getAfter:function(e,t){t=!!t;for(var i,a=this._getKeyboardList(),n=a.index(e),o=e.is(":radio"),r=e.attr("name");;){if(t?(n--,n=n>=0?n:a.length-1):(n++,n=n>a.length-1?0:n),i=a.eq(n),i[0]==e[0]){i=null;break}if(!o||!i.is(":radio")||r!=i.attr("name"))break}if(i&&i.is(":radio")){var s,l=i.attr("name");l&&(s=a.filter(':radio:checked[name="'+l+'"]:eq(0)'),i=s[0]?s:i)}return i},_getKeyboardList:function(){return $(".kd_Enter2tab:visible:not(.k-state-disabled):not(:disabled)").filter(function(e){return this.tabIndex>=0}).each(function(e,t){t.enter2tabSortKey=e}).sort(function(e,t){return e.tabIndex==t.tabIndex?e.enter2tabSortKey-t.enter2tabSortKey:e.tabIndex-t.tabIndex})}};define("KDKeyNavigate",["KD"],function(e){return function(){var t;return t||e.KDKeyNavigate}}(this)),KDFloatingManager=function(){},KDFloatingManager.instance=new KDFloatingManager,$.extend(KDFloatingManager.prototype,{allowFloating:!0,floatingPages:{},duckList:[],itemMap:{},registerPage:function(e,t){this.floatingPages[e]=void 0===t?!0:t},setFloat:function(e,t,i,a){if(this.allowFloating&&this.floatingPages[e]){t=$(t);var n=t.attr("id"),o={};if(o=this.duckList[e]?this.duckList[e]:{top:{totalPx:this._getFloatDefaultValue("top"),items:[]},right:{totalPx:0,items:[]},left:{totalPx:0,items:[]},bottom:{totalPx:0,items:[]}},o[i.dock]&&n){var r=!1,s=0;for(s in o[i.dock].items)if(o[i.dock].items[s].id==n){r=!0;break}var l=null;if(r?(l=o[i.dock].items[s],l.otherSideDockValue=i.otherSideDockValue,l.ParentWidthOrHeightValue=i.ParentWidthOrHeightValue):(l=$.extend({id:n,px:this.__getPx(t,i),oDockValue:t.css(i.dock),oWidthOrHeightValue:t[0].style[i.WidthOrHeightName],isShow:!0,dock:"top",WidthOrHeightName:"width",ParentWidthOrHeightValue:"100%",otherSideDockName:"left",otherSideDockValue:"auto"},i),o[i.dock].items.push(l),this.itemMap[n]=l,this.duckList[e]=o),!t.hasClass("kd-el-floating")||a){var d={};d[l.WidthOrHeightName]=l.ParentWidthOrHeightValue;for(var c=0,h=null,u=null,s=0;5>s&&(h=u||ClientAppProxy.Current.getAliveForm(e),!h||!h.isTabChildForm);s++){var p="";if(p=h&&h.hostWindowProxy&&h.hostWindowProxy.getPageId&&h.hostWindowProxy.getPageId(),u=ClientAppProxy.Current.getAliveForm(p),!u)break;var g=this.duckList[u.baseId];if(g){var f=g[i.dock].totalPx;f>0&&(f-=this._getFloatDefaultValue(i.dock)),f=0>f?0:f,c+=f}}c=0>c?0:c,d[i.dock]=o[i.dock].totalPx+c,t.addClass("kd-el-floating").css(d)}var m={};m[l.otherSideDockName]=l.otherSideDockValue,m[l.WidthOrHeightName]=l.ParentWidthOrHeightValue,t.css(m),r&&!a&&l.isShow||(o[i.dock].totalPx+=l.px,this.duckList[e]=o),l.isShow=!0}}},_getFloatDefaultValue:function(e){var t=0;return"top"==e&&KD.CONST.IsBillHeadFloat&&(t=KD.getBillHeadHeight(!1)),t},setSink:function(e,t){if(this.allowFloating&&this.floatingPages[e]){t=$(t);var i=t.attr("id"),a=this.itemMap[i];if(t.hasClass("kd-el-floating")&&a&&a.isShow){var n={};n=this.duckList[e]?this.duckList[e]:{top:{totalPx:this._getFloatDefaultValue("top"),items:[]},right:{totalPx:0,items:[]},left:{totalPx:0,items:[]},bottom:{totalPx:0,items:[]}},this.itemMap[i].isShow=!1;var o={};o[a.WidthOrHeightName]=a.oWidthOrHeightValue,o[a.dock]=a.oDockValue,t.removeClass("kd-el-floating").css(o),t.css(a.otherSideDockName,""),n[a.dock].totalPx=this._getFloatDefaultValue(a.dock);for(var r=0;r<n[a.dock].items.length;r++)a=n[a.dock].items[r],a&&a.id&&a.id==i?n[a.dock].items[r].isShow=!1:a.isShow&&this.setFloat(e,$("#"+a.id),a,!0)}}},__getPx:function(e,t){var i=0;switch(t.dock){case"left":case"right":i=$(e).width();break;case"top":case"bottom":i=$(e).height()}return i},clearPageData:function(e,t,i){this.floatingPages[e]&&delete this.duckList[e]},release:function(e,t,i){var a=$(t).attr("id"),n=KD.parseObject($(t).attr("data-attdata"));if(n&&"kdmenubar"==n.xtype&&delete this.floatingPages[e],void 0===t)delete this.duckList[e];else if(a){var o=this.duckList[e];for(var r in o){var s=o[r];if(s&&s.items)for(var l=0;l<s.items.length;l++){var d=s.items[l]||{};d.id==a&&(delete s.items[l],s.items.splice(l,1))}}}if(a){delete this.itemMap[a];var c=this[i.dock];if(c){$(c,{totalPx:0,items:[]});for(var r=0;r<c.items.length;r++)item=c.items[r],item&&item.id&&item.id==a&&c.items.splice(r,1)}}}}),define("KDFloatingManager",["jqueryk3cloudex"],function(e){return function(){var t;return t||e.KDFloatingManager}}(this)),DataBaseCategory={Normal:1,Archive:2,Report:3,ManagementCenter:4,MultiLanguageCenter:5},function(){KDCookieManager=window.KDCookieManager||{Const_sessionid:"kdservice-sessionid",Const_aspnetsessionkey:"ASP.NET_SessionId",Const_awselb:"AWSELB",kdSessionId:"",aspnetSessionId:"",renewKDSession:function(){KDCookieManager.setKDSessionId("v")},getKDSessionId:function(){return KDCookieManager.kdSessionId||(KDCookieManager.kdSessionId=KD.getKDSessionId()),KDCookieManager.kdSessionId},getAspNetSessionId:function(){return KDCookieManager.aspnetSessionId||(KDCookieManager.aspnetSessionId=KD.getAspNetSessionId()),KDCookieManager.aspnetSessionId},getAWSELB:function(){return KD.getConnectConfig().awselb||""},setKDSessionId:function(e){KDCookieManager.kdSessionId=e,KD.writeLog("setKDSessionId","kdsid="+e,!0)},setAspNetSessionId:function(e){KDCookieManager.aspnetSessionId=e,KD.writeLog("setAspNetSessionId","aspnetsid="+e,!0)},updateSessionId:function(e){e&&e.Context&&(KDCookieManager.setKDSessionId(e.KDSVCSessionId),KDCookieManager.setAspNetSessionId(e.Context.SessionId),KDCookieManager.writeToDocument())},setSessions:function(e){var t=/https\:\/\//.test(document.URL)&&"https://"==document.URL.substr(0,8).toLowerCase(),i=new Date;i.setSeconds(i.getSeconds()+60);var a={expires:i,secure:t},n=KDCookieManager.getAWSELB();n&&(KD.cookie.clear(KDCookieManager.Const_awselb),KD.cookie.write(KDCookieManager.Const_awselb,n,a));var o=KDCookieManager.getAspNetSessionId();KD.IsNullOrWhiteSpace(o)||KD.cookie.write(KDCookieManager.Const_aspnetsessionkey,o,a),KD.cookie.clear(KDCookieManager.Const_sessionid,a),KD.cookie.write(KDCookieManager.Const_sessionid,KDCookieManager.getKDSessionId(),a)},writeToDocument:function(){var e=KDCookieManager.getAspNetSessionId();KD.IsNullOrWhiteSpace(e)||(document.cookie=KD.format("{0}={1}",KDCookieManager.Const_aspnetsessionkey,e));var t=KDCookieManager.getKDSessionId();KD.IsNullOrWhiteSpace(t)||(document.cookie=KD.format("{0}={1}",KDCookieManager.Const_sessionid,t));var i=KDCookieManager.getAWSELB();i&&(document.cookie=KD.format("{0}={1}",KDCookieManager.Const_awselb,i))}},window.KDCookieManager=KDCookieManager}(),function(){function e(e,t){for(var i="",a="",n=e?e.serviceName||"":"",o=e?e.parameters||[]:[],r=void 0,s=0;s<o.length;s++)if("ap1"==o[s].key)a=o[s].value;else if("ap2"==o[s].key)i=o[s].value;else if("ap3"==o[s].key){r=o[s].value;break}var l={status:t,pageId:a,methodName:i,serviceName:n,txtParams:r};return l}KDServiceClient=function(){this.baseUrl=KD.getUrlRoot()},KDServiceClient.getTxtParameters=function(e){for(var t=new Array,i=1;i<e.length;i++){var a=new Object;a.key="ap"+(i-1),void 0===e[i]?a.value=null:a.value=e[i],
t.push(a)}return t},KDServiceClient.getContentType=function(){var e="text/json";return KD.isFirefox()&&(e="application/x-www-form-urlencoded"),e},KDServiceClient.compressApx=function(e){var t=e;if(ClientAppProxy.isCompressedApx())for(var i in t){var a=t[i];KD.isString(a)&&KD.isRunInForIn(i,t)&&(KD.equalsIgnoreCase((i||"__").substr(0,2),"ap")||KD.equalsIgnoreCase(i,"forminfo"))&&(t[i]=KD.urlEncodeComponent(KD.compress(KD.urlEncodeComponent(a))))}return t},KDServiceClient.runRequestQueue=function(e){var t=(new Date).getTime(),i=KDServiceClient.reqQueue=KDServiceClient.reqQueue||{items:[],isRunning:!1,lastReqTime:t,limitToReset:6e4,next:function(){var e=KDServiceClient.reqQueue;e.items.length>0&&(e.isRunning=!1,KDServiceClient.runRequestQueue())}};if(e?i.items.push(e):0==i.items.length&&(i.isRunning=!1),i.isRunning&&t-(i.lastReqTime||0)>i.limitToReset&&(i.isRunning=!1),!i.isRunning&&i.items.length>0){var a=i.items.shift(0,1);i.isRunning=!0,i.lastReqTime=t,a.scope.doPostAsyncCore.call(a.scope,a.uri,a.txtParams,a.request)}return i},KDServiceClient.isSeqRequest=function(){var e=!(0==KD.getConnectConfig().HTMLSeqReqEnabled||KD.equalsIgnoreCase("false",KD.getConnectConfig().HTMLSeqReqEnabled));return e},KDServiceClient.beforeLogoff=function(e){if(KDServiceClient.isSeqRequest()){KD.getConnectConfig().HTMLSeqReqEnabled=!1;var t=(new Date).getTime(),i=KDServiceClient.reqQueue||{};i.isRunning=!0,i.lastReqTime=t,KD.delayInvoke(function(){KD.isFunction(e)&&e()},200)}else KD.isFunction(e)&&e()},KDServiceClient.prototype={executeService:function(e){e.url=this.baseUrl+"/"+e.serviceName+"."+e.methodName+".common.kdsvc";var t=KDServiceClient.getTxtParameters(arguments);e.parameters=t,this.doExecuteAsync(e)},executeServiceByUrl:function(e){var t=KDServiceClient.getTxtParameters(arguments);e.parameters=t,this.doExecuteAsync(e)},doExecuteAsync:function(e){for(var t=new Object,i=e.parameters,a=0;a<i.length;a++)if("string"==typeof i[a].value){var n=i[a].value;t[i[a].key]=n}else{var n=JSON.stringify(i[a].value);t[i[a].key]=n}t.nonce="",t.v="1.0",t.format="1",t.sign="",t.timestamp=JSON.stringify(new Date),t.compressed=e.compressed,t.compressedapx=ClientAppProxy.isCompressedApx(),t.useragent="KD.HTML5.GZIP";var o=JSON.stringify(KD.getClientInfo());t.clientinfo=o,t.forminfo=JSON.stringify(KDServiceClient.getFormInfo(e)),1==KD.IsHtml5LoginForSilverlight&&(t.useragent="Silverlight AppDomain"),this.doPostAsync(e.url,t,e)},doSimulationAttack:function(e){if(ClientAppProxy.isSimulationAttack){ClientAppProxy.simulationAttackList||(ClientAppProxy.simulationAttackList=['><img src=x onerror=alert("xss");>',"<media location=x onload = alert(1);>",'<script>alert("sss");</script>','<iframe href="www.baidu.com"/>','alter(document.cookie.get("aaa"))']),ClientAppProxy.simulationAttackParamList||(ClientAppProxy.simulationAttackParamList=["ap0","ap1","ap2","ap3","ap4","ap5","ap6","format","clientinfo","useragent","v"]);var t=ClientAppProxy.simulationAttackParamList[ClientAppProxy.simulationAttackCurParam||0],i=ClientAppProxy.simulationAttackList[ClientAppProxy.simulationAttackTime||0];e[t]&&(e[t]=e[t]+i),ClientAppProxy.simulationAttackTime=((ClientAppProxy.simulationAttackTime||0)+1)%ClientAppProxy.simulationAttackList.length,ClientAppProxy.simulationAttackCurParam=((ClientAppProxy.simulationAttackCurParam||0)+1)%ClientAppProxy.simulationAttackParamList.length}},doPostAsync:function(e,t,i){var a=KDServiceClient.isSeqRequest();if(a){var n={scope:this,uri:e,txtParams:t,request:i};KDServiceClient.runRequestQueue(n)}else this.doPostAsyncCore(e,t,i)},doPostAsyncCore:function(t,i,a){var n=a;this.doSimulationAttack(i);var o=JSON.stringify(i),r=KDServiceClient.fetchBizMethod(a.methodName,i);i=KDServiceClient.compressApx(i);var s=JSON.stringify(i);KDServiceClient.updateLastTime(r,i);var l=KD.isIndex()&&t.indexOf("Kingdee.BOS.ServiceFacade.ServicesStub.ClienterService.GetServerCommonConfig.common.kdsvc")>0,d=KD.getReqBETimeString(),c=a.csrfToken||"",h=KDServiceClient.getRequestBizInfo(a)||"";$.ajax({url:t,async:void 0==a.async||a.async,data:KD.isFirefox()?i:s,type:a.type||"Post",contentType:KDServiceClient.getContentType(),beforeSend:function(e){e.setRequestHeader(KDCookieManager.Const_sessionid,KDCookieManager.getKDSessionId()),c&&e.setRequestHeader("CSRF-Token",c),h&&e.setRequestHeader("KDBIZ-Info",h),KDCookieManager.setSessions(l);var t=KD.cookie.read("Theme");(!t||KD.checkChinese(t))&&(t="standard",KD.cookie.write("Theme",t)),e.setRequestHeader("Theme",t)},jsonpCallback:function(){},success:function(a,s,l){if(KDServiceClient.isIdle(n),"string"==typeof a&&0==(a||"").indexOf("response_error"))return i.uri=t,i.debugMessage=KDServiceClient.debugMessage,KDServiceClient.writeReqLog(o,a,r,d),a=a.replace(/\n/g,"<br/>").replace(/\r\n/g,"<br/>").replace(/\\r\\n/g,"<br/>"),void(n.response_error?n.response_error.call(n.scope||n,a):KDMessageBox.show({sourceClass:"",sourceMethod:r,type:KDMessageBox.KDMesBoxType.Error,msg:"response_error",description:a}));var c=a;if(KDServiceClient.isCompressData(a))try{c=KD.utf8Decode(KD.decompress(a))}catch(h){c=a}i.uri=t,i.debugMessage=KDServiceClient.debugMessage,KDServiceClient.writeReqLog(o,c,r,d);var u=e(n,s);n.callback.call(n.scope||n,c,u,l),KDServiceClient.runRequestQueue().next()},error:function(e,a,o){i.uri=t,i.debugMessage=KDServiceClient.debugMessage;var s=[{actionname:"showConfirm",params:[{title:"",msg:e?KD.getReponseHttpCodeTipMessage(e.status):KD.format(ResManager.LoadKDString("未找到远程服务器或服务器强制中断请求! [{0}]","0025710000008513"),i.uri),option:0,msgType:KDMessageBox.KDMesBoxType.Warning}]}];KDServiceClient.writeReqLog(JSON.stringify(i),KD.stringify(s),r,d);var l=n.scope&&n.scope.errcallback?n.scope.errcallback:n.errcallback,c=n.scope?n.scope:n;c&&l.call(c,KD.stringify(s),a,o),KDServiceClient.runRequestQueue().next()}})}},$.extend(KDServiceClient,{IdleMin:10,getHttpWatchUrl:function(e){var t=KD.format("../help/httpwatcher/index.html{0}&token={1}",(KD.getConnectConfig()||{}).resVer||"?ver=1",e);return t},ignoreUpdateLastTimeMethods:{TimerElapsed:!0,QueryProgressValue:{ignoreUpdateLastTime:!0},CustomEvents:{smartRobotCircleReq:!0,smartRobotCircleMsg:!0},DoKDMessageConcentratorData:!0,CommitChildFormData:!0},getCSRFToken:function(e,t,i){var a="",n=16,o=e||"",r=t||"";if(!KD.isString(r)){var s=r||{};r=s.pageid||s.pageId||""}if(KD.isString(r)||(r=""),KD.equalsIgnoreCase("CallByUrl",o)){var l=(KD.isString(i)?i:"")||"",d=l.split("?"),c=d.length>1?d[1]:d[0],h=c.split("&");for(var u in h){var p=h[u],d=(p||"").split(/=/g);if(KD.isString(p)&&KD.equalsIgnoreCase("pageid",d[0]||"")){r=d[1]||"";break}}}if(!KD.equalsIgnoreCase("MainPageId",r)){var g=r.replace(/-/g,""),f=g.length>n?n:g.length;g=g.substr(0,f);var m=KDServiceClient.getNonce()+"&"+g+"&"+(new Date).getTime().toString();m=KD.base64Encode(KD.utf8Encode(m)),a=m}return a},getNonce:function(){for(var e=6,t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i="",a=e;a>0;--a)i+=t[Math.floor(Math.random()*t.length)];return i},showWatcherPop:function(e){var t=KDServiceClient.getHttpWatchUrl(e);KDServiceClient.logWatcher=KD.openPage(t,"_newwindow"," ")},showWatcher:function(e){if($("#watchersh").length>0){var t=$("#watchersh").data("kendoWindow"),i=t.isMinimized();return void(i?t.open():t.minimize())}var a=KDServiceClient.getHttpWatchUrl(e);$(document.body).append('<div class="kd-httpwatcher"><div id="watchersh"></div></div>'),$("#watchersh").kendoWindow({actions:["Minimize","Maximize","Close"],content:a,pinned:!0,scrollable:!1,height:750,width:650,title:ResManager.LoadKDString("http数据监控","0025710000004015"),position:{top:20,left:10},refresh:function(e){try{KDServiceClient.logWatcher&&KDServiceClient.logWatcher.initSplitter&&KDServiceClient.logWatcher.initSplitter()}catch(t){console&&console.log&&console.log(t.message,t.stack)}},iframe:!0,close:function(e){return KDServiceClient.logwatcherClearLog(),setTimeout(function(){var e=$("#watchersh"),t=e.data&&e.data("kendoWindow");t&&t.destroy&&t.destroy(),e.remove(),delete KDServiceClient.logWatcher},300),!0}}),$("#watchersh").data("kendoWindow").minimize(),KDServiceClient.logWatcher=$(".k-content-frame")[0].contentWindow},fetchBizMethod:function(e,t){var i="";try{if("CallByUrl"==e){var a=t.ap0,n=a.indexOf("methodname=")+"methodname=".length,o=a.substring(n).indexOf("&");i=t.ap0.substring(n).substr(0,o)+"."+e}else i="Call"==e?t.ap2:e}catch(r){i=e}return i},registerIgnoreUpdateTime:function(e,t){var i=e?KDServiceClient.ignoreUpdateLastTimeMethods[e]:void 0;KD.isEmpty(i)&&(i=t?{}:!0),t&&!KD.isObject(i)&&(i={},i[e]=!0),t&&(i[t]=!0),KDServiceClient.ignoreUpdateLastTimeMethods[e]=i},isIgnoreUpdateLastTime:function(e){var t=!1,i=e.methodName,a=e.txtParams,n=i?KDServiceClient.ignoreUpdateLastTimeMethods[i]:void 0;if(!KD.isEmpty(n))if(t=!1,1==n)t=!0;else if(KD.isObject(n)){var o=KD.isArray(a)?a:KD.parseObject(a.ap3||[]),r=KD.isArray(o)&&o.length>1?o[1]||"":i,s=KD.isArray(o)&&o.length>3?o[3]||"":i;r&&1==n[r]?t=!0:"QueryProgressValue"==i&&1==n[s]&&(t=!0)}return t},updateLastTime:function(e,t){var i={methodName:e,txtParams:t};KDServiceClient.isIgnoreUpdateLastTime(i)||(KDServiceClient.LastReqTime=KDServiceClient.getNowMinutes())},getNowMinutes:function(){var e=0,t=new Date;if($.isFunction(t.getHours)){var i=t.getHours(),a=t.getMinutes(),n=t.getSeconds();e=60*i+a+n/60}return e},setIdleMin:function(e){try{KDServiceClient.IdleMin=(e||300)/60}catch(t){KDServiceClient.IdleMin=5}},isIdle:function(e){var t=!1,i=KDServiceClient.getNowMinutes(),a=KDServiceClient.LastReqTime,n=i-a;t=n>=KDServiceClient.IdleMin;var o={timeoutInfo:{escapeMin:n.toFixed(3),isIdle:t,last:a.toFixed(3),now:i.toFixed(3),idleMin:KDServiceClient.IdleMin}};return KDServiceClient.debugMessage=KD.stringify(o),t},isCompressData:function(e){var t="H4sIAAAAAAAEA";return e.length>t.length&&e.substr(0,t.length)==t},logwatcherWriteLog:function(e,t){try{var i=KDServiceClient.logWatcher,a={message:KD.isString(e)?e:KD.stringify(e),description:KD.isString(t)?t:KD.stringify(t),invokeMth:"writeLog"};KD.equalsIgnoreCase(typeof i.postMessage,"function")?i.postMessage(a,"*"):i.writeLog&&i.writeLog(e,t)}catch(n){console&&console.log&&console.log(n.message,n.stack)}},logwatcherWriteReqLog:function(e,t,i,a,n){try{var o=KDServiceClient.logWatcher,r={message:KD.isString(e)?e:KD.stringify(e),description:KD.isString(t)?t:KD.stringify(t),method:i,reqTime:a,endTime:n,invokeMth:"writeReqLog"};KD.equalsIgnoreCase(typeof o.postMessage,"function")?o.postMessage(r,"*"):o.writeReqLog&&o.writeReqLog(e,t,i,a,n)}catch(s){console&&console.log&&console.log(s.message,s.stack)}},logwatcherClearLog:function(){try{var e=KDServiceClient.logWatcher,t={invokeMth:"clearLog"};KD.equalsIgnoreCase(typeof e.postMessage,"function")?e.postMessage(t,"*"):e.clearLog&&e.clearLog()}catch(i){console&&console.log&&console.log(i.message,i.stack)}},writeLog:function(e,t){try{var i=this,a=KDServiceClient.logWatcher;if(!a||a.closed){delete a,delete KDServiceClient.logWatcher,this.showWatcher();var n=setTimeout(function(){clearTimeout(n),i.logwatcherWriteLog(e,t)},300)}else i.logwatcherWriteLog(e,t)}catch(o){console&&console.log&&console.log(o.message,o.stack)}},writeReqLog:function(e,t,i,a){try{var n=this,o=KDServiceClient.logWatcher,r=15e4;if(o)if(o.closed)delete KDServiceClient.logWatcher;else{var s=KD.getReqBETimeString(a),l=(e||"").length,d=(t||"").length;l>r&&(e=KD.format(" Posted data is out of {0} kb. \r\n length = {1} kb",r/1e3,l/1e3)),d>r&&(t=KD.format(" Received data is out of {0} kb. \r\n length = {1} kb",r/1e3,d/1e3)),n.logwatcherWriteReqLog(KD.htmlUtil.encode(e),KD.htmlUtil.encode(t),KD.htmlUtil.encode(i),a,s)}}catch(c){console&&console.log&&console.log(c.message,c.stack)}},getFormInfo:function(e){var t={};try{var i=(e||{}).scope||{};t=KD.isFunction(i.getFormId)?{scope:i.getFormId.call(i)}:KD.isEmpty(i[0])?{scope:"all"}:{scope:KD.format("{0}_{1}",i[0].tagName,i[0].id)}}catch(a){t={}}return t},getRequestBizInfo:function(e){var t={};try{var i=(e||{}).scope||{};void 0===i.dformConfig&&KD.isFunction(i.getFormProxy)&&(i=i.getFormProxy.call(i));var a=(e||{}).parameters||[],n=(e||{}).methodName||"",o=i.dformConfig||{},r=o.serviceName||"",s=o.loadUrl||"",l=o.formid||"",d=(a.length>2?(a[2]||{}).value:"")||n||"";if(KD.equalsIgnoreCase(d,"CallByUrl")){var c=(a[0]||{}).value||"",h=new RegExp(/methodname\=[\w|W^&]{1,}\&/);d=(h.exec(c)[0]||"").substr("methodname=".length).replace("&","")}if(/get[a-z,A-Z,0-9]{0,}metadata/i.test(d)){var u="servicename=",p=(s.match("[^|&]"+u+"([^&]*)(&|$)")[0]||"").replace(/\&/g,"");r=p.substr(u.length+1)}if(!r){var g=((e||{}).url||"").split("/");g=(g[g.length-1]||"").split(".common.kdsvc"),g=(g[0]||"").split("."),r=g.length>1?g[g.length-2]:r,n=g.length>0?g[g.length-1]:n}l&&(t.t=l),t.m=t.t?d:n,r&&(t.s=r)}catch(f){}finally{t.sd=t.sd||KD.getSubDomainName(),t.c="HTML5"}return KD.stringify(t)}})}(),LoginInfo=function(){},LoginInfo.prototype={Username:"",Password:"",AcctID:"",Lcid:"",AuthenticateType:"",ValidationCode:"",EncyptType:1,PasswordIsEncrypted:!1},ClienterServiceProxy=function(){},ClienterServiceProxy.prototype={GetServerCommonConfig:function(e){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.ClienterService",e.methodName="GetServerCommonConfig";var t=new KDServiceClient;t.executeService.call(t,e,0)},FaceVerify:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.ClienterService",e.methodName="FaceVerify";var i=new KDServiceClient;i.executeService.call(i,e,t)},InitializeHtml5MainConsole:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.DataCenterService",e.methodName="InitializeHtml5MainConsoleInner";var i=new KDServiceClient;i.executeService.call(i,e,t,!0)},GetSMSVerificationCode:function(e,t,i,a){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService",e.methodName="GetUserSmsCode";var n={u:i,p:a};beforeLogin(n,1),t.AuthSign="HTML5",t.CustomizationParameter=KD.stringify({a:f5});var o=new KDServiceClient;o.executeService.call(o,e,t)},IsSubscriptionRegControlPolicy:function(e){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.ClienterService",e.methodName="IsSubscriptionRegControlPolicy";var t=new KDServiceClient;t.executeService.call(t,e,0)}},UserServiceProxy=function(){},UserServiceProxy.prototype={ValidateUser:function(e,t){var i=t.Username,a=t.Password;delete t.Username,delete t.Password,e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService";var n={u:i,p:a};e.methodName="ValidateLoginInfo";var o=new KDServiceClient;beforeLogin(n,1),t.AuthSign="HTML5",KD.isIndex()&&!KD.isLoginByValidationCode()&&KDCookieManager.renewKDSession(),t.CustomizationParameter=KD.stringify({a:f5,c:t.CustomizationParameter}),o.executeService.call(o,e,"",t)},logout:function(e){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService",e.methodName="Logout";var t=new KDServiceClient;t.executeService.call(t,e)},BuildSession:function(e,t){e.compressed=!1,e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService",e.methodName="BuildSession";var i=new KDServiceClient,a=t.UserToken||t.Context&&t.Context.UserToken;i.executeService.call(i,e,a)},BuildSessionWithClient:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService",e.methodName="BuildSessionWithClient";var i=new KDServiceClient,a=t.UserToken||t.Context&&t.Context.UserToken;i.executeService.call(i,e,a,t.clientInfo)},BuildSessionWithHtml5:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService",e.methodName="BuildSessionWithHtml5";var i=new KDServiceClient,a=t.UserToken||t.Context&&t.Context.UserToken;i.executeService.call(i,e,a,t.clientInfo)},UserFaceCollection:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService",e.methodName="UserFaceCollection";var i=new KDServiceClient;i.executeService.call(i,e,t.userToken,t.userid,t.convalue)},CheckAutherUser:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.serviceName="Kingdee.BOS.ServiceFacade.ServicesStub.User.UserService",e.methodName="CheckAutherUser";var i=new KDServiceClient;i.executeService.call(i,e,t.userName,t.dbid,t.clientType,t.lcid)}},AccountClientProxy=function(){},AccountClientProxy.prototype={serviceName:"Kingdee.BOS.ServiceFacade.ServicesStub.Account.AccountService",getDataCenterList:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.serviceName=this.serviceName;var i=new KDServiceClient,a=KD.getQueryString("tenantid",void 0,!1);KD.isManagementSite()?(e.methodName="GetManagementDataCenterList",t=4,i.executeService.call(i,e,t)):a?(e.methodName="GetDataCenterListByTenanID",i.executeService.call(i,e,a,t)):(e.methodName="GetDataCenterList",i.executeService.call(i,e,t))},getDataCenterLoginLanguages:function(e,t,i,a,n){e.compressed=ClientAppProxy.isCompressed(),e.serviceName=this.serviceName;var o=new KDServiceClient;switch(i){case DataBaseCategory.ManagementCenter:e.methodName="GetManageDataCenterLoginLanguages",o.executeService.call(o,e,t);break;case DataBaseCategory.MultiLanguageCenter:e.methodName="GetMultilangDataCenterLoginLanguages",o.executeService.call(o,e,t);break;default:e.methodName="GetDataCenterLoginLanguages",o.executeService.call(o,e,a,n,t)}},getValidationCodeImageByte:function(e){e.compressed=ClientAppProxy.isCompressed(),e.methodName="GetValidationCodeImageByte",e.serviceName=this.serviceName;var t=new KDServiceClient;KD.isIndex()&&KDCookieManager.renewKDSession(),t.executeService.call(t,e)},getValidationCodeObject:function(e){e.compressed=ClientAppProxy.serverConfig?ClientAppProxy.serverConfig.SL_Http_Compressed:!1,e.methodName="GetVImageInfo4CookieOnly",e.serviceName=this.serviceName;var t=new KDServiceClient;KD.isIndex()&&KDCookieManager.renewKDSession(),t.executeService.call(t,e)},getDataCenterDBLanguages:function(e,t,i,a,n,o){e.compressed=ClientAppProxy.isCompressed(),e.methodName="GetDataCenterDBLanguages",e.serviceName=this.serviceName;var r=new KDServiceClient;r.executeService.call(r,e,t,i,a,n,o)},getDataCenterDBStatus:function(e,t,i,a,n){e.compressed=ClientAppProxy.isCompressed(),e.methodName="GetDataCenterDBStatus",e.serviceName=this.serviceName;var o=new KDServiceClient;o.executeService.call(o,e,t,i,a,n)}},DynamicFormServiceProxy=function(){},DynamicFormServiceProxy.prototype={serviceName:"Kingdee.BOS.ServiceFacade.ServicesStub.DynamicForm.DynamicFormService",callByUrl:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.methodName="CallByUrl",e.serviceName=this.serviceName;var i=t;e.csrfToken=KDServiceClient.getCSRFToken("CallByUrl","",i);var a=new KDServiceClient;a.executeService.call(a,e,i)},call:function(e,t,i,a,n){e.compressed=ClientAppProxy.isCompressed(),e.methodName="Call",e.serviceName=this.serviceName,e.csrfToken=KDServiceClient.getCSRFToken("Call",i,"");var o=new KDServiceClient;o.executeService.call(o,e,t,i,a,n)},closeForm:function(e,t){var i=t[0]||"";e.compressed=ClientAppProxy.isCompressed(),e.methodName="CloseForm",e.serviceName=this.serviceName,e.async=!1,e.csrfToken=KDServiceClient.getCSRFToken("CloseForm",i,"");var a=new KDServiceClient;a.executeService.call(a,e,t)}},HTMLFormHandlerProxy=function(){},HTMLFormHandlerProxy.prototype={ValidateUser:function(e,t){e.compressed=!1;var i=ClientAppProxy.serverConfig?ClientAppProxy.serverConfig.LoginEntryRole:"";i=i||(e&&e.scope?e.scope.entryrole:""),i=i?i.toLocaleLowerCase():i,t.EntryRole=i;var a=null,n=KD.entryrolePlugins.getPlugin(i);n&&$.isFunction(n.getUserServiceProxy)&&(a=n.getUserServiceProxy.call(n)),a&&$.isFunction(a.ValidateUser)||(a=new UserServiceProxy),a.ValidateUser(e,t)}},ReportDataProxy=function(){},ReportDataProxy.prototype={serviceName:"Kingdee.BOS.ServiceFacade.ServicesStub.DynamicForm.DynamicFormService",getNoteReport:function(e,t){var i=t.printConfig;e.compressed=ClientAppProxy.isCompressed(),e.methodName="call",e.serviceName=this.serviceName,e.url=KD.getUrlRoot()+"/Service.aspx";var a=new KDServiceClient,n=i.pageID||i.pageId||"",o=i.printJobId||"",r=i.start||0,s=i.pageSize||20,l=i.action||"",d=t.dataMethod||"GetReport";e.csrfToken=KDServiceClient.getCSRFToken(d,n,""),a.executeService.call(a,e,"NotePrintService",n,d,[n,o,r,s,l])},getListReport:function(e,t){var i=t.printConfig,a=t.serviceName||"ListService";e.compressed=ClientAppProxy.isCompressed(),e.methodName="call",e.serviceName=this.serviceName,e.url=KD.getUrlRoot()+"/Service.aspx";var n=new KDServiceClient,o=i.pageId||i.pageID||"",r=(i.printJobId||"",i.start||0),s=i.pageSize||20,l=i.OperationKey||"PrintSync",d=t.dataMethod||"GetEntryPrintData";e.csrfToken=KDServiceClient.getCSRFToken(d,o,""),n.executeService.call(n,e,a,o,d,["FLIST",r,s,l])}},CPDemoClientProxy=function(){},CPDemoClientProxy.prototype={serviceName:"Kingdee.BOS.ServiceFacade.ServicesStub.DynamicForm.CDPDemoActionService",autoLogin:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.methodName="AutoLogin",e.serviceName=this.serviceName;var i=new KDServiceClient;i.executeService.call(i,e,t)}},StartAppServiceProxy=function(){},StartAppServiceProxy.prototype={serviceName:"Kingdee.BOS.ServiceFacade.ServicesStub.StartAppVerifySerivce",Verify:function(e,t){e.compressed=ClientAppProxy.isCompressed(),e.methodName="Verify",e.serviceName=this.serviceName;var i=new KDServiceClient;i.executeService.call(i,e,t)}},define("KDServiceClient",["KD"],function(e){return function(){var t;return t||e.KDServiceClient}}(this)),KDRequest=function(){},KDRequest.serviceProxy=new DynamicFormServiceProxy,KDRequest.prototype={actionCacheId:"",url:"",serviceName:"",queryString:"",pageId:"",callback:null,errcallback:null,scope:null,showProgressBar:!1,progressBarTipInfo:"",progressShowType:"",released:!1,pushBatchCall:function(e){var t=this;t.getBatchCall().push(e)},getBatchCall:function(){var e=this;return e.batchCall=e.batchCall||[],e.batchCall},resetBatchCall:function(){var e=this;e.batchCall=[]},isEnableBatchRequest:function(){var e=this.isBatchRequest>1;return e},beginBatchRequest:function(){var e=this;KD.isSingleReq()?e.isBatchRequest=0:e.isBatchRequest=(e.isBatchRequest||0)+1},endBatchRequest:function(){var e=this;e.isBatchRequest=(e.isBatchRequest||0)-1;try{if((e.isBatchRequest||0)<=0){var t=e.getBatchCall();if(!KD.isEmpty(t)&&t.length>1){var i=t;e.resetBatchCall(),e.call("BatchCall",i)}else if(1==t.length){var a=t[0];e.resetBatchCall(),e.call2(a.methodname,a.async,a.param)}}}catch(n){KD.writeLog(n)}finally{}},callByUrl:function(){var e=new Object;e.callback=this.callback,e.errcallback=this.errcallback,e.scope=this.scope,KDRequest.serviceProxy.callByUrl(e,this.url)},syncCall:function(e){var t=this.getParamFromArgument(arguments);this.callByParaArray(e,!1,t)},call:function(e){var t=this.getParamFromArgument(arguments);this.callByParaArray(e,!0,t)},closeForm:function(e){var t=new Object;t.callback=this.callback,t.errcallback=this.errcallback,t.scope=this.scope,KDRequest.serviceProxy.closeForm(t,e)},callByParaArray:function(e,t,i){var a=this;if((a.isBatchRequest||0)>0){var n=new Object;n.methodname=e,n.async=void 0==t||t,n.param=i,a.pushBatchCall(n)}else a.call2(e,t,i)},getData:function(e){var t=new Object;t.callback=this.callback,t.errcallback=this.errcallback,t.scope=this.scope,KDRequest.serviceProxy.callByUrl(t,e)},getBeforeCalledEventArgs:function(e,t){return{MethodName:e,Parameter:t}},call2:function(e,t,i){var a=this,n=new Object;$(this).trigger("BeforeCalled",a.getBeforeCalledEventArgs(e,i)),$.extend(n,{async:void 0==t||t,callback:this.callback,errcallback:this.errcallback,scope:this.scope}),KDRequest.serviceProxy.call(n,this.serviceName,this.pageId,e,i)},getParamFromArgument:function(e){var t=new Array;if(null!=e){for(var i=1;i<e.length;i++)void 0===e[i]?t.push(null):t.push(e[i]);return t}},bindBeforeCalledEvent:function(e){KD.isFunction(e)&&$(this).bind("BeforeCalled",e)}},define("KDRequest",["KDServiceClient","KD"],function(e){return function(){var t;return t||e.kdmain}}(this)),ShowFormType={FORM:0,LIST:1},LookUpLikeMatchType={LeftMatch:1,RightMatch:2,BothMatch:3},ClientAppProxy=function(){},function(e){var t=function(t,i){var a=t&&e.serverConfig?"true"==(e.serverConfig[t]||"").toLowerCase():void 0===i?!0:i;return a};$.extend(e,{C_DefTimeout:1800,C_MinIdleTimeOut:600,C_MinHearbeat:10,C_DefHearbeat:300,C_IdleTimeOfHearbeat:1,isCompressed:function(){var e=!KD.equalsIgnoreCase(KD.getConnectConfig().compressed,"false");return e},isCompressedApx:function(){var t=e.isCompressed()?!KD.equalsIgnoreCase(KD.getConnectConfig().compressedapx,"false"):!1;return KD.isFunction(KD.getCompressor())||(t=!1),t},isResponseUnzip:function(){var e=t("ResponseUnzip",!0);return e},isInputBlock:function(){var e=t("IsInputBlock",!0);return e},isShowLoggedInMessage:function(){var e=t("IsShowLoggedInMessage",!1);return e},isLoginVaildCookieTip:function(){var e=t("IsLoginVaildCookieTip",!1);return e},fireUserBehavior:function(t,i,a,n){var o=KD.CONST.CustomEventName.PutUserBehavior,r={};try{if(KD.equalsIgnoreCase(KD.getConnectConfig().sendUserBehaviorData+"","false"))return;if(KD.isEmpty(t)){var s=e.Current.getRootForm();t=KD.isFunction((s||{}).getPageId)?s.getPageId():null}if(!KD.isEmpty(t)){var l=e.Current.getAliveForm(t);l&&(r.opkey=KD.format("{0}{1}",i,a?KD.format(".{0}",a):""),r.opname=n,l.fireCustomEventsNoData.call(l,o,o,KD.stringify(r)))}}catch(d){KD.writeLog(KD.format("{0},{1}",i,a,n),d.message,!0)}}})}(ClientAppProxy),function(e){var t=function(t){for(var i=$.isPlainObject(t)?e.base64Encode(t):t,a="",n=i.length,o=95,r=n%o,s=0;n>s;s++){var l=i.charCodeAt(s),d=l-r;32>d?d+=o:d>126&&(d-=o),a+=String.fromCharCode(d)}return e.base64Encode(a)};beforeLogin=function(i,a){var n=window,o=a||0;n[e.format("f{0}",4+o)]=t(i)};var i=function(t,i){for(var a=e.urlEncode(t),n="",o=a.length,r=95,s=(e.getStrCharFlag(i)+o)%r,l=0;o>l;l++){var d=a.charCodeAt(l),c=d-s;32>c?c+=r:c>126&&(c-=r),n+=String.fromCharCode(c)}return e.base64Encode(n)};beforeTransForm=function(t,a){var n=window,o=a||0,r=i(e.stringify(t),t.key);n[e.format("C{0}.S{1}",2+o,3+o)]=r},e.getStrCharFlag=function(t){var i=31;if(!e.isEmpty(t)){for(var a=0;a<t.length;a++){var n=t.substr(a,1);i+=n.charCodeAt()}i%=126}return i}}(KD),ClientAppProxy.prototype={defaultLocalId:2052,logoff:null,rootForm:null,aliveForms:{},IdleTimeout:ClientAppProxy.C_DefTimeout,IsPreTimeOutLogoffTip:!1,lastRequestTime:new Date,_clientUserParamsSetting:null,_messageConcentrator:null,IsLookupLikeMatch:!1,IsQingJSRegister:!1,AllowUpLoadFileType:"",IsTableVerticalNoLines:!1,NumFieldRPTakeFormat:void 0,ImgFileEnableCompress:!1,LineTipsDisplayRule:"",tipsDelayMillisec:0,setLogoffPage:function(e,t){var i=e||"index.aspx";void 0==t&&(t="");var a=[],n=(i||"").indexOf("?")>0?"&":"?";KD.isDebug()&&a.push("isDebug=true"),(t||"").replace(/\s/g,"")&&a.push("EntryRole="+t),this.logoffPage=i+(a.length?n:"");for(var o=0;o<a.length;o++)this.logoffPage+=a[o]+(o<a.length-1?"&":"")},getLogoffPage:function(){return this.logoffPage||this.setLogoffPage("index.aspx"),this.logoffPage},getRootForm:function(){return this.rootForm},getIsNotLoginUserByHistory:function(){return ClientAppProxy.serverConfig&&void 0!=ClientAppProxy.serverConfig.IsNotLoginUserByHistory?"true"==ClientAppProxy.serverConfig.IsNotLoginUserByHistory:!1},getAliveForm:function(e){return this.aliveForms[e]},getAliveForms:function(e){var t=[];for(var i in this.aliveForms){var a=this.aliveForms[i];a&&a.dformConfig&&KD.equalsIgnoreCase(e,a.dformConfig.formid)&&t.push(a)}return t},getLocals:function(){if(this._locals="underfined"){if(!(null!=this.CTX&&null!=this.CTX.UseLanguages&&this.CTX.UseLanguages.length>0))return[{lang:"2052",alias:"CN",text:ResManager.LoadKDString("简体中文","0025710030032331")},{lang:"1033",alias:"EN",text:"English"},{lang:"3076",alias:"TW",text:ResManager.LoadKDString("繁体中文","0025710030032332")}];var e=[];for(var t in this.CTX.UseLanguages){var i=this.CTX.UseLanguages[t],a={};a.lang=""+i.LocaleId,a.alias=i.Alias,a.text=i.LocaleName,e.push(a)}this._locals=e}return this._locals},getGolbalFontName:function(){if(KD.isEmpty(KD.golbalFontNames)){var e=KD.parseObject(KD.getConnectConfig().browserFontFamilys||KD.storage.getItem("KDGolbalFontFames")||"{}");ClientAppProxy.Current.setGolbalFontNames(e)}var t=KD.golbalFontNames=KD.golbalFontNames||{},i=ClientAppProxy.Current.defaultLocalId||2052,a=t[i];return a},setGolbalFontNames:function(e){var t=KD.golbalFontNames=KD.golbalFontNames||{};KD.isObject(e)&&!KD.isEmpty(e)&&$.extend(t,e),KD.isEmpty(t)||KD.storage.setItem("KDGolbalFontFames",JSON.stringify(t))},removeAliveForm:function(e){null!=this.rootForm&&this.rootForm.dformConfig.pageId==e&&(this.rootForm=null),delete this.aliveForms[e]},addAliveForm:function(e,t){if(null==this.rootForm&&(this.rootForm=t),this.aliveForms[e]){var i=this.aliveForms[e];delete this.aliveForms[e],i.doCloseWindow()}this.aliveForms[e]=t},setMainTab:function(e){this.mainTab||(this.mainTab=e)},getMainTab:function(){return this.mainTab},setMainConsoleForm:function(e){this.mainConsoleForm||(this.mainConsoleForm=e)},getMainConsoleForm:function(){return this.mainConsoleForm},releaseMainTab:function(){delete this.mainTab,delete this.mainConsoleForm},invokeTimeCounter:function(){if(this.AppTimeOutEnable){var e=KD.dateDiff(new Date,this.lastRequestTime,"second"),t=this.IdleTimeout-300;if(t>0&&e>=t&&e<this.IdleTimeout&&this.rootForm&&this.rootForm.logoffPreWarn){var i={TimeOutPoint:"LogOutPreFivePoint"};this.rootForm.logoffPreWarn(i),this.IsPreTimeOutLogoffTip=!0}return KD.writeLog("current idle::"+e+", timeout::"+this.IdleTimeout,"",!0),e>this.IdleTimeout?(KDMessageBox.remove(),this.IsPreTimeOutLogoffTip=!1,void(this.rootForm&&this.rootForm.logoff?this.rootForm.logoff({isTimeOut:!0,LoginRedirectUrl:"index.aspx"}):this.raiseLogoff(!0))):void(null!=this.rootForm&&this.rootForm.invokeTimeCounter.call(this.rootForm))}},resetTimeCount:function(){var e=this.timeoutHandler||ClientAppProxy.Current.timeoutHandler,t=window.clearTimeout;void 0!=e&&t(e)},setHearbeat:function(e){this.C_ClientTimerCount=e,KDServiceClient&&KDServiceClient.setIdleMin(this.C_ClientTimerCount*ClientAppProxy.C_IdleTimeOfHearbeat)},loadTimeoutConfig:function(e){var t=null!=e&&e.length>0?e[0]:null;this.IdleTimeout=t&&t.value?parseInt(t.value):ClientAppProxy.C_DefTimeout,this.IdleTimeout<ClientAppProxy.C_MinIdleTimeOut&&(this.IdleTimeout=ClientAppProxy.C_MinIdleTimeOut),this.AppTimeOutEnable=t.enabled||void 0===t.enabled,this.AppTimeOutEnable?(this.setHearbeat(t.hearbeat?t.hearbeat:ClientAppProxy.C_DefHearbeat),this.C_ClientTimerCount<ClientAppProxy.C_MinHearbeat&&this.setHearbeat(ClientAppProxy.C_MinHearbeat),null!=this.rootForm&&KD.getValue(t,"immediately",!0)&&this.rootForm.resetTimeCount()):(this.setHearbeat(2*this.IdleTimeout),this.rootForm&&KD.isFunction(this.rootForm.resetTimeCount)&&this.rootForm.resetTimeCount()),KD.getValue(t,"immediately",!0)&&this.startHearbeat()},startHearbeat:function(){try{ClientAppProxy.Current.resetTimeCount.call(ClientAppProxy.Current);var e=window.setTimeout;ClientAppProxy.Current.timeoutHandler=e(function(){ClientAppProxy.Current.resetTimeCount.call(ClientAppProxy.Current),ClientAppProxy.Current.invokeTimeCounter.call(ClientAppProxy.Current)},1e3*ClientAppProxy.Current.C_ClientTimerCount)}catch(t){ClientAppProxy.Current.resetTimeCount.call(ClientAppProxy.Current)}},updateLastReqTime:function(e,t){if(null!=e){var i=!1;if(KDServiceClient&&KDServiceClient.isIgnoreUpdateLastTime(t)&&(i=!0),!i)for(var a in e){var n=e[a],o=n.actionname;if(o&&"SETTIMEOUT"==o.toUpperCase()){i=!0;break}}i||(this.lastRequestTime=new Date)}},setWatermark:function(e,t){try{var i=KD.getConnectConfig(),a="GenuineLicense",n=i.LicenseType,o=e.el,r=(i.showGlobalWatermark||"0").toString(),s=e.config||i.globalWatermarkConfig||{},l=s.width||260,d=s.height||160,c=s.angle||-15,h=s.fontsize||12,u=s.opacity||.1,p=s.fontfamily||"",g=s.big_fontsize||16,f=s.lictext||"",m=s.watermarktext||"",v=void 0===s.showtype?r:KD.format("{0}",s.showtype);
if((c>360||-360>c)&&(c=-15),(0>u||u>1)&&(u=.1),(16>l||l>screen.availWidth)&&(l=240),(16>d||d>screen.availHeight)&&(d=200),"0"==KD.format("{0}",n)&&(n=a),KD.equalsIgnoreCase(n,a)||(h=g),KD.equalsIgnoreCase(n,a)){if(KD.equalsIgnoreCase(v,"0")||KD.equalsIgnoreCase(v,"2"))return}else if(KD.equalsIgnoreCase(v,"2"))return;var y=function(e){KD.__curlicDescMaps=KD.__curlicDescMaps||{};var t=KD.__curlicDescMaps[e]||"";return t},b="",D="",k=y(n),C=(ClientAppProxy.Current.CTX||{}).UserName||"";(KD.equalsIgnoreCase(v,"0")||KD.equalsIgnoreCase(v,"2"))&&(C=""),D=n==a?KD.format("{0}",m||C):KD.format("{0} {1}",f||k,m||C);var x=$.extend({},s,{licType:n,dspDesc:D});b=KD.base64Encode(x);var w=function(e,t,i,a){var n="";try{var r=t,s=document.createElement("canvas");s.width=r,s.height=i;var l=s.getContext("2d");l.rotate(a*Math.PI/180),l.fillStyle="#000000",l.font=KD.format("{0}px {1}",h,p||o.css("fontFamily")||"Microsoft YaHei").replace(/\"/g,""),l.textAlign="start";var d=l.measureText(e).width,c=a/90*r,u=a/90*i,g=(r-d)/2+u,f=(i-h)/2-c;g=c>g?c:g,f=f>i?i-h:f;var m=d>.98*r;g=m?f*(a/90):g,l.fillText(e,g,f),l.restore(),n=s.toDataURL("image/png")}catch(v){n=""}return n};if(D&&o&&o.length>0){var K=KD.__curlicDescMaps[b]=KD.__curlicDescMaps[b]||w(D,l,d,c),S={"background-image":"url("+K+")",position:"absolute",opacity:u,top:0,left:0,height:"100%",width:"100%","pointer-events":"none"};t&&(S.position="fixed"),$(".kd-gbl-watermark",o).remove(),K&&$('<div class="kd-gbl-watermark">').css(S).appendTo(o),KD.delayInvoke(function(){ClientAppProxy.fireUserBehavior(null,"HTML5","GlobalWatermark","全局安全水印")},15e3)}}catch(I){KD.writeLog("ClientAppProxy.setWatermark() failure",I.message,!0)}},raiseLogoff:function(e,t,i){var a=new UserServiceProxy,n={sessionkey:"none",scope:this.rootForm,callback:function(e){try{}catch(a){}finally{KD.isFunction(i)&&(t?i.call(t):i())}},errcallback:function(){KD.isFunction(i)&&(t?i.call(t):i())}};a.logout(n),this.releaseMainTab(),KDLockedSystem.reset();var o=KD.getEntryRole(),r=KD.entryrolePlugins.getPlugin(o),s=!0;r&&$.isFunction(r.isDefaultLogoff)&&(s=r.isDefaultLogoff.call(r));var l=this.getMessageConcentrator();if(l&&l.StopTimer.call(l),s&&null!=this.logoff){var d=1==e;d?this.logoff(this,{isTimeOut:d,LoginRedirectUrl:"index.aspx"}):this.logoff(this,new Object)}},showWatcher:function(e){KDServiceClient&&KDServiceClient.showWatcher(e)},writeLog:function(e,t){KDServiceClient&&KDServiceClient.writeLog(e,t)},writeReqLog:function(e,t,i,a){KDServiceClient&&KDServiceClient.writeReqLog(e,t,i,a)},LookupLikeMatchType:LookUpLikeMatchType.LeftMatch,setLookupLikeMatchType:function(e){this.LookupLikeMatchType=e},setLookupLikeMatchTypeSilent:function(e){if(e=parseInt(e),this.LookupLikeMatchType!=e){this.LookupLikeMatchType=e;var t=this.rootForm;t&&t.fireEventNoData("CustomEvents","RootFormDefault","LookupLikeMatch",e,[])}},getLookupLikeMatchType:function(){return this.LookupLikeMatchType},getClientUserPaSetting:function(){var e="C"+ClientAppProxy.Current.CTX.UserName+"_"+ClientAppProxy.Current.CTX.UserId+"_"+ClientAppProxy.Current.CTX.DBid;return null==this._clientUserParamsSetting?this._clientUserParamsSetting=new ClientUserParamsSetting(e):this._clientUserParamsSetting.CurrentUsepre()!=e&&(this._clientUserParamsSetting=new ClientUserParamsSetting(e)),this._clientUserParamsSetting},getMessageConcentrator:function(){return null==this._messageConcentrator&&(this._messageConcentrator=new KDMessageConcentrator),this._messageConcentrator},getLineTipsDelayMillisec:function(){var e=this.LineTipsDisplayRule;switch(e){case"0":this.tipsDelayMillisec=0;break;case"1":this.tipsDelayMillisec=1200;break;case"2":this.tipsDelayMillisec=3e3;break;case"3":return this.tipsDelayMillisec=4,!1;default:this.tipsDelayMillisec=0}return this.tipsDelayMillisec},handlerLoginCustParam:function(){var e=KD.getConnectConfig()||{},t={};if(e.connectState&&KD.isObject(e.connectState)){var i=e.connectState.lcp;i&&KD.isObject(i)&&(t=i)}this.ImgFileEnableCompress=KD.getValue(t,"FImgFileCompress",!1),this.LineTipsDisplayRule=KD.getValue(t,"FSystemTipsRule","")},handlerUnload:function(){function e(){if(KD.IsF5RefreshToMainConsole()){if(KD.isDebug())return;var e=KD.storage.getItem(KD.CONST.F5RefreshEventParameterName);KD.storage.removeItem(KD.CONST.F5RefreshEventParameterName);var t=KD.isObject(e)?e:KD.parseObject(e);if(t){var i=t.isdispose;if(0==i)return}}var a=window.disposeData.disposeUrl,n="",o=$.extend({},window.disposeData||{});delete o.disposeUrl,ClientAppProxy.Current.writeReqLog(KD.stringify({ap0:o}),KD.stringify({message:"send."}),"Client DoDispose","");try{if(KD.isChrome()){n=navigator.sendBeacon(a,null);for(var r=(new Date).getTime();;)if((new Date).getTime()-r>100)break}else $.ajax({url:a,async:!1,beforeSend:function(e){e.setRequestHeader("Cookie","ASP.NET_SessionId="+window.disposeData.aspSid),e.setRequestHeader("kdservice-sessionid",window.disposeData.kdsvSid)},success:function(e,t,i){n=e},error:function(e,t,i){n=(e||{}).statusText||"error"}})}catch(s){}return n}var t=KD.getConnectConfig()||{};if(void 0!==t.userToken){var i=window.disposeData={};i.disposeUrl=KD.getUrlRoot()+"/Services/Dispose.ashx?usertoken="+t.userToken,i.aspSid=t.aspNetSessionId,i.kdsvSid=t.kdSessionId,i.userToken=t.userToken;var a=ClientAppProxy.prototype.raiseLogoff;ClientAppProxy.prototype.__raiseLogoff=a,ClientAppProxy.prototype.raiseLogoff=function(){var e=arguments;window.disposeData.svrLogoff=!0,KD.delayInvoke(function(){ClientAppProxy.prototype.__raiseLogoff.apply(ClientAppProxy.Current,e)},500,!0)};var n=function(e){if(!window.disposeData.svrLogoff){var t=ResManager.LoadKDString("要离开金蝶云星空页面吗？","0025710000005246")||" ";e.returnValue=t}},o=function(t){window.disposeData.svrLogoff||e(),delete window.disposeData};KD.storage.removeItem(KD.CONST.F5RefreshEventParameterName);var r=window;KD.isDForm()&&!KD.equalsIgnoreCase(KD.getConnectConfig().IsUnloadConfirm||"false","false")&&(r.addEventListener?r.addEventListener("beforeunload",n,!1):r.attachEvent&&r.attachEvent("beforeunload",n)),KD.isDForm()&&(r.addEventListener?r.addEventListener("unload",o,!1):r.attachEvent&&r.attachEvent("onunload",o))}}},ClientAppProxy.Current=new ClientAppProxy,ClientAppProxy.Current.IdleTimeout=ClientAppProxy.C_DefTimeout,ClientAppProxy.Current.AppTimeOutEnable=!0,ClientAppProxy.Current.lastRequestTime=new Date,ClientAppProxy.Current.handlerUnload(),ClientAppProxy.Current.handlerLoginCustParam(),$.extend(KD,{entryCellBtnClick:function(e){var t=ClientAppProxy.Current,i=t.getAliveForm.call(t,e.pageid);if(i){var a=JSON.stringify({key:e.key,row:e.row}),n=i.getControlProxy.call(i,e.entrykey);n&&void 0!=n.setFocusRowIndex&&n.setFocusRowIndex.call(n,e.row,!0),KD.getValue(e,"sync",!0)?i.fireSyncCustomEvents.call(i,e.entrykey,"EntryCellBtnClick",a):i.fireCustomEvents.call(i,e.entrykey,"EntryCellBtnClick",a)}},entryLargetextClick:function(e){var t=ClientAppProxy.Current,i=t.getAliveForm.call(t,e.pageid),a=i.getControlProxy.call(i,e.entrykey);a.setFocusRowIndex.call(a,e.row,!0),KD.delayInvoke(function(){var t=new FormManager,i=new ShowFormParameter("BOS_LargeTextEdit");i.CustomParams.FieldKey=e.key,i.CustomParams.AllowEdit=!1,i.CustomParams.parentPageId=e.pageid,t.ShowClientDynamicForm.call(t,i)},200)},entryLinkBtnClick:function(e,t){var i=ClientAppProxy.Current;if(KD.isString(e))try{e=KD.parseObject(e)}catch(a){e=KD.htmlUtil.decode(e),e=KD.parseObject(e)}if(!KD.isEmpty(e)){var n=i.getAliveForm.call(i,e.pageid);if(n){var o=n.getControlProxy.call(n,e.entrykey);o.setFocusRowIndex.call(o,e.row,!0),n.lockControl.call(n,o),KD.isEmpty(e.itemid)||KD.isEmpty(e.attrname)||o.el.find("#"+e.itemid).attr(e.attrname,"true"),KD.isEmpty(t)?KD.getValue(e,"sync",!0)?n.fireSyncEvent.call(n,"EntryButtonCellClick",e.entrykey,e.key,e.row):n.fireEvent.call(n,"EntryButtonCellClick",e.entrykey,e.key,e.row):KD.getValue(e,"sync",!0)?n.fireSyncEvent.call(n,"EntryButtonCellClickExt",e.entrykey,e.key,e.row,t):n.fireEvent.call(n,"EntryButtonCellClickExt",e.entrykey,e.key,e.row,t)}}},entryButtonClick:function(e,t){KD.entryLinkBtnClick(e,t)},entryPictureFileClick:function(e){var t=ClientAppProxy.Current;if("string"==typeof e)try{e=KD.parseObject(e)}catch(i){e=KD.htmlUtil.decode(e),e=KD.parseObject(e)}var a=t.getAliveForm.call(t,e.pageid);if(a){var n=a.getControlProxy.call(a,e.entrykey);if(e.key){var o=n.getStore(),r=null==o?null:o.getColumnDescriptor(e.key);if(r&&r.PictureFileClick){var s=window.event||arguments.callee.caller.arguments[0];e.target=s.currentTarget,r.PictureFileClick.call(r,e,event)}}}},entryPictureFieldHover:function(e){var t=ClientAppProxy.Current;if("string"==typeof e)try{e=KD.parseObject(e)}catch(i){e=KD.htmlUtil.decode(e),e=KD.parseObject(e)}var a=t.getAliveForm.call(t,e.pageid);if(a){a.currentPastePicItem={ctlbaseid:e.id,ctlKey:e.ctlkey,arg:e};var n=a.getControlProxy.call(a,e.entrykey);if(e.key){var o=n.getStore(),r=null==o?null:o.getColumnDescriptor(e.key);if(r){var s=window.event||arguments.callee.caller.arguments[0];e.target=s.currentTarget,r.PictureFileClick.call(r,e)}}}}}),ClientUserParamsSetting=function(e){this.CurrentUsepre=function(){return this.UserPre},this.UserPre=e,KD.IsNullOrWhiteSpace(this.UserPre)&&(this.UserPre=KD.Guid.NewGuid().ToString()),this.InitCurrentElemnt()},ClientUserParamsSetting.prototype={xmlFileName:"ClientUserParamsSetting",xmlPath:"",currentElement:null,RootElement:null,UserPre:"",InitCurrentElemnt:function(){if(null!=KD.storage.getStorage()){var e=KD.storage.getItem(this.xmlFileName);null==e?(this.RootElement=new Object,this.RootElement[this.UserPre]=new Object,KD.storage.setItem(this.xmlFileName,JSON.stringify(this.RootElement))):this.RootElement=KD.parseObject(e),this.currentElement=this.RootElement[this.UserPre]}},InitRootElemnt:function(){this.RootElement=KD.storage.getItem(this.xmlFileName),null==this.RootElement&&(this.RootElement=new Object,KD.storage.setItem(this.xmlFileName,JSON.stringify(this.RootElement)))},SetAttribute:function(e,t){this.SetAttributeOnly(e,t),this.SaveXmlFile()},SetAttributeOnly:function(e,t){null==this.RootElement&&this.InitCurrentElemnt(),null==this.currentElement&&(this.currentElement=new Object),this.currentElement[e]=t},GetAttribute:function(e){return null==this.RootElement&&this.InitCurrentElemnt(),null==this.currentElement?null:this.currentElement[e]},SaveXmlFile:function(){null==this.RootElement&&this.InitRootElemnt(),KD.storage.setItem(this.xmlFileName,JSON.stringify(this.RootElement))},ResetSaveByRootElment:function(e){return!0},SaveXmlFileByCurrentUser:function(e){return!0},LoadXmlStream:function(e){return!0}},KDMessageConcentrator=function(){function e(){a=setTimeout(function(){if(KD.dateDiff(new Date,r,"second")>i){var t=ClientAppProxy.Current.getRootForm();t&&t.fireDoKDMessageConcentratorDataNoPostData.call(t,"")}e()},1e3*t,"KDMessageConcentrator.getMesReqTimer()")}var t=60,i=10,a=null,n=!1,o=new Date,r=new Date,s={InvokeCloseAction:!0};return{registerIngorGetMessageEvent:function(e){s[e]=!0},IsGetMessage:function(){return n},StartTimer:function(){null==a&&e()},StopTimer:function(){null!=a&&(clearTimeout(a),a=null)},GetIsMessage:function(e){var t=e?s[e]:void 0;if(t)return n=!1;var a=new Date;return KD.dateDiff(a,o,"second")<i?(n=!1,this.StartTimer()):(n=!0,r=a),o=a,n}}},define("ClientAppProxy",["KD"],function(e){return function(){var t;return t||e.ClientAppProxy}}(this)),KDControlFactoryProxy=function(){this.controls={},this.forms=[],this.childForms=[],this.afterControlCreate=null},KDControlFactoryProxy.types={},KDControlFactoryProxy.CustomPluginsFailTypes={},$.extend(KDControlFactoryProxy,{registerType:function(e,t){KDControlFactoryProxy.types[e]=t;var i=t.xtypes=t.xtypes||[];i.push(e);var a=KDControlFactoryProxy.callbackObjects||[],n=a[e];KD.isObject(n)&&n.loadedHandler&&(n.loadedHandler.call(n,e),delete KDControlFactoryProxy.callbackObjects[e])},registerTypeCallback:function(e,t){KDControlFactoryProxy.callbackObjects=KDControlFactoryProxy.callbackObjects||[],KDControlFactoryProxy.callbackObjects[e]=t},registerCustomPluginsFailType:function(e,t){KDControlFactoryProxy.CustomPluginsFailTypes[e]=t},exitCustomPluginsFailType:function(e){return KDControlFactoryProxy.CustomPluginsFailTypes[e]},formatFormtXType:function(e){return(e||"").replace(/\.Silverlight\./gi,".XPF.")},exitForm:function(e){return!!KDControlFactoryProxy.types[e]}}),KDControlFactoryProxy.prototype={dashboardInitExpand:{},setParentFormProxy:function(e){this.formProxy=e},getParentFormProxy:function(){return this.formProxy},createAllProxyInstance:function(e){this.dashboardInitExpand=e.dashboardInitExpand||this.dashboardInitExpand;var t=this.createProxyInstance(e);if(e.items&&t.isContainer())for(var i=e.items.length,a=0;i>a;a++)this.createAllProxyInstance(e.items[a])},getProxyInstance:function(e){var t=e.id?e.id.toUpperCase():void 0;return this.controls[t]?this.controls[t]:this.createProxyInstance(e)},isViewGrid:function(e){return e&&"kdgrid"==e.xtype&&"VIEWGRID"==e.gridtype},isCanKDVGrid:function(e){return e&&"kdgrid"==e.xtype&&("VIEWGRID"==e.gridtype||!!KD.debugKDVEditGrid)},switchAgViewGrid:function(e,t){var i=e;return this.isViewGrid(t)&&KD.debugAgGrid&&KD.equalsIgnoreCase(typeof window.agGrid&&typeof(window.agGrid||{}).Grid,"function")&&(i="kdaggrid"),i},switchKDVGrid:function(e,t){var i=e,a=KD.getLocalConfiguration().EnableListKDVGrid||KD.getConnectConfig().enableListKDVGrid,n=a&&this.isCanKDVGrid(t);if(n&&KD.isFunction($.prototype.KDVGrid)&&KD.isFunction(window.KDVGridProxy)){var o=(window.KDVGridUtils||{}).hasColEditor;KD.isFunction(o)&&!o(t)&&(i="kdvgrid")}else i=this.switchAgViewGrid(e,t);return i},createProxyInstance:function(e){var t=void 0==e.xtype?"panel":e.xtype;t="kdcombo"==t&&e.isMulti?"kdmulticombo":"kdmultiselorg"==t&&e.selmodel?"kdmultiselorgpopup":this.switchKDVGrid(t,e);var i,a=t;if(this.formProxy&&KD.isGalaxyFormTheme(this.formProxy.FormTheme)){var n=KD.getValue(e,"isIgnoreFormTheme",!1);1!=n&&(a=t+"_"+this.formProxy.FormTheme,i=KDControlFactoryProxy.types[a],e.originXtype=t)}i||(i=KDControlFactoryProxy.types[t],a=t);var o=!1;if(i||(i=KDPanelProxy,o=!0),!i)return void KD.Error.raise({sourceClass:"KDControlFactoryProxy",sourceMethod:"createControl",msg:"The '"+t+"' type has not been registered with this manager"});var r=new i,s=e.id?e.id.toUpperCase():void 0,l=this.dashboardInitExpand[s];if(0==l&&(e.visible=!1),$.extend(r,{key:s,xtype:a,controlFactoryProxy:this}),null!=s&&s.length>0&&!e.fromClient)if(void 0!=this.controls[s]){var d='From KDControlFactory <span style="color:blue"><B>control key [" + id + "] is duplicate!</B></span><br>';KD.writeLog(d)}else this.controls[s]=r;return r},removeProxyInstance:function(e){var t=this.controls[e];t&&delete this.controls[e]},createControl:function(e){var t=this.getProxyInstance(e),i=e.id?e.id.toUpperCase():void 0;t.key=i,t.dock=e.dock;var a=void 0==e.xtype?"panel":e.xtype;if("kdform"!=a){var n=this.getParentFormProxy().server;t.setServer(n);var o=null;i&&(o=i.replace("$$","")),t.setBaseId(KD.converToJqId(this.formProxy.baseId)+"-"+(i?o:(e.parent?e.parent:"")+i))}t.setControlFactoryProxy(this),t.createControl(e),this.menuBar||(this.menuBar=[]),t.isMenuBar&&this.menuBar.push(t),this.grids=this.grids||[],t.isGrid&&this.grids.push(t),i&&(this.controls[i.toUpperCase()]=t);var r=this.getParentFormProxy();return r&&$.isFunction(r.onAfterControlCreate)&&r.onAfterControlCreate.call(r,t),t},initEl:function(e,t,i,a){var n=e.getControl();n&&(n.id=e.getBaseId(),n.dock=t.dock,n.proxy=e,n.loadConfig&&n.loadConfig(t),a?(n.css({border:"solid red 1px",overflow:"hidden"}),n.text(n.attr("data-attdata"))):"panel"==i&&n.css({border:"solid yellow 0px"}))},getGrids:function(){return this.grids||[]},getMenuBars:function(){return this.menuBar||[]},getCmp:function(e){var t=e?this.controls[e]:void 0;return void 0===t&&(t=e?this.controls[e.toUpperCase()]:void 0),t},createForm:function(e,t){var i=KDControlFactoryProxy.formatFormtXType(e.xtype);Constructor=KDControlFactoryProxy.types[i],Constructor||KD.Error.raise({sourceClass:"KDControlFactoryProxy",sourceMethod:"createForm",msg:"The '"+i+"' type has not been registered with this manager"});var a=new Constructor;return a.pageId=e.pageId,KD.layout.setCtOrientation(a,e.ctOrientation),a.initiControlFactoryProxy(),a.initElementByContainerProxy(t,e),this.forms.push(a),t&&(t.childForm=a,this.childForms&&this.childForms.push(a)),a},addForm:function(e){e&&KD.isFunction(e.isFlowForm)&&this.forms&&this.forms.push&&this.forms.push(e)},getForm:function(e){var t;for(var i in this.forms)if(e==this.forms[i].pageId){t=this.forms[i];break}return t},removeForm:function(e){var t=function(e,t){var i=-1;for(var a in t)if(t[a]==e){i=a;break}i>=0&&delete t[i]};t(e,this.forms),t(e,this.childForms),e&&e.dformConfig&&ClientAppProxy.Current.removeAliveForm(e.dformConfig.pageId)},getContentFormProxy:function(e){var t,i=this.forms;for(var a in i){var n=i[a];if(n.getHostWindowProxy()==e){t=n;break}}return t},getFromCache:function(e){var t=null;for(var i in this.forms){var a=this.forms[i];if(null!=a.dformConfig&&null!=a.dformConfig.cacheId&&a.dformConfig.cacheId==e){t=a;break}}return t},doLayout:function(){for(var e in this.controls)this.controls[e.toUpperCase()].doLayout()},setActivate:function(e,t){for(var i=void 0===t,a=function(e,t){for(var i=[],a=$(".kd-kdgrid-base",e.el),n=0;n<a.length;n++){var o=(KD.parseObject($(a[n]).attr("data-attdata")||"")||{}).id||"",r=t.getCmp(o);r&&i.push(r)}return i},n=i?this.getGrids():a(t,this),o=i?this.getMenuBars():[],r=0;r<n.length;r++){var s=n[r];s&&KD.isFunction(s.setActivate)&&s.setActivate.call(s,e)}for(var r=0;r<o.length;r++){var l=o[r];l&&KD.isFunction(l.setActivate)&&l.setActivate.call(l,e)}},release:function(){for(var e in this.controls){var t=this.controls[e.toUpperCase()];try{t&&t.release&&t.release.call(t)}catch(i){KD.writeError(i)}}for(var a in this.grids){var n=this.grids[a];try{n&&n.release&&n.release.call(n)}catch(i){KD.writeError(i)}}for(var o in this.forms){var r=this.forms[o];if(r&&r.dformConfig){r.dformConfig.keepInCache=!1;try{r.doCloseWindow&&r.doCloseWindow.call(r)}catch(i){KD.writeError(i)}}}delete this.controls,delete this.grids,delete this.childForms,this.controls=[],this.grids=[],this.childForm=[]}},define("KDControlFactoryProxy",["KD"],function(e){return function(){var t;return t||e.KDControlFactoryProxy}}(this)),KDControlProxy=function(){},$.extend(KDControlProxy,{isBoxCtrl:function(e){var t=!1;return e&&e.item&&(t="kdcheckbox"==e.item.xtype||"kdradio"==e.item.xtype),t}}),KDControlProxy.prototype={InlineStyleValue:"",requestLock:!1,serverLock:!1,getType:function(){return"KDControlProxy"},getXType:function(){return(this.getConfig()||{}).xtype},getKendoCType:function(){return null},getCType:function(){return null},tabindex:0,isKendo:function(){return $.isFunction(this.getKendoCType)&&this.getKendoCType()||null},getPageId:function(){return this.pageId||(this.pageId=this.getFormProxy().dformConfig.pageId),this.pageId},getFormTheme:function(){if(this.getFormProxy){var e=this.getFormProxy();if(e&&e.FormTheme)return e.FormTheme}return""},getHeight:function(e){return this.elHeight=parseInt((e?e:21)/12*100)/100+"em",this.elHeight},getInnerHeight:function(e,t){return this.innerHeight=parseInt(100*(parseFloat(e||this.elHeight)-(t||2)/12))/100+"em",this.innerHeight},setRequestLock:function(e){this.requestLock=e},setServerLock:function(e){this.serverLock=e,e&&this.setRequestLock(!0)},setViewLocked:function(e){if(this.el&&this.requestLock&&(this.viewLocked=e,$(".kd-ui-viewlocker",this.el).remove(),e)){var t={};if(t.height=this.el.height(),"absolute"==this.el.css("position")||"fixed"==this.el.css("position")||"relative"==this.el.css("position"))$.extend(t,{top:0,left:0});else{t.width=this.el.width();var i=this.el.position();t.top=i.top,t.left=i.left}$('<div class="kd-ui-viewlocker">').css(t).appendTo(this.el)}},createControl:function(e){this.rendered=!1,this.activated=!0,this.config=e,this.isDynamicCreated=e&&e.isDynamicCreated,this.el=0!=$("#"+this.baseId).length?$("#"+this.baseId):this.createControlDom(),this.el.addClass("kd-mouseover-el");var t=this.isKendo();return this.el.attr("id",this.baseId),this.el.dock=this.config.dock,KD.setAttachmentData(this.el,e),null==t&&(this.el.proxy=this),this.attachFocusManager(),this.el},setZindex:function(e){this.el.css("z-index",e)},setX:function(e){this.el.css("left",e+"px")},setY:function(e){this.el.css("top",e+"px")},setGuide:function(e,t,i){function a(e){var t=n.menus&&n.menus.data("kendoContextMenu");if(t){if(param.openMenuNode){var i=n.menus.children("li").length;i>0&&!n.menus.is(":visible")&&n.component.click(),targetli=n.menus.find(param.openMenuNode).closest("li"),0==e?(targetli.removeClass("k-state-hover"),param.setMenuChildLiHover&&(targetli.find(param.setMenuChildLiHover).closest("li").removeClass("k-state-hover"),n.menus.closest(".k-animation-container").slideUp(1e3)),t.close(targetli[0])):(targetli.addClass("k-state-hover"),n.menus.closest(".k-animation-container").css("z-index","10010"),t.open(targetli[0]),param.setMenuChildLiHover&&targetli.find(param.setMenuChildLiHover).closest("li").addClass("k-state-hover"))}param.closeMenuNode&&(targetli=n.menus.find(param.closeMenuNode).closest("li"),targetli.removeClass("k-state-hover"),t.close(targetli[0]))}}var n=this;if(param=e[i],!KD.isEmpty(param)){var o={id:" ",content:"  ",guideText:"   ",serverClick:!1,targetKey:" ",guideLineHeiht:50,dock:"bottom",width:195,targetDomId:"",targetDomClass:"",isGuidePrompt:!1,currentPageId:"",addTop:0,addRight:0,addInputTextForNextStep:"",delayDisappear:0,arrowTop:"",addorremovemask:"",addtipsTop:0,addtipsLeft:0,addtipsWidth:0,addtipsHeight:0,addHandTop:0,addHandLeft:0,text:"",guideType:"",outNextStepBtnClass:"",finishClass:"",finishText:"",isExtClickEvent:!0};1==param.isGuidePrompt&&(o.guideLineHeiht=5),param=$.extend(o,param),1==param.toggleMenuChildNode&&a(param);var r=this.itemContainer||this.el||this.component;if(param.getDomNode&&(r=$("body")),!r)return;if(!KD.isEmpty(param.targetDomId)){var s=r.find("#"+param.targetDomId);r=s.length>0?s:r}if(!KD.isEmpty(param.targetDomClass)){var l=r.find("."+param.targetDomClass);r=l.length>0?l:r}param.showTargetParsentClass&&(r=r.closest("."+param.showTargetParsentClass));var d,c,h;if(param.isGuidePrompt&&1==param.isGuidePrompt){var u="left"==param.dock?"kd-popover-placement-left":"kd-popover-placement-right",p="",g="",f=parseInt(param.width)-37;p="<span class='kd-guidePromptTips'>"+param.content+"</span>",param.finishOrknow&&(g=kendo.format("<div><div class='kd-guidePromptHand-knowbtn {1}'><span data-key='Kindee.BOS.KDGuard.Download'>{2}</span><span data-key='Kindee.BOS.KDGuard.Know' class='kd-guidePromptHand-know-text'>{0}</span></div></div>",param.finishOrknow,param.finishClass,param.finishText)),r.addClass("kd-guidepromptintro-outer");var m=this.setGuideSketch(param,r);d=$(kendo.format("<div class='kd-popover {0}' tabindex='0' style='left: 784px; top: 752px; transform-origin: -4px 0px;display:none'><div class='kd-popover-content'><div class='kd-popover-arrow'></div><div class='kd-popover-inner' role='tooltip'><div><div class='kd-popover-inner-content'><div class='kd-popover-message'><div class='kd-sketch {5}' style= 'background-image:url("+KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png")+");'></div></div><div class='kd-popover-text'><div class='kd-popover-textcontents'>{1}</div></div><div class='kd-popover-guidetext {3}'><span class='kd-popover-step {7}'>{4}</span><span class='kd-guidepromptclose'>{2}</span></div>{6}</div></div></div></div></div>",u,p,param.skipGuide,KD.isEmpty(param.skipGuide)?"kd-popover-guide-hide":"",param.index,m,g,param.languageEnglish?"kd-popover-english-step":"")),d.css({width:param.width}),d.find(".kd-guidePromptTips").css({"max-width":f}),KD.IsNullOrWhiteSpace(param.arrowTop)||d.find(".kd-popover-arrow").css({top:param.arrowTop}),param.needMaskLayer&&(c=$("<div class='k-block kd-guidepromptintro-maskLayer' tabindex='-1' id='divMaskLayer_"+param.id+"'></div>"),h=$("<div class='k-block kd-guidepromptintro-firstmaskLayer' tabindex='-1' id='first_divMaskLayer"+param.id+"'></div>"),$("body").append(c),$("body").append(h)),KD.isEmpty(param.content)&&KD.isEmpty(param.skipGuide)&&d.css({display:"none"})}else d=$("<div class='k-block kd-guideTips' id='tip_"+param.id+"'>"+param.content+"<div class='tip-line'></div><div class='kd-TipsOperators'><a href='#'>"+param.guideText+"</a></div></div>"),d.css({width:param.width});var v=$("<div class='kd-handmasker'></div>");if(KD.isEmpty(param.position)||(d.css({position:param.position}),v.css({position:param.position})),$("body").append(d),KD.isEmpty(param.handdirection)||$("body").append(v),KD.IsNullOrWhiteSpace(param.guideType)){var y=$(".kd-TipsOperators a",d),b=$(".tip-line",d);$(".tip-line:after",d);y.click(function(a){delete n.controlGuide,d.remove()&&v.remove()&&r.removeClass("kd-guidePrompt-extrude kd-guidePrompt-containrelative"),param.serverClick&&t.fireCustomEvents.call(t,param.id,"GuideTipsClick","Click"),t.setControlsGuide.call(t,e,!0,++i),n.afterGuideClose&&n.afterGuideClose()})}else{var D=$(".kd-TipsOperators",d);D.find("a").hide();var k=$(kendo.format("<div class='kd-guide-operationtips kd-guide-confirmtips'><div>{0}</div></div>",ResManager.LoadKDString("确认","00215181000004049"))),C=$(kendo.format("<div class='kd-guide-operationtips kd-guide-cancletips'><div>{0}</div></div>",ResManager.LoadKDString("取消","002014030021133")));D.append(k),D.append(C);var b=$(".tip-line",d);$(".tip-line:after",d);k.off("click").on("click",function(){if(delete n.controlGuide,d.remove()&&v.remove()&&r.removeClass("kd-guidePrompt-extrude kd-guidePrompt-containrelative"),param.serverClick){t.fireCustomEvents.call(t,"confirm","TipsConfirm","Click");var e="Kingdee.BOS.MainConsole.HtmlConsoleMainEdit.H5SmartLayoutChangeTipsConfirm",i={};i.opkey=e,i.opname="Confirm",t.fireCustomEventsNoData.call(t,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(i))}n.afterGuideClose&&n.afterGuideClose()}),C.off("click").on("click",function(){if(delete n.controlGuide,d.remove()&&v.remove()&&r.removeClass("kd-guidePrompt-extrude kd-guidePrompt-containrelative"),param.serverClick){t.fireCustomEvents.call(t,"cancle","TipsConfirm","Click");var e="Kingdee.BOS.MainConsole.HtmlConsoleMainEdit.H5SmartLayoutChangeTipsConfirm",i={};i.opkey=e,i.opname="Cancle",t.fireCustomEventsNoData.call(t,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(i))}n.afterGuideClose&&n.afterGuideClose()})}if(n.controlGuide={container:r,domGuide:d,param:param,line:b,handPosition:v},KD.isEmpty(param.delayInvokeTimeGuidePS)?n.setGuidePosition():KD.delayInvoke(function(){n.setGuidePosition()},param.delayInvokeTimeGuidePS),1==param.isGuidePrompt){var x=this._setViewTips(r,!0);if(0==x.width()&&x.width(r.innerWidth()),0==x.height()&&x.height(r.innerHeight()),param.targetDomId.indexOf("KDINFOLINK")>-1&&(x=r),KD.equalsIgnoreCase(param.targetDomId,"__kdHelpContainer")){var w=$(".icon-expandandcollapse",this.compoment),K=w&&w.find(".kd-maintabRightDiv-expander");K&&K.addClass("kd-maintabRightDiv-expander-expand").removeClass("kd-maintabRightDiv-expander-collapse"),K&&K.css({width:"40px"}),$("#maintabRightDiv",this.compoment).css({display:"block"})}if(param.delayDisappear>0){var S={domGuide:d,eltips:x,container:r};KD.delayInvoke(function(e){e&&(e.domGuide&&e.domGuide.remove(),e.eltips&&e.eltips.remove(),v&&v.remove(),e.container&&e.container.removeClass("kd-guidepromptintro-outer kd-guidePrompt-extrude"))},param.delayDisappear,!0,S)}x.click(function(o){n.controlGuide.outNextStepBtnNode&&n.controlGuide.outNextStepBtnNode.remove(),delete n.controlGuide,r.removeClass("kd-guidepromptintro-outer kd-guidePrompt-extrude kd-guidePrompt-containrelative"),r.children("a").length>0&&KD.IsNullOrWhiteSpace(param.guideText)?param.stopClick||r.find("a").click():(r.hasClass("kd_SystemMenu")&&(ClientAppProxy.Current.delayLoadData="BOS_MainSystemMenuCard"),param.stopClick||r.click()),param.showFullSearchInput&&n.showSearchInput&&n.showSearchInput(),param.showHelpPanel&&$("body").find("#"+param.targetDomId).click(),a(param),d&&d.remove(),v&&v.remove(),x&&x.remove(),param.serverClick&&t.fireCustomEvents.call(t,param.id,"GuideTipsClick","Click"),param.showPopList&&n.afterGuideClose&&n.afterGuideClose(param),t.setControlsGuide.call(t,e,!0,++i),o.stopPropagation()});var I=$(".kd-guidepromptclose",d);I.click(function(){if(KD.CONST.isStartNewUserUtilityWizards=!0,n.controlGuide.outNextStepBtnNode&&n.controlGuide.outNextStepBtnNode.remove(),delete n.controlGuide,0==param.delayDisappear&&t.fireCustomEvents.call(t,"Kingdee.BOS.GuidePrompt.Close","ReLoadH5InfoPanel",KD.stringify({id:param.id,action:"click"})),t.fireEvent.call(t,"ButtonClick","Kingdee.BOS.GuidePrompt.Close","Kingdee.BOS.GuidePrompt.Close",null),n.closeSearchInput&&n.closeSearchInput(),d&&d.remove(),v&&v.remove(),x&&x.remove(),n.helpContainer&&n.helpContainer.hide(),r&&r.removeClass("kd-guidepromptintro-outer kd-guidePrompt-extrude kd-guidePrompt-containrelative kd-guidepromptintro-relative"),param.closeMenuNode&&n.menus&&n.menus.data("kendoContextMenu")){var e=$("body").find(param.closeMenuNode).closest("li");e.removeClass("k-state-hover"),n.menus.data("kendoContextMenu").close(e[0])}$(".kd-guidepromptintro-maskLayer").remove(),$(".kd-guidepromptintro-firstmaskLayer").remove(),param.showPopList&&n.afterGuideClose&&n.afterGuideClose(param)});var P;if(param.outNextStepBtn){var F=r.offset();P=$("<div tabindex='0' style='position:absolute' class='kd-outNextStepBtnNode'></div>"),P.css({width:r.width()+param.addtipsWidth,height:r.height()+param.addtipsHeight,top:F.top+param.addtipsTop,left:F.left,"z-index":100160}).addClass("kd-ui-viewTips"),param.outNextStepBtnClass&&P.addClass(param.outNextStepBtnClass),n.controlGuide.outNextStepBtnNode=P,r.siblings(".icondiv-masklayer").show(),r.closest("#maintabRightDiv").addClass("kd-maintabright-zindex-upgrade"),$("body").append(P),P.off("click").on("click",function(a){if(0==param.isExtClickEvent){n.controlGuide.outNextStepBtnNode&&n.controlGuide.outNextStepBtnNode.remove(),delete n.controlGuide,r.removeClass("kd-guidepromptintro-outer kd-guidePrompt-extrude kd-guidePrompt-containrelative"),r.siblings(".icondiv-masklayer").hide(),r.closest("#maintabRightDiv").removeClass("kd-maintabright-zindex-upgrade"),d&&d.remove(),v&&v.remove(),x&&x.remove(),param.serverClick&&t.fireCustomEvents.call(t,param.id,"GuideTipsClick","Click"),param.showPopList&&n.afterGuideClose&&n.afterGuideClose(param),t.setControlsGuide.call(t,e,!0,++i)}else x.click();P.remove(),a.stopPropagation()})}g&&param.finishOrknow&&d.find(".kd-guidePromptHand-knowbtn").length>0&&$(".kd-guidePromptHand-knowbtn",d).off("click").on("click",function(e){if(param.text)$(".kd-guidepromptclose",d).click();else{d.remove(),x&&x.remove(),a(!1),$(".kd-guidepromptintro-maskLayer").remove(),$(".kd-guidepromptintro-firstmaskLayer").remove();var i=$(e.target).attr("data-key")||"";r&&r.removeClass("kd-guidePrompt-extrude kd-guidepromptintro-relative"),t.fireEvent.call(t,"ButtonClick",i,i,null)}})}}},setGuidePosition:function(){if(!KD.isEmpty(this.controlGuide)){var e=$(this.controlGuide.container),t=$(this.controlGuide.domGuide),i=this.controlGuide.param||{},a=$(this.controlGuide.line);this._setViewTips(e,!0,!0);var n,o,r=e.offset();if("right"==i.dock||"left"==i.dock){if(a.addClass("tip-line-H"),a.css({left:-i.guideLineHeiht,width:i.guideLineHeiht}),n=r.left+e.width()+i.guideLineHeiht,"left"==i.dock&&(n=r.left-i.width-i.guideLineHeiht-7,a.css({left:i.width-1,width:i.guideLineHeiht}).addClass("tip-line-L")),o=r.top+(e.height()-t.outerHeight())/2,!KD.isEmpty(i.arrowTop)){var s=parseFloat(i.arrowTop);s=KD.isNaN(s)?0:s,o=i.arrowTop.indexOf("%")>0?r.top+e.height()/2-t.outerHeight()*s/100:r.top+e.height()/2-s}}else a.addClass("tip-line-V"),a.css({top:-i.guideLineHeiht,height:i.guideLineHeiht}),n=r.left+e.width()/2-t.outerWidth()/2-i.addRight,o=r.top+e.height()+i.guideLineHeiht;if(1==i.isGuidePrompt&&(n=r.left+e.innerWidth()+i.guideLineHeiht+5,
"left"==i.dock&&(n=r.left-i.width-i.addRight-i.guideLineHeiht),o+=parseInt(i.addTop)),i.focusOtherTarget){var l=this.menus&&this.menus.closest(".k-animation-container");if(l){var d=l.offset(),c=d.left-t.outerWidth()-10;n=c>0?c:n,o=d.top>0?d.top:o}}n=0>=n?0:n,o=0>=o?0:o,t.css({left:n,top:o,display:"block"}),i.handdirection&&this.setHandDirection();var h=this.menus&&this.menus.data("kendoContextMenu");h&&this.menus.is(":visible")&&this.menus.closest(".k-animation-container").css("z-index","10010"),this.setoutNextStepBtnNode()}},setHandDirection:function(){if(!KD.isEmpty(this.controlGuide)){var e,t,i=$(this.controlGuide.container),a=$(this.controlGuide.handPosition),n=this.controlGuide.param||{},o=i.offset();switch(e=o.left+(i.width()-a.outerWidth())/2+7,e=e+n.addHandLeft<0?e:e+n.addHandLeft,t=o.top+i.height()+3+n.addHandTop,n.handdirection){case"top":a.css({top:t,left:e}).addClass("kd-handmasker-up");break;case"down":t=o.top-a.outerHeight()-3,a.css({top:t,left:e}).addClass("kd-handmasker-down");break;case"left":e=o.left+i.width()+3,a.css({top:o.top+n.addHandTop,left:e}).addClass("kd-handmasker-left");break;case"right":a.css({top:o.top,left:e-45}).addClass("kd-handmasker-right")}}},setGuideSketch:function(e,t){var i=e.sketchclass||"";switch(e.step){case 1:case 2:t.addClass("kd-guidePrompt-containrelative"),i="kd-userinfosketch";break;case 3:case 4:i="kd-applicationsketch",t.addClass("kd-guidePrompt-extrude");break;case 5:i="kd-helpsketch";break;case 6:i="kd-helpsketch";break;case 7:i="kd-introtocontactus";break;case 8:i="kd-introtoapprise";break;case 9:i="kd-searchsketch-Btn",this.closeSearchInput&&this.closeSearchInput();break;case 10:i="kd-searchsketch-entrance",t.addClass("kd-guidePrompt-containrelative");break;case 11:i="kd-searchsketch-function",t.removeClass("kd-guidepromptintro-outer"),t.addClass("kd-guidepromptintro-relative"),t.find(".kd-fullsearch-searchdisplayname").click()}return i},_setViewTips:function(e,t,i){var a=$('<div class="kd-ui-viewTips">');if(e&&t){var n={};if("kdfullsearch"==this.xtype||"kdicontextbutton"==this.xtype?n.height=e.outerHeight(!0):n.height=e.height(),"absolute"==e.css("position")||"fixed"==e.css("position")||"relative"==e.css("position"))$.extend(n,{top:0,left:0});else{n.width=e.width();var o=e.position();n.top=o.top,n.left=o.left}i?a=e.find(".kd-ui-viewTips").css(n):a.css(n).appendTo(e),param.tipsText&&param.tipstextColor&&param.tipsbgColor&&a.css({"line-height":n.height+"px",color:param.tipstextColor,"background-color":param.tipsbgColor}).text(param.tipsText).addClass("kd-ui-tipstext")}return a},setoutNextStepBtnNode:function(){if(!KD.isEmpty(this.controlGuide)&&this.controlGuide.outNextStepBtnNode){var e=$(this.controlGuide.container),t=this.controlGuide.param||{},i=e.offset();this.controlGuide.outNextStepBtnNode.css({top:i.top+t.addtipsTop,left:i.left})}},createControlDom:function(){return $("<div></div>")},invokeInitComponent:function(){var e=this;KD.delayInvoke(function(){e.initComponent.call(e)})},initComponent:function(){var e=(this.getConfig(),KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(this.getConfig()));this.InlineStyle=$.extend(this.InlineStyle||{},e),this.initCellComponent(),this.setVisible(KD.getValue(this.config,"visible",!0)),this.rendered=!0,this.setStylekey(KD.getValue(this.config,"Stylekey","")),this.setToolTip(this.config.tooltip||this.config.description||"")},initCellComponent:function(e){var t=this.isKendo(),i=this.getConfig(),a=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(i);if(this.InlineStyle=$.extend(this.InlineStyle||{},a),t){var n=$.isFunction(this.getKendoOptions)&&this.getKendoOptions()||{};if(n.style=(n.style?n.style:"")+";"+KD.stringify(this.InlineStyle).replace(/{|}|"+/g,"").replace(/,/g,";"),e)this.el=e,this.component=e[t](n);else{var o=this.createInnerDom();this.el.append(o),this.component=o[t](n)}n.style&&this.component.css(n.style),n.tagClass&&this.component.addClass(n.tagClass),n.id&&this.component.attr("id",n.id),null==this.component||0==this.component.length,KDFlowlayoutProxy.getCtOrientation(i)&&this.el.css(a)}else this.setInlineStyle(),this.el.addClass(this.getStyleKey());this.setVisible(KD.getValue(this.config,"visible",!0)),this.component&&this.setDisabled(KD.getValue(this.config,"disabled",!1)),this.setEditable&&this.setEditable(KD.getValue(this.config,"editable",!0)),this.rendered=!0,this.setStylekey(KD.getValue(this.config,"Stylekey","")),this.setToolTip(this.config.tooltip||this.config.description||"")},createInnerDom:function(){return $("<span>")},getComponentByDom:function(e,t){var i=$("#"+e,this.el);if(i&&i.length||1!=t.length||(i=t),!i||!i.length)for(var a in t){var n=t[a];if(n&&n[0]){var o=$(n[0]).attr("id");if(e==o){i=n;break}}}return i},setInlineStyle:function(e){e&&"string"==typeof e&&(e=KD.parseObject(e)),this.InlineStyle=$.extend(this.InlineStyle||{},e);var t=this.isKendo();t&&this.component?this.component.css(this.InlineStyle):this.el&&this.el.css(this.InlineStyle)},addInlineClass:function(e){if(!e||"string"==typeof e){var t=this.isKendo();t&&this.component?this.component.addClass(e):this.el&&this.el.addClass(e)}},setChildFormCtStyleValue:function(e){var t;t=KD.isArray(e)?e[0]:e||"";var i=(this.isKendo(),this.InlineStyle||{}),a=t.split(";");for(var n in a)if(!KD.IsNullOrWhiteSpace(a[n])){var o=a[n].split(":");i[o[0]]=o[1]}this.hostWindowProxy&&this.hostWindowProxy.el.childFormCt&&this.hostWindowProxy.el.childFormCt.css(i)},setInlineStyleValue:function(e){KD.isArray(e)?this.InlineStyleValue=e[0]:this.InlineStyleValue=e||"";var t=this.isKendo(),i=this.InlineStyle||{},a=this.InlineStyleValue.split(";");for(var n in a)if(!KD.IsNullOrWhiteSpace(a[n])){var o=a[n].split(":");i[o[0]]=o[1]}t&&this.component&&this.component.option?this.component.option("style",i):this.el&&this.el.css(i),this.editor&&this.editor.setInlineStyleValue&&this.editor.setInlineStyleValue(i)},isContainer:function(){return!1},isItemContainer:function(){return!1},isFlowLayout:function(){return!1},getOptions:function(){return{id:this.baseId+"_c",hidden:!1,tagClass:this.getStyleKey()}},getKendoOptions:function(e){var t=this;void 0===e?t.config:e;return{id:t.baseId+"_c",tagClass:t.getStyleKey()}},getStyleKey:function(){return this.config?this.config.stylekey||"":""},setStyleKey:function(e){this.setStylekey(e)},setStylekey:function(e){var t=this.isKendo();t&&this.component?this.component.addClass(e):this.el&&this.el.addClass(e)},isRestting:function(){return this.restting},setRestting:function(e){this.restting=e},setSync:function(e){this.sync=e,this.el&&this.el.attr("data-sync",e)},getSync:function(){var e=this.sync;return this.el&&(e="true"==this.el.attr("data-sync")),e},getToolTip:function(){return this.tooltip},setToolTip:function(e){this.tooltip=e;var t=(KD.htmlUtil.encode(e)||"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");this.component?this.component.attr("title",t):this.el&&this.el.attr("title",t)},getDisabled:function(){return this.disabled},setDisabled:function(e){this.disabled=e;var t=this.isKendo();if(t&&this.component){var i=this.component.data(t);if(i&&i.enable)return i.enable(!e)}},setReadonly:function(e){this.disabled=e,this.readonly=e;var t=this.isKendo();return t&&this.component.data(t).input?this.component.data(t).input.attr("readonly",e):void 0},getStyle:function(){return this.style},getLayoutSettingIsbecommon:function(){return"0"},setStyle:function(e){this.style=e},isVisible:function(){return void 0===this.visible?!0:this.visible&&this.isParentVisible()},setVisible:function(e){var t=this,i=void 0===t.visible?t.config.visible:t.visible,i=void 0===i?!0:i;t.visible!=e&&(t.visible=e,!t.config,t.visible||void 0===t.config.height?void 0!==t.config.metaHeight&&$.extend(t.config,{height:t.config.metaHeight,width:t.config.metaWidth}):$.extend(t.config,{height:0,width:0}),t.el&&t.el.setVisible?(t.el.setVisible(e),t.onAfterVisible.call(t,{visible:e,oldVisible:i})):t.el&&(e?(t.el.show(),t.onAfterVisible.call(t,{visible:!0,oldVisible:i})):(t.el.hide(),t.onAfterVisible.call(t,{visible:!1,oldVisible:i}))))},isParentVisible:function(){return void 0===this.parentVisible?!0:this.parentVisible},setParentVisible:function(e){this.parentVisible=e,this.onAfterVisible({visible:e})},onAfterVisible:function(e){var t=this;KD.isFunction(t.visibleCallback)&&t.visibleCallback(e)},getTabIndex:function(){return this.tabindex},setTabIndex:function(e){this.tabindex=e},getX:function(){return this.x},getY:function(){return this.y},getDock:function(){return this.dock},getZIndex:function(){return this.Zindex},getControlFactoryProxy:function(){return this.controlFactoryProxy},setControlFactoryProxy:function(e){this.controlFactoryProxy=e},getFormProxy:function(){var e=this.controlFactoryProxy,t=e.getParentFormProxy.call(e);return t},getFormId:function(){if(!this.formId){var e=this.getFormProxy();this.formId=e.dformConfig.formid}return this.formId},getControl:function(){return this.el},getParentProxy:function(){var e,t=this.config?this.config.parent:"";if(t){var i=this.getFormProxy();e=i.getControlProxy.call(i,t)}return e},getKey:function(){return this.key},loadConfig:function(e){this.key=e.id,this.config=e,e.height&&(this.config.metaHeight=e.metaHeight?e.metaHeight:e.height,this.elHeight=this.getHeight(e.height),this.innerHeight=this.getInnerHeight()),e.width&&(this.config.metaWidth=e.metaWidth?e.metaWidth:e.width),this.setSync(KD.getValue(e,"sync",!1)),KD.layout.setAbsolute(this.el,e),e.InlineStyle&&"string"==typeof e.InlineStyle&&(e.InlineStyle=KD.parseObject(e.InlineStyle)),this.InlineStyle=e.InlineStyle||{},this.InlineStyleValue=e.InlineStyleValue||"",e.font&&this.setFont(e.font),e.text&&this.isDontLazy()&&this.el.text(e.text)},isDontLazy:function(){return this.rendered},doLazyAction:function(){var e=this.lazyActions;if(e){for(var t=e.length,i=0;t>i;i++){var a=e[i];if("updateState"==a.name)this.updateState(a.args);else if("invokeMethod"==a.name)this.invokeMethod(a.args[0],a.args[1]);else if("showDynamicForm"==a.name){var n=this.getFormProxy();n.showDynamicForm.call(n,a.args)}else"selectEntities"==a.name&&this.setSelectEntities&&this.setSelectEntities(a.args.selectEntities)}delete this.lazyActions}},pushLazyAction:function(e,t){this.lazyActions||(this.lazyActions=[]),this.lazyActions.push({name:e,args:t})},pushLazyMsg:function(e,t){if(this.lazyMsg||(this.lazyMsg=[],this.lazyMsgKeyMap={}),"UpdateControlStates"==e||"InvokeControlMethod"==e){var i=t[0].key;this.lazyMsgKeyMap[i]=this.lazyMsgKeyMap[i]||[],this.lazyMsgKeyMap[i].push({index:this.lazyMsg.length})}this.lazyMsg.push({actionname:e,params:t})},updateState:function(e){return this.updateStateIgnoreActive(e),this.isDontLazy()?void this.updateStateCore(e):void this.pushLazyAction("updateState",e)},updateStateIgnoreActive:function(e){},updateStateCore:function(e){var t=e?e.key:"[]",i="";for(var a in e){i=a;try{if(a in this&&"function"==typeof this[a])this[a].call(this,e[a]);else{var n=a.substr(0,1);i="set"+n.toUpperCase()+a.substr(1),this[i]?this[i].call(this,e[a]):this.editor&&this.editor[i]?this.editor[i].call(this.editor,e[a]):this[a]=e[a]}}catch(o){var r=this.getFormProxy();!KD.writeError(o)&&r&&r.showErrMsgStr.call(r,"KDControlProxy.updateState(),key:"+t+";method:"+i,o.message+"<p>"+o.description+"<p>"+o.stack)}}},invokeMethod:function(e,t){if(!this.isDontLazy())return void this.pushLazyAction("invokeMethod",[e,t]);var i,a,n=e.substr(0,1),o=n.toLowerCase()+e.substr(1);return o in this&&"function"==typeof this[o]?t&&0!=t.length?1==t.length?i=this[o].call(this,t[0]):2==t.length?this[o].call(this,t[0],t[1]):3==t.length?this[o].call(this,t[0],t[1],t[2]):4==t.length?this[o].call(this,t[0],t[1],t[2],t[3]):5==t.length?this[o].call(this,t[0],t[1],t[2],t[3],t[4]):6==t.length&&this[o].call(this,t[0],t[1],t[2],t[3],t[4],t[5]):this[o].call(this):this.isItemContainer()&&this.editor&&(i=this.editor.invokeMethod.call(this.editor,e,t)),0==(e+"").toLowerCase().indexOf("get")&&(a=i),a},setServer:function(e){this.server=e},getConfig:function(){return this.config},getServer:function(){return this.server},setBaseId:function(e){this.baseId=e},getBaseId:function(){return this.baseId},focus:function(e){},doLayout:function(){this.el&&this.el.doLayout&&this.el.doLayout(),this.setGuidePosition()},doParentLayout:function(){var e=this.getParentProxy();e&&e.doLayout&&e.doLayout.call(e)},setItemContainer:function(e){this.itemContainer=e},updateDisplayText:function(){return this.el.setValue(this.getValue())},release:function(){var e=this.isKendo();if(this.isChilderInited=!1,this.el&&e){var t=this.el.data(e);t&&t.destroy(),this.component&&this.component.remove()}this.detachFocusManager(),this.el&&this.el.release&&this.el.release()},setHeight:function(e){this.config&&(this.config.customHeight=e),this.el&&this.el.css("height",e+"px"),this.editor&&this.editor.setHeight&&this.editor.setHeight.call(this.editor,e)},setWidth:function(e){this.config&&(this.config.customWidth=e),this.el&&this.el.css("width",e+"px"),this.editor&&this.editor.setWidth&&this.editor.setWidth.call(this.editor,e)},setFont:function(e){if(e){var t=KD.parseObject(e),i=new Object;for(var a in t)"fontName"==a?i["font-family"]=this.getCssFontName(t[a]):"fontStyle"==a?(this.el.css("font-style","normal"),this.IsFontBold(t[a])&&(i["font-weight"]="bold"),this.IsItalic(t[a])&&(i["font-style"]="italic"),this.IsStrikeout(t[a])&&(i["text-decoration"]="line-through"),this.IsUnderline(t[a])&&(i["text-decoration"]="underline")):"fontSize"==a?i["font-size"]=t[a]+"px":this.el.css(a,t[a]);this.el.css(i)}},setForecolor:function(e){this.setForeColor(e)},setForeColor:function(e){if(!KD.IsNullOrWhiteSpace(e)){var t=-1!=e.indexOf("#")||-1!=e.toUpperCase().indexOf("RGB")?KD.interceptColorStr(e):"rgb("+e+")";this.el.css("color",t),this.editor&&this.editor.setForeColor(t)}},setTitleForceColor:function(e){if(!KD.IsNullOrWhiteSpace(e)){var t=-1!=e.indexOf("#")||-1!=e.toUpperCase().indexOf("RGB")?KD.interceptColorStr(e):"rgb("+e+")";this.el.find(".kdItemContainer_label span").css("color",t)}},setBackcolor:function(e){this.setBackColor(e)},setBackColor:function(e){if(!(KD.IsNullOrWhiteSpace(e)||this.editor&&this.editor.disabled)){var t=-1!=e.indexOf("#")||-1!=e.toUpperCase().indexOf("RGB")?KD.interceptColorStr(e):"rgb("+e+")";this.editor&&this.editor.setBackColor&&this.editor.setBackColor(t)}},getCssFontName:function(e){return"宋体"==e?"Simsun":"楷体"==e?"KaiTi":"黑体"==e?"SimHei":"仿宋"==e?"FangSong":"微软正黑体"==e?"Microsoft JhengHei":"细明体"==e?"MingLiu":"微软雅黑"==e?"Microsoft YaHei":"隶书"==e?"LiSu":"华文彩云"==e?"STCaiyun":"华文琥珀"==e?"STHupo":"华文隶书"==e?"STLiti":"华文新魏"==e?"STXinwei":"华文行楷"==e?"STXingkai":"幼圆"==e?"YouYuan":"SimSun"},IsFontBold:function(e){return 1==(1&e)},IsStrikeout:function(e){return 8==(8&e)},IsUnderline:function(e){return 4==(4&e)},IsItalic:function(e){return 2==(2&e)},IsNormal:function(e){return 0==(0&e)},getBlocking:function(e){var t=this,i=t.blocking;return i||(t.blocking=i=new KD.blocking,i.init.call(i,$.extend({target:t.getControl(),text:""},e))),i},showBlocking:function(e){var t=this.getBlocking();t.show.call(t,e)},hideBlocking:function(e){var t=this.getBlocking();t.hide.call(t,e)},attachFocusManager:function(){FormFocusedManager.registeCtrlProxy(this)},detachFocusManager:function(){FormFocusedManager.unregisteCtrlProxy(this)},getLineTipsDefConfig:function(e){var t={id:e,xtype:"kdtooltip"};return t}},define("KDControlProxy",["ResManager","KDControlFactoryProxy","KD"],function(e){return function(){var t;return t||e.KDControlProxy}}(this)),KDContainerProxy=KD.extend(KDControlProxy,{loadConfig:function(e,t){KDContainerProxy.superclass.loadConfig.call(this,e),this.isChilderLoaded=!1,this.style=e.style,this.hscroll=e.hscroll,this.vscroll=e.vscroll,this.border=e.border,this.backgroundimage=e.backgroundimage,this.ImageShowStyle=e.ImageShowStyle,this.zindex=e.zindex,this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(this.config)),t||this.loadChildren(e),this.loaded=!0},applyConfig:function(e){},onAfterVisible:function(e){var t=this;KD.isFunction(t.visibleCallback)&&t.visibleCallback(e),t.notifyChildrenVisible(e.visible),t.doLazyAction()},isFlowLayout:function(){return!1},onAfterControlInited:function(e){var t=this.getFormProxy();t&&$.isFunction(t.onAfterControlInited)&&t.onAfterControlInited.call(t,e)},initchildren:function(){var e=void 0;for(var t in this.children)e=this.children[t],e.initComponent.call(e);e&&e.setParentVisible&&e.setParentVisible.call(e,this.isParentVisible())},isContainer:function(){return!0},notifyChildrenVisible:function(e){if(KD.isArray(this.children)){var t=this.children[0];t&&t.setParentVisible&&t.setParentVisible.call(t,e);for(var i in this.children)t=this.children[i],t.doLazyAction.call(t)}},loadChildren:function(e){if(!this.isChilderLoaded){var t=this;t.children||(t.children=[]);var i=e.items,a=t.getControlFactoryProxy();if(null!=i&&a)for(var n in i){var o=i[n];o.id=o.id?o.id.toUpperCase():void 0,o.isDynamicCreated=o.isDynamicCreated||t.isDynamicCreated,o.parent=this.config.id,e.isstackpanel&&1==e.isstackpanel&&(o.isNoneAbsPosition=!0,e.stackorientation&&1==e.stackorientation&&(o.width="100%"));t.createInnerControl(o)}this.initchildren(),this.isChilderLoaded=!0}},createInnerControl:function(e){var t=this,i=t.getControlFactoryProxy();if(!i)return{};var a=i.createControl.call(i,e);a.parentProxy=t,t.children=t.children||[],t.children.push(a);var n=a.getControl.call(a);if(n.dock=e.dock,"kdpopup"==a.config.xtype||"kdPopupWorkPages"==a.config.xtype||"kdPopupMainMenuProxy"==a.config.xtype)$(document.body).append(n);else if("kdanchor"==a.config.xtype){var o=t.getFormProxy().el;o&&o.addControl&&o.addControl.call(o,n)}else t.el.addControl?t.el.addControl.call(t.el,n):n.appendTo(t.el);return a.loadConfig.call(a,e),t.onAfterControlInited(a),a},createControl:function(e){KDContainerProxy.superclass.createControl.call(this,e),this.el=this.el.KDPanel()},addDynamicForm:function(e){this.childForm=e;var t=e.getControl.call(e);t.appendTo(this.el)},getContentFormProxy:function(e){var t=this.getControlFactoryProxy(),i=t.getContentFormProxy.call(t,e||this);return i},doChildFormLayout:function(){this.childForm&&this.childForm.doLayout.call(this.childForm)},doLayout:function(){if(this.config&&this.config.isFlowForm){var e={height:"auto"};this.el&&this.el.css(e)}else this.el&&this.el.doLayout&&this.el.doLayout.call(this.el,this.config||this.dformConfig);if(this.children&&this.children.length)for(var t=0;t<this.children.length;t++){var i=this.children[t];i&&i.doLayout&&i.doLayout.call(i)}},release:function(){this.children&&KD.isArray(this.children)&&$.each(this.children,function(e,t){t.release.call(t)}),KDContainerProxy.superclass.release.call(this),delete this.childForm,delete this.children},hideWindow:function(){this.el.hide()},closeWindow:function(e,t){if("kdPopupMainMenuProxy"==this.config.xtype)this.closePopUpDirect();else{var i=this.getControlFactoryProxy(),a=t?i.getForm.call(i,t):this.getContentFormProxy(this);if(i.removeForm.call(i,a),t){var n;n=this.childForm&&this.childForm.getPageId()==t?this.childForm:this.childForms?this.childForms[t]:a,n&&$(document).find(n.el).length>0&&n.el.remove()}else this.el.empty()}},clearControls:function(e){if(e){var t=e.items||e.children;if(t){var i=t;if(i)for(var a=this.getControlFactoryProxy(),n=this,o=0;o<i.length;o++){var r=i[o],s=r&&r.id?r.id.toUpperCase():void 0;s&&(r.id=s,a.removeProxyInstance.call(a,s),n.clearControls(r))}}}}}),$.extend(KDContainerProxy,{isFormContainerReady:function(e){return void 0===e?!1:e.rendered}}),KDOnlyContainerProxy=KD.extend(KDContainerProxy,{loadConfig:function(e){KDOnlyContainerProxy.superclass.loadConfig.call(this,e)},createControl:function(e){var t=this;return KDContainerProxy.superclass.createControl.call(t,e),t.el.css({overflow:"visible"}),t.el}}),KDControlFactoryProxy.registerType("overcontainer",KDOnlyContainerProxy),define("KDContainerProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDContainerProxy}}(this)),function(e){KDInfoDataFlowConverter=function(t,i){function a(e,t){for(var i={items:[]},o=e.children||e.items||[],r=KDFlowlayoutProxy.isColumn(t),d=0;d<o.length;d++){var c=o[d],h=n(c),u=h.xtype==s;if(r&&u){var p=h;p.zindex=0,h={xtype:l,orientation:KDFlowlayoutProxy.vertical,id:h.id+"_itemct",height:p.height,width:p.width,dock:0,zindex:d,items:[p]}}else h.zindex=d,h.items=a(c,h).items;i.items.push(h)}return i}function n(t){t.cols>1&&t.rows>1&&e.writeLog("Console info. panel ["+t.id+"] has mutiple rows["+t.rows+"] and cols["+t.cols+"] configuration!The special layout isn's supported");var i={height:e.isNumber(t.height)?t.height:(t.height||"").indexOf("*")>0?"auto":parseInt(t.height||""),width:e.isNumber(t.width)?t.width:(t.width||"").indexOf("*")>0?"100%":parseInt(t.width||""),orientation:void 0===t.orientation?t.cols>1?KDFlowlayoutProxy.column:KDFlowlayoutProxy.vertical:t.orientation},a={id:t.id,isInfo:!0,style:t.style,row:t.row,col:t.col,tempwidth:t.tempwidth,background:t.background,padding:t.padding,title:t.title,showtitle:t.showtitle,margin:e.isEmpty(t.margin)?"0,0,0,0":t.margin,hoverable:e.getValue(t,"hoverable",!1),text:e.getValue(t,"text",""),styleKey:e.getValue(t,"styleKey",""),backgroundimage:e.getValue(t,"backgroundimage",""),preloadImage:e.getValue(t,"preloadImage",""),fixedSize:(t.tempwidth||"").indexOf("*")>0?void 0:1,allowexpand:t.allowexpand,formid:t.formid,keyvalue:t.keyvalue,ishideprogressindicator:t.ishideprogressindicator,cardparminfo:t.cardparminfo,cardname:t.cardname,Seq:t.Seq,cardid:t.cardid,xtype:xtypeMaps[t.xtype]?xtypeMaps[t.xtype]:t.xtype,orientation:t.xtype==o?i.orientation:void 0,isallowedit:t.isallowedit,isshowedit:t.isshowedit,isspilit:t.isspilit,spiltcardheight:t.spiltcardheight,spiltcardwidth:t.spiltcardwidth,isaddbutton:t.isaddbutton,visible:t.visible,detailfuncid:t.detailfuncid,titleclass:t.titleclass,isautoheight:t.isautoheight,bussinesssplitlineclass:t.bussinesssplitlineclass};return t["max-height"]&&!e.isNaN(t["max-height"])&&(a.maxHeight=t["max-height"]),e.isNaN(i.height)||(a.height=i.height),e.isNaN(i.width)||(a.width=i.width),KDFlowlayoutProxy.isVertical(i)&&(a.minHeight=a.height),t.isNeedPackEvent&&(a.isNeedPackEvent=t.isNeedPackEvent),a}var o="KDInfoPanel",r="KDInfoItem",s="kdinfoflowitem",l="kdinfoflowpanel";return xtypeMaps={},xtypeMaps[r]=s,xtypeMaps[o]=l,a(t,i)}}(KD),define("KDInfoDataFlowConverter",["KD"],function(e){return function(){var t;return t||e.KDInfoDataFlowConverter}}(this)),function(e){KDInfoDataFlowConverterForMainMenuTree=function(t,i){function a(t,i){var r=t,s={items:[]};r&&!e.isEmpty(r.items)&&$.each(r.items[0].children,function(e){$.each(r.items[0].children[e].children,function(t){var i=r.items[0].children[e].children[t],a=n(i.id,i.text,i.cardid,i.startype,i.commfunid);r.items[0].children[e].children[t].children=a})});for(var d=r.children||r.items||[],c=(KDFlowlayoutProxy.isColumn(i),0);c<d.length;c++){var h=d[c],u=o(h);u.xtype==l;u.zindex=c,u.items=a(h,u).items,s.items.push(u)}return s}function n(t,i,a,n,o){var r=[],s=u||ResManager.LoadKDString("点击添加到常用功能","014006000001507"),l="KDINFOLINK"+a,d="KDINFOLINKTEXT"+a,f="kd-btn-h5cardsubsysmenuestart",m=e.isEmpty(o)?"KDINFOLINKSTARTADDTOCOMMUNFUN"+a:"KDINFOLINKSTARTADDTOCOMMUNFUN"+a+"COMMFUNID"+o;n!=c||e.isEmpty(o)||(s=p||ResManager.LoadKDString("点击取消常用功能","002014030037301"),f="kd-btn-h5cardsubsysmenuessolidtart",m="KDINFOLINKSTARTREMOVEFORMCOMMUNFUN"+a+"COMMFUNID"+o),n!=h||e.isEmpty(o)||(s=g||ResManager.LoadKDString("移动到当前常用功能卡片","002014030037302"),f="kd-btn-h5cardsubsysmenuesgreysolidtart",m="KDINFOLINKSTARTMIGRATEFROMCURCOMMUNFUN"+a+"COMMFUNID"+o);var v={id:l,detailfuncid:l,parent:t,title:i,dock:0,lineWrap:!0,style:"line-height:21px;",styleKey:"kd-btn-h5cardsubsysmenuelink",vscroll:0,xtype:"kdlinkbutton"},y={id:d,parent:t,text:i,dock:0,styleKey:"kd-btn-h5cardsubsysmenuelinktext",vscroll:0,xtype:"kdlinkbutton"};if(e.isManagementSite())r.push(v),r.push(y);else{var b={id:m,detailfuncid:m,parent:t,title:s,dock:0,lineWrap:!0,style:"line-height:21px;",styleKey:f,width:16,height:16,xtype:"kdlinkbutton"};r.push(v),r.push(y),r.push(b)}return r}function o(t){t.cols>1&&t.rows>1&&e.writeLog("Console info. panel ["+t.id+"] has mutiple rows["+t.rows+"] and cols["+t.cols+"] configuration!The special layout isn's supported");var i={height:e.isNumber(t.height)?t.height:(t.height||"").indexOf("*")>0?"auto":parseInt(t.height||""),width:e.isNumber(t.width)?t.width:(t.width||"").indexOf("*")>0?"100%":parseInt(t.width||""),orientation:void 0===t.orientation?t.cols>1?KDFlowlayoutProxy.column:KDFlowlayoutProxy.vertical:t.orientation},a={id:t.id,isInfo:!0,style:t.style,row:t.row,col:t.col,background:t.background,title:t.title,showtitle:t.showtitle,margin:e.isEmpty(t.margin)?"0,0,0,0":t.margin,hoverable:e.getValue(t,"hoverable",!1),text:e.getValue(t,"text",""),styleKey:e.getValue(t,"styleKey",""),ishideprogressindicator:t.ishideprogressindicator,cardid:t.cardid,xtype:xtypeMaps[t.xtype]?xtypeMaps[t.xtype]:t.xtype,orientation:t.xtype==r?i.orientation:void 0,visible:t.visible,detailfuncid:t.detailfuncid,titleclass:t.titleclass};return t["max-height"]&&!e.isNaN(t["max-height"])&&(a.maxHeight=t["max-height"]),e.isNaN(i.height)||(a.height=i.height),e.isNaN(i.width)||(a.width=i.width),KDFlowlayoutProxy.isVertical(i)&&(a.minHeight=a.height),a}var r="KDInfoPanel",s="KDInfoItem",l="kdinfoflowitem",d="kdinfoflowpanel",c="red",h="grey",u=ResManager.LoadKDString("点击添加到常用功能","014006000001507"),p=ResManager.LoadKDString("点击取消常用功能","002014030037301"),g=ResManager.LoadKDString("移动到当前常用功能卡片","002014030037302");return xtypeMaps={},xtypeMaps[s]=l,xtypeMaps[r]=d,a(t,i)}}(KD),define("KDInfoDataFlowConverterForMainMenuTree",["KD"],function(e){return function(){var t;return t||e.KDInfoDataFlowConverterForMainMenuTree}}(this)),function(e){KDFlowlayoutProxy=e.extend(KDContainerProxy,{allFlowlayoutChild:!0,bizBlockCls:"kd-flow-bizblock",altBizBlockCls:"kd-flow-bizblock-odd",isChilderInited:!1,isFlowLayout:function(){return!0},getOrientation:function(){return this.config.orientation},createControl:function(t){var i=this;return this.adjustTheDockMeta(t),t.orientation||e.layout.setOrientation(t,KDFlowlayoutProxy.vertical),i.isFlowBillRootPanel=this.__isFlowBillRootPanel(t),KDContainerProxy.superclass.createControl.call(i,t),i.beforeCreateContent(t),i.childrenCt=$('<div id="'+i.getContentId()+'" style="width:100%;height:auto;">').appendTo(i.el),i.flowBottomPlaceHolder=$('<div class="kd-bill-flow-bottom-placeholder" '+(t.mainMenuBarHeight?'style="height:'+1.5*t.mainMenuBarHeight+'px"':"")+">"),i.afterCreateContent(t),i.clear=$('<div class="kd-clear" style="clear:both;height:0px;">'),this.el},adjustTheDockMeta:function(e){var t=this.getFormProxy(),i=t.dformConfig;if(!i||!i.fluidSettings){var a=this.getFormId(),n=KDPanelProxy.getFormMetaPlugins(a);n&&n(e)}},beforeCreateContent:function(e){},afterCreateContent:function(e){},initComponent:function(){KDFlowlayoutProxy.superclass.initComponent.call(this)},loadConfig:function(t){KDFlowlayoutProxy.superclass.loadConfig.call(this,t);var i=this;i.el.addClass("kd-flowlayout"),t.styleKey&&i.el.addClass(t.styleKey);var a={};if(KDFlowlayoutProxy.isFlowlayoutChild(this.config)||$.extend(a,{overflow:"auto"}),t.margin){var n=e.layout.kdRangeSize2HTMLRangeSize(t.margin),o=e.layout.getRangeSizeStyleValue("margin",n);$.extend(a,o)}if(t.padding){var r=e.layout.kdRangeSize2HTMLRangeSize(t.padding),o=e.layout.getRangeSizeStyleValue("padding",r);$.extend(a,o)}KDFlowlayoutProxy.isColumn(i.config)&&$.extend(a,{"overflow-x":"hidden","overflow-y":"hidden",height:"auto"}),i.config.background?(i.backColor=e.getHexColor(t.background),$.extend(a,{"background-color":i.backColor})):i.config.backcolor&&(i.backColor=e.getHexColor(t.backcolor),$.extend(a,{"background-color":i.backColor})),KDFlowlayoutProxy.isFormOnlyChild(i.config)&&$.extend(a,{height:"auto",overflow:"none"}),KDFlowlayoutProxy.isInColumn(i.config)&&$.extend(a,{display:"inline-block","float":"left"}),i.el.css(a),e.isEmpty(t.modelTitle)||this.setModelTitle(t.modelTitle)},setModelTitle:function(t){if(!e.isEmpty(t)){var i=this.el.closest(".kdform"),a=$(".kd-modelTitlePanel",i);if(!(a.length>=1)){var n=this;a=$("<div class='kd-modelTitlePanel'><div class='kd-modelTitleSpan'><span>"+t+"</span></div><div class='kd-modelClose'><span class='k-icon k-i-close'></span></div><div style='clear: both;'></div></div>"),i.prepend(a),$(".k-i-close",a).click(function(){n._close.call(n)})}}},_close:function(){var e=this.getFormProxy();e&&e.invokeCloseAction.call(e)},getContentId:function(){return this.getBaseId()+"_c"},getContent:function(){return this.childrenCt||$("#"+this.getContentId(),this.el||$(document))},loadChildren:function(t){var i=this;(!i.children||i.children.length>0)&&(i.children=[]),i.clear&&i.clear.remove();var a=t.items;null!=a&&i.getControlFactoryProxy()&&this.__recalcItemSize(t,function(e){i.createInnerControl.call(i,e)}),0==i.isChilderInited&&0!=t.visible&&this.initchildren(),!i.allFlowlayoutChild&&KDFlowlayoutProxy.isColumn(t)&&e.writeLog("Type error in ["+i.getKey()+"] children.","All children of  ["+i.getKey()+"] must be flowlayout.")},isNeedMetaSort:function(){var e=this.getFormProxy();return e&&e.isNeedFlowMetaSort&&e.isNeedFlowMetaSort.call(e)},__recalcItemSize:function(t,i){var a=this,n=t.items,o=0,r=this.el.width();if(null!=n&&a.getControlFactoryProxy()){for(var s=this.isNeedMetaSort()&&1!=t.isInfo?e.quickSort(n,"zindex"):n,l=0;l<n.length;l++){var d=n[l];a.allFlowlayoutChild=a.allFlowlayoutChild&&KDFlowlayoutProxy.isFlowlayout(d),o+=d.width}var c=o,h=r;c>h&&(c=h);var u=!1;for(var l in s){var d=s[l];KDFlowlayoutProxy.isAbsPosChild(d)||e.layout.setCtOrientation(d,a.getOrientation()),d.parent=a.config.id,d.inAllFlowlayoutChild=a.allFlowlayoutChild,KDFlowlayoutProxy.isInColumn(d)&&(u=u||d.fixedSize,l!=s.length-1||u||(d.fixedSize=0),d.fixedSize&&(fw=d.width<=h?d.width:c,c-=fw,h-=fw,d.perWidth=fw,d.calcWidth=fw))}for(var l in s){var d=s[l];if(KDFlowlayoutProxy.isInColumn(d)&&!d.fixedSize){var p=d.width/c;p>1&&(p=1),d.perWidth=(100*p).toString()+"%",d.calcWidth=parseInt((h*p).toString())}i&&i(d)}}},__isFlowBillRootPanel:function(e){return"BILLCONTROLS"==this.getKey()&&KDFlowlayoutProxy.isFlowlayout(e)},__isMainBill:function(e){return!!e.isMain},refreshAltBizStyle:function(e){if(this.isFlowBillRootPanel){var t=this,i=t.getFormProxy(),a=t.bizBlockCls,n=t.altBizBlockCls,o=t.el,r=0;if(!e){var s=i.getControlProxy.call(i,i.billDashBoardKey);e=s?s.getVisKeys.call(s):void 0}$("."+a,o).removeClass(n),e=e||[];for(var l=0;l<e.length;l++){var d=e[l],c=d?i.getControlProxy.call(i,d):void 0;c&&!KDFlowlayoutProxy.isAbsPosChild(c.config)&&(r++,r%2==0&&c.setStylekey.call(c,n))}}},createInnerControl:function(t){var i=this;KDFlowlayoutProxy.isAbsPosChild(t)||(t.isNoneAbsPosition=!0,t.dock=e.dock.None),i.isFlowBillRootPanel&&(t.styleKey=(t.styleKey||"")+" "+this.bizBlockCls);var a=i.getControlFactoryProxy(),n=a.createControl.call(a,t);i.children.push(n),n.config=t;n.getControl.call(n);return n},initchildren:function(){var e=this;for(var t in e.children){var i=e.children[t],a=i.getControl.call(i);a.appendTo(e.getContent()),i.loadConfig.call(i,i.config),i.initComponent.call(i),i.doLazyAction.call(i)}e.__isFlowBillRootPanel(e.config)&&e.__isMainBill(e.config)&&KDFloatingManager.instance.allowFloating,e.clear&&e.clear.appendTo(e.getContent()),e.isChilderInited=!0,e.doLayout()},isReplaceFormMode:function(e){var t=this;return("BOS_HtmlConsoleMain"==t.formId||"BOS_INFOFLOWLAYOUTPANEL_CARD"==t.formId||"BOS_HtmlConsole"==t.formId)&&"BOS_HtmlConsoleMainFooter"!=(e||{}).formid},addDynamicForm:function(t){var i=this;i.clear&&i.clear.remove(),i.childForms||(i.childForms={});var a=t.pageId,n=i.childForms[a];n&&(n.doCloseWindow.call(n),delete i.childForms[a]),i.childForms[a]=t;var o=t.getControl.call(t);i.isReplaceFormMode(arguments[1]||{})&&i.getContent().empty(),o.appendTo(i.getContent()),i.clear&&i.clear.appendTo(i.getContent()),KDFlowlayoutProxy.isColumn(i.config)&&e.writeLog("Container Type Error in ["+i.getKey()+"]","The dynamic form did not be show in column container of flowlayout.",!0);
},adjustDynamicFormHeight:function(t,i){if(KDFlowlayoutProxy.isVertical(this.config)){var a=i.height,n=t.getControl();e.delayInvoke(function(){try{n.css({height:"auto","min-height":a})}finally{clearTimeout(th)}},1e3)}},removeDynamicForm:function(e){var t=this,e=formProxy.pageId;t.childForms||(t.childForms={});var i=t.childForms[e];if(i){var a=i.getControl();a&&a.remove(),i.doCloseWindow.call(i),delete t.childForms[e]}},setVisible:function(e){var t=this;t.visible!=e&&(t.visible=e,0==t.isChilderInited&&t.visible&&t.initchildren(),!t.config,t.visible||void 0===t.config.height?void 0!==t.config.metaHeight&&$.extend(t.config,{height:t.config.metaHeight,width:t.config.metaWidth}):$.extend(t.config,{height:0,width:0}),t.el&&t.el.setVisible?(t.el.setVisible(e),t.onAfterVisible.call(t,{visible:e})):t.el&&(e?t.el.show(function(){t.onAfterVisible.call(t,{visible:!0})}):t.el.hide("slow",function(){t.onAfterVisible.call(t,{visible:!1})})))},doLayout:function(){this.el&&this.el.doLayout&&this.el.doLayout.call(this.el,this.config);var t={};if(t=KDFlowlayoutProxy.isHorizontal(this.config)?{width:KDFlowlayoutProxy.getItemWidth(this.el,this.config),height:"auto","min-height":KDFlowlayoutProxy.getItemHeight(this.el,this.config)}:{width:KDFlowlayoutProxy.getItemWidth(this.el,this.config),height:KDFlowlayoutProxy.getItemHeight(this.el,this.config)},this.el.css(t),this.__recalcItemSize(this.config),this.children&&this.children.length)for(var i in this.children){var a=this.children[i],n=a.getControl(),o=a.config;if(!KDFlowlayoutProxy.isAbsPosChild(o)){var r={width:KDFlowlayoutProxy.getItemWidth(n,o),height:KDFlowlayoutProxy.getItemHeight(n,o)};r=this._handleChildSize(a,r),a.el.css(r),a&&a.doLayout&&a.doLayout.call(a);var s=a.getControl(),l={position:"relative","float":KDFlowlayoutProxy.isInVertical(this.config)?"":"left"};s.css(l)}}if(this.childForms)for(var i in this.childForms){var d=this.childForms[i];d&&(e.layout.setInnerDFormSize(this,d),d.doLayout.call(d))}else this.childForm&&(e.layout.setInnerDFormSize(this),this.childForm.doLayout.call(this.childForm))},_handleChildSize:function(e,t){return t}}),KDControlFactoryProxy.registerType("flowlayout",KDFlowlayoutProxy),KDControlFactoryProxy.registerType("kdflowlayoutpanel",KDFlowlayoutProxy),KDFlowlayoutProxy_Galaxy=e.extend(KDFlowlayoutProxy,{loadConfig:function(e){this.el.addClass("kg-flowlayout"),KDFlowlayoutProxy_Galaxy.superclass.loadConfig.call(this,e)},_handleChildSize:function(t,i){if(t&&!e.isEmpty(t.config.customHeight)&&(i.height=parseFloat(t.config.customHeight+"")),t&&"kditemcontainer"==t.config.xtype){var a=i.height+21+20;i.height=a}return i}}),KDControlFactoryProxy.registerType("flowlayout_Galaxy",KDFlowlayoutProxy_Galaxy),KDControlFactoryProxy.registerType("kdflowlayoutpanel_Galaxy",KDFlowlayoutProxy_Galaxy)}(KD),function(e){$.extend(KDFlowlayoutProxy.prototype,{replaceChildrenData:function(t){t&&t.items&&(e.isString(t.dock)&&(t.dock=parseInt(t.dock)),this.setData(t.items,!1))},setData:function(t,i){var a=this;a.oldData=a.data,a.data=t;var n=a.el.closest(".k-window-content");("FH5CARDSUBSYSTEMMENUFLOWLAYOUT"==a.config.id||"FH5CARDMAINSYSTEMMENUFLOWLAYOUT"==a.config.id)&&(n=n.children());var o=a.getFormProxy(),r=o.config;n.length>0&&(a.lastTop=n.scrollTop());var s=$.isArray(t)?{items:t}:{items:[t]};$.each(s.items,function(e){s.items[e].isDynamicCreated=!0}),this.children&&e.isArray(this.children)&&$.each(this.children,function(e,t){t.release.call(t)}),this.getContent().empty(),this.clearControls(this.oldData),this.clearControls(this.data),this.isChilderLoaded=!1,this.isChilderInited=!1;this.config.isInfo=0!=i;var l=this.config.isInfo?KDInfoDataFlowConverter(s,this.config):s;this.loadChildren(l),a.lastTop>0&&o.isPopUpFlowForm(r)&&n.scrollTop(a.lastTop)},setRightPanelData:function(t,i){var a=this;a.oldData=a.data,a.data=t;var n=a.el.closest(".k-window-content");("FH5CARDSUBSYSTEMMENUFLOWLAYOUT"==a.config.id||"FH5CARDMAINSYSTEMMENUFLOWLAYOUT"==a.config.id)&&(n=n.children());var o=a.getFormProxy(),r=o.config;n.length>0&&(a.lastTop=n.scrollTop());var s=$.isArray(t)?{items:t}:{items:[t]};$.each(s.items,function(e){s.items[e].isDynamicCreated=!0}),this.children&&e.isArray(this.children)&&$.each(this.children,function(e,t){t.release.call(t)}),this.getContent().empty(),this.clearControls(this.oldData),this.clearControls(this.data),this.isChilderLoaded=!1,this.isChilderInited=!1;this.config.isInfo=0!=i;var l=this.config.isInfo?KDInfoDataFlowConverterForMainMenuTree(s,this.config):s;this.loadChildren(l),a.lastTop>0&&o.isPopUpFlowForm(r)&&n.scrollTop(a.lastTop)},setHTML:function(e){this.setData({});var t=this.getContent();t&&t.setHTML(e)},setLinkPage:function(t){this.iFrameContentMode=!0;var i=this.getContent(),a=e.getValue(t,"url",""),n=e.getValue(t,"height",300);i.empty();var o=$('<iframe src="'+a+'" style="height:'+n+'px;width:100%;border:0px solid transparent;"></iframe>');o.appendTo(i)},setBackColor:function(e){if(this.BackColor!=e){this.BackColor=e;var t=this.getContent();t.css("background-color",e)}},setWidth:function(t){var i=this,a=parseInt(t);if(!e.isNaN(a)){var n=KDFlowlayoutProxy.isInColumn(i.config)&&KDFlowlayoutProxy.isFixedSize(i.config);(n||KDFlowlayoutProxy.isInHorizontal(i.config))&&(i.config.width=a,i.doParentLayout())}},setHeight:function(e){}})}(KD),function(e){$.extend(KDFlowlayoutProxy,{vertical:"vertical",horizontal:"horizontal",column:"collayout",horWrap:"horWrap",autoHeightControls:{label:!0,kdgrid:!0,kdacctorgstatistictable:!0,navibar:!0,kdcardnavibar:!0},isAbsPosChild:function(e){return e&&"kdwatermark"==e.xtype},isFlowlayout:function(e){return!!e.orientation},isFormOnlyChild:function(e){return e.isFormOnlyChild||!1},isFlowlayoutChild:function(e){return!!e.ctOrientation},isVertical:function(e){return e.orientation==KDFlowlayoutProxy.vertical},isInVertical:function(e){return e.ctOrientation==KDFlowlayoutProxy.vertical},isHorizontal:function(e){return e.orientation==KDFlowlayoutProxy.horizontal},isInHorizontal:function(e){return e.ctOrientation==KDFlowlayoutProxy.horizontal},isColumn:function(e){return e.orientation==KDFlowlayoutProxy.column},isInColumn:function(e){return e.ctOrientation==KDFlowlayoutProxy.column},isFixedSize:function(e){return e&&1==e.fixedSize},flowElement:function(e){return e.addClass("kd-flowlayout").css({height:"auto",overflow:"none"})},setFlowFormOverFlow:function(e,t){if(!e.ctOrientation&&t&&t.isFlowForm){var i=e.el.children(),a={"overflow-y":"auto","overflow-x":"auto"};e.getIsMain.call(e)&&$.extend(a,{overflow:"initial",height:"auto"}),KDFlowlayoutProxy.column==e.ctOrientation&&$.extend(a,{"overflow-x":"hidden"}),i.css(a)}},getItemWidth:function(t,i){var a=function(t,i){var a=t.parent(),n=e.layout.getChildSize(a,t);return n.targetOption?n.targetOption.width||i:i},n=KDFlowlayoutProxy.isInVertical(i),o=e.layout.existChildDock(i),r="kdform"==i.xtype,s=0;return s=n?o&&!r?a(t,t.parent().width()):a(t,"100%"):KDFlowlayoutProxy.isInColumn(i)&&i.inAllFlowlayoutChild?i.calcWidth:i.width},isAutoHeightControl:function(e){return KDFlowlayoutProxy.autoHeightControls[e.xtype]},getItemHeight:function(e,t){var i=KDFlowlayoutProxy.isInVertical(t)&&KDFlowlayoutProxy.isAutoHeightControl(t)||KDFlowlayoutProxy.isVertical(t)||KDFlowlayoutProxy.isInColumn(t)||KDFlowlayoutProxy.isColumn(t);return i?"auto":t.height},getHeight:function(e,t){return KDFlowlayoutProxy.isFlowlayout(t)?"auto":t.height},getCtOrientation:function(e){return e.ctOrientation},getMargin:function(e,t){return e&&e.margin?e.margin.replace(/\s{0,}\,\s{0,}/g,"px ")+"px":t},getFlowLayoutInlineStyleOptions:function(e){var t={};if(e.ctOrientation&&KDFlowlayoutProxy.isNeedInnerStyleForFlowLayout(e)){var i=KDFlowlayoutProxy.isNeedLineheight(e)?e.height+"px;":"";switch(e.ctOrientation){case KDFlowlayoutProxy.vertical:$.extend(t,{"line-height":i,height:"auto",width:"100%",margin:KDFlowlayoutProxy.getMargin(e,"0px"),"min-height":e.minHeight}),KDFlowlayoutProxy.isFlowlayout(e)||$.extend(t,{"min-height":e.height});break;case KDFlowlayoutProxy.column:$.extend(t,{"line-height":i,height:"auto",width:e.calcWidth,margin:KDFlowlayoutProxy.getMargin(e,"0px"),"vertical-align":"top",display:"inline-block","float":"left","min-height":"1px"});break;default:$.extend(t,{"line-height":i,height:KDFlowlayoutProxy.isFlowlayout(e)?"auto":e.height+"px",width:e.width+"px",margin:KDFlowlayoutProxy.getMargin(e,"0px"),"vertical-align":"middle",display:"inline-block","min-height":e.minHeight})}}return t},isNeedInnerStyleForFlowLayout:function(e){return"".indexOf(e.xtype)<=0},isNeedLineheight:function(e){return",kdlinkbutton,kdbutton,kdtogglebutton,togglebutton,".indexOf(e.xtype)>0}})}(KD),define("KDFlowlayoutProxy",["KDContainerProxy","KDInfoDataFlowConverter","KDInfoDataFlowConverterForMainMenuTree","KD"],function(e){return function(){var t;return t||e.KDFlowlayoutProxy}}(this)),function(e){KDMetaDataFlowConverter=function(e){this.init(e)},KDMetaDataFlowConverter.prototype={init:function(e){this.srcMetaData=e},getFlowMetaData:function(){var t=this;return!e.getConnectConfig().formFlowMode||t.srcMetaData.isFlowForm?t.srcMetaData:t.srcMetaData}}}(KD),define("KDMetaDataFlowConverter",["KDFlowlayoutProxy","KD"],function(e){return function(){var t;return t||e.KDMetaDataFlowConverter}}(this)),KDDynamicFormProxyBase_DataManager=function(){},KDDynamicFormProxyBase_DataManager=KD.extend(KDContainerProxy,{_isValidated:null,validDataList:[],initChangeData:function(){this.changedData=[],this.entrySelections={},this.changedData.push(this.entrySelections),this.messageController={},this.messageController[KD.CONST.MessageConcentratorGetProKey]=!1},getValidateMessage:function(){return this.validateMessage},getValidDataList:function(){return this.validDataList},setValidDataList:function(e){this.validDataList=e||[]},validating:function(e){this.commitFields();var t=!0,i=!0;for(var a in this.controlFactoryProxy.childForms){var n=this.controlFactoryProxy.childForms[a];if(i=n.validating(),!i){this.validateMessage=n.getValidateMessage(),this.validDataList=n.getValidDataList(),n.setValidDataList([]);break}}t=i?this.controlValidating():i;var o=this.getHostWindowProxy(),r=o&&o.el,s=r&&r.isVerifyDialogFormTip&&r.isVerifyDialogFormTip.call(r);if(!t&&e)if(s||this.isVerifyFormBannerTip())this.showErrMsgStr(this.validateMessage||ResManager.LoadKDString("数据校验不通过！","099002000000020"));else{var l=[],d={title:kendo.format(ResManager.LoadKDString("共有{0}处必录项未填","0991733030047798"),this.validDataList.length)};l.push(d),this.fireEventNoData.call(this,"ProcessBillValidateResult",this.validDataList,l)}else(!s||this.isVerifyFormBannerTip())&&this.fireEventNoData.call(this,"ProcessBillValidateResult",[],[]);return _isValidated=t,t},_hasCommitFiled:!1,commitFields:function(){if(!this._hasCommitFiled){for(var e in this.controlFactoryProxy.controls){var t=this.controlFactoryProxy.controls[e];t.commitField&&t.commitField()}this._hasCommitFiled=!1}},controlValidating:function(){var e=!0,t=new Array,i=[];for(var a in this.controlFactoryProxy.controls){var n=this.controlFactoryProxy.controls[a];if(n.validating&&!n.getDisabled()&&!n.forceCommit)if(n.validating.call(n))n.forceCommit&&n.forceCommit.call(n);else{e=!1;var o={},r=n.itemContainer&&n.itemContainer.config.tabIndex;o.tabindex=KD.isEmpty(r)?0:r,o.key=n.postKey,o.text=n.getValidateMessage.call(n),o.title=n.config.labelText,o.pKey=n.config.parentTabControlKey||null,o.pItemKey=n.config.parentTabItemKey||null,o.pItemTitle=n.config.parentTabItemTitle||null,o.errorMsg=kendo.format("{0}{1}",o.text,ResManager.LoadKDString("是必填项，不能为空！","099002000000020")),o.pageId=this.getPageId.call(this),o.rowIndex=-1;var s=this.getControlProxy.call(this,o.pItemKey),l="";s&&(l=KD.isEmpty(s.config.PageIndex)?"":s.config.PageIndex),o.tabItemIndex=l,t.push(o)}}if(t.length>0&&(t=KD.quickSort(t,"tabindex")),!e){for(var d=0;d<t.length;d++)i.length>0&&i.push("、"),i.push(t[d].text);this.validateMessage=ResManager.LoadKDString("以下必录项不能为空：","099002000000021")+i.join(""),this.validDataList=t}return e},commitDataBeforeGridRowChanged:function(e,t){if(this.isDataChanged()){var i=this.changedData?this.changedData:[];i.length>1&&(this.setBusy(!0),this.server.call("CustomEvents",e,"BeforeGridRowChanged","DataUpdate",i),this.initChangeData())}},commitData:function(e){this.beginBatchRequest();try{if(this.commitFields(),(!e||this.validating(!0))&&this.isDataChanged()){var t=this.getChangeData(!0);t.length>0&&(this.setBusy(!0),this.server.call("CommitData",t))}}catch(i){KD.writeError(i)}finally{this.endBatchRequest()}},isDataChanged:function(){var e=!1;return null!=this.changedData&&0!=this.changedData.length&&(e=1==this.changedData.length?!this.changedData[0]:!0),e},storeData:function(e,t,i,a){if(1!=this.isInit){a||(a=-1);for(var n=[],o=1;o<this.changedData.length;o++)if(this.changedData[o]&&this.changedData[o].Key){var r=this.changedData[o];if(r&&KD.equalsIgnoreCase(r.Key,e)&&r.Row==i){n.push(o);break}}for(var s=n.length-1;s>=0;s--){var l=n[s];this.changedData.splice(l,1)}var d=new Object;d.Key=e,d.Row=i,d.Value=t,-1!=a&&(d.ParentRow=a),this.changedData.push(d)}},batchStoreData:function(e){null==this.changedData&&this.initChangeData();for(var t=e[0],i=t&&t.Key,a=[],n=1;n<this.changedData.length;n++){var o=this.changedData[n],r=o&&o.Key;!KD.IsNullOrWhiteSpace(r)&&KD.equalsIgnoreCase(i,r)&&a.push(n)}for(var s=a.length-1;s>=0;s--){var l=a[s];this.changedData.splice(l,1)}if(null!=e)for(var d in e)KD.isRunInForIn(d,e)&&this.changedData.push(e[d])},getChangeData:function(e,t){this.commitFields();var i=this.server;for(var a in this.controlFactoryProxy.childForms)if(KD.isRunInForIn(a,this.controlFactoryProxy.childForms)){var n=this.controlFactoryProxy.childForms[a];if(n&&this.dformConfig.pageId!=n.dformConfig.pageId){var o=n.getChangeData.call(n,!0);if(o.length>1){for(var r=!1,s=0;s<o.length;s++){var l=o[s];l&&KD.isObject(l)&&l.hasOwnProperty(KD.CONST.MessageConcentratorGetProKey)||l&&KD.isObject(l)&&(r=!KD.isObjectEmpty(l))}r&&i.call.call(i,"CommitChildFormData",n.dformConfig.pageId,o)}}}var d=this.controlFactoryProxy.getGrids.call(this.controlFactoryProxy);for(var a in d)if(KD.isRunInForIn(a,d)){var c=d[a];try{var h=c.getSelection.call(c,"",t);void 0!=c.justUpdateValRowId&&c.justUpdateValRowId>-1&&h.rowIndex!=c.justUpdateValRowId&&(h.rowIndex=c.justUpdateValRowId),this.updateEntrySelection(h)}catch(u){KD.writeError(u),this.showErrMsgStr(u.message,u.stack)}}var p=this.changedData?this.addDefaultMessageControl(this.changedData):this.addDefaultMessageControl([]);if(e&&this.initChangeData(),1==p.length){var g=p[0];if(KD.isEmpty(g))return this.addDefaultMessageControl([])}return p},updateEntrySelection:function(e){if(e&&e.entryKey){var t=this.entrySelections[e.entryKey];null==t&&(t=new Object,this.entrySelections[e.entryKey]=t),t.fieldKey=KD.getValue(e,"colName",""),t.row=KD.getValue(e,"rowIndex",-1),t.selRows=KD.getValue(e,"selRows",""),t.isClientNewRow=KD.getValue(e,"isClientNewRow",!1),t.clientNewRows=KD.getValue(e,"clientNewRows","")}},addDefaultMessageControl:function(e){if(KD.isManagementSite())return e;if(e&&KD.isArray(e)){var t=e.length>1?e[0]:void 0;return t&&KD.isObject(t)&&t.hasOwnProperty(KD.CONST.MessageConcentratorGetProKey)?e:(this.messageController=new Object,this.messageController[KD.CONST.MessageConcentratorGetProKey]=!1,e.splice(0,0,this.messageController),e)}return e},getLayoutSetting:function(){var e=new Array;if(this.controlFactoryProxy&&this.controlFactoryProxy.controls)for(var t in this.controlFactoryProxy.controls){var i=this.controlFactoryProxy.controls[t];if(i&&i.getLayoutSetting){var a=i.getLayoutSetting();if(a&&!KD.isEmpty(a)){var t=i.getKey(),n=new Array;if(n.push(t),n.push(a),n.push(KD.CONST.ClientType),i&&i.getLayoutSettingIsbecommon){var o=i.getLayoutSettingIsbecommon.call(i);n.push(o)}e.push(n)}}}return e.length>0?JSON.stringify(e):null}}),define("KDDynamicFormProxyBase_DataManager",["KDContainerProxy","KDMetaDataFlowConverter","KD","KDFloatingManager"],function(e){return function(){var t;return t||e.KDDynamicFormProxyBase_DataManager}}(this)),KDImageProxy=KD.extend(KDControlProxy,{exDownLoadUrl:null,extandUrl:null,autoFitType:0,createControl:function(e){this.config=e,this.el=$('<div type="imgDiv"><img onerror="this.style.display=\'none\';"style="margin:0px auto; width:'+e.width+"px;height:"+e.height+'px"></img></div>');this.getCType();return this.el.attr("id",this.baseId),this.el.dock=this.config.dock,KD.setAttachmentData(this.el,e),this.componentImg=this.el.find("img"),this.el},loadConfig:function(e){if(KDImageProxy.superclass.loadConfig.call(this,e),this.componentImg=this.el.find("img"),this.exDownLoadUrl=KD.getValue(e,"exdownloadurl",""),this.extandUrl=KD.getValue(e,"extandurl",""),this.isAdaptive=KD.getValue(e,"isadaptive",!1),this.IsCanDownland=KD.getValue(e,"iscandownland",!0),KD.isEmpty(this.postKey)&&(this.postKey=KD.getValue(e,"id","")),KD.isEmpty(e.src)){var t=KD.getValue(e,"ImageKeyBasePath","")+"/"+KD.getValue(e,"ImageKey","").replace("img","")+".png";"/.png"==t&&(t=""),this.setSourceUrl(t)}else this.setSourceUrl(e.src)},setHeight:function(e){KDImageProxy.superclass.setHeight.call(this,e),this.componentImg&&this.Stretch!=KDImageProxy.Stretch.None&&this.componentImg.css("height",e+"px")},setStretch:function(e){switch(this.Stretch=e,e){case KDImageProxy.Stretch.None:this.componentImg.css({height:"auto",width:"auto",margin:"auto","float":"none"});break;case KDImageProxy.Stretch.Fill:this.componentImg.css({width:this.el.width(),height:this.el.height()});break;case KDImageProxy.Stretch.Uniform:break;case KDImageProxy.Stretch.UniformToFill:}},setSourceUrl:function(e){if(this.el){if(KD.isEmpty(e))return void this.componentImg.css({display:"none",visibility:"hidden"});if(this.config.src=e,this.componentImg.css({display:"block",visibility:"visible"}),KD.isUrl(e))this.componentImg.attr({src:e});else if(this.IsPicture(e))e.toUpperCase().indexOf("/CP/")>=0?this.componentImg.attr({src:e}):this.componentImg.attr({src:"../"+e});else if("./images/biz/default/Common/WaterMarks/"==e)this.componentImg.css("display","none");else if(KD.IsNullOrWhiteSpace(this.exDownLoadUrl))this.componentImg.attr({src:"data:image/jpeg;base64,"+e});else{var t=KD.getUrlRoot()+"/"+this.exDownLoadUrl+((this.exDownLoadUrl||"").indexOf("?")>0?"&":"?")+"fileId="+e+"&dbId="+ClientAppProxy.Current.CTX.DBid+"&token="+ClientAppProxy.Current.CTX.UserToken;this.componentImg.attr({src:t})}}},setValue:function(e){this.setSourceUrl(e)},pictureViewForm:function(e,t){function i(){var e=a.componentImg.attr("src");a._getImageWidth(e,function(e,t){var i,n,r,s;o&&(r=o.find("[type='imgDiv']").height()||o.height(),s=o.find("[type='imgDiv']").width()||o.width());var l=r-10,d=s-10;if(d&&e>=d)if(l&&t>=l){var c=d/e,h=c*t;l>h?(i="auto",n="100%",a.autoFitType=1):(i="100%",n="auto",a.autoFitType=2)}else i="auto",n="100%",a.autoFitType=1;else l&&t>=l?(i="100%",n="auto",a.autoFitType=2):(i="auto",n="auto",a.autoFitType=0);a.isAdaptive&&a.componentImg.css({height:i,width:n})})}var a=this,n=e.formProxy,o=e.find("#"+e.getBaseId()+"-"+t.targetkey.toUpperCase());if(o.find('div[type="pictureView"]').length>0){var r=o.find('div[type="pictureView"]');r.remove()}var s=$('<div type="pictureView" style="text-align: center;"></div>');o.append(s.append(a.getControl())),a.el.css({position:"absolute","float":"none","margin-top":"3px","margin-bottom":"3px",height:"calc(100% - 60px)",width:"100%",left:"0%",overflow:"auto"});var l=$('<input id="slider" style="width: 350px" />'),d=$('<div type="picToolbar" style="position:absolute;left:15%;bottom:0;padding-top:10px;width:70%;height:42px;background-color:silver"></div>');s.prepend(d.append(l));var c={},h=!0;if(a.componentImg.addClass("kd-pictureView-image"),a.componentImg.kendoKDDraggable({hint:function(e){var t=e.clone();return t.attr({id:t.attr("id")+"_drag"}).width(e.width()).height(e.height()),t},dragstart:function(e){e.currentTarget.css({opacity:0})},drag:function(e){},dragcancel:function(e){},dragend:function(e){a._checkIsOverContainer(e,!0)}}),0!=a.componentImg.height())c={height:a.componentImg.height(),width:a.componentImg.width(),currentzoomin:100,isautofit:a.isAdaptive};else{var u=a.componentImg.attr("src");a._getImageWidth(u,function(e,t){c={height:t,width:e,currentzoomin:100,isautofit:a.isAdaptive}})}var p=l.kendoSlider({precision:0,smallStep:20,largeStep:40,min:20,max:360,value:100,tooltip:{format:"{0:##}%"},change:function(e){if(0!=a.componentImg.height()){h&&(c={height:a.componentImg.height(),width:a.componentImg.width()},h=!1);var t=this.value(),i=t*c.height/100,n=t*c.width/100;c.currentzoomin=t,a.componentImg.css({height:i+"px",width:n+"px"}),a._checkIsOverContainer(e,!1)}}}).data("kendoSlider"),g=a.IsCanDownland?kendo.format('<span title="{0}" class="k-icon k-i-down kd-icon-toolview" style="background-image:url({1});"></span>',ResManager.LoadKDString("下载","014005030037576"),KD.getImageUrlByNameAndVersion("kd_icon_extend.png")):"",f=kendo.format('<span title="{0}" class="k-icon kd-icon-undo kd-icon-toolview"></span><span title="{1}" class="k-icon kd-icon-redo kd-icon-toolview"></span><span title="{2}" class="k-icon k-i-maximize kd-icon-toolview"></span><span title="{3}" class="kd-icon-autofit" ></span>{4}',ResManager.LoadKDString("逆时针旋转","0025710030033485"),ResManager.LoadKDString("顺时针旋转","0025710030033486"),ResManager.LoadKDString("全屏查看","0025710030033487"),ResManager.LoadKDString("自适应","0025710000007626"),g);d.append(f);var m=0;d.find(".kd-icon-undo").off("click").on("click",function(e){m-=90,a.componentImg.css({transform:"rotate("+m+"deg)"}).attr({transform:m}),a._checkIsOverContainer(e,!1)}),d.find(".kd-icon-redo").off("click").on("click",function(e){m+=90,a.componentImg.css({transform:"rotate("+m+"deg)"}).attr({transform:m}),a._checkIsOverContainer(e,!1)}),d.find(".k-i-maximize").off("click").on("click",function(e){var t=n.getHostWindowProxy().el.data("kendoWindow");console.log(t);var o=t.isMaximized();o?($(this).removeClass("k-i-restore").addClass("k-i-maximize").attr("title",ResManager.LoadKDString("全屏查看","0025710030033487")),t.restore()):(t.maximize(),$(this).removeClass("k-i-maximize").addClass("k-i-restore").attr("title",ResManager.LoadKDString("退出全屏","0025710030033488"))),KD.delayInvoke(function(){i();var e,t;if(c.isautofit){switch(a.autoFitType){case 0:t="auto",e="auto";break;case 1:t="auto",e="100%";break;case 2:t="100%",e="auto";break;default:t="auto",e="auto"}a.componentImg.css({height:t,width:e})}},1),a._checkIsOverContainer(e,!1)}),d.find(".k-i-down").off("click").on("click",function(e){if(!KD.isEmpty(n)){var t=a.config.src?a.config.src:"",i={};i.row=0,i.ServerFileName=t,n.fireCustomEventsNoData(a.postKey,"Kingdee.BOS.ImageDownload",KD.stringify(i))}});var v=d.find(".kd-icon-autofit");if(a.isAdaptive){var y;v.addClass("kd-icon-autofit-click"),y=!0,p.enable(!y),c.isautofit=y,c.currentzoomin=100,h=!1,a._checkIsOverContainer(null,!1),a._setImgCenterDisplay(o,!0)}else a._setImgCenterDisplay(o,!1);i(),v.off("click").on("click",function(e){i(),h&&(c={height:a.componentImg.height(),width:a.componentImg.width()},h=!1);var t,n,r;if(1==c.isautofit)if($(this).removeClass("kd-icon-autofit-click"),KD.isIeBrowser()){var s=a.componentImg.attr("src");a._getImageWidth(s,function(e,i){c={height:i,width:e,currentzoomin:100,isautofit:a.isAdaptive};var s=c.currentzoomin?c.currentzoomin:a.slideToolbar?a.slideToolbar.value():100;t=s*c.height/100+"px",n=s*c.width/100+"px",r=!1,a._setImgCenterDisplay(o,!1)})}else{var l=c.currentzoomin?c.currentzoomin:a.slideToolbar?a.slideToolbar.value():100;t=l*c.height/100+"px",n=l*c.width/100+"px",r=!1,a._setImgCenterDisplay(o,!1)}else{switch($(this).addClass("kd-icon-autofit-click"),a.autoFitType){case 0:t="auto",n="auto";break;case 1:t="auto",n="100%";break;case 2:t="100%",n="auto";break;default:t="auto",n="auto"}r=!0,a._setImgCenterDisplay(o,!0)}a.componentImg.css({height:t,width:n}),p.enable(!r),c.isautofit=r,a._checkIsOverContainer(e,!1)})},_getImageWidth:function(e,t){var i=new Image;i.src=e,i.complete?t(i.width,i.height):i.onload=function(){t(i.width,i.height)}},_setImgCenterDisplay:function(e,t){var i=e.find('div[type="imgDiv"]'),a=e.find("img");if(t)i&&i.css({display:"flex"}),a&&a.css({"align-self":"center"});else{var n=i.width(),o=i.height(),r=a.width(),s=a.height();n>r&&o>s?(i.css({display:"flex"}),a.css({"align-self":"center"})):i&&i.css({display:"inline-block"})}},_checkIsOverContainer:function(e,t){var i=this.componentImg;if(i){var a,n,o,r=$("#"+i.attr("id")+"_drag"),s=t||!1,l=50;i.length>0&&r.length>0?(a=i.parent().offset(),n={left:parseFloat(r.css("left")),top:parseFloat(r.css("top"))},o={position:"absolute",left:n.left-a.left,top:n.top-a.top}):1!=t&&(o={left:parseFloat(i.css("left")),top:parseFloat(i.css("top"))});var d=parseFloat(i.attr("transform"));d=KD.isNaN(d)?0:d;var c=d/180!=parseInt(d/180);if(c){var h={width:i.width(),height:i.height()},u=this._getTruePositionByRotatePosition(o,h,!0);u.left+i.height()<l&&(o.left=this._getRotatePositionByTruePosition(l-i.height(),h,!0),s=!0),u.left+l>i.parent().width()&&(o.left=this._getRotatePositionByTruePosition(i.parent().width()-l,h,!0),s=!0),u.top+i.width()<l&&(o.top=this._getRotatePositionByTruePosition(l-i.width(),h,!1),s=!0),u.top+l>i.parent().height()&&(o.top=this._getRotatePositionByTruePosition(i.parent().height()-l,h,!1),s=!0)}else o.left+i.width()<l&&(o.left=l-i.width(),s=!0),o.left+l>i.parent().width()&&(o.left=i.parent().width()-l,s=!0),o.top+i.height()<l&&(o.top=l-i.height(),s=!0),o.top+l>i.parent().height()&&(o.top=i.parent().height()-l,s=!0);r&&r.length>0&&r.hasClass("kd-pictureView-image")&&r.hide(),s&&i.css(o),i.css({opacity:1})}},_getTruePositionByRotatePosition:function(e,t){var i={},a={};return a.left=e.left+t.width/2,a.top=e.top+t.height/2,i.left=a.left-t.height/2,i.top=a.top-t.width/2,i},_getRotatePositionByTruePosition:function(e,t,i){var a,n={};return i?(n.left=e+t.height/2,a=n.left-t.width/2):(n.top=e+t.width/2,a=n.top-t.height/2),a},IsPicture:function(e){var t=".jpeg|.gif|.jpg|.png|.bmp|.pic|";if(e.indexOf(".")>-1){var i=e;e.indexOf("?")>0&&(i=e.substr(0,e.lastIndexOf("?")));var a=i.lastIndexOf("."),n=i.substring(a)+"|";if(n=n.toLowerCase(),t.indexOf(n)>-1)return!0}return!1}}),KDImageProxy.Stretch=KDImageProxy.Stretch||{},$.extend(KDImageProxy.Stretch,{Fill:0,None:1,Uniform:2,UniformToFill:3}),KDControlFactoryProxy.registerType("kdpicture",KDImageProxy),KDControlFactoryProxy.registerType("image",KDImageProxy),KDControlFactoryProxy.registerType("kdbarcode",KDImageProxy),KDWatermarkProxy=KD.extend(KDImageProxy,{createControl:function(e){return KDWatermarkProxy.superclass.createControl.call(this,e),this.el.css({"z-index":1}),this.componentImg.addClass("kd-ui-watermark"),this.el},loadConfig:function(e){KDWatermarkProxy.superclass.loadConfig.call(this,e),this.setSourceUrl(e.src)},setSourceUrl:function(e){KDWatermarkProxy.superclass.setSourceUrl.call(this,e),e&&(this.IsPicture(e)||KD.isBase64Str(e))?(this.el.show(),this.el.css({"z-index":3})):(this.el.hide(),this.el.css({"z-index":0}))}}),KDControlFactoryProxy.registerType("kdwatermark",KDWatermarkProxy),define("KDImageProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDImageProxy}}(this)),KDDynamicFormProxyBase_DoAction=function(){},KDDynamicFormProxyBase_DoAction=KD.extend(KDDynamicFormProxyBase_DataManager,{_lastfocusdChild:null,reset:function(e){for(var t in this.controlFactoryProxy.controls){var i=this.controlFactoryProxy.controls[t];i.setRestting&&i.setRestting(!0)}for(var t in this.controlFactoryProxy.controls){var i=this.controlFactoryProxy.controls[t];i.setRestting&&i.setRestting(!1)}},closeWindow:function(e){var t=this,i=function(e){e.doCloseWindow()};for(var a in e){var n=e[a],o=n.pageId,r=null;if(!this.dformConfig||this.dformConfig.pageId!=o&&this.dformConfig.flexpageId!=o){for(var a in this.controlFactoryProxy.forms){var s=this.controlFactoryProxy.forms[a];if(s.dformConfig&&s.dformConfig.pageId==o){r=s;break}}null!=r&&i(r)}else r=this,i(this);n.callbackid&&t.fireActionCallBack.call(t,n.callbackid,null)}},doLazyMsg:function(){if(this.lazyMsg){var e=this.lazyMsg;delete this.lazyMsg,delete this.lazyMsgKeyMap;for(var t=e.length,i=0;t>i;i++){var a=e[i];a&&this.doAction(a)}}},notShowMainFormHolder:function(e){KD.notShowMainFormHolder=KD.notShowMainFormHolder||{},void 0!=e?KD.notShowMainFormHolder[e]=!0:KD.notShowMainFormHolder[this.baseId]=!0,$(".kd-bill-flow-bottom-placeholder").hide()},doLazyCtrlMsg:function(e,t){if(e&&(!t||"doLazyCtrlMsg"!=t.methodName)){var i=e.getKey.call(e);if(i&&this.lazyMsgKeyMap&&this.lazyMsgKeyMap[i]){var a=this.lazyMsgKeyMap[i];delete this.lazyMsgKeyMap[i];for(var n=0;n<a.length;n++){var o=a[n].index,r=this.lazyMsg[o];this.lazyMsg[o]=void 0;var s=r.actionname,l=this[s];l||(s=s.substr(0,1).toLowerCase()+s.substr(1),l=this[s]),l&&l.call(this,r.params,{methodName:"doLazyCtrlMsg",serviceName:"",status:"success"})}}}},doCloseWindow:function(e){if(this.dformConfig&&this.dformConfig.keepInCache&&this.hostWindowProxy)this.hostWindowProxy.hideWindow.call(this.hostWindowProxy);else if(this.controlFactoryProxy){var t=this.controlFactoryProxy.forms&&this.controlFactoryProxy.forms.length>0,i=[];if(e||this.getSvrHasClosed()||this.getCloseFormArgs(i),t)for(var a in this.controlFactoryProxy.forms){var n=this.controlFactoryProxy.forms[a];n.dformConfig&&(n.dformConfig.keepInCache=!1),n.doCloseWindow&&n.doCloseWindow(!0),n.setSvrHasClosed.call(n)}this.closeServer(),e||this.getSvrHasClosed()||this.batchCloseServer(i);var o=this.getHostWindowProxy();if(o){var r=this.dformConfig?this.dformConfig.pageId:void 0;this.release(),o.closeWindow(!1,r)}else this.release()}if(this.closed){var s={dialogResult:this.dialogResult,returnValue:this.returnValue},l=this.getParentFormByCurrentForm(this);null!=l?this.closed.call(l,this,s):this.closed(this,s)}},getParentFormByCurrentForm:function(e){return e.dformConfig?ClientAppProxy.Current.getAliveForm(e.dformConfig.parentPageId):null},release:function(){this.controlFactoryProxy&&this.controlFactoryProxy.release.call(this.controlFactoryProxy),this.clearChildren(),KDFloatingManager.instance.release(this.getPageId()),null!=this.dformConfig&&ClientAppProxy.Current.removeAliveForm.call(ClientAppProxy.Current,this.getPageId()),this.el&&this.el.undelegate&&this.el.undelegate("input","keyup"),this.el&&this.el.remove&&this.el.remove()},setMainMenuServerLock:function(e){if(null!=e){var t=this.getControlProxy(this.billMenuKey);if(t){var i="true"==((KD.isArray(e)?e[0]:e)||"").toString().toLowerCase();t.setServerLock.call(t,i)}}},lockControl:function(e){if(e&&KD.writeLog("lockControl",e.getKey?e.getKey.call(e):"no getKey",!0),e&&e.requestLock){var t=e.getKey.call(e);e&&(void 0===this._lockCtrlKeys[t]&&(this._lockCtrlKeys[t]=e.viewLocked),e.setViewLocked.call(e,!0))}},unlockReqLocked:function(){this.__unlockReqLocked()},__unlockReqLocked:function(){var e=this;for(var t in e._lockCtrlKeys)e._lockCtrlKeys[t]=!1;KD.delayInvoke(function(){var t=e.getControlProxy(e.billMenuKey);t&&!t.serverLock&&t.setViewLocked.call(t,!1);var i="";for(var a in e._lockCtrlKeys){var n=t&&e.billMenuKey==a?t:e.getControlProxy(a);null==n||n.serverLock||(n.setViewLocked.call(n,e._lockCtrlKeys[a]),i+=","+a)}if(i.Length>0){var o=i.split(",");for(var r in o){var a=o[r];s||void 0===e._lockCtrlKeys[a]||delete e._lockCtrlKeys[a]}}},1)},unlockControlView:function(e){if(null!=e){var t=e;if(null!=t&&t.Count>0){var i=this.getControlProxy(this.billMenuKey);for(var a in t){var n=t[a];i&&this.billMenuKey==n&&i.setViewLocked.call(i,!1);var o=ctlMainMenu&&this.billMenuKey==n?ctlMainMenu:this.getControlProxy(n);null!=o&&this._lockCtrlKeys[n]&&(o.setViewLocked.call(o,this._lockCtrlKeys[n]),delete this._lockCtrlKeys[n])}}}},setGolbalFontNames:function(e){var t=e;KD.isArray(e)&&(t=e[0]),KD.isObject(t)&&(ClientAppProxy.Current.setGolbalFontNames(t),KD.applyGolbalFontName())},setChildFormHeightLimit:function(e){this.childFormHeightLimit=KD.isEmpty(e)?!1:e[e.length-1]||!1},setDialogResult:function(e){this.dialogResult=e[e.length-1]},setReturnData:function(e){
this.returnValue=e[e.length-1]},adjustHeight:function(e){var t=this.getBillControlsPanel();if(t){var i=this.el.height();this.el.css({height:e}),t.doLayout.call(t),this.el.css({height:i}),t.getControl().parent().css({overflow:"auto"})}},updateControlStates:function(e,t){for(var i in e)this.updateControlState(e[i],t)},showErrMsg:function(e){if(e){var t="";try{t=KD.isObject(e)?e:e[0]}catch(i){t={errorTiltle:"error message",errorInfo:e}}var a=t.errorTitle,n=t.errorInfo;if(t.invokeaction&&KD.isArray(t.invokeaction))return void this.doActions(t.invokeaction);(null==a||0==a.length)&&(a=n,n=""),this.showErrMsgStr(a,n,t)}},showErrMsgWindow:function(e){var t=KD.isObject(e)?e:e[0],i=t.errorTitle,a=t.errorInfo;this.showErrMsgStrWindow(i,a,t)},setFormTitle:function(e){var t=null;!KD.isObject(e)&&e.length>0&&(t=e[0]),this.dformConfig.billTitle=t,this.hostWindowProxy&&this.hostWindowProxy.setWindowTitle&&this.hostWindowProxy.setWindowTitle.call(this.hostWindowProxy,this.dformConfig.getBillTitle())},SetFormWH:function(e){var t={};!KD.isObject(e)&&e.length>0&&(t=e[0]);var i=KD.getValue(t,"width",0),a=KD.getValue(t,"height",0);this.hostWindowProxy&&this.hostWindowProxy.setWindowWH?(this.hostWindowProxy.setWindowWH.call(this.hostWindowProxy,i,a),a>0&&this.setHeight(a)):this.hostWindowProxy&&this.hostWindowProxy.doLayout&&this.hostWindowProxy.doLayout()},setWindowHide:function(){this.hostWindowProxy&&this.hostWindowProxy.hide&&this.hostWindowProxy.hide.call(this.hostWindowProxy,!1)},setViewInlineStyle:function(e){var t=e;KD.isArray(e)&&(t=e[0]),t&&t.clientMinHeight&&this.dformConfig.showType==KDDynamicFormShowType.NewTabPage&&(t["min-height"]=KD.clientMinHeight-56-30),this.el.closest(".k-content").css(t)},showConfirm:function(e){this.showNotificationMsg(e)},showWebURLExt:function(e){var t="",i="<a href='{0}' target='_blank'>showWebURL</a>";t=(KD.isArray(e)||KD.isObject(e))&&KD.isString(e[0])&&e[0].trim().length>0?(e[0]||"").trim():(e||"").trim(),t=KD.getEncodeUrl(t),i=KD.format(i,t);var a=$(i).get(0),n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),a.dispatchEvent(n),$(a).remove()},showWebURL:function(e){var t="",i=!0;KD.isArray(e)&&(KD.isString(e[0])&&(t=(e[0]||"").trim()),KD.isObject(e[0])&&(t=e[0].url||"",i=e[0].isencode)),KD.IsNullOrWhiteSpace(t)||(0!=i&&(t=KD.getEncodeUrl(t)),KD.isUrl(t)||(t=KD.getUrlRoot()+"/"+t),window.open(t,"_blank"))},setUnCommunitySolutionSearchMode:function(e){var t=e;KD.isArray(e)&&(t=e[0]),KD.CONST.UnCommunitySolutionSearchMode=KD.getValue(t,"unsearchmode",!1),KD.CONST.MesTipErrorUnStandVisible=KD.getValue(t,"unstandvisible",!0)},setErrorTipCommunitySolution:function(e){var t=e;KD.isArray(e)&&(t=e[0]);var i=KD.getValue(t,"hassolution",!1),a=KD.getValue(t,"url",""),n=KD.getValue(t,"firsttitle",""),o=KD.getValue(t,"hasmulti",!1),r=KD.getValue(t,"multiurl",""),s={};s.hassolution=i,s.url=a,s.urltitle=n,s.hasmulti=o,s.multiurl=r;var l=this.getControlProxy(this.floatErrMsgId);l&&l.el||(l=this.getControlProxy(this.floatTipMsgId)),l&&l.setCommunitySolutionCaption&&l.setCommunitySolutionCaption.call(l,s)},showWarnningMsg:function(e){var t=e[0]||e;t&&(t.msgType=KDMessageBox.KDMesBoxType.Warning,this.showNotificationMsg(t))},verifyBestExperienceBrowser:function(e){var t=e[0]||e||{};if(KD.isIeBrowser()){var i={};if(i.option=0,i.msgType=KDMessageBox.KDMesBoxType.Question,i.title="",i.msg=ResManager.LoadKDString("为了获得更好的体验，建议您使用谷歌浏览器。","0991733000004482"),t.chromeDownLoadUrl){var a={},n=[];a.key="KDDownLoadChromeBrowserAddress",a.caption=ResManager.LoadKDString("下载谷歌浏览器","0991733000004483"),a.linkopen=t.chromeDownLoadUrl,n.push(KD.stringify(a)),i.msgcontrol=n}var o=KD.generateUserHashID()+"_verifyBestExperienceBrowserState",r="true"==KD.storage.getItem(o)?!1:!0;r&&(this.showConfirm(i),KD.storage.setItem(o,"true"))}},showTopMessage:function(e){e=e[0]||e;var t=e.type;t||(t=1);var i=1==t?"Warning":"Error",a=this,n=$("<div class='kd_topMessage kd_"+i+"_topMessage'></div>");$(".cloudHeader").append(n);var o=(e.message,$("<div class='kd_MessageTip kd_"+i+"_MessageTip'></div>"));n.append(o);var r=$("<div class='kd_topMessageContent kd_"+i+"_topMessageContent'><span class='kd_topMessageSpan'></span></div>");n.append(r);var s=$("<div class='kd_messageAction kd_"+i+"_messageAction'><span class='kd_messageActionSpan'></span></div>");n.append(s);var l=e.message;l&&!KD.isEmpty(l.text)&&$(".kd_topMessageSpan",n).text(l.text);var d=e.action;d&&!KD.isEmpty(d.text)&&$(".kd_messageActionSpan",n).text(d.text),d&&d.serverClick&&$(".kd_messageActionSpan",n).click(function(e){a.fireEventNoData("CustomEvents","Kingdee.BOS.doAction.topMessageActionKey","Kingdee.BOS.doAction.TopMessageClick",null,[])});var c=$("<div class='kd_MessageClose kd_"+i+"_MessageClose'></div>");n.append(c),$(".kd_MessageClose",n).click(function(e){n.remove()})},showNotificationMsg:function(e){var t=this,i=e[0]||e;if(i){var a=i.title,n=KD.convertToHtmlString(this.dealWithUrl(i.msg)),o=i.id,r=i.option?i.option:0,s=i.msgType?i.msgType:0,l=i.msgcontrol,d=null==a||0==a.length;KD.delayInvoke(function(){t.showMessage.call(t,d?n:a,d?"":n,o,r,s,l,i)},300)}},showSimpleMessage:function(e){this.showNotificationMsg(e)},dealWithUrl:function(e){var t=e;if(e&&e.indexOf&&e.indexOf("http")>=0){t="";for(var i=e.split("\r\n"),a=0;a<i.length;a++){var n=i[a];t=n.indexOf("http")>=0?t+KD.getEncodeUrl(n)+"\r\n":t+n+"\r\n"}t.lastIndexOf("\r\n")==t.length-2&&(t=t.substring(0,t.length-2))}return t},showBizTips:function(e){var t=KD.isArray(e)?e[0]:e,i=this.dformConfig.getLocalValue(t.Message);t.IsShowDetail?this.dformConfig.getLocalValue(t.Description):"";switch(i||(i="[No Message]"),t.MsgType){case KDMessageBox.KDMesBoxType.Error:var a=KD.bizTipsUtils.ToError(t);this.showErrMsg(a);break;default:var a=KD.bizTipsUtils.ToMessage(t);this.showNotificationMsg(a)}},showMessageByInnerForm:function(e,t,i,a,n,o,r,s){var l=ClientAppProxy.Current.getAliveForm(e);l&&l.showMessage.call(l,t,i,a,n,o,r,s)},showMessage:function(e,t,i,a,n,o,r){e&&e.replace&&(e=KD.convertToHtmlString(e,!1)),t&&t.replace&&(t=KD.convertToHtmlString(t,!1));var s=KD.isEmpty(this.billMenuKey)?"":this.billMenuKey.toUpperCase(),l={id:this.floatTipMsgId,xtype:"kdPopupMessage",BizTipsMasterId:(r||{}).MasterId,BizTipsNumber:(r||{}).BizTipsNumber,otherset:(r||{}).otherset,layout:"kdlayout",lineWrap:!1,ImageShowStyle:0,backgroundimage:"",border:!1,dock:0,height:90,hscroll:0,style:0,tabIndex:1001,vscroll:0,width:240,x:0,y:157,zindex:10012,defaultElemId:this.baseId+"-"+s,CommunitySolutionCode:(r||{}).CommunitySolutionCode||"",message:e,detail:t,opts:a,mesType:n,mesId:i,msgcontrol:o},d=this.createInnerControl(l);d.visible||d.show()},afterMessageHandler:function(e,t){this.setBusy(!0),this.server.call("AfterConfirm",e,t)},aftInvokeControlMethod:function(e,t){this.invokeControlMethod(e,t)},invokeControlMethod:function(e,t){var i=this,a=[];for(var n in e){var o=KD.getValue(e[n],"callbackid",""),r=i.innerInvokeMethod(e[n],t);o&&a.push({key:o,value:r})}KD.delayInvoke(function(){for(var e in a){var t=a[e];t.value&&i.fireEventNoData.call(i,"AfterActionCallback",t.key,t.value)}})},showSilverlightForm:function(e){for(var t in e){var i=new DFormConfig;i.loadConfig(e[t]),i.xtype="kdform";var a=ClientAppProxy.Current.getMainTab();if(!a)return void KDMessageBox.show({type:KDMessageBox.KDMesBoxType.Ok,msg:ResManager.LoadKDString("主控页签控件不存在！","0991733000003987")});var n=a.add&&a.add({id:i.pageId,isSilverlightForm:!0,title:i.caption,active:!0,afterReady:function(){}});if(!n)return void KD.Error.raise({sourceClass:"KDDynamicFormProxy_DoAction",sourceMethod:"showDynamicForm",msg:"The NewTabPage is null."});i.height="100%",i.width="100%",i.dock=KD.dock.Fill;var o=new KDSilverlightFormProxy;o.setHostWindowProxy.call(sfrmproxy,n);var r=o.createControl(i);n.getControl().append(r),o.formdata=e[t],o.loadConfig(i)}},showChangeTheme:function(){KDChangeTheme.showTheme(this)},lockedSystems:function(){KDLockedSystem.show()},ShowUserparamSetting:function(){KDUserparamSetting.show()},showChangeFontSize:function(){KDChangeFontSize.show(this)},showPictureViewForm:function(e){if(null!=e&&0!=e.length){var t=e[0],i=new KDImageProxy,a={};a.extandurl=KD.getValue(t,"extandurl",""),a.exdownloadurl=KD.getValue(t,"exdownloadurl",""),a.isadaptive=KD.getValue(t,"isadaptive",!1),a.iscandownland=KD.getValue(t,"iscandownland",!0);var n=KD.getValue(t,"eventkey","");KD.IsNullOrWhiteSpace(n)||(a.id=n),i.createControl(a),i.loadConfig(a),i.setValue(KD.getValue(t,"value","")),this.el.formProxy=this,i.pictureViewForm(this.el,KD.getValue(t,"otherobj",""))}},doCheckFCerts:function(e){var t="";if(!KD.isEmpty(e)){var i=e[0],a={};if(a.RawSignData="",a.SignedData="",KD.isEmpty(i))t="param is invalid";else{try{initCAActiveXObj()}catch(n){}var o=getCerts();if(void 0==o||null==o)t="未找到CA插件，请安装CA插件。插件安装完成后，请重启浏览器。";else{var r=o,s="";r.length>0&&(s=r[0].CommonName);for(var l=[],d=0;d<r.length;d++)r[d].CommonName==ClientAppProxy.Current.CTX.UserName&&l.push(r[d]);if(r=l,r.length<=0)t=KD.isEmpty(s)?"签名时发生错误，错误描述：未找到CA证书用户":kendo.format("当前CA证书的用户为：{0}，与当前登录用户名称：{1} 不一致，请联系管理员！",s,ClientAppProxy.Current.CTX.UserName);else{var c=i.RawSignData,h=getSignLogonData(r[0].SerialNumber,c),u=h;u.Success?(a.RawSignData=c,a.SignedData=u.SignedData):t=kendo.format("签名时发生错误，错误号：{0}，错误描述：{1}",u.HexCode,u.Message)}}}a.errormsg=t,this.fireCustomEventsNoData("IdentityAuthentication","IdentityAuthentication",JSON.stringify(a))}},showDynamicForm:function(e,t){var i=this,a=i.loadFormPlugins(e);a||(MindFusion.Diagramming.Diagram.prototype.clearTooltip(),i.showDynamicFormCore(e,t))},showClientDynamicForm:function(e){if(KD.isArray(e))for(var t in e){var i=e[t]||{},a=new ShowFormParameter;if(a.LoadConfig(i),a.FormId){var n=new FormManager;n.ShowClientDynamicForm.call(n,a)}}},__initShowDynFormForDebug:function(e){},_adjustDynamicFormConfig:function(e){if(KD.isSingleMode())try{if(e=e||{},e.openstyle=e.openstyle||{},KD.isMainConsoleFormIdForSingleMode(e.formid))switch(e.openstyle.ShowType){case KDDynamicFormShowType.InContainer:var t=this.getControlFactoryProxy(),i=e.openstyle.TagetKey,a=t.getCmp.call(t,i);if(a&&a.isFlowLayout&&a.isFlowLayout.call(a)){var n=KD.getWindowHeight();e.height=n-KD.getBillHeadHeight()-KD.getMainConsoleBillFootHeight()}}}catch(o){}return e},showDynamicFormCore:function(e,t){for(var i in e){var a=e[i]||{};a.childFormHeightLimit=this.childFormHeightLimit;var n=KD.entryrolePlugins.getPlugin(KD.getEntryRole());n&&$.isFunction(n.showDynamicForm)&&(a=n.showDynamicForm.call(n,a));var o=new DFormConfig;o.loadConfig(a),o.isInPopWindow=DFormConfig.isInPopWindow(this,o),null==o.billTitle&&(o.billTitle=""),this.__initShowDynFormForDebug(o),o.isUseSmallScreenModel=KD.isUseSmallScreenModel(o);var r=null,s=this.getControlFactoryProxy();switch(o.openstyle.ShowType){case KDDynamicFormShowType.Modal:case KDDynamicFormShowType.Default:case KDDynamicFormShowType.NonModal:case KDDynamicFormShowType.Floating:case KDDynamicFormShowType.ModalInCurrentForm:o.dock=KD.dock.Fill,r=o.keepInCache?s.getFromCache.call(s,o.cacheId):s.getForm.call(s,o.pageId),null==r&&(r=ClientAppProxy.Current.getAliveForm.call(ClientAppProxy.Current,o.pageId)),null==r&&(r=s.createForm.call(s,o)),this.attachClosed(r),this.showDynamicFormNormal(r,o),r.SetActiveVerifyBannerTips(!0);break;case KDDynamicFormShowType.FloatingAutoHide:o.dock=KD.dock.Fill,r=o.keepInCache?s.getFromCache.call(s,o.cacheId):s.getForm.call(s,o.pageId),null==r&&(r=ClientAppProxy.Current.getAliveForm.call(ClientAppProxy.Current,o.pageId)),null==r&&(r=s.createForm.call(s,o)),this.attachClosed(r);var l=this.controlFactoryProxy.getCmp(o.TagetKey||o.tagetKey);if(!l){var d=this.getControlProxy(this.mainMenuKey);if(d)if(o.FloatingPlacement==KD.CONST.FloatingPlacementType.MainMenuBottomRightToLeft)l=d,o.FloatingPlacement=KD.CONST.FloatingPlacementType.BottomRightToLeft,o.tagetKey=this.mainMenuKey;else{var c=d.getBarItemById.call(d,o.TagetKey||o.tagetKey,!0);KD.isEmpty(c)||(l=d)}}l?this.showDynamicFormTarget(r,o,l):this.showDynamicFormNormal(r,o);break;case KDDynamicFormShowType.NewWindow:var l=(o.openstyle?o.openstyle.TagetKey:o.getBillTitle()).toLowerCase(),h="height="+o.height+", width="+o.width+",top="+o.vOffset+", left="+o.hOffset+", toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no",u=KD.isDebug()&&"_blank"==l,p={target:u?"_self":l,FormId:o.formid,PageId:o.pageId,EntryRole:KD.getEntryRole(),FormType:o.FormType||o.formType||"",UserToken:KD.getUserToken(),PkId:o.PkId||o.pkId||"",features:h};KD.openUrl(p);break;case KDDynamicFormShowType.NewTabPage:var g=s.getCmp.call(s,o.openstyle.TagetKey);if(!g&&(g=ClientAppProxy.Current.getMainTab().getControlFactoryProxy().getCmp(o.openstyle.TagetKey),!g)){KD["debugger"]("Not exists container that key is "+w+", <br>the message been raised by DoAction of DynamicFormProxyBase.",!g);break}if(!KDContainerProxy.isFormContainerReady(g)){g.pushLazyAction("showDynamicForm",[a]),KD["debugger"](o.openstyle.TagetKey+" tabProxy not Ready,show form will pushLazyAction",!0);break}var f=g.getControl.call(g);if(g.IsEnableLimit&&g.children&&g.children.length>=g.MaxTabItemsCount+2){var m=o.openstyle&&o.openstyle.FromPageId,v=KD.IsNullOrWhiteSpace(m)?null:ClientAppProxy.Current.getAliveForm(m);if(null!=v){var y={};y.limitcount=g.MaxTabItemsCount,v.fireCustomEventsNoData.call(v,"Kingdee.BOS.LimitTabPage","Kingdee.BOS.LimitTabPage",KD.stringify(y))}KD.Error.raise({msg:KD.format(ResManager.LoadKDString("不能打开当前功能页签。原因：超出了参数控制打开页签数的上限{0}个。建议：关闭不需要的页签或联系管理员取消控制参数（参数设置->基础管理->BOS平台）。","014002000008977"),g.MaxTabItemsCount)});break}var b=g.add&&g.add({id:o.pageId,FormTheme:o.FormTheme,title:o.billTitle,active:!0,hiddenclosebutton:o.hiddenclosebutton,ctOrientation:g.config.ctOrientation,afterReady:function(){}});if(!b)return void KD.Error.raise({sourceClass:"KDDynamicFormProxy_DoAction",sourceMethod:"showDynamicForm",msg:"The NewTabPage is null."});var D=KD.clientDetaHeight;o.isUseSmallScreenModel&&(D=0>D?0:D);var k=o.height=o.height+D,C=KD.layout.getActualWidth(f);if(o.height="inherit",o.width=C,o.dock=KD.dock.Fill,KD.layout.setCtOrientation(o,g.config.ctOrientation),null==o.openstyle.InlineStyleCss||!o.openstyle.InlineStyleCss){var x=9;KD.isIeBrowser()&&(x=10),o.openstyle.InlineStyleCss={MarginLeft:x+10,MarginRight:x},o.width=C-2*x-22,o.isUseSmallScreenModel&&(x=24,o.width=C-2*x,o.openstyle.InlineStyleCss={MarginLeft:x,MarginRight:x})}o.originalParentPageId=o.parentPageId,o.parentPageId=this.getPageId(),r=s.createForm.call(s,o,b),r.setHostWindowProxy.call(r,b),r.isTabChildForm=!0,r.metaHeight=k,r.metaWidth=o.width,r.apply(o),this.attachClosed(r);break;case KDDynamicFormShowType.InContainer:var w=o.openstyle.TagetKey,K=s.getCmp.call(s,w);if(KDMainTabControlProxy.isExtKey(w)){o.openstyle.ShowType=KDDynamicFormShowType.FloatingAutoHide,this.showDynamicForm(e);break}if(!K){if(!w){o.openstyle.ShowType=KDDynamicFormShowType.FloatingAutoHide,this.showDynamicForm(e);break}this.pushLazyMsg("showDynamicForm",[a]),KD.writeLog("Not exists container that key is "+w+", <br>the message been raised by DoAction of DynamicFormProxyBase.",!g,!0);break}if(!KDContainerProxy.isFormContainerReady(K)){K.pushLazyAction("showDynamicForm",[a]);break}if(K.isFlowLayout&&K.isFlowLayout.call(K)){o=this._adjustDynamicFormConfig(o),r=s.createForm.call(s,o,K);var S=K.getOrientation.call(K);if(KD.layout.setCtOrientation(r,S),KDFlowlayoutProxy.isVertical(K.config)){var I=KD.layout.getActualWidth(K.getControl.call(K));if(n&&$.isFunction(n.getMarginSize)){var x=n.getMarginSize.call(n,a);I=I-x.left-x.right}o.width=I}o.minHeight=o.height,o&&o.maxHeight&&(o.maxHeight=o.maxHeight),delete o.height}else o.height="inherit",o.width="100%",o.dock=KD.dock.Fill,r=s.createForm.call(s,o,K);r.setHostWindowProxy.call(r,K),r.apply.call(r,o),this.attachClosed(r);break;case KDDynamicFormShowType.InCurrentForm:if(K=this.getHostWindowProxy(),K.isFlowLayout&&K.isFlowLayout.call(K)){var S=K.getOrientation.call(K);if(KD.layout.setCtOrientation(r,S),KDFlowlayoutProxy.isVertical(K.config)){var I=KD.layout.getActualWidth(K.getControl.call(K));if(n&&$.isFunction(n.getMarginSize)){var x=n.getMarginSize.call(n,a);I=I-x.left-x.right}o.width=I}o.minHeight=o.height,o&&o.maxHeight&&(o.maxHeight=o.maxHeight)}else o.height="inherit",o.width="100%",o.dock=KD.dock.Fill;this.apply(o),this.attachClosed(r)}}},sendBroadcast:function(e){try{$.isArray(e)?config=e[0]:config=e;var t=new KDBroadcastBoxProxy;t.ShowBroadcastBox($("body"),config)}catch(i){}},ShowKDWebbrowseForm:function(e){if(null!=e){var t=e[0];if(null!=t){var i=t.source||"";if(!KD.IsNullOrWhiteSpace(i)){$this=this,KD.isUrl(i)||(i=window.location.href.substr(0,window.location.href.indexOf("/html5"))+i);var a=t.data||[];t.isweb||!1;if(!KD.IsNullOrWhiteSpace(i))var n=window.open(i,"widow"+kendo.guid(),"fullscreen=no,channelmode=no,toolbar=no,alwaysRaised=yes,location=no,status=no,scrollbars=yes,resizable=yes,width="+(t.width||682)+",height="+(t.height||605)+",top=80,left=200"),o=KD.setInterval(function(){(!n||n.closed)&&(clearInterval(o),$this.fireCustomEventsNoData.call($this,$this.dformConfig.pageId,"KDWebbrowseFormClosed",KD.stringify(a)))},500)}}}},OpenClientLocalResource:function(e){if(!KD.isEmpty(e)){var t=KD.isArray(e)?e[0]:e;if(!KD.isEmpty(t)){var i=KD.getValue(t,"action",""),a=KD.getValue(t,"filepath",""),n=KD.getValue(t,"fileid",""),o=KD.getValue(t,"targetfilename",""),r=KD.getValue(t,"targetfoldername",""),s=KD.getValue(t,"targetapp",""),l=KD.getValue(t,"pageid","");switch(i){case"OpenRes":case"OpenResNoCache":KD.CallWinService(i,a,n,o,r,s,l)}}}},attachClosed:function(e){null!=e&&($this=this,e.closed=$this.childFormProxy_Closed)},detachClosed:function(e){null!=e&&(e.closed=null)},childFormProxy_Closed:function(e,t){e.Closed=null,e.dformConfig&&!e.dformConfig.keepInCache&&(this.controlFactoryProxy.removeForm(e),null!=e.dformConfig.closedActionId&&this.server.call("FormClosedCallBack",e.dformConfig.closedActionId,!1))},sendAynDynamicFormAction:function(e){this.beginBatchRequest();try{for(var t in e)this.applyAynDynamicFormAction(e[t])}catch(i){KD.writeError(i)}finally{this.endBatchRequest()}},applyAynDynamicFormAction:function(e){var t=ClientAppProxy.Current.getAliveForm.call(ClientAppProxy.Current,e);null!=t&&t.getServiceFormSate.call(t)},sendDynamicFormAction:function(e){for(var t in e)this.innerSendDynamicFormAction(e[t])},innerSendDynamicFormAction:function(e){var t=this,i=e.pageId;if(i){var a=e.actions;if(a){var n=ClientAppProxy.Current.getAliveForm.call(ClientAppProxy.Current,i);void 0===n&&(n=t,KD.writeLog("sendDynamicFormAction()",KD.format("pageid [{0}] not found!",i),!0));var o=t.separateCloseFormActions(a);n&&n.doActions.call(n,o.acts),n&&n.asyncDoCloseFormActions.call(n,o.closeFormActs)}}},updateControlState:function(e,t){var i=e.key;if(null!=i){try{var a=this.getControlProxy(i),n="updateState",o=a?a[n]:void 0,r="";if(void 0===a)return r="From KDDynamicForm Control["+i+"] not found!",void KD.writeLog(r,KD.stringify(e),!0);if(!a.rendered)return this.pushLazyMsg("UpdateControlStates",[e]),void(void 0!==e.visible&&KDFieldSetContainerProxy.checkStateBeforeRendered(a,e,this,t));if(void 0===o)return r="From KDDynamicForm Control["+i+"].["+n+"] not found!",void KD.writeLog(r,KD.stringify(e),!0);this.doLazyCtrlMsg(a,t),o.call(a,e)}catch(s){KD.writeError(s,KD.stringify(e),!0),this.showErrMsgStr("KDDynamicFormProxyBase_DoAction.updateControlState(), state:"+JSON.stringify(e),s.message+"\r\n"+s.description,!0)}if(this.getIsMain()&&!ClientAppProxy.Current.timeoutHandler)try{ClientAppProxy.Current.startHearbeat.call(ClientAppProxy.Current)}catch(s){KD.writeError(s,KD.stringify(e),!0)}}},updateControlFlexStates:function(e){if(null!=e){var t=new Object;t.actionname="UpdateControlStates";for(var i in e){var a=e[i];if(null!=a.flextargetpageid&&a.flextargetpageid.length>0){var n=ClientAppProxy.Current.getAliveForm(a.flextargetpageid);if(null!=n){delete a.flextargetpageid;var o=[];t.params=o,o.push(a),n.doAction.call(n,t)}}}}},innerInvokeMethod:function(e,t){var i=!0,a=e.key;if(null==a)return i;var n=this.getControlProxy(a);if(null==n)return i;if(!n.rendered)return this.pushLazyMsg("InvokeControlMethod",[e]),i=!1;var o,r=e.args,s=e.methodname;try{this.doLazyCtrlMsg(n,t),o=n.invokeMethod.call(n,s,r),void 0==o||null==o||(i=o)}catch(l){KD.writeError(l),i=!1}return i},isNoBusyActions:function(e){var t=this,i=e&&(e.length||0)>0,a=!i;if(!a)for(var n=function(e,t){return e>t?t:e},o=n(t.noBusyActionNames.limit,e.length),r=0;o>r;r++){var s=e[r];if("InvokeControlMethod"==s.actionname){for(var l=s.params||[],d=n(t.noBusyMethodNames.limit,l.length),c=0;d>c;c++){var h=l[c];if(h&&t.noBusyMethodNames[h.methodname]){a=!0;break}}if(1==a)break}if(s&&t.noBusyActionNames[s.actionname]){a=!0;break}}return a},doActions:function(e,t){var i=this,a=300,n=e&&(e.length||0)>0;try{var o=i.isNoBusyActions(e)||i.isNoNeedSetBusy(t);if(!n)return;if(o||KD.delayInvoke(function(){i.setBusy(!0)},a),n){i.isInit=!0,i.onBeforeDoActions(e,t);var r=i.separateCloseFormActions(e);for(var s in r.acts)i.doAction(r.acts[s],t);i.doCloseFormActions(r.closeFormActs,t),r.showConfirmActs.length>0&&KD.delayInvoke(function(){i.doCloseFormActions(r.showConfirmActs,t)},500)}}catch(l){var d=l.message,c=l.description+"<p>"+l.stack;KD.writeError(l),i.showErrMsgStr(d,c)}finally{n&&(i.onAfterDoActions(e,t),i.isInit=!1),o||KD.delayInvoke(function(){i.setBusy.call(i,!1,function(){i.__unlockReqLocked.call(i)})},a)}},separateCloseFormActions:function(e){var t={acts:[],closeFormActs:[],showConfirmActs:[]};for(var i in e){var a=parseInt(i),n=a+1;n+="",e[i].actionname&&e[i].actionname.toUpperCase().trim()=="closeWindow".toUpperCase().trim()?t.closeFormActs.push(e[i]):e[i].actionname&&e[n]&&e[n].actionname&&e[i].actionname.toUpperCase().trim()=="showConfirm".toUpperCase().trim()&&e[n].actionname.toUpperCase().trim()=="showDynamicForm".toUpperCase().trim()&&e[n].params&&e[n].params[0]&&e[n].params[0].openstyle&&e[n].params[0].openstyle.ShowType==KDDynamicFormShowType.InCurrentForm?t.showConfirmActs.push(e[i]):t.acts.push(e[i])}return t},doCloseFormActions:function(e,t){var i=this;for(var a in e)i.doAction(e[a],t)},asyncDoCloseFormActions:function(e,t){var i=this;KD.delayInvoke(function(){i.doCloseFormActions.call(i,e,t)})},invokeAction:function(e){var t=KD.isArray(e)?e:[e];this.doActions(t)},doAction:function(e,t){var i="";try{if(i=e.actionname,null==i)return;var a=e.params,n=this[i];null==n&&(i=i.substring(0,1).toLowerCase()+i.substring(1),n=this[i]),null!=n&&n.call(this,a,t)}catch(o){KD.writeError(o),this.showErrMsgStr("KDDynamicFormProxyBase_DoAction.doAction::actionName:"+i,o.message+"<p>"+o.description)}},showErrMsgStrWindow:function(e,t,i){this.showErrMsgStr(e,t,i)},showErrMsgStr:function(e,t,i){e&&e.replace&&(e=KD.convertToHtmlString(e,!1)),t&&t.replace&&(t=KD.convertToHtmlString(t,!1));var a={id:this.floatErrMsgId,xtype:"kdErrPopupMessage",BizTipsMasterId:(i||{}).MasterId,BizTipsNumber:(i||{}).BizTipsNumber,CommunitySolutionCode:(i||{}).CommunitySolutionCode,layout:"kdlayout",lineWrap:!1,ImageShowStyle:0,backgroundimage:"",border:!1,dock:0,height:90,hscroll:0,style:0,tabIndex:1001,vscroll:0,width:240,x:0,y:157,zindex:10012,defaultElemId:this.baseId+"-"+this.billMenuKey.toUpperCase(),message:e,detail:t,opts:null,mesType:KDMessageBox.KDMesBoxType.Error,mesId:null,msgcontrol:i?i.msgcontrol:void 0};try{var n=this.createInnerControl(a);if(this.hadActiveElement())if(n&&KD.isFunction(n.show))n.show.call(n);else{var o=e+":"+t;o!=KD.lastUnhandleException&&(KD.lastUnhandleException=o,alert(o),KD.checkGolbalOperation(!0))}else{var o=e+":"+t;alert(o)}}catch(r){KD.writeError(r);var o=e+":"+t;o!=KD.lastUnhandleException&&(KD.lastUnhandleException=o,alert(o),KD.checkGolbalOperation(!0))}},hadActiveElement:function(){return"ie"==KD.getCurrentBrowsType().type?!0:document.activeElement?!0:!1},setMainMenuVisible:function(e){var t=e;KD.isArray(e)&&(t=e[0]),this.mainMenu&&this.mainMenu.setVisible&&this.mainMenu.setVisible(t)},updateMainMenuPanelHeight:function(e,t){var i=this,a=i.getControlProxy(i.billMenuKey);if("kdflowlayoutpanel"!=a.xtype||KD.isEmpty(t)||(a=i.getControlProxy(t.id)),a){0==e?a.config.height=0:a.config.height=i.mainMenuBarHeight;var n=i.getControlProxy(i.innerTitleContainerKey);if(n){n.config.height=1;for(var o=0;o<n.config.items.length;o++){var r=n.config.items[o];0!=r.visible&&(n.config.height=n.config.height+r.height)}}i.doLayout()}},updateToolbarPanelHeight:function(e,t){var i=this,a=i.getControlProxy(e.key);a&&(0==t?a.config.metaHeight=a.config.height=0:a.config.metaHeight=a.config.height=e.height,i.doLayout())},updateMainMenuStates:function(e){var t=this;if(t.mainMenuKey){var i={key:t.mainMenuKey,methodname:"setBarItemStates",args:[e]};t.innerInvokeMethod(i)}},doMenuActions:function(e){for(var t in e){var i=e[t].actionName;switch(i){case"ItemClick":var a=e[t].key,n=new Object;n.ParentKey="",n.Key=a,n.Validation=this.mainMenu.getItem(a).validation,this.mainMenu_ItemClick(this.mainMenu,n);break;case"AddMainMenu":var o=e[t].item,r=e[t].position;null!=o&&null!=r&&this.addMainMenuItem(o,r);break;case"RemoveMenuBarItems":var s=e[t].keys;for(var t in s)this.removeMainMenuItem(s[t])}}},mainMenu_ItemClick:function(e,t){var i=this;KD.delayInvoke(function(){try{var a=e;if(null==a)return;var n=a.getItem(t.Key);if(null==n)return;var o=n,r=!0;if(null!=o&&(r=o.validation?i.validating(!0):r),!r)return;o.ProgressBarConent;this.IsBusy=o.ShowProgressBar;var s=i.getChangeData(!0);i.lockControl&&i.lockControl(a),"barinnersetting"==t.Key.toLowerCase()?i.fireEventNoData.call(i,"MainBarItemClick","bosdesigner",s):i.fireEventNoData.call(i,"MainBarItemClick",t.Key,s)}finally{}})},_KDClientService:function(){},openUrlWindow:function(e){var t=null,i=this;if(null!=e&&e.length>0){var a=e[0],n=KD.isEmpty(a.isurldecode)?!0:a.isurldecode,o=a.url||"";n&&(o=decodeURIComponent(a.url||""));var r=o.split("?"),s=r[0]||"",l=(r[1]||"").split("#"),d=l[0]||"",c=l[1]||"",h=o.indexOf("from=yzj")>=0;if(h)o=s+"?"+(KD.checkChinese(d)?KD.urlEncode(d):d);else{if(o.indexOf("ExeType=GUARDRUNTIME")>0&&installShellVerison&&"8.0.395">installShellVerison)return void i.showMessage(ResManager.LoadKDString("检测到引导程序未更新，请先下载打开GUI客户端进行引导程序更新，完成更新后再次下载打开星空卫士。","002014000007415"),"",i.getPageId(),0,3);o=s+"?"+(KD.checkChinese(d)?KD.urlEncode(d):d)+"#"+c}o=o.replace(" ","");var u=o.toLowerCase();KD.IsNullOrWhiteSpace(u)||u.startsWith("k3cloud:")||u.startsWith("http://")||u.startsWith("https://")||(o=KD.getUrlRoot()+(o.startsWith("/")?o:"/"+o));var p=a.title||"",g=a.urltitle||ResManager.LoadKDString("点击打开","0991733000003988"),f=a.desc||"";if(KD.IsNullOrWhiteSpace(o))return;var m=function(){t=i.openUrl(o,p,g,f)},v=function(){var e=function(e,t,i,a,n){$.ajax({async:!1,url:"https://localhost:"+e+"/RunProgram.kcapi?"+escape(t),type:"GET",dataType:"jsonp",jsonp:"clientproxycallback",timeout:n||500,success:function(e){e&&0==e.code||!a?i&&i(e):a()},error:function(e){a&&a()}})},t=function(t,i,a){e(8022,t,a,function(){e(18022,t,a,i)})};return{call:function(i,a,n,o){i&&i>0&&65535>i?e(i,a,o,function(){t(a,n,o)}):t(a,n,o)}}};if(o.indexOf("?KCS=1&")>0||o.indexOf("&KCS=1&")>0){var y="&KCSPort=",b=o.indexOf(y),D=0;if(b>0){b+=y.length;var k=o.indexOf("&",b+1);k>b&&(D=o.substring(b,k)),D=parseInt(D)}v().call(D,o,m,function(e){})}else m()}},loadLayoutSetting:function(e){if(null!=e&&0!=e.length){var t;if(t=this.layoutSettings&&this.layoutSettings.length>0?this.layoutSettings:KD.parseObject(e),null!=t){var i={};for(var a in t){var n=t[a];if(!KD.isEmpty(n)){var o=n[0];if(!KD.isEmpty(n[1])){var r=n.length>2?n[2]:KD.CONST.ClientType,s=n.length>3?KD.equalsIgnoreCase(n[3],"1"):!0;KD.isEmpty(i[o])?(r!=KD.CONST.ClientType&&s||r==KD.CONST.ClientType)&&(i[o]=n):s||r!=KD.CONST.ClientType||(i[o]=n)}}}for(var a in i){var l=i[a];if(null!=l&&l.length>1){var o=l[0],d=this.controlFactoryProxy.getCmp.call(this.controlFactoryProxy,o),c=l[1];null!=c&&null!=d&&d.loadLayoutSetting&&d.loadLayoutSetting(c)}}}}},outerHandleCommand:function(e){var t=this.targetContainer;if(null!=t&&null!=para&&e.length>0&&t.handleCommands){var i=e[0];t.handleCommands(this,i)}},sessionTimeout:function(e){var t=this,i=KD.isArray(e)?e[0]:e;KD.isEmpty(i)||(i.isTimeOut=!0,t.logoff(i))},logoff:function(e){var t=this;KDServiceClient.isSeqRequest()?KDServiceClient.beforeLogoff(function(){t.logoffCore.call(t,e)}):KD.delayInvoke(function(){t.logoffCore.call(t,e)},200)},logoffCore:function(e){var t=this;t.doCloseWindow.call(t),ClientAppProxy.Current.raiseLogoff.call(ClientAppProxy.Current,!1,t,function(){if(KD.isObject(e)&&e.isTimeOut){var i=e.msg||ResManager.LoadKDString("系统闲置时间过长，请重新登录","0991733000003989"),a={type:KDMessageBox.KDMesBoxType.Warning,msg:i,callback:function(i){t._realLogoOff(e)}};KD.Error.raise(a)}else{if(e&&null!=e.actions&&void 0!=e.actions&&e.actions.length>0){var n=e.actions[0];if(n&&null!=n.actionname&&void 0!=n.actionname&&n.actionname.toUpperCase()=="ShowNotificationMsg".toUpperCase()&&n.params&&n.params.length>0){var o=n.params[0];return o.callback=function(){t._realLogoOff(e)},void KDMessageBox.show(o)}}t._realLogoOff(e)}})},logoffPreWarn:function(e){if(KD.isObject(e)&&"LogOutPreFivePoint"==e.TimeOutPoint){var t=KD.IsNullOrWhiteSpace(e.Message)?ResManager.LoadKDString("系统闲置时间过长，即将自动退出，请确认是否退出？","00215177000026761"):e.Message;if(!ClientAppProxy.Current.IsPreTimeOutLogoffTip){var i={type:KDMessageBox.KDMesBoxType.Question,msg:t,button:KDMessageBox.KDMessageBoxButtons.ExitNotexit,callback:function(e){if(e==KDMessageBox.KDDialogResult.Exit)KD.writeLog("Login off after five minutes");else{ClientAppProxy.Current.rootForm&&ClientAppProxy.Current.rootForm.fireCustomEventsNoData("Kingdee.BOS.LogOutPreFivePoint","");var t={actionname:"idlewithhold"},i=[t];ClientAppProxy.Current.updateLastReqTime(i,{})}ClientAppProxy.Current.IsPreTimeOutLogoffTip=!1}};KDMessageBox.show(i)}}},_realLogoOff:function(e){KD.delayInvoke(function(){var t=KD.getEntryRole(),i=KD.entryrolePlugins.getPlugin(t),a=!0,n=KD.isIndex()?!1:!0;if(i&&$.isFunction(i.isDefaultLogoff)&&(a=i.isDefaultLogoff.call(i),KD.isIndex()&&(n=0==a?!0:!1)),!a&&i&&KD.isFunction(i.doLogoff))return void i.doLogoff.call(i);a&&n&&(e instanceof String?ClientAppProxy.Current.setLogoffPage(e,t):$.isArray(e)?ClientAppProxy.Current.setLogoffPage(e[0],t):$.isPlainObject(e)&&ClientAppProxy.Current.setLogoffPage(e.LoginRedirectUrl,t));var o=ClientAppProxy.Current.getLogoffPage();n&&KD.redirection(o)},200)},addMainMenuItem:function(e,t){this.mainMenu&&this.mainMenu.addItem&&this.mainMenu.addItem(e,t)},removeMainMenuItem:function(e){this.mainMenu&&this.mainMenu.removeItem&&this.mainMenu.removeItem(e)},setMainMenubarProperty:function(e,t){if(this.mainMenu)if(KD.isString(e))this.mainMenu.setItemProperty&&this.mainMenu.setItemProperty.call(this.mainMenu,e,t);else{var i=null,a=null;for(var n in e)i=e[n].key+"",a=e[n].value,KD.isEmpty(i)||(i="set"+i.substring(0,1).toUpperCase()+i.substring(1),this.mainMenu[i]&&KD.isFunction(this.mainMenu[i])&&this.mainMenu[i].call(this.mainMenu,a))}},setChildFormFloatTarget:function(e){if(!KD.isEmpty(e)){var t=KD.isArray(e)?e[0]:e,i=this.controlFactoryProxy;if(i){var a=i.getForm(t.pageId);if(a){1==t.isUpdateMainMenu&&(t.targetKey=this.mainMenuKey);var n=i.getCmp(t.targetKey);n&&(n=KD.isEmpty(t.targetDomId)?n.getControl&&n.getControl():n.getBarItemById?n.getBarItemById.call(n,t.targetDomId):n.getControl&&n.getControl(),a.hostWindowProxy.setWindowFloatTarget.call(a.hostWindowProxy,n,t))}}}},showDynamicFormNormal:function(e,t,i){var a=this.controlFactoryProxy.getCmp(t.TagetKey);if(a)return void this.showDynamicFormTarget(e,t,a);var n=null;e.hostWindowProxy?(n=e.hostWindowProxy,n&&n.setVisible&&n.setVisible(!0)):(n=this.getDynKDForm(e,t,n),e.apply.call(e,t)),t.showType==KDDynamicFormShowType.Modal?n.showDialog():n.show()},getDynKDForm:function(e,t,i){if(i=new KDFormProxy,i.createControl.call(i,t),i.setControlFactoryProxy.call(i,this.getControlFactoryProxy()),i.loadConfig.call(i,t),i.addDynamicForm.call(i,e),e.setHostWindowProxy.call(e,i),t.tagetKey){
var a=this.controlFactoryProxy.getCmp(t.tagetKey);if(t.tagetKey==this.mainMenuKey&&(a=this.getControlProxy(this.mainMenuKey)),null!=a){var n=a.getControl();n.kdform=i,n.clickAction=function(){this.kdform.show()},i.setTarget(a)}else if(t.openstyle&&t.openstyle.ShowType==KDDynamicFormShowType.FloatingAutoHide){var o=this.getControlProxy(this.mainMenuKey);if(o){var r=o.getBarItemById.call(o,t.tagetKey,!0);KD.isEmpty(r)||(r.kdform=i,r.clickAction=function(){this.kdform.show()},i.setTargetEl(r))}}}return i},showDynamicFormTarget:function(e,t,i){var a=null;return e.hostWindowProxy?(a=e.hostWindowProxy,a.hideWindow.call(a)):(a=this.getDynKDForm(e,t,a),e.apply.call(e,t)),t.showType==KDDynamicFormShowType.FloatingAutoHide?void a.showFloatingAutoHide():void(t.showType==KDDynamicFormShowType.Modal?a.showDialog():a.show())},addControls:function(e){var t=e,i=null;if(null!=t)for(var a=0;a<t.length;a++)if(i=t[a],null!=i){var n=i.parentkey,o=i.items;if(null!=o&&n){var r=this.getControlFactoryProxy(),s=r.getCmp.call(r,n.toUpperCase());if(s&&s.addControls){s.addControls.call(s,o)}}}},ShowWatcher:function(){KD.ShowHttpWatchWindow(!0)},exitLocalService:function(){KDLocalServiceClient.exit(null,this)},setLanguages:function(e){},updateLayout:function(){},clearChildren:function(){},openUrl:function(e,t,i,a){var n=this.IsClientUrl(e),o=null,r=null;if(n)KD.openK3CloudApp(e,t,i,a);else{o=this.GenDisplayWindow(t,a);var s=this.GenHyperLinkButton(i,e,o);$(o.Content).append(s),r=o.ShowDialog(),$(".windowColseHandle",o.Content).off("click").on("click",function(e){KD.delayInvoke(function(e){r.close()},900)})}},OpenAppUrl:function(e){KD.OpenDeskApp(e)},GetDeskShellStatus:function(){return KD.checkDeskShellStatus()},IsClientUrl:function(e){return KD.isClientUrl(e)},GenDisplayWindow:function(e,t){return KD.genDisplayWindow(e,t)},GenHyperLinkButton:function(e,t,i){return KD.genHyperLinkButton(e,t,i)},GenClientDownloadPanel:function(e,t,i){return KD.genClientDownloadPanel(e,t,i)},invokeTimeCounter:function(){this.beginBatchRequest();try{var e=this.getChangeData(!0),t={postDatas:e};this.addAdditionalInfo(t),this.fireEvent("TimerElapsed",t)}catch(i){KD.writeError(i)}finally{this.endBatchRequest()}},addAdditionalInfo:function(e){e=$.extend(e,{ClientConfigInfo:"",isConnectInternet:!1})},resetTimeCount:function(){ClientAppProxy.Current.resetTimeCount.call(ClientAppProxy.Current)},setTimeout:function(e){ClientAppProxy.Current.loadTimeoutConfig.call(ClientAppProxy.Current,e)},onPreviewPrintBtnClick:function(e){var t=this,i=[{pageID:e.pageId,printJobId:e.jobId,action:"PreviewPrint",printerAddress:""}];KD.delayInvoke(function(){t.print.call(t,i)})},printPreview:function(e){var t=e;$.isArray(t)||(t=[e]);var i=(this.extParam(t),this.getPageId()),a=t.length,n=KD.Guid.NewGuid().ToString();void 0==KD.BatchPrintArgs&&(KD.BatchPrintArgs={}),KD.BatchPrintArgs[n]={pageId:i,preview:!0,actionCount:a,printedActionCount:0};for(var o in t){var r=t[o];r.actionIsoId=n;var s={printConfig:r,isoId:n,serviceName:this.server.serviceName,printJobId:r.printJobId||"",dataMethod:r.dataMethod||r.methodName||r.MethodName,callback:this.printCallBack};this.doPrintCommand(s)}KD.delayInvoke(function(){ClientAppProxy.fireUserBehavior(null,"KDXPF","PrnHardOptim","打印机硬件优化专题")},3e3)},print:function(e){var t=e;$.isArray(t)||(t=[e]),this.extParam(t);var i=this.getPageId(),a=t.length,n=KD.Guid.NewGuid().ToString();void 0==KD.BatchPrintArgs&&(KD.BatchPrintArgs={}),KD.BatchPrintArgs[n]={pageId:i,actionCount:a,printedActionCount:0};for(var o in t){var r=t[o];r.actionIsoId=n;var s={printConfig:r,isoId:n,serviceName:this.server.serviceName,printJobId:r.printJobId||"",dataMethod:r.dataMethod||r.methodName||r.MethodName,callback:this.printCallBack};this.doPrintCommand(s)}KD.delayInvoke(function(){ClientAppProxy.fireUserBehavior(null,"KDXPF","PrnHardOptim","打印机硬件优化专题")},3e3)},printCallBack:function(e){void 0==KD.BatchPrintArgs&&(KD.BatchPrintArgs={});var t=this.getPageId(),i=KD.BatchPrintArgs[e.isoId]||{pageId:t,actionCount:1,printedActionCount:0,items:[]},a={printjobid:e.jobId,isSuccessfull:"true"==(e.success||!1).toString().toLowerCase()};i.items=i.items||[],i.items.push(a),KD.BatchPrintArgs[e.isoId]=i,i.printedActionCount++,i.message=i.message?i.message+"\r\n"+e.message:e.message,i.printedActionCount==i.actionCount&&this.batchPrintComplete(e,i)},batchPrintComplete:function(e,t){try{this.setBusy(!1);var i=1==KD.getLocalConfiguration().PrintNoPrompt;if(!t.preview&&!i&&t.message){var a={msg:t.message};KDJSPreviewProxy.showMessage(a)||this.showNotificationMsg(a)}delete KD.BatchPrintArgs[e.isoId]}catch(n){KD.writeError(n)}finally{if(!t.preview){var o={curPageId:e.pageId,pageId:e.pageId,Items:t.items||[]};this.fireEventNoData(KD.KDPrintConst.AfterPrintEvents,t.pageId,"DataOutputed",KD.stringify(o))}}},doPrintCommand:function(e){var t=e.printConfig[KD.KDPrintConst.PageBuilder],i=KDReportPlugInProxy.getPlugin(t,this);if(!i){var a=ResManager.LoadKDString("没有可用插件","0991733030033495"),n={msg:a,type:KDMessageBox.KDMesBoxType.Warning};return void KDMessageBox.show(n)}$.extend(i,{completedAction:function(e){},errorAction:function(e){this.setBusy(!1)}}),this.setBusy(!0),i.doPrintCommand.call(i,e)},setFocus:function(e){if(null!=e&&0!=e.length){var t=e[0],i=t.key;if(i){var a=this.controlFactoryProxy.getCmp.call(this.controlFactoryProxy,i);null!=a&&KD.delayInvoke(function(){a&&(a.isGrid?KD.isFunction(a.setFocusCell)&&a.setFocusCell.call(a,t.row,t.colKey):KD.isFunction(a.focus)&&a.focus.call(a,!1))},500)}}},removeWaterMark:function(e){$(document.body).find(".kd-gbl-watermark").remove()},showWaterMark:function(e){if("Array"==typeof e){if(null!=e&&e.length>0)for(var t in e)setWaterMark(e[t])}else act(e)},setWaterMark:function(e){},setCoverWatermark:function(e){try{for(var t=KD.isArray(e)?e:[e],i=0;i<t.length;i++){var a=t[i];if(!KD.isEmpty(a)){var n=this.getHostWindowProxy();n&&KD.isFunction(n.setCoverWatermark)?n.setCoverWatermark.call(n,a):this.setCoverWatermarkGlobalCore(a)}}}catch(o){KD.writeLog(o.message,!0)}},setCoverWatermarkGlobalCore:function(e){},setControlsGuide:function(e,t,i){var a=this;if(i=i||0,e&&e[i]){var n=this.getControlProxy(e[i].targetKey);n&&n.setGuide&&(KD.isEmpty(e[i].delayInvokeTimeSpan)?n.setGuide(e,this,i):KD.delayInvoke(function(){n.setGuide.call(n,e,a,i)},e[i].delayInvokeTimeSpan))}},hideSmartCardBottom:function(e){var t=this;t.el.find(".kd-H5SmartCardBottomDiv")&&t.el.find(".kd-H5SmartCardBottomDiv").remove()},closeControlsGuide:function(e){if(!KD.isEmpty(e)){e=KD.isArray(e)?e[0]:e;var t,i=this,a=".",n="class",o=e.ismainconsole;KD.isEmpty(e.id)||(a="#",n="id",e[n]="tip_"+e[n]),t=o?$(a+e[n]):$(a+e[n],i.el),t.length>0?t.remove():KD.delayInvoke(function(){t=o?$(a+e[n]):$(a+e[n],i.el),t.length>0&&t.remove()},8e3)}},showMainConsoleTips:function(e){var t=e;KD.isArray(e)&&(t=e[0]),KDMainDynamicFormProxy.isNeedShowTip=t},setClientParams:function(e){if(null!=e&&0!=e.length){var t=e[0];if(null!=t&&0!=t.length){var i=KD.parseObject(t);ClientAppProxy.Current.clientControllerParams=i}}},extParam:function(e){var t=e;if($.isArray(e)&&e.length>0)for(var i=0;i<e.length;i++)if(t=e[i],KD.isObject(t)){var a=t[KD.KDPrintConst.PageBuilder];KD.isEmpty(a)&&(t[KD.KDPrintConst.PageBuilder]=KD.PrintMode.NotePrint)}return t},fireControlFocusedEvent:function(e,t){var i=e||{};i&&i.fireGotFocus&&this.fireControlFocusEvents&&(KD.isEmpty(this._lastfocusdChild)||this._lastfocusdChild.postKey!=i.postKey)&&this.fireEventNoData(KD.CONST.CustomEventName.FieldEditorFocued,i.postKey,KD.isEmpty(this._lastfocusdChild)?"":this._lastfocusdChild.postKey,0,0),this._lastfocusdChild=i},redirectRequest:function(e){},fireCustomRequest:function(e){var t=this;for(var i in e){var a=e[i];if(null!=a){var n=a.key,o=a.eventName,r="";if(r="string"==typeof a.data?a.data:JSON.stringify(a.data),a.isgcinfo){var s={};r&&(s.indata=r),s.clientinfo=KD.getClientInfo(),r=JSON.stringify(s)}a.data=r;var l=KD.getValue(a,"delay",0),d=KD.getValue(a,"delayClick",!1);if(d){var c=a;c.delay=0,c.delayClick=!1;var h=[];h.push(c),ClientAppProxy.Current.delayClickRequest=h,l>0&&KD.delayInvoke(function(e){ClientAppProxy.Current&&ClientAppProxy.Current.delayClickRequest&&ClientAppProxy.Current.delayClickRequest.length>0&&(t.fireCustomEvents(e.key,e.eventName,e.data),ClientAppProxy.Current.delayClickRequest=null)},l,!0,a)}else l>0?KD.delayInvoke(function(e){t.fireCustomEvents(e.key,e.eventName,e.data)},l,!0,a):t.fireCustomEvents(n,o,r)}}},refreshChildForm:function(e){if(e)for(var t in e){var i=KD.getValue(e[t],"formid",""),a=KD.getValue(e[t],"pageid","");this.refreshContentChildForm(this.controlFactoryProxy,i,a)}},refreshContentChildForm:function(e,t,i){if(""==t&&""==i)return!1;if(""!=t&&e.formProxy.dformConfig.formid.toLowerCase()==t.toLowerCase()||""!=i&&e.formProxy.dformConfig.pageId.toLowerCase()==i.toLowerCase())return e.formProxy.loadData(),!0;for(var a in e.forms){var n=e.forms[a];if(n)if(""!=t&&n.dformConfig.formid.toLowerCase()==t.toLowerCase()||""!=i&&n.dformConfig.pageId.toLowerCase()==i.toLowerCase())n.loadData();else if(this.refreshContentChildForm(n.controlFactoryProxy,t,i))return!0}return!1},showGuidePromptStart:function(e){var t=this;KD.CONST.isStartNewUserUtilityWizards=!0;var i=1e3,a=$("#divGuidePromptStart"),n=kendo.format('<div id="divGuidePromptStart" class="kd-consoleguidepromptform kd-consoleguideprompt"><div class="kd-consoleguideprompt-lbltitle" style="margin-top:40px">'+ResManager.LoadKDString("开启您的","002014000004567")+'</div><div class="kd-consoleguideprompt-lbltitle1">'+ResManager.LoadKDString("金蝶云星空旅程","002014000004568")+'</div><div class="kd-consoleguideprompt-lblslogan">'+ResManager.LoadKDString("打造专属于您的个性化业务平台，为您开启新的企业管理流程","00214298000004657")+'</div><div class="kd-consoleguideprompt-btn-container"><a class="kd-consoleguideprompt-btnnext"><span>'+ResManager.LoadKDString("带您了解金蝶云星空","002014000004570")+'</span></a></div><div class="kd-consoleguideprompt-btn-container"><a class="kd-consoleguideprompt-btnskip">'+ResManager.LoadKDString("跳过","002014000004571")+"</a></div>NaN");a=$(n),KD.checkChinese(ResManager.LoadKDString("金蝶云星空旅程","002014000004568"))||a.find(".kd-consoleguideprompt-lbltitle1").css({"font-size":"29px"});var o={width:416,height:297,title:!1,resizable:!1,modal:!0,close:function(e){e.preventDefault(),t._handleGuidePromptAnimation(e,i)},open:function(e){t._adjustGuidePromptlayout(e)}};a.kendoWindow(o),a.data("kendoWindow").open(),$(".kd-consoleguideprompt-btnnext",a).click(function(e){$(this).off("click"),KD.delayInvoke(function(e){e.fireCustomEvents.call(e,"Kingdee.BOS.GuidePrompt.Start","LoadInfoPanelWithGuide",null),e.fireEvent.call(e,"ButtonClick","Kingdee.BOS.GuidePrompt.Start","Kingdee.BOS.GuidePrompt.Start",null)},i,!0,t),a.addClass("kd-close-frombtnnext"),a.data("kendoWindow").close()}),$(".kd-consoleguideprompt-btnskip",a).click(function(e){KD.CONST.isStartNewUserUtilityWizards=!1,KD.delayInvoke(function(e){e.fireCustomEvents.call(e,"Kingdee.BOS.GuidePrompt.Skip","ReLoadH5InfoPanel",null),e.fireEvent.call(e,"ButtonClick","Kingdee.BOS.GuidePrompt.Skip","Kingdee.BOS.GuidePrompt.Skip",null)},i,!0,t),a.data("kendoWindow").close()})},showGuidePromptEnd:function(e){var t=this;KD.CONST.isStartNewUserUtilityWizards=!1;var i=1e3,a=$("#divGuidePromptStart"),n=kendo.format('<div id="divGuidePromptEnd" class="kd-consoleguidepromptform kd-consoleguidepromptformend" ><div class="kd-consoleguidepromptend-divguideendtitle">'+ResManager.LoadKDString("您已经完成入门学习","00215181030033817")+'</div><div class="kd-consoleguidepromptend-divguideendtitle">'+ResManager.LoadKDString("立刻开始您的金蝶云星空旅程","00215181030033818")+'</div><div  class="kd-consoleguideprompt-btn-container kd-consoleguidepromptend" style="height:46px;width:200px"><a class="kd-consoleguidepromptend-btnbegin">'+ResManager.LoadKDString("开始使用金蝶云星空","00215181030033791")+"</a></div>NaN");a=$(n);var o={width:416,height:296,title:!1,resizable:!1,modal:!0,close:function(e){e.preventDefault(),t._handleGuidePromptAnimation(e,i)},open:function(e){t._adjustGuidePromptlayout(e)}};a.kendoWindow(o),a.data("kendoWindow").open(),$(".kd-consoleguidepromptend-btnmorintro",a).click(function(e){KD.delayInvoke(function(e){e.fireCustomEvents.call(e,"Kingdee.BOS.GuidePrompt.GetMoreInforFromVipKingdee","GetMoreInforFromVipKingdee",null),e.fireEvent.call(e,"ButtonClick","Kingdee.BOS.GuidePrompt.GetMoreInforFromVipKingdee","Kingdee.BOS.GuidePrompt.GetMoreInforFromVipKingdee",null)},i,!0,t),a.data("kendoWindow").close()}),$(".kd-consoleguidepromptend-btnbegin",a).click(function(e){KD.delayInvoke(function(e){e.fireCustomEvents.call(e,"Kingdee.BOS.GuidePrompt.BeginUse","ReLoadH5InfoPanel",null),e.fireEvent.call(e,"ButtonClick","Kingdee.BOS.GuidePrompt.BeginUse","Kingdee.BOS.GuidePrompt.BeginUse",null)},i,!0,t),a.data("kendoWindow").close()})},_handleGuidePromptAnimation:function(e,t){if(e&&e.sender){var i=$(e.sender.wrapper),a=50,n=50,o={left:$(document).width()-a+"px",top:"80px",width:a+"px",height:n,opacity:.1,"margin-top":"0px","margin-left":"0px"};if(i.find(".kd-close-frombtnnext").length>0)var o={opacity:.1};var r=t||1e3;i.animate(o,r),KD.delayInvoke(function(e){e&&e.sender&&e.sender.destroy()},r,!0,e)}},_adjustGuidePromptlayout:function(e){if(e&&e.sender){var t=$(e.sender.wrapper);t.css({"background-color":"transparent",top:"50%","margin-top":0-t.height()/2+"px",left:"50%","margin-left":0-t.width()/2+"px"}),KD.delayInvoke(function(e){e&&e.css({"background-color":"transparent",top:"50%","margin-top":0-e.height()/2+"px",left:"50%","margin-left":0-e.width()/2+"px"})},15,!0,t)}},showBroadcastBox:function(e){if(null!==e){var t=[];if($.isArray(e)){if(e.length<=0)return;if(e.length>1){var i;for(var a in e){var n=e[a];if(n){var o=KD.getValue(n,"pushbysrc",!1);if(o)if(i){if(i){var r=KD.getValue(i,"items",[]),s=KD.getValue(n,"items",[]);if(s.length>0)for(var l in s)r.push(s[l]);i.items||(i.items=r)}}else i=n,t.push(i);else t.push(n)}}}else t.push(e[0])}else{if(!KD.isObject(e))return;t.push(e)}for(var a in t){var d=t[a],c=KD.getValue(d,"src",""),h=KD.getValue(d,"pushbysrc",!1);if(!KD.IsNullOrWhiteSpace(c))if(h){if(!KD.isObject(d)||KD.isObject(d)&&KD.isObjectEmpty(d))return;var u=new KDBroadcastBoxProxy;u.ShowBroadcastBox($("body"),d)}else{var p=KD.getValue(d,"datatype",""),g=[{url:c,eventname:"ShowBroadcastBox"+p,otherdata:JSON.stringify(d)}];this.RequestInternetHttp(g)}}}},setIsLookupLikeMatch:function(e){var t=e;if("object"==typeof e[0]&&(t=e[0]),null!=t){var i=t.value||ClientAppProxy.Current.LookupLikeMatchType,a=t.isSilence||!1;t.store&&t.store.length>0&&(ClientAppProxy.Current.LookupLikeMatchStore=t.store),a?ClientAppProxy.Current.SetLookupLikeMatchTypeSilent(i):ClientAppProxy.Current.LookupLikeMatchType=parseInt(i)}},setLookupPageSizes:function(e){var t=e;KD.isArray(t)&&(t=e[0]),null!=t&&t.store&&t.store.length>0&&(ClientAppProxy.Current.LookupLikePageSizeStore=t.store)},ShowPCCloudApp:function(e){if(null!=e){var t=e[0],i=(KD.getValue(t,"phone",""),KD.getValue(t,"tophone","")),a=KD.getValue(t,"eid",""),n=KD.getValue(t,"toopenid",""),o=KD.getValue(t,"fromopenid",""),r=KD.getValue(t,"token",""),s=KD.format("tophone={0}&eid={1}&toopenid={2}&openid={3}&token={4}",i,a,n==o?"":n,o,r);K3Combine&&K3Combine.invokePlugin(s)}},OpenCloudAppriseWindow:function(e){if(e&&$.isArray(e)){var t=e[0];if(t&&(t=$.parseJSON(t),t.adress)){var i=t.adress;delete t.adress,i+=encodeURIComponent(KD.stringify(t));var a=[];a.push({source:i,title:ResManager.LoadKDString("云反馈","0991733000003998"),isweb:!0}),this.ShowKDWebbrowseForm(a)}}},SetHideMainAppriseRight:function(e){$("#mainAppriseRightDiv").hide()},SetClickFlyeffect:function(e){if(e&&$.isArray(e)){var t=e[0];if(t){"string"==typeof t&&(t=$.parseJSON(t));var i=void 0!=t.startid?this.controlFactoryProxy.controls[t.startid.toUpperCase()]:void 0,a=i&&i.el?i.el:null;if(null==a&&t.startel&&(a=$(t.startel)),null==a&&t.startelid&&(a=$("#"+t.startelid)),null==a&&(a=$(".flystartposition").children(0)),null!=a){var n=this;n.flyoption=t;var o=a.offset();if(!o)return;o.top-=window.pageYOffset,o.left-=window.pageXOffset;var r=$(".flyendposition").children(0);if(!r.length)return;t.flyimg||(t.flyimg="Images/biz/default/common/Shopcar.png");var s=r.offset();s.top-=window.pageYOffset,s.left-=window.pageXOffset;var l=$('<img style="display: block;width: 35px;height: 35px;border-radius: 35px;position: fixed;z-index: 9999;" src="'+t.flyimg+'">');l.fly({start:{left:o.left,top:o.top},end:{left:s.left+10,top:s.top+10,width:0,height:0},onEnd:function(){l.remove(),$(".flyendposition").removeClass("flyendposition"),$(".flystartidposition").removeClass("flystartidposition");var e="";null!=n.flyoption.startid?e=n.flyoption.startid:null!=n.flyoption.startelid&&(e=n.flyoption.startelid),n.fireCustomEvents(e+"_Flyeffect","FlyeffectEnd",""),delete n.flyoption}})}}}},selectPrinter:function(){var e=this;try{KDReportPlugInProxy.selectPrinter(function(t,i){var a=i||{},n=a.returnvalue||"",o={PrinterName:n};if(!n&&a.errMessage){var r=e.getParentFormByCurrentForm.call(e,e);if(r&&KD.isFunction(r.showSimpleMessage)){var s={title:"",msg:a.errMessage,option:0,msgType:0};r.showSimpleMessage.call(r,s)}}var l=KD.stringify(o);e.fireCustomEvents.call(e,"SelectPrinter","PrinterName",l)},e)}catch(t){KD.writeError(t)}},queryPrinterInfo:function(e){var t=this;try{var i=(KD.isArray(e)?e[0]:e)||"";KDReportPlugInProxy.queryPrinterInfo(i,function(e,i){var a=t.getPageId.call(t),n=KD.stringify(i.returnPack);t.fireCustomEvents.call(t,a,"QueryPrinterInfo",n)},t)}catch(a){KD.writeError(a)}},selectPrinterExt:function(e){var t=this;try{var i=parseInt((KD.isArray(e)?e[0]:e)||"0");KDReportPlugInProxy.selectPrinterExt(i,function(e,a){var n={Data:KD.stringify(a.returnPack),RetType:i},o=t.getPageId.call(t),r=KD.stringify(n);t.fireCustomEvents.call(t,o,"SelectPrinter",r)},t)}catch(a){KD.writeError(a)}},AddBtnForRightMenu:function(e){var t=ClientAppProxy.Current.getMainTab();t&&t.AddBtnForRightMenu&&t.AddBtnForRightMenu.call(t,e)},SetMainRightMenuVisible:function(e){var t=ClientAppProxy.Current.getMainTab&&ClientAppProxy.Current.getMainTab();t&&t.setMainRightMenuVisible&&t.setMainRightMenuVisible.call(t,e)},GetCurrentMainActiveForm:function(e){var t;e&&$.isArray(e)&&(t=KD.getValue(e[0],"callbackid",""));var i="";return ClientAppProxy.Current&&ClientAppProxy.Current.MainActiveForm&&(i=ClientAppProxy.Current.MainActiveForm.DformConfig.PageId,null==ClientAppProxy.Current.getAliveForm(i)&&(i="")),t&&this.fireActionCallBack(t,i),i},LoadRightColoudIframe:function(e){if(e&&$.isArray(e)){var t=e[0];if(t){t=t.url;var i=$("#RightColoudIframe"),a=i.length>0;if(!a&&t){var n=$(document).height()-250,o="<iframe id='RightColoudIframe' src='"+t+"'";o+="style='position:absolute;right:0px;top:5px;width:240px;z-index:9999999;display:none;height:"+n+"px'></iframe>",$(o).appendTo($(document.body)),i=$("#RightColoudIframe"),a=!0}if(t&&a){var r=i.get(0).src;r!=t&&(i.get(0).src=t)}var s=function(){$(document).off("click.LoadRightColoudIframe")},l=function(){$(document).on("click.LoadRightColoudIframe",function(){i.hide(function(){s()})})},d=i.is(":visible");d?d&&a&&i.hide(function(){s()}):i.show(function(){l()})}}},SetAllowUpLoadFileType:function(e){if(e&&$.isArray(e)){var t=e[0];t&&(ClientAppProxy.Current.AllowUpLoadFileType=t)}},SetTableVerticalNoLines:function(e){if(e&&$.isArray(e)){var t=e[0];ClientAppProxy.Current.IsTableVerticalNoLines=t}},SetGridFieldNotDefaultFull:function(e){if(e&&$.isArray(e)){var t=e[0];ClientAppProxy.Current.GridFieldNotDefaultFull=t}},SetFilterQuickerGuideTips:function(e){if(KD.isArray(e))if(1==e.length)var t=e[0];else var t=e[e.length-1];else var t=e;t="True"==t?!0:!1,ClientAppProxy.Current.FilterQuickerGuideTips=t},SetActiveVerifyBannerTips:function(e){if(KD.isArray(e))if(1==e.length)var t=e[0];else var t=e[e.length-1];else var t=e;t="boolean"==typeof t?t:"True"==t?!0:!1;var i=ClientAppProxy.Current.getMainConsoleForm();i&&this.dformConfig&&this.dformConfig.pageId==i.getPageId()?ClientAppProxy.Current.ActiveVerifyBannerTip=t:this.ActiveVerifyBannerTip=t},isVerifyFormBannerTip:function(){return ClientAppProxy.Current.ActiveVerifyBannerTip||this.ActiveVerifyBannerTip||this.hostWindowProxy&&this.hostWindowProxy.ActiveVerifyBannerTipFrom},SetClientComPro:function(e){if(e)if(KD.isArray(e))for(var t=0;t<e.length;t++)KD.isRunInForIn(t,e)&&this.setClientComProCore(e[t]);else KD.isObject(e)&&this.setClientComProCore(e)},setClientComProCore:function(e){KD.isObject(e)&&(KD.isValidProp(e,"NumberFieldRPTakeFormat")&&(ClientAppProxy.Current.NumFieldRPTakeFormat=KD.getValue(e,"NumberFieldRPTakeFormat",void 0)),KD.isValidProp(e,"EnableShowCVPAllFieldData")&&(this.enableShowCVPAllFieldData=KD.getValue(e,"EnableShowCVPAllFieldData",!0)),KD.isValidProp(e,"EnableTipsContent")&&(this.enableTipsContent=KD.getValue(e,"EnableTipsContent",!0)))},setIncludeMKStatusControl:function(e){this.includeMKStatusControl=e},SetMainMenuBeginTwinkle:function(e){if(KD.isArray(e))for(var t=this.mainMenu,i=0;i<e.length;i++)if(KD.isRunInForIn(i,e[i])){var a=e[i],n=KD.getValue(a,"key",""),o=KD.getValue(a,"isAnimate","false"),r=KD.getValue(a,"closeInterval","0");t&&t.setBarItemBeginTwinkle.call(t,n,o,r)}},ShowCVPAllFieldData:function(e,t){this.enableShowCVPAllFieldData&&this.includeMKStatusControl&&this.fireEventNoData(KD.CONST.CustomEventName.ShowCVPAllFieldData,e,[])},requestInternetHttpCallBack:function(e){var t=this,i=e[0],a=e[1];t.callingInternetHttp=t.callingInternetHttp||{},t.callingInternetHttp[i.EventName]=!1,t.fireCustomEventsNoData.call(t,"HttpRequestCallBack",i.EventName,a,null)},requestInternetHttp:function(e){var t=this,i=200,a=1500,n={values:e,formId:t.getFormId()};for(var o in e){var r=e[o],s={Url:KD.getValue(r,"url",""),NeedCallBack:KD.getValue(r,"needcallback",!1),Content:KD.getValue(r,"data",""),EventName:KD.getValue(r,"eventname",""),ContentType:KD.getValue(r,"contentType",""),IsBase64Call:KD.getValue(r,"isbase64call",!1),OtherData:KD.getValue(r,"otherdata",""),IsCallBackWithOtherData:KD.getValue(r,"iscallbackwithotherdata",!1)};r&&!KD.isEmpty(r.timeout)&&(s.TimeOut=KD.getValue(r,"timeout",0)),!KD.isDebug()&&s.Url.indexOf("&phone=")>0&&(s.Url=KD.getEncodeUrl(s.Url),r.url=s.Url),console.error&&console.error("requestInternetHttp"+s.Url),t.callingInternetHttp=t.callingInternetHttp||{},t.callingInternetHttp[s.EventName]=!0;var l=function(e,i){i&&!i.success&&(t.callingInternetHttp=t.callingInternetHttp||{},t.callingInternetHttp[s.EventName]&&KD.writeLog("Timeout!",i.data||"Failure, please try again later.",!1))},d=KD.getValue(r,"isservercall",!0);if(d&&this.server){var c=KD.getValue(r,"plusmethod","");if(c&&this[c])return r.usertoken=KD.getUserToken(),void this.doAction(r);var h=this.getNewServer(function(e,o){var r=KD.parseObject(e);return!KD.isEmpty(e)&&r.length>0?void t.onResponse(e,o):void t.circleQuery.call(t,"HttpRequestCallBack","",i,a,1,l,KD.stringify(n))},function(e){KD.isEmpty(e)||t.onResponseErr(e),t.circleQuery.call(t,"HttpRequestCallBack","",i,a,1,l,KD.stringify(n))});h.call.call(h,"H5RequestInternetHttp",this.dformConfig.pageId,r)}else{var u=KD.getValue(r,"isHandleException",!1),p=KD.getValue(r,"isClientMsgShow",!0),g={async:!0,url:KD.urlEncode(s.Url),type:s.Content?"POST":void 0,data:s.Content||void 0,contentType:s.ContentType||"application/x-www-form-urlencoded ",cache:!1,dataType:KD.getValue(r,"datatype","jsonp"),jsonp:"jsoncallback",jsonpCallback:"jsonpCallback",timeout:3e3,isHandleException:u,isClientMsgShow:p};s.TimeOut&&(g.timeout=s.TimeOut),$.ajax($.extend(g,{success:function(e,i){if(s.NeedCallBack&&s.EventName){var a={};a.callbackdata=e,a.otherdata=s.OtherData,t.fireCustomEvents.call(t,"HttpRequestCallBack",s.EventName,s.IsCallBackWithOtherData?JSON.stringify(a):e,"")}},error:function(e,i,a){if(this.isHandleException&&s.EventName){var n={};n.callbackdata="",n.otherdata=s.OtherData,t.fireCustomEvents.call(t,"HttpRequestCallBack",s.EventName,s.IsCallBackWithOtherData?JSON.stringify(n):""),this.isClientMsgShow&&t.showErrMsg({errorTitle:"",errorInfo:i})}}}))}}},updateCardInfoSetting:function(e){this.updateCardInfo({setting:e})},toggleshowcontent:function(e){KD.isArray(e)&&(e=e[0]);var t=this.el.data().attdata.id,i=$("#"+t+"-"+e.contentid);i.toggle();var a=$("#"+t+"-"+e.btnid).find("a");a.toggleClass(e.btntogleclass)},updateCardInfo:function(e){var t=this.el.closest(".kd-infoflow-item");if(!(t.length<=0)){KD.isArray(e)&&(e=e[0]);var i=KD.parseObject(t.attr("cardinfo"));if(null!=e.cardId&&void 0!=e.cardId&&(i.cardid=e.cardId),null!=e.setting&&void 0!=e.setting&&(i.cardparminfo=e.setting.toString()),null!=e.groupId&&void 0!=e.setting){this.el.closest(".kd-infoflow-panel")}t.attr("cardinfo",KD.stringify(i))}},circleQuery:function(e,t,i,a,n,o,r){var s=this,l=n||0;if(r=r||"",l>i)return void(KD.isFunction(o)&&o(s,{curTimes:l,success:!1,data:r+(r?"\r\n":"")+"Timeout, please try again later."}));var d=this.getNewServer(function(n){var d=KD.parseObject(n);KD.delayInvoke(function(){d&&d.length>0?(s.doActions.call(s,d),KD.isFunction(o)&&o(s,{curTimes:l,success:!0,data:r})):s.circleQuery.call(s,e,t,i,a,l+1,o,r)},a)},function(e){KD.isFunction(o)&&o(s,{curTimes:l,success:!1,data:e})});d.call.call(d,"CustomEvents",e,t,"",null)},getDashboardProxy:function(){var e=this.getControlProxy(this.billDashBoardKey);return e},setDashBoardItems:function(e){if(!KD.isArray(e))return void KD.writeLog("Error arguments in setDashBoardItems!","",!0);var t=e;if(e.length>0&&KD.isArray(e[0])&&(t=e[0]),t){var i=this.getDashboardProxy();i&&i.setItems&&i.setItems.call(i,t)}else KD.writeLog("Error arguments in setDashBoardItems!","",!0)},setDashBoardVisible:function(e){var t=e;t=KD.isArray(e)&&e.length>0?e[e.length-1]:e;var i=this.getDashboardProxy();i&&i.setVisible(t)},updateDashBoardItems:function(e){var t=e;if(!KD.isArray(e)){if(!KD.isObject(e)||KD.isEmpty(e.items))return void KD.writeLog("Error arguments in updateDashBoardItems!","",!0);t=e.items}if(e.length>0&&KD.isArray(e[0])&&(t=e[0]),t){var i=this.getDashboardProxy();i&&i.setItems&&i.updateItems.call(i,t)}else KD.writeLog("Error arguments in updateDashBoardItems!","",!0)},batchUpdateBizPanel:function(e){var t=e;if(!KD.isArray(e))return void KD.writeLog("Error arguments in expandBizPanelBatch!","",!0);for(var i={items:[]},a=0;a<t.length;a++){var n=t[a],o=n.targetKey,r=n.expand;o&&(this.expandBizPanel([o,r]),n.refreshDashBoard&&i.items.push(n))}KD.isEmpty(i.items)||this.updateDashBoardItems(i)},expandBizPanel:function(e){if(KD.isArray(e)&&!((e||[]).length<2))if(e.length<=3)this.expandTarget(e[0],e[1],e[2]);else for(var t=0;t<e.length&&t+1<e.length;t++){var i=e[t+1];if(KD.isString(e[t])&&!KD.isString(i)){var a=!1;t+2<e.length&&!KD.isString(e[t+2])&&(a=e[t+2]),this.expandTarget(e[t],i,a)}}},expandTarget:function(e,t,i){var a=this.getControlProxy(e),n=a?a.getControl.call(a):void 0;if(n){i||a&&a.setVisible&&a.setVisible.call(a,t,!0);var o=this.getDashboardProxy();o&&o.setItemOption&&(o.setItemOption.call(o,{targetKey:e,expand:t}),i||this.refreshFluidBizAltStyle())}},refreshFluidBizAltStyle:function(){var e=this.getDashboardProxy(),t=e?e.getVisKeys.call(e):void 0;if(!KD.isEmpty(t)){var i=this.getBillControlsPanel();i&&i.refreshAltBizStyle&&i.refreshAltBizStyle.call(i,t)}},checkTargetIsShowInWindow:function(e,t,i,a,n){var o,r=this,s=r.getControlProxy(e),l=s?s.getControl.call(s):void 0,d=!1,c=$(l);if(0==c.length)return d;var h=20,u=r.hasMenu?r.mainMenuBarHeight:0,p=-1*(u+h);p-=this.anchorPointProxyHeight;var g=void 0;if(i)g=i;else if(KD.CONST.IsBillHeadFloat)if(this.hostWindowProxy&&this.hostWindowProxy.contentEL)g=this.hostWindowProxy.contentEL;else{var f=ClientAppProxy.Current.getMainTab();if(f&&f._getTabItemIndexbyAnyFormKey){var m=f._getTabItemIndexbyAnyFormKey.call(f,this.key,"1");g=m&&m.contentEL}}else g=$("html, body");var v=c.offset().top,y=KD.CONST.IsBillHeadFloat?1e-4:(a||{}).top,b=!1;if(g){var D=$(g);y=(y?y:D.scrollTop())-D.offset().top}var k,C,x=!1,w=!1;return t?(x=KD.CONST.IsBillHeadFloat?0-(y+p)>=v:y-p>=v,x&&(C=c.outerHeight(!0),w=KD.CONST.IsBillHeadFloat?v+C>=0-(y+p):v+C>=y-p,w?d=!0:(d=!1,b=!0))):(x=KD.CONST.IsBillHeadFloat?v>=0-(y+p)-h:v>=y-p-h,x&&(k=KD.getWindowHeight(),w=KD.CONST.IsBillHeadFloat?0-(y+p)+k-h>=v:y-p+k>=v,w?d=!0:(d=!1,b=!0))),o=1==b?{formContainer:g,windowoffset:a,currentScrollActionId:n}:d},scrollToTarget:function(e){var t=this,i=t.getControlProxy(e),a=i?i.getControl.call(i):void 0,n=t.getScrollOffsetDeta(),o=t.hasMenu?t.mainMenuBarHeight:0,r=-1*(o+n);r-=this.anchorPointProxyHeight;var s=void 0;if(KD.CONST.IsBillHeadFloat)if(this.hostWindowProxy&&this.hostWindowProxy.contentEL)s=this.hostWindowProxy.contentEL;else{var l=ClientAppProxy.Current.getMainTab();if(l&&l._getTabItemIndexbyAnyFormKey){var d=l._getTabItemIndexbyAnyFormKey.call(l,this.key,"1");s=d&&d.contentEL}}KD.scrollTo(a,{height:r},s)},scrollToTop:function(){var e=$("html body"),t=void 0;if(KD.CONST.IsBillHeadFloat)if(this.hostWindowProxy&&this.hostWindowProxy.contentEL)t=this.hostWindowProxy.contentEL;else{var i=ClientAppProxy.Current.getMainTab();if(i&&i._getTabItemIndexbyAnyFormKey){var a=i._getTabItemIndexbyAnyFormKey.call(i,this.key,"1");t=a&&a.contentEL}}KD.scrollTo(e,{},t)},onExecCommand:function(e){if(120==e.keyCode){var t=$(e.target).val()||"";if(t&&"clearmetacache"==t.toLowerCase())KD.ClearLocalCahce();else{var i=this.getFormProxy();t&&i&&KD.isFunction(i[t])&&i[t].call(i)}}},currentOpenFileDialogFileList:null,currentPastePicItem:{},ShowSpecialUploadForm:function(e){if(null!=e){var t=e[0],i=KD.getValue(t,"upcontrol",""),a=KD.getValue(t,"formid",""),n=KD.getValue(t,"btupkey","");if(i&&a&&(n||null!=this.currentOpenFileDialogFileList)){var o=new FormManager,r=new ShowFormParameter(a);if(t.data)for(var s in t.data)r.CustomParams[t.data[s][0]]=t.data[s][1];var l=this.currentOpenFileDialogFileList;$.extend(r,{FormProxyLoaded:function(e){var n;$.each(o.Forms,function(e){return o.Forms[e].dformConfig&&o.Forms[e].dformConfig.formid==a?(n=o.Forms[e],!1):void 0});var r=n?n.getControlProxy(i):void 0;r&&(r.setExtandUrl(KD.getValue(t,"extandurl","")),r.setUpUrl(KD.getValue(t,"upurl","")),r.UpLoadAiles(l))}}),o.ShowClientDynamicForm.call(o,r,function(){this.currentOpenFileDialogFileList=null});var d=this.getControlFactoryProxy();if(d&&KD.isFunction(d.addForm)&&o&&o.Forms){var c=o.Forms[0];c&&c.hostWindowProxy&&c.hostWindowProxy.setIsSpecialForm&&(c.hostWindowProxy.setIsSpecialForm.call(c.hostWindowProxy,!0),d.addForm.call(d,c))}}}},setNavTipsState:function(e){if(KD.isArray(e))if(1==e.length)var t=e[0];else var t=e[e.length-1];else var t=e;var i="";i=!KD.isEmpty(t)&&KD.equalsIgnoreCase(t.toString(),"true")?{state:!0}:{state:!1},KD.storage.setItem("isShowedTips",JSON.stringify(i))},setLastFocusGridTD:function(e,t){KD.isEmpty(e)||(KD.isEmpty(t)?this.lastFocusGridTDDetails=this.lastFocusGridTDDetails||{}:this.lastFocusGridTDDetails={},this.lastFocusGridTDDetails[e]=t)},getLastFocusGridTD:function(e){var t=null;return KD.isEmpty(this.lastFocusGridTDDetails)||(t=this.lastFocusGridTDDetails[e]),t},setH5PrintDrv:function(e){KDPrintingStrategy.setH5PrintDrv(KD.isArray(e)?e:[e])},invokeLocalTrayAction:function(e){var t=this,i=function(e,t){KD.writeLog("invokeLocalTrayAction()")},a=(KD.isArray(e)?e[0]:e)||{},n=a.methodName||"",o=a.classAssembly||"",r=a.params;KDLocalServiceClient.invokeLocalAction(i,t,n,o,r)},invokeLocalTrayActionExt:function(e){var t=this,i=function(e,t){KD.writeLog("invokeLocalTrayActionExt()")},a=(KD.isArray(e)?e[0]:e)||{},n=a.methodName||"",o=a.actionKey||"",r=a.classAssembly||"",s=a.params;KDLocalServiceClient.invokeLocalActionExt(i,t,n,o,r,s)},loadYunZhiJiaQingJS:function(e){if(e&&$.isArray(e)){var t=e[0];if(t){var i=this.getIsSupportYunZhiJiaQing();i&&KD.DynaLoadJS("KDYunZhiJiaQingJS",t)}}},getIsSupportYunZhiJiaQing:function(e){var t=this,i=KD.isArray(e)?e[0]:e,a=KD.getValue(i,"callbackid",""),n=!1;try{var o=KD.getCurrentBrowsType(),r=o.type,s=o.ver,l=o.mainVer,d=l||Number(s.split(".")[0]);n=r==KD.CONST.BrowsType.Chrome&&d>=59||r==KD.CONST.BrowsType.firefox||r==KD.CONST.BrowsType.Safari&&d>=14,(KD.isMobileOS()||r==KD.CONST.BrowsType.Safari)&&(n=!1);
}catch(c){KD.writeLog("KD.Form.loadYunZhiJiaQingJS",c,!1),n=!1}return a&&KD.delayInvoke(function(){t.fireActionCallBack.call(t,a,n)}),n},setYunZhiJiaCosmicSsoToken:function(e){if(e&&$.isArray(e)){var t=e[0];t&&t.qingssotoken&&(ClientAppProxy.Current.YunZhiJiaCosmicSsoToken=t.qingssotoken)}},doExcelPrintAction:function(e){try{this.setBusy(!0);var t=new KDExcelPrintPluginProxy;t.owner=this,t.beginExcelPrintAction(e)}catch(i){KD.writeError(i)}finally{this.setBusy(!1)}},setDynamicResAddin:function(e){try{for(var t=KD.isArray(e)?e:[e],i=0;i<t.length;i++){var a=t[i],n=a.id||"",o=a.src||"";KD.dynamicResAddin(n,o)}}catch(r){KD.writeLog("setDynamicResAddin",r.message,!0)}},raiseHelpFun:function(e){var t=KD.isArray(e)&&e[0],i=KD.isObject(t)&&t.showmaintabhelp,a=ClientAppProxy.Current.getMainTab();a&&a.setUnAllowHelpCenter&&a.setUnAllowHelpCenter.call(a,!i),a&&a.setHelpPanelVisible&&a.setHelpPanelVisible.call(a,e)},RaiseHelpAssistant:function(e){var t=ClientAppProxy.Current.getMainTab();t&&t.handleHelpAssistantData&&t.handleHelpAssistantData.call(t,e)},loadTipsContent:function(e){var t=ClientAppProxy.Current&&ClientAppProxy.Current.LineTipsDisplayRule;this.enableTipsContent&&"3"!=t&&this.server.call("LoadTipsContent")},getNotificationProxy:function(e){if(KD.isEmpty(e))return"";var t,i=ClientAppProxy.Current.getRootForm()||this;switch(e.msgStyle){case 2:t=this.msgBannerStyleTypeId;break;case 3:t=this.msgKaiPingStyleTypeId;break;case 4:t=this.msgMenuBarStyleTypeId}var a=i.getControlProxy(t);if(!a){var n={id:t,xtype:"kdnotification",backgroundimage:"",border:!1,dock:0,height:"auto",hscroll:0,style:0,tabIndex:1001,vscroll:0,width:295,zindex:10012};a=this.createInnerControl(n),i.children&&i.children.push(a)}return a},doKDMessageCenterDataSingle:function(e){if(!KD.isEmpty(e)){var t=KD.isArray(e)?e:[e];if(t&&t.length>0)for(var i=0;i<t.length;i++){var a=t[i],n=this.getNotificationProxy(a),o={},r=a.msgStyle?[a.msgStyle]:[1];o.msgStyle=a.msgStyle,o.autocloseinterval=a.autocloseinterval,o.msgItems=KD.isArray(a)?a:[a],(r.indexOf(2)>=0||r.indexOf(3)>=0||r.indexOf(4)>=0)&&(n.visible||n.showToastMsg(o))}}},doKDMessageConcentratorData:function(e){if(!KD.isEmpty(e)){var t=KD.isArray(e)?e:[e];if(t&&t.length>0)for(var i=0;i<t.length;i++){var a=t[i],n=a.hasRemindType||[1,2,3,4],o=ClientAppProxy.Current.getRootForm()||this,r=o.getControlProxy(this.mesCenterTypeId);if(!r){var s="FBtnMessage",l="FAudioPlay",d={id:this.mesCenterTypeId,xtype:"kdmescentertype",anchorControlId:s,audioControlId:l,layout:"kdlayout",lineWrap:!1,ImageShowStyle:0,backgroundimage:"",border:!1,dock:0,height:"auto",hscroll:0,style:0,tabIndex:1001,vscroll:0,width:295,zindex:10012};if(r=this.createInnerControl(d),r&&r.setActionFormProxy){var c=ClientAppProxy.Current.getMainConsoleForm();c&&(r.setActionFormProxy.call(r,c),r.setParentControlProxy.call(r,d.anchorControlId),r.setAudioControlProxy.call(r,d.audioControlId))}}var h=this.getNotificationProxy(a);n.indexOf(1)>=0&&r.setBtnMessageIsHighlightRemind.call(r,!0);var u=a.msgStyle?[a.msgStyle]:[1];if(u.indexOf(1)>=0?r.visible||r.showToastMsg(a):(u.indexOf(2)>=0||u.indexOf(3)>=0||u.indexOf(6)>=0)&&(h.visible||h.showToastMsg(a)),n.indexOf(3)>=0){var p={};p.isAnimate=!0,p.autocloseinterval=KD.getValue(a,"twinkleinterval",8),r.beginAnimateBtnMessageRing.call(r,p)}if(n.indexOf(4)>0){var p={};r.setMainConsolePlayAudio.call(r,p)}}}},NavigateToField:function(e){if(!KD.isEmpty(e)){e=KD.isArray(e)?e:[e];for(var t=function(e,t){var i=$(t).closest(".kd-fluid-fieldsetitem");i=0==i.length?$(t):i;var a=i.height(),n=$(e).offset(),o=i.offset();return n.top+$(e).height()<=a+o.top||!1},i=0;i<e.length;i++){var a=e[i],n=KD.getValue(a,"rowIndex",-1),o=KD.getValue(a,"entryKey",""),r=KD.getValue(a,"key",""),s=KD.getValue(a,"pageId",""),l=KD.getValue(a,"verifyResultPageId",""),d=this||ClientAppProxy.Current.getAliveForm(s),c=!1,h=null,u=!1;if(!KD.isEmpty(d)&&(KD.isEmpty(o)?h=d.getControlProxy(r):n>-1&&(h=d.getControlProxy(o),c=!0),h)){var p=h.config&&h.config.parentTabControlKey;if(p){var g=d.getDashboardProxy(),f=h.config.parentTabItemKey;if(g){if(g.AnchorPointProxy&&g.AnchorPointProxy.showTabItem){var m=g._getAnchorPointKeyByTargetKey(f);d.expandTarget.call(d,f,!0),g.AnchorPointProxy.showTabItem.call(g.AnchorPointProxy,m,!0),u=!0}}else{var v=d.getControlProxy(p);if(v){var y=v._getTabItemIndexOrItemObjectbyKey.call(v,f,!0);if(y&&!y.visible)return;v.setSelectedKey.call(v,f)}}}var b=ClientAppProxy.Current.getAliveForm(l),D=null,k=b&&b.getHostWindowProxy(),C=k&&k.el;C&&(C.updateCollapseStatesByFieldKey&&C.updateCollapseStatesByFieldKey.call(C,r),D=C.elDialog);var x=null;if(c)h.setFocusCell.call(h,n,r),x=h.getTdByFieldAndRowId.call(h,r,n);else{var w=!0,K=h&&h.getParentProxy.call(h);K&&(w=kendo.isScrollable(K.el[0])?!1:t(h.el,K.el)?!1:!0),x=h.el;var S=h.editor;!w&&x&&(x[0].scrollIntoView(!1),x.editor&&x.editor.find(".k-input").focus(),S.setFocus&&S.setFocus()),S&&S.validating.call(S)}if(!x)return void(b&&b.showWarnningMsg.call(b,[{msg:"当前字段无法定位，可能页签被隐藏"}]));D&&D.wrapper.is(":visible")&&KD.delayInvoke(function(){KD.isCoveredInElement(x,D.wrapper)&&C.collapseDialogForm()},u?1e3:500)}}}},UpdateErrorFieldInfos:function(e){if(!KD.isEmpty(e)){e=KD.isArray(e)?e:[e];for(var t=0;t<e.length;t++){var i=KD.isArray(e[t].errorFields)?e[t].errorFields:[e[t].errorFields],a=KD.getValue(e[t],"verifyResultPageId",""),n=ClientAppProxy.Current.getAliveForm(a);if(n){var o=n.getHostWindowProxy(),r=o&&o.el,s=[];i.forEach(function(e){var t={};$.extend(!0,t,e),t.verifyResultPageId=a,t.rowIndex=t.row,s.push(t)}),r&&r.setCollapseDialogFormData.call(r,s)}i=i.filter(function(e){return 1==e.isNavigatable});for(var l=0;l<i.length;l++){var d=i[l],c=this,h=KD.getValue(d,"row",-1),u=KD.getValue(d,"entryKey",""),p=KD.getValue(d,"key",""),g=KD.getValue(d,"pageId",""),f=ClientAppProxy.Current.getAliveForm(g)||this;if(h>-1&&f){var m=c.getControlProxy(u),v={key:p,row:h,hasError:!0};m&&m.updateFieldStates&&m.updateFieldStates.call(m,v)}}}}},fireLoadPastePic:function(){var e=this;this.el.off("paste").on("paste",function(t){var i=t.originalEvent;if(e.currentPastePicItem&&e.currentPastePicItem.ctlKey&&!KD.isEmpty(i)){var a=e.controlFactoryProxy.getCmp.call(e.controlFactoryProxy,e.currentPastePicItem.ctlKey);if(!KD.isEmpty(a)&&(void 0===a.AllowImagePaste||a.AllowImagePaste)&&!a.disabled&&0!=a.isShowMenu)for(var n=i.clipboardData&&i.clipboardData.items,o=0;o<n.length;o++)if(KD.isRunInForIn(o,n)&&"file"==n[o].kind&&-1!==n[o].type.indexOf("image/")){n[o]&&n[o].getAsFile();i.dataTransfer=i.clipboardData;var r=a.columnDescriptor;e.currentPastePicItem.arg;r?r._uploadloader&&r._uploadloader.UpLoadAiles&&r._uploadloader.UpLoadAiles(i):a._uploadloader&&a._uploadloader.UpLoadAiles&&a._uploadloader.UpLoadAiles(i)}}})}}),function(){$.extend(KDDynamicFormProxyBase_DoAction.prototype,{simulationAttack:function(){if(ClientAppProxy.simulationAttackSwitchCount=(ClientAppProxy.simulationAttackSwitchCount||0)+1,ClientAppProxy.simulationAttackSwitchCount%2!=0){var e=ClientAppProxy.isSimulationAttack=!ClientAppProxy.isSimulationAttack;KD.writeLog("ClientAppProxy.isSimulationAttack = "+e,"",!0),KDMessageBox.show({type:KDMessageBox.KDMesBoxType.OK,callback:null,button:KDMessageBox.KDMessageBoxButtons.Yes,msg:"SimulationAttack:"+(e?"ON":"OFF")})}},updateSimulationClientInfo:function(e){var t=KD.CONST.SimulateMacAddress,i=KD.CONST.SimulateIpAddress,a=KD.isArray(e)?e[0]:void 0;if(!KD.isEmpty(a)){var n=KD.getValue(a,t,""),o=KD.getValue(a,i,"");KD.isEmpty(n)||KD.isEmpty(o)||(KD.storage.setItem(t,n||""),KD.storage.setItem(i,o||""))}},updateConnectionConfig:function(e){var t=this,i=KD.getConnectConfig(),a=KD.isArray(e)?e:[e],n="updateConnectionConfig()_{0}",o="";try{o=t.getFormId(),KD.writeLog(KD.format(n,o),KD.stringify(a),!0);for(var r=0;r<a.length;r++){var s=a[r]||{};void 0!==s.key&&void 0!==s.value&&(i[s.key]=s.value)}}catch(l){KD.writeLog(KD.format(n,o),l,!0)}},LoadUserParamSetting:function(e){var t=KD.isArray(e)?e[0]:void 0;t=KD.isEmpty(t)?"":t.toUpperCase();var i=this.getControlProxy(t),a=this.baseId;KDUserparamSetting.show(a,i)}})}(),function(){var e=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){return t=t||"",e.test(t)?RegExp.$1:"*"}}(),t=function(t,i){var a=(window.name||"_parent",{_top:window.top,_self:window,_parent:window.parent});if(t=a[t]){t.postMessage(KD.stringify(i),e("*"))}};$.extend(KDDynamicFormProxyBase_DoAction.prototype,{sendMessageToWBOpener:function(e){var i=(KD.isArray(e)?e[0]:e)||{pageid:"xxx",putdata:{title:"xxx",openurl:"xxxx",otherargs:void 0}};t("_top",i),window._$postmessageargs=KD.stringify(i)}})}(),define("KDDynamicFormProxyBase_DoAction",["KDDynamicFormProxyBase_DataManager","KD","KDImageProxy"],function(e){return function(){var t;return t||e.KDDynamicFormProxyBase_DoAction}}(this)),KDDynamicFormProxyBase_Server=function(){},KDDynamicFormProxyBase_Server=KD.extend(KDDynamicFormProxyBase_DoAction,{defLocalId:"2052",server:null,dformConfig:null,load:function(e,t,i,a){var n=new Object;n.formID=e,i&&(n.pageID=i),t||null==t||0==t.length||(n.formType="list"),a&&(n.layoutID=a),this.loadByParaObject(n)},loadByParaObject:function(e,t){var i=this,a=new KDRequest;a.serviceName="FormMetaDataService",a.url=DFormConfig.absolutePath+"Service.aspx",a.scope=i,a.pageId=e.formID,a.callback=function(e){try{var a=KD.parseObject(e);if(!a)return;var n=new DFormConfig;n.loadConfig.call(n,a,i.defLocalId),n.actionname?i.invokeAction.call(i,n):(i.apply.call(i,n),t&&$.isFunction(t)&&t(i,n))}catch(o){i.showErrMsg.call(i,{errorInfo:o.stack,errorTitle:"Kingdee Information"})}},a.call.call(a,"GetDynamicFormConfig",e)},apply:function(e){if(KD.isGalaxyFormTheme(e.FormTheme)&&e.openstyle.ShowType==KDDynamicFormShowType.NewTabPage){this.el.addClass("kdform_"+e.FormTheme);var t=this.el.closest(".k-content");t.addClass("kdTabContent_"+e.FormTheme),this.notShowMainFormHolder(e.pageId)}KD.isKDScriptBusy(!0),this.rendered=!1;var i=this;if(e.openstyle){if(this.FormTheme=e.FormTheme,null!=this.dformConfig&&(this.dformConfig.showType=e.showType,this.release()),null==i.controlFactoryProxy&&i.initi(),e.openstyle.ShowType==KDDynamicFormShowType.InContainer){var a=this.getHostWindowProxy();if(a){var n=this.getHostWindowProxy().getControl();a.isFlowLayout&&a.isFlowLayout.call(a)||(e.height="0px"==n.css("height")?e.height:n.css("height")),e.width="0px"==n.css("width")?e.width:n.css("width")}}if(e.openstyle.ShowType==KDDynamicFormShowType.NewTabPage){var o=e.openstyle.InlineStyleCss;if(!KD.layout.isRelativeWidth(this.el)&&o){var r=parseInt(o.MarginRight)+parseInt(o.MarginRight);e.width=this.el.parent().width()-r}}if(null!=this.dformConfig){var s="";this.dformConfig.openstyle&&this.dformConfig.openstyle.InlineStyleCss&&null==e.openstyle.InlineStyleCss&&(s=this.dformConfig.openstyle.InlineStyleCss,e.openstyle.ShowType==KDDynamicFormShowType.InCurrentForm&&(e.openstyle.InlineStyleCss=s)),this.release()}this.setDFormConfig(e),null!=this.hostWindowProxy&&this.dformConfig.openstyle.ShowType==KDDynamicFormShowType.InCurrentForm&&this.initElementByContainerProxy(this.hostWindowProxy,e);var l=KD.getValue(e,"noBusy",!1);if(l||this.showBlocking(),this.initiServer(),null==this.dformConfig.flexpageId||0==this.dformConfig.flexpageId.length){this.loadData();var d=KD.storage.getMetaData(this.dformConfig);KD.isEmpty(d)?this.callMetadata():KD.delayInvoke(function(){i.callMetadata.call(i,d)})}this.hostWindowProxy&&this.hostWindowProxy.onReady&&this.hostWindowProxy.onReady.call(this.hostWindowProxy)}},setDFormConfig:function(e){this.dformConfig=e,ClientAppProxy.Current.addAliveForm.call(ClientAppProxy.Current,e.pageId,this)},initiServer:function(){this.server=new KDRequest,this.server.url=DFormConfig.absolutePath+this.dformConfig.serviceUrl,this.server.pageId=this.dformConfig.pageId,this.server.callback=this.onResponse,this.server.serviceName=this.dformConfig.serviceName,this.server.errcallback=this.onResponseErr,this.server.scope=this,this.server.bindBeforeCalledEvent(function(e,t){var i=null;if(t&&KD.isObject(t)&&(i=t.Parameter),i&&KD.isArray(i))for(var a=0;a<i.length;a++){var n=i[a];if(n&&KD.isArray(n)&&n.length>0){for(j=n.length-1;j>=1;j--){var o=n[j];o&&KD.isObject(o)&&o.hasOwnProperty(KD.CONST.MessageConcentratorGetProKey)&&n.splice(j,1)}var r=n[0];if(r&&KD.isObject(r)&&r.hasOwnProperty(KD.CONST.MessageConcentratorGetProKey)){var s=ClientAppProxy.Current.getMessageConcentrator();r[KD.CONST.MessageConcentratorGetProKey]=s.GetIsMessage.call(s,t.MethodName)}break}}})},callMetadata:function(e){if(null!=e)this.loadMetadata(e);else{var t=new KDRequest;t.scope=this,t.url=DFormConfig.absolutePath+this.dformConfig.loadUrl,t.callback=this.onLoad,t.errcallback=this.onResponseErr,t.callByUrl.call(t)}},onLoad:function(e,t){if(null==this.dformConfig.flexpageId||0==this.dformConfig.flexpageId.length){var i=e;if(!i)return;var a=null;try{a=KD.parseObject(i)}catch(n){return void this.showErrMsgStr(n.Message,n.StackTrace)}if(null!=a&&KD.isArray(a))return void this.doActions(a,t);var o=a;if(null==o)return void this.ShowErrMsgStr("元数据格式错误！",null!=a?i:"No Data");KD.storage.setMetaData(this.dformConfig,o),this.loadMetadata(o)}else this.loadMetadata(null)},loadMetadata:function(e){var t=this;t.setBusy(!0);var i=5,a=void 0,n=t.dformConfig&&t.dformConfig.formid||"";(t.getIsMain()||"BOS_HtmlConsoleMain"==n||"BOS_INFOFLOWLAYOUTPANEL_CARD"==n)&&(a=!0),KD.delayInvoke(function(){t.rendered=!1;var i=t.controlFactoryProxy;i&&i.controls.length>0&&t.release.call(t),t.loadConfig.call(t,e),t.rendered=!0,t.lazyActions?(t.onResponse.call(t,t.lazyActions,{methodName:"LoadData"}),delete t.lazyActions):t.setBusy.call(t,!1,function(){t.__unlockReqLocked.call(t)})},i,a)},loadData:function(){return!ClientAppProxy.Current.delayLoadData&&this.dformConfig&&"BOS_MainSystemMenuCard"==this.getPageId()&&this.dformConfig.showType&&this.dformConfig.showType==KDDynamicFormShowType.NewTabPage?void(ClientAppProxy.Current.delayLoadData=this.getPageId()):(this.setBusy(!0),void this.server.call.call(this.server,"LoadData"))},onResponseErr:function(e){var t=this;try{var i=KD.parseObject(e);t.doActions(i)}finally{KD.GolbalOperation==KD.EnumGolbalOperation.NormalBiz,KD.isKDScriptBusy(!1),KD.isFunction(t.setBusy)&&t.setBusy(!1,function(){t.__unlockReqLocked.call(t)})}},onResponse:function(e,t){var i=this;try{var a=(e||"").substr(0,1e3).toLowerCase();if(a.indexOf("<!doctype html")>=0){var n=KD.entryrolePlugins.getPlugin(KD.getEntryRole()),o=!0;if(n&&KD.isFunction(n.doResponseError)&&(o=n.doResponseError.call(n,e,t)),o){var r={type:KDMessageBox.KDMesBoxType.Warning,msg:"Response data error!",description:KD.htmlUtil.encode(e),callback:function(e){}};return void KD.Error.raise(r)}}if(KD.isFunction(this.isDontLazy)&&!this.isDontLazy())return void(this.lazyActions=e);var s=e;if(!s)return void KD.checkGolbalOperation();var l,d=KD.parseObject(s);d&&KD.isArray(d)?l=d:d&&KD.isObject(d)?(l=new Array,l.push(d)):null==d?l=new Array:this.showErrMsg(d),ClientAppProxy.Current.updateLastReqTime.call(ClientAppProxy.Current,l||[],t),this.doActions(l,t),!this.firstLoaded&&this.afterLoadData&&(this.firstLoaded=!0,this.afterLoadData())}finally{KD.checkGolbalOperation(),KD.isKDScriptBusy(!1),KD.isFunction(i.setBusy)&&i.setBusy(!1,function(){i.__unlockReqLocked.call(i)})}},doConfirmReturn:function(e,t){null!=t&&0!=t.length&&(this.setBusy(!0),this.server.call.call(this.server,"AfterConfirm",t,e))},getNewServer:function(e,t){if(null==this.dformConfig)return null;var i=new KDRequest;return i.url=DFormConfig.absolutePath+this.dformConfig.serviceUrl,i.pageId=this.dformConfig.pageId,i.serviceName=this.dformConfig.serviceName,i.callback=null==e?this.onResponse:e,i.errCallBack=t||this.onResponseErr,i},invokeCloseAction:function(){this.fireEvent("InvokeCloseAction")},closeServer:function(){if(!this.getSvrHasClosed()&&(this.setSvrHasClosed(),null!=this.server)){var e={},t=this.dformConfig&&this.dformConfig.pageId||this.pageId||"",i=this.dformConfig&&this.dformConfig.formid||this.formid||"",a=this.dformConfig&&this.dformConfig.isFormSizeChanged?this.dformConfig.isFormSizeChanged:!1;e.pageId=t,e.formid=i,this.hostWindowProxy&&KD.isEmpty(this.hostWindowProxy.formId)&&!KD.isEmpty(i)&&1==a&&(e.formwidth=this.el.width(),e.formheight=this.el.height());var n=this.getLayoutSetting();null!=n&&(e.setting=n);try{this.beginBatchRequest(),this.server.call.call(this.server,"CloseForm",!0,e)}catch(o){KD.writeError(o)}finally{this.endBatchRequest(),e=null}}},batchCloseServer:function(e){if(!this.getSvrHasClosed()&&(this.setSvrHasClosed(),null!=this.server))try{this.beginBatchRequest(),this.server.closeForm.call(this.server,e)}catch(t){KD.writeError(t)}finally{this.endBatchRequest()}},setSvrHasClosed:function(){this.serverHasClosed=!0},getSvrHasClosed:function(){return 1==this.serverHasClosed},getCloseFormArgs:function(e){void 0==e&&(e=[]);for(var t in this.controlFactoryProxy.forms){var i=this.controlFactoryProxy.forms[t];i.getSvrHasClosed.call(i)||i.getCloseFormArgs.call(i,e)}var a={},n=this.getLayoutSetting(),o=this.dformConfig&&this.dformConfig.pageId||this.pageId||"",r=this.dformConfig&&this.dformConfig.formid||this.formid||"";null!=n&&(KD.isEmpty(this.hostWindowProxy.formId)&&this.dformConfig.formid&&(a.pageId=o,a.formid=r,a.formwidth=this.el.width(),a.formheight=this.el.height()),a.setting=n);var s={pageid:o,servicename:this.server&&this.server.serviceName||"",paramdata:[!0,a]};e.push(s)},getServiceFormSate:function(){var e=this,t=e.server;e.setBusy(!0),t.call.call(t,"GetServiceFormState")},fireEventNoData:function(e){var t=this,i=t.server;if(t.isNoNeedSetBusy(e)||t.setBusy(!0),i){var a=i.getParamFromArgument.call(i,arguments);i.callByParaArray.call(i,e,!0,a)}},fireEventForArrayArgs:function(e){var t=this,i=t.server;if(i){var a=e[0];t.isNoNeedSetBusy(a)||t.setBusy(!0);var n=t.getChangeData(!0,a),o=i.getParamFromArgument.call(i,e);o.push(n),i.callByParaArray.call(i,a,!0,o)}},fireEvent:function(e){var t=this,i=t.server,a=!1;t.isNoNeedSetBusy(e)||(a=!0,t.setBusy(!0));var n=!KD.isSingleReq()&&t.forceBatchRequestEventNames[e];n&&this.beginBatchRequest(),this.beginBatchRequest();try{if(i){var o=t.getChangeData(!0,e),r=i.getParamFromArgument.call(i,arguments);r.push(o),i.callByParaArray.call(i,e,!0,r),a&&i.isEnableBatchRequest&&i.isEnableBatchRequest()&&t.setBusy(!1)}}catch(s){KD.writeError(s)}finally{this.endBatchRequest(),n&&KD.delayInvoke(function(){t.endBatchRequest.call(t)},10)}},fireSyncEvent:function(e){var t=this,i=t.server,a=!1;t.isNoNeedSetBusy(e)||(a=!0,t.setBusy(!0)),this.beginBatchRequest();try{var t=this,i=t.server;if(i){var n=t.getChangeData(!0,e),o=i.getParamFromArgument.call(i,arguments);o.push(n),i.callByParaArray.call(i,e,!1,o),a&&i.isEnableBatchRequest&&i.isEnableBatchRequest()&&t.setBusy(!1)}}catch(r){KD.writeError(r)}finally{this.endBatchRequest()}},beginBatchRequest:function(){this.server.beginBatchRequest.call(this.server)},endBatchRequest:function(){this.server.endBatchRequest.call(this.server)},fireCustomEvents:function(e,t,i){if(null!=this.server){this.beginBatchRequest();try{var a=this.getChangeData(!0,t);this.server.call.call(this.server,"CustomEvents",e,t,i,a)}catch(n){KD.writeError(n)}finally{this.endBatchRequest()}}},fireCustomEventsNoData:function(e,t,i){if(null!=this.server){this.beginBatchRequest();try{this.server.call.call(this.server,"CustomEvents",e,t,i,null)}catch(a){KD.writeError(a)}finally{this.endBatchRequest()}}},fireDoKDMessageConcentratorDataNoPostData:function(e){if(null!=this.server){this.beginBatchRequest();try{var t=KD.isString(e)?e:KD.stringify(e);this.server.call.call(this.server,"DoKDMessageConcentratorData",t,null)}catch(i){KD.writeError(i)}finally{this.endBatchRequest()}}},fireSyncCustomEvents:function(e,t,i){if(null!=this.server){this.beginBatchRequest();try{var a=this.getChangeData(!0,t);this.server.syncCall.call(this.server,"CustomEvents",e,t,i,a)}finally{this.endBatchRequest()}}},fireHideOrShowCustomEvents:function(e){e?this.fireCustomEventsNoData("FormShow","",""):this.fireCustomEventsNoData("FormHide","","")},fireActionCallBack:function(e,t){if(null!=this.server){this.beginBatchRequest();try{this.server.syncCall.call(this.server,"AfterActionCallback",e,t)}catch(i){KD.writeError(i)}finally{this.endBatchRequest()}}},loadCustomLayout:function(e){for(var t in this.controlFactoryProxy.controls){var i=this.controlFactoryProxy.controls[t],a=i;if(i.loadLayoutSetting){var n=!1;for(var o in e){var r=e[o],t=r.k;if((t||(t=r.key))&&t==i.Key){a.loadLayoutSetting(r),n=!0;break}}n||a.loadLayoutSetting(null)}}},loadFormPlugins:function(e){var t=this,i=[],a=KD.getVersion(),n=this.getPageId();for(var o in e){var r=e[o],s=KDControlFactoryProxy.formatFormtXType(r.customxtype);if(xtype=KDControlFactoryProxy.formatFormtXType(r.xtype),r.customxtype&&!KDControlFactoryProxy.exitForm(xtype)){var l=KDControlFactoryProxy.exitCustomPluginsFailType(xtype);if(!KD.isEmpty(l))return r.customxtype=r.xtype=l,t.showDynamicFormCore.call(t,e),!0;var d=KDCustomControlProxy.getPluginOptions({key:n,ver:a,assembly:s});KDControlFactoryProxy.registerTypeCallback(xtype,{scope:t,loadedHandler:function(t){this.scope.showDynamicFormCore.call(this.scope,e)}}),i.push(d)}}return i.length>0?(KDCustomControlProxy.createPluginNodeBatch({items:i,scope:this,onComplete:function(e){},onError:function(i){for(var a in e){var n=e[a]||{};KDControlFactoryProxy.registerCustomPluginsFailType(n.xtype,"kdform"),KD.writeError("loadFormPlugins error!",kendo.format("Has change plugins xtype {0} to {1}.",n.xtype,"kdform"),!0),n.customxtype=n.xtype="kdform"}t.showDynamicFormCore.call(t,e)}}),!0):!1}}),define("KDDynamicFormProxyBase_Server",["KDDynamicFormProxyBase_DoAction","KD"],function(e){return function(){var t;return t||e.KDDynamicFormProxyBase_Server}}(this)),function(){KDDynamicFormProxyBase=function(){},KDDynamicFormProxyBase=KD.extend(KDDynamicFormProxyBase_Server,{rootPanelKey:"BILLCONTROLS",billMenuKey:"billmenu",innerTitleKey:"innertitle",innerTitleContainerKey:"innertitlepanel",billDashBoardKey:"BILLDASHBOARD",floatErrMsgId:"popFloateErrMessage",floatTipMsgId:"popFloateMessage",mesCenterTypeId:"popFloatMesssageCenterType",msgBannerStyleTypeId:"popBannerTypeMesssage",msgMenuBarStyleTypeId:"popMenuBarTypeMesssage",msgKaiPingStyleTypeId:"popKaiPingTypeMesssage",enableTipsContent:!0,mainMenuBarHeight:48,anchorPointProxyHeight:36,fireControlFocusEvents:!1,enableShowCVPAllFieldData:!0,includeMKStatusControl:!1,noBusyEventNames:{EntityRowClick:!0,EntryCellFocued:!0,UpdateValue:!0,QueryProgressValue:!0,TreeNodeClick:!0,TimerElapsed:!0,FieldEditorFocued:!0,CustomEvents:{smartRobotCircleReq:!0,smartRobotCircleMsg:!0,LoadInfoForms:!0}},noBusyActionNames:{limit:10,setTimeout:!0},noBusyMethodNames:{limit:10,select:!0,Start:!0,SetCurrentValue:!0,SetCaption:!0},forceBatchRequestEventNames:{EntityRowClick:!0,EntryCellFocued:!0,TreeNodeClick:!0,CustomEvents:!0,QueryProgressValue:!0},_lockCtrlKeys:{},closed:null,getHostWindowProxy:function(){return this.hostWindowProxy},setHostWindowProxy:function(e){this.hostWindowProxy=e},getDialogResult:function(){return this.dialogResult},getReturnValue:function(){return this.returnValue},getPageId:function(){return this.dformConfig?this.dformConfig.pageId:""},getFormId:function(){return this.dformConfig?this.dformConfig.formid:""},isNoNeedSetBusy:function(e){var t=this,i=!1,a=t.dformConfig;if(a&&KD.getValue(a,"noBusy",!1))i=!0;else if(t.noBusyEventNames){var n=KD.isString(e)?e:void 0,o=KD.isObject(e)?e:void 0;if(n){var r=t.noBusyEventNames[n];KD.isObject(r)?i=r[n]:1==r&&(i=!0)}else if(o){var s=o.methodName||"",l=o.txtParams,d=(l&&l.length>1?l[1]:"")||"",r=t.noBusyEventNames[s];KD.isObject(r)?i=r[d]:1==r&&(i=!0)}}return i},isBusy:function(){return this._isBusy>0},setBusy:function(e,t){var i=this.dformConfig,a=!1;i&&KD.getValue(i,"noBusy",!1)&&(a=!0),this.isBusy()==e&&t&&KD.isFunction(t)&&t(),this._isBusy=this._isBusy||0,this._isBusy=(this._isBusy<0?0:this._isBusy)+(e?1:-1),this._isBusy>0?!a&&this.showBlocking():(this._isBusy=0,!a&&this.hideBlocking()),null!=this.busyStateChanged&&this.busyStateChanged(this,new EventArgs),t&&KD.isFunction(t)&&t()},getTargetContainer:function(){return this.targetContainer},setTargetContainer:function(e){this.targetContainer=e},getBusyContent:function(){return this.busyContent},setBusyContent:function(e){this.busyContent=e},initElementByContainerProxy:function(e,t){this.createControl(t),e&&e.addDynamicForm&&e.addDynamicForm.call(e,this,t)},initi:function(){this.controlFactoryProxy=this.initiControlFactoryProxy(),this.initChangeData()},afterCreateControlHandle:function(e){},getControlProxy:function(e){var t=this.controlFactoryProxy;return t.getCmp.call(t,e)},_getLayoutXType:function(e){var t=this.isFlowForm(e);return t?"kdflowlayoutpanel":"panel"},_menuMetaData:function(e,t){var i=!1,a=this.isFlowForm(e.billMetaData),n=this.getHostWindowProxy(),o=n&&n.isMainTab,r=o?e.innerTitleMetaData:void 0,s=!!r,l=e.menuMetaData,d=0;if(r&&($.extend(r,{id:this.innerTitleKey,xtype:"formtitlebar",x:0,y:0,zindex:0,tabIndex:0,width:700,height:r.istitlevisble?40:0,ctOrientation:a?"vertical":"",dock:a?KD.dock.None:KD.dock.Fill,visible:r.istitlevisble,fromClient:!1}),d+=r.height),l){l.items&&l.items.length>0&&(l.items[0].ismainmenu=!0,l.items[0].actionKey="MainBarItemClick",this.mainMenuKey=this.billMenuKey+"_"+l.items[0].id),i=!0,$.each(l.items,function(e){e.imagepath=l.imagepath});var c=0;for(var h in l.items){var u=l.items[h];u.xtype="kdmenubar",u.id=this.billMenuKey+"_"+u.id,u.height=this.mainMenuBarHeight,u.visible&&(c+=this.mainMenuBarHeight)}$.extend(l,{id:this.billMenuKey,xtype:this._getLayoutXType(e.billMetaData),ctOrientation:a?"vertical":"",dock:a?KD.dock.None:s?KD.dock.Bottom:KD.dock.Top,fromClient:!1,height:c}),d+=c}if(void 0===r)l&&t.items.push(l);else if(a)r&&t.items.push(r),l&&t.items.push(l);else{var p={id:this.innerTitleContainerKey,xtype:"panel",dock:KD.dock.Top,tabIndex:0,x:0,y:0,zindex:0,style:0,hscroll:0,vscroll:0,layout:"kdlayout",border:!1,width:700,InlineStyle:{overflow:"visible","overflow-x":"visible","overflow-y":"visible"},height:d||1,items:[]};r&&p.items.push(r),l&&p.items.push(l),p&&t.items.push(p)}return i},_billMetaData:function(e,t){var i=this,a=e.billMetaData;KDFlowlayoutProxy.isFlowlayoutChild(i.dformConfig);if(a){a.xtype?(t.xtype=a.xtype,a.dock?t.dock=a.dock:(t.dock=i.getIsMain()?KD.dock.Fill:t.dock||0,a.dock=KD.dock.Fill)):(t.xtype="kdform",t.id=i.getPageId(),a.dock?t.dock=t.isFlowLayout?0:a.dock:(t.dock=i.getIsMain()?KD.dock.Fill:t.dock||0,a.dock=KD.dock.Fill),t.x=0,i.dformConfig.left&&(t.x=i.dformConfig.left,a.x=i.dformConfig.left),t.y=0,i.dformConfig.top&&(t.y=i.dformConfig.top,a.y=i.dformConfig.top),t.height=i.dformConfig.height,t.width=i.dformConfig.width,t.minHeight=i.dformConfig.minHeight,t.maxHeight=i.dformConfig.maxHeight);var n=i.isFlowForm(a),o=KD.isGalaxyFormTheme(this.dformConfig.FormTheme)?"kd_bill_"+this.dformConfig.FormTheme+"_RootPanel":"",r="";this.dformConfig&&this.dformConfig.IsGrandTitle&&this.dformConfig.openstyle.ShowType==KDDynamicFormShowType.Modal&&(r=i.dformConfig.billTitle),$.extend(a,{id:i.rootPanelKey,Stylekey:"kd_bill_RootPanel "+o,xtype:i._getLayoutXType(a),orientation:n?"vertical":"",ctOrientation:n?"vertical":"",formid:i.dformConfig.formid,billTitle:i.dformConfig.billTitle,modelTitle:r,fromClient:!0,isFlowForm:n,isMain:i.getIsMain(),mainMenuBarHeight:i.mainMenuBarHeight,dock:n?KD.dock.None:KD.dock.Fill}),t.isFluid||(KD.writeLogTime(i.dformConfig.formid+" Meta Data Sort Begin:","",!0),i._sortMetaConfigItems(a),KD.writeLogTime(i.dformConfig.formid+" Meta Data Sort End  :","",!0)),this.metaFlowConverter=new KDMetaDataFlowConverter(a),a=this.metaFlowConverter.getFlowMetaData(),t.items.push(a),i._debugControl(a),i._billMetaData_dashboard(e,t),n&&KDFloatingManager.instance.registerPage(i.getPageId())}return a},_sortMetaConfigItems:function(e){if(e&&e.items){"panel"==e.xtype&&(e.items=KD.quickSort(e.items,"zindex"));for(var t in e.items)this._sortMetaConfigItems(e.items[t])}},_debugControl:function(e){return},_debugFlowConsoleInfoPanel:function(e){if(e&&e.items)for(var t=0;t<e.items.length;t++){var i=e.items[t];"FINFOPANELCONTAINER"==i.id&&$.extend(i,{xtype:"kdflowlayoutpanel",orientation:KDFlowlayoutProxy.vertical})}},_billMetaData_dashboard:function(e,t){var i=this;if(i.hasDashBoard(e.dashBoardMetaData)){i.layoutSettings=KD.isEmpty(i.dformConfig.fluidSettings)?KD.parseObject(i.dformConfig.setting)||[]:[];var a={};for(var n in i.layoutSettings){var o=i.layoutSettings[n];if(null!=o&&o.length>1){var r=o[0];if(r==i.billDashBoardKey){var s=(o[1]||{}).items,l=KD.isArray(s)?s:[];for(var d in l)l[d].targetKey&&(a[l[d].targetKey]=l[d].expand);break}}}var c=e.dashBoardMetaData.items,h={};for(var n in c){var u=c[n];u.targetKey=(u.targetKey||"").toUpperCase(),h[u.targetKey]=u.expand,void 0!==a[u.targetKey]&&(u.expand=a[u.targetKey],h[u.targetKey]=a[u.targetKey])}for(var p={xtype:"kdbilldashboard",id:i.billDashBoardKey,items:c,expand:!1,visible:!0},g=0,f=0;f<t.items.length;f++){var m=t.items[f]||{};if(KD.equalsIgnoreCase(m.id,this.innerTitleKey))g=f+1;else if(KD.equalsIgnoreCase(m.id,this.billMenuKey)){g=f+1;break}}t.items.splice(g,0,p),t.dashboardInitExpand=h}},loadConfig:function(e){var t=this;t.setBusy(!0,function(e){KD.delayInvoke(function(){t.setBusy.call(t,!1)})}),(this.dformConfig||e).isUseSmallScreenModel&&(t.mainMenuBarHeight=30,t.anchorPointProxyHeight=32),t.initChangeData();var i=t.server.pageId;i&&(i=i.replace("$$","")),this.baseId=i,KD.layout.setCtOrientation(t.dformConfig,t.ctOrientation),KD.layout.setCtOrientation(e,t.ctOrientation);var a={id:t.getPageId(),ctOrientation:t.ctOrientation,fromClient:!0,xtype:"kdform",dock:t.dformConfig.dock,isFlowForm:t.isFlowForm(e.billMetaData),items:[],inlineStyle:t.dformConfig.openstyle?t.dformConfig.openstyle.InlineStyleCss||{}:{}};this.fireControlFocusEvents=this.fireGotFocus=1==KD.getValue(e,"FireCellFocuedEvent",0)?!0:!1,e=KDFormMetaFluidConverter(t.dformConfig,a,e),t.hasMenu=t._menuMetaData(e,a);var n=t._billMetaData(e,a);t.el.attr("data-kdformid",t.getFormId());var o={};1==t.isTabChildForm&&n&&0==n.isFlowForm&&t.isInFlowlayoutForm()&&($.extend(o,{height:t.metaHeight,width:t.metaWidth}),t.el.parent().css({height:t.metaHeight,width:t.metaWidth}));var r=t.controlFactoryProxy;r.createAllProxyInstance.call(r,a),KDDynamicFormProxyBase.superclass.loadConfig.call(t,a),t.mainMenuKey&&(t.mainMenu=t.getControlProxy(t.mainMenuKey)),null!=t.formLoaded&&t.formLoaded(t,new Object),t.loadLayoutSetting(t.dformConfig.setting),t.getIsMain()&&($.extend(o,{height:"auto",width:"auto"}),n&&n.isFlowForm&&($("#MainPanel")[getPropName()]("data-isflowform","true"),$("#MainPanel").css({height:"auto"}))),t.isInFlowlayoutForm()&&($.extend(o,{height:"auto","min-height":a.minHeight?a.minHeight:a.height}),this.dformConfig.openstyle&&this.dformConfig.openstyle.ShowType==KDDynamicFormShowType.NewTabPage&&this.isFlowForm(this.config||this.dformConfig)&&this.hostWindowProxy&&this.hostWindowProxy.doLayoutInnerForFlowForm&&(this.hostWindowProxy.doLayoutInnerForFlowForm.call(this.hostWindowProxy),this.hostWindowProxy.onFlowFormScroll&&this.hostWindowProxy.onFlowFormScroll.call(this.hostWindowProxy,this))),void 0!=t.dformConfig.maxHeight&&t.dformConfig.maxHeight>0&&$.extend(o,{"max-height":t.dformConfig.maxHeight}),t.isPopUpFlowForm(n)&&($.extend(o,{height:"auto"}),t.onFlowWindowScroll()),t.el.css(o),n&&KDFlowlayoutProxy.setFlowFormOverFlow(t,n),t.mainMenu&&t.mainMenu.resetOverflow&&t.mainMenu.resetOverflow(),t.getIsMain()&&KDDynamicFormProxy.attachMainFormParent(t),t.el&&t.el.css&&parseInt(t.el.css("margin-left"))>0&&t.doLayout()},hasDashBoard:function(e){return e&&e.items&&e.items.length>0},isFlowForm:function(e){return this.el.isFlowForm||this._isFlowForm(e)},_isFlowForm:function(e){var t=e;if(!t)return!1;if(void 0!==t.isFlowForm)return t.isFlowForm;var i=0,a=!1;for(var n in t.items){var o=t.items[n];KDDynamicFormProxy.exclueTypesJudgeFlow[o.xtype]||i++}if(t.items&&1==i){var o=t.items[0];KDFlowlayoutProxy.isFlowlayout(o)&&(o.isFormOnlyChild=!0,
a=!0)}return t.isFlowForm=a,a},isInFlowlayoutForm:function(){return KDFlowlayoutProxy.vertical==this.ctOrientation||KDFlowlayoutProxy.column==this.ctOrientation},isPopUpFlowForm:function(e){var t=this,i=!1;if(!t.isMain)switch(t.dformConfig.openstyle.ShowType){case KDDynamicFormShowType.Default:case KDDynamicFormShowType.Floating:case KDDynamicFormShowType.NonModal:case KDDynamicFormShowType.Modal:case KDDynamicFormShowType.FloatingAutoHide:i=e?t.isFlowForm(e):t.config.isFlowForm}return i},getBillControlsPanel:function(){return this.getControlProxy(this.rootPanelKey)},loadMainMenu:function(e){},onBodyMainKeyDown:function(e){if(e){var t,i=e.keyCode||e.which||e.charCode;116==i&&KD.IsF5RefreshToMainConsole()&&(t={},t.actionTime=new Date,t.keyCode=i,t.isdispose=!1,KD.storage.setItem(KD.CONST.F5RefreshEventParameterName,KD.stringify(t)),KD.delayInvoke(function(){KD.storage.removeItem(KD.CONST.F5RefreshEventParameterName)},5e3,!0))}},onBodyMainClick:function(e){this.getIsMain()&&this.onBodyClick(e)},onBodyClick:function(e){var t=this.controlFactoryProxy.forms;for(var i in t){var a=t[i];a&&a.onBodyClick&&a.onBodyClick.call(a,e)}var n=this.getControlProxy(this.billDashBoardKey);n&&n.onBodyClick&&n.onBodyClick.call(n,e)},_lastWinOffset:{top:0,left:0,deta:3},getScrollOffsetDeta:function(){return this._lastWinOffset?this._lastWinOffset.deta||3:3},onBodyMainScroll:function(e){if(1!=KD.CONST.IsBillHeadFloat&&this.getIsMain()){var t={top:$(window).scrollTop(),left:$(window).scrollLeft()},i=this.getScrollOffsetDeta(),a=t.top-this._lastWinOffset.top,n=t.left-this._lastWinOffset.left;(a>i||-1*i>a||n>i||-1*i>n)&&($.extend(this._lastWinOffset,t),this.onBodyScroll(e,t))}},onHostWindowProxyScroll:function(e){e=e||{};var t={top:$(e.target).scrollTop(),left:$(e.target).scrollLeft()},i=this.getScrollOffsetDeta(),a=t.top-this._lastWinOffset.top,n=t.left-this._lastWinOffset.left;(a>i||-1*i>a||n>i||-1*i>n)&&($.extend(this._lastWinOffset,t),this.onBodyScroll(e,t))},_lastModelWinOffset:{top:0,left:0,deta:1},onFlowWindowScroll:function(){var e=this;this.hostWindowProxy&&this.hostWindowProxy.el&&this.hostWindowProxy.el.childFormCt&&e.hostWindowProxy.el.childFormCt.css({overflow:"auto"}).attr("allowscrollaction","true").off("scroll").on("scroll",function(t){var i={top:$(this).scrollTop(),left:$(this).scrollLeft(),isFromPopupWin:!0},a=e._lastModelWinOffset.deta,n=i.top-e._lastModelWinOffset.top,o=i.left-e._lastModelWinOffset.left;(n>a||-1*a>n||o>a||-1*a>o)&&($.extend(e._lastModelWinOffset,i),e.onBodyScroll(t,i))})},onBodyScroll:function(e,t){var i=this.controlFactoryProxy.forms;for(var a in i){var n=i[a];n&&n.onBodyScroll&&n.onBodyScroll.call(n,e,t)}var o=this.controlFactoryProxy.getMenuBars.call(this.controlFactoryProxy);for(var a in o){var r=o[a];r.onScroll&&r.onScroll.call(r,e,t)}var s=this.getControlProxy(this.billDashBoardKey);s&&s.onScroll&&s.onScroll.call(s,e,t);var l=this.getControlProxy(this.floatErrMsgId);l&&l.onScroll&&l.onScroll.call(l,e,t);var d=this.getControlProxy(this.floatTipMsgId);d&&d.onScroll&&d.onScroll.call(d,e,t);var c=this.controlFactoryProxy.getGrids.call(this.controlFactoryProxy);for(var a in c){var h=c[a];h.onScroll&&h.onScroll.call(h,e,t)}},recalcGridsVScroll:function(){var e=this.controlFactoryProxy.getGrids.call(this.controlFactoryProxy);for(var t in e){var i=e[t];i.recalcVScroll&&i.recalcVScroll.call(i)}}})}(),define("KDDynamicFormProxyBase",["KDDynamicFormProxyBase_Server","KD"],function(e){return function(){var t;return t||e.KDDynamicFormProxyBase}}(this)),function(e){e.fn.KDPanel=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDPanel.prototype,e.fn.KDControlBase.defaults,e.fn.KDPanel.defaults,t);return this.fw=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDPanel.prototype={getType:function(){return"KDPanel"},getContent:function(){return this.fw},addControl:function(e){var t=this,i=this.layoutPanel;if(this.isMain){var a=e.dock&&this.dockFrameWork&&this.dockFrameWork.fw?this.dockFrameWork.fw[e.dock]:void 0;this.isDockChildren&&e.dock&&a?e.appendTo(a):e.appendTo(this.getContent())}else if(i&&(e.dock||i.existFill.call(i,t)))i.addControl.call(i,e,t);else{var a=this.getContent();a.ready(function(){}),e.appendTo(this.getContent())}},absPos:function(e){var t=y=0;do t+=e.offsetLeft,y+=e.offsetTop;while(e=e.offsetParent);return{x:t,y:y}},applyFormPosition:function(t){var i={padding:"0px",margin:"0px",position:"relative"};if(t.dock&&t.dock!=KD.dock.None){var a=t.InlineStyle,n=a&&KD.stringify(a).toLowerCase().indexOf("border")>0?2:0,o=this.parent(),r=KD.layout.isRelativeHeight(o)?KD.layout.getActualHeight(o):KD.layout.getRealStyleNumberProp(o,"height",n),s=KD.layout.isRelativeWidth(o)?KD.layout.getActualWidth(o):KD.layout.getRealStyleNumberProp(o,"width",n),l=KD.isNumber(r)?r:parseInt((r||"").replace(/px/g,"")),d=KD.isNumber(s)?s:parseInt((s||"").replace(/px/g,"")),c=KD.layout.getRangeSize(KD.layout.getTargetRangeProp(o,"padding")),h=KD.layout.getRangeSize(KD.layout.kdRangeSize2HTMLRangeSize(t.margin)),u=KD.layout.getRangeSize(KD.layout.kdRangeSize2HTMLRangeSize(t.padding)),p={height:c.top+c.bottom+u.top+u.bottom+h.top+h.bottom,width:c.left+c.right+u.left+u.right+h.left+h.right},g=this.css("border-top-width").replace("px",""),f=this.css("border-bottom-width").replace("px","");switch(p.height=p.height+parseInt(g)+parseInt(f),t.dock){case KD.dock.Fill:i=e.extend(i,{height:l-p.height,width:d-p.width});break;case KD.dock.Top:case KD.dock.Bottom:i=e.extend(i,{height:t.height?t.height-p.height:0,width:d-p.width});break;case KD.dock.Left:i=e.extend(i,{width:t.width?t.width-p.width:0,height:l-p.height,"float":"left"});break;case KD.dock.Right:i=e.extend(i,{width:t.width?t.width-p.width:0,height:l-p.height,"float":"right"})}}else i=e.extend(i,{height:KD.layout.isPixelValue(t.height)?t.height+"px":"100%",width:KD.layout.isPixelValue(t.width)?t.width+"px":"100%"});KDLayout.isNeedFixed||("100%"==i.height&&delete i.height,"100%"==i.width&&delete i.width),this.css(i)},setHTML:function(e){var t=this.getContent();t.hide(),t&&t.empty&&t.empty(),t.html(e),t.show("slow")},loadConfig:function(t){var i=this;if(i.applyFormPosition(t),KD.setAttachmentData(i,t),KD.layout.setAbsolute(i,t),"headpanel"!=t.xtype&&"richstackpanel"!=t.xtype){this.isDockChildren=!1;for(var a in t.items){var n=t.items[a];if(KD.layout.isDock(n)){i.isDockChildren=!0;break}}i.style=t.style,i.hscroll=t.hscroll,i.vscroll=t.vscroll,i.border=t.border,i.backgroundimage=t.backgroundimage,i.ImageShowStyle=t.ImageShowStyle,i.zindex=t.zindex;var o={};if(0==i.hscroll&&(o["overflow-x"]="hidden"),0==i.vscroll&&(o["overflow-y"]="hidden"),i.hscroll&&"1"==i.hscroll&&(o["overflow-x"]="scroll"),i.vscroll&&"1"==i.vscroll&&(o["overflow-y"]="scroll"),0!=o.length&&i.getContent().css(o),i.isDockChildren)if(i.isMain);else{var r=i.layoutPanel=new KDLayout,s=i.proxy?i.proxy.baseId:"";i.id=s;var l=e.extend({},t,{xtype:"kdlayoutpanel",id:s+"_layout",dock:5});i.layoutOptions=r.loadConfig.call(r,l,i)}else KDLayout.isNeedFixed&&i.getContent().css({height:"inherit",width:"100%"});return"hidden"==i.getContent().css("overflow")&&(null==i.getContent().css("width")||"0px"==i.getContent().css("width"))&&(t.dock!=KD.dock.Top&&t.dock!=KD.dock.Bottom&&t.dock!=KD.dock.Fill?i.getContent().css({width:t.width}):i.getContent().css({width:"100%"})),i.ready(function(){i.isReady=!0}),i.layoutOptions}},doLayout:function(e){var t=e||this.layoutOptions,i=this.layoutPanel;if(t)if(t.dock!=KD.dock.None||e&&KDFlowlayoutProxy.isInVertical(e))if(i)i.doLayout.call(i,t,this);else{var a=this.parent(),n=KD.layout.getRangeSize(KD.layout.getTargetRangeProp(a,"padding")),o=KD.layout.getRangeSize(KD.layout.getTargetRangeProp(this,"margin")),r=KD.layout.getRangeSize(KD.layout.getTargetRangeProp(this,"padding")),s={height:n.top+n.bottom+r.top+r.bottom+o.top+o.bottom,width:n.left+n.right+r.left+r.right+o.left+o.right},l=this.css("border-top-width").replace("px",""),d=this.css("border-bottom-width").replace("px","");if(s.height=s.height+parseInt(l)+parseInt(d),a&&a.length){var c={};switch(t.dock){case KD.dock.Left:case KD.dock.Right:var h=KD.layout.getActualHeight(a)-s.height;this.css({width:t.width-s.width,height:h});break;case KD.dock.Top:case KD.dock.Bottom:var u=KD.layout.getActualWidth(a)-s.width;this.css({width:u,height:t.height-s.height});break;case KD.dock.Fill:var u=KD.layout.getActualWidth(a)-s.width,h=KD.layout.getActualHeight(a)-s.height;this.css({width:KDLayout.getInnerPixels(u),height:KDLayout.getInnerPixels(h)});break;case KD.dock.FieldSet:e.height&&(c.height=e.height),e.width&&(c.width=e.width),this.css(c)}}}else"kdform"==t.xtype&&i&&!KDFlowlayoutProxy.isFlowlayoutChild(t)&&i.doLayout.call(i,t,this)},setVisible:function(e){var t=this;0==e?t.css("display","none"):t.css("display","block")}},e.fn.KDPanel.defaults={isMain:!1,metaHtml:"",defaults:{}}}(jQuery),define("KDPanel",["KD"],function(e){return function(){var t;return t||e.KDPanel}}(this)),KDDynamicFormProxy=KD.extend(KDDynamicFormProxyBase,{isNavigated:!0,formLoaded:null,initiControlFactoryProxy:function(){var e=new KDControlFactoryProxy;return e.setParentFormProxy(this),this.controlFactoryProxy=e,e},initElementByContainerProxy:function(e,t){var i=this;KDDynamicFormProxy.superclass.initElementByContainerProxy.call(i,e,t),i.el.attr({tabindex:"0"}),i.el.off("keydown").on("keydown",function(e){i.onDynamicFormKeyDown.call(i,e)}),i.el.off("keyup").on("keyup",function(e){i.onDynamicFormKeyUp.call(i,e)})},navigateInput:function(e,t){var i=this,a=null,n=null,o=function(e){var t=$(e).parents(".k-content").first();if(!t.hasClass("k-state-active")){var i=t.find(".k-state-active");return i.length>0?!0:!1}return!0},r=function(e,t){var i=$(e).parents(".kdItemContainer_editorct").parent().data("attdata"),a=$(t).parents(".kdItemContainer_editorct").parent().data("attdata");return i&&a&&void 0!=i.tabIndex&&void 0!=a.tabIndex?i.tabIndex-a.tabIndex:0},s='.k-input:not(table[role="grid"] td input, table[role="grid"] th input), input[data-role="kdtextfield"]:not(table[role="grid"] td input, table[role="grid"]  th input),textarea:not(table[role="grid"] td textarea, table[role="grid"]  th textarea), .k-textbox:not(table[role="grid"] td .k-textbox, table[role="grid"]  th .k-textbox)';"kdformforflex"==this.getXType()&&(s+=",.k-button:not(.k-state-disabled)");var l=this.el.find(s).filter(function(e,t){return o(t)}).sort(r);if(0==l.length&&l.prevObject&&l.prevObject.length>0&&(l=l.prevObject.sort(r)),t||0===t?a=t:$.each(l,function(t,i){$(i)[0]==$(e)[0]&&(a=t)}),null!=a){if(a+1==l.length){var d=i.controlFactoryProxy.getGrids();if(d&&d.length>0){var c=d[0],h=c.component&&c.component.find('tbody tr td[role="gridcell"]').filter(function(t,i){var a=$(e).parents(".k-content").first();return a.hasClass("k-state-active")?$(i).find(".k-state-disabled").length>0||$(i).find(".k-gridCellstate-disabled").length>0?!1:!0:!1});return void c.editCell(h&&$(h[0]))}}n=l.length-(a+2)>=0?a+1:0;var u=l[n];if(this.isDisabledCtl(u))this.navigateInput(e,n);else{var p=$(u);"SPAN"==u.tagName?p.find("input").focus().select():(p.focus(),"TEXTAREA"!=u.tagName&&p.select())}}},navigateTD:function(e,t,i,a,n){var o=this,r=null,s=null,l=function(e){var t=$(e).parents(".k-content").first();return t.hasClass("k-state-active")?!0:!1},d=o.el.find('tbody tr td[role="gridcell"]').filter(function(e,t){return l(t)});if(i||0===i?r=i:$.each(d,function(t,i){$(i)[0]==$(e)[0]&&(r=t)}),null==r)return!1;var c=function(e,t){if($(t).find(".k-state-disabled").length>0||$(t).find(".k-gridCellstate-disabled").length>0)return!1;var i=$("[data-field]",t).data();return t&&t.focus&&!KD.isEmpty(i)?("TD"==t.tagName?$.each(o.controlFactoryProxy.getGrids(),function(n,o){o.el.find(e).length>0&&o.closeEditCell($(e)),o.el.find(t).length>0&&(KD.delayInvoke(function(){o.setLastNavigateTD({rowId:i.rowid,field:i.field,isEnterJump:a})}),a?(o.editCell($(t)),$(t).find("input.k-input").first().select(),i.role&&"checkbox"==i.role&&($(t).find("input").first().focus().select(),o.onGridCellFocus.call(o))):o.getKendoGrid().current($(t)))}):$(t).focus(),!0):void 0};return s=n?r-1:d.length-(r+2)>=0?r+1:-1,t||(t=r),0>s?!0:void(c(d[t],d[s])||o.navigateTD(e,t,s,a,n))},onDynamicFormKeyUp:function(e,t,i){e.keyCode||e.which||e.charCode},onDynamicFormKeyDown:function(e){var t=this,i=e.keyCode||e.which||e.charCode,a=9==i?!0:!1;if((13==i||a)&&t.isNavigated){if(a&&(e.preventDefault(),KD.stopPropagation(e)),"BOS_HtmlConsoleMain"==t.getFormId())return;if(0==$(e.target).parents('table[role="grid"]').length){if(t.isUnNaviCtl(e.target,a))return;t.navigateInput(e.target)}}else if(122==i)t.onF11Click(e);else if(112==i)e.preventDefault(),e.stopPropagation(),t.onF1Click();else if(e&&e.altKey&&e.shiftKey&&e.ctrlKey){if(77==i||KD.equalsIgnoreCase(e.key,"M")){KD.stopPropagation(e);var n={};n.TargetKey="",n.TargetPageId=this.getPageId(),n.Key="Control+Alt+Shift+M",this.fireCustomEventsNoData.call(this,"Kingdee.BOS.ExecuteShortcut","Kingdee.BOS.ExecuteShortcut",KD.stringify(n))}}else if(e&&e.shiftKey&&e.ctrlKey){if(83==i||KD.equalsIgnoreCase(e.key,"S")){KD.stopPropagation(e);var n={};n.TargetKey="",n.TargetPageId=this.getPageId(),n.Key="Control+Shift+S",this.fireCustomEventsNoData.call(this,"Kingdee.BOS.ExecuteShortcut","Kingdee.BOS.ExecuteShortcut",KD.stringify(n))}}else if(e&&e.ctrlKey&&e.altKey)if(75==i||KD.equalsIgnoreCase(e.key,"k")){KD.stopPropagation(e);var n={};n.Key="Control+Alt+K",this.ShowCVPAllFieldData(!1,n)}else if(80==i||KD.equalsIgnoreCase(e.key,"p")){KD.stopPropagation(e);var n={};n.Key="Control+Alt+K",this.ShowCVPAllFieldData(!0,n)}if(e&&KD.isCombinationOrFunctionKey(e)){var o=this.getControlProxy(this.mainMenuKey);KD.isEmpty(o)||o.setBillsFullKeyBoardAction.call(o,e)}},onF11Click:function(e){var t=ClientAppProxy.Current.getMainTab()||{};e&&t.toggleFullScreenBtn&&t.toggleFullScreenBtn.trigger&&KD.isChrome()&&(e.preventDefault(),KD.stopPropagation(e),t.toggleFullScreenBtn.trigger("click"))},onF1Click:function(e){var t=this;if(!e){var i=t.el.find(".kd-mouseover-el:hover").last();if(i.length>0){var a=i.attr("id").substring(0,36);if(t.getPageId().indexOf(a)<0&&0==i.parents('.ui-form[data-kdformid="BOS_INFOFLOWLAYOUTPANEL"]').length)return;var n=i.data("attdata"),o=t.controlFactoryProxy.getCmp(n.id);switch(n.xtype){case"navibar":var r=$(".kd-consoleFunction-btn:hover");e=r&&r.attr("title")||"";break;case"kditemcontainer":case"bosf7field":e=o.config.labelText;break;case"togglebutton":e=o.config.text||o.tooltip;break;default:e=""}}}e=e?e.replace(">",""):"";var s=t.getFormProxy();s.fireEvent.call(s,"F1Click",e)},isUnNaviCtl:function(e,t){var i=$(e).parents(".kdItemContainer_editorct").children().first(),a=i.data("attdata");if("kdformforflex"==this.getXType()&&KD.isEmpty(a)){var a=$(e).parents(".kd-navigate-button").data("attdata");if(a&&!t)return!0}if(!a)return!0;var n=["kdmultilingualdynamictext","kdlangtextarea","kdlargetexttips","kdrichedit","kddynamictextfield","kdtextarea","kdtextareaext"];if(!t&&n.indexOf(a.xtype)>=0)return!0;var o=$(e).parents(".kdItemContainer_editorct").hasClass("kdQuickFilterContainer_editorct");return o},isDisabledCtl:function(e){var t=$(e).parents(".kdItemContainer_editorct").children().first(),i="on"==$(e).attr("unselectable")||$(e).hasClass("k-state-disabled")||$(e).find(".k-state-disabled").length>0;return i?!0:"none"==t.css("display")},onAfterControlCreate:function(e){},onAfterControlInited:function(e){},onBeforeDoActions:function(e){},onAfterDoActions:function(e){},getBaseId:function(){return this.server.pageId},setIsMain:function(e){this.isMain=e},getIsMain:function(){return this.isMain},setDock:function(e){this.dock=e},isNeedFlowMetaSort:function(){return this.dformConfig&&0!=this.dformConfig.isNeedFlowMetaSort},loadFormControls:function(e){var t=this;if(!this.controlFactoryProxy)return void KD.Error.raise({sourceClass:"KDDynamicFormProxy",sourceMethod:"loadFormControls",msg:"this.controlFactoryProxy is null!"});t.baseId=t.el.baseId=this.getBaseId(),t.el.attr("data-kdid",t.baseId);var i=t.el.loadConfig(e),a=JSON.stringify(i);i=KD.parseObject(a),t.el.addClass("kdform");var n=e.items;if(null!=n){var o=t.controlFactoryProxy;for(var r in n){var s=n[r],l=o.createControl.call(o,s);t.el.addControl(l.getControl()),l.initComponent(),this.onAfterControlInited(l)}}null!=t.formLoaded&&t.formLoaded(this,new Object),t.doLayout(i)},createControl:function(e){var t=this,i=e||{};return this.el=$("<div></div>"),i.dock==KD.dock.Fill?t.el.css({height:"inherit",width:"auto"}):t.getIsMain()?t.el.css({height:"inherit",width:"auto"}):t.el.css({height:i.height,width:i.width}),t.el.addClass("ui-form wform kdform"),t.el.isFlowForm=i.isFlowForm,t.el=i.isFlowForm?KDFlowlayoutProxy.flowElement(t.el):t.el.KDPanel(),t.el.isMain=t.getIsMain(),t.el.undelegate("input","keyup").delegate("input","keyup",function(e){e.ctrlKey&&e.altKey&&120==e.keyCode&&(KD.stopPropagation(e),t.onExecCommand.call(t,e))}),t.el},setSize:function(e){this.el.css(e),$.extend(this.config,e),this.layoutOptions=$.extend(this.layoutOptions||{},e),this.doLayout()},doLayout:function(){this.config&&KDDynamicFormProxy.superclass.doLayout.call(this)},comboBoxSelectionChanged:function(e,t){if(t)for(var i=t.current,a=this.controlFactoryProxy,n=0;n<e.changeListeners.length;n++){var o=a.getCmp.call(a,e.changeListeners[n]);o&&o.setGroups(i)}},setAttachContent:function(e){var t=(this.controlFactoryProxy.formProxy.getBaseId(),(new DFormConfig).loadConfig(e[0])),i=this.controlFactoryProxy;if(!i.controls[t.id.toUpperCase()]){var a=i.createControl(t),n=a.getControl();a.initComponent(),a.loadConfig(a.config),this.el.append(n)}},deactivated:function(e){var t=this.controlFactoryProxy||{},i=t.forms||[],a=this.dformConfig||{},n=a.openstyle||{},o=n.ShowType==KDDynamicFormShowType.Floating||n.ShowType==KDDynamicFormShowType.Default||n.ShowType==KDDynamicFormShowType.ModalInCurrentForm,r=this.getControlProxy(this.floatTipMsgId)||this.getControlProxy(this.floatErrMsgId);if(r&&KD.isFunction(r.onDeactivated)&&r.onDeactivated.call(r),a.isFluid){var s=this.getControlProxy(e.key||"");t&&KD.isFunction(t.setActivate)&&t.setActivate.call(t,!1,s)}else t&&KD.isFunction(t.setActivate)&&t.setActivate.call(t,!1);for(var l=0;l<i.length;l++){var d=i[l]||{},c=$.extend(KD.cloneObject(e),{isChildForm:!0});d&&KD.isFunction(d.deactivated)&&d.deactivated.call(d,c)}if(e.isChildForm&&this.hostWindowProxy&&o){var h=this.hostWindowProxy;(!h.el.is(":hidden")||h.el.collapseStateEl&&h.el.collapseStateEl.is(":visible"))&&(h.tabDeativeHidden=!0,h&&h.hideWindow&&h.hideWindow.call(h,!0))}},activated:function(e){var t=this.controlFactoryProxy||{},i=t.forms||[],a=this.dformConfig||{},n=a.openstyle||{},o=n.ShowType==KDDynamicFormShowType.Floating||n.ShowType==KDDynamicFormShowType.Default||n.ShowType==KDDynamicFormShowType.ModalInCurrentForm,r=this.getControlProxy(this.floatTipMsgId)||this.getControlProxy(this.floatErrMsgId);if(r&&KD.isFunction(r.onActivated)&&r.onActivated.call(r),a.isFluid){var s=this.getControlProxy(e.key||"");t&&KD.isFunction(t.setActivate)&&t.setActivate.call(t,!0,s)}else t&&KD.isFunction(t.setActivate)&&t.setActivate.call(t,!0);if(e.isChildForm&&this.hostWindowProxy&&o){var l=this.hostWindowProxy;l.tabDeativeHidden&&(delete l.tabDeativeHidden,l&&KD.isFunction(l.getIsSpecialForm)&&l.getIsSpecialForm()&&KD.isFunction(l.showWindow)?l.showWindow.call(l,!0):l&&l.show&&l.el.is(":hidden")&&l.show.call(l,!0))}for(var d=0;d<i.length;d++){var l=i[d]||{},c=$.extend(KD.cloneObject(e),{isChildForm:!0});l&&KD.isFunction(l.deactivated)&&l.activated.call(l,c)}},setVisible:function(e){var t=KDDynamicFormProxy.superclass.setVisible.call(this,e);return this.fireHideOrShowCustomEvents(e),t},toFront:function(){var e=this.getHostWindowProxy();e&&e.toFront&&e.toFront()}}),$.extend(KDDynamicFormProxy,{exclueTypesJudgeFlow:{kdwatermark:!0,kdbilldashboard:!0},attachMainFormParent:function(e){document.addEventListener("scroll",function(t){e&&e.onBodyMainScroll&&e.onBodyMainScroll.call(e,t)},!0),document.body.addEventListener("click",function(t){e&&e.onBodyMainClick&&e.onBodyMainClick.call(e,t)},!1),document.body.addEventListener("keydown",function(t){e&&e.onBodyMainKeyDown&&e.onBodyMainKeyDown.call(e,t)},!1)}}),KDControlFactoryProxy.registerType("kdform",KDDynamicFormProxy),KDDynamicFormPluginProxy=KD.extend(KDDynamicFormProxy,{}),define("KDDynamicFormProxy",["KDDynamicFormProxyBase","KDPanel","KD"],function(e){return function(){var t;return t||e.KDDynamicFormProxy}}(this)),kdformMain.prototype.AddBtnForRightMenu=function(e){if(null!=e){var t=kdformMain;t.AddrightMenuConfig=t.AddrightMenuConfig||{};var i=function(){var e=$(this).attr("data-role");t.RbClickFn(e,t.AddrightMenuConfig[e])};if($.isArray(e))for(var a in e){var n=e[a];if(n.name)if(t.AddrightMenuConfig[n.name]=n,"btFeelBack"==n.name&&n.tooltip)$("div[data-role=FaceBack] img",t.RightButtonTemplate).attr("title",n.tooltip);else if("btCloudApp"!=n.name)if("btAnnualReport"!=n.name){var o="<div class='IconDiv dyapprise' data-role='"+n.name+"'><img title='"+n.tooltip+"' src='"+n.img+"'></div><div class='LineDiv'></div>";$(o).prependTo(t.RightButtonTemplate).bind("click",i)}else n.tooltip&&$("div[data-role=btAnnualReport] img").attr("title",n.tooltip),n.iscustomevent&&$("div[data-role=btAnnualReport]").unbind("click").bind("click",i),n.visible&&$("div[data-role=btAnnualReport]").css("display","block");else n.tooltip&&$("div[data-role=btCloudApp] img",t.RightButtonTemplate).attr("title",n.tooltip),n.iscustomevent&&$("div[data-role=btCloudApp]",t.RightButtonTemplate).unbind("click").bind("click",i)}}},define("kdmain",["KDDynamicFormProxy","KD"],function(e){return function(){var t;return t||e.kdmain}}(this));var hexcase=0,b64pad="",chrsz=8,Sha1Encrypt=Sha1Encrypt||{hex_sha1:function(e){return this.binb2hex(this.core_sha1(this.str2binb(e),e.length*chrsz))},b64_sha1:function(e){return this.binb2b64(this.core_sha1(str2binb(e),e.length*chrsz))},str_sha1:function(e){return this.binb2str(this.core_sha1(str2binb(e),e.length*chrsz))},hex_hmac_sha1:function(e,t){return this.binb2hex(this.core_hmac_sha1(e,t))},b64_hmac_sha1:function(e,t){return this.binb2b64(this.core_hmac_sha1(e,t))},str_hmac_sha1:function(e,t){return this.binb2str(this.core_hmac_sha1(e,t))},sha1_vm_test:function(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==this.hex_sha1("abc")},core_sha1:function(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var i=Array(80),a=1732584193,n=-271733879,o=-1732584194,r=271733878,s=-1009589776,l=0;l<e.length;l+=16){for(var d=a,c=n,h=o,u=r,p=s,g=0;80>g;g++){16>g?i[g]=e[l+g]:i[g]=this.rol(i[g-3]^i[g-8]^i[g-14]^i[g-16],1);var f=this.safe_add(this.safe_add(this.rol(a,5),this.sha1_ft(g,n,o,r)),this.safe_add(this.safe_add(s,i[g]),this.sha1_kt(g)));s=r,r=o,o=this.rol(n,30),n=a,a=f}a=this.safe_add(a,d),n=this.safe_add(n,c),o=this.safe_add(o,h),r=this.safe_add(r,u),s=this.safe_add(s,p)}return Array(a,n,o,r,s)},sha1_ft:function(e,t,i,a){return 20>e?t&i|~t&a:40>e?t^i^a:60>e?t&i|t&a|i&a:t^i^a},sha1_kt:function(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514},core_hmac_sha1:function(e,t){var i=this.str2binb(e);i.length>16&&(i=this.core_sha1(i,e.length*chrsz));for(var a=Array(16),n=Array(16),o=0;16>o;o++)a[o]=909522486^i[o],n[o]=1549556828^i[o];var r=this.core_sha1(a.concat(str2binb(t)),512+t.length*chrsz);return this.core_sha1(n.concat(r),672)},safe_add:function(e,t){var i=(65535&e)+(65535&t),a=(e>>16)+(t>>16)+(i>>16);return a<<16|65535&i},rol:function(e,t){return e<<t|e>>>32-t},str2binb:function(e){for(var t=Array(),i=(1<<chrsz)-1,a=0;a<e.length*chrsz;a+=chrsz)t[a>>5]|=(e.charCodeAt(a/chrsz)&i)<<24-a%32;return t},binb2str:function(e){for(var t="",i=(1<<chrsz)-1,a=0;a<32*e.length;a+=chrsz)t+=String.fromCharCode(e[a>>5]>>>24-a%32&i);return t},binb2hex:function(e){for(var t=hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",a=0;a<4*e.length;a++)i+=t.charAt(e[a>>2]>>8*(3-a%4)+4&15)+t.charAt(e[a>>2]>>8*(3-a%4)&15);return i},binb2b64:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",a=0;a<4*e.length;a+=3)for(var n=(e[a>>2]>>8*(3-a%4)&255)<<16|(e[a+1>>2]>>8*(3-(a+1)%4)&255)<<8|e[a+2>>2]>>8*(3-(a+2)%4)&255,o=0;4>o;o++)i+=8*a+6*o>32*e.length?b64pad:t.charAt(n>>6*(3-o)&63);return i}};define("Sha1Encrypt",["KD"],function(e){return function(){var t;return t||e.Sha1Encrypt}}(this)),function(e,t){var i,a,n=window.kendo,o=n.ui,r=o.Widget,s=0,l=0,d=0,c=0,h=0,u=["#2cfecf","#373fdf","#88fe1f","#48d6ff","#b3fcff","#f76cad","#505083","#113a7e","#014050","#ccf3ef","#009437","#8fb300"],p=r.extend({options:{name:"KDLockedView",width:300},init:function(t,i){r.fn.init.call(this,t,i);var a=e('<ul id="lockedViewInputPassword" class="fieldlist"><li id="li_password"><label>'+ResManager.LoadKDString("请设置解锁密码","0991733000004042")+'</label><input class="k-textbox kd-password" placeholder="'+ResManager.LoadKDString("最少输入6位密码","0991733030033337")+'" type="password" style="width: 100%;border: 1px solid #bebec3;height: 23px;" /><span class="k-widget k-tooltip k-tooltip-validation k-invalid-msg" style="display:none"><span class="k-icon k-warning"></span><b id="pwdMsg" style="color:red"></b></span></li><li id="li_repassword"><label>'+ResManager.LoadKDString("再次输入解锁密码","0991733000004043")+'</label><input class="k-textbox k-rePassordword" placeholder="'+ResManager.LoadKDString("再次输入解锁密码","0991733000004043")+'" type="password" style="width: 100%;border: 1px solid #bebec3;height: 23px;" ></input><span class="k-widget k-tooltip k-tooltip-validation k-invalid-msg" style="display:none"><span class="k-icon k-warning"></span><b id="repwdMsg" style="color:red"></b></span></li><li><a href="#" class="k-button kd-ok">'+ResManager.LoadKDString("确定","0991733000003896")+'</a><a href="#" class="k-button kd-cancel">'+ResManager.LoadKDString("取消","0991733000003922")+"</a></li></ul>");this.element=e(t),this.element.append(a).css({width:this.options.width+"px"})},validePassword:function(){var t=e(".kd-password",this.element).val(),i=e(".k-rePassordword",this.element).val();return""==t.trim()&&""==i.trim()?(e("#pwdMsg",this.element).html("").append(ResManager.LoadKDString("请设置解锁密码","0991733000004042")),e("#repwdMsg",this.element).html("").append(ResManager.LoadKDString("请输入确认密码","0991733000004043")),!1):""==t.trim()?(e("#pwdMsg",this.element).html("").append(ResManager.LoadKDString("密码不能为空","0991733000004044")),!1):""==i.trim()?(e("#repwdMsg",this.element).html("").append(ResManager.LoadKDString("确认密码不能为空","0991733000004045")),!1):t.trim().length<6?(e("#pwdMsg",this.element).html("").append(ResManager.LoadKDString("密码长度不能小于6位","0991733000004046")),e(".kd-password",this.element).val(""),e(".k-rePassordword",this.element).val(""),!1):t!=i?(e("#repwdMsg",this.element).html("").append(ResManager.LoadKDString("两次密码输入不一致，请重新输入！","0991733000004047")),e(".kd-password",this.element).val(""),e(".k-rePassordword",this.element).val(""),!1):!0},drawLockedView:function(t){function i(e){return s.Surface.create(t,{type:e})}function a(){for(var e=new l({stroke:{color:"red",width:15,lineCap:"round",lineJoin:"round"}}),t=new r(300,300),i=0;d>i;i++)e.lineTo(t.clone().translate(i*c,0));return e}var o=(n.dataviz,n.geometry),r=o.Point,s=n.drawing,l=s.Path,d=60,c=15,h=a();e(".k-overlay").on("mousemove",function(t){var i=e(this).offset();h.segments[0].anchor().move(t.pageX-i.left,t.pageY-i.top);for(var a=0;d-1>a;a++){var n=h.segments[a].anchor(),o=h.segments[a+1].anchor(),s=n.clone().translate(-o.x,-o.y);s.scale(c/s.distanceTo(r.ZERO)),o.move(n.x-s.x,n.y-s.y)}}).on("mousedown",function(e){h.options.stroke.set("width",2)}).on("mouseup",function(e){h.options.stroke.set("width",20)});var u=i();u.draw(h)},_drawInterval:function(){var t=e.fn.kendoKDLockedView.widget.fn;a.setTransform(1,0,0,1,0,0),t.drawColorsTaps(a),KD.delayInvoke(t._drawInterval,6),d=s,c=l,h++},drawColorsTaps:function(e){e.clearRect(0,0,window.innerWidth,window.innerHeight);for(var t=0;t<i.length;t++){var a=i[t];if(a.update(),e.fillStyle=a.c,e.lineWidth=2,e.strokeStyle="#ffffff",a.segments.length>1){e.beginPath(),e.moveTo(a.segments[0].leftX1,a.segments[0].leftY1);for(var n=0;n<a.segments.length;n++){var o=a.segments[n];e.lineTo(o.leftX1,o.leftY1)}e.lineTo(a.segments[a.segments.length-1].rightX1,a.segments[a.segments.length-1].rightY1);for(var n=a.segments.length-1;n>=0;n--){var o=a.segments[n];e.lineTo(o.rightX1,o.rightY1)}e.closePath(),e.fill(),e.stroke()}if(e.strokeStyle="#ffffff",a.segments.length>=1){var r=a.segments[0].x1,u=a.segments[0].y1,p=a.segments[0].thickness;a.thickness<p&&(p=a.thickness),0>=p&&(p=1e-6),e.beginPath(),e.arc(r,u,p,a.segments[0].lAngle,a.segments[0].rAngle,!1),e.closePath(),e.stroke();var g=a.segments[a.segments.length-1].x1,f=a.segments[a.segments.length-1].y1;p=a.segments[a.segments.length-1].thickness,a.thickness<p&&(p=a.thickness),0>=p&&(p=1e-6),e.beginPath(),e.arc(g,f,p,a.segments[a.segments.length-1].lAngle,a.segments[a.segments.length-1].rAngle,!0),e.stroke(),p=a.thickness-.6,a.thickness<p&&(p=a.thickness),this.fillCircle(a.segments[0].x1,a.segments[0].y1,p),p=a.segments[a.segments.length-1].thickness-.6,a.thickness<p&&(p=a.thickness),this.fillCircle(a.segments[a.segments.length-1].x1,a.segments[a.segments.length-1].y1,p),a.life>0&&(e.fillStyle="#ffffff",this.fillCircle(a.segments[0].x1,a.segments[0].y1,.72*p))}}for(var t=0;t<i.length;t++){var a=i[t];a.ooo&&(i.splice(t,1),t--)}if(h%2==0&&i.length<50){var m=Math.atan2(c-l,d-s)+Math.PI,v=new this.Worm(s,l);i.push(v),s!=d&&l!=c&&(v.heading=m)}},fillCircle:function(e,t,i){0>=i&&(i=0),a.beginPath(),a.arc(e,t,i,0,2*Math.PI,!0),a.closePath(),a.fill()},Marsalia:function(e,t){var i=e||362436069,a=t||521288629,n=function(){return i=36969*(65535&i)+(i>>>16)&4294967295,a=18e3*(65535&a)+(a>>>16)&4294967295,4294967295&((65535&i)<<16|65535&a)};return this.Marsalia.nextDouble=function(){var e=n()/4294967296;return 0>e?1+e:e},this.Marsalia.nextInt=n,this.Marsalia},createRandomized:function(){var e=new Date;return this.Marsalia(e/6e4&4294967295)},PerlinNoise:function(i){function a(e,t,i,a){var n=15&e,o=8>n?t:i,r=4>n?i:12===n||14===n?t:a;return(0===(1&n)?o:-o)+(0===(2&n)?r:-r)}function n(e,t,i){var a=0===(1&e)?t:i;return 0===(2&e)?-a:a}function o(e,t){return 0===(1&e)?-t:t}function r(e,t,i){return t+e*(i-t)}var s,l,d=e.fn.kendoKDLockedView.widget.fn,c=i!==t?d.Marsalia(i):d.createRandomized(),h=new Array(512);for(s=0;256>s;++s)h[s]=s;for(s=0;256>s;s++){var u=h[l=255&c.nextInt()];h[l]=h[s],h[s]=u}for(s=0;256>s;++s)h[s+256]=h[s];this.noise3d=function(e,t,i){var n=255&Math.floor(e),o=255&Math.floor(t),s=255&Math.floor(i);e-=Math.floor(e),t-=Math.floor(t),i-=Math.floor(i);var l=(3-2*e)*e*e,d=(3-2*t)*t*t,c=(3-2*i)*i*i,u=h[n]+o,p=h[u]+s,g=h[u+1]+s,f=h[n+1]+o,m=h[f]+s,v=h[f+1]+s;return r(c,r(d,r(l,a(h[p],e,t,i),a(h[m],e-1,t,i)),r(l,a(h[g],e,t-1,i),a(h[v],e-1,t-1,i))),r(d,r(l,a(h[p+1],e,t,i-1),a(h[m+1],e-1,t,i-1)),r(l,a(h[g+1],e,t-1,i-1),a(h[v+1],e-1,t-1,i-1))))},this.noise2d=function(e,t){var i=255&Math.floor(e),a=255&Math.floor(t);e-=Math.floor(e),t-=Math.floor(t);var o=(3-2*e)*e*e,s=(3-2*t)*t*t,l=h[i]+a,d=h[i+1]+a;return r(s,r(o,n(h[l],e,t),n(h[d],e-1,t)),r(o,n(h[l+1],e,t-1),n(h[d+1],e-1,t-1)))},this.noise1d=function(e){var t=255&Math.floor(e);e-=Math.floor(e);var i=(3-2*e)*e*e;return r(i,o(h[t],e),o(h[t+1],e-1))}},noise:function(e,i,a){var n={generator:t,octaves:4,fallout:.5,seed:t};n.generator===t&&(n.generator=new this.PerlinNoise(n.seed));for(var o=n.generator,r=1,s=1,l=0,d=0;d<n.octaves;++d){switch(r*=n.fallout,arguments.length){case 1:l+=r*(1+o.noise1d(s*e))/2;break;case 2:l+=r*(1+o.noise2d(s*e,s*i))/2;break;case 3:l+=r*(1+o.noise3d(s*e,s*i,s*a))/2}s*=2}return l},Worm:function(t,i){var a=e.fn.kendoKDLockedView.widget.fn;this.x=t,this.y=i,this.lx=t,this.ly=i,this.heading=Math.sin(.083*h)*Math.PI,this.rotation=Math.random()*(Math.PI/(70*Math.random())),this.rate=0,this.maxLength=18+15*a.noise(.0025*h,.1*h),this.detail=3,this.thickness=4,this.thicknessTarget=5+10*Math.random();var n=parseInt(Math.random()*u.length);
this.c=u[n],this.life=30+120*Math.random(),this.segments=new Array,this.ooo=!0,this.counter=a.noise(.1*h,.1*h),this.update=function(){if(this.life--,this.life>0){this.thickness+=.1*(this.thicknessTarget-this.thickness),this.thickness+=.1,this.thickness>this.thicknessTarget&&(this.thickness=this.thicknessTarget),this.heading+=this.rotation,this.rate=Math.cos(this.counter/200)*(10+10*a.noise(.05*h)),this.rotation=Math.sin(this.counter/this.rate)*(this.segments.length+1)*.01,this.counter++;var e=this.segments.length*this.segments.length*this.segments.length*.0015*this.thickness/this.thicknessTarget,t=this.detail+e,i=Math.cos(this.heading)*t,n=Math.sin(this.heading)*t;this.walk(i,n)}else{if(!(this.segments.length>1))return this.thickness*=.95,this.thickness-=.2,void(this.thickness<.1&&(this.ooo=!0));this.segments.pop()}this.ooo=!0;for(var o=0;o<this.segments.length;o++){var r=this.segments[o];if(0==r.ooo()){this.ooo=!1;break}}},this.walk=function(e,t){this.lx=this.x,this.ly=this.y,this.x+=e,this.y+=t;var i=new a.Segment(this.lx,this.ly,this.x,this.y,this.thickness);this.segments.unshift(i),this.segments.length>1&&this.segments[this.segments.length-1].smoothAgainst(this.segments[this.segments.length-2]),this.segments.length>=this.maxLength&&this.segments.pop()}},Segment:function(e,t,i,a,n){this.x1=e,this.y1=t,this.x2=i,this.y2=a,this.thickness=n;var o=Math.atan2(a-t,i-e);this.lAngle=o-.5*Math.PI;var r=Math.cos(this.lAngle)*n,s=Math.sin(this.lAngle)*n;this.leftX1=e+r,this.leftY1=t+s,this.leftX2=i+r,this.leftY2=a+s,this.rAngle=o+.5*Math.PI;var l=Math.cos(this.rAngle)*n,d=Math.sin(this.rAngle)*n;this.rightX1=e+l,this.rightY1=t+d,this.rightX2=i+l,this.rightY2=a+d,this.smoothAgainst=function(e){this.leftX1=e.leftX2=.5*(e.leftX2+this.leftX1),this.leftY1=e.leftY2=.5*(e.leftY2+this.leftY1),this.rightX1=e.rightX2=.5*(e.rightX2+this.rightX1),this.rightY1=e.rightY2=.5*(e.rightY2+this.rightY1)},this.ooo=function(){return this.x1<0||this.y1<0||this.x1>window.innerWidth||this.y1>window.innerHeight||this.x2<0||this.y2<0||this.x2>window.innerWidth||this.y2>window.innerHeight?!0:!1}},hidePopuDiv:function(){var t=this,i=parseInt(ResManager.Language),a=e("#lockedViewInputPassword").closest(".k-window");a.hide();var n=e("<div id='lockedPic' style='background-image:url(.././images/biz/default/AdImages/locksystem_"+i+".png);background-repeat:round;height:100%'></div>");e(".k-overlay").append(n).css("opacity",1).dblclick(function(i){1==e(".k-overlay").css("opacity")&&(a.show(),e(".k-overlay").css("opacity",.99),t.showUnlockedSystem())})},matchPassword:function(){var t=e(".kd-password",this.element).val(),i=Sha1Encrypt.hex_sha1(t),a=this.getLockedInfo();return a.lockedPWD==i?(e(document).off("contextmenu").off("keydown"),!0):(e(".k-invalid-msg",this.element).show(),e("#pwdMsg",this.element).html("").append("<b>"+ResManager.LoadKDString("密码错误！","0991733000004048")+"</b>"),e("<p id='forgetPwd'></p>").css({"margin-top":"5px","text-align":"end",cursor:"pointer","text-decoration":"underline"}).appendTo("#li_password",this.element),e("#forgetPwd").html("").append(ResManager.LoadKDString("忘记密码？请重新登录！","0991733030033336")).click(function(){KDDynamicFormProxyBase_DoAction.prototype.logoff("index.aspx")}),!1)},savePassword:function(){var t=e(".kd-password",this.element).val(),i=Sha1Encrypt.hex_sha1(t),a=KD.storage.getItem("KDLockedSystemInfo")||"{}",n=KD.parseObject(a),o={lockedPWD:i};o[this.isLockedStatusKey]=!0,n[this.getCurrentUserId()]=o,KD.storage.setItem("KDLockedSystemInfo",KD.obj2str(n))},isLocking:function(){var e=this.getLockedInfo();return e&&e[this.isLockedStatusKey]?!0:!1},notPassword:function(){var e=this.getLockedInfo();return e&&e.lockedPWD&&!KD.IsNullOrWhiteSpace(e.lockedPWD)?!1:!0},getCurrentUserId:function(){var e=KD.storage.getItem(KD.CONST.k3CloudLoginInfoKey)||"{}",t=KD.parseObject(e),i=KD.isEmpty(t)?"":t.user;return i},getLockedInfo:function(){var e=KD.storage.getItem("KDLockedSystemInfo")||"{}",t=KD.parseObject(e);if(t&&t[this.getCurrentUserId()]){var i=t[this.getCurrentUserId()];return i}var a={};return a[this.isLockedStatusKey]=!1,a},reset:function(){var e=KD.storage.getItem("KDLockedSystemInfo")||"{}",t=KD.parseObject(e);t[this.getCurrentUserId()]&&delete t[this.getCurrentUserId()],KD.storage.setItem("KDLockedSystemInfo",KD.obj2str(t))},isLockedStatusKey:"LockingStatus",updateLockedStatus:function(e){var t=KD.storage.getItem("KDLockedSystemInfo")||"{}",i=KD.parseObject(t),a=this.getLockedInfo();a[this.isLockedStatusKey]=e,i[this.getCurrentUserId()]=a,KD.storage.setItem("KDLockedSystemInfo",KD.obj2str(i))},showInputPassword:function(t){var i=this;i.popuDiv=this.element.kendoWindow({pinned:!0,draggable:!0,modal:!0,actions:[],title:!1,width:this.options.width,scrollable:!1,resizable:!1,close:function(e){var t=i.element.parent();return t.remove(),!0}}).data("kendoWindow"),i.popuDiv.center(),i.updateLockedStatus(t),t?(i.filterBehavior(),i.hidePopuDiv()):i.popuDiv.open(),e(".kd-ok",this.element).css({width:"4.2em","margin-left":"1.25em","float":"right"}).click(function(e){i.okOrCancelHandler()}),e(document).keydown(function(t){13==t.keyCode&&e("#KDLockedView").is(":visible")&&i.okOrCancelHandler()}),e(".kd-cancel",this.element).css({width:"4.2em","float":"right"}).click(function(t){i.isUnLockedOperate()?(i.hidePopuDiv(),e("#forgetPwd").remove(),e("#lockedPic").remove()):i.popuDiv.close()})},okOrCancelHandler:function(){if(this.isUnLockedOperate())this.matchPassword()&&(this.updateLockedStatus(!1),this.popuDiv.close());else{if(!this.validePassword())return void e(".k-invalid-msg",this.element).show();this.filterBehavior(),this.savePassword(),this.hidePopuDiv()}},isUnLockedOperate:function(){return e("#li_repassword",this.element).is(":visible")?!1:!0},showUnlockedSystem:function(){e(".kd-password",this.element).val("").removeAttr("placeholder"),e(".k-warning","#li_password").after(""),e("#li_repassword",this.element).hide(),e("label:first",this.element).html(ResManager.LoadKDString("请输入解锁密码","0991733000004049")),e("#pwdMsg",this.element).html("").parent().hide()},filterBehavior:function(){e(document).on("contextmenu",function(e){return!1}).on("keydown",function(e){var t=e||window.event;return 37==t.keyCode||39==t.keyCode||115==t.keyCode?(t.keyCode=0,!1):t.ctrlKey&&82==t.keyCode?(t.keyCode=0,!1):(t.shiftKey&&121==t.keyCode&&(t.returnValue=!1),t.altKey&&115==t.keyCode?(t.keyCode=0,t.returnValue=!1,!1):void("A"==window.event.srcElement.tagName&&window.event.shiftKey&&(t.returnValue=!1)))})}});o.plugin(p)}(window.kendo.jQuery);var KDLockedSystem=KDLockedSystem||{};KDLockedSystem.getLockedViewData=function(){var e;if($("#KDLockedView").length>0)e=$("#KDLockedView").data("kendoKDLockedView");else{var t=$("<div class='k-content' id='KDLockedView'></div>");t.appendTo($(document.body));var e=t.kendoKDLockedView({}).data("kendoKDLockedView")}return e},KDLockedSystem.init=function(e){var t=this.getLockedViewData();t.isLocking()?t.showInputPassword(!0):t.element.hide()},KDLockedSystem.show=function(e){var t=this.getLockedViewData();t.isLocking()?t.showInputPassword(!0):!t.isLocking()&&t.notPassword()?t.showInputPassword(!1):t.showInputPassword(!0)},KDLockedSystem.reset=function(){var e=this.getLockedViewData();e.reset(!1),e.element.hide()},define("KDLockedSystem",["KD","Sha1Encrypt"],function(e){return function(){var t;return t||e.KDLockedSystem}}(this));var KDChangeFontSize=KDChangeFontSize||{};KDChangeFontSize.initFontSize=function(){$("body").css({"font-size":KDChangeFontSize.getFontSize()})},KDChangeFontSize.getFontSize=function(){var e=KD.getLocalConfiguration();return e.FontSize||"12px"},KDChangeFontSize.getIntFontSize=function(){var e=this.getFontSize();return parseInt(e.replace("px",""))},define("KDChangeFontSize",["KD"],function(e){return function(){var t;return t||e.KDChangeFontSize}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.Widget,o={MessageDisTime:3,SelectRowBackground:"#E0E8FF",MinusNumColor:"#E74C3C",FontSize:"12px",PrintNoPrompt:!1,UseClientPrinterSetting:!1,IsDefNomalPreviewWindow:!1,IsPreviewAutoSize:!1,FixedTableSelectColumns:!1,IsReadOnlyTextWrap:!1,NotShowUtcOffset:!1,DisabledGridCellBorder:!1,DisabledColReset:!1,CopyGridOrginalValue:!1,EnableListKDVGrid:!1,GridHeadFilterOnlyShowVisData:!1,ThemeChooser:"standard"},r=n.extend({options:{name:"KDUserparamSettingView",width:KD.convertToPX(55)},init:function(t,a){n.fn.init.call(this,t,a);var o=KD.isIeBrowser()?"iefieldlist fieldlist":"fieldlist",r=ResManager.LoadKDString("启用金蝶V表格（Beta版）","0991733000005073").replace("V",'<span class="kd-vgrid-user-flag"></span>'),s=ResManager.LoadKDString("启用后列表和报表将能支持到万行级的大数据应用","0991733000003971"),l=e(i.format('<div id="toolbar"></div><div id="userParamSettingContent" style="height:310px;flex-direction:row;display:flex;flex-wrap:nowrap;overflow-y:auto;"><div style="flex-grow:1; display: inline-block;"><ul class="{0}"><li><label style="display: inline-block; width: '+("1033"==ResManager.Language?"73%":"55%")+'; word-wrap: break-word; word-break: normal;">'+ResManager.LoadKDString("通知信息显示时间(秒)","0991733000004099")+'</label><input type="number" id="MessageDisTime" style="width: '+("1033"==ResManager.Language?"8.3em":"7em")+';" /><span id="MessageDisTimeDsc" title="'+ResManager.LoadKDString("如果数值太小，可能引起提示信息不显示。","0991733000004232")+'"><span class="kd-log"></span></span></li><li><label style="display: inline-block; width: '+("1033"==ResManager.Language?"73%":"55%")+'; word-wrap: break-word; word-break: normal;">'+ResManager.LoadKDString("表格选中行颜色","0991733000004030")+'</label><div id="SelectRowBackground" type="color" style="display: inline-block;"></div></li><li><label style="display: inline-block; width: '+("1033"==ResManager.Language?"73%":"55%")+'; word-wrap: break-word; word-break: normal;">'+ResManager.LoadKDString("负数编辑颜色","0991733000004032")+'</label><div id="NumFieldForeColor" type="color"  style="display: inline-block;"></div></li><li><label style="display: inline-block; width: '+("1033"==ResManager.Language?"73%":"55%")+'; word-wrap: break-word; word-break: normal;">'+ResManager.LoadKDString("主题皮肤","0991733000004100")+'</label><input id="ThemeChooser" style="width: '+("1033"==ResManager.Language?"8.3em":"7em")+';" /></li></ul></div><div style="flex-grow:1; display: inline-block;margin-left:1em;"><ul class="{0}"><li><input type="checkbox" id="FixedTableSelectColumns" class="k-checkbox"><label class="k-checkbox-label" for="FixedTableSelectColumns">'+ResManager.LoadKDString("列表选择列固定","0991733000004040")+'</label></li><li><input type="checkbox" id="NotShowUtcOffset" class="k-checkbox"><label class="k-checkbox-label" for="NotShowUtcOffset">'+ResManager.LoadKDString("关闭登录时区提示","014005000007578")+'</label></li><li><input type="checkbox" id="DisabledGridCellBorder" class="k-checkbox"><label class="k-checkbox-label" for="DisabledGridCellBorder">'+ResManager.LoadKDString("不启用表格边框线","014002030036957")+'</label></li><li><input type="checkbox" id="DisabledColReset" class="k-checkbox"><label class="k-checkbox-label" for="DisabledColReset">'+ResManager.LoadKDString("列表点击不清除选中行","00214298000008713")+'</label></li><li><input type="checkbox" id="CopyGridOrginalValue" class="k-checkbox"><label class="k-checkbox-label" for="CopyGridOrginalValue">'+ResManager.LoadKDString("列表数字字段复制不带格式","014003030040473")+'</label></li><li><input type="checkbox" id="EnableListKDVGrid" class="k-checkbox"><label class="k-checkbox-label" for="EnableListKDVGrid" title="'+s+'">'+r+'</label></li><li><input type="checkbox" id="GridHeadFilterOnlyShowVisData" class="k-checkbox"><label class="k-checkbox-label" for="GridHeadFilterOnlyShowVisData">'+ResManager.LoadKDString("列头过滤下拉仅显示筛选后数据","002014030048099")+'</label></li></ul></div><div style="flex-grow:1; display: inline-block;margin-left:1em;"><ul class="{0}"><li><input type="checkbox" id="PrintNoPrompt" class="k-checkbox"><label class="k-checkbox-label" for="PrintNoPrompt">'+ResManager.LoadKDString("打印无需提示","0991733000004037")+'</label></li><li><input type="checkbox" id="UseClientPrinterSetting" class="k-checkbox"><label class="k-checkbox-label" for="UseClientPrinterSetting">'+ResManager.LoadKDString("使用本地打印机设置","0991733000004038")+'</label></li><li><input type="checkbox" id="IsDefNomalPreviewWindow" class="k-checkbox"><label class="k-checkbox-label" for="IsDefNomalPreviewWindow">'+ResManager.LoadKDString("预览为普通窗口","0991733030046915")+'</label></li><li><input type="checkbox" id="IsPreviewAutoSize" class="k-checkbox"><label class="k-checkbox-label" for="IsPreviewAutoSize">'+ResManager.LoadKDString("预览内容自适应窗口","0991733030046916")+'</label></li></div></ul></div><div style="display:inline-block;padding-left:.8em;"><label style="display: inline-block; color: rgba(52, 73, 94, 0.3); word-wrap: break-word; word-break: normal;">'+ResManager.LoadKDString("主题皮肤设置后，请刷新浏览器让其生效。","0991733030033374")+"</label></div>",o));this.element=e(t),this.element.append(l).css({width:this.options.width+"px"});var d=KD.getLocalConfiguration();this.initComponent(d)},showUserparamSettingWindow:function(t){var i=this;i.popuDiv=this.element.kendoWindow({title:ResManager.LoadKDString("本地配置","0991733000004027"),actions:["Close"],animation:{open:{effects:"fade:in"},close:{effects:"fade:out"}},pinned:!1,draggable:!0,modal:!1,width:this.options.width,minHeight:KD.convertToPX(25),scrollable:!1,resizable:!1,close:function(e){i.popuDiv.destroy()}}).data("kendoWindow"),i.popuDiv.center(),i.popuDiv.open();var a=i.popuDiv.wrapper&&i.popuDiv.wrapper.find(".k-window-actions")&&i.popuDiv.wrapper.find(".k-window-actions").find("[aria-label=Maximize]");a&&a.length>0&&e(a).hide()},initComponent:function(t){var i=this;if(KD.isObject(t)){e("#toolbar").kendoToolBar({resizable:!0,items:[{type:"button",text:ResManager.LoadKDString("保存","0991733000003959"),attributes:{"class":"kd-userParamSetting-toolbtn"},click:function(e){i.saveSettings.call(i)}},{type:"button",text:ResManager.LoadKDString("恢复缺省值","0991733000004024"),attributes:{"class":"kd-userParamSetting-toolbtn"},click:function(e){i.customSettings.call(i,o)}}]});var a=e("#toolbar").data("kendoToolBar"),n=a.element;n&&n.addClass("kd-userParamSetting-toolbar-wrapper"),e("#SelectRowBackground").kendoColorPicker({value:t.SelectRowBackground||o.SelectRowBackground,messages:{apply:ResManager.LoadKDString("应用","0991733030032296"),cancel:ResManager.LoadKDString("取消","0991733000003922")}});var r=e("#SelectRowBackground").data("kendoColorPicker");i.customColorPicker(r,t.SelectRowBackground,o.SelectRowBackground),e("#MessageDisTime").kendoNumericTextBox({decimals:2,min:.01,max:3600,value:t.MessageDisTime||o.MessageDisTime,change:function(){var e=this.value();i._change("MessageDisTime",e)},spin:function(){var e=this.value();i._change("MessageDisTime",e)}}),e("#NumFieldForeColor").kendoColorPicker({value:t.MinusNumColor||o.MinusNumColor,messages:{apply:ResManager.LoadKDString("应用","0991733030032296"),cancel:ResManager.LoadKDString("取消","0991733000003922")}});var s=e("#NumFieldForeColor").data("kendoColorPicker");i.customColorPicker(s,t.MinusNumColor,o.MinusNumColor);var l=KD.getEntryRoleConfig(),d=[];null==l.themePlugins||KD.isObjectEmpty(l.themePlugins)?d.push({text:ResManager.LoadKDString("默认皮肤","0991733000004080"),value:"standard"}):null!=l.themePlugins.ThemeItems&&KD.isArray(l.themePlugins.ThemeItems)&&l.themePlugins.ThemeItems.length>0&&e(l.themePlugins.ThemeItems).each(function(e,t){var i=t.Name,a=KD.parseObject(i);a&&!KD.isEmpty(a[ClientAppProxy.Current.defaultLocalId])&&(i=a[ClientAppProxy.Current.defaultLocalId]),d.push({text:i,value:t.Key})}),e("#ThemeChooser").kendoDropDownList({dataTextField:"text",dataValueField:"value",dataSource:d,value:t.ThemeChooser||o.ThemeChooser}),e("#PrintNoPrompt").prop("checked",t.PrintNoPrompt||o.PrintNoPrompt),e("#UseClientPrinterSetting").prop("checked",t.UseClientPrinterSetting||o.UseClientPrinterSetting),e("#IsDefNomalPreviewWindow").prop("checked",t.IsDefNomalPreviewWindow||o.IsDefNomalPreviewWindow),e("#IsPreviewAutoSize").prop("checked",t.IsPreviewAutoSize||o.IsPreviewAutoSize),e("#FixedTableSelectColumns").prop("checked",t.FixedTableSelectColumns||o.FixedTableSelectColumns),e("#NotShowUtcOffset").prop("checked",t.NotShowUtcOffset||o.NotShowUtcOffset),this.element.find("#DisabledGridCellBorder").prop("checked",KD.getValue(t,"DisabledGridCellBorder",o.DisabledGridCellBorder)),this.element.find("#DisabledColReset").prop("checked",KD.getValue(t,"DisabledColReset",o.DisabledColReset)),this.element.find("#CopyGridOrginalValue").prop("checked",KD.getValue(t,"CopyGridOrginalValue",o.CopyGridOrginalValue)),this.element.find("#EnableListKDVGrid").prop("checked",KD.getValue(t,"EnableListKDVGrid",o.EnableListKDVGrid)),this.element.find("#GridHeadFilterOnlyShowVisData").prop("checked",KD.getValue(t,"GridHeadFilterOnlyShowVisData",o.GridHeadFilterOnlyShowVisData))}},_change:function(t,i){"MessageDisTime"==t&&(i=parseFloat(i),1>i?e("#MessageDisTimeDsc").show():e("#MessageDisTimeDsc").hide())},customColorPicker:function(t,i,a){var n=e(t.wrapper[0]);n.width("1033"==ResManager.Language?"8.3em":"7em"),n.find(".k-selected-color").eq(0).css({width:"1033"==ResManager.Language?"6.2em":"4.9em","line-height":"2em","text-align":"center"}).text(i.toLocaleLowerCase()===a.toLocaleLowerCase()?ResManager.LoadKDString("默认颜色","0991733030032663"):i),t.bind("select",function(e){n.find(".k-selected-color").eq(0).text(e.value.toLocaleLowerCase()===a.toLocaleLowerCase()?ResManager.LoadKDString("默认颜色","0991733030032663"):e.value)}),t.bind("open",function(){var i=e(this._selector.element[0]);if(!(i.find(".k-controls .reset").eq(0).length>0)){var o=e('<button class="k-button reset" style="margin-left: 1.5%;">'+ResManager.LoadKDString("恢复默认","0991733030032664")+"</button>");o.bind("click",function(){t.value(a),t.close(),n.find(".k-selected-color").eq(0).text(ResManager.LoadKDString("默认颜色","0991733030032663"))}),i.find(".k-controls").eq(0).append(o)}})},customSettings:function(t){KD.isObjectEmpty(t)||(!KD.IsNullOrWhiteSpace(t.MessageDisTime)&&KD.isNumber(t.MessageDisTime)&&e("#MessageDisTime").data("kendoNumericTextBox").value(t.MessageDisTime),!KD.IsNullOrWhiteSpace(t.SelectRowBackground)&&KD.isString(t.SelectRowBackground)&&e("#SelectRowBackground").data("kendoColorPicker").value(t.SelectRowBackground),!KD.IsNullOrWhiteSpace(t.MinusNumColor)&&KD.isString(t.MinusNumColor)&&e("#NumFieldForeColor").data("kendoColorPicker").value(t.MinusNumColor),!KD.IsNullOrWhiteSpace(t.ThemeChooser)&&KD.isString(t.ThemeChooser)&&e("#ThemeChooser").data("kendoDropDownList").value(t.ThemeChooser),KD.IsNullOrWhiteSpace(t.PrintNoPrompt)||e("#PrintNoPrompt").prop("checked",t.PrintNoPrompt),KD.IsNullOrWhiteSpace(t.UseClientPrinterSetting)||e("#UseClientPrinterSetting").prop("checked",t.UseClientPrinterSetting),KD.IsNullOrWhiteSpace(t.IsDefNomalPreviewWindow)||e("#IsDefNomalPreviewWindow").prop("checked",t.IsDefNomalPreviewWindow),KD.IsNullOrWhiteSpace(t.IsPreviewAutoSize)||e("#IsPreviewAutoSize").prop("checked",t.IsPreviewAutoSize),KD.IsNullOrWhiteSpace(t.FixedTableSelectColumns)||e("#FixedTableSelectColumns").prop("checked",t.FixedTableSelectColumns),KD.IsNullOrWhiteSpace(t.NotShowUtcOffset)||e("#NotShowUtcOffset").prop("checked",t.NotShowUtcOffset),KD.IsNullOrWhiteSpace(t.DisabledGridCellBorder)||this.element.find("#DisabledGridCellBorder").prop("checked",t.DisabledGridCellBorder),KD.IsNullOrWhiteSpace(t.DisabledColReset)||this.element.find("#DisabledColReset").prop("checked",t.DisabledColReset),KD.IsNullOrWhiteSpace(t.CopyGridOrginalValue)||this.element.find("#CopyGridOrginalValue").prop("checked",t.CopyGridOrginalValue),KD.IsNullOrWhiteSpace(t.EnableListKDVGrid)||this.element.find("#EnableListKDVGrid").prop("checked",t.EnableListKDVGrid),KD.IsNullOrWhiteSpace(t.GridHeadFilterOnlyShowVisData)||this.element.find("#GridHeadFilterOnlyShowVisData").prop("checked",t.GridHeadFilterOnlyShowVisData))},saveSettings:function(){var t=this;KD.resetLocalConfiguration();var i={MessageDisTime:e("#MessageDisTime").data("kendoNumericTextBox").value()||"",SelectRowBackground:e("#SelectRowBackground").data("kendoColorPicker").value(),MinusNumColor:e("#NumFieldForeColor").data("kendoColorPicker").value(),ThemeChooser:e("#ThemeChooser").data("kendoDropDownList").value(),PrintNoPrompt:e("#PrintNoPrompt").prop("checked"),UseClientPrinterSetting:e("#UseClientPrinterSetting").prop("checked"),IsDefNomalPreviewWindow:e("#IsDefNomalPreviewWindow").prop("checked"),IsPreviewAutoSize:e("#IsPreviewAutoSize").prop("checked"),FixedTableSelectColumns:e("#FixedTableSelectColumns").prop("checked"),NotShowUtcOffset:e("#NotShowUtcOffset").prop("checked"),DisabledGridCellBorder:t.element.find("#DisabledGridCellBorder").prop("checked"),DisabledColReset:t.element.find("#DisabledColReset").prop("checked"),CopyGridOrginalValue:t.element.find("#CopyGridOrginalValue").prop("checked"),EnableListKDVGrid:t.element.find("#EnableListKDVGrid").prop("checked"),GridHeadFilterOnlyShowVisData:t.element.find("#GridHeadFilterOnlyShowVisData").prop("checked")},a=KD.parseObject(KD.storage.getItem(KD.CONST.LocalConfigurationKey)||"{}");a[KD.generateUserHashID()]=i,KD.storage.setItem(KD.CONST.LocalConfigurationKey,KD.obj2str(a)),KD.cookie.write("Theme",i.ThemeChooser),KDDynamicFormProxyBase_DoAction.prototype.showMessageByInnerForm(ShowFromPageId,ResManager.LoadKDString("保存成功！","0991733030044648"),"","userparamsetting",0,0,null,null)}});a.plugin(r)}(window.kendo.jQuery);var KDUserparamSetting=KDUserparamSetting||{},ShowFromPageId="";KDUserparamSetting.getKDUserparamSettingViewData=function(e,t){var i;if($("#KDUserparamSettingView").length>0)i=$("#KDUserparamSettingView").data("kendoKDUserparamSettingView");else{var a=$("<div class='k-content' id='KDUserparamSettingView'></div>"),n="1033"==ResManager.Language?KD.convertToPX(65):KD.convertToPX(55);t&&!KD.isEmpty(t.el)?(n="auto",a.appendTo(t.el),ShowFromPageId=e):a.appendTo($(document.body));var i=a.kendoKDUserparamSettingView({width:n}).data("kendoKDUserparamSettingView")}return i},KDUserparamSetting.show=function(e,t){var i=this.getKDUserparamSettingViewData(e,t);i.showUserparamSettingWindow()},define("KDUserparamSetting",["KD"],function(e){return function(){var t;return t||e.KDUserparamSetting}}(this)),function(e){KDNumberFormatInfo=function(){this.NSign="-",this.NDSeparator=".",this.NGSeparator=",",this.CSymbol=""},KDNumberFormatInfo.prototype={NumType:"N",setNumType:function(e){this.NumType=e},NDSeparator:".",setNDSeparator:function(e){this.NDSeparator=e},NGSeparator:",",setNGSeparator:function(e){this.NGSeparator=e},NNPattern:0,setNNPattern:function(e){this.NNPattern=e},NPPattern:0,setNPPattern:function(e){this.NPPattern=e},CNPattern:0,setCNPattern:function(e){this.CNPattern=e},CPPattern:0,setCPPattern:function(e){this.CPPattern=e},NSign:"-",getNSign:function(){return KD.IsNullOrWhiteSpace(this.NSign)?"-":this.NSign},setNSign:function(e){this.NSign=e},CSymbol:"",setCSymbol:function(e){this.CSymbol=e},IsDefault:!1,setIsDefault:function(e){this.IsDefault=e},_nfi:null,getNumInfo:function(){return null!=this._nfi?this._nfi:(this._nfi=new Object,this._nfi.PositiveSign="",this._nfi.NumberNegativePattern=this.NNPattern,this._nfi.NumberDecimalSeparator=this.NDSeparator,this._nfi.NumberGroupSeparator=this.NGSeparator,this._nfi.NegativeSign=this.NSign,this._nfi.CurrencySymbol=this.CSymbol,this._nfi.CurrencyNegativePattern=this.CNPattern,this._nfi.CurrencyPositivePattern=this.CPPattern,this._nfi.CurrencyDecimalSeparator=this.NDSeparator,this._nfi.CurrencyGroupSeparator=this.NGSeparator,this._nfi.PercentNegativePattern=this.NNPattern,this._nfi.PercentPositivePattern=this.NPPattern,this._nfi.PercentDecimalSeparator=this.NDSeparator,this._nfi.PercentGroupSeparator=this.NGSeparator,this._nfi.PercentSymbol="%",this._nfi)},reset:function(){this._nfi=null,this._displayFormatString=""},getFormatedString:function(){var e=arguments[0];if(1==arguments.length){var t=this.getNumInfo();t.NumberDecimalDigits=0,t.CurrencyDecimalDigits=0,t.PercentDecimalDigits=0;var i=KD.numInfo.formatNumber(e,0).replace(/,/g,t.NumberGroupSeparator).replace("-",t.NegativeSign);return i=this.getCurrencyFormatString(i,t)}var a=arguments[1],n=arguments[0],o=arguments[2]||e,r=ClientAppProxy.Current.NumFieldRPTakeFormat;if(r){var s=""+e,l=(s.length,s.indexOf("."));if(l>-1){var d=s.substr(l+1);a=d.length}else a=0}if(o=KD.numInfo.formatNumber(n,a,this.NumType),"number"==typeof e){var t=this.getNumInfo();t.NumberDecimalDigits=a,t.CurrencyDecimalDigits=a,t.PercentDecimalDigits=a;var i=KD.numInfo.formatNumber(e,a);if(o!=e){var c=i.split(".")[1];i=o.split(".")[0]+(c?"."+c:"")}return i=i.replace(".",t.NumberDecimalSeparator).replace(/,/g,t.NumberGroupSeparator),i=this._formatNNPatternString(t,i),"C"==this.NumType&&(i=this.getCurrencyFormatString(i,t)),i}var h=null==e?"0":e.toString(),u=0;return u=parseFloat(h),this.getFormatedString(u,a,arguments[2]||u)},_formatNNPatternString:function(e,t){if(t=t||"",t.indexOf("-")<0)return t;var i={bracketsWrap:0,leftReplace:1,leftSpaceReplace:2,rightReplace:3,rightSpaceReplace:4};switch(e.NumberNegativePattern){case i.bracketsWrap:t="("+t.replace("-","")+")";break;case i.leftReplace:t=t.replace("-",e.NegativeSign);break;case i.leftSpaceReplace:t=t.replace("-",e.NegativeSign+" ");break;case i.rightReplace:t=t.replace("-","")+e.NegativeSign;break;case i.rightSpaceReplace:t=t.replace("-","")+e.NegativeSign+" "}return t},getCurrencyFormatString:function(e,t){switch(-1==e.indexOf(t.CurrencySymbol)&&(e=t.CurrencySymbol+""+e),t.CurrencyPositivePattern.toString()){case"1":e=e.replace(t.CurrencySymbol,"")+t.CurrencySymbol;break;case"0":}return t.CurrencyNegativePattern.toString(),e},_displayFormatString:"",isSymbolFirstPosition:function(e){return null==e&&(e=this.getNumInfo()),KD.IsNullOrWhiteSpace(e.CurrencySymbol)?!0:0==e.CurrencyPositivePattern},getDisplayFormatString:function(e){if(void 0===e&&(e=-1),!KD.IsNullOrWhiteSpace(this._displayFormatString)&&-1==e)return this._displayFormatString;var t=this.getNumInfo(),i=function(e){return-1!=e?e:KD.equalsIgnoreCase("C",this.NumType)||KD.equalsIgnoreCase("P",this.NumType)?t.CurrencyDecimalDigits:t.NumberDecimalDigits},a="#,###,###,##0.#########;-#,###,###,##0.#########",n=this.isSymbolFirstPosition(t);if(n?a=t.CurrencySymbol+a:a+=t.CurrencySymbol,!KD.IsNullOrWhiteSpace(t.NumberGroupSeparator))if(KD.equalsIgnoreCase("C",this.NumType)){var o=new String("#",i(e)),r=new String("#",t.CurrencyGroupSizes[0]),s=new String("#",t.CurrencyGroupSizes[0]-1);a=string.Format("{6}#{0}{3}{0}{3}{0}{4}0{1}{2}{8};{7}",t.CurrencyGroupSeparator,t.CurrencyDecimalSeparator,o,r,s,this.NSign,n?t.CurrencySymbol:"",getCurrencyNagativeDisplayFormat(),n?"":t.CurrencySymbol)}else if(KD.equalsIgnoreCase("P",this.NumType)){var o=new String("#",i(e)),r=new String("#",t.CurrencyGroupSizes[0]),s=new String("#",t.CurrencyGroupSizes[0]-1);a=string.Format("{6}#{0}{3}{0}{3}{0}{4}0{1}{2}{7};{6}{5}#{0}{3}{0}{3}{0}{4}0{1}{2}{7}",t.CurrencyGroupSeparator,t.CurrencyDecimalSeparator,o,r,s,this.NSign,n?t.CurrencySymbol:"",n?"":t.CurrencySymbol)}else{var o=new String("#",i(e)),r=new String("#",t.NumberGroupSizes[0]),s=new String("#",t.NumberGroupSizes[0]-1);a=string.Format("#{0}{3}{0}{3}{0}{4}0{1}{2};{5}#{0}{3}{0}{3}{0}{4}0{1}{2}",t.NumberGroupSeparator,t.NumberDecimalSeparator,o,s,r,this.NSign)}return _displayFormatString=a,_displayFormatString},_curNegativePartterns:new Array(16),getCurrencyNagativeParttern:function(e,t){var i=t;return KD.IsNullOrWhiteSpace(this._curNegativePartterns[0])&&(this._curNegativePartterns[0]="({5}#{0}{3}{0}{3}{0}{4}0{1}{2})",this._curNegativePartterns[1]="{5}{6}#{0}{3}{0}{3}{0}{4}0{1}{2}",this._curNegativePartterns[2]="{6}{5}#{0}{3}{0}{3}{0}{4}0{1}{2}",this._curNegativePartterns[3]="{6}#{0}{3}{0}{3}{0}{4}0{1}{2}{5}",this._curNegativePartterns[4]="(#{0}{3}{0}{3}{0}{4}0{1}{2}{5})",this._curNegativePartterns[5]="{5}#{0}{3}{0}{3}{0}{4}0{1}{2}{6}",this._curNegativePartterns[6]="#{0}{3}{0}{3}{0}{4}0{1}{2}{5}{6}",this._curNegativePartterns[7]="#{0}{3}{0}{3}{0}{4}0{1}{2}{6}{5}",this._curNegativePartterns[8]="{5}#{0}{3}{0}{3}{0}{4}0{1}{2} {6}",this._curNegativePartterns[9]="{5}{6} #{0}{3}{0}{3}{0}{4}0{1}{2}",this._curNegativePartterns[10]="#{0}{3}{0}{3}{0}{4}0{1}{2} {6}{5}",this._curNegativePartterns[11]="{6} #{0}{3}{0}{3}{0}{4}0{1}{2}{5}",this._curNegativePartterns[12]="{6} {5}#{0}{3}{0}{3}{0}{4}0{1}{2}",this._curNegativePartterns[13]="#{0}{3}{0}{3}{0}{4}0{1}{2}{5} {6}",this._curNegativePartterns[14]="({5} #{0}{3}{0}{3}{0}{4}0{1}{2})",this._curNegativePartterns[15]="(#{0}{3}{0}{3}{0}{4}0{1}{2} {5})"),e>=0&&15>=e&&(i=this._curNegativePartterns[e]),i},isShowNSign:function(e){return 0!=e&&4!=e&&14!=e&&15!=e},getCurrencyNagativeDisplayFormat:function(){var e=this.getNumInfo(),t="-#,###,###,##0.#########";this.isSymbolFirstPosition(e)?t=e.CurrencySymbol+t:t+=e.CurrencySymbol;var i=new string("#",e.currencydecimaldigits),a=new string("#",e.currencygroupsizes[0]),n=new string("#",e.currencygroupsizes[0]-1),o=this.getCurrencyNagativeParttern(e.CurrencyNegativePattern,"");return KD.IsNullOrWhiteSpace(o)||(t=this.isShowNSign(e.CurrencyNegativePattern)?string.format(o,e.CurrencyGroupSeparator,e.CurrencyDecimalSeparator,i,a,n,this.NSign,e.CurrencySymbol):string.format(o,e.CurrencyGroupSeparator,e.CurrencyDecimalSeparator,i,a,n,e.CurrencySymbol)),t},isDeciamlType:function(){return KD.IsNullOrWhiteSpace(this.NumType)||"D"==this.NumType||"d"==this.NumType}}}(jQuery),define("KDNumberFormatInfo",["KD"],function(e){return function(){var t;return t||e.KDNumberFormatInfo}}(this));var KDGetCursorPositon=KDGetCursorPositon||{getInputPositon:function(e){if(void 0==e.getBoundingClientRect&&(e=e[0]),document.selection){e.focus();var t=document.selection.createRange();return{left:t.boundingLeft,top:t.boundingTop,bottom:t.boundingTop+t.boundingHeight}}var i=this,a="{$clone_div}",n="{$cloneLeft}",o="{$cloneFocus}",r='<span style="white-space:pre-wrap;"> </span>',s=e[a]||document.createElement("div");s.id="KDGetCursorPositon"+e.id;var l=e[o]||document.createElement("span"),d=e[n]||document.createElement("span"),c=(i._offset(e),this._getStartIndex(e)),h={left:0,top:0};e[a]?$(e[a]).css({display:"inline-block"}):(e[a]=s,e[o]=l,e[n]=d,s.appendChild(d),s.appendChild(l),document.body.appendChild(s),l.innerHTML="|",l.style.cssText="display:inline-block;width:0px;overflow:hidden;z-index:-100;word-wrap:break-word;word-break:break-all;",s.className=this._cloneStyle(e),s.style.cssText="visibility:hidden;display:inline-block;position:absolute;z-index:-100;word-wrap:break-word;word-break:break-all;overflow:hidden;"),s.style.left=this._offset(e).left+"px",s.style.top=this._offset(e).top+"px";var u=e.value.substring(0,c).replace(/</g,"<").replace(/>/g,">").replace(/\n/g,"<br/>").replace(/\s/g,r);d.innerHTML=u,l.style.display="inline-block";try{h=this._offset(l)}catch(p){}return l.style.display="none",$(e[a]).css({display:"none"}),{left:h.left,top:h.top,bottom:h.bottom}},_cloneStyle:function(e,t){if(!t&&e["${cloneName}"])return e["${cloneName}"];var i,a,n=/^(number|string)$/,o=/^(content|outline|outlineWidth)$/,r=[],s=e.style;for(a in s)o.test(a)||(val=this._getStyle(e,a),""!==val&&n.test(typeof val)&&(a=a.replace(/([A-Z])/g,"-$1").toLowerCase(),r.push(a),r.push(":"),r.push(val),r.push(";")));return r=r.join(""),e["${cloneName}"]=i="clone"+(new Date).getTime(),this._addHeadStyle("."+i+"{"+r+"}"),i},_addHeadStyle:function(e){var t=this._style[document];t||(t=this._style[document]=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(t)),t.styleSheet&&(t.styleSheet.cssText+=e)||t.appendChild(document.createTextNode(e))},_style:{},_getStyle:"getComputedStyle"in window?function(e,t){return getComputedStyle(e,null)[t]}:function(e,t){return e.currentStyle[t]},setSelection:function(e,t,i){var a=e;if(!isNaN(t)&&!isNaN(i))if(a.setSelectionRange)setTimeout(function(){a.setSelectionRange(t,i),a.focus()},0);else if(a.createTextRange){var n=a.createTextRange();n.moveEnd("character",i),n.moveStart("character",t),n.select()}},setSelectionIndex:function(e,t){
var i=e;if(0>t&&(t=i.value.length),i.setSelectionRange)setTimeout(function(){i.setSelectionRange(t,t),i.focus()},0);else if(i.createTextRange){var a=i.createTextRange();a.move("character",t),a.select()}},getSelectionIndex:function(e){return this._getStartIndex(e)},getSelectionEndIndex:function(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();if("TEXTAREA"===e.nodeName){var a=i.duplicate();a.moveToElementText(e);for(var t=-1;a.inRange(i);)a.moveEnd("character"),t++}else"INPUT"===e.nodeName&&(i.moveEnd("character",-e.value.length),t=i.text.length)}else(e.selectionEnd||0==e.selectionEnd)&&(t=e.selectionEnd);return t},_getStartIndex:function(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();if("TEXTAREA"===e.nodeName){var a=i.duplicate();a.moveToElementText(e);for(var t=-1;a.inRange(i);)a.moveStart("character"),t++}else"INPUT"===e.nodeName&&(i.moveStart("character",-e.value.length),t=i.text.length)}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t},_offset:function(e){var t=e.getBoundingClientRect(),i=e.ownerDocument,a=i.body,n=i.documentElement,o=n.clientTop||a.clientTop||0,r=n.clientLeft||a.clientLeft||0,s=t.top+(self.pageYOffset||n.scrollTop)-o,l=t.left+(self.pageXOffset||n.scrollLeft)-r;return{left:l,top:s,right:l+t.width,bottom:s+t.height}}};define("KDGetCursorPositon",function(){}),function(e){e.fn.KDNumerInput=function(t){var i=".KDNumerInput",a="kd-editor-input-bound";if(KD.isString(t)&&"release"==t&&this.unbind(i),e(this).css({"ime-mode":"disabled"}).attr("data-options",KD.stringify(t)),!e(this).hasClass(a)){e(this).addClass(a);var n=".",o="-",r=function(e){var t=e||"",i=t.length>0&&t.substr(0,1)==o;return i},s=function(e){return e>=48&&57>=e||e>=96&&105>=e},l=function(t,i){var a=t||"",o=e(i).data(),r=(o&&o.options||{},(a||"").split(n)),s=parseInt(r[0]),l=""==t||void 0===t||""==r[0]||r[0]==s.toString();return l},d=(e.fn.KDNumerInput.checkOptions=function(t,i,a,o){var r=e(a).data(),d=r&&r.options||{},c=l(t,a);if(!c)return c;var h=(t||"").split(n),u=a.selectionStart<=h[0].length;if(!u&&d.isControlPrecision){var p=d.precision||0;c=p>0?h.length<2?!0:h[1].length<p:1==h.length&&46!=i}if(c){var g=d.intLength||13;c=h[0].replace(/\-/g,"").length<=g;var f=parseFloat(d.max)||Number.POSITIVE_INFINITY,m=parseFloat(d.min)||Number.NEGATIVE_INFINITY,v=parseFloat(t||"0");c=o?s(i)||!KD.isNaN(v)&&v>=m&&f>=v:!KD.isNaN(v)&&v>=m&&f>=v}return c},function(t,i){var a=t||"",o=e(i).data(),s=(o&&o.options||{},(a||"").split(n)),l=parseInt(s[0]),d=(r(t),l.toString()+(s.length>1?n+s[1]:""));return d});e.fn.KDNumerInput.cutOptions=function(t,i){var a=e(i).data(),s=a&&a.options||{},l=innerCurVal=d(t,i),c=r(t);innerCurVal!=t&&c&&(innerCurVal=o+innerCurVal);var h=(innerCurVal||"").split(n);if(s.isControlPrecision){var u=s.precision||0;l=innerCurVal=h.length<2?h[0]:h[1].length<=u?innerCurVal:h[0]+n+h[1].substr(0,u)}var p=parseFloat(s.max)||Number.POSITIVE_INFINITY,g=parseFloat(s.min)||Number.NEGATIVE_INFINITY,f=parseFloat(innerCurVal||"0");return void 0==i.oldValue&&(i.oldValue=g),g>f?l=i.oldValue:f>p?l=i.oldValue:KD.isNaN(f)&&(l="0"),l}}}}(jQuery),define("KDNumerInput",["KD","KDGetCursorPositon"],function(e){return function(){var t;return t||e.KDNumerInput}}(this)),function(e){KD.numInfo=KD.numInfo||{},e.extend(KD.numInfo,{redCellCls:"kd-grid-redcell",FLOAT_MIN_VALUE:9.99999e-7,formatNumber:function(e,t,i){var a="",n=void 0===t?2:t;if(void 0===i)return a=KD.numInfo.formatNumberNoPattern(e,t);if(!KD.numInfo.isSimpleFotmat(i)){var o=KD.numInfo.isSimpleHadNum(i);if(-1==o)return a=KD.numInfo.formatNumberByPattern(e,i);n=o,i=i[0]}switch(i){case"c":case"C":for(var r=n,s="###,###,###,###,###,###,###,###.",l=0;r>l;l++)s+="0";a=KD.numInfo.formatNumberByPattern(e,s);break;case"p":case"P":for(var d=100*e,r=n,s="###,###,###,###,###,###,###,###.",l=0;r>l;l++)s+="0";a=KD.numInfo.formatNumberByPattern(d,s)+"%";break;case"g":case"G":for(var r=n,s="########################.",l=0;r>l;l++)s+="#";a=KD.numInfo.formatNumberByPattern(e,s);break;case"d":case"D":for(var r=n,s="###,###,###,###,###,###,###,###.",l=0;r>l;l++)s+="#";a=KD.numInfo.formatNumberByPattern(e,s);break;case"f":case"F":case"n":case"N":for(var r=n,s="###,###,###,###,###,###,###,###.00",l=0;r-2>l;l++)s+="#";a=KD.numInfo.formatNumberByPattern(e,s);break;default:a=(e||"").toString()}return a},formatNumberNoPattern:function(e,t){("undefined"==typeof e||null===e)&&(e=0,console&&console.log&&console.log("KDNumInfoUtils::number is undefined or null")),(isNaN(parseFloat(e))||!isFinite(e))&&(e=0,console&&console.log&&console.log("KDNumInfoUtils::"+e+" is not a number."));var i=e+"";if("undefined"==typeof t||null===t)return i;if(isNaN(parseInt(t))||!isFinite(t))return console&&console.log&&console.log("KDNumInfoUtils::precision with "+t+" is not a number."),i;if(t=parseInt(t),i=KD.numInfo.checkValueIsOverFloatMinValue(e,t)+"",0>t&&(t=0),-1==i.indexOf(".")){if(0===t)return i;i+=".";for(var a=0;t>a;a++)i+="0"}else{var n=i.split("."),o=n.length>1?n[1]:"",r=t-o.length;if(r>0)for(var s=0;r>s;s++)i+="0";else{var l=parseFloat("0."+o);l=l.toFixed(t),i=l.indexOf("1.")>=0?parseInt(n[0])+1+(0===t?"":"."):n[0]+(0===t?"":"."),l=l.replace("0.","").replace("1.","");for(var s=0;t>s;s++)i+=l[s]}}return i},isSimpleFotmat:function(e){return!e||-1!="cCpPgGdDfFnN".indexOf(e)},isSimpleHadNum:function(e){if(e&&e.length>1&&-1!="cCpPgGdDfFnN".indexOf(e[0])){var t=parseInt(e.substr(1));return t}return-1},formatNumberByPattern:function(e,t){var i=0,a=0;if(!KD.isEmpty(t)){var n=t.indexOf(".");if(n>=0){var o=t.slice(n),r=new RegExp("%","g"),s=new RegExp("‰","g"),l=o.match(r),d=o.match(s);i=l&&l.length||0,a=d&&d.length||0}}t=this.getNewPatternByPercentOrPermillage(t,i,a);var c=/[\#\.\,0]{1,}/,h=c.exec(t),u=h?h[0]:t;e=KD.numInfo.checkValueIsOverFloatMinValue(e);var p=e?e.toString().split("."):["0"],g=u?u.split("."):[""],f="",m=p[0],v=p.length>1?p[1]:"",y=parseFloat("0."+v),b=g.length>1?g[1]:"";y=y.toFixed(b.length),y.indexOf("1.")>=0&&(m=parseInt(m)+1+""),b=g[0];for(var D=m.length-1,k=!1,C=b.length-1;C>=0;C--){var x=b.substr(C,1);switch(x){case"#":D>=0&&(f=m.substr(D--,1)+f);break;case"0":f=D>=0?m.substr(D--,1)+f:"0"+f;break;case",":if(k=!0,0==D&&"-"===m.substr(0,1))break;f=","+f;break;default:f=x+f}}if(D>=0)if(k)for(var w=m.length;D>=0;D--)f=m.substr(D,1)+f,D>0&&(w-D)%3==0&&(f=","+f);else f=m.substr(0,D+1)+f;if(b=g.length>1?g[1]:"",b.length>0){f+=".",m=p.length>1?y.replace("0.","").replace("1.",""):"",D=0;for(var C=0;C<b.length;C++){var x=b.substr(C,1);switch(x){case"#":D<m.length&&(f+=m.substr(D,1),D++);break;case"0":D<m.length?(f+=m.substr(D,1),D++):f+="0";break;default:f=x+f}}}return f=f.replace(/^,+/,"").replace(/\.[^\d]/,""),f.length>0&&"."==f.substr(f.length-1,1)&&(f=f.substr(0,f.length-1)),f=this.getNewRetStrByCalculate(f,i,a),t.replace(c,f)},getNewRetStrByCalculate:function(e,t,i){if(KD.isEmpty(e)||0==t&&0==i)return e;var a=Math.pow(100,t),n=Math.pow(1e3,i),o=(a*n).toString().slice(1),r=e.indexOf(".");if(0>r)e+=o;else{var s,l=e.slice(0,r),d=e.slice(r+1),c=o.length;0==parseInt(l)?(s=parseInt(d.slice(0,c)).toString(),l=""):(s=d.slice(0,c),l=parseInt(l).toString()),d=s+"."+d.slice(c),e=l+d}return e},getNewPatternByPercentOrPermillage:function(e,t,i){if(0==t&&0==i)return e;var a=Math.pow(100,t),n=Math.pow(1e3,i),o=(a*n).toString().slice(1),r=e.indexOf(".");return r>=0&&(e=e.slice(0,r+1)+o+e.slice(r+1)),e},isOutOfIntLength:function(e,t){var i=parseInt(e)<0?1:0,a=(e||"").toString();return a=a.split(".")[0],a.length-i>(t.intLength?t.intLength:13)},getNumberFormatInfo:function(t){var i=new KDNumberFormatInfo,a=t;return a?i=e.extend(i,KD.parseObject(a)):i.IsDefault=!0,i},getMask:function(e,t){for(var i={intLength:e,precision:t},a="",n=0;n<i.intLength;n++)a="#"+(n%3==0&&0!=n?",":"")+a;if(i.precision>0){a+=".";for(var n=0;n<i.precision;n++)a+="0"}return a},validation:function(e,t,i){var a=t,n=!0,o=0,r=KD.numInfo.getRealMax(t),s=KD.numInfo.getRealMin(t);return KD.isEmpty(e)?{result:n,value:e}:(o=KD.isNumber(e)?e:0==a.precision?parseInt(e):parseFloat(e),isNaN(o)?(o=i||0,{result:!1,value:o}):(o>r?(o=r,n=!1):s>o&&s!=1/0?(o=s,n=!1):0==s?n=!((e+"").indexOf("-")>=0):KD.numInfo.isOutOfIntLength(e,t)&&(o=e,n=!1),{result:n,value:o}))},getRedBlueValue:function(e,t,i){var a=t,n=KD.isNumber(e)?e:0==a.precision?parseInt(e):parseFloat(e);KD.numInfo.getRealMax(t),KD.numInfo.getRealMin(t);return isNaN(n)&&(n=i||0),a.isRedBlue&&(n=-1*n),n=KD.numInfo.checkValueIsOverFloatMinValue(n)},getRealMin:function(e){var t=e.min,i=0==e.precision?parseInt:parseFloat;return t=i(t),t=isNaN(t)?0:t},checkValueIsOverFloatMinValue:function(e,t){var i,a=e,n=parseFloat(e);return KD.isNaN(n)?a=e:KD.numInfo.isOverFloatMinValue(n)&&(0>n?(i=n-1+"",i=i.replace("-1.0","-0.0")):n>0&&(i=n+1+"",i=i.replace("1.0","0.0")),a=i),a},isOverFloatMinValue:function(e){var t=!1,i=parseFloat(e),a=Math.abs(i);return KD.isNaN(a)?t=!1:a>0&&a<=KD.numInfo.FLOAT_MIN_VALUE&&(t=!0),t},getRealMax:function(e){var t=e.max,i=0==e.precision?parseInt:parseFloat;return t=i(t),t=isNaN(t)?Number.POSITIVE_INFINITY:t},toPrecision:function(e,t){var i,a=e;if(a.indexOf(".")>-1){var n=a.split(".");n[1]=n[1]||"",n[1].length>t&&(n[1]=n[1].slice(0,t),a=n.join("."))}return i=parseFloat(a),i=KD.numInfo.checkValueIsOverFloatMinValue(i)}})}(jQuery),define("KDNumInfoUtils",["KD","KDNumberFormatInfo","KDGetCursorPositon"],function(e){return function(){var t;return t||e.KDNumInfoUtils}}(this)),ShowFormParameter=function(e,t){this.FormId=e,this.ShowFormType=0,this.IsShowModel=!0,this.ResizeMode=2,t?this.LayoutId=t:this.LayoutId="",this.CustomParams={},this.Height=0,this.Width=0,this.Caption="",this.PageId="",this.IsLookUp=!1,this.IsShowModel=!1,this.InlineStyleCss={},this.ListFilterParameter=null,this.TitleVisible=!0,this.CacheId=""},ShowFormParameter.prototype={CreateWebParams:function(){var e={};e.formID=this.FormId,this.Width>0?e.width=this.Width:1==this.ShowFormType&&(e.width=800),this.Height>0?e.height=this.Height:1==this.ShowFormType&&(e.height=600),1==this.ShowFormType&&(e.formType="list",this.ListFilterParameter&&this.ListFilterParameter.length>0&&(e.listfilterstringfromclient=this.ListFilterParameter)),e.Caption=this.Caption,this.InputData&&""!=this.InputData&&(e.inputData=this.InputData),e.isLookup=this.IsLookUp,e.isshowmodel=this.IsShowModel,this.LayoutId&&""!=this.LayoutId&&(e.layoutID=this.LayoutId),this.PageId&&""!=this.PageId&&(e.pageID=this.PageId),e.titlevisible=this.TitleVisible,this.CacheId&&""!=this.CacheId&&(e.CacheId=this.CacheId);for(var t in this.CustomParams)e[t]=this.CustomParams[t];return this.InlineStyleCss&&(e.InlineStyleCss=this.InlineStyleCss),e},LoadConfig:function(e){if(!e)return this;if(this.FormId=KD.getValue(e,"formID",""),this.LayoutId=KD.getValue(e,"layoutID",this.LayoutId),this.Width=KD.getValue(e,"width",800)||800,this.Height=KD.getValue(e,"height",600)||600,this.Caption=KD.getValue(e,"Caption",""),this.IsLookUp=KD.getValue(e,"isLookup",!0),this.CacheId=KD.getValue(e,"CacheId",""),this.TitleVisible=KD.getValue(e,"titlevisible",!0),this.PageId=KD.getValue(e,"pageID",""),this.ShowFormType="list"==KD.getValue(e,"formType","")?1:this.ShowFormType,this.IsShowModel=KD.getValue(e,"isshowmodel",!0),e.customparams&&KD.isObject(e.customparams))for(var t in e.customparams)this.CustomParams[t]=e.customparams[t];if(this.ResizeMode=KD.getValue(e,"resizemode",2),e.InlineStyleCss&&KD.isObject(e.InlineStyleCss))for(var i in e.InlineStyleCss)this.InlineStyleCss[i]=e.InlineStyleCss[i]}},FormManager=function(){this.Forms=[]},FormManager.prototype={CreateDynamicFormProxy:function(){var e=new KDDynamicFormProxy;return e.Load(showFormParameter.CreateWebParams()),this.Forms.push(e),e},ShowClientDynamicForm:function(e,t,i){var a=$('<div data-kdrole="ShowClientDynamicForm">').KDForm(),n=e.CreateWebParams.call(e);0!=e.ResizeMode&&e.TitleVisible||(n.showmaxbutton=!1,n.resizable=!1),e.modal&&(n.modal=e.modal),e.activeVerifyBannerTip&&(n.activeVerifyBannerTip=e.activeVerifyBannerTip);var o=this;o.showFormPara=n,a.LoadDynamicFormByParemeter.call(a,n,function(t,i){var n=t.getHostWindowProxy.call(t);if(n){a._childFormProxy&&(n.close=function(){a._childFormProxy.invokeCloseAction.call(a._childFormProxy)}),n.loadConfig.call(n,i);var r={resizable:KD.getValue(i,"resizable",!0)};if(o.showFormPara.modal&&(r.modal=o.showFormPara.modal),!e.hideform){e.showformoption=r,o.showFormPara.isshowmodel?n.showDialog.call(n,r):n.show.call(n,void 0,r);var s={t:o,f:a};KD.delayInvoke(function(e){if(!KD.isEmpty(e)){var t=e.t,i=e.f;t.showFormPara.InlineStyleCss&&i._childFormProxy&&i._childFormProxy.setViewInlineStyle&&i._childFormProxy.setViewInlineStyle.call(i._childFormProxy,t.showFormPara.InlineStyleCss)}},15,!0,s)}}}),this.Forms.push(a._childFormProxy),e.FormProxyLoaded&&(a._childFormProxy.formLoaded=e.FormProxyLoaded),t&&(a._childFormProxy.closed=function(e){i?t.call(i,e):t(e)})}},function(e){FormFocusedManager=function(){},function(t){var i=t,a=".k-input,.k-textbox";i.focusedData=i.focusedData||{pageId:"",key:""},$.extend(i,{setFocused:function(t){try{var a=t.itemContainer||t,n=a.getPageId.call(a),o=a.getKey.call(a);$.extend(i.focusedData,{pageId:n,key:o})}catch(r){e.writeLog("FormFocusedManager.setFocused()",r.message,!0)}},isFocused:function(t){var a=!1;try{var n=i.focusedData,o=t.itemContainer||t,r=o.getPageId.call(o),s=o.getKey.call(o);a=s==n.key&&n.pageId==r}catch(l){e.writeLog("FormFocusedManager.isFocused()",l.message,!0)}return a},registeCtrlProxy:function(i){i&&i.el&&e.isFunction(i.el.undelegate)&&i.el.undelegate(a,"focus").delegate(a,"focus",function(e){e.stopPropagation(),t.setFocused(i)})},unregisteCtrlProxy:function(t){t&&t.el&&e.isFunction(t.el.undelegate)&&t.el.undelegate(a,"focus")}})}(FormFocusedManager)}(KD),define("FormManager",["KD"],function(e){return function(){var t;return t||e.FormManager}}(this)),function(e){function t(t){return e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDControlBase.defaults,t)}e.fn.KDControlBase=function(e){return t(e)},e.fn.KDControlBase.prototype={debug:!1,id:"",serverProxy:{},formProxy:{},metaData:{},content:e({}),addControl:function(e){e.appendTo(this.content)},getType:function(){return"KDControlBase"},loadConfig:function(e){KD.setAttachmentData(this,e),KD.layout.setAbsolute(this,e),this.config=e},metaHtml:"",ctIdKeyHolder:"{$this.ctId}",getMetaHtml:function(){var e=this.metaHtml.replace(this.ctIdKeyHolder,"ct_"+this.id);return e},setVisible:function(e){if(e||(this._height=this.css("height"),this._width=this.css("width"),this._padding=this.css("padding"),this._margin=this.css("margin")),void 0!=e&&"boolean"==typeof e){var t=e?"visible":"hidden",i=e?this._height:"0px",a=e?this._width:"0px",n=e?this._padding:"0px",o=e?this._margin:"0px";this.css({visibility:t,height:i,width:a,padding:n,margin:o})}},getId:function(){return this.id},setId:function(e){this.id=e},getProxy:function(){return this.proxy},getBaseId:function(){var e=this.getProxy();return e?e.getBaseId():"undefined_kdcontrolbase"},getConfig:function(){return this.config?this.config:{}},doLayout:function(){},setValue:function(e){var t=e;try{"string"!=typeof e&&(t=e.toString()),this.content?this.content.text(e):this.text(e)}catch(i){}},release:function(){this.remove&&this.remove()}},e.fn.KDControlBase.defaults={id:"",x:0,y:0,serverProxy:{},formProxy:{},metaData:{},metaHtml:"",debug:!1}}(jQuery),define("KDControlBase",["KD"],function(e){return function(){var t;return t||e.KDControlBase}}(this));var AuthenticationType=AuthenticationType||{DomainAuthentication:0,PwdAuthentication:1,DynamicPwdAuthentication:2,CAAuthentication:3,XuntongAuthentication:4,WeixinPublicAuthentication:5,WeixinEntAuthentication:6,CloudEntryAuthentication:7,IDECloudEntryAuthentication:8,SimplePassportAuthentication:9,YunZhiJiaAuthentication:10,YunZhiJiaDynamicPwdAuthentication:11,YunZhiJiaQRCodeAuther:12},LoginMethod={Normal:0,ByUserToken:1,SpecDataCenterId:2},qrcodeDivObject=null;window.vQRLifeCycle=1e3,window.isUserQRCodeNew=!1,window.isConnectYZJok=!1,window.cloudAccountTypeId="20",window.SMSVerifyTypeId="25",window.limitGetSMSIntervalCode=-1,window.lanErrRequestStr="",window.LicenseType=-1;var timer=null,checkTimer=null,__execContent=function(e,t){function i(){var t=e("#particles-js"),i={particles:{number:{value:70,density:{enable:!0,value_area:2e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:3},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.5,random:!1,anim:{enable:!0,speed:.07992007992007992,opacity_min:.1,sync:!1}},size:{value:5,random:!1,anim:{enable:!0,speed:9.744926547616142,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:250,color:"#ECF0F1",opacity:.6,width:1},move:{enable:!0,speed:1,direction:"top-right",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:1042.21783956259,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!1,mode:"repulse"},onclick:{enable:!1,mode:"push"},resize:!0},modes:{grab:{distance:800,line_linked:{opacity:1}},bubble:{distance:800,size:40,duration:3,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0};t.length>0&&window.particlesJS("particles-js",i)}function a(e,t){var i=!0,a=!1,n=KD.isEmpty(KD.getQueryString("EntryRole"))?"":KD.getQueryString("EntryRole");return(KD.equalsIgnoreCase(n,"srm")||KD.IsNullOrWhiteSpace(n))&&(a=!0),(!a||KD.isManagementSite()||1!=e&&e!=window.SMSVerifyTypeId&&!t)&&(i=!1),i}function n(){var t=KD.getConnectConfig()&&KD.getConnectConfig().IsPublicCloud;t?e("#divICPNo").css({display:"block","margin-top":"3px"}):(e("#divICPNo").css({display:"none"}),e("#divKDIntroInfo").css({"margin-top":"3px"}))}function o(){var e=KD.entryrolePlugins.getPlugin(KD.getEntryRole()),t=!0,i=!0;e&&KD.isFunction(e.isUseQRCode)&&(i=e.isUseQRCode.call(e));var a=KD.isManagementSite();return(a||!i)&&(t=!1),t}function r(){if(o()){var t=KD.getUrlSubRoot()+"/Kingdee.BOS.ServiceFacade.ServicesStub.QRCode.QRCodeService.GetQRCode.common.kdsvc",i=Date.parse(new Date);e.get(t,'{"timestamp": "'+i+'"}',function(t){var i=KD.parseObject(t);if(1==i.success){window.vQRAccessToken=i.data.token,window.vQRLifeCycle=i.data.expiretime<1e3?6e4:i.data.expiretime,window.dbId=i.dbid,window.appId=i.appid;var a=i.data.url;e("#yzjQRCode").attr("src",a)}else{var n=KD.format("<span class='qrcode-errreload active'><span></span><i class='linefirst'>{0}</i><i class='linesec'>{1}<i></span>",ResManager.LoadKDString("开通云之家","0991733000006701"),ResManager.LoadKDString("畅享二维码登录","0991733000006702"));e(".qr-wrap").find(".qrcode-reload").remove(),e(".qr-wrap").find(".qrcode-errreload").remove(),e(".qr-wrap").append(e(n));var a=KD.getUrlSubRoot()+"/images/biz/default/MainConsole/H5CardLayout/qrcode_grey.png";e("#yzjQRCode").attr("src",a),KD.writeLog("qrcode login error log:"+i.error)}})}}function s(t,i,a){o()&&(scanGuid=e(".scan-guid"),loginQrcode=e(".login-qrcode"),reload=e(".qrcode-reload"),loginQrcode.on("mouseenter",function(){return reload.hasClass("active")?!1:(e(this).addClass("active").animate({left:26},500),scanGuid.animate({right:6,opacity:1},500),!1)}),reload.on("click",function(){e(this).removeClass("active"),loginQrcode.animate({left:26},500),scanGuid.animate({right:6,opacity:1},500),window.isUserQRCodeNew||(clearTimeout(timer),r(),l(),d(t,i,null))}),l())}function l(){if(reload.addClass("active"),!window.isUserQRCodeNew){var e=function(){timer=KD.delayInvoke(e,window.vQRLifeCycle)};timer=KD.delayInvoke(e,window.vQRLifeCycle)}}function d(i,a,n){if(o()&&!(!Y()||e("#yzjQRCode").next("span.qrcode-reload.active").length>0||e("#yzjQRCode").next("span.qrcode-errreload.active").length>0)){var r=KD.getUrlSubRoot()+"/Kingdee.BOS.ServiceFacade.ServicesStub.QRCode.QRCodeService.GetQRCodeTicket.common.kdsvc",s=Date.parse(new Date);e.post(r,'{"token": "'+window.vQRAccessToken+'","timestamp": "'+s+'"}',function(e){var a=KD.parseObject(e);return null==e?void(checkTimer=KD.delayInvoke(d,2e3,!0)):""==e?void(checkTimer=KD.delayInvoke(d,2e3,!0)):void(1==a.success?null!=a.data.ticket&&a.data.ticket!=t?(window.ticktId=a.data.ticket,h(i,qrcodeDivObject,null),c()):(alert(e.description),checkTimer=KD.delayInvoke(d,2e3,!0)):checkTimer=KD.delayInvoke(d,2e3,!0))})}}function c(){window.ticktId=null,window.appId=null,window.dbId=null,window.vQRAccessToken=null,window.vQRLifeCycle=1e3}function h(t,i,a){var n=new LoginInfo;e.extend(n,{EncyptType:1,PasswordIsEncrypted:!1,AuthenticateType:12,ClientInfo:KD.getClientInfo()});try{var o={sessionkey:KDCookieManager.getKDSessionId(),scope:i,response_error:function(e){var t={};"response_error:"==(e||"").substr(0,15)?(t=KD.parseObject((e||"").substr((e||"").indexOf("{"))),t={sourceClass:t.ClassName,sourceMethod:t.ExceptionMethod,msg:t.Message||(e||"").substr(30),description:e}):t={name:"",number:"",description:e},KD.Error.raise(t)},callback:function(e){var t=this;t.isAsyncJs=!1;try{var i="string"==typeof e?KD.parseObject(e):e;if(KDCookieManager.updateSessionId(i),1==KD.IsHtml5LoginForSilverlight)return void(t.ok&&t.ok.call(t,i));if(i.LoginResultType==KD.LoginResultType.Success){var a=function(){t.ok&&t.ok.call(t,i)};if(KD.isSameUTimeZone(i)||KD.getLocalConfiguration(i).NotShowUtcOffset)a();else{var n={name:ResManager.LoadKDString("金蝶提示","0991733000004008"),number:"",msg:b(i),description:"",type:KDMessageBox.KDMesBoxType.Warning,button:KDMessageBox.KDMessageBoxButtons.YesNo,callback:function(e){e==KDMessageBox.KDDialogResult.Yes?a():E()}};KD.Error.raise(n)}}else D(i)?(t.isAsyncJs=!0,k(t,function(e,t){x.call(e,t)},i)):x.call(t,i)}catch(o){KD.writeError(o)}finally{t.isAsyncJs||KD.delayInvoke(function(){t.waiting.hide.call(t.waiting)},1e3)}},errcallback:function(e){var t=this;e||(e="return null error"),t.err&&t.err({msg:ResManager.LoadKDString("登录失败","0991733000004007"),type:KDMessageBox.KDMesBoxType.Error,description:e.responseText||e})}};n.Username="******",n.Password="******",n.AcctID=window.dbId,n.Lcid=2052,n.AppId=window.appId,n.OpenToken=window.ticktId;var l=new HTMLFormHandlerProxy;l.ValidateUser.call(l,o,n),c(),r(),s($this,i,null),d($this,i,null)}catch(h){KD.Error.raise({msg:"login error",description:h.toString()})}finally{}}function u(){e(".k-dropdown-wrap",e("#loginDBInfo")).css({border:"none",background:"#fff","text-align":"right","box-shadow":"none"}),e(".k-dropdown",e("#loginDBInfo")).css({border:"none",background:"#fff","box-shadow":"none"}),e(".k-dropdown-wrap",e("#divqrcodedatacenterinfo")).css({border:"none",background:"#fff","text-align":"right","box-shadow":"none"}),e(".k-dropdown",e("#divqrcodedatacenterinfo")).css({border:"none",background:"#fff","box-shadow":"none"})}function p(t){var i={user:"",acc:"",lan:"",ver:""};try{var a=KD.entryrolePlugins.getPlugin(t.entryrole),n=!0;a&&e.isFunction(a.isUseDefaultLoginUI)&&(n=a.isUseDefaultLoginUI.call(a));var o="",r=e("#language").data("kendoDropDownList").value(),s="",l=e("#user").val(),i={user:l,lan:r};if(n){var d=e("#datacenter");o=d.data("kendoDropDownList").value();var c=e("#verifyType");s=c.data("kendoDropDownList").value(),e.extend(i,{acc:o,ver:s})}a&&e.isFunction(a.beforeSaveCookies)&&a.beforeSaveCookies.call(a,i)}catch(h){}finally{KD.storage.setItem(KD.CONST.k3CloudLoginInfoKey,JSON.stringify(i))}}function g(t){var i={user:"",acc:"",lan:"",ver:""};try{var a=KD.storage.getItem(KD.CONST.k3CloudLoginInfoKey)||"{}",n=KD.parseObject(a);i=e.extend(i,n);var o=KD.entryrolePlugins.getPlugin(t.entryrole);o&&e.isFunction(o.afterLoadCookies)&&o.afterLoadCookies.call(o,i)}catch(r){}finally{t.__LoginInfo=i}}function f(){E()}function m(t,i,a){if("1"==KD.IsLoginManualInputDC()){var n=e("#inputDatacenter").val();if(""==n.trim())return KDMessageBox.show({msg:ResManager.LoadKDString("请输入数据中心","0991733030034783"),type:KDMessageBox.KDMesBoxType.Warning}),!1;if(e("#spanDatacenter").hasClass("k-i-wrong"))return KDMessageBox.show({msg:ResManager.LoadKDString("数据中心不正确，请重新输入","0991733030034784"),type:KDMessageBox.KDMesBoxType.Warning}),!1}var o=e("#datacenter"),n=o.data("kendoDropDownList")&&o.data("kendoDropDownList").value();if(n&&n.trim&&""==n.trim())return KDMessageBox.show({msg:ResManager.LoadKDString("数据中心未加载。","014004030026308"),type:KDMessageBox.KDMesBoxType.Warning}),!1;var i=e("#language"),r=i.data("kendoDropDownList").value();if(""==r.trim())return KDMessageBox.show({msg:ResManager.LoadKDString("语言未加载。","0991733030031988"),type:KDMessageBox.KDMesBoxType.Warning}),!1;var s=e("#user").val(),l=e("#password").val();if(KD.IsNullOrWhiteSpace(s)&&t!=AuthenticationType.CAAuthentication.toString())return KDMessageBox.show({msg:a?ResManager.LoadKDString("请输入手机号。","0991733000004315"):ResManager.LoadKDString("请输入用户名。","0991733000004004"),type:KDMessageBox.KDMesBoxType.Warning}),!1;if(KD.IsNullOrWhiteSpace(l))return KDMessageBox.show({msg:ResManager.LoadKDString("请输入密码。","0991733000004005"),type:KDMessageBox.KDMesBoxType.Warning}),!1;var d=i.val();return KD.IsNullOrWhiteSpace(ResFactoryProxy.res[d])?(KDMessageBox.show({msg:"Cannot find file MlResource_"+d+",please contact the admin or change the language and log in again.",type:KDMessageBox.KDMesBoxType.Error}),!1):!0}function v(t,i){if(i==AuthenticationType.CAAuthentication.toString()){var a=e("#CAuser").data("kendoDropDownList"),n=a.value();if(KD.isEmpty(n))return KD.Error.raise({type:KDMessageBox.KDMesBoxType.Error,msg:ResManager.LoadKDString("请选择证书","0991733030034787")}),!1;var o=null,r=new Date,s=(1e4*r.getTime()+621355968e9-6e8*r.getTimezoneOffset()+102).toString();try{o=getSignLogonData(n,s)}catch(l){return KD.Error.raise({type:KDMessageBox.KDMesBoxType.Error,msg:l.stack}),!1}return KD.isEmpty(o)?(KD.Error.raise({type:KDMessageBox.KDMesBoxType.Error,msg:ResManager.LoadKDString("签名时发生错误，请重试","0991733030034788")}),!1):o.Success?(KD.isEmpty(o.RawSignData)||(s=o.RawSignData),t.RawSignData=s,t.SignedData=o.SignedData,!0):(KD.Error.raise({type:KDMessageBox.KDMesBoxType.Error,msg:kendo.format(ResManager.LoadKDString("签名时发生错误，错误号：{0}，错误描述：{1}","0025710030033250"),o.HexCode,o.Message)}),!1)}return!0}function y(i,a,n,o,r){if(KD.isShowAcceptCookieForm())return void KD.acceptCookieVerify(!0);var s=new LoginInfo;e.extend(s,{EncyptType:1,PasswordIsEncrypted:!1,AcctID:"",AuthenticateType:1,ClientInfo:C()}),o&&r&&r.Context&&!KD.isEmpty(r.Context.UserToken)&&(s.LoginMethod=LoginMethod.ByUserToken,s.UserToken=r.Context.UserToken);var l=e("#datacenter"),d=e("#language"),c=e("#verifyType"),h=e("#velidationCode"),u=0;c&&c.data&&c.data("kendoDropDownList")&&c.data("kendoDropDownList").value&&(u=c.data("kendoDropDownList").value());var h=e("#velidationCode");if(v(s,u)&&m(u,d,U())){e("#oldpassword").val(e("#password").val());var g=new KD.blocking;g.show.call(g,{target:e("#MainPanel"),id:"dbox",text:ResManager.LoadKDString("登录校验中...","0991733000004006")});try{KD.isEmpty(a.currentTarget)&&(a.currentTarget=i),a.waiting=g;var f={sessionkey:KDCookieManager.getKDSessionId(),scope:a,response_error:function(e){var t=this,i={};"response_error:"==(e||"").substr(0,15)?(i=KD.parseObject((e||"").substr((e||"").indexOf("{"))),i={sourceClass:i.ClassName,sourceMethod:i.ExceptionMethod,msg:i.Message||(e||"").substr(30),description:e}):i={name:"",number:"",description:e},t.waiting.hide.call(t.waiting),KD.Error.raise(i)},callback:function(e){var t=this;t.isAsyncJs=!1;try{var i="string"==typeof e?KD.parseObject(e):e;if(KDCookieManager.updateSessionId(i),1==KD.IsHtml5LoginForSilverlight)return void(t.ok&&t.ok.call(t,i));switch(i.LoginResultType){case KD.LoginResultType.Success:case KD.LoginResultType.PWInvalid_Optional:case KD.LoginResultType.DealWithForm:case KD.LoginResultType.Wanning:p(f.scope)}if(i.LoginResultType==KD.LoginResultType.Success){var a=function(){t.ok&&t.ok.call(t,i)};if(KD.isSameUTimeZone(i)||KD.getLocalConfiguration(i).NotShowUtcOffset)a();else{var n={name:ResManager.LoadKDString("金蝶提示","0991733000004008"),number:"",msg:b(i),description:"",type:KDMessageBox.KDMesBoxType.Warning,button:KDMessageBox.KDMessageBoxButtons.YesNo,callback:function(e){e==KDMessageBox.KDDialogResult.Yes?a():E()}};KD.Error.raise(n)}}else D(i)?(t.isAsyncJs=!0,t.currentLanId=ResManager.Language,k(t,function(e,t){x.call(e,t),e.waiting.hide.call(e.waiting),ResManager.setLanguage(e.currentLanId)},i)):x.call(t,i)}catch(o){KD.writeError(o)}finally{t.isAsyncJs||KD.delayInvoke(function(){t.waiting.hide.call(t.waiting)},50)}},errcallback:function(e){var t=this;e||(e="return null error"),t.waiting.hide.call(t.waiting),t.err&&t.err({msg:ResManager.LoadKDString("登录失败","0991733000004007"),type:KDMessageBox.KDMesBoxType.Error,description:e.responseText||e})}},y=KD.entryrolePlugins.getPlugin(a.entryrole),w=!0;y&&e.isFunction(y.isUseDefaultLoginUI)&&(w=y.isUseDefaultLoginUI.call(y));var K=e("#user").val();u==AuthenticationType.CAAuthentication.toString()&&(K=e("#CAuser").data("kendoDropDownList").text());var S=n?n.isShowLoggedInMessage:t;!w&&y&&e.isFunction(y.getLogininfo)?(s=y.getLogininfo.call(y,s),s&&(s.IsShowLoggedInMessage=S===t?ClientAppProxy.isShowLoggedInMessage():S)):(s.Username=K,s.Password=e("#password").val(),s.AcctID=l.data("kendoDropDownList").value(),s.Lcid=d.data("kendoDropDownList").value(),s.AuthenticateType=U()?window.cloudAccountTypeId:c.data("kendoDropDownList").value(),s.ValidationCode=h.val(),s.SMSCode=se(),s.IsShowLoggedInMessage=S===t?ClientAppProxy.isShowLoggedInMessage():S);var I=new HTMLFormHandlerProxy;I.ValidateUser.call(I,f,s)}catch(P){KD.Error.raise({msg:"login error",description:P.toString()})}finally{}}}function b(e){var t=ResManager.LoadKDString("本地操作系统时区与登录用户时区不一致，建议修改本地操作系统时区后，重新刷新浏览器。","0991733000008451")+"\n"+ResManager.LoadKDString("本地操作系统时区：{0}。","0991733030034195")+"\n"+ResManager.LoadKDString("登录用户时区：{1}。","0991733000008452")+"\n"+ResManager.LoadKDString("是否继续登录？","0991733000008453"),i="";if(e&&e.Context&&e.Context.UTimeZone){var a=e.Context.UTimeZone,n=a.OffsetTicks/1e7/60/60;i+=a.StandardName+"("+(n>0?"+"+n:n)+")"}var o=-1*(new Date).getTimezoneOffset()/60;return KD.format(t,KD.getTimeZoneName()+"("+(o>0?"+"+o:o)+")",i)}function D(t){var i=!1,a=KD.isDebug();switch(t.LoginResultType){case KD.LoginResultType.PWInvalid_Required:case KD.LoginResultType.PWInvalid_Optional:case KD.LoginResultType.Activation:case KD.LoginResultType.DealWithForm:case KD.LoginResultType.PWError:i=!0}return i&&(i=a?0==e('[data-requiremodule="kendo.view"]',"head").length:0==e('[data-requiremodule="k3cloudmin"]',"head").length),i}function k(t,i,a){e('[data-requirecontext="_"]',"head").remove();var n=KD.isDebug();window.isLoadFullRes=!0,window.onKDScriptReady=function(){KD.triggerPluginsReady(),i&&i(t,a),window.isLoadFullRes=!1,KD.GetServerCommonConfig()},KDCustomControlProxy.createResourceNodeBatch({items:[{key:KD.getUrlRoot()+"/"+KD.getSubPath()+"/kdformjsloader"+(n?"":".min"),ver:KD.getVersion(),jsUrl:KD.getUrlRoot()+"/"+KD.getSubPath()+"/script/kdformjsloader"+(n?"":".min")+".js"}],scope:this,onComplete:function(e){},onError:function(n){KD.writeLog(n.message||"error",n.stack||KD.stringify(n)),a=e(a||{},{error:!0}),i&&i(t,a)}})}function C(){return KD.getClientInfo()}function x(i){var a=this,n=t,o=(i.Message||"")+(i.ErrorStackTrace||"");switch(i.LoginResultType){case KD.LoginResultType.Failure:n={name:ResManager.LoadKDString("金蝶提示","0991733000004008"),number:"",msg:o,description:o,type:KDMessageBox.KDMesBoxType.Error,button:KDMessageBox.KDMessageBoxButtons.Ok,callback:function(e){E(),a.setEnabled.call(a,!0)}};break;case KD.LoginResultType.EntryCloudUnBind:n={name:ResManager.LoadKDString("金蝶提示","0991733000004008"),number:"",msg:i.Message,description:o,type:KDMessageBox.KDMesBoxType.Error,button:KDMessageBox.KDMessageBoxButtons.Ok,callback:function(e){a.setEnabled.call(a,!0)}};break;case KD.LoginResultType.PWError:n={name:ResManager.LoadKDString("金蝶提示","0991733000004008"),number:"",msg:i.Message,description:o,type:KDMessageBox.KDMesBoxType.Error,button:KDMessageBox.KDMessageBoxButtons.Ok,callback:function(e){a.setEnabled.call(a,!0),a.setPassword.call(a,""),E()}};break;case KD.LoginResultType.PWInvalid_Optional:
var r=e("#oldpassword").val();a.setPassword(""),i.buildsessiononly=!0,KD.buildsession(i),n={name:ResManager.LoadKDString("密码修改提示","0991733000004009"),number:"",msg:i.Message,description:o,type:KDMessageBox.KDMesBoxType.Question,button:KDMessageBox.KDMessageBoxButtons.OkCancel,callback:function(e){e==KDMessageBox.KDDialogResult.Ok?a.showModifyPwdWindow.call(a,r,i):a.ok?(i.LoginResultType=KD.LoginResultType.Success,a.ok.call(a,i)):E()}};break;case KD.LoginResultType.PWInvalid_Required:var r=e("#oldpassword").val();a.setPassword(""),n={name:ResManager.LoadKDString("密码修改提示","0991733000004009"),number:"",msg:i.Message,description:o,type:KDMessageBox.KDMesBoxType.Warning,button:KDMessageBox.KDMessageBoxButtons.Ok,callback:function(e){a.showModifyPwdWindow.call(a,r,i)}};break;case KD.LoginResultType.Activation:var r=e("#oldpassword").val();a.setPassword(""),i.buildsessiononly=!0,KD.buildsession(i),n={name:ResManager.LoadKDString("激活提示","0991733000004010"),number:"",msg:i.Message||ResManager.LoadKDString("用户需要在线激活！","0991733030034198"),description:o,type:KDMessageBox.KDMesBoxType.Warning,button:KDMessageBox.KDMessageBoxButtons.Ok,callback:function(e){a.showActivationForm.call(a,r,i)}};break;case KD.LoginResultType.Wanning:var s=KDMessageBox.KDMesBoxType.Warning,l=KDMessageBox.KDMessageBoxButtons.Ok,d="$"==(i.MessageCode||" ").substr(0,1);"$ReqMsgOption_Question"==i.MessageCode?(s=KDMessageBox.KDMesBoxType.Question,l=KDMessageBox.KDMessageBoxButtons.YesNo):"$ReqMsgOption_Error"==i.MessageCode&&(s=KDMessageBox.KDMesBoxType.Error,l=KDMessageBox.KDMessageBoxButtons.OkCancel),n={name:ResManager.LoadKDString("警告提示","0991733000004011"),number:"",msg:i.Message,description:o,type:s,button:l,callback:function(e){(e==KDMessageBox.KDDialogResult.Yes||e==KDMessageBox.KDDialogResult.Ok)&&(d?y(a,a,{isShowLoggedInMessage:!1},!0,i):(i.LoginResultType=KD.LoginResultType.Success,a.ok.call(a,i)))}};break;case KD.LoginResultType.DealWithForm:i.buildsessiononly=!0,i.modal=!0,KD.buildsession(i),a.showSpecialForm.call(a,i,i.FormId,i.FormInputObject)}n&&KD.Error.raise(n)}function w(t){var i=e("#inputDatacenter").val(),a=e("#spanDatacenter"),n=e("#datacenter"),o=0,r="";if(""==i?a.css("visibility","hidden"):a.css("visibility","visible"),t&&t.length>0)for(var s=0;s<t.length;s++){var l=t[s];l.alias==i&&(o++,r=l.value)}1==o?(n.data("kendoDropDownList").value(r),n.data("kendoDropDownList").trigger("change"),a.addClass("k-i-right").removeClass("k-i-wrong").attr("title",ResManager.LoadKDString("数据中心匹配成功","0991733030034785"))):o>1?a.addClass("k-i-wrong").removeClass("k-i-right").attr("title",KD.format("含有多个命名为{0}的数据中心",i)):a.addClass("k-i-wrong").removeClass("k-i-right").attr("title",KD.format(ResManager.LoadKDString("无法匹配为{0}的数据中心","0991733030034786"),i))}function K(t,i){if(!KD||!KD.autologin){var a=e("#datacenter"),n=t;i.currentTarget=t;var o={scope:i,callback:function(t){var o=this;try{var r=KD.parseObject(t);i.currentTarget.data=r;for(var s=[],l=null,d=0,c=0;c<r.length;c++){var l=r[c],h=l.Name;e.each(l.LocaleValueName,function(e,t){t.Key==ResManager.Language&&(h=t.Value)}),s.push([l.Id,h]),o.__LoginInfo&&l.Id==o.__LoginInfo.acc&&(d=c)}var u=KD.getEnumSource(s),p={dataSource:u,popup:{origin:"bottom right",position:"top right"},dataTextField:"alias",dataValueField:"value",height:350,autoWidth:!0,valueTemplate:'<span title="#: alias #" class="toolTip"> #: alias #</span>',noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490"),template:'<span title="#: alias #" style="display:inline-block; width:100%; height:100%;"> #: alias #</span>',change:function(e){F(n,this.value(),o)},dataBound:function(e){B()}};u&&u.length>=8&&(p.filter="contains",p.minLength=1,p.delay=0),a.kendoDropDownList(p),a.data("kendoDropDownList").select(d),a.data("kendoDropDownList").trigger("change"),KD.isManagementSite()&&(e("#datacenter").data("kendoDropDownList").enable(!1),l&&l.IsNotDefaultAdmin||e("#user").val("Administrator").attr("readonly","true").addClass("k-state-disabled"),e("#verifyType_ct").hide()),"1"==KD.IsLoginManualInputDC()?(e("#datacenter_ct").css("margin-right","10px"),e("#inputDatacenter").css("display","inline-block").off("keyup").keyup(function(e){w(u)}),e("#spanDatacenter").css("visibility","hidden"),e("#spanDatacenter").css("display","inline-block"),e("#datacenter").data("kendoDropDownList").span.closest(".k-header").css("display","none")):(e("#inputDatacenter").css("display","none"),e("#spanDatacenter").css("display","none"),e("#datacenter").data("kendoDropDownList").span.closest(".k-header").css("display","inline-block"))}catch(g){o.err({msg:ResManager.LoadKDString("初始数据中心列表失败!","0991733000004012"),description:""})}},errcallback:function(e){var t=this;t.err&&t.err({msg:ResManager.LoadKDString("初始数据中心列表失败!","0991733000004012"),description:""})}},r=new AccountClientProxy;r.getDataCenterList.call(r,o,1)}}function S(t,i){if(i=parseInt(i),!KD.isEmpty(t)&&!KD.isNaN(i)){var a,n;if(1==t&&(a=2052==i||3076==i?"kd-bgdemolictype":"kd-bgdemolictype1033"),2==t)switch(i){case 1033:a="kd-bglimitlictype1033";break;case 2052:a="kd-bglimitlictype";break;case 3076:a="kd-bglimitlictype3076";break;default:a="kd-bglimitlictype1033"}KD.isEmpty(a)||KD.IsNullOrWhiteSpace(a)||(n=e("#divTitle").find(".kd-lic-logo"),n.length>0?n.removeClass().addClass("kd-lic-logo").addClass(a):(n=e(KD.format('<div class="kd-lic-logo {0}"></div>',a)),e("#divTitle").length>0&&e("#divTitle").append(e(n))))}}function I(t){var i=[];try{var a=0;if(!t.currentTarget)return;var n=e("#datacenter").data("kendoDropDownList");dcValue=n.value();for(var o=0;o<t.currentTarget.data.length;o++){var r=t.currentTarget.data[o];r.Id==dcValue&&(a=o);var s=KD.isEmpty(r.Name)?"":r.Name;e.each(r.LocaleValueName,function(e,t){t.Key==ResManager.Language&&(s=t.Value)}),i.push([r.Id,s])}var l=t.currentTarget.data[a],d=new kendo.data.DataSource({data:KD.getEnumSource(i)});n.setDataSource(d),n.select(a),L(ResManager.Language,l)}catch(c){KD.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013")+KD.stringify(t.currentTarget.data[0]),description:c.stack})}}function P(e,t){try{var i=this;ResManager.setLanguage(e),S(window.LicenseType,e),KDCustomControlProxy.loadLanguageRes(e,i,function(t,i){var a=Y();ResManager.setLanguage(e),KD.setLoginLang(),a&&H()})}catch(a){KD.Error.raise({msg:ResManager.LoadKDString("语言变更失败","0991733030033484"),description:a.toString()})}}function F(t,i,a){var n=e("#language"),o=(e("#verifyType"),t),r=0;try{for(var s=0;s<o.data.length;s++){var l=o.data[s];l.Id==i&&(r=s)}var d=o.data[r];ResManager.Language}catch(c){KD.Error.raise({msg:ResManager.LoadKDString("初始认证列表失败!_datacenter_kendo_changed","0991733000004014"),description:c.stack})}var h={scope:a,response_error:function(t){window.lanErrRequestStr=t;var i={scope:a,response_error:function(e){KD.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:e})},callback:function(e){try{var t=KD.parseObject(e);t&&t.ISCONNECTSUCCESS&&1==t.ISCONNECTSUCCESS?KD.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:window.lanErrRequestStr}):KD.Error.raise({msg:t.MESSAGE})}catch(i){KD.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:i.stack})}},errcallback:function(e){var t=this;t.err&&KD.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:e})}},n=e("#language").data("kendoDropDownList").value(),o=a&&a.__LoginInfo&&a.__LoginInfo.lan;n=n?n:o;var r=new AccountClientProxy;r.getDataCenterDBStatus.call(r,i,e("#datacenter").data("kendoDropDownList").value(),KD.isManagementSite(),e("#user").val(),n?n:2052)},callback:function(e){try{var t=this,i=KD.parseObject(e),a=0,o=[];if(i.length>0){var r=i[0];window.LicenseType=r&&r.LicenseType}for(var s=0;s<i.length;s++){var l=i[s],d=l.LocaleName;d&&d.replace&&d.indexOf&&d.indexOf("/中国")>0&&(d=d.replace("/中国","")),o.push([l.LocaleId,d]),t.__LoginInfo&&l.LocaleId&&l.LocaleId.toString()==t.__LoginInfo.lan.toString()&&(a=s)}var c=KD.getEnumSource(o),h=n.kendoDropDownList({dataSource:c,popup:{origin:"bottom right",position:"top right"},dataTextField:"alias",dataValueField:"value",autoWidth:!0,noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490"),valueTemplate:'<span title="#: alias #" class="toolTip"> #: alias #</span>',change:function(e){P(this.value(),t)},dataBound:function(e){B()}}).data("kendoDropDownList");Y()&&H(),h.select(a),ResManager.setLanguage(o[a][0]),window.LicenseType>-1&&!KD.IsNullOrWhiteSpace(ResManager.Language)&&S(window.LicenseType,ResManager.Language),KDCustomControlProxy.loadLanguageRes(ResManager.Language,t,function(e,t){KD.setLoginLang()}),I(t)}catch(u){KD.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:u.stack})}},errcallback:function(e){var t=this;t.err&&KD.Error.raise({msg:ResManager.LoadKDString("初始语言列表失败!","0991733000004013"),description:e})}},u=new AccountClientProxy;u.getDataCenterLoginLanguages.call(u,h,"zh-CN",1,d.Id,d.DBType),M(d),T(),Q(d.Id),le(""),ae()}function T(){var t=KD.getEntryRoleConfig();"srm"==t?e("#grid_SRMSupplier").css("display","block"):e("#grid_SRMSupplier").css("display","none")}function _(){var i=AuthenticationType.DomainAuthentication;if(e("#verifyType")&&e("#verifyType").data("kendoDropDownList")&&e("#verifyType").data("kendoDropDownList").value&&(i=e("#verifyType").data("kendoDropDownList").value()),i.toString()==AuthenticationType.CAAuthentication.toString()){R(!1);var a=e("#CAuser").data("kendoDropDownList");KD.isEmpty(a)&&(a=e("#CAuser").kendoDropDownList({dataSource:{data:[]},dataTextField:"name",dataValueField:"id"}).data("kendoDropDownList"),a._arrow&&a._arrow.css("margin-top","-8px"));try{initCAActiveXObj()}catch(n){}var o=getCerts();if(o==t||null==o)return void KD.Error.raise({type:KDMessageBox.KDMesBoxType.Error,msg:ResManager.LoadKDString("未找到CA插件，请安装CA插件。插件安装完成后，请重启浏览器。","0025710030033247")});if(o&&o.length<=0)return void KD.Error.raise({type:KDMessageBox.KDMesBoxType.Error,msg:ResManager.LoadKDString("未找到CA证书，请检查证书是否已安装","0025710030033248")});for(var r=[],s=0,l=0;o&&o.length&&l<o.length;l++){var d=o[l];r.push({id:d.SerialNumber,name:d.CommonName}),d.CommonName==$this.__LoginInfo.user&&(s=l)}var c=new kendo.data.DataSource({data:r});a.setDataSource(c),a.select(s)}else N()}function A(e,t,i){_(),Z(e),le(""),KD.IsNullOrWhiteSpace(e)||(j(),V(!0))}function L(t,i){for(var a=e("#verifyType"),n=i.AuthenticationMethods,o=[],r="",s=0,l=!1,d=this,c=0;c<n.length;c++)if(r=n[c].Name,n[c].AuthenticationMethodType!=AuthenticationType.CAAuthentication.toString()||KD.isIeBrowser()){for(var h=0;h<n[c].MultiLangName.length;h++)if(n[c].MultiLangName[h].Key==t){r=n[c].MultiLangName[h].Value;break}$this&&$this.__LoginInfo&&n[c].AuthenticationMethodType.toString()==$this.__LoginInfo.ver.toString()&&i.Id==$this.__LoginInfo.acc&&(s=c,1==l&&(s-=1)),o.push([n[c].AuthenticationMethodType,r])}else l=!0;var u=a.kendoDropDownList({dataSource:KD.getEnumSource(o),popup:{origin:"bottom right",position:"top right"},autoWidth:!0,valueTemplate:'<span title="#: alias #" class="toolTip"> #: alias #</span>',dataTextField:"alias",noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490"),dataValueField:"value",dataBound:function(e){B()},change:function(e){A(this.value(),this.text(),d)}}).data("kendoDropDownList");u&&u.select(s),_(),V(!1),j(),Z()}function M(t){t.IsNeedValicationCode?(e("#grid_VelidationCode").css("display","block"),e("#dbox").css("min-height","410px"),e("#loginBtnInfo").css("margin-top","20px"),E()):(e("#dbox").css("min-height","410px"),e("#grid_VelidationCode").css("display","none"),e("#loginBtnInfo").css("margin-top","48px")),_isUseKingdeeUnifiedStyle()&&e("#loginBtnInfo").css("margin-top","73px")}function E(){if("none"!=e("#grid_VelidationCode").css("display")){e("#velidationCode").val("");var t=new AccountClientProxy,i={callback:function(t){try{var i=KD.parseObject(t);i.KDSID&&KDCookieManager.setKDSessionId(i.KDSID),i.ASPNETSID&&KDCookieManager.setAspNetSessionId(i.ASPNETSID);var a="data:image/jpeg;base64,"+i.imageData;e("#img_VelidationCode").attr("src",a)}catch(n){KD.Error.raise({msg:ResManager.LoadKDString("验证码加载失败!","0991733000004015"),description:n.toString()})}},errcallback:function(e){var t=this;KD.parseObject(e);t.err&&KD.Error.raise({msg:ResManager.LoadKDString("验证码加载失败!","0991733000004015"),description:e})}};t.getValidationCodeObject.call(t,i)}}function B(){e("#loginDBInfo .toolTip[title!='']").kendoTooltip({position:"top",animation:{open:{duration:1}}})}function R(t){var i=e("#CAuser").data("kendoDropDownList"),a=e("#user").data("kendoAutoComplete");t?(e("#user").css({visibility:"visible"}),e("#CAuser").css({visibility:"hidden"}),e("#user").css({display:"inline-block"}),a&&a.wrapper&&a.wrapper.show(),i&&i.wrapper&&i.wrapper.hide()):(e("#user").css({visibility:"hidden"}),e("#CAuser").css({visibility:"visible"}),a&&a.wrapper&&a.wrapper.hide(),i&&i.wrapper&&i.wrapper.show(),KD.isEmpty(a)||KD.isEmpty(a.wrapper)?e("#user").css({display:"none"}):e("#user").css({display:"inline-block"}))}function N(){if((!ClientAppProxy.Current||!ClientAppProxy.Current.getIsNotLoginUserByHistory())&&(R(!0),KD.isEmpty(e("#user").data("kendoAutoComplete")))){var t=KD.storage.getItem("userHistory")||"{}",i=KD.parseObject(t),a=[];for(var n in i)a.push([i[n].acc,i[n].user]);var o=KD.getEnumSource(a);e("#user").kendoAutoComplete({dataSource:o,clearButton:!1,dataTextField:"alias",dataValueField:"value",animation:!1,noDataTemplate:ResManager.LoadKDString("无数据","0991733000004096"),template:'#: alias #<span class="kd_iconDelUserHistory"></span>',close:function(t){t.sender.ul.children(":hidden").each(function(){var t=e("#user").data("kendoAutoComplete").dataSource;t.filter({field:"alias",operator:"contains",value:e(this).text()});var i=t.view();t.remove(i[0]),t.sync()})},dataBound:function(t){e(".kd_iconDelUserHistory").bind("click",function(e){function t(e){for(var t=[],i=e.parentNode.parentNode.firstChild;i;i=i.nextSibling)1===i.nodeType&&i!==e&&t.push(i);return t}e.preventDefault(),e.stopPropagation(),this.parentNode.style.display="none";var i=KD.storage.getItem("userHistory")||"{}",a=KD.parseObject(i),n=this.parentNode.innerText;document.getElementById("user").value==n&&(document.getElementById("user").value=""),delete a[n],KD.storage.setItem("userHistory",JSON.stringify(a));for(var o=t(this),r=0;r<o.length&&"none"==o[r].style.display;r++);r==o.length&&(this.parentNode.parentNode.parentNode.parentNode.parentNode.style="none")})}})}}function H(){u(),e("#childframe").attr("src","");var t=e("#datacenter").data("kendoDropDownList")&&e("#datacenter").data("kendoDropDownList").value(),i=e("#language").data("kendoDropDownList")&&e("#language").data("kendoDropDownList").value(),a=KD.getUrlSubRoot()+"/Kingdee.BOS.WebApi.ServicesStub.YunZhiJiaService.GetYunZhiJiaInfobydbid.common.kdsvc";!Y()||KD.IsNullOrWhiteSpace(t)||KD.IsNullOrWhiteSpace(i)||e.post({url:a,data:{dbid:t},success:function(t,i){var a=KD.parseObject(t);if(0==a.Successful)return void O(a.Message);var n=e("#datacenter").data("kendoDropDownList")&&e("#datacenter").data("kendoDropDownList").value(),o=e("#language").data("kendoDropDownList")&&e("#language").data("kendoDropDownList").value(),r=a.Result.CloudServiceHost,s=a.Result.EID;if(KD.IsNullOrWhiteSpace(s)||KD.IsNullOrWhiteSpace(r))O(),e("#childframe").attr("src","");else{var l,d=KD.base64Encode(KD.format('{"dbid":"{0}","entryrole":"XT","lcid":{1},"origintype":"XTTD","formid":"","formtype":"","pkid":""}',n,o)),c=KD.urlEncodeComponent(KD.format("{0}/html5/index.aspx?ud={1}&dbid={2}&lcid={3}&loginType=qrcode",r,d,n,o)),h="https:"==document.location.protocol?!0:!1;if(h){var u=KD.urlEncodeComponent(KD.format("{0}/html5/content/themes/kd.ui.qrlogin.css",KD.getUrlSubRoot()));l="https://www.yunzhijia.com/opencloud/openthird/qrconnet?appid=10867&redirect_uri="+c+"&csshref="+u}else l="https://www.yunzhijia.com/opencloud/openthird/qrconnet?appid=10867&redirect_uri="+c+"&csshref=https%3A%2F%2Ffile.open.kingdee.com%2Fk3cloud%2Fuploads%2Fcss%2Fqrcodeforyzj%2Fk3cloudqrcode.css";e(".qr-wrap").find(".qrcode-errreload").remove(),e("#childframe").attr("src",l)}}})}function O(t){var i=KD.format("<span class='qrcode-errreload active'><span></span><i class='linefirst'>{0}</i><i class='linesec'>{1}<i></span>",ResManager.LoadKDString("开通云之家","0991733000006701"),ResManager.LoadKDString("畅享二维码登录","0991733000006702"));i=KD.IsNullOrWhiteSpace(t)?i:KD.format("<span class='qrcode-errreload active'><span></span><i class='linefirst'>{0}</i><i class='linesec'><i></span>",t),e(".qr-wrap").find(".qrcode-reload").remove(),e(".qr-wrap").find(".qrcode-errreload").remove(),e(".qr-wrap").append(e(i))}function V(t){var i=e("#user"),a=U();t&&z();var n=a?window.cloudAccountTypeId:e("#verifyType").data("kendoDropDownList")&&e("#verifyType").data("kendoDropDownList").value(),o=ResManager.LoadKDString("用户名","0991733000004017");switch(n){case"10":o=ResManager.LoadKDString("手机号","014004030033670");break;case window.cloudAccountTypeId:o=ResManager.LoadKDString("手机号","014004030033670");break;default:o=ResManager.LoadKDString("用户名","0991733000004017")}t?i.val("").attr("placeholder",o):i.attr("placeholder",o)}function j(){var t=null,i=e("#verifyType").data("kendoDropDownList");i&&i.value&&(t=i.value()),"cloudaccount"==_getLoginType()?e("#forgetpass").show():!KD.isEmpty(KD.getQueryString("EntryRole"))||KD.isManagementSite()||1!=t&&t!=window.cloudAccountTypeId&&t!=window.SMSVerifyTypeId?e("#forgetpass").hide():e("#forgetpass").show()}function z(){E(),e("#password").val("")}function U(t){var i=!1,a=e('#loginContainer .boxtitles .boxtitle[data-type="cloudaccount"]');return a.length>0&&a.hasClass("active")&&!Y()&&(i=!0),i}function q(){var t=KD.getUrlSubRoot()+"/Kingdee.BOS.WebApi.ServicesStub.YunZhiJiaService.GetYZJConnectInfo.common.kdsvc";e.post({url:t,data:{appid:10867},timeout:2e3,success:function(e){var t=KD.parseObject(e);t.Successful?(window.isConnectYZJok=!0,H(),KD.writeLog("Connect YZJ OK!")):(O(t.Message),KD.writeLog(t.Message))},error:function(e,t,i){"timeout"==t&&(O(ResManager.LoadKDString("应用服务器连不上云之家","014002030031931")),KD.writeLog("Connect YZJ TIMEOUT!"))}})}function G(t,i){var a=e(this);if("qrcode"!==a.data("type")&&W(),!a.hasClass("active"))if(a.siblings().removeClass("active"),a.addClass("active"),"account"==a.data("type")||"cloudaccount"==a.data("type")){if(e("#password").val(""),e(".boxtitles").parent().attr({logintype:a.data("type")}).removeClass("kd-login-type-qrcode"),a.parent().find('.boxtitle[data-type="qrcode"]').find("span").text(ResManager.LoadKDString("扫码登录","0991733000006693")),a.parent().find('.boxtitle[data-type="qrcode"]').attr({datarole:""}),e("#ct_").css("display","inline-block"),a.siblings().removeClass("active"),e("#qr_").hide(),"cloudaccount"==a.data("type")){"true"!=a.attr("isfirstload")&&e("#user").val(""),e("#user").attr("placeholder",ResManager.LoadKDString("手机号","014004030033670")),j();var n=KD.storage.getItem(KD.CONST.isHasLoginByCloudAccountName);KD.isEmpty(n)&&e("#forgetpass .kd-getpassword-tips").show()}else{var o=e("#verifyType");if(o.length>0){var l=o.data("kendoDropDownList");l.trigger("change")}}$(),"true"==a.attr("isfirstload")&&KD.delayInvoke(function(e){W()},1e3)}else if("qrcode"==a.data("type")){_isUseKingdeeUnifiedStyle&&_isUseKingdeeUnifiedStyle()&&a.hide();a.attr("datarole");a.attr({datarole:"qrcode"}),e("#qr_").show(),e(".boxtitles").parent().addClass("kd-login-type-qrcode"),e(".qrcode-reload").removeClass("active"),s($this,i,null),window.isUserQRCodeNew?q():(c(),clearInterval(timer),r(),d($this,i,null)),a.addClass("active")}}function $(){var t=KD.getConnectConfig()&&KD.getConnectConfig().isShowQRCodeLogin;t=!("false"==t);var i=e('.boxtitle[data-type="qrcode"]');return t?i.show():i.hide(),t}function W(){var t=e("#loginUserInfo .kd-login-input-container #user"),i=t.val();t.focus(),t.val("").val(i)}function J(){var t=function(t){var i=e('.boxtitles .boxtitle[data-type="'+t+'"]');i.hasClass("active")||i.trigger("click")},i={scope:e(document.body),callback:function(e){t(KD.equalsIgnoreCase(e,"true")?"cloudaccount":"account")},errcallback:function(e){t("account")}},a=new ClienterServiceProxy;a.IsSubscriptionRegControlPolicy(i)}function Q(t){var i={scope:e(document.body),callback:function(e){KD.writeLog("InitializeHtml5MainConsole",e,!0)},errcallback:function(e){KD.writeError("InitializeHtml5MainConsole error",e)},response_error:function(e){KD.writeError("InitializeHtml5MainConsole error",e)}},a=new ClienterServiceProxy;a.InitializeHtml5MainConsole.call(a,i,t)}function X(t,i){var a=KD.parseObject(KD.storage.getItem("lastLoginType")||""),n=KD.getConnectConfig()&&KD.getConnectConfig().defaultLoginType,o=$(),r="";r=10==n&&o?"qrcode":20==n?"cloudaccount":"account",KD.IsNullOrWhiteSpace(a)&&KD.IsNullOrWhiteSpace(n)&&J(),KD.IsNullOrWhiteSpace(a)&&(a=r);var s=e('.boxtitles .boxtitle[data-type="'+a+'"]');0==s.length&&(s=e('.boxtitles .boxtitle[data-type="account"]')),s.attr({isfirstload:"true"}),s.trigger("click"),s.removeAttr("isfirstload")}function Y(){var t=e("#qr_").is(":visible");return t}function Z(t){var i=t,a=i?null:e("#verifyType").data("kendoDropDownList");a&&a.value&&(i=a.value()),i==window.SMSVerifyTypeId?e("#SMSVerificationContainer").show():e("#SMSVerificationContainer").hide()}function ee(){if(m(window.SMSVerifyTypeId,null,U())){var t={scope:e(document.body),callback:function(e){var t=KD.parseObject(e);KD.equalsIgnoreCase(t.Successful+"","true")?(te(t.Message),ie()):(ne(!0),KDMessageBox.show({msg:t.Message,type:KDMessageBox.KDMesBoxType.Warning,callback:function(e){e==KDMessageBox.KDDialogResult.Yes?okHandler():E()}}))},errcallback:function(e){ne(!0);var t={name:ResManager.LoadKDString("金蝶提示","0991733000004008"),msg:e,description:"",type:KDMessageBox.KDMesBoxType.Warning,callback:function(e){e==KDMessageBox.KDDialogResult.Yes?okHandler():E()}};KD.Error.raise(t)}},i=new ClienterServiceProxy,a=de(),n=oe(),o=re(),r=ce(),s=new LoginInfo;e.extend(s,{EncyptType:1,PasswordIsEncrypted:!1,AcctID:"",AuthenticateType:window.SMSVerifyTypeId,ClientInfo:C()}),s.AcctID=a,s.Lcid=r,s.ValidationCode=e("#velidationCode").val(),i.GetSMSVerificationCode.call(i,t,s,n,o),ne(!1)}}function te(t){e("#SMSVerificationContainer .kd-login-sms-tips").text(t)}function ie(){if(!(window.limitGetSMSIntervalCode>=0)){var t=e("#kd-login-btn-sms"),i=waittime=120,a=function(){var e=KD.format(ResManager.LoadKDString("{0}秒后可重发","00214298000005664"),i);0>=i?(ae(),i=waittime):(i-=1,t.text(e),ne(!1))};window.limitGetSMSIntervalCode=KD.setInterval(a,1e3)}}function ae(){var t=e("#kd-login-btn-sms");window.limitGetSMSIntervalCode>=0&&(clearInterval(window.limitGetSMSIntervalCode),window.limitGetSMSIntervalCode=-1,t.text(ResManager.LoadKDString("发送验证码","00214298000005663")),ne(!0),te(""))}function ne(t){var i=e("#kd-login-btn-sms");t?i.removeAttr("disabled").removeClass("k-state-disabled").css("color","#FFF"):i.attr("disabled","disabled").addClass("k-state-disabled").css("color","#333")}function oe(){var t=e("#user");if(0==t.is(":Visible")){var i=e("#CAuser");i.is(":Visible")&&(t=i)}var a=t.val();return a}function re(){var t=e("#password").val();return t}function se(){var t=e("#kd-input-sms-verification").val();return t}function le(t){e("#kd-input-sms-verification").val(t)}function de(){var t="",i=e("#datacenter");return dataAccObj=i.data("kendoDropDownList"),dataAccObj&&dataAccObj.value&&(t=dataAccObj.value()),t}function ce(){var t="",i=e("#language");return lanObj=i.data("kendoDropDownList"),lanObj&&lanObj.value&&(t=lanObj.value()),t}function he(i,a){var n=!1;KD.isIeBrowser&&KD.isIeBrowser()&&(a=!1),n=a!=t?a:i&&"password"==e(i.target).attr("id")?KD.checkCapsLockState.call(this,i):!1;var o=e("#capslockstate");if(o.find(".kd-text").text(ResManager.LoadKDString("大写锁定已打开","0991733000014723")),n){var r="url("+KD.getUrlRoot()+"/"+KD.getSubPath()+"/"+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+")";o.show(),o.find(".kd-icon").css({"background-image":r})}else o.hide()}e.fn.KDLogin=function(l){var c=e.extend({},e.fn.KDControlBase.defaults,e.fn.KDLogin.defaults,l),h=window._kdlogin=e.extend(this,e.fn.KDLogin.prototype,c),p=KD.entryrolePlugins.getPlugin(h.entryrole);g(this);var m=KD.getConnectConfig().pageName.toLowerCase(),v="index.aspx"==m,b=KD.isManagementSite(),D=t;if(v)if(o()){var k=e('<div class="boxtitles"></div>');k.append('<div class="boxtitle " data-type="cloudaccount"><span>'+ResManager.LoadKDString("金蝶·云账号","0991733000005697")+"</span></div>"),k.append('<div class="boxtitle" data-type="qrcode" datarole="" style="background-image: url('+KD.getUrlRoot()+"/"+KD.getSubPath()+"/"+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+')"><span>'+ResManager.LoadKDString("扫码登录","0991733000006693")+'</span><div class="kd-tipline"></div></div>'),k.append('<div class="boxtitle" data-type="account"><span>'+ResManager.LoadKDString("金蝶云星空账号","0991733000005698")+"</span></div>"),D=e('<div id="boxcontainer"></div>');var C=KD.getConnectConfig()&&KD.getConnectConfig().startAppPlugin;window.isUserQRCodeNew=C&&("Kingdee.BOS.ServiceFacade.StartApp.MacVerify_V2,Kingdee.BOS.ServiceFacade.StartApp"==C||"Default"==C),window.isUserQRCodeNew?D.append(h.qrcodeHtmlNew):D.append(h.qrcodeHtml),D.append(h.getMetaHtml()),this.append(k).append(D)}else D=e('<div id="boxcontainer"></div>'),D.append(h.getMetaHtml()),this.append(D),e("#ct_").css("display","inline-block");else this.append('<div id="divQRCodeTitle"><div class="loginKDLogo"></div></div>').append(h.qrcodeHtml);b&&D&&(D.find("#datacenter_ct").css({position:"absolute",left:"25px"}),D.find("#language_ct #language").width(200)),e("#pBrowerVersion").length<=0&&e(".footer").append(h.footerHtml),n();var x=!0;return p&&e.isFunction(p.isUseDefaultLoginUI)&&(x=p.isUseDefaultLoginUI.call(p)),!x&&p&&e.isFunction(p.initLoginUI)?p.initLoginUI.call(p):(e("#datacenter",document).kendoDropDownList({noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490")}),e("#language",document).kendoDropDownList({noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490")}),e("#verifyType",document).kendoDropDownList({noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490")})),ClientAppProxy.Current&&ClientAppProxy.Current.getIsNotLoginUserByHistory()?e("#user").val(""):e("#user").val(h.__LoginInfo.user),e("#password").val(""),e("#velidationCode").val(""),e("#link_ChangeCode,#img_VelidationCode").click(function(e){f(e)}),e("#divImgBg").css("min-height","565px"),$this=this,this.each(function(){e.meta?e.extend({},c,$this.data()):c;$this.ready(function(){var t=e("#IsHtml5LoginForSilverlight");if(t.length>0&&(KD.IsHtml5LoginForSilverlight=!0),1==KD.IsHtml5LoginForSilverlight)return e("#btnLogin").kendoButton({enable:!0,click:function(e){return!1}}),KD.lgoinwaiting=new KD.blocking,void KD.lgoinwaiting.show({target:e("#htmllogin"),id:"dbox",text:ResManager.LoadKDString("准备登录数据...","0991733000004003")});var i=KD.entryrolePlugins.getPlugin(h.entryrole),a=!0,n=!1;i&&KD.isFunction(i.isInitDataCenterList)&&(a=i.isInitDataCenterList.call(i)),i&&KD.isFunction(i.isNeedValicationCode)&&(n=i.isNeedValicationCode.call(i),n&&M({IsNeedValicationCode:n})),!a&&i&&e.isFunction(i.loginUIReady)?i.loginUIReady.call(i):a&&(v||window.isUserQRCodeNew?K($this,h):(r(),s($this,h,null),d($this,h,null))),e("#btnLogin").kendoButton({enable:!0,click:function(e){return y($this,h,e),!1}})})}),KDKeyNavigate.initEnter2tab(e("#user"),null),e("#user").off("keydown").on("keydown",function(t){KDKeyNavigate.onKeyNavigate(e(this),null,t)}),e("#loginUserInfo").delegate("input","blur",function(t){var i=e(this);i.removeClass("kd-state-focused"),i.closest(".kd-login-input-container").removeClass("kd-state-focused")}),e("#loginUserInfo").delegate("input","focus",function(t){var i=e(this);i.addClass("kd-state-focused"),i.closest(".kd-login-input-container").addClass("kd-state-focused")}),KDKeyNavigate.initEnter2tab(e("#password"),null),e("#password").off("keydown").on("keydown",function(t){"13"!=t.keyCode||KD.isLoginByValidationCode()?KDKeyNavigate.onKeyNavigate(e(this),null,t):y($this,h,t),he(t)}),e("#password").off("blur").on("blur",function(e){he(e,!1)}),e("body").off("keydown").on("keydown",function(e){he(e)}),e("#kd-input-sms-verification").off("keydown").on("keydown",function(t){"13"==t.keyCode&&e(this).is(":Visible")?y($this,h,t):KDKeyNavigate.onKeyNavigate(e(this),null,t)}),e("#kd-login-btn-sms").off("click").on("click",function(e){ee()}),KDKeyNavigate.initEnter2tab(e("#velidationCode"),null),e("#velidationCode").off("keydown").on("keydown",function(t){return"13"==t.keyCode&&"none"!=e("#grid_VelidationCode").css("display")?void y($this,h,t):void KDKeyNavigate.onKeyNavigate(e(this),null,t)}),u(),i(),e("#logintypeDiv .typescontainer .typeItem .icon").click(function(t){var i=e(this.children[0]).attr("class"),a=location.href.split("?");switch(i){case"account":window.location.href="./ACCIndex.aspx"+(a.length>1?"?"+a[1]:"");break;case"face":window.location.href="./loginface.aspx"+(a.length>1?"?"+a[1]:"");break;case"qrcode":window.location.href="./QRCodeIndex.aspx"+(a.length>1?"?"+a[1]:"")}}),e(".kd-floatmenu .icon").click(function(t){var i=e(this.children[0]).attr("class"),a=location.href.split("?");switch(i){case"account":window.location.href="./ACCIndex.aspx"+(a.length>1?"?"+a[1]:"");break;case"face":window.location.href="./loginface.aspx"+(a.length>1?"?"+a[1]:"");break;case"qrcode":window.location.href="./QRCodeIndex.aspx"+(a.length>1?"?"+a[1]:"")}}),qrcodeDivObject=h,v&&(e(".kd-floatmenu").hide(),b||(e(".boxtitles .boxtitle").click(function(e){G.call(this,e,h)}),X.call(this,$this,h))),j(),KD.isShowAcceptCookieForm()&&KD.acceptCookieVerify(),e("#forgetpass").click(function(){var t=e("#verifyType").data("kendoDropDownList"),i=1;t&&(i=t.value());var n=U(),o=a(i,n);if(o)if(n)window.open("https://cloud.kingdee.com/passport/hi/password/forget","_blank");else{var r=encodeURIComponent(e("#datacenter option:selected").html()),s={userName:e("#user").val(),dbid:e("#datacenter").data("kendoDropDownList").value(),clientType:16,lcid:e("#language").data("kendoDropDownList").value()},l=new UserServiceProxy,d={callback:function(t){var i=KD.parseObject(t);0==i.Successful?KDMessageBox.show({msg:i.Message,type:KDMessageBox.KDMesBoxType.Warning}):e(location).attr("href",KD.getUrlRoot()+"/"+KD.getSubPath()+"/ForgetPassword.html?p0="+r+"&p1="+e("#datacenter").data("kendoDropDownList").value()+"&p2="+e("#language").data("kendoDropDownList").value()+"&p3="+encodeURIComponent(e("#user").val())+"&p4=16&p5="+encodeURIComponent(window.location))}};l.CheckAutherUser.call(l,d,s)}}),h},e.fn.KDLogin.prototype={setEnabled:function(e){},setPassword:function(t){e("#password").val(t)},refreshDataCenter:function(){I(this)},showModifyPwdWindow:function(t,i){var a=this,n=i.Context?i.Context.UserId:"",o=new FormManager,r=new ShowFormParameter("SEC_ModifyPassword","7e62583e-7d50-4546-afc6-389525b0df2c");r.ShowFormType=0,r.Height=165,r.Width=385,r.ResizeMode=0,r.activeVerifyBannerTip=!0,r.InputData=t,n&&(r.CustomParams.EditUserId=n),o.ShowClientDynamicForm.call(o,r,function(t){a.setPassword(""),e("#password").focus(),E()})},showActivationForm:function(t,i){var a=this,n=i.Context?i.Context.UserId:"",o=new FormManager,r=new ShowFormParameter("SEC_SetPwd","C288CC59-A964-4DC6-B543-6B7FB2804498");r.ShowFormType=0,r.Height=413,r.Width=710,r.ResizeMode=0,r.activeVerifyBannerTip=!0,r.InputData=t,n&&(r.CustomParams.EditUserId=n),o.ShowClientDynamicForm.call(o,r,function(t){if(t.dialogResult==KDMessageBox.KDDialogResult.Ok){var n="";t.returnValue&&t.returnValue.replace&&(n=t.returnValue.replace('"',"")),a.setPassword(n),a.ok&&(i.LoginResultType=KD.LoginResultType.Success,a.ok.call(a,i))}else a.setPassword(""),E(),e("#password").focus()})},showSpecialForm:function(e,t,i){var a=i||{},n=this,o=new FormManager,r=a&&a.PageId?a.PageId:kendo.guid(),s=a&&a.FormLayoutId?a.FormLayoutId:"",l=new ShowFormParameter(t,s);l.ShowFormType=0,l.Height=210,l.Width=385,l.ResizeMode=0,l.InputData=i,l.PageId=r,e.modal&&(l.modal=e.modal),
a&&(a.FormWidth>0&&(l.Width=a.FormWidth),a.FormHeight>0&&(l.Height=a.FormHeight)),n.inputData=i,o.ShowClientDynamicForm.call(o,l,function(t){!n.ok||t.dialogResult!=KDMessageBox.KDDialogResult.Ok&&t.dialogResult!=KDMessageBox.KDDialogResult.Ignore||(e.LoginResultType=KD.LoginResultType.Success,n.ok.call(n,e))})}},e.extend(e.fn.KDLogin.prototype,e.fn.KDControlBase.prototype),e.fn.KDLogin.defaults={qrcodeHtml:'<div id="qr_" class="wrap"><div class="login-wrap"><div class="login-content"><div class="login-scan-qrcode active"><div class="login-qrcode active"><span class="qr-wrap"><img alt="" id="yzjQRCode" src="" /><span class="qrcode-reload"><span></span><i id="qrcode-loseeffect">'+ResManager.LoadKDString("二维码已失效","0991733000006695")+"<br />"+ResManager.LoadKDString("请点击刷新","0991733000006696")+'</i></span></span><b><span id="qrcode-populuarize">'+ResManager.LoadKDString("使用","0991733000006713")+'<a href="http://www.yunzhijia.com/home/?m=open&amp;a=download">'+ResManager.LoadKDString("云之家APP","0991733000006714")+"</a>"+ResManager.LoadKDString("扫描二维码","0991733000006697")+'<span></b></div><div class="scan-guid"></div></div></div></div></div>',qrcodeHtmlNew:'<div id="divqrcodedatacenterinfo" style="padding-left: 60px;padding-top: 20px;"><div style="display: inline;" id="datacenter_ct1"><select id="datacenter1" style="width: 155px;height: 31px;"></select><input id="inputDatacenter1" placeholder='+ResManager.LoadKDString("请输入数据中心名称","0991733030034782")+' class="k-textbox" style="width:122px;display:none;" type="text"/><span id="spanDatacenter1" class="k-icon" style="visibility:hidden;height:26px;"  /></div><div id="language_ct1" style="display: inline;"><select id="language1" style="width: 150px;height: 31px;"></select></div></div><div id="qr_" class="wrap"><div class="login-wrap"><div class="login-content"><div class="login-scan-qrcode active"><div class="login-qrcode active"><div class="qr-wrap"><div style="margin:auto;"><iframe style="width:270px; height:180px;margin-top:-30px" id="childframe" name="childframename" src=""></iframe></div></div><b><span id="qrcode-populuarize">'+ResManager.LoadKDString("使用","0991733000006713")+'<a href="http://www.yunzhijia.com/home/?m=open&amp;a=download">'+ResManager.LoadKDString("云之家APP","0991733000006714")+"</a>"+ResManager.LoadKDString("扫描二维码","0991733000006697")+'<span></b></div><div class="scan-guid"></div></div></div></div></div>',metaHtml:'<div id="{$this.ctId}" class="kdlogin"><div id="loginDBInfo"><div id="verifyType_ct"  style="float:right;margin-right:15px;"><select id="verifyType" style="width: 120px;height: 31px;"></select></div><div id="language_ct" style="float:right;margin-right:15px;"><select id="language" style="width: 135px;height: 31px;"></select></div><div id="datacenter_ct" style="float:right;margin-right:15px;"><select id="datacenter" style="width: 155px;height: 31px;"></select><input id="inputDatacenter" placeholder='+ResManager.LoadKDString("请输入数据中心名称","0991733030034782")+' class="k-textbox" style="width:122px;display:none;" type="text"/><span id="spanDatacenter" class="k-icon" style="visibility:hidden;height:26px;"  /></div></div><div id="loginUserInfo"><div style="height: 53px; width: 310px;" class="kd-login-input-container"><span class="k-icon kd_iconUserName"></span><input id="user" class="k-textbox kd-notborder" autocomplete="off" placeholder='+ResManager.LoadKDString("用户名","0991733000004017")+' style="height: 53px;width:287px;" type="text"/><input id="CAuser" class="k-textbox kd-notborder" autocomplete="off"  style="visibility:hidden;padding-top: 3px;width:287px;" type="text"/></div><div class="divPartingLine"></div><div class="kd-login-msgcontainer"><div id="capslockstate" class="kd-capslock-state"><span class="kd-icon">&nbsp;</span><span class="kd-text"></span></div></div><div style="height: 53px; width: 310px;" class="kd-login-input-container kd-login-psd-container"><span class="k-icon kd_iconPassword"></span><input id="oldpassword" type="hidden" /><input id="password"  class="k-textbox kd-notborder" autocomplete="new-password"  placeholder='+ResManager.LoadKDString("密码","0991733000004018")+' style="height: 53px;width:287px;" type="password"/></div><div class="divPartingLine"></div><div id="grid_VelidationCode" style="display:none"><input id="velidationCode" class="kd-login-velidationCode" style="width: 90px;height: 38px" autocomplete="off" class="k-textbox" placeholder='+ResManager.LoadKDString("验证码","0991733000004019")+' type="text"/><img id="img_VelidationCode" title='+ResManager.LoadKDString("换一张","0991733000004020")+' style="width:98px;height:38px;margin-left:18px;vertical-align:middle;cursor:pointer;"/><span id="link_ChangeCode" class="k-icon kd_iconRefresh" style="margin-left:16px;" title="'+ResManager.LoadKDString("换一张","0991733000004020")+'"></span></div><div class="divPartingLine"></div><div id="SMSVerificationContainer" class="kd-login-sms-container"><div class="kd-login-sms-tips"></div><div style="height:53px;width:180px;display:inline-block;"><div style="height:100%;" class="kd-login-input-container"><span class="k-icon kd-icon-sms-verification"></span><input id="kd-input-sms-verification" class="k-textbox kd-notborder" autocomplete="off" placeholder="'+ResManager.LoadKDString("请输入短信验证码","00214298000005662")+'" style="height:53px;max-width:155px;" type="text"/></div></div><button id="kd-login-btn-sms" type="button" >'+ResManager.LoadKDString("发送验证码","00214298000005663")+'</button></div></div><div id="loginBtnInfo"><button id="btnLogin" style="height: 100%;width:100%" type="button" class="btnlogin">'+ResManager.LoadKDString("登录","00214298000004485")+'</button><span style="float: left;margin-left: 130px;margin-top:10px;cursor: pointer;" id="forgetpass"><div class="kd-getpassword-tips"><div class="kd-getpassword-tips-line"></div><span class="kd-login-tips-text">'+ResManager.LoadKDString("首次登录请点击“忘记密码”来设置密码","002014030033727")+'</span></div><span class="kd-text">'+ResManager.LoadKDString("忘记密码","002014000004304")+'</span></span></div><div id="grid_SRMSupplier" style="display:none;float:right;margin-right:85px;margin-top:15px;"><a id="indexSRMSupplier" class="login-SRMSupplier" href="" target="_blank">'+ResManager.LoadKDString("供应商注册","0991733000007301")+'</a></div><div style="width:100%;height:0px;"></div></div>',footerHtml:'<div><div id="divServiceContactAndPrivacyPolicy"><p id="pServiceContactAndPrivacyPolicy"><a id="linkServiceContact" href="https://cloud.kingdee.com/passport/#/policy-agree/client-kd" target="_blank">'+ResManager.LoadKDString("用户协议","014003030033142")+'</a><span class="kd-login-spiltline">|</span><a id="linkPrivacyPolicy" href="https://cloud.kingdee.com/passport/#/policy-agree/privacy-policy" target="_blank">'+ResManager.LoadKDString("隐私政策","014003030033109")+'</a></p></div><div id="divICPNo"><a id="linkSiteRecordNop" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030502004999"><span id="img_ICPIcon" style="background-image: url('+KD.getUrlRoot()+"/"+KD.getSubPath()+"/"+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+')"></span><span class="ICP_SapnLabel">粤公网安备 44030502004999号</span></a><a id="linkSiteRecordNoe" target="_blank" href="https://beian.miit.gov.cn/"><span class="ICP_SapnLabel">粤ICP备05041751号-26</span></a></div><div id="divKDIntroInfo"><p id="pBrowerVersion"><a id="indexDLChrome" target="_blank">'+ResManager.LoadKDString("建议浏览器：","0991733030033749")+'</a>Chrome<span class="kd-login-spiltline">|</span><a id="indexSuggest">'+ResManager.LoadKDString("建议分辨率：1280x1024以上像素","0991733030033750")+'</a><span class="kd-login-spiltline">|</span><a id="indexClearCache" href="#" onclick="KD.ClearLocalCahce()">'+ResManager.LoadKDString("清除本地缓存","099002000002731")+'</a><a id="indexShowHttpwatcher" href="#" style="display:none;" onclick="KD.ShowHttpWatchWindow()">'+ResManager.LoadKDString("查看http数据","099002000002730")+'</a></p><p id="pCopyRight" style="">'+KD.format(ResManager.LoadKDString("{0}1993-{1} 金蝶国际软件集团有限公司版权所有","0991733000004763"),"©","2020")+"</p></div></div>"}};__execContent(jQuery),define("kdlogin",["KDControlBase","KDControlProxy","KDKeyNavigate","KD"],function(e){return function(){var t;return t||e.kdlogin}}(this)),function(){KD.isDForm()||window.isLoadFullRes||KD.isLoginRenderByPlugins()||$(document).ready(function(){KD.getQueryString("ud","")?KD.initClientInfo(mainlogin):mainlogin()})}(),define("kdmainlogin",["kdlogin","KD"],function(e){return function(){var t;return t||e.kdmainlogin}}(this)),KDLayout=function(){},KDLayout.isNeedFixed=!1,KDLayout.__getDockCtId=function(e,t){var i="";return t==KD.dock.Top?i=e+"_top":t==KD.dock.Left?i=e+"_left":t==KD.dock.Fill?i=e+"_fill":t==KD.dock.Right?i=e+"_right":t==KD.dock.Bottom&&(i=e+"_bottom"),i},KDLayout.__getCtSel=function(e,t){var i=KDLayout.__getDockCtId(e,t);return'[data-kdid="'+i+'"]:first'},KDLayout.__getMark=function(e){var t=e[getPropName()]("data-kdlayoutmark"),i=JSON.parse(t||"{}");return $.extend({top:0,left:0,center:0,right:0,bottom:0},i)},KDLayout.__isFillOnly=function(e){return e.top+e.left+e.right+e.bottom==0},KDLayout.__existFill=function(e){return e.top||e.left||e.right||e.bottom||e.center},KDLayout.__calcAutoStrechWidth=function(e){var t=e.width;if(-1==t){var t=e.width;if(0>=t&&e.items)for(var i in e.items){var a=e.items[i]?e.items[i].width:0;t+=a?a+35:0}e.width=t}return t},KDLayout.__calcAutoStrechHeight=function(e){var t=e.height;if(-1==t){var t=e.height;if(0>=t&&e.items)for(var i in e.items){var a=e.items[i]?e.items[i].height:0;t+=a?a+4:0}e.height=t}return t},KDLayout.__getChildSize=function(e,t){var i=KD.layout.getChildSize(e,t);return i},KDLayout.getInnerPixels=function(e,t){var i=KD.isNumber(e)?e:parseInt(((e||"")+"").replace(/px/g,""));return t=t||0,isNaN(i)?e:i-t>0?i-t:1},KDLayout.getItemConfig=function(e,t,i){var a=void 0;if(!e.items)return cfg;var n=0;for(var o in e.items){var r=e.items[o];if(r.dock==t&&(n++,n==i)){a=r;break}}return a},KDLayout.prototype={getType:function(){return"KDLayout"},loadConfig:function(e,t){if(!t)return{};var i=t.id,a={width:KD.layout.getActualWidth(t),height:KD.layout.getActualHeight(t),target:t},n=this.getLayoutTemp(e,i,a);return t[getPropName()]("data-kdlayoutmark",JSON.stringify(n.mark)),n.topTmp&&$(n.topTmp).appendTo(t),n.leftTmp&&$(n.leftTmp).appendTo(t),n.centerTmp&&$(n.centerTmp).appendTo(t),n.rightTmp&&$(n.rightTmp).appendTo(t),n.bottomTmp&&$(n.bottomTmp).appendTo(t),$('<div style="clear:both;">').appendTo(t),t.css({options:"relative"}),{}},getLayoutTemp:function(e,t,i){var a={mark:{top:0,left:0,center:0,right:0,bottom:0,ctOrientation:e.ctOrientation,isMissDockFill:e.isMissDockFill}},n='<div style="float:left;display:inline-block;width:{centerwidth};height:{centerheight};" data-kdid="'+KDLayout.__getDockCtId(t,KD.dock.Fill)+'"></div>',o='<div style="height:{topheight}px;width:100%;" data-kdid="{data-kdid}"></div>',r='<div style="display:inline-block;height:{bottomheight}px;width:100%;" data-kdid="{data-kdid}"></div>',s='<div style="float:left;display:inline-block;width:{leftwidth}px;height:{leftheight};" data-kdid="{data-kdid}"></div>',l='<div style="display:inline-block;width:{rightwidth}px;height:{rightheight};" data-kdid="{data-kdid}"></div>',d=e.items=KD.quickSort(e.items,"dock");for(var c in d){var h=d[c],u=h.dock,p=KDLayout.__getDockCtId(t,u);u==KD.dock.Top?(a.mark.top++,KDLayout.__calcAutoStrechHeight(h),a.topSize=(a.topSize||0)+(h.height||0),a.topTmp=o.replace("{data-kdid}",p).replace("{topheight}",a.topSize)):u==KD.dock.Bottom?(a.mark.bottom++,KDLayout.__calcAutoStrechHeight(h),a.bottomSize=(a.bottomSize||0)+(h.height||0),a.bottomTmp=r.replace("{data-kdid}",p).replace("{bottomheight}",a.bottomSize)):u==KD.dock.Left?(a.mark.left++,KDLayout.__calcAutoStrechWidth(h),a.leftSize=(a.leftSize||0)+(h.width||0),a.leftTmp=s.replace("{data-kdid}",p).replace("{leftwidth}",a.leftSize)):u==KD.dock.Right?(a.mark.right++,KDLayout.__calcAutoStrechWidth(h),a.rightSize=(a.rightSize||0)+(h.width||0),a.rightTmp=l.replace("{data-kdid}",p).replace("{rightwidth}",a.rightSize)):u==KD.dock.Fill&&(a.mark.center++,a.centerTmp=n)}var g=KD.layout.isRelativeWidth(i.target)?KD.layout.getActualWidth(i.target):i.width;g="0px"==g?"100%":g-(a.leftSize||0)-(a.rightSize||0)+"px";var f=KD.layout.isRelativeHeight(i.target)?KD.layout.getActualHeight(i.target):i.height;f="0px"==f?"inherit":f-(a.topSize||0)-(a.bottomSize||0)+"px",a.centerSize={width:g,height:f};var m=KDLayout.__isFillOnly(a.mark)?"inherit":a.centerSize.height,v=KDLayout.__isFillOnly(a.mark)?"100%":a.centerSize.width;return a.centerTmp=(a.centerTmp||n).replace("{centerwidth}",v).replace("{centerheight}",m),a.leftTmp=(a.leftTmp||"").replace("{leftheight}",m),a.rightTmp=(a.rightTmp||"").replace("{rightheight}",m),a},existFill:function(e){var t=(e.id,KDLayout.__getMark(e));return KDLayout.__existFill(t)},addControl:function(e,t){var i=t.id,a=KDLayout.__getMark(t),n=e.dock;if(null==n&&(n=KD.dock.None),n!=KD.dock.None||KDLayout.__existFill(a)){var o=null;if(o=KDLayout.__existFill(a)&&n==KD.dock.None?$(KDLayout.__getCtSel(i,KD.dock.Fill),t):$(KDLayout.__getCtSel(i,n),t),0==o.length&&t&&(e.layoutOptions=t.layoutPanel.loadConfig.call(t.layoutPanel,t.getProxy().getConfig(),t),o=$(KDLayout.__getCtSel(i,n),t)),n==KD.dock.Fill||n==KD.dock.Left||n==KD.dock.Right){var r={height:"inherit"};KDFlowlayoutProxy.isInVertical(a)&&$.extend(r,{overflow:"hidden"}),e.css(r)}o.length&&e.appendTo(o)}else e.css({display:"inline-block"}),e.appendTo(t);KD.getAttachmentData(e)},loadConfig1:function(e,t){var i=$('<table style="height:inherit;width:100%;border:0px;"></table>').appendTo(t);t.rowEls=t.rowEls||{},t.cellEls=t.cellEls||{};for(var a=0;3>a;a++){var n="<tr></tr>",o="r"+a,r=$(n).appendTo(i);t.rowEls[o]=r;for(var s=0;3>s;s++){var l='<td style="display:inline-block;border:0px;padding:0px;margin:0px;"><div></div></td>',d="r"+a+"c"+s,c=$(l);t.cellEls[d]=c,c.appendTo(r)}}return{}},addControl1:function(e,t){var i=e.dock;if(i==KD.dock.None)e.css({display:"inline-block"}),t.append(e);else{var a="";i==KD.dock.Fill?a="r1c1":i==KD.dock.Top?a="r0c1":i==KD.dock.Bottom?a="r2c1":i==KD.dock.Left?a="r1c0":i==KD.dock.Right&&(a="r1c2");var n=t.cellEls[a];n&&e.appendTo(n)}},hasVisibleChild:function(e){for(var t=e.children(),i=!0,a=0;a<t.length;a++){var n=$(t[a]);if("none"!=n.css("display"))break;a==t.length-1&&(i=!1)}return i},doLayout:function(e,t){var i=t.id,a=KDLayout.__getMark(t),n=KDLayout.__isFillOnly(a),o=$(KDLayout.__getCtSel(i,KD.dock.Fill),t),r=KDFlowlayoutProxy.isFlowlayoutChild(a)?t:t.parent(),s=KD.layout.getRangeSize(KD.layout.getTargetRangeProp(r,"border-width"));if(n){var l=KDLayout.__getChildSize(r,t);return void(r&&r.length&&!KDFlowlayoutProxy.isFlowlayoutChild(a)?(t.css(l.targetOption),o.css(l.containerOption)):KDFlowlayoutProxy.isInVertical(a)&&t.css({width:l.width}))}if(r&&r.length){var l=KDLayout.__getChildSize(r,t);t.css(l.targetOption)}var d={width:KD.layout.getRealStyleNumberProp(t,"width",0),height:KD.layout.getRealStyleNumberProp(t,"height",0)},c=$.extend({},d);if(a.top){var h=$(KDLayout.__getCtSel(i,KD.dock.Top),t);if(h&&h.length){for(var u=0,p=void 0,g=0;g<e.items.length;g++)p=KDLayout.getItemConfig(e,KD.dock.Top,g),u+=p?p.height:0;var f={height:u,width:KD.layout.getActualWidth(r)};0==a.top&&h.css(f),this.hasVisibleChild(h)?h.css({height:u}):(h.css({height:0}),u=0),c.height-=u}}if(a.bottom){var m=$(KDLayout.__getCtSel(i,KD.dock.Bottom),t);if(m&&m.length){for(var u=0,p=void 0,g=0;g<e.items.length;g++)p=KDLayout.getItemConfig(e,KD.dock.Bottom,g),u+=p?p.height:0;var f={height:u,width:KD.layout.getActualWidth(r)};0==a.top&&m.css(f),this.hasVisibleChild(m)?m.css({height:u}):(m.css({height:0}),u=0),c.height-=u}}if(a.left){var v=$(KDLayout.__getCtSel(i,KD.dock.Left),t);if(v&&v.length){for(var y=0,p=void 0,g=0;g<e.items.length;g++)p=KDLayout.getItemConfig(e,KD.dock.Left,g),y+=p?p.width:0;var f={height:c.height,width:y};1==a.left&&v.css(f),this.hasVisibleChild(v)?v.css({width:y}):(v.css({width:0}),y=0),c.width-=y}}if(a.right){var b=$(KDLayout.__getCtSel(i,KD.dock.Right),t);if(b&&b.length){for(var y=0,p=void 0,g=0;g<e.items.length;g++)p=KDLayout.getItemConfig(e,KD.dock.Right,g),y+=p?p.width:0;var f={height:c.height,width:y};1==a.right&&b.css(f),this.hasVisibleChild(b)?b.css({width:y}):(b.css({width:0}),y=0),c.width-=b.width()}}KDLayout.__existFill(a)&&!a.isMissDockFill?(void 0!==c.height&&(c.height=KDLayout.getInnerPixels(c.height,s.top+s.bottom)),void 0!==c.width&&(c.width=KDLayout.getInnerPixels(c.width,s.left+s.right+1)),o.css(c)):a.isMissDockFill&&o.css({height:0})}},define("KDLayout",function(){}),DevDocPreviewProxy=KD.extend(KDContainerProxy,{loadConfig:function(e){DevDocPreviewProxy.superclass.loadConfig.call(this,e)},initComponent:function(){DevDocPreviewProxy.superclass.initComponent.call(this),this.component=$('<div style="overflow: auto;height: inherit; background: #C3C6CE;"></div>'),this.page=$('<h1 style="margin: 10px 0px; text-align: center;"></h1>'),this.component.append(this.page),this.contentContainer=$('<div style="border:1px solid #ceced2; margin: 0px auto 10px; background: #fff;"></div>'),this.component.append(this.contentContainer),this.el.append(this.component)},showPage:function(e){e.pageWidth=parseFloat(e.pageWidth),e.pageHeight=parseFloat(e.pageHeight),this.page.text(e.pageIndexContent),this.contentContainer.html(e.html),KD.isNaN(e.pageWidth)||this.contentContainer.width(e.pageWidth),KD.isNaN(e.pageHeight)||this.contentContainer.height(e.pageHeight)},clearPage:function(){this.page&&this.page.empty(),this.contentContainer&&this.contentContainer.empty()},exportReport:function(e){var t=this.getFormProxy(),i=[];i[0]=e.fileUrl,t.showWebURL(i)},printReport:function(e){var t=this.el.find("iframe.report_print");0==t.length&&(t=$("<iframe class='report_print' src='"+e.pdfUrl+"' />").hide(),this.el.append(t)),t[0].contentWindow.print()}}),KDControlFactoryProxy.registerType("devdocpreview",DevDocPreviewProxy),KDExcelPrintPluginProxy=function(){},KDExcelPrintPluginProxy=KD.extend(KDExcelPrintPluginProxy,{acts:{},setBusy:function(e){this.owner.setBusy(e)},doActionCallBack:function(e,t){e.setBusy(!1),t&&e.owner.fireActionCallBack(t)},beginExcelPrintAction:function(e){try{this.setBusy(!0);var t;e&&$.isArray(e)&&(t=KD.getValue(e[0],"callbackid",""));var i=e.length>1?e[1]:e[0];this.makeSureManifestIsLatest(i,t)}catch(a){this.setBusy(!1)}},makeSureManifestIsLatest:function(e,t){var i={actionKey:"ClientActions",methodName:"ManifestIsLatest",params:[e.OpenAppUrl,e.LocalTrayModifyData,e.ExitApp],serverCallbackId:t,rawPrintArgs:e},a=this,n=function(e){try{var t=e.rawPrintArgs;t.serverCallbackId=e.serverCallbackId,a.doExcelPrint(t)}catch(i){a.setBusy(!1)}};this.sendData(i,n)},doExcelPrint:function(e){var t={actionKey:"ExcelPrintActions",methodName:"DoExcelPrintAction",params:[e],serverCallbackId:e.serverCallbackId},i=this,a=function(e){try{i.doActionCallBack(i,e.serverCallbackId)}catch(t){i.setBusy(!1)}};this.sendData(t,a)},sendData:function(e,t){var i=this;e.callbackid=KD.Guid.NewGuid().ToString(),this.acts[e.callbackid]={callback:t,args:e};var a=function(e){try{i.reciveMsgCallback(e)}catch(t){i.setBusy(!1)}},n=function(){KDExcelPrintSocket.sendData(e)};KDExcelPrintSocket.createServicesChannel({open:function(e){n()},message:function(e){try{a(e)}catch(t){i.setBusy(!1)}},close:function(e){i.setBusy(!1),KDLocalServices.alertToStartService()},error:function(e){i.setBusy(!1),"iehttps"==e.type&&KDLocalServices.alertNoSupportIeHttps()}},n)},reciveMsgCallback:function(e){try{var t=KD.parseObject(e.data),i=(t.ActionPacks?t.ActionPacks[0]:{})||{},a=(i?i.callbackid:"")||"",n=this.acts[a];delete this.acts[a],n.args.ret=e,n.callback.call(this,n.args)}catch(o){this.setBusy(!1)}}}),KDExcelPrintSocket=function(){},$.extend(KDExcelPrintSocket,{createServicesChannel:function(e,t){var i=KDExcelPrintSocket,a=function(e,t,a){e.onopen=function(n){i.ws=e;var o=t.open||a;KD.isFunction(o)&&o(n)},e.onmessage=function(e){var i=t.message||a;KD.isFunction(i)&&i(e)},e.onclose=function(e){var n=t.close||a;e.normalClose=i.normalClose,delete i.normalClose,KD.isFunction(n)&&n(e),delete i.ws},e.onerror=function(e){var n=t.error||a;KD.isFunction(n)&&n(e),delete i.ws}};if(KDLocalServices.isIeHttps()){delete i.ws;var n=e.error||t;KD.isFunction(n)&&n({message:"nonsupport websocket!",returnValue:!1,type:"iehttps"})}else if(i.ws&&1==i.ws.readyState){var i=KDExcelPrintSocket;void 0!==i.ws&&1==i.ws.readyState&&a(i.ws,e,t),KD.isFunction(t)&&t({message:"success!",returnValue:!0,type:"open"})}else{delete i.ws;var o=KDLocalServices.getSocket(),r=null;try{if(o)r=i.ws=i.ws||new o(KDLocalServices.getConnectStr()),a(r,e,t);else{delete i.ws;var n=e.error||t;KD.isFunction(n)&&n({message:"nonsupport websocket!",returnValue:!1,type:"open"})}}catch(s){KD.writeError(s),i.ws=void 0}}},sendData:function(e){var t=KDExcelPrintSocket;if(void 0!==t.ws&&1==t.ws.readyState){var i=KD.isString(e)?e:KD.stringify(e);t.ws.send(i)}}}),define("DevDocPreviewProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.DevDocPreviewProxy}}(this)),KDCustomControlProxy=KD.extend(KDControlProxy,{loadConfig:function(e,t){KDCustomControlProxy.superclass.loadConfig.call(this,e);var i=KDCustomControlProxy.getPluginOptions({ver:e.VersionInfo,assembly:e.Assembly});KDCustomControlProxy.createPluginNode(this.getKey(),i.jsUrl,i.cssUrl,this)},createCustomControl:function(e){var t=this,i=window[e.ClassName];i?(t.innerControl=new i,t.innerControl.setOwner.call(t.innerControl,t)):t.el.text(e.ClassName+" no exist!"),t.innerControl&&$.isFunction(t.innerControl.initControl)&&t.innerControl.initControl.call(t.innerControl,t.el)},doLayout:function(){this.innerControl&&this.innerControl.doLayout.call(this.innerControl)},onNodeCreated:function(e){var t=this;t.createCustomControl(e.scope.config)},onNodeCreating:function(){},doCustomMethod:function(e,t){if(this.innerControl)try{var i=e.substr(0,1).toLowerCase()+e.substr(1),a=this.innerControl[i]||this.innerControl[e];if($.isFunction(a))a.apply(this.innerControl,t);else{var n="method:"+e+"(arguments:"+t.length+"),no exist！";KD.writeLog(n)}}catch(o){this.onError(o)}},fireCustomEvents:function(e,t){var i=this.getFormProxy();if(i){var a="";a="string"==typeof t?t:KD.stringify(t),i.fireCustomEvents.call(i,this.getKey(),e,a)}},onError:function(e){var t=this.getFormProxy();t?t.showErrMsgStr&&t.showErrMsgStr(e.message,e.stack):KD.writeLog(e.message+";"+e.stack)},release:function(){this.innerControl&&this.innerControl.release.call(this.innerControl)}}),KDControlFactoryProxy.registerType("kdcustomcontroldef",KDCustomControlProxy),$.extend(KDCustomControlProxy,{baseJsPath:KD.getUrlRoot()+"/"+KD.getSubPath()+"/script/kd/plugins/",baseCssPath:KD.getUrlRoot()+"/"+KD.getSubPath()+"/content/themes/kd/plugins/",getResourceOptions:function(e){var t=e.ver?"?ver="+e.ver.replace(/[\s\-\:]/g,""):"",i=e.assembly||"",a=e.hasJs?i+".js"+t:"",n=e.hasCss?i+".css"+t:"";return{jsUrl:a,cssUrl:n,key:e.key}},createResourceNodeBatch:function(e){var t=e.items.length,i="";for(var a in e.items){var n=e.items[a],o=n.pageTypes||"",r=KD.getConnectConfig().pageType||"";(!o||o.indexOf(KD.format(",{0},",r))>=0)&&KDCustomControlProxy.createResourceNode(n.key,n.jsUrl,n.cssUrl,{onNodeCreated:function(a){t--,i+=a.message||"",0==t&&$.isFunction(e.onComplete)&&e.onComplete.call(e.scope,{message:i,isSuccess:!0,scope:e.scope})},onError:function(a){t--,i+=a.message||"",0==t&&$.isFunction(e.onError)&&e.onError.call(e.scope,{message:i,isSuccess:!1,scope:e.scope,eventoption:a})}},100)}},createResourceNode:function(e,t,i,a,n){a&&a.onNodeCreating&&a.onNodeCreating.call(a,{scope:a,moduleName:e,jsUrl:t,cssUrl:i});var o=function(){a&&a.onNodeCreated&&a.onNodeCreated.call(a,{scope:a,moduleName:e,jsUrl:t,cssUrl:i})},r=document.getElementsByTagName("head")[0];if(i&&0==$('link[href="'+i+'"]').length){var s=document.createElement("link");$.extend(s,{rel:"stylesheet",charset:"utf-8",href:i,async:!0,moduleName:e}),r.appendChild(s)}if(t&&0==$('script[src="'+t+'"]').length){var l=document.createElement("script");$.extend(l,{type:"text/javascript",charset:"utf-8",src:t,async:!0,moduleName:e}),$(l).attr("data-requirecontext","kd"),!l.attachEvent||l.attachEvent.toString&&l.attachEvent.toString().indexOf("[native code")<0||isOpera?(l.addEventListener("load",a.onScriptLoad||a.onNodeCreated,!1),l.addEventListener("error",a.onScriptError||a.onError,!1)):l.attachEvent("onreadystatechange",a.onScriptLoad),r.appendChild(l)}else o();return{cssNode:s,scriptNode:l}},getPluginOptions:function(e){var t=/^http(s){0,}:\/\//,i=e.ver?"?ver="+e.ver.replace(/[\s\-\:]/g,""):"",a=e.assembly||"";if(t.test(a||"")){var n=document.location.protocol;a=a.replace(t,n+"//")}var o=KD.isUrl(a)?a:KDCustomControlProxy.baseJsPath+a+".js"+i,r=KD.isUrl(a)?a:KDCustomControlProxy.baseCssPath+a+".css"+i;return{jsUrl:o,cssUrl:r,key:e.key,pageTypes:e.pageTypes}},createPluginNode:function(e,t,i,a,n){KDCustomControlProxy.createResourceNode(e,t,i,a,n)},createPluginNodeBatch:function(e){KDCustomControlProxy.createResourceNodeBatch(e)},loadLanguageRes:function(e,t,i){var a=ResManager.hasLanguageRes(e);if(a)i&&i(t,{result:!0});else{var n="html5"==KD.getSubPath().toLowerCase(),o=KD.isDebug()&&!n,r=KD.getVersion()?"?ver="+KD.getVersion().replace(/[\s\-\:]/g,""):"",s=o?"":".min",l=KDCustomControlProxy.getLocalNameById(e),d=o?"kendo.src":"kendo",c=KD.format("{0}/{1}/script/thirdpart/{2}/cultures/kendo.culture.{3}{4}",KD.getUrlRoot(),KD.getSubPath(),d,l,s),h=KD.format("{0}/{1}/script/thirdpart/{2}/messages/kendo.messages.{3}{4}",KD.getUrlRoot(),KD.getSubPath(),d,l,s),u=KD.format("{0}/{1}/script/LangRes/MlResource_{2}{3}",KD.getUrlRoot(),KD.getSubPath(),e,"");KDCustomControlProxy.createResourceNodeBatch({items:[{key:c,ver:KD.getVersion(),jsUrl:KD.format("{0}{1}{2}",c,".js",r)},{key:h,ver:KD.getVersion(),jsUrl:KD.format("{0}{1}{2}",h,".js",r)},{key:u,ver:KD.getVersion(),jsUrl:KD.format("{0}{1}{2}",u,".js",r)}],scope:this,onComplete:function(e){KD.delayInvoke(function(){i&&i(t,{result:!0})},1e3)},onError:function(e){KD.writeLog(e.message||"error",e.stack||KD.stringify(e)),i&&i(t,{result:!0,exception:e})}})}},getLocalNameById:function(e){var t=KD.getLocalIdToNameMaps();return t[e]||t[2052]}}),KDCustomControlBase=function(){},KDCustomControlBase.prototype={setOwner:function(e){this.owner=e,this.formOwner=e.getFormProxy.call(e)},fireEvent:function(e,t){this.owner&&this.owner.fireCustomEvents.call(this.owner,e,t)},initControl:function(e){return $("<div>KDCustomControlBase</div>").appendTo(e)},doLayout:function(){},release:function(){delete this.owner,delete this.formOwner}},$.extend(KD,{pluginsReadyHandlers:[],pluginReady:function(e){KD.pluginsReadyHandlers.push(e)},triggerPluginsReady:function(){for(var e in KD.pluginsReadyHandlers){var t=KD.pluginsReadyHandlers[e];t&&t()}}}),function(){$(document).ready(function(){var e=KD.getEntryRoleConfig();if(e&&e.jsPlugins){var t=[],i="EntryRole_Plugins",a=e||{},n=a.jsPlugins||{},o=a.cssPlugins||{},r=n.Version||KD.getVersion(),s=n.Items||[],l=o.Items||[];if(l)for(var d in l){var c=l[d],h=KDCustomControlProxy.getPluginOptions({key:i,ver:c.Version||r,assembly:c.Value,pageTypes:c.PageTypes||""});delete h.jsUrl,t.push(h)}if(s)for(var d in s){var c=s[d];h=KDCustomControlProxy.getPluginOptions({key:i,ver:r||c.Version,assembly:c.Value,pageTypes:c.PageTypes||""}),delete h.cssUrl,t.push(h)}return t.length>0?(KDCustomControlProxy.createPluginNodeBatch({items:t,scope:this,onComplete:function(e){KD.triggerPluginsReady()},onError:function(e){KD.writeLog(e.message||"error",e.stack||KD.stringify(e))}}),!0):void 0}})}(),define("KDCustomControlProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDCustomControlProxy}}(this)),KDDynamicFormShowType={Default:0,NewTabPage:1,InContainer:3,Floating:4,NonModal:5,Modal:6,InCurrentForm:8,FloatingAutoHide:9,NewWindow:10,ModalInCurrentForm:15},DFormConfig=function(){this.iintData=[],this.defaultLocalId=2052,this.vOffset=0,this.hOffset=0,this.keepInCache=!1,this.showType=0,this.initcontrolstates=[],this.isFormSizeChanged=!1},$.extend(DFormConfig,{absolutePath:"",isInPopWindow:function(e,t){var i=KD.getValue(e.dformConfig,"isInPopWindow",!1),a=KD.getValue(e.dformConfig,"openstyle",void 0)||{},n=KD.getValue(a,"ShowType",KDDynamicFormShowType.Default),o=KD.getValue(t,"openstyle",void 0)||{},r=KD.getValue(o,"ShowType",KDDynamicFormShowType.Default),s=!1;switch(r){case KDDynamicFormShowType.Modal:case KDDynamicFormShowType.Default:case KDDynamicFormShowType.NonModal:case KDDynamicFormShowType.FloatingAutoHide:case KDDynamicFormShowType.Floating:s=!1;break;default:switch(n){case KDDynamicFormShowType.Modal:case KDDynamicFormShowType.NonModal:case KDDynamicFormShowType.FloatingAutoHide:case KDDynamicFormShowType.Floating:s=!0;break;case KDDynamicFormShowType.Default:s=e.getIsMain.call(e)?!1:!0;break;default:s=i?!0:!1}}return s}}),DFormConfig.prototype={getFormUrl:function(){try{var e=this,t=e.formid,i=e.serviceUrl.indexOf("ListService")?"list":"form",a=e.pageId;if(!t)return"";var n=KD.getFormUrl(t,i,a);return n}catch(o){return""}},loadConfig:function(e,t){if(t&&(this.defLocalId=t),null!=e){e.hiddenclosebutton=KD.getValue(e,"hiddenclosebutton",!1),e.titlevisible=KD.getValue(e,"titlevisible",!0),KD.apply(this,e);var i=e.openstyle;if(null!=i&&(this.showType=i.ShowType,this.FormTheme=KD.getValue(i,"FormTheme",""),this.tagetKey=i.TagetKey,i.CacheId&&(this.cacheId=i.CacheId,this.keepInCache=i.CacheId?!0:!1)),this.OriginalHeight=e.height,this.OriginalWidth=e.width,this.width=e.width>$(window).width()?$(window).width()-30:e.width,KD.IsNullOrWhiteSpace(e.childFormHeightLimit)){var a=KD.getWindowHeight();KD.isUseSmallScreenModel(e,!0)&&($("body").addClass("kdmainformbg-listview-smallscreenmodel"),a=KD.getWindowHeight(),$("body").removeClass("kdmainformbg-listview-smallscreenmodel")),this.height=e.height>a-KD.getBillHeadHeight()?a-KD.getBillHeadHeight():e.height}else"clientarea"==e.childFormHeightLimit&&(this.height=e.height>$(window).height()?$(window).height():e.height);if(void 0!=e.maxHeight&&e.maxHeight>0&&(this.maxHeight=e.maxHeight),this.iintData=new Array,e.InitData)for(var n in e.InitData)var o=e.InitData[n];try{for(var r={},s=e.loadUrl&&e.loadUrl.length>13?e.loadUrl.substr(13).split("&"):[],n=0;n<s.length;n++){var l=(s[n]||"").split("=");l.length>1&&("paramdata"==l[0]?r[l[0]]=KD.parseObject(KD.urlDecodeComponent(l[1])):r[l[0]]=l[1])}this.loadUrlParam=r}catch(d){KD.writeError(d)}}return this},getLocalId:function(){return ClientAppProxy.Current.defaultLocalId||this.defaultLocalId},getLocalValue:function(e){var t=this.getLocalId(),i=KD.getLocalValue(t,e);return i},getBillTitle:function(){return this.getLocalValue(this.billTitle)},getMetaCacheKey:function(){var e=this,t=e.serviceName+e.formid+e.version+e.layoutID+e.dbid+e.lcid;return"Cache_"+t}},define("DFormConfig",["KD"],function(e){return function(){var t;return t||e.DFormConfig}}(this));var KDCardLayoutDesignerProxy=KDCardLayoutDesignerProxy||{editCardCout:0,setTarget:function(e){this.targeCommontProxy=e,this.mainTabEl=ClientAppProxy.Current.getMainTab().el,this.initFuncButton(),this.initCardEditbtnList(),this.addGroupNameEdit()},setStdTarget:function(e,t){this.targetStdProxy=e,this.mainTabEl=ClientAppProxy.Current.getMainTab().el,this.initFuncButton(!0,!1,t),this.initCardEditbtnList(!0,t),this.initAddCardButton()},setSmartCardTarget:function(e,t){this.targeCommontProxy=e,this.mainTabEl=ClientAppProxy.Current.getMainTab().el,this.initSmartCardFuncButton(t),this.initSmartCardEditbtnList(t),this.addGroupNameEdit()},setMonitorConsoleTarget:function(e){this.targeCommontProxy=e,this.mainTabEl=ClientAppProxy.Current.getMainTab().el,this.initFuncButton(!1,!0),this.initMonitorCardEditbtnList()},getTargetFormProxy:function(e){return e.getFormProxy()},getTargetEl:function(e){return e.el},initAddCardButton:function(){var e=this,t=$(".kd-infoflow-stdGroupAddItem",e.getTargetEl(e.targetStdProxy));t.css({display:"inline-block"})},initFuncButton:function(e,t,i){var a,n,o=this;
if(e?(a=this.getTargetEl(o.targetStdProxy),n=this.getTargetFormProxy(o.targetStdProxy).el):(a=this.getTargetEl(o.targeCommontProxy),n=this.getTargetFormProxy(o.targeCommontProxy).el),!($(".kd-H5CardEditBtnDiv",a.parent()).length>0)){var r,s=$("<div class='kd-H5CardEditBtnDiv'></div>");if(e)this.targetStdProxy.el.after(s),s.addClass("kd-newstdconsole-eidtbuttons");else{var l=t?"none":"block";this.targeCommontProxy.el.after(s),r=$(KD.format("<div class='kd-H5CardTopBtnList'><div class='kd-H5CardTopBtnItem'><span id='addCardBtn' title='{0}'><img src='../images/biz/default/MainConsole/H5CardLayout/addCard.png' /></span></div><div class='kd-H5CardTopBtnItem' style='display:{3}'><span id='resetCarLayoutBtn' title='{2}'><img src='../images/biz/default/MainConsole/H5CardLayout/resetCarLayout.png' /></span></div></div>",ResManager.LoadKDString("添加卡片","0025710000006703"),ResManager.LoadKDString("添加业务分组","0025710000006767"),ResManager.LoadKDString("恢复默认布局","0025710000006704"),l))}s.append(r);var d=e?"kd-H5SubSystemConsolSaveBtn":"kd-H5CardSaveBtn",c=e?"kd-H5SubSystemConsolCanelBtn":"kd-H5CardCanelBtn",h=$(KD.format("<div class='kd-H5CardButtomBtnList'><div id='{3}' title='{0}'>{1}</div><div id='{4}' title='{2}'>{2}</div></div>",ResManager.LoadKDString("保存当前布局","0025710000006705"),ResManager.LoadKDString("确定","0991733000003896"),ResManager.LoadKDString("取消","0991733000003922"),d,c));s.append(h),$("#addCardBtn").off("click").on("click",function(t){o.checkCanAddCard()&&(o.setViewLocked($("#addCardBtn")),e?o.getTargetFormProxy(o.targetStdProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targetStdProxy),o.targetStdProxy.config.id,"AddCardClick"):o.getTargetFormProxy(o.targeCommontProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targeCommontProxy),o.targeCommontProxy.config.id,"AddCardClick"),o.removeVieLocked($("#addCardBtn")))}),$("#addBusinessGroupBtn",n).off("click").on("click",function(e){o.setViewLocked($("#addBusinessGroupBtn")),o.getTargetFormProxy(o.targeCommontProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targeCommontProxy),o.targeCommontProxy.config.id,"AddBusinessGroupClick"),o.removeVieLocked($("#addBusinessGroupBtn"))}),$("#resetCarLayoutBtn",n).off("click").on("click",function(e){o.setViewLocked($("#resetCarLayoutBtn")),o.getTargetFormProxy(o.targeCommontProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targeCommontProxy),o.targeCommontProxy.config.id,"resetCarLayoutClick"),o.removeVieLocked($("#resetCarLayoutBtn"))}),$("#kd-H5CardSaveBtn",n).off("click").on("click",function(e){o.setViewLocked($("#kd-H5CardSaveBtn")),o.saveCardLayout.call(o,e),KD.delayInvoke(function(){o.removeVieLocked($("#kd-H5CardSaveBtn")),o.outOfCardDesign()},1e3)}),$("#kd-H5SubSystemConsolSaveBtn",n).off("click").on("click",function(e){o.setViewLocked($("#kd-H5SubSystemConsolSaveBtn")),o.saveSubSystemConsoleCardLayout.call(o,e),KD.delayInvoke(function(){o.removeVieLocked($("#kd-H5SubSystemConsolSaveBtn")),o.outOfCardDesign()},1e3)}),$("#kd-H5CardCanelBtn",n).off("click").on("click",function(t){o.setViewLocked($("#kd-H5CardCanelBtn")),e?o.getTargetFormProxy(o.targetStdProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targetStdProxy),o.targetStdProxy.config.id,"canelCarLayoutClick"):o.getTargetFormProxy(o.targeCommontProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targeCommontProxy),o.targeCommontProxy.config.id,"canelCarLayoutClick"),o.removeVieLocked($("#kd-H5CardCanelBtn"))}),$("#kd-H5SubSystemConsolCanelBtn",n).off("click").on("click",function(t){o.setViewLocked($("#kd-H5SubSystemConsolCanelBtn")),e?o.getTargetFormProxy(o.targetStdProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targetStdProxy),o.targetStdProxy.config.id,"canelCarLayoutClick"):o.getTargetFormProxy(o.targeCommontProxy).fireCustomEvents.call(o.getTargetFormProxy(o.targeCommontProxy),o.targeCommontProxy.config.id,"canelCarLayoutClick"),o.removeVieLocked($("#kd-H5SubSystemConsolCanelBtn"))})}},initSmartCardFuncButton:function(e){return},_setFocusOnBottomDiv:function(){var e=this;targetFormProxyEl=e.getTargetFormProxy(e.targeCommontProxy).el,targetFormProxyEl&&targetFormProxyEl.next()&&$(".kd-H5SmartCardBottomLink",targetFormProxyEl.next()).focus()},checkStdCanAddCard:function(){var e=$(".kd-infoflow-stdGroupItem",this.getStdToDoListTarget());return e.length>=KD.CONST.MaxCardsCount?(KD.Error.raise({msg:KD.format(ResManager.LoadKDString("当前已有{0}张卡片，不允许继续添加卡片。可替换卡片或者先删除卡片后再添加卡片","0025710000008045"),e.length)}),!1):!0},checkCanAddCard:function(){var e=$(".kd-infoflow-item",this.targeCommontProxy.el);return e.length>=KD.CONST.MaxCardsCount?(KD.Error.raise({msg:KD.format(ResManager.LoadKDString("当前已有{0}张卡片，不允许继续添加卡片。可替换卡片或者先删除卡片后再添加卡片","0025710000008045"),e.length)}),!1):!0},getCardEditListDom:function(e){var t;return t=e?$(KD.format("<div class='kd-cardEditBtnList'><span title='{0}' style='display:none;margin-right:10px;opacity:0.4;' class='kd-cardEditItem kd-cardEdit k-icon k-i-pencil'></span></div><div style='clear:both;height:0px;'></div>",ResManager.LoadKDString("编辑卡片","0025710000006706"))):$(KD.format("<div class='kd-cardEditBtnList'><span title='{0}' style='display:none;margin-right:10px;opacity:0.4;' class='kd-cardEditItem kd-cardEdit k-icon k-i-pencil'></span><span title='{1}' style='opacity:0.4;' class='kd-cardEditItem kd-cardReplace'></span><span title='{2}' class='kd-cardEditItem kd-cardDelete '></span></div><div style='clear:both;height:0px;'></div>",ResManager.LoadKDString("编辑卡片","0025710000006706"),ResManager.LoadKDString("替换卡片","0025710000006707"),ResManager.LoadKDString("删除卡片","0025710000006708")))},getSmartCardEditListDom:function(e,t){var i=KD.IsNullOrWhiteSpace(e)?"none":"inline-block",a=t?"kd-smartCardEdit-customevent":"",n=$(KD.format("<div class='kd-cardEditBtnList'><span title='{0}' style='margin-right:10px;' class='kd-cardEditItem kd-smartCardDelete'>{0}</span><span title='{1}' style='display:{2}' class='kd-cardEditItem kd-smartCardEdit {3}'>{1}</span></div><div style='clear:both;height:0px;'></div>",ResManager.LoadKDString("移除","002014030035640"),ResManager.LoadKDString("编辑","014003000005395"),i,a));return n},getSmartCardLayoutAdjusttDom:function(e){var t=$(KD.format("<div class='kd-smartcard-layoutadjust'><span title='{0}'>{0}</span></div><div style='clear:both;height:0px;'></div>",KD.IsNullOrWhiteSpace(e)?"":e));return t},getConsoleCardEditListDom:function(e){var t=KD.IsNullOrWhiteSpace(e)?"none":"inline-block",i=$(KD.format("<div class='kd-cardEditBtnList'><span title='{0}' style='margin-right:10px;' class='kd-cardEditItem kd-smartCardDelete kd-monitorCardDelete'>{0}</span><span title='{1}' style='display:{2}' class='kd-cardEditItem kd-smartCardEdit'>{1}</span></div><div style='clear:both;height:0px;'></div>",ResManager.LoadKDString("删除","014003000000376"),ResManager.LoadKDString("编辑","014003000005395"),t));return i},setViewLocked:function(e){if($(".kd-ui-viewlocker",e).remove(),e){var t={};t.height=e.height(),"absolute"==e.css("position")?$.extend(t,{top:0,left:0}):(t=e.position(),t.height=e.height(),t.width=e.width()),$('<div class="kd-ui-viewlocker">').css(t).appendTo(e)}},removeVieLocked:function(e){$(".kd-ui-viewlocker",e).remove()},initCardEditbtnList:function(e,t){var i,a=this;i=e?this.getTargetEl(a.targetStdProxy):this.getTargetEl(a.targeCommontProxy);for(var n=$(".kd-infoflow-item",i),o=0;o<n.length;o++)if("false"==$($(n[o]).parents(".kd-infoflow-panel")[0]).attr("isallowedit")||"false"==$(n[o]).attr("isallowedit")){var r=$(n[o].children[0]);this.addCardNameEdit(r)}else if("false"==$($(n[o]).parents(".kd-infoflow-panel")[0]).attr("isshowedit")||"false"==$(n[o]).attr("isshowedit")){var r=$(n[o].children[0]);r.before(this.getCardEditListDom(!0)),this.addCardNameEdit(r)}else if("true"==$($(n[o]).parents(".kd-infoflow-panel")[0]).attr("isaddbutton")||"true"==$(n[o]).attr("isaddbutton")){var r=$(n[o].children[0]);this.addCardNameEdit(r)}else{var r=$(n[o].children[0]);r.before(this.getCardEditListDom()),this.addCardNameEdit(r)}$(".kd-cardDelete",i).off("click").on("click",function(t){e?a.onStdCardDeleteClick.call(a,t):a.onCardDeleteClick.call(a,t)}),$(".kd-cardReplace",i).off("click").on("click",function(e){a.onCardReplaceClick.call(a,e)}),$(".kd-cardEdit",i).off("click").on("click",function(i){a.onCardEditClick.call(a,i,e,t)})},initSmartCardEditbtnList:function(e){var t,i=this;t=this.getTargetEl(i.targeCommontProxy);for(var a=$(".kd-infoflow-item",t),n=0;n<a.length;n++){var o=KD.parseObject($(a[n]).attr("cardinfo")),r=KD.IsNullOrWhiteSpace(o.cardparminfo)?"":KD.parseObject(o.cardparminfo);if(!KD.IsNullOrWhiteSpace(r)){var s=KD.isEmpty(r.setformid)?"":r.setformid,l=KD.isEmpty(r.issendcustomevent)?!1:KD.equalsIgnoreCase(r.issendcustomevent.toString(),"true")?!0:!1,d=$(a[n].children[0]);e||(d.before(this.getSmartCardEditListDom(s,l)),this.addCardNameEdit(d,!0))}}$(".kd-smartCardDelete",t).off("click").on("click",function(e){i.onCardDeleteClick.call(i,e,!0)}),$(".kd-smartCardEdit",t).off("click").on("click",function(e){i.onSmartCardEditClick.call(i,e)})},initMonitorCardEditbtnList:function(){var e,t=this;e=this.getTargetEl(t.targeCommontProxy);for(var i=$(".kd-infoflow-item",e),a=0;a<i.length;a++){var n=KD.parseObject($(i[a]).attr("cardinfo")),o=KD.IsNullOrWhiteSpace(n.cardparminfo)?"":KD.parseObject(n.cardparminfo);if(!KD.IsNullOrWhiteSpace(o)){var r=KD.isEmpty(o.setformid)?"":o.setformid,s=$(i[a].children[0]);s.before(this.getConsoleCardEditListDom(r)),this.addCardNameEdit(s,!0)}}$(".kd-monitorCardDelete",e).off("click").on("click",function(e){var t=$(this).parents(".kd-infoflow-item");t&&t.remove()}),$(".kd-smartCardEdit",e).off("click").on("click",function(e){t.onSmartCardEditClick.call(t,e)})},initBusinessGroupDrag:function(){},initCardDrag:function(e){for(var t=this,e=e,i=t.getTargetEl(t.targeCommontProxy).parent(),a=$(".kd-infoflow-panel",i),n=0;n<a.length;n++){var o=$(a[n]);$(".kd-infoflow-item",o);$("#"+o.attr("id")+"_c").kendoSortable({cursor:"move",filter:".kd-infoflow-item",ignore:"input",placeholder:function(e){return e.clone().addClass("kd-placeholder")},start:function(t){if(!e){var i=t.item.parent();if(i&&(2==i.children().length||1==i.children().length)){t.preventDefault();var a=i.closest(".kd-infoflow-panel"),n=KD.format("当前卡片为【{0}】最后一张卡片，不允许删除/移动。",a.find(".kd-infopanel-title-text").text());KD.Error.raise({msg:n})}}},hint:function(e){return e.clone().css({display:"inline-block"})},change:function(e){$(".kd-infoflow-item",i).css({display:"inline-block"}),KD.delayInvoke(function(){$(".kd-infoflow-item",i).css({display:"inline-block"})},500)},cancel:function(e){$(".kd-infoflow-item",i).css({display:"inline-block"}),KD.delayInvoke(function(){$(".kd-infoflow-item",i).css({display:"inline-block"})},250)},end:function(a){if(e){var n=a.item,o=n.parents(".kd-smartcard-businesscard").index();KD.delayInvoke(function(){$(".kd-infoflow-item",i).css({display:"inline-block"});var e=n.parents(".kd-smartcard-businesscard").parent().children(".kd-smartcard-businesscard").eq(o),a=n.parents(".kd-smartcard-businesscard"),r=e.find(".kd-infoflow-item"),s=a.find(".kd-infoflow-item"),l={},d={},c=[],h=[],u=n.parents(".kd-smartcard-businesscard").index();$.each(r,function(e){var i={};i=t._getCardInfo($(this),e,o),c.push(i)}),$.each(s,function(e){var i={};i=t._getCardInfo($(this),e,u),h.push(i)});var p={};u==o||0==r.count?(l.index=o,l.colsInfo=[],p.oldColsInfo=l):(l.index=o,l.colsInfo=c,p.oldColsInfo=l),d.index=u,d.colsInfo=h,p.newColsInfo=d;var g=t.getTargetFormProxy(t.targeCommontProxy);g&&g.fireCustomEvents.call(g,KD.stringify(p),"moveCard")},500)}else{a.item.css({display:"inline-block"});var r=$(a.item.parent());r.find(".kd-clear").remove();var s=$('<div class="kd-clear" style="clear:both;height:0px;">');r.append(s)}},move:function(e){}})}},_getCardInfo:function(e,t,i){var a={},n=KD.parseObject(e.attr("cardinfo")),o=KD.parseObject(n.cardparminfo)&&KD.parseObject(n.cardparminfo).cardid;return a.entryid=n&&n.cardid,a.cardid=o,a.rowindex=t,a.colindex=i,a},stdDesign:function(e){var t=this;$(".kd-H5CardEditBtnDiv",t.getTargetEl(t.targetStdProxy).parent()).show(),$(".kd-cardEditBtnList",t.getTargetEl(t.targetStdProxy)).show(),$(".kd-cardEditBtnList",t.getTargetEl(t.targetStdProxy)).addClass("kd-stdCardEditBtnList"),$(".kd-infoflow-stdGroupAddItem",t.getTargetEl(t.targetStdProxy)).show(),$(".kd-infoflow-lastStdGroupItem",t.getTargetEl(t.targetStdProxy)).removeClass("kd-infoflow-lastStdGroupItem");var i=t.getTargetEl(t.targetStdProxy).find(".kd-cardEdit");e?$(i).click():i.length>0&&$(i[0]).click(),$(".kd-addcardpanel-btn",t.getTargetEl(t.targetStdProxy)).off("click").on("click",function(e){t.checkStdCanAddCard()&&(t.setViewLocked($(".kd-addcardpanel-btn")),t.getTargetFormProxy(t.targetStdProxy).fireCustomEvents.call(t.getTargetFormProxy(t.targetStdProxy),t.targetStdProxy.config.id,"AddCardClick"),t.removeVieLocked($(".kd-addcardpanel-btn")))})},design:function(e){var t=this;this.initBusinessGroupDrag(),this.initCardDrag(e);var t=this;if($(".kd-H5CardEditBtnDiv",t.getTargetEl(t.targeCommontProxy)).show(),$(".kd-cardEditBtnList",t.getTargetEl(t.targeCommontProxy)).show(),e){var i=$(".kd-smartCardEdit-customevent",t.getTargetEl(t.targeCommontProxy));if(i&&i.length>0)for(var a=0;a<i.length;a++)t.fireSmartCardEditClick($(i[a]),!0)}else $(".kd-cardEdit",t.getTargetEl(t.targeCommontProxy)).click()},monitorDesign:function(){var e=this;this.initBusinessGroupDrag();var e=this;$(".kd-H5CardEditBtnDiv",e.getTargetEl(e.targeCommontProxy)).show(),$(".kd-cardEditBtnList",e.getTargetEl(e.targeCommontProxy)).show(),$(".kd-cardEdit",e.getTargetEl(e.targeCommontProxy)).click()},outOfCardDesign:function(){var e=this;$(".kd-H5CardEditBtnDiv",e.getTargetEl(e.targeCommontProxy).parent()).hide(),$(".kd-cardEditBtnList",e.getTargetEl(e.targeCommontProxy)).hide(),$(".kd-infoflow-stdGroupAddItem",e.getTargetEl(e.targeCommontProxy)).hide(),$(".kd-infoflow-stdGroupAddItem",e.getTargetEl(e.targeCommontProxy)).prev().addClass("kd-infoflow-lastStdGroupItem")},showSmartCardBottom:function(){},onPanelDrop:function(e){},onItemDrop:function(e){},doDesignerCommand:function(e){if(!KD.isEmpty(e)){var t=e.Command;this[t]&&this[t].call(this,e)}},doDesignerStdConsoleCommand:function(e){if(!KD.isEmpty(e)){var t=e.Command;this[t]&&this[t].call(this,e)}},onCommit:function(){this.targeCommontProxy.getTargetFormProxy($this.targeCommontProxy).call(this.targeCommontProxy)},saveCardLayout:function(e){for(var t=this,i=this.targeCommontProxy.el.find(".kd-infoflow-panel"),a=[],n=0;n<i.length;n++){for(var o=$(i[n]),r=KD.parseObject(o.attr("data-attdata")),s={groupId:r.id.replace("BussinessPanel_","").replace("BUSSINESSPANEL_",""),groupTitle:o.find(".kd-infopanel-title-text").text()},l=o.find(".kd-infoflow-item"),d=[],c=0;c<l.length;c++){var h=$(l[c]),u=KD.parseObject(h.attr("cardInfo"));d.push(u)}s.cards=d,a.push(s)}t.getTargetFormProxy(t.targeCommontProxy).fireCustomEvents.call(t.getTargetFormProxy(t.targeCommontProxy),t.targeCommontProxy.config.id,"saveCarLayoutClick",JSON.stringify(a))},saveSubSystemConsoleCardLayout:function(e){for(var t=this,i=this.targetStdProxy.el.find(".kd-infoflow-panel").find(".kd-infoflow-stdGroup"),a=[],n=0;n<i.length;n++){for(var o=$(i[n]),r=KD.parseObject(o.attr("data-attdata")),s={groupId:r.id.replace("BussinessPanel_","").replace("BUSSINESSPANEL_",""),groupTitle:o.find(".kd-infopanel-title-text").text()},l=o.find(".kd-infoflow-item"),d=[],c=0;c<l.length;c++){var h=$(l[c]),u=KD.parseObject(h.attr("cardInfo"));d.push(u)}s.cards=d,a.push(s)}t.getTargetFormProxy(t.targetStdProxy).fireCustomEvents.call(t.getTargetFormProxy(t.targetStdProxy),t.targetStdProxy.config.id,"saveCarLayoutClick",JSON.stringify(a))},resetDefaultLayout:function(){},onCardReplaceClick:function(e){var t=this,i=$(e.target).closest(".kd-infoflow-item"),a=KD.parseObject(i.attr("cardinfo")),n=i.find(".kdform"),o=KD.parseObject(n.attr("data-attdata")),r=i.closest(".kd-infoflow-panel"),s=KD.parseObject(r.attr("data-attdata")),l={cardId:a.cardid,pageId:o.id,Seq:a.Seq,groudId:s.id.replace("BussinessPanel_","").replace("BUSSINESSPANEL_","")},d=t.targetStdProxy||t.targeCommontProxy;this.getTargetFormProxy(d).fireCustomEvents.call(this.getTargetFormProxy(d),o.id,"replaceCard",KD.stringify(l))},onCardDeleteClick:function(e,t){var i=this,a=$(e.target).closest(".kd-infoflow-item");if(t){var n=$(a.parents(".kd-smartcard-allcardlayout")),o=n&&n.find(".kd-infoflow-item").not(".kd-smartcard-emptycard");if(o&&o.length<=1){var r=KD.format(ResManager.LoadKDString("当前卡片为最后一张卡片，不允许删除。","014003000005396"));return void KD.Error.raise({msg:r})}}else if($(a.parent()).find(".kd-infoflow-item").length<=1){var s=a.closest(".kd-infoflow-panel"),r=KD.format(ResManager.LoadKDString("当前卡片为【{0}】最后一张卡片，不允许删除/移动。","014003000005397"),s.find(".kd-infopanel-title-text").text());return void KD.Error.raise({msg:r})}var l=a.find(".kdform"),d=KD.parseObject(l.attr("data-attdata")),c=d&&d.id||"",h={cardId:KD.parseObject(a.attr("cardinfo")).cardid,pageId:c},u=i.targetStdProxy||i.targeCommontProxy;this.getTargetFormProxy(u).fireCustomEvents.call(this.getTargetFormProxy(u),c,"deleteCard",KD.stringify(h))},onStdCardDeleteClick:function(e){var t=this,i=$(e.target).closest(".kd-infoflow-item"),a=this.getToDoListGroupProxy().getFormProxy();if($(i.parent()).find(".kd-infoflow-item").length<=2)return void(a&&a.fireCustomEvents.call(a,a.pageId,"lastcard",null));var n=i.find(".kdform"),o=n.parents(".kd-infoflow-stdGroupItem").attr("id")||"",r={cardId:KD.parseObject(i.attr("cardinfo")).cardid,pageId:o,formType:null};this.getTargetFormProxy(t.targetStdProxy).fireCustomEvents.call(this.getTargetFormProxy(t.targetStdProxy),a.pageId,"deleteCard",KD.stringify(r))},onSmartCardEditClick:function(e){var t=this;t.fireSmartCardEditClick($(e.target),!1)},fireSmartCardEditClick:function(e,t){var i=this,a=e.closest(".kd-infoflow-item"),n=a.find(".kdform"),o=KD.parseObject(n.attr("data-attdata")),r=i.targeCommontProxy||i.targetStdProxy,s=o&&o.id||"",l={cardId:KD.parseObject(a.attr("cardinfo")).cardid,cardparminfo:KD.parseObject(a.attr("cardinfo")).cardparminfo,cardname:KD.parseObject(a.attr("cardinfo")).cardname,pageId:s,isdesign:t?!0:!1};i.getTargetFormProxy(r).fireCustomEvents.call(i.getTargetFormProxy(r),s,"editCardInfo",KD.stringify(l))},onCardEditClick:function(e,t,i){var a=this;if(t&&!i){var n=a.targetStdProxy,o=n&&n.el,r=o&&o.find(".kd-infoflow-item:visible");if(r&&r.length>0)for(var s=0;s<r.length;s++){var l=!KD.isEmpty(r[s])&&$(r[s]),d=!KD.isEmpty(l)&&l.length>0&&l.find(".kdform:visible"),c=d.length>0&&KD.parseObject($(d[0]).attr("data-attdata")),h=this.getCardFormProxy(c.id),u=d&&d.length>0&&d.attr("data-kdformid");h&&h.fireCustomEvents&&h.fireCustomEvents.call(h,u,"editCardInfo",c.id)}}else{var p=$(e.target).closest(".kd-infoflow-item"),g=p.find(".kdform"),f=KD.parseObject(g.attr("data-attdata")),m=a.targetStdProxy||a.targeCommontProxy,v=a.getTargetFormProxy(m)&&a.getTargetFormProxy(m).controlFactoryProxy&&a.getTargetFormProxy(m).controlFactoryProxy.childForms;if(f&&!KD.isEmpty(f.id)){var y=this.getCardFormProxy(f.id);if(!y)for(var b=g.parent().closest(".kdform").data("attdata"),s=0;s<v.length;s++)if(b&&b.id==v[s].baseId){v=v[s]&&v[s].controlFactoryProxy.childForms,y=this.getCardFormProxy(f.id);break}y&&y.fireCustomEvents&&y.fireCustomEvents.call(y,f.id,"editCardInfo")}}},getCardFormProxy:function(e){return ClientAppProxy.Current.getAliveForm(e)},getStdToDoListTarget:function(){var e=$(".kd-infoflow-stdGroup",this.getTargetEl(this.targetStdProxy)).children()[0];return e=$(e)},getToDoListGroupProxy:function(){for(var e=this.targetStdProxy.children,t=0;t<e.length;t++){var i=e[t];if(i.el.attr("class").indexOf("kd-stdinfo-todolistcard")>-1){var a=i.el.find('div[data-kdformid="BOS_H5BUSSINESSTODOLIST"]');a=$(a);var n=a.attr("data-attdata"),o=KD.parseObject(n),r=ClientAppProxy.Current.getAliveForm(o.id),s=r.getControlProxy("H5CARDLAYOUTSTDAPPALL");return s}}},getBussinessGroupProxy:function(e){for(var t=this.targeCommontProxy.children,i=0;i<t.length;i++){var a=t[i];if(a.config.id.toUpperCase()==("BussinessPanel_"+e).toUpperCase())return a}},newCardId:0,addCard:function(e,t){var i=this,a=$("#"+this.getTargetFormProxy(this.targeCommontProxy).getBaseId()+"-BUSSINESSPANEL_"+e.groudId+"_c");if(a.length<=0)return void KD.Error.raise({msg:ResManager.LoadKDString("业务分组不存在。请刷新页面后重新操作！","0025710000006710")});var n,o=!1,r=a.children().length,s=$(a.children()[r-1]);if(void 0!=t){o=!0,n=this.getCardFormProxy(e.pageId);var l=n.el.closest(".kd-infoflow-item"),d=l.index();n.release(),l.remove(),s=$(a.children()[d]),s.length<=0&&(s=$(a.children()[0])),e.cardId="Replace_"+e.cardId}o||(e.cardId="NEW"+this.newCardId,this.newCardId++);var c={allowexpand:!1,row:"0",background:"#ffffff",ctOrientation:"horizontal",dock:6,height:190,hoverable:!0,inAllFlowlayoutChild:!1,isNoneAbsPosition:!0,isInfo:!0,ishideprogressindicator:!0,items:null,keyvalue:null,margin:"0,0,20,20",minHeight:190,showTitle:!1,style:"0",tempwidth:"100*",width:300,xtype:"kdinfoflowitem",parent:"BussinessPanel_"+e.groudId,id:"H5Card_"+e.cardId,Seq:o?e.Seq:r-1,cardid:e.cardId,cardparminfo:e.partsparames||"",formid:e.formId,cardname:e.title,isPreView:!0,col:r},h=this.targeCommontProxy.getControlFactoryProxy(),u=h.createControl.call(h,c);u.parentProxy=this.getBussinessGroupProxy(e.groudId),u.parentProxy.children.push(u);var p=u.getControl.call(u);p.dock=c.dock,s.before(p);var g=i.getCardEditListDom();$(p.children()[0]).before(g),u.initComponent.call(u,c),u.loadConfig.call(u,c),u.parentProxy.onAfterControlInited(u),$(".kd-cardDelete",g).off("click").on("click",function(e){i.onCardDeleteClick.call(i,e)}),$(".kd-cardReplace",g).off("click").on("click",function(e){i.onCardReplaceClick.call(i,e)}),$(".kd-cardEdit",g).off("click").on("click",function(e){KD.Error.raise({msg:ResManager.LoadKDString("该卡片为新增卡片，需要先保存布局后才可以编辑！","0025710000006711")})})},addStdCard:function(e,t){var i=this,a=$(".kd-infoflow-stdGroup",this.getTargetEl(this.targetStdProxy)).children()[0];if(a=$(a),a.length<=0)return void KD.Error.raise({msg:ResManager.LoadKDString("业务分组不存在。请刷新页面后重新操作！","0025710000006710")});var n,o=!1,r=a.find(".kd-infoflow-stdGroupItem").length,s=a.find(".kd-infoflow-stdGroupAddItem");if(void 0!=t){o=!0,n=this.getCardFormProxy(e.pageId);var l=n.el.closest(".kd-infoflow-item"),d=l.index();n.release(),l.remove(),s=$(a.children()[d]),s.length<=0&&(s=$(a.children()[0])),e.cardId="Replace_"+e.cardId}o||(e.cardId="NEW"+this.newCardId,this.newCardId++);var c={allowexpand:!1,row:"0",background:"#ffffff",ctOrientation:"horizontal",dock:6,height:140,hoverable:!0,inAllFlowlayoutChild:!1,isNoneAbsPosition:!0,isInfo:!0,ishideprogressindicator:!0,items:null,keyvalue:null,margin:"0,0,20,20",minHeight:140,showTitle:!1,style:"0",tempwidth:"100*",width:200,xtype:"kdinfoflowitem",id:"H5Card_"+e.cardId,Seq:o?e.Seq:r-1,cardid:e.cardId,cardparminfo:e.partsparames||"",formid:e.formId,cardname:e.title,isPreView:!0,col:r},h=this.getToDoListGroupProxy().getControlFactoryProxy(),u=h.createControl.call(h,c);u.parentProxy=this.getToDoListGroupProxy(),u.parentProxy.children.push(u);var p=u.getControl.call(u);p.dock=c.dock,s.before(p);var g=i.getCardEditListDom();$(p.children()[0]).before(g),u.initComponent.call(u,c),u.loadConfig.call(u,c),u.parentProxy.onAfterControlInited(u),$(".kd-cardDelete",g).off("click").on("click",function(e){i.onStdCardDeleteClick.call(i,e)}),$(".kd-cardReplace",g).off("click").on("click",function(e){i.onCardReplaceClick.call(i,e)}),$(".kd-cardEdit",g).off("click").on("click",function(e){KD.Error.raise({msg:ResManager.LoadKDString("该卡片为新增卡片，需要先保存布局后才可以编辑！","0025710000006711")})})},addSmartCard:function(e,t){var i=this,a=$("#"+this.getTargetFormProxy(this.targeCommontProxy).getBaseId()+"-BUSSINESSPANEL_"+e.groudId+"_c");a.length<=0;var n,o=!1,r=a.children().length,s=$(a.children()[r-1]);if(void 0!=t){o=!0,n=this.getCardFormProxy(e.pageId);var l=n.el.closest(".kd-infoflow-item"),d=l.index();n.release(),l.remove(),s=$(a.children()[d]),s.length<=0&&(s=$(a.children()[0])),e.cardId="Replace_"+e.cardId}o||(e.cardId="NEW"+this.newCardId,this.newCardId++);var c={allowexpand:!1,row:"0",background:"#ffffff",ctOrientation:"horizontal",dock:6,height:e.height?e.height:190,hoverable:!0,inAllFlowlayoutChild:!1,isNoneAbsPosition:!0,isInfo:!0,ishideprogressindicator:!0,items:null,keyvalue:null,margin:"0,0,20,20",minHeight:e.height?e.height:190,showTitle:!1,style:"0",tempwidth:"100*",width:430,xtype:"kdinfoflowitem",parent:"BussinessPanel_"+e.groudId,id:"H5Card_"+e.cardId,Seq:o?e.Seq:r-1,cardid:e.cardId,cardparminfo:e.partsparames||"",formid:e.formId,cardname:e.title,isPreView:!0,col:r},h=this.targeCommontProxy.getControlFactoryProxy(),u=h.createControl.call(h,c);u.parentProxy=this.getBussinessGroupProxy(e.groudId),u.parentProxy.children.push(u);var p=u.getControl.call(u);p.dock=c.dock,s.before(p);var g=i.getSmartCardEditListDom();if($(p.children()[0]).before(g),u.initComponent.call(u,c),u.loadConfig.call(u,c),u.parentProxy.onAfterControlInited(u),u.parentProxy.children.length>1)for(var f=0;f<u.parentProxy.children.length;f++){var m=u.parentProxy.children[f];m&&m.key&&m.key.indexOf("EMPTYCARD")>-1&&m.el.css({display:"none"})}else m.el.css({display:"inline-block"});$(".kd-smartCardDelete",g).off("click").on("click",function(e){i.onCardDeleteClick.call(i,e)}),$(".kd-smartCardEdit",g).off("click").on("click",function(e){KD.Error.raise({msg:ResManager.LoadKDString("该卡片为新增卡片，需要先保存布局后才可以编辑！","0025710000006711")})})},addMonitorCard:function(e,t){var i=this,a=$("#"+this.getTargetFormProxy(this.targeCommontProxy).getBaseId()+"-BUSSINESSPANEL_"+e.groudId+"_c");if(a.length<=0)return void KD.Error.raise({msg:ResManager.LoadKDString("业务分组不存在。请刷新页面后重新操作！","0025710000006710")});var n,o=!1,r=a.children().length,s=$(a.children()[r-1]);if(void 0!=t){o=!0,n=this.getCardFormProxy(e.pageId);var l=n.el.closest(".kd-infoflow-item"),d=l.index();n.release(),l.remove(),s=$(a.children()[d]),s.length<=0&&(s=$(a.children()[0])),e.cardId="Replace_"+e.cardId}o||(e.cardId="NEW"+this.newCardId,this.newCardId++);var c={allowexpand:!1,row:"0",background:"#ffffff",ctOrientation:"horizontal",dock:6,height:190,hoverable:!0,inAllFlowlayoutChild:!1,isNoneAbsPosition:!0,isInfo:!0,ishideprogressindicator:!0,items:null,keyvalue:null,margin:"0,0,20,20",minHeight:324,showTitle:!1,style:"0",tempwidth:"100*",width:430,xtype:"kdinfoflowitem",parent:"BussinessPanel_"+e.groudId,id:"H5Card_"+e.cardId,Seq:o?e.Seq:r-1,cardid:e.cardId,cardparminfo:e.partsparames||"",formid:e.formId,cardname:e.title,isPreView:!0,col:r},h=this.targeCommontProxy.getControlFactoryProxy(),u=h.createControl.call(h,c);u.parentProxy=this.getBussinessGroupProxy(e.groudId),u.parentProxy.children.push(u);var p=u.getControl.call(u);p.dock=c.dock,s.before(p);var g=i.getSmartCardEditListDom();$(p.children()[0]).before(g),u.initComponent.call(u,c),u.loadConfig.call(u,c),u.parentProxy.onAfterControlInited(u),$(".kd-smartCardDelete",g).off("click").on("click",function(e){i.onCardDeleteClick.call(i,e)})},editCard:function(e){},deleteCard:function(e){var t=$("#"+this.getTargetFormProxy(this.targeCommontProxy).getBaseId()+"-H5CARD_"+e.cardId);t.remove()},deleteStdCard:function(e){var t;e.cardId.indexOf("NEW")>-1?(t=$("#"+e.pageId+"-H5CARD_"+e.cardId),t.remove()):(t=$("#"+e.pageId),t.remove())},addCommFuncCards:function(e,t){var i=this;if(e){this.targeCommontProxy=t;var a=e.needAddCards,n=e.realAddCards;n||(n=a);var o=e.groudId,r=(e.pageId,e.currentSeq),s=$("#"+this.getTargetFormProxy(t).getBaseId()+"-BUSSINESSPANEL_"+o+"_c");if(s.length<=0)return void KD.Error.raise({msg:ResManager.LoadKDString("业务分组不存在。请刷新页面后重新操作！","0025710000006710")});for(var l=$(".kd-infoflow-item",s),d=null,c=0,h=0;h<l.length;h++){var u=$(l[h]),p=u.attr("cardinfo"),g=KD.parseObject(p);g.Seq==r?(d=u,c=h):g.Seq>r&&(g.Seq=g.Seq+n,u.attr("cardinfo",KD.stringify(g)))}for(var f=e.cardList,m=$(".kd-H5CardTopBtnList").length>0?!0:!1,h=0;h<f.length;h++){var v=f[h],y={allowexpand:!1,row:"0",background:"#ffffff",ctOrientation:"horizontal",dock:6,height:190,hoverable:!0,inAllFlowlayoutChild:!1,isNoneAbsPosition:!0,isInfo:!0,ishideprogressindicator:!0,items:null,keyvalue:null,margin:"0,0,20,20",minHeight:190,showTitle:!1,style:"0",tempwidth:"100*",width:300,xtype:"kdinfoflowitem",parent:"BussinessPanel_"+v.groudId,id:"H5Card_"+v.cardId,Seq:v.Seq,cardid:v.cardId,cardparminfo:v.partsparames||"",formid:v.formId,cardname:v.title,isPreView:!0,col:c+1},b=t.getControlFactoryProxy(),D=b.createControl.call(b,y);D.parentProxy=this.getBussinessGroupProxy(o),D.parentProxy.children.push(D);var k=D.getControl.call(D);if(k.dock=y.dock,d.after(k),D.initComponent.call(D,y),D.loadConfig.call(D,y),D.parentProxy.onAfterControlInited(D),d=k,m){var C=i.getCardEditListDom();$(k.children()[0]).before(C),$(".kd-cardDelete",C).off("click").on("click",function(e){i.onCardDeleteClick.call(i,e)}),$(".kd-cardReplace",C).off("click").on("click",function(e){i.onCardReplaceClick.call(i,e)}),$(".kd-cardEdit",C).off("click").on("click",function(e){KD.Error.raise({msg:ResManager.LoadKDString("该卡片为新增卡片，需要先保存布局后才可以编辑！","0025710000006711")})})}}return a>n?void KD.Error.raise({msg:KD.format(ResManager.LoadKDString("当前已有{0}张卡片，不允许继续添加卡片。可替换卡片或者先删除卡片后再添加卡片","0025710000008045"),KD.CONST.MaxCardsCount)}):void 0}},replaceCard:function(e){this.addCard(e,e.cardId)},replaceStdCard:function(e){this.addStdCard(e,e.cardId)},addBusinessGroup:function(e){var t=$(this.targeCommontProxy.el.children()[0]),i=t.children().length,a={allowexpand:!1,row:i,ctOrientation:"vertical",dock:6,height:238,orientation:"horizontal",inAllFlowlayoutChild:!0,isNoneAbsPosition:!0,isInfo:!0,ishideprogressindicator:!0,items:[],keyvalue:null,margin:"0,0,0,0",minHeight:190,showtitle:!0,style:"0",xtype:"kdinfoflowpanel",parent:"H5CARDLAYOUTALL",id:"BussinessPanel_"+e.groudId,title:e.title,col:"0"},n=this.targeCommontProxy.getControlFactoryProxy(),o=n.createControl.call(n,a);o.parentProxy=this.targeCommontProxy,o.parentProxy.children.push(o);var r=o.getControl.call(o);r.dock=a.dock,$(t.children()[i-1]).before(r),o.initComponent.call(o,a),o.loadConfig.call(o,a),o.parentProxy.onAfterControlInited(o)},editBusinessGroup:function(e){},deleteBusinessGroup:function(e){},release:function(){},addGroupNameEdit:function(){return},addCardNameEdit:function(e,t){var i=e.find("[data-canEditCardTitle='true']");if(!(i.length<=0||i.find(".h5-homepage-card-name-edit").length>0)){var a=$('<a class="h5-homepage-card-name-edit" href="javascript:;"></a>');t||i.css({width:"","max-width":"210px"}).append(a),e.find("[data-canEditCardTitle='true'] span").css({display:"inline-block","max-width":"174px"}),$("a.h5-homepage-card-name-edit").off("click").on("click",function(e){$(this).prev().hide(),$('<input type="text" class="h5-homepage-card-name-edit" maxlength="100">').val($(this).prev().text()).insertBefore($(this)).focus().blur(function(e){$(this).val().trim()&&($(this).prev().text($(this).val().trim()).show(),$(this).closest("[cardinfo]").attr("cardinfo",$(this).closest("[cardinfo]").attr("cardinfo").replace(/cardname\":\".*?\"/,'cardname":"'+$(this).val().trim()+'"'))),$(this).prev().show(),$(this).next().show(),$(this).remove()}),$(this).hide()})}}};define("KDCardLayoutDesignerProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDCardLayoutDesignerProxy}}(this)),function(){KDPanelProxy=KD.extend(KDContainerProxy,{BackColor:"",BackgroundImage:"",clearguidetimer:null,guidepanel:null,createControl:function(e){var t=this.server&&this.server.serviceName&&("ListService"==this.server.serviceName||"H5ListService"==this.server.serviceName);if(!t){var i=this.getFormProxy(),a=i&&i.dformConfig?i.dformConfig.isFluid:!1;a&&!KD.isEmpty(e.items)&&(e.items=KD.quickSort(e.items,"zindex")),this.adjustTheDockMeta(e)}KDPanelProxy.superclass.createControl.call(this,e)},adjustTheDockMeta:function(e){var t=this.getFormId(),i=KDPanelProxy.getFormMetaPlugins(t);i&&i(e)},loadConfig:function(e){this.isFormSlip=!1,KDPanelProxy.superclass.loadConfig.call(this,e);var t={};
if(e.backgroundimage){var i=KD.getValue(e,"forceabsolutepath","");if(i)this.setBackgroundImage(e.backgroundimage);else{this.BackgroundImage=e.backgroundimage;var a=KD.isUrl(this.BackgroundImage)?this.BackgroundImage:"../"+this.BackgroundImage;$.extend(t,{background:"url("+a+") no-repeat center","background-size":"100%"})}}if(e.background?(this.BackColor=e.background,$.extend(t,{"background-color":e.background})):e.backcolor&&(this.BackColor=e.backcolor,$.extend(t,{"background-color":e.backcolor})),e.margin){var n=KD.layout.kdRangeSize2HTMLRangeSize(e.margin),o=KD.layout.getRangeSizeStyleValue("margin",n);$.extend(t,o)}if(e.padding){var r=KD.layout.kdRangeSize2HTMLRangeSize(e.padding),o=KD.layout.getRangeSizeStyleValue("padding",r);$.extend(t,o)}e.isFlowForm?e.isMain?$.extend(t,{overflow:"auto"}):$.extend(t,{height:"auto"}):this.loadScrollOptions(e,t);var s=KD.getValue(e,"styleKey",null);null!=s&&this.setStylekey(KD.getValue(e,"styleKey",null)),this.el.css(t),KD.isEmpty(e.modelTitle)||this.setModelTitle(e.modelTitle)},setModelTitle:function(e){if(!KD.isEmpty(e)){var t=this.el.closest(".kdform"),i=$(".kd-modelTitlePanel",t);if(!(i.length>=1)){var a=this;i=$("<div class='kd-modelTitlePanel'><div class='kd-modelTitleSpan'><span>"+e+"</span></div><div class='kd-modelClose'><span class='k-icon k-i-close'></span></div><div style='clear: both;'></div></div>"),t.prepend(i),$(".k-i-close",i).click(function(){a._close.call(a)})}}},_close:function(){var e=this.getFormProxy();e&&e.invokeCloseAction.call(e)},loadScrollOptions:function(e,t){var i=function(e){var t="";switch(e){case 0:t="hidden";break;case 1:t="visible";break;case 2:t="auto";break;default:t=""}return t},a=i(e.vscroll),n=i(e.hscroll);a&&(t["overflow-y"]=a),a&&(t["overflow-x"]=n)},setFormSlipOptions:function(e){this.isFormSlip=KD.getValue(e,"isFormSlip",!1),this.slipInterval=1e3*KD.getValue(e,"slipInterval",5)},startFormSlip:function(e){var t=this;e&&t.isFormSlip?(this.itemSlipInterval&&clearInterval(this.itemSlipInterval),this.itemSlipInterval=KD.setInterval(function(e){t.currentShowFormIndex=(t.currentShowFormIndex+1)%t.marqueeItemList.length,$.each(t.marqueeItemList,function(e){var i=t.marqueeItemList[e];i.el&&(e==t.currentShowFormIndex?i.el.show():i.el.hide())})},t.slipInterval)):this.itemSlipInterval&&clearInterval(this.itemSlipInterval)},addDynamicForm:function(e){this.childForm=e;var t=e.getControl();$this=this,$this.isFormSlip&&($this.marqueeItemList=$this.marqueeItemList||[],$.each($this.marqueeItemList,function(e){var t=$this.marqueeItemList[e];t.el&&t.el.hide()}),$this.marqueeItemList.push(e),$this.currentShowFormIndex=$this.marqueeItemList.length-1),t.appendTo(this.getFormAppendDom())},getFormAppendDom:function(){if(this.config&&this.config.dock!=KD.dock.None&&this.config.items&&this.config.items.length>0){for(var e=!1,t=0;t<this.config.items.length;t++){var i=this.config.items[t];i.dock==KD.dock.Fill&&(e=!0)}if(e)return this.el;var a=this.el.find("div[data-kdid='"+this.getBaseId()+"_fill']");if(a&&a.length>0)return a}return this.el},setSourceUrl:function(e){this.el.css("backgroundImage","url("+e+")"),this.el.css("backgroundRepeat","no-repeat"),this.el.css("backgroundSize","100% 100%")},setData:function(e,t){var i=this;i.oldData=i.config.items,i.data=e,i.children||$.each(i.children,function(e,t){t.release()}),t&&1==t&&(i.children=[],$.each(i.oldData,function(e,t){i.data.push(t)}));var a=$.isArray(i.data)?{items:i.data}:{items:[i.data]};$.each(a.items,function(e,t){t.isDynamicCreated=!0}),i.config.items=a.items,i.el.empty(),i.clearControls(a),i.isChilderLoaded=!1,i.loadChildren(a)},replaceChildrenData:function(e){if(e&&e.items){var t=this,i=KD.isArray(e)?e:e.items;KD.isObject(e)&&void 0===e.id&&(KD.isString(e.dock)&&(e.dock=parseInt(e.dock)),i=$.extend({id:t.getKey()+"_REPLACER",dock:5,xtype:"panel",height:"inherit",width:"inherit"},e)),t.setData(i)}},setHTML:function(e){this.setData({}),this.el.setHTML(e)},setLinkPage:function(e){this.iFrameContentMode=!0;var t=KD.getValue(e,"url","");this.el.empty();var i=$('<iframe src="'+t+'" style="height:100%;width:100%;border:0px solid transparent;"></iframe>');i.appendTo(this.el)},setGuideTip:function(e){if(null!=e){this.guidepanel=$("<div style='opacity:0.95;text-align:center;padding:0px; position: absolute;width:100%;height:100%;z-index:10000;background-color:#444444;'></div>");var t=KD.getValue(e,"src","");t=KD.getValue(e,"url",t);var i=$("<img src='"+t+"'></img>");this.guidepanel.append(i),this.IsOpenInFullWindow=KD.getValue(e,"isopeninfullwindow",!0),this.IsOpenInFullWindow?$(document.body).prepend(this.guidepanel):guidepanel.prepend(this.guidepanel),i.css({"margin-top":KD.getValue(e,"y","10%"),"line-height":KD.getValue(e,"height","50%"),width:KD.getValue(e,"width","50%"),height:KD.getValue(e,"height","50%")});var a=KD.getValue(e,"autoclose",!0);if(a){var n=this;this.clearguidetimer=KD.delayInvoke(function(){n.onclearguidetimer.call(n)},KD.getValue(e,"closeinterval",5e3))}}},onclearguidetimer:function(){this.guidepanel.remove(),clearInterval(this.clearguidetimer),this.clearguidetimer=null},setBackColor:function(e){this.BackColor!=e&&(this.BackColor=e,this.el.css("background-color",e))},setBackgroundImage:function(e){if(this.BackgroundImage!=e){this.BackgroundImage=e;var t=KD.getUrlSubRoot()+"/"+this.BackgroundImage;this.setSourceUrl(t)}},setHeight:function(e){var t=this,i=parseInt(e);if(!KD.isNaN(i)){KDPanelProxy.superclass.setHeight.call(t,e);var a=t.getControlFactoryProxy();if(t.config.parent){var n=a.getCmp.call(a,t.config.parent),o=n.config,r=o?o.items:void 0;if(r)for(var s=0;s<r.length;s++)t.getKey()==r[s].id&&(itemcfg=r[s],itemcfg&&(itemcfg.height=e));n.doLayout.call(n)}}},setWidth:function(e){var t=this,i=parseInt(e);KD.isNaN(i)||(!this.config||this.config.width!=i&&this.config.customWidth!=i)&&(KDPanelProxy.superclass.setWidth.call(t,e),this.doLayout())},setVisible:function(e,t){var i=this,a=i.isVisible(),n=this.config.height;(t||a!=e||0==n)&&KDPanelProxy.superclass.setVisible.call(i,e)},onAfterVisible:function(e){var t=this;if(KDPanelProxy.superclass.onAfterVisible.call(t,e),e.visible!=e.oldVisible){var i=t.getControlFactoryProxy(),a=i.getCmp.call(i,t.config.parent);a&&a.doLayout&&a.doLayout.call(a)}},addControls:function(e){delete e.id,delete e.parentkey;for(var t in e)e[t]&&(e[t].fireUpdate=1);return this.setData(e,!0),this.children},updateDock:function(e){var t=this,i=t.config.dock;if(i!=e){t.config.dock=e,e==KD.dock.None?t.el.css({position:"absolute"}):e==KD.dock.Fill?t.el.css({position:"relative",left:"",top:""}):KD.setPositionInitial(t.el);var a=t.getControlFactoryProxy(),n=a.getCmp.call(a,t.config.parent);n&&n.doLayout&&n.doLayout.call(n),KD.delayInvoke(function(){t.childForm&&t.childForm.doLayout.call(t.childForm)})}},setDisabled:function(e){if(KDPanelProxy.superclass.setDisabled.call(this,e),this.masklayerDiv||(this.masklayerDiv=$('<div class="kd-ui-masklayerDiv" style="display:none;">'),this.el.append(this.masklayerDiv)),e){var t=0;if(this.children)for(var i=0;i<this.children.length;i++){var a=this.children[i],n=a.getControl.call(a),o=n&&n.getZIndex&&n.getZIndex();o&&o>t&&(t=o)}t+=1,this.masklayerDiv.css({"z-index":t,display:"block"})}else this.masklayerDiv.css({display:"none"})},doLayout:function(){var e=this;if(!this.iFrameContentMode&&(KDPanelProxy.superclass.doLayout.call(this,this.config),this.childForm&&(KD.layout.setInnerDFormSize(this),this.childForm.doLayout.call(this.childForm)),1==this.config.contentcenter)){var t=this.getControl();KD.isIeBrowser()&&t&&t.addClass("kd-div-centerforiediv"),t&&t.css({"text-align":"center"})&&t.children().length>0&&t.children().eq(0).css({"text-align":"left"})&&t.find("a[id*='MC_DeployMonitorView-CONTENT']").css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}),e.children&&$.each(e.children,function(e,t){var i=t.getControl.call(t);i&&i.css({position:"initial","float":"none"})})}},setX:function(e){this.el.css("left",e)},setY:function(e){this.el.css("top",e)}}),KDControlFactoryProxy.registerType("panel",KDPanelProxy),KDControlFactoryProxy.registerType("mainpanel",KDPanelProxy)}(),function(){$.extend(KDPanelProxy,{fromMetaPlugins:{},registerFormMetaPlugins:function(e,t){var i=(e||"").toLocaleUpperCase().split(",");for(var a in i){var n=i[a];n&&(KDPanelProxy.fromMetaPlugins[(n||"").toLocaleUpperCase()]=t)}},getFormMetaPlugins:function(e){var t=KDPanelProxy.fromMetaPlugins[(e||"defaultMetaDataPlugIn").toLocaleUpperCase()],i=KD.isFunction(t)?t:void 0;return i||KDPanelProxy.defaultMetaDataPlugIn},defaultMetaDataPlugIn:function(e){KD.isDebug()&&KDPanelProxy.dockFillMetaCheckPlugIn(e)},dockFillMetaCheckPlugIn:function(e){if(e){var t="",i=e.Stylekey,a=e.xtype,n=e.items;if("cloudHeader"!=i&&"panel"==a&&(!n||KD.isArray(n))){var o={0:0,1:0,2:0,3:0,4:0,5:0};for(var r in n){var s=n[r],l=s.dock||0;o[l]=o[l]+1}for(var d="",c=0,h=1;6>h;h++)c+=5!=h?o[h]||0:0,(o[h]||0)>1&&(d+=h+",");d&&(t+='From KDPanel <span style="color:#FF3CFF"><B>MetaData Error: ['+e.id+"] exists mutiple children with same dock prop. value is ["+h+"].<b></span><br>"),c>0&&0==o[5]&&(t+='From KDPanel <span style="color:#FF3CF0"><B>MetaData Error: ['+e.id+"] exists unfill elements but hasn't fill element.<b></span><br>",n.splice(0,0,{id:e.id+"_MISS_5_DOCK",dock:5,xtype:"panel",isMissReplacer:!0,visible:!1,height:0,width:0,items:[]}),e.isMissDockFill=!0),delete o,t&&KD.writeLog(t,KD.stringify(e))}}}}),KDPanelProxy.registerFormMetaPlugins("defaultMetaDataPlugIn",void 0),KDPanelProxy.registerFormMetaPlugins("dockFillMetaCheckPlugIn",KDPanelProxy.dockFillMetaCheckPlugIn)}(),function(){KDFloatPanelProxy=KD.extend(KDPanelProxy,{loadConfig:function(e){this.flowDirection=KD.getValue(e,"flowdirection",""),KDFloatPanelProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDFloatPanelProxy.superclass.initComponent.call(this);var e=this,t={position:"fixed",top:KD.getBillHeadHeight()+"px",right:"0px",left:"auto"};KD.equalsIgnoreCase(this.flowDirection+"",KD.dock.Left+"")&&(t.left="0px",t.right="auto"),this.el.addClass("kd-panel-float-container").css(t),0==this.config.visible&&e.setVisible(!1)},doLayout:function(){var e=KD.getWindowHeight()-KD.getBillHeadHeight()-KD.getScrollBarHeight();this.config.height=e,this.el.height(e),KDFloatPanelProxy.superclass.doLayout.call(this)},setItemContaonerStyle:function(e){KDFloatPanelProxy.superclass.setItemContaonerStyle.call(this,e)},setVisible:function(e,t){var i=this;this.el&&(e?i.el.focus():i.el.hide(function(){})),KDFloatPanelProxy.superclass.setVisible.call(this,e,t)},addDynamicForm:function(e){this._closeChildForm(),KDFloatPanelProxy.superclass.addDynamicForm.call(this,e)},_closeChildForm:function(e){if(this.childForm&&this.childForm.invokeCloseAction)try{this.childForm.invokeCloseAction.call(this.childForm),delete this.childForm}catch(t){KD.writeError(t.message)}}}),KDControlFactoryProxy.registerType("kdfloatpanel",KDFloatPanelProxy)}(),define("KDPanelProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDPanelProxy}}(this)),function(){KDPanelProxy.defaultMetaDataPlugIn=void 0,KDPanelProxy.registerFormMetaPlugins("BOS_HtmlConsoleMain",function(e){if(e){var t=e.items||[],i=(e.id||"").toLocaleUpperCase();switch(i){case"FPANELRIGHT":case"FPANELSEARCHCONTENT":for(var a in t){var n=t[a];KDHeadPanelProxy.isHeadPanel(n.xtype)&&(n.dock=KD.dock.Fill)}break;case"FMAINPANEL":for(var o=0;o<t.length;o++)"FPANELRIGHT"==t[o].id&&(t[o].dock=KD.dock.Fill);break;default:var r=KDPanelProxy.defaultMetaDataPlugIn;r&&r(e)}}}),KDPanelProxy.registerFormMetaPlugins("BOS_MainSystemMenu",function(e){if(e){var t=(e.items||[],(e.id||"").toLocaleUpperCase());switch(t){case"FPANEL4":e.hscroll=1,e.margin="0,0,0,0"}}}),KDPanelProxy.registerFormMetaPlugins("CRM_Cust_Cust360View",function(e){if(e){var t=e.items||[];if("FPANEL1"==e.id)for(var i=0;i<t.length;i++)"FNAME"==t[i].id&&(t[i].dock=KD.dock.Fill);else if("FCUSTOVERVIEWPANEL"==e.id)for(var i=0;i<t.length;i++)"FCUSTPANEL"==t[i].id&&(t[i].dock=KD.dock.Fill);else{var a=KDPanelProxy.dockFillMetaCheckPlugIn;a&&a(e)}}}),KDPanelProxy.registerFormMetaPlugins("BOS_ConvertOpForm",function(e){if(e){var t=e.items||[];if("BILLCONTROLS"==e.id)for(var i=0;i<t.length;i++)"FPNLMAIN"==t[i].id&&(t[i].dock=KD.dock.Fill,t[i].items=[]);else if("FTAB_PARAMSELETE"==e.id)for(var i=0;i<t.length;i++)"FPNLPARAMER"==t[i].id&&(t[i].dock=KD.dock.Fill)}}),KDPanelProxy.registerFormMetaPlugins("ER_MatchWizard,CA_CostRollup",function(e){if(e){var t=e.items||[];if("FPANELFORALL"==e.id)for(var i=0;i<t.length;i++)"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom,t[i].height=50)}}),KDPanelProxy.registerFormMetaPlugins("MOB_CreateCloudMenuWizard",function(e){if(e){var t=e.items||[];if("FPANELFORALL"==e.id)for(var i=0;i<t.length;i++)"FWIZARDSTYLE"==t[i].id&&(t[i].dock=KD.dock.Top);else if("FPANEL2"==e.id)for(var i=0;i<t.length;i++)"FENTITY"==t[i].id&&(t[i].dock=KD.dock.Fill);else if("FWIZARDSTYLE"==e.id)for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDTITLE"==t[i].id&&(t[i].height=0)}}),KDPanelProxy.registerFormMetaPlugins("PLN_MRPCALCWIZARD,PLN_BATCHMRPCALCWIZARD,PLN_WriteOff,PRD_PMWizardForm",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom,t[i].height=50);break;case"FWIZARDSTYLE":for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("Ap_AutoMatchStencil,AP_BillingMatck,AP_PayMatck,AP_Write_Off,Ap_WriteOffStencil,AR_BillingMatck,AR_Matck,AR_Write_Off",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom,t[i].height=50);break;case"FWIZARDSTYLE":for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("FA_DEPR",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDGUIDE"==t[i].id?t[i].dock=KD.dock.Fill:"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom,t[i].height=50);break;case"FWIZARDSTYLE":for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDTITLE"==t[i].id&&(t[i].dock=KD.dock.Top,t[i].height=42)}}}),KDPanelProxy.registerFormMetaPlugins("GL_AllocateExchange,GL_AntiClosingAccount,GL_ClosingAccount",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom,t[i].height=50);break;case"FWIZARDSTYLE":for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("PUR_BatchCreateVMIConsumeSum",function(e){if(e){var t=e.items||[];switch(e.id){case"FWIZARDSTYLE":for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Left,t[i].width=560)}}}),KDPanelProxy.registerFormMetaPlugins("DRP_DistributionCente",function(e){}),KDPanelProxy.registerFormMetaPlugins("DRP_ChannelRelationAddDynamic",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom,t[i].height=50);break;case"FWIZARDSTYLE":for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("CB_CostCall",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDSTYLE"==t[i].id&&(t[i].dock=KD.dock.Top),"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom,t[i].height=250);break;case"FWIZARDSTYLE":for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Fill),"FLABEL"==t[i].id&&(t[i].dock=KD.dock.Top)}}}),KDPanelProxy.registerFormMetaPlugins("ENG_BOMBatchAllocate,ENG_BOMBATCHEDIT,ENG_BOMIMEX",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=void 0,a=void 0,n=0;n<t.length;n++)"FPANELPROG"==t[n].id&&($.extend(t[n],{dock:KD.dock.None,x:1,y:1}),a=t[n],t[n]={id:"FPANELPROG_Replacer"}),"FWIZARDCOMMAND"==t[n].id&&(i=t[n],t[n].height=75);i&&a&&i.items&&i.items.push(a)}}}),KDPanelProxy.registerFormMetaPlugins("CRE_CreateScoringTb",function(e){if(e){var t=e.items||[];switch(e.id){case"FWIZARDBIZ":for(var i=0;i<t.length;i++)"FPANEL"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("HS_VALUATIONMETHOD",function(e){if(e){var t=e.items||[];"FSPLITECONTAINER~PANEL1"==e.id&&(t.splice(0,0,{id:e.id+"_MISS_5_DOCK",dock:5,xtype:"panel",isMissReplacer:!0,visible:!1,height:0,width:0,items:[]}),e.isMissDockFill=!0)}}),KDPanelProxy.registerFormMetaPlugins("FA_CLOSINGACCOUNT",function(e){if(e){var t=e.items||[];if("FPANEL"==e.id)for(var i=0;i<t.length;i++)t[i].dock=KD.dock.None}}),KDPanelProxy.registerFormMetaPlugins("STK_InStock",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANEL4":for(var i=0;i<t.length;i++)"FPANEL5"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("PUR_PurchaseOrder",function(e){if(e){var t=e.items||[];switch(e.id){case"FHEADFINANCEPAGE":for(var i=0;i<t.length;i++)"FPANEL2"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("ENG_BOM",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANEL":for(var i=0;i<t.length;i++)"FPANEL2"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("HS_CALSTOCKIN",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom),"FWIZARDCAPTION"==t[i].id&&(t[i].dock=KD.dock.Top),"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("HS_OutStockAcctg",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++)"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom)}}}),KDPanelProxy.registerFormMetaPlugins("STK_InitInStock",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANEL4":for(var i=0;i<t.length;i++)"FPANEL5"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("SUB_ReqChange,PRD_MOChange,SUB_CVA,PRD_CVA,PRD_MOVEMTRL,REM_CVA",function(e){if(e){var t=e.items||[];switch(e.id){case"FSPLITECONTAINER~PANEL1":for(var i=0;i<t.length;i++)"FTAB1"==t[i].id&&(t[i].dock=KD.dock.Fill);break;case"FTAB_PPBOM":for(var i=0;i<t.length;i++)"FPPBOMPANEL"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("ER_ExpenseRequest_Travel,ER_ExpenseRequest",function(e){if(e){var t=e.items||[];switch(e.id){case"FSPLITECONTAINER~PANEL1":for(var i=0;i<t.length;i++)"FPANELTOP"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("FA_BORROW",function(e){if(e){var t=e.items||[];switch(e.id){case"BILLCONTROLS":for(var i=0;i<t.length;i++)"FPANEL"==t[i].id?t[i].dock=KD.dock.Top:"FTAB1"==t[i].id?t[i].dock=KD.dock.Fill:"FTAB2"==t[i].id&&(t[i].dock=KD.dock.Bottom)}}}),KDPanelProxy.registerFormMetaPlugins("CB_COMPLETIONQTYRPT,CB_CLASSALLOCSTDSETRPT,HS_HSBillCostAnalysis,CB_PROSALEPROFITRPT,CB_PROSALEPROFITRPT,HS_InStockEstimateSummary,CB_PUTINOUTPUTRPT,CB_SFCINOUTPUTRPT,CB_MATERIALCOSTRPT,CB_NONMATALLOCRESULTRTP,CB_MATALLOCRESULTRPT,CB_STOCKINCOSTDETAILRPT,HS_InStockEstimateDetailRpt,CB_CostCalBill,CB_CostCalBillHorizonRpt,CB_SALESPROFITRPT,CB_OrderCostTrack,CB_PRODUCTPERREALCOSTDIFFRPT,CB_PRODUCTRESTORECOSTDIFFRPT",function(e){if(e){var t=e.items||[];switch(e.id){case"FSPLITECONTAINER~PANEL1":for(var i=0;i<t.length;i++)"FPANELTITLE"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("AP_ApprovalAssignHandle",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELBILL2":for(var i=0;i<t.length;i++)"FPANELBILL"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("CN_CashJournalFilter",function(e){if(e){var t=e.items||[];switch(e.id){case"FSPLITECONTAINER~PANEL1":for(var i=[],a=0;a<t.length;a++)"FGROPTITLE11"!=t[a].id&&"FGROPTITLE1"!=t[a].id&&i.push(t[a]);e.items=i}}}),KDPanelProxy.registerFormMetaPlugins("GL_TransferPL",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELFORALL":for(var i=0;i<t.length;i++){var a=t[i];switch(a.id){case"FWIZARDCOMMAND":a.dock=KD.dock.Bottom;break;case"FWIZARDSTYLE":a.dock=KD.dock.Top;break;case"FWIZARDGUIDE":a.dock=KD.dock.Fill}}}}}),KDPanelProxy.registerFormMetaPlugins("GL_VoucherAmortize",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANEL2":for(var i=0;i<t.length;i++){var a=t[i];switch(a.id){case"F_GL_GROPTITLE21":a.dock=KD.dock.Fill}}}}}),KDPanelProxy.registerFormMetaPlugins("QT_TreeModel",function(e){if(e){var t=e.items||[];switch(e.id){case"BILLCONTROLS":for(var i=0;i<t.length;i++)"FLSENTITY"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("HS_AcctgErrorDetail",function(e){if(e){var t=e.items||[];switch(e.id){case"BILLCONTROLS":for(var i=0;i<t.length;i++)"FENTRYPANEL"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("SEC_PermissionBatchAllocateObject",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELITEM2":for(var i=0;i<t.length;i++)"FITEMDETAILENTITY"==t[i].id&&(t[i].isRealModel=!0)}}}),KDPanelProxy.registerFormMetaPlugins("CP_HomePage_MainContent",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANEL_LAYOUTHOME":for(var i=0;i<t.length;i++)"FPANEL_LAYOUTHOME1"==t[i].id&&(t[i].dock=KD.dock.Fill);break;case"FPANEL_LAYOUTHOMENO1MB1":for(var i=0;i<t.length;i++)"FPANEL_LAYOUTHOMENO1M1"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("CP_NavigationBar",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANEL_LAYOUTBOTTOM1":for(var i=0;i<t.length;i++)"FPANEL_LAYOUTNAV"==t[i].id&&(t[i].dock=KD.dock.Fill);break;case"FPANEL_LAYOUTTOP":for(var i=0;i<t.length;i++)"FPANEL_TOPBAR"==t[i].id&&(t[i].dock=KD.dock.Fill);break;case"FPANEL_TOPBAR":for(var i=0;i<t.length;i++)"FPANEL_TOPBARCONTENT"==t[i].id&&(t[i].dock=KD.dock.Right,t[i].x=0);t.push({dock:KD.dock.Fill,id:"FPANEL_TOPBAR_MissFillDock",xtype:"panel",zindex:2});break;case"FPANEL_LAYOUTTOP2":for(var i=0;i<t.length;i++)"FPANEL_TOP2CONTENT"==t[i].id&&(t[i].dock=KD.dock.Right,t[i].x=0);t.push({dock:KD.dock.Fill,id:"FPANEL_LAYOUTTOP2_MissFillDock",xtype:"panel",zindex:2})}}}),KDPanelProxy.registerFormMetaPlugins("CP_HomePage_Ad_1",function(e){if(e){var t=e.items||[];switch(e.id){case"BILLCONTROLS":for(var i=0;i<t.length;i++)"FPANEL_SHELF"==t[i].id&&(t[i].dock=KD.dock.Fill)}}}),KDPanelProxy.registerFormMetaPlugins("CP_SchemeOrder,CP_NoticeList",function(e){if(e){var t=e.items||[];switch(e.id){case"FFLOWLAYOUT6":for(var i=0;i<t.length;i++)"kdgrid"==t[i].xtype&&(t[i].allowHtmlCell=!0);break;case"FFLOWLAYOUT1":for(var i=0;i<t.length;i++)"kdgrid"==t[i].xtype&&(t[i].allowHtmlCell=!0)}}}),KDPanelProxy.registerFormMetaPlugins("BAS_WarnCycle",function(e){if(e){var t=e.items||[];switch(e.id){case"FPANELMAIN":for(var i=0;i<t.length;i++)"FENDTIME"==t[i].id&&(t[i].x=t[i].x+t[i].labelWidth||0,t[i].width=t[i].width-t[i].labelWidth||0,t[i].labelWidth=0)}}}),KDPanelProxy.registerFormMetaPlugins("BAS_WARNMSGDISPLAY",function(e){if(e){var t=e.items||[];if("FTAB1"==e.id)for(var i=0;i<t.length;i++)"FPANELREMINDMSG"==t[i].id&&(t[i].vscroll=2);else if("FTAB2"==e.id)for(var i=0;i<t.length;i++)"FPANELWARNMSG"==t[i].id&&(t[i].vscroll=2);else if("FTAB3"==e.id)for(var i=0;i<t.length;i++)"FPANELURGENTMSG"==t[i].id&&(t[i].vscroll=2);else if("FPANEL"==e.id){"1033"!=KD.cookieLanguageId()&&(e.width=97,e.x=e.x-28);for(var i=0;i<t.length;i++)"FLINK"==t[i].id&&(t[i].x="1033"!=KD.cookieLanguageId()?62:100,t[i].y="1033"!=KD.cookieLanguageId()?5:2)}else if("FTAB_UNPROCESSED"==e.id)for(var i=0;i<t.length;i++)"FPANELUNPROCESSED"==t[i].id&&(t[i].vscroll=2);else if("FTAB_PROCESSED"==e.id)for(var i=0;i<t.length;i++)"FPANELPROCESSED"==t[i].id&&(t[i].vscroll=2)}}),KDPanelProxy.registerFormMetaPlugins("BOS_ConvertResultForm",function(e){if(e){e.items||[];"FTABTARGETBILL"==e.id&&(e.width="100%")}}),KDPanelProxy.registerFormMetaPlugins("SP_InStock",function(e){if(e){var t=e.items||[];if("BILLCONTROLS"==e.id)for(var i=0;i<t.length;i++)"FPANEL1"==t[i].id&&(t[i].height=130)}}),KDPanelProxy.registerFormMetaPlugins("SFC_AlertType",function(e){if(e){var t=e.items||[];if("FPANEL2"==e.id)for(var i=0;i<t.length;i++)"FTAB"==t[i].id&&(t[i].dock=KD.dock.Fill)}}),KDPanelProxy.registerFormMetaPlugins("ENG_Buffer",function(e){if(e){var t=e.items||[];if("BILLCONTROLS"==e.id){for(var i,a,n,o=0;o<t.length;o++){var r=t[o];"FPANEL1"==r.id?n=r:"FPANEL"==r.id?i=r:"FTABENTRY"==r.id&&(a=r)}var s={dock:KD.dock.Fill,id:"newFill",layout:"kdlayout",zindex:0,style:0,xtype:"panel",items:[n,a]};e.items=[i,s]}}}),KDPanelProxy.registerFormMetaPlugins("FA_DEPRPOLICY",function(e){if(e){var t=e.items||[];if("FTAB_P0"==e.id)for(var i=0;i<t.length;i++)"FCLEARDEPRPOLICY"==t[i].id&&t.splice(i,1)}}),KDPanelProxy.registerFormMetaPlugins("IOS_CreateSettle",function(e){if(e){var t=e.items||[];if("FWIZARDCOMMAND"==e.id){e.dock=5;for(var i=0;i<t.length;i++)"FWIZARDCAPTION"==t[i].id&&(t[i].padding="0,30,0,0")}}}),KDPanelProxy.registerFormMetaPlugins("AR_STATEMENT",function(e){if(e&&"FSPLITECONTAINER~PANEL2"==e.id)for(var t=e.items||[],i=0;i<t.length;i++)if("FSPLITECONTAINER1"==t[i].id){t[i].splitposition=440;break}}),KDPanelProxy.registerFormMetaPlugins("MC_DeployMonitorView",function(e){if(e){var t=e.items||[];if("F_PAEZ_PANELCENTER"==e.id)for(var i=0;i<t.length;i++)"F_PAEZ_PANEL"==t[i].id&&(t[i].dock=KD.dock.Top),"F_PAEZ_PANEL13"==t[i].id&&(t[i].dock=KD.dock.Fill);if("F_PAEZ_PANEL1"==e.id)for(var i=0;i<t.length;i++)"F_PAEZ_LABEL"==t[i].id&&(t[i].height=26)}}),KDPanelProxy.registerFormMetaPlugins("CN_MUTIBLENDWIZARD",function(e){if(e){var t=e.items||[];if("FPANELFORALL"==e.id)for(var i=0;i<t.length;i++)"FWIZARDGUIDE"==t[i].id&&(t[i].dock=KD.dock.Fill),"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom)}}),KDPanelProxy.registerFormMetaPlugins("CA_CostRollup",function(e){if(e){var t=e.items||[];if("FPANELFORALL"==e.id)for(var i=0;i<t.length;i++)"FWIZARDCOMMAND"==t[i].id&&(t[i].dock=KD.dock.Bottom)}}),KDPanelProxy.registerFormMetaPlugins("BOS_OftenFuncSetting_H5",function(e){if(e){e.items||[];switch(e.id){case"BILLCONTROLS":e.vscroll=2}}}),KDPanelProxy.registerFormMetaPlugins("BAS_NewsPage",function(e){if(e){var t=e.items||[];if("FPANEL3"==e.id)for(var i=0;i<t.length;i++)"FPANELIMG"==t[i].id&&(t[i].vscroll=1,t[i].margin="0")}}),KDPanelProxy.registerFormMetaPlugins("REQ_MultiOrgWriteOff",function(e){if(e){var t=e.items||[];"FWIZARDGUIDE"==e.id&&(e.dock=0),"FPANELFORALL"==e.id&&$.each(t,function(e,t){"FWIZARDCOMMAND"==t.id&&(t.dock=2,$.each(t.items,function(e,t){t.x=t.x-50}))})}}),KDPanelProxy.registerFormMetaPlugins("HS_ReportUserParameter",function(e){if(e){var t=e.items||[];"BILLCONTROLS"==e.id&&$.each(t,function(e,t){"FTAB"==t.id&&(t.dock=5)})}})}(),define("KDDynamicFormProxyBase_RepairMetaData",["KDPanelProxy","KD"],function(e){return function(){var t;return t||e.KDDynamicFormProxyBase_RepairMetaData}}(this)),KDMainDynamicFormProxy=KD.extend(KDDynamicFormProxy,{loadConfig:function(e){$("#mainAppriseRightDiv").hide(),KDMainDynamicFormProxy.superclass.loadConfig.call(this,e),KD.isFunction((ClientAppProxy.Current||{}).setWatermark)&&ClientAppProxy.Current.setWatermark({el:$(document.body)},!0)},setCoverWatermark:function(e){try{for(var t=KD.isArray(e)?e:[e],i=0;i<t.length;i++){var a=t[i];KD.isEmpty(a)||this.setCoverWatermarkGlobalCore(a)}}catch(n){KD.writeLog(n.message,!0)}},setCoverWatermarkGlobalCore:function(e){var t=(ClientAppProxy.Current||{}).setWatermark;KD.isFunction(t)&&t({el:$(document.body),config:e})},afterLoadData:function(){var e={};if(e.isshowyzjtab=!1,this.fireCustomEventsNoData("$$ClientUserPaSetting","$$ClientUserPaSetting",KD.stringify(e)),this._isNeedClearCacheReloadForm()){KD.storage.removeMetaData(this.dformConfig);var t="Cache_CurrentHtmlConsoleMainBillMetaDataIsEmpty";t+=this.dformConfig?this.dformConfig.version:"";var i=KD.storage.getItem(t);KD.isEmpty(i)?(KD.storage.setItem(t,"true"),KD.storage.setItem("CurrentUserLoginIsFromIndexaspx","true"),window.location.href=KD.getEntryPageUrl()):KD.storage.removeItem(t)}},_isNeedClearCacheReloadForm:function(){var e=!1,t=this.getControlFactoryProxy(),i=t.controls,a=0;for(var n in i)if(KD.isRunInForIn(n,i)&&(a+=1,a>1))break;return(0==a||1==a&&"BILLCONTROLS"==n)&&(e=!0),e}}),KDMainDynamicFormProxy.doShowKDTipButton=function(){if("CP"!=KD.getEntryRole().toUpperCase()&&0!=this.isNeedShowTip){var e=KDMainTabControlProxy.getAllFeatureKey(),t=KDMainTabControlProxy.getFavoriteKey(),i=KD.getTipsConfiguration();if(i.showConsoleTips){var a=$("<div class='k-block kd-AllFeatureButtonTips'>"+ResManager.LoadKDString("所有功能菜单在这里，进来瞧瞧吧。","0025710030032398")+"<div class='tip-line'></div><div class='kd-TipsOperators'><a href='#'>"+ResManager.LoadKDString("下一个","0025710030032400")+"</a></div></div>"),n=$("<div class='k-block kd-FavoriteButtonTips'>"+ResManager.LoadKDString("页签小管家，想关就关，想换就换，来试试吧。","0025710030032399")+"<div class='tip-line'></div><div class='kd-TipsOperators'><a href='#'>"+ResManager.LoadKDString("我知道了","0025710030032401")+"</a></div></div>");$("#"+e).append(a),$("#"+t).append(n.hide());var o=KD.getCurrentBrowsType();switch(o.type){case"firefox":$(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":"-55.33%"}),$(".kd-FavoriteButtonTips .tip-line").css({"margin-top":"-47.33%"}),"1033"==ResManager.Language?($(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":"-66.33%"}),$(".kd-FavoriteButtonTips .tip-line").css({"margin-top":"-56.33%"})):"3076"==ResManager.Language&&$(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":"-66.33%"});break;case"ie":"1033"==ResManager.Language?($(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":"-63%"}),$(".kd-FavoriteButtonTips .tip-line").css({"margin-top":"-54%"})):"3076"==ResManager.Language&&$(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":"-63%"});break;case"safari":var r=o.system&&"win"!=o.system?"-110px":"-120%";$(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":r}),$(".kd-FavoriteButtonTips .tip-line").css({"margin-top":r});break;default:"1033"==ResManager.Language?($(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":"-63.9%"}),$(".kd-FavoriteButtonTips .tip-line").css({"margin-top":"-54.7%"})):"3076"==ResManager.Language&&$(".kd-AllFeatureButtonTips .tip-line").css({"margin-top":"-63.3%"})}var s=$(".kd-FavoriteButtonTips .kd-TipsOperators a"),l=$(".kd-AllFeatureButtonTips .kd-TipsOperators a");l.click(function(e){window.event?window.event.cancelBubble=!0:e.stopPropagation(),$(".kd-AllFeatureButtonTips").remove(),n.show(),s.click(function(e){window.event?window.event.cancelBubble=!0:e.stopPropagation(),i.showConsoleTips=!1;var t=KD.parseObject(KD.storage.getItem("TipsConfiguration")||"{}");t[KD.generateUserHashID()]=i,KD.storage.setItem("TipsConfiguration",KD.stringify(t)),$(".kd-FavoriteButtonTips").remove()})}),$(".kd-AllFeatureButtonTips, .kd-FavoriteButtonTips").click(function(e){window.event?window.event.cancelBubble=!0:e.stopPropagation()})}}},KDMainDynamicFormProxy.doCloseKDTipButton=function(){$(".kd-AllFeatureButtonTips").remove(),$(".kd-FavoriteButtonTips").remove()},define("KDMainDynamicFormProxy",["KDDynamicFormProxy","KD"],function(e){return function(){var t;return t||e.KDMainDynamicFormProxy}}(this)),KDFlexDynamicFormProxy=KD.extend(KDDynamicFormProxy,{loadConfig:function(e){var t=this.dformConfig.metadata.billMetaData;if(null!=t){this.initChangeData(),this.baseId=this.dformConfig.flexpageId;var i={id:this.dformConfig.flexpageId,ctOrientation:this.ctOrientation,fromClient:!0,xtype:"kdformforflex",items:[],inlineStyle:this.dformConfig.openstyle?this.dformConfig.openstyle.InlineStyleCss||{}:{}};t.dock?i.dock=t.dock:(i.dock=this.getIsMain()?KD.dock.Fill:0,
t.dock=KD.dock.Fill);var a=!1;if(t.items&&1==t.items.length){var n=t.items[0];KDFlowlayoutProxy.isFlowlayout(n)&&(n.isFormOnlyChild=!0,a=!0)}$.extend(t,{id:"flexForm"+this.rootPanelKey,xtype:"panel",fromClient:!0,isFlowForm:a,isMain:this.getIsMain(),dock:KD.dock.Fill}),i.items.push(t),this.el.attr("data-kdformid",this.getFormId());var o=this.controlFactoryProxy;o.createAllProxyInstance.call(o,i),KDDynamicFormProxyBase.superclass.loadConfig.call(this,i),null!=$this.formLoaded&&$this.formLoaded(this,new Object),KD.isEmpty(this.dformConfig.fluidSettings)&&this.loadLayoutSetting(this.dformConfig.Setting);var r={};if((KDFlowlayoutProxy.vertical==this.ctOrientation||KDFlowlayoutProxy.column==this.ctOrientation)&&$.extend(r,{height:"auto","min-height":i.height}),this.el.css(r),t.isFlowForm){var s=this.el.children(),l={"overflow-y":"auto","overflow-x":"auto"};KDFlowlayoutProxy.column==this.ctOrientation&&$.extend(l,{"overflow-x":"hidden"}),s.css(l)}this.loadFlexDataByValue(this.dformConfig.flexdata)}},initiServer:function(){KDFlexDynamicFormProxy.superclass.initiServer.call(this),this.server.pageId=this.dformConfig.flexpageId},updateControlState:function(e,t){var i=KD.getValue(e,"key",null);if(null==i)return void KD.writeLog("KDFlexDynamicFormProxy:updateControlState key is null,data:",JSON.stringify(e),!0);try{var a=this.controlFactoryProxy.getCmp.call(this.controlFactoryProxy,i),n=a?a.updateState:void 0;if(null==a){if(this.dformConfig&&this.dformConfig.flexpageId){var o=ClientAppProxy.Current.getAliveForm(this.dformConfig.flexpageId);if(null!=o){var r=new Array,s=new Array,l=new Object;s.push(e),l.actionname="updateControlStates",l.params=s,r.push(l),o.doActions(r)}}var d=KD.getValue(e,"fieldstates",[]);if(KD.isArray(d))for(var c=0;c<d.length;c++)this.loadFlexDataByValue.call(this,{value:d[0].value||[]});return}if(!a.rendered)return this.pushLazyMsg("UpdateControlStates",[e]),void(void 0!==e.visible&&KDFieldSetContainerProxy.checkStateBeforeRendered(a,e,this,t));if(void 0===n)return errMsg="From KDFlexDynamicFormProxy Control["+i+"].[updateState] not found!",void KD.writeLog(errMsg,KD.stringify(e),!0);this.doLazyCtrlMsg(a,t),a.updateState(e)}catch(h){KD.writeError(h,KD.stringify(e),!0),this.showErrMsgStr("KDFlexDynamicFormProxy.updateControlState(), state:"+JSON.stringify(e),h.message+"\r\n"+h.description,!0)}},apply:function(e){KDFlexDynamicFormProxy.superclass.apply.call(this,e);var t=this;t.loadMetadata(e.metaData),KD.delayInvoke(function(){t.loadFlexDataByValue.call(t,e.flexdata||{value:[]})})},loadFlexDataByValue:function(e){var t=e,i=KD.getValue(t,"value",null);if(!KD.isEmpty(ar))for(var a=0;a<i.length;a++){var n=i[a],o=n[1];if(!o){var r=this.getControlProxy(o.toUpperCase());if(null!=r){var s={value:n[0],key:n[1],row:n[2],type:n[3],show:n[4]};r.updateState.call(r,s)}}}},loadData:function(){},invokeCloseAction:function(){var e=this.getChangeData(!0);this.server.call("InvokeFlexCloseAction",e)},closeServer:function(){if(null!=this.server){var e=new Object;e.pageId=this.dformConfig.pageId;var t=this.getLayoutSetting();null!=t&&(e.setting=t);var i=this.getNewServer(this.onResponse);try{i.beginBatchRequest.call(i),i.pageId=this.dformConfig.pageId,i.call("CloseForm",!0,e)}catch(a){KD.writeError(a)}finally{e=null,i.endBatchRequest.call(i)}}},loadFlexDataByValue:function(e){if(null!=e){var t=e.value;for(var i in t){var a=t[i],n=a[1];if(n&&n.length>0){var o=this.controlFactoryProxy.getCmp(n.toLowerCase());if(null!=o){var r=new Object;r.value=a[0],r.key=a[1],r.row=a[2],r.type=a[3],r.show=a[4],o.updateState(r)}}}}}}),KDControlFactoryProxy.registerType("kdformforflex",KDFlexDynamicFormProxy),define("KDFlexDynamicFormProxy",["KDDynamicFormProxy","KD"],function(e){return function(){var t;return t||e.KDFlexDynamicFormProxy}}(this)),function(e){function t(t){var i=!1;switch(t.openstyle.ShowType){case KDDynamicFormShowType.Modal:case KDDynamicFormShowType.Default:case KDDynamicFormShowType.NonModal:case KDDynamicFormShowType.FloatingAutoHide:case KDDynamicFormShowType.Floating:i=!1;break;default:var a=e.getValue(t,"isInPopWindow",!1);i=a?!1:t.fluidSettings||ee[t.formid]||e.getQueryString("isfluid","",!0)}return i}function i(t){return e.getValue(t,"xtype","")==H}function a(t){var i=t.billMetaData;i.isFlowForm=!0;var a=i.items;i.items=void 0;var n=e.cloneObject(t);return i.items=a,n}function n(e){return void 0!==e}function o(e){var t=!1,i=e.x||0,a=e.y||0;return(0>i||0>a)&&(t=!0),t}function r(t){var i=!0;return i=o(t)?!1:e.getValue(t,"parentVisible",!0)&&e.getValue(t,"visible",!0)}function s(t){var a=!0;return a=e.getValue(t,"dashboard",i(t))&&e.getValue(t,"title","")&&!e.getValue(t,"isOutOfView",!1)}function l(e,t,i,a){var n=0;a?n=(i||{}).spliter?1:0:void 0===i?0:i.parent==e.parent?0:1;var o=void 0;return 1==n&&(o=d(e,t),$.extend(o,{type:1,text:""})),o}function d(e,t){if(void 0!==e.title){var i={index:t,text:e.title,targetKey:e.id,expand:r(e),locked:!1,enabled:!0,type:0,cls:""};return i}}function c(t){if(e.isArray(t))return[];var i=h(t),a={};for(var o in t)e.isRunInForIn(o,t)&&n(t[o])&&n(Z[o])&&(a[o]=t[o]);return $.extend(a,{xtype:Y.colSeg[t.xtype]?O:H,originParentId:i.oParent,dock:e.dock.FieldSet,visible:r(t),fieldSetIndex:t.fieldSetIndex||u(t)},i),a}function h(e){var t={oId:e.id,oParent:e.parent,oXType:e.xtype,oDock:e.dock,oPageIndex:e.PageIndex};return t}function u(t,i){var a="00000_00000",n=i?i.forceXY:!1;if(n||"kdwatermark"!=t.xtype)if(!n&&e.layout.isDock(t))switch(t.dock){case e.dock.Top:a="00000_00001";break;case e.dock.Left:a="00000_00002";break;case e.dock.Fill:a="zzzzz_zzzzx";break;case e.dock.Right:a="zzzzz_zzzzy";break;case e.dock.Bottom:a="zzzzz_zzzzz"}else if(t.absOrType==W.TabIndex){var o="00000"+(t.tabIndex||0);a=o.substr(o.length-5)}else{var r="00000"+(t.y||0),s="00000"+(t.x||1);a=t.absOrType==W.N_OR?s.substr(s.length-5)+"_"+r.substr(r.length-5):r.substr(r.length-5)+"_"+s.substr(s.length-5)}else a="00000_00000";return a}function p(t,i){var a={id:t.id,xtype:j,dock:e.dock.FieldSet,Stylekey:"kd-Fluid-fieldmap kd-Fluid-"+i.FormTheme+"-fieldmap",height:0,minHeight:0,width:0,visible:!1,fieldSetIndex:u(t),zindex:t.zindex,keys:[]};if(t&&t.items)for(var n=0;n<t.items.length;n++)a.keys.push(t.items[n].id);return a}function g(t,i,a){var n=a||"_FSITEM",o={oXType:t.xtype,oDock:t.dock};e.layout.isFillDock(t)&&!t.brothers&&$.extend(t,{dock:t.parentDock,height:t.height||t.parentHeight,width:t.width||t.parentWidth});var s=0;e.isGalaxyFormTheme(i.FormTheme)&&(s=41);var l=e.layout.isVerDock(t),d=e.layout.isHorDock(t),c=e.layout.isDock(t),h=e.layout.isFillDock(t),p=e.getValue(i,"minHeight",d?Q:void 0),g=e.getValue(i,"height",0)||e.getValue(t,"height",c?Q:X)+s;p=C(t,i)?g:p;var f={id:t.id+n,xtype:V,dock:e.dock.FieldSet,height:l?p:g,minHeight:t.minHeight||g||p,widthFlex:d?J.Strech:-1==i.minWidth?J.Strech:J.Fixed,width:t.width,visible:r(t),fieldSetIndex:u(t),zindex:t.zindex,labelText:t.labelText,items:[t]};return h&&!t.height&&(t.height=t.height||Q),d&&$.extend(t,{minHeight:t.minHeight||g||p}),$.extend(f,o),delete t.visible,f}function f(t,i){var a="_FFSET",n=t.id,o=h(t),s=C(t,i);$.extend(t,{xtype:"panel",dock:e.dock.Fill}),(e.layout.isFillDock(t)&&!t.brothers||"kdtabpage"==o.oXType)&&$.extend(t,{dock:t.parentDock,height:t.parentHeight,width:t.parentWidth});var l=e.layout.isHorDock(t),d=e.layout.isDock(t),c=e.getValue(i,"height",0)||e.getValue(t,"height",d?Q:X),p=g(t,i),f=r(t),m={id:n,originParentId:o.oParent,PageIndex:t.PageIndex,xtype:H,stylekey:z,dock:e.dock.FieldSet,widthFlex:l?J.Strech:-1==i.minWidth?J.Strech:J.Fixed,width:t.width,title:s&&f?t.title:"",visible:f,fieldSetIndex:t.fieldSetIndex||u(t),zindex:t.zindex,isOutOfView:t.isOutOfView,items:[p]};return $.extend(t,{id:n+a,dock:e.dock.FieldSet,widthFlex:J.Strech,height:i.height||c},o),delete p.visible,delete m.height,m}function m(e){var t={FORMID:{mainBlockIndex:0,blockIndex:0,metaSetting:{FEENTRYGRID:{minHeight:500},FPANEL1:{title:"",visible:!1}},bizBlocks:[],bizFields:[]},SEC_BatchDistributeOrgForUser:{metaSetting:{FPANELUSER:{title:"用户",dashboard:{expand:!0,locked:!0,enabled:!1}},FUSERENTITY:{minHeight:600},FPANELORGROLE:{title:"组织与角色",minHeight:600,dashboard:{expand:!0,locked:!1,enabled:!0}}},bizBlocks:["FPANELUSER"],bizFields:["FPANELORGROLE"]},PUR_PurchaseOrder:{metaSetting:{FHEADBASEPAGE:{dashboard:{expand:!0,locked:!0,enabled:!1}},FENTRYLISTPAGE:{dashboard:{expand:!0,locked:!0,enabled:!1}},FHEADTAB_HIDEP:{title:"",dashboard:!1,visible:!1},FENTRYFINANCEPAGE:{dashboard:!1,visible:!1},FENTRYTAB_P:{dashboard:!1,visible:!1},FPOORDERENTRY:{minHeight:600}},bizBlocks:[],bizFields:[]},BD_Currency:{metaSetting:{FTAB_P0:{dashboard:!1,visible:!1},FTAB_P1:{dashboard:!1,visible:!1}},bizBlocks:[],bizFields:[]},SEC_PermissionBatchAllocateRole:{metaSetting:{FPANELALL:{dashboard:!1,visible:!1,title:"",height:50},FPANEL1:{dashboard:!1,title:""},FPANEL:{dashboard:!1,title:"",height:71},FLABLE:{y:40}},bizBlocks:["FPANEL1"],bizFields:["FPANELALL","FPANEL","FPANELGROUP","FPANELITEM"]}};return t[e.formid]}function v(e,t){var i=K(e,t);if(i)return!1;var a=Y.blockSeg[e.xtype],n=t.bizBlockChecks||{},o=e.oId||e.id;if(void 0!==n[o]){var r=a&&n[o]&&void 0===t.fluidType,s=n[o]&&t.fluidType==G.FieldSet;a=r||s}return a}function y(t,i){var a=!1;if(t.items&&!t.isLRConverted)for(var n=0;n<t.items.length;n++)if(t.items[n].dock==e.dock.Left){a=!0;break}return a}function b(t,i){var a=!1;if(t.items&&!t.isLRConverted)for(var n=0;n<t.items.length;n++)if(t.items[n].dock==e.dock.Right){a=!0;break}return a}function D(e,t){var i="kdsplitcontainer"==e.xtype&&0==e.orientstyle||Y.colSeg[e.xtype];return i}function k(t){var i=!e.isGalaxyFormTheme((t||{}).FormTheme)&&e.equalsIgnoreCase("true",e.format("{0}",e.getConnectConfig().IsFluidFldCtDefAsFixed));return i?e.isEmpty(Y.defFixedBlock)&&($.extend(Y.defFixedBlock,{kdtabpage:!0}),Q=300):e.isEmpty(Y.blockSeg)&&$.extend(Y.blockSeg,{kdtabpage:!0}),i}function C(t,i){var a=k(i);return a&&(a=Y.defFixedBlock[t.xtype],o(t)?a=!1:t.dock!=e.dock.None||0!=t.height&&0!=t.width||(a=!1)),a&&(a=x(t,i,{})),a}function x(t,i,a){var n=!0,r=10,s=t.items||[];if(e.isEmpty(s))n=!I(t,i);else{var l=a.recursionCount||0;if(1==s.length&&s[0].dock==e.dock.Fill&&r>l)i.recuOpt=l+1,n=x(s[0],i,a);else for(var d=0;d<s.length;d++){var c=s[d];if(!I(c,i)&&t.dock!=e.dock.None&&!o(c)){n=!1;break}}}return n}function w(e,t){var i=C(e,t),a=(t?t.bizBlockChecks:void 0)||{},n=e.oId||e.id;if(void 0!==a[n]){var o=i&&a[n]&&void 0===t.fluidType,r=a[n]&&t.fluidType==G.FixedFieldSet;i=o||r}return i}function K(e,t){var i=C(e,t),a=(t?t.bizBlockChecks:void 0)||{},n=e.oId||e.id;if(void 0!==a[n]){var o=i&&a[n]&&void 0===t.fluidType,r=a[n]&&t.fluidType==G.FixedFieldSet;i=o&&!r}return i}function S(t,i,a){var n=(i?i.dashboardChecks:void 0)||{},o=t.oId||t.id;return ret=e.isEmpty(n)?a:n[o],ret}function I(e,t){var i=1!=Y.noFieldSeg[e.xtype],a=(t?t.bizFieldChecks:void 0)||{},n=e.oId||e.id;return i=a[n]||i}function P(e,t){return Y.watermark[e.xtype]}function F(e,t){return Y.menuSeg[e.xtype]}function T(t,i){var a=t.item&&"kditemcontainer"==t.xtype&&Y.noLabel[t.item.xtype];return!a&&e.isGalaxyFormTheme(t.FormTheme)&&KDControlProxy.isBoxCtrl(t)&&(a=!0),a}function _(e,t){var i=e.oId||e.id,a=(t?t.metaSetting[i]:void 0)||{};return a.bizBlockChecks=t.bizBlockChecks,a.bizFieldChecks=t.bizFieldChecks,a.dashboardChecks=t.dashboardChecks,a.FormTheme=t.FormTheme,a}function A(e,t){"kditemcontainer"==e.xtype&&(void 0===t.editorLblWidth?t.editorLblWidth=e.labelWidth:t.editorLblWidth!=e.labelWidth&&(t.editorLblWidth<e.labelWidth&&(t.editorLblWidth=e.labelWidth),t.lblWidthVariance=!0))}function L(t,i,a){var n=t.items||[],s=_({id:U},a),l=_(t,a)||{},d=e.getValue(a,"useSeq",!1),i=i||{items:[]};i.items=i.items||[],a.calcBlocks=a.calcBlocks||[];for(var h=a.wMark||{id:"__FWATERMARK_OVERCONTAINER",xtype:"overcontainer",x:0,y:0,height:0,width:0,items:[]},m=i.items,k=i,C=k.items,x=[],E=[],B=0;B<n.length;B++){var R=!1,N=k,V=n[B],j=_(V,a),z=(V.xtype,d&&e.getValue(j,"dashboard",!1));if(A(V,l),$.extend(V,{absOrType:l.absOrType,parentDock:t.dock,brothers:n.length-1,parentHeight:t.height,parentWidth:t.width}),P(V,j))h.items.push(V),h.fieldSetIndex=u(V),V=h;else if(F(V,j)){a.mainBlockIndex++;var q=p(V,j);$.extend(V,j),C.push(q)}else if(D(V,j)){a.blockIndex++,r(t)||(V.parentVisible=!1);var W=u({dock:z?e.dock.None:V.dock,y:z?j.seq:a.mainBlockIndex,x:z?0:a.blockIndex});$.extend(V,{isOutOfView:o(t)||o(V),fieldSetIndex:W,parent:V.parent||t.id}),N=c(V),N.xtype=O,$.extend(N,j),m.push(N);for(var J=0;J<V.items.length;J++){var Q=V.items[J];if(!a.metaSetting[Q.id]){a.bizBlockChecks[Q.id]=!0;var X={y:J+1,title:"",dashboard:!1,fluidType:G.FieldSet};0==J?a.metaSetting[Q.id]=$.extend(X,{width:V.splitposition,minWidth:V.splitposition,dock:e.dock.FieldSet}):a.metaSetting[Q.id]=$.extend(X,{dock:e.dock.Right})}}}else if(!w(V,j)&&y(V,j))N=M(t,a,V,j,N,m,e.dock.Left);else if(!w(V,j)&&b(V,j))N=M(t,a,V,j,N,m,e.dock.Right);else if(v(V,j)){a.blockIndex++,r(t)||(V.parentVisible=!1);var W=u({dock:z?e.dock.None:V.dock,y:z?j.seq:a.mainBlockIndex,x:z?0:a.blockIndex});$.extend(V,{isOutOfView:o(t)||o(V),fieldSetIndex:W,parent:V.parent||t.id}),N=c(V),$.extend(N,j),m.push(N),S(V,j,!0)&&!e.isEmpty(N)&&a.calcBlocks.push(N)}else if(w(V,j)){R=K(V,j),a.blockIndex++,$.extend(V,j),r(t)||(V.parentVisible=!1);var W=u({dock:z?e.dock.None:V.dock,y:z?j.seq:a.mainBlockIndex,x:z?0:a.blockIndex});$.extend(V,{isOutOfView:o(t)||o(V),fieldSetIndex:W,parent:V.parent||t.id});var q=f(V,j);$.extend(q,j,{xtype:H}),delete q.height,delete q.minHeight,m.push(q),S(V,j,!0)&&!e.isEmpty(q)&&a.calcBlocks.push(q)}else if(I(V,j)){$.extend(V,j),t.isMetaDataRoot&&s&&s.absOrType&&(V.absOrType=s.absOrType);var q=g(V,j);$.extend(q,j),V.dock=e.dock.FieldSet,C.push(q),E.push(q)}e.isEmpty(V.items)||R||I(V,j)||w(V,j)||x.push({t:N,o:V})}if(l.lblWidthVariance&&l.editorLblWidth)for(var B=0;B<E.length;B++){var Y=E[B],V=Y.items[0];if(T(V,j))V.labelWidth=0;else{var Z=l.editorLblWidth-V.labelWidth;Y.labelWidth=V.labelWidth=l.editorLblWidth,Y.width=V.width=V.width+(e.isNaN(Z)?0:Z)}}for(var B in x)if(e.isRunInForIn(B,x)){var V=x[B];if(!e.isEmpty(V.o.items)){var ee=L(V.o,V.t,a);ee.id!=N.id&&(N=ee)}}return e.isEmpty(C)||(i.items=C,h&&e.isEmpty(a.wMark)&&!e.isEmpty(h.items)&&(a.wMark=h,i.items.push(h))),i}function M(t,i,a,n,s,l,d){i.blockIndex++,r(t)||(a.parentVisible=!1);var h=e.getValue(i,"useSeq",!1)&&e.getValue(n,"dashboard",!1);$.extend(a,{isOutOfView:o(t)||o(a),fieldSetIndex:u({dock:h?e.dock.None:a.dock,y:h?n.seq:i.mainBlockIndex,x:h?0:i.blockIndex}),parent:a.parent||t.id}),l&&(s=c(a),$.extend(s,n),l.push(s));var p=d==e.dock.Left?1:d==e.dock.Right?2:0,g=a.id+"~P1",f={id:g,xtype:"panel",items:[],dock:e.dock.FieldSet,isLRConverted:!0},m=a.id+"~P2",v={id:m,xtype:"panel",items:[],dock:e.dock.Fill,isLRConverted:!0},y=a.items,b={id:a.id+"~SPLITCT",xtype:"kdsplitcontainer",orientstyle:0,leftOrRight:p,splitposition:(p?f.width:v.width)||150,items:[f,v]};a.items=[b],i.bizBlockChecks[g]=!0,i.bizBlockChecks[m]=!0;for(var D=0;D<y.length;D++){var k=y[D];k.dock==d?(b.splitposition=k.width+4,f.width=k.width,f.items.push(k)):v.items.push(k)}return S(a,n,!0)&&i&&(i.calcBlocks||(i.calcBlocks=[]),!e.isEmpty(s)&&i.calcBlocks.push(s)),s}function E(t,i){var a=$.extend({},i||m(t)||{mainBlockIndex:0,blockIndex:0});if(a.FormTheme=t.FormTheme,void 0===a.metaSetting&&(a.metaSetting={}),void 0===a.bizBlocks)a.bizBlocks=[];else{a.bizBlockChecks={},a.dashboardChecks={};for(var n in a.bizBlocks)if(e.isRunInForIn(n,a.bizBlocks)){var o=a.bizBlocks[n],r=a.metaSetting[o];a.bizBlockChecks[o]=!0,r&&r.dashboard&&(a.dashboardChecks[o]=!0)}}if(void 0===a.bizFields)a.bizFields=[];else{a.bizFieldChecks={};for(var n in a.bizFields)e.isRunInForIn(n,a.bizFields)&&(a.bizFieldChecks[a.bizFields[n]]=!0)}return delete a.bizBlocks,delete a.bizFields,t.convertedFluidSettings=a,a}function B(t){var i=!1,a=t?t.calcBlocks||[]:[];a=R(a);for(var n=0;n<a.length;n++){var o=a[n]||{};if(void 0!==o.seq){i=!0;break}}if(!i)for(var n=0;n<a.length;n++){var o=a[n]||{};o&&(o.seq=o.fieldSetIndex||e.format("{0}",n))}}function R(e){var t=e||[],i=t.indexOf(null);return i>-1&&(t.splice(i,1),R(t)),t}function N(t,i){var a=void 0,n=(i||{}).calcBlocks||(t||{}).items;return a=i&&i.useSeq&&n&&n.length>1?e.quickSort(n,"seq"):n}var H="kdfieldset",O="kdfieldsetcol",V="kdfieldsetitem",j="kdfieldmap",z="kd-fluid-fixedfieldset",U="FBILLHEAD",q="BILLCONTROL_FLUID_ROOT",G={Def:0,FieldSet:1,Field:2,FixedFieldSet:3},W={Def:0,Z_OR:1,N_OR:2,TabIndex:3},J={Strech:1,Fixed:0},Q=400,X=21,Y={watermark:{kdwatermark:!0},menuSeg:{tabpanel:!0},blockSeg:{kdtabpage:!0},defFixedBlock:{},colSeg:{kdsplitcontainer:!1},noFieldSeg:{kdwatermark:!0,kdsplitcontainer:!0,kdtabpage:!0,tabpanel:!0,kdtabpage:!0,panel:!0,mainpanel:!0,kdform:!0},noLabel:{kdpicfield:!0}},Z={id:!0,zindex:!0,dock:!0,style:!0,hscroll:!0,vscroll:!0,x:!0,y:!0,lineWrap:!0,layout:!0,title:!0,border:!0,backgroundimage:!0,ImageShowStyle:!0,panelVisibility:!0,tabIndex:!0,visible:!0,zindex:!0,parent:!0,isOutOfView:!0},ee={};KDFormMetaFluidConverter=function(i,n,o,r){var c=o,h=E(i,r||i.fluidSettings),u="--KDtime-- KDFormMetaFluidConverter";if($.extend(h,{mainBlockIndex:0,blockIndex:0}),!n.isFlowForm&&e.isEmpty(o.dashBoardMetaData)&&t(i)){console&&console.time(u),n.isFlowForm=!0,n.isFluid=!0,i.isFluid=!0,c=a(o);var p=o.billMetaData;p.isMetaDataRoot=!0,p.id=q;var g={id:q,title:"",hscroll:0,vscroll:0,stylekey:"kd-Fluid-Root"+(i.FormTheme?e.format(" kd-Fluid-{0}-Root",i.FormTheme):""),zindex:0,dock:e.dock.FieldSet,xtype:H};if(k(h)){var f=q+"_FFSET",m={id:f,xtype:"kdtabpage",dock:5,zindex:0,tabIndex:0,items:p.items};w(m,h)&&(p.items=[m],h.metaSetting=h.metaSetting||{},h.metaSetting[f]={fluidType:G.FieldSet,dock:e.dock.FieldSet})}y(p)?M(p,h,p,null,null,null,e.dock.Left):b(p)&&M(p,h,p,null,null,null,e.dock.Right);var g=L(p,g,h);B(h);var v=N(g,h);if(e.isEmpty(g.items)||(c.billMetaData.items=[g]),!e.isEmpty(v)){for(var D=[],C=void 0,x=0,K=0;K<v.length;K++){var S=v[K];if(s(S)){S.parentIsFluidRoot=!0;var I=l(S,x,C,h.specSpliter);I&&(x++,D.push(I));var P=d(S,x);e.isObject(S.dashboard)&&$.extend(P,S.dashboard),P&&D.push(P),x++,C=S}}c.dashBoardMetaData={items:D}}console&&console.timeEnd(u),KDFloatingManager.instance.registerPage(i.pageId)}return c},KDFormMetaFluidConverter.isFluidRoot=function(e){return e==q},KDFormMetaFluidConverter.getFluidOptions=function(e){var t=e.convertedFluidSettings||E(e,e.fluidSettings);return t}}(KD),define("KDFormMetaFluidConverter",["KD"],function(e){return function(){var t;return t||e.KDFormMetaFluidConverter}}(this)),function(e){e.registerCssClass(".kd-fluid-ct{display:flex;flex-flow:row wrap;padding:1px 0px 1px 0px;display:-webkit-flex; /* Safari */ overflow:hidden;}.kd-fluid-fi-fixed{flex:0;margin:3px 0px 3px 0px;}.kd-fluid-fi-fixed-holder{flex:0;margin:0px 0px 0px 0px;}.kd-fluid-fi-strech{flex:1;margin:3px 0px 3px 0px;position:relative;}.kd-fluid-col-ct{display:flex;flex-flow:row nowrap;padding:1px 0px 8px 0px;display:-webkit-flex; /* Safari */ overflow:hidden;}.kd-fluid-col-ct .kd-fluid-col-first{display:inline-block;}.kd-fluid-col-ct .kd-fluid-col-second{display:inline-block;}.kd-fluid-fi-title-icon{display:inline-block;height:0.3em;width:0.3em;line-height:1.5em;margin:0.75em 0.6em 0.55em 0.3em;background-color:#3787E1;border:0px solid transparent;border-radius:0.3em;}.kd-fluid-ct-title-text{display:inline-block;line-height:1.5em;vertical-align:top;}.kd-fluid-ct-title-extbtn{border:none;float:left;margin-top:1px;cursor:pointer;}.kd-fluid-ct-title-extbtn-90deg{transform: rotate(-90deg);margin-top:7px}.kd-fluid-ct-title{width:100%;text-align:left;vertical-align:middle;line-height:3em;font-weight:400;font-size:16px;color:#276FF5;padding:0.1em 0em 0.1em 0.1em;}.k-arrow-normal{background-position: -157px -205px !important;margin-right: 10px;}.kd-fluid-box{display:inline-block;cursor:pointer;}"),KDFieldSetContainerProxy=e.extend(KDContainerProxy,{getColNum:function(){var t=e.layout.getFluidColumnCount();return t},isOutOfView:function(){var e=this.config.isOutOfView,t=this.config;if(e)return e;var i=t.x||0,a=t.y||0;return(0>i||0>a)&&(e=!0),e},loadConfig:function(t,i){if(this.config=t,e.getValue(t,"visible",!0)||e.getValue(this,"visible",!1)){if(this.isFluidRoot(t.parent)){var a=t.items;if(null!=a&&e.isArray(a))for(var n=0;n<a.length;n++){var o=a[n],r={parentTabKey:t.originParentId,id:t.id,title:t.title};e.layout.setParentTabControlInfo(o,r)}}KDFieldSetContainerProxy.superclass.loadConfig.call(this,t)}},isFluidRoot:function(e){return"BILLCONTROL_FLUID_ROOT"==e?!0:!1},doLazyAction:function(){var e=this;KDFieldSetContainerProxy.superclass.doLazyAction.call(this);var t=e.getFormProxy.call(e);t&&t.doLazyMsg.call(t),e.doLayout.call(e)},createControl:function(t){var i=this;i.rendered=!1,i.adjustTheDockMeta(t),i.el=KDContainerProxy.superclass.createControl.call(i,t);var a=e.getValue(t,"title"," ");if(" "!=a&&(i.el.append('<div class="kd-fluid-ct-title"><div class="kd-fluid-box"><span class="kd-fluid-ct-title-text">'+a+'</span><span class="k-icon k-arrow-normal k-i-arrow-s kd-fluid-ct-title-extbtn"></span></div></div>'),i.el.find(".kd-fluid-box").bind("click",function(e){i.onExtBtnClick.call(i,e)})),i.el.addClass("kd-fluid-ct"),"kdfieldset"==i.xtype){var n=this.getFormProxy();n&&n.isFlowForm.call(n,n.config)&&(n.el.addClass("kd-form-ui-fluid"),i.el.addClass("kd-fluid-ct-defulat"),e.isIeBrowser()&&i.el.addClass("kd-fluid-ct-defulat-iebrowser"))}return t.parentIsFluidRoot&&i.el.addClass("kd-flow-bizblock"),e.getValue(t,"visible",!0)||i.el.hide(),i.el},release:function(){var e=this;e.el&&e.el.undelegate(".kd-fluid-box","click"),KDFieldSetContainerProxy.superclass.release.call(e)},createInnerControl:function(t){var i=this,a=KDFieldSetContainerProxy.superclass.createInnerControl.call(this,t);i.config.inFieldSetCols&&(a.visibleCallback=function(t){var a=e.getValue(i,"visible",!0),n=e.getValue(t,"visible",!0);if(!(a==n||i.config.items.length>1)){i.setVisible.call(i,n,!0);var o=i.getFormProxy.call(i),r=o.getControlProxy.call(o,i.config.parent);r&&r.doLayout.call(r)}})},initComponent:function(){var e=this;if(e.loaded&&!e.isDontLazy()){var t=(e.getConfig(),KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(e.getConfig()));this.InlineStyle=$.extend(e.InlineStyle||{},t),this.initCellComponent()}},initCellComponent:function(t){var i=this;if(i.loaded&&!i.isDontLazy()){var a=(this.isKendo(),this.getConfig()),n=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(a);this.InlineStyle=$.extend(this.InlineStyle||{},n),this.setInlineStyle(),this.el.addClass(this.getStyleKey()),this.rendered=!0,this.setStylekey(e.getValue(this.config,"Stylekey",""))}},setVisible:function(t,i){var a=this,n=a.config.oId,o=a.getKey(),r=void 0!=a.config.inFieldSetCols,s=a.children,l=this.getFormProxy(),d=a.config.bizBlockChecks||{};if(!i&&d[n||o])return void(l&&l.expandBizPanel.call(l,[o.toLocaleUpperCase(),t]));if(!this.isOutOfView()||1!=t){r&&s&&1==s.length&&(t=s[0].visible);var c=void 0===a.visible?a.config.visible:a.visible,c=void 0===c?!0:c;if(c!=t){a.visible=t,1!=a.visible||a.isDontLazy()||(a.loadConfig(a.config),a.initComponent()),t?a.el.show(function(){a.onAfterVisible.call(a,{visible:!0,oldVisible:c})}):e.isIeBrowser()?(a.onAfterVisible.call(a,{visible:!1,oldVisible:c}),a.el.hide()):a.el.hide(function(){a.onAfterVisible.call(a,{visible:!1,oldVisible:c})});var h=a.getFormProxy();if(h&&h.expandBizPanel.call(h,[o,t,!0]),h&&i&&"kdtabpage"==a.config.oXType&&n){var u={key:n,isChildForm:!1},p=t?"activated":"deactivated";h[p].call(h,u);var g=a.config.oPageIndex,f=a.config.oParent;t&&f&&void 0!==g&&h.fireEvent.call(h,"TabItemSelectedChange",f,g,n,-1)}}}},onAfterVisible:function(t){KDFieldSetContainerProxy.superclass.onAfterVisible.call(this,t);var i=this.getFormProxy(),a=i.getControlProxy(i.floatTipMsgId)||i.getControlProxy(i.floatErrMsgId);a&&e.isFunction(a.onActivated)&&a.onActivated.call(a)},adjustTheDockMeta:function(t){if(e.isArray(t.items)){this.getKey();t.items=e.quickSort(t.items,"fieldSetIndex")}var i=this.getFormId(),a=KDPanelProxy.getFormMetaPlugins(i);a&&a(t)},doLayout:function(){var t=this,i={},a=t.config;if(KDFormMetaFluidConverter.isFluidRoot(a.id))return void KDFieldSetContainerProxy.superclass.doLayout.call(t);var n=e.layout.getInnerSize(t.el.parent()).width;if(a.minHeight&&$.extend(i,{"min-height":a.minHeight}),a.inFieldSetCols||$.extend(i,{"min-width":n,width:n}),t.el.css(i),this.children&&this.children.length)for(var o=0;o<this.children.length;o++){var r=this.children[o];r&&r.doLayout&&r.doLayout.call(r)}var s=t.getColNum();if($(".kd-fluid-fi-fixed-holder",this.el).remove(),a.items&&a.items.length>s)for(var l=Math.floor(e.layout.getInnerSize(this.el).width/s),o=0;s>o;o++){var d=$('<div class="kd-fluid-fi-fixed-holder"><div>');d.css({"flex-grow":1,height:1,"min-height":0,"min-width":l,width:l}),t.el.append(d)}},isFlowLayout:function(){return!0},getOrientation:function(){return KDFlowlayoutProxy.vertical},onExtBtnClick:function(t){var i="kd-fluid-ct-title-extbtn-90deg",a="kd-fluid-ct-title",n=$(t.target),o="";n.hasClass("kd-fluid-box")?n=n.children().eq(1):n.hasClass("kd-fluid-ct-title-text")&&(n=n.parent().children().eq(1)),o=n.hasClass(i),o?n.removeClass(i):n.addClass(i);var r=n.closest("."+a).parent().children();r.each(function(e){var t=$(r[e]);t.hasClass(a)||(o?t.show():t.hide())});var s=this.config.minHeight;e.isEmpty(s)||(s=o?s+"px":"auto",this.el.css({"min-height":s}))},addDynamicForm:function(e){KDFieldSetContainerProxy.superclass.addDynamicForm.call(this,e),this.el.addClass("kd-fluid-ct-container")}}),KDControlFactoryProxy.registerType("kdfieldset",KDFieldSetContainerProxy),$.extend(KDFieldSetContainerProxy,{checkStateBeforeRendered:function(t,i,a,n){var o=a.dformConfig;if(t&&i&&o){var r=(o?KDFormMetaFluidConverter.getFluidOptions(o):void 0)||{},s=(n?n.methodName:void 0)||"",l="LoadData"==s&&r.ignoreFirstVis,d=r&&r.bizBlockChecks?r.bizBlockChecks[t.key]:!1;l&&t.isContainer.call(t)||d?delete i.visible:i.visible===!0&&t.config&&"kdfieldset"==t.config.xtype?e.delayInvoke(function(){t&&i&&t.setVisible.call(t,i.visible),delete i.visible}):e.isValidProp(i,"visible")&&"kditemcontainer"==t.xtype&&a.pushLazyMsg.call(a,"UpdateControlStates",[{key:t.key+"_FSITEM",visible:i.visible}])}}}),KDFieldSetContainerProxy_Galaxy=e.extend(KDFieldSetContainerProxy,{createControl:function(e){var t=this;return t.el=KDFieldSetContainerProxy_Galaxy.superclass.createControl.call(t,e),t.el.addClass("kd-fluid-galaxy-ct"),t.el},doLayout:function(){var t=this,i={},a=t.config;if(KDFormMetaFluidConverter.isFluidRoot(a.id))return void KDFieldSetContainerProxy.superclass.doLayout.call(t);var n=e.layout.getInnerSize(t.el.parent()).width;if(a.minHeight&&$.extend(i,{"min-height":a.minHeight+25}),a.inFieldSetCols||$.extend(i,{"min-width":n,width:n}),t.el.css(i),this.children&&this.children.length)for(var o=0;o<this.children.length;o++){var r=this.children[o];r&&r.doLayout&&r.doLayout.call(r)}var s=t.getColNum();if($(".kd-fluid-fi-fixed-holder",this.el).remove(),a.items&&a.items.length>s)for(var l=Math.floor(e.layout.getInnerSize(this.el).width/s),o=0;s>o;o++){var d=$('<div class="kd-fluid-fi-fixed-holder"><div>');d.css({"flex-grow":1,height:1,"min-height":0,"min-width":l,width:l}),t.el.append(d)}}}),KDControlFactoryProxy.registerType("kdfieldset_Galaxy",KDFieldSetContainerProxy_Galaxy)}(KD),define("KDFieldSetContainerProxy",["KDContainerProxy","KDFormMetaFluidConverter","KD"],function(e){return function(){var t;return t||e.KDFieldSetContainerProxy}}(this)),function(e){KDFieldSetColContainerProxy=e.extend(KDFieldSetContainerProxy,{createControl:function(t){var i=this;if(i.rendered=!1,t.items)for(var a=0;a<t.items.length;a++)t.items[a].inFieldSetCols=t.items.length;return i.adjustTheDockMeta(t),i.el=KDContainerProxy.superclass.createControl.call(i,t),i.el.addClass("kd-fluid-col-ct"),e.getValue(t,"visible",!0)||i.el.hide(),i.el},doLayout:function(){var t=this,i={},a=t.config;if(KDFormMetaFluidConverter.isFluidRoot(a.id))return void KDFieldSetContainerProxy.superclass.doLayout.call(t);var n=e.layout.getInnerSize(t.el.parent()).width,o=this.children[0],r=this.children[1];if(o&&r){var s=e.getValue(o,"visible",!0),l=e.getValue(r,"visible",!0),d=o.el,c=r.el;a.minHeight&&$.extend(i,{"min-height":a.minHeight}),a.inFieldSetCols||$.extend(i,{"min-width":n,width:n}),t.el.css(i);var h=s?l?o.config.width:n:0,u=l?n-h:0,p={width:h,flex:"0 "+h+"px"};d.addClass("kd-fluid-fi-fixed kd-fluid-col-first").css(p);var g={width:u};if(c.addClass("kd-fluid-fi-strech kd-fluid-col-second").css(g),this.children&&this.children.length)for(var f=0;f<this.children.length;f++){var m=this.children[f],v=e.getValue(this.children[f],"visible",!0);v&&m&&m.doLayout&&m.doLayout.call(m)}}},getOrientation:function(){return KDFlowlayoutProxy.horizontal},getOrientation:function(){return KDFlowlayoutProxy.vertical}}),KDControlFactoryProxy.registerType("kdfieldsetcol",KDFieldSetColContainerProxy)}(KD),define("KDFieldSetColContainerProxy",["KDFieldSetContainerProxy","KDFormMetaFluidConverter","KD"],function(e){return function(){var t;return t||e.KDFieldSetColContainerProxy}}(this)),function(e){KDFieldSetItemHolderProxy=e.extend(KDControlProxy,{createControl:function(e){var t=this;t.el=KDFieldSetItemHolderProxy.superclass.createControl.call(t,e),t.el.addClass("kd-fluid-fi-fixed-holder")},loadConfig:function(e){KDFieldSetItemHolderProxy.superclass.loadConfig.call(this,e)},doLayout:function(){}}),KDControlFactoryProxy.registerType("kdfieldsetitem_holder",KDFieldSetItemHolderProxy)}(KD),function(e){KDFieldMapProxy=e.extend(KDControlProxy,{createControl:function(e){var t=this,i=t.el=KDFieldMapProxy.superclass.createControl.call(t,e);return i.css({height:0,width:0,display:"none"}),i},loadConfig:function(e){var t=this.config,i=t.keys;this.keyMaps={};for(var a=0;a<i.length;a++){var n=i[a];n&&(this.keyMaps[n]=a)}},doLayout:function(){},setVisible:function(e){},setSelectedIndex:function(e){var t=this.config,i=t.keys[e];i&&this.setSelectedKey(i)},setSelectedKey:function(t,i){var a=this.getFormProxy();i=(e.isEmpty(i)?!0:i)?!0:!1,t=(t||"").toUpperCase(),a&&this.keyMaps[t]&&a.expandBizPanel.call(a,[t,i])},showTabItem:function(t){e.isEmpty(t)||this.setSelectedKey(t,!0)},hideTabItem:function(t){e.isEmpty(t)||this.setSelectedKey(t,!1)}}),KDControlFactoryProxy.registerType("kdfieldmap",KDFieldMapProxy)}(KD),define("KDFieldSetItemHolderProxy",["KDControlProxy","KDFormMetaFluidConverter","KD"],function(e){return function(){var t;return t||e.KDFieldSetItemHolderProxy}}(this)),function(e){isTextAlginCenter=function(e){return!1},isBoxCtrl=function(e){var t="kditemcontainer"==e.xtype&&KDControlProxy.isBoxCtrl(e);return t},isNoStrechChild=function(e){var t="kdbutton"==e.xtype||"label"==e.xtype||"kdicontextbutton"==e.xtype;return t};var t={C_Strech:1,C_Fixed:0};KDFieldSetItemProxy=e.extend(KDContainerProxy,{getColNum:function(){var t=e.layout.getFluidColumnCount();return t},createControl:function(e){var i=this;i.el=KDContainerProxy.superclass.createControl.call(i,e);var a=e.widthFlex==t.C_Strech?"kd-fluid-fi-strech":"kd-fluid-fi-fixed";a+=" kd-fluid-fieldsetitem",i.el.addClass(a)},loadConfig:function(e){KDFieldSetItemProxy.superclass.loadConfig.call(this,e)},createInnerControl:function(t){var i=this,a=t.labelWidth;t.parentTabControlKey=this.config.parentTabControlKey,t.parentTabItemKey=this.config.parentTabItemKey,t.parentTabItemTitle=this.config.parentTabItemTitle;var n=t.items;if(null!==n&&e.isArray(n))for(var o=0;o<n.length;o++){var r=n[o],s={parentTabKey:t.parentTabControlKey,id:t.parentTabItemKey,title:t.parentTabItemTitle};e.layout.setParentTabControlInfo(r,s)}var l=KDFieldSetItemProxy.superclass.createInnerControl.call(this,t);if(isBoxCtrl(t)){var d={"text-align":"left"};a&&(d["margin-left"]=a),l.el.css(d)}else isNoStrechChild(t)&&(i.el.css({"text-align":"center"}),l.el.css({"text-align":"left",display:"inline-block",width:t.width,height:t.height}));l.visibleCallback=function(t){var a=e.getValue(i,"visible",!0),n=e.getValue(t,"visible",!0);a!=n&&i.setVisible.call(i,n)}},initchildren:function(){
var e=void 0;for(var t in this.children)e=this.children[t],e.initComponent.call(e)},notifyChildrenVisible:function(e){},doLayout:function(){var i=this,a={},n=i.config,o=n.inFieldSetCols||i.getColNum(),r=e.layout.getInnerSize(i.el.parent()).width/o,s=r;if(n.widthFlex==t.C_Fixed){var l=0;r<n.width&&(l=parseInt((n.width/r).toString())+1,s=r*l),$.extend(a,{"flex-grow":l})}else n.widthFlex==t.C_Strech&&(s=r*o,$.extend(a,{"flex-grow":o}));if(n.height&&$.extend(a,{height:n.height}),n.minHeight&&$.extend(a,{"min-height":n.minHeight}),n.inFieldSetCols||$.extend(a,{"min-width":s,width:s}),i.el.css(a),this.children&&this.children.length)for(var d=0;d<this.children.length;d++){var c=this.children[d];c&&c.doLayout&&c.doLayout.call(c)}},isFlowLayout:function(){return!0}}),KDControlFactoryProxy.registerType("kdfieldsetitem",KDFieldSetItemProxy)}(KD),define("KDFieldSetItemProxy",["KDContainerProxy","KDFormMetaFluidConverter","KD"],function(e){return function(){var t;return t||e.KDFieldSetItemProxy}}(this)),KDEditorProxy=KD.extend(KDControlProxy,{labelAlign:0,isKeyNaviget:!0,editable:!0,fireUpdate:!1,mustInput:!1,isInit:!1,value:null,oldValue:null,preValue:null,showEditButton:!1,onfilterchange:null,onAttachOptions:null,emptyTip:"",cloudContacts:!1,cloudContactPhone:"",SelectionStart:void 0,isEmpty:function(){return!this.value},loadConfig:function(e){KDEditorProxy.superclass.loadConfig.call(this,e),this.postKey=e.id,this.fireUpdate=e.fireUpdate&&1==e.fireUpdate,this.mustInput=e.mustinput&&1==e.mustinput,this.editable=KD.getValue(e,"editable",!0),this.EmptyTip=KD.getValue(e,"EmptyTip",""),this.cloudContacts=KD.getValue(e,"cloudcontacts",!1),this.cloudContactPhone=KD.getValue(e,"cloudcontactstel",""),this.positionDescription=KD.getValue(e,"PositionDescription",""),this.fireGotFocus=1==KD.getValue(e,"firegotfocus",1)?!0:!1,this.labelAlign=e.labelAlign},release:function(){this.__relesePopMsg(),KDEditorProxy.superclass.release.call(this)},initComponent:function(){var e=this;if(this.initEditButton(this.config),KDEditorProxy.superclass.initComponent.call(this),this.component&&this.component.keyup&&this.component.keydown){var t=this.component.parents(".kdItemContainer_editorct").parent().data("attdata");this.component.attr("tabindex",t&&!KD.isEmpty(t.tabIndex)?t.tabIndex+1:0),this.component.off("keyup").on("keyup",function(t){e.onkeyup.call(e,t)}),this.component.off("keydown").on("keydown",function(t){e.onkeydown.call(e,t)})}KD.isEmpty(this.EmptyTip)||this.setEmptyTip(this.EmptyTip);var i=this._getControlInput();if(i){i=$(i);var a=this.getTextAlign();i.css("text-align",a),i.on("focus",function(t){if(e.fireGotFocus){var i=e.getFormProxy();i&&i.fireControlFocusedEvent&&i.fireControlFocusedEvent.call(i,e)}})}},setDisabled:function(e){KD.isFirefox()&&"textfield"==this.config.xtype?KDEditorProxy.superclass.setReadonly.call(this,e):KDEditorProxy.superclass.setDisabled.call(this,e),this.disabled?this.editerBtn&&this.editerBtn.hide():this.editerBtn&&this.editerBtn.show(),0==this.disabled&&0==this.editable?(this.el&&this.el.find(":input").addClass("k-state-disabled"),this.itemContainer&&this.itemContainer.el.find(".kdItemContainer_editorct").removeClass("kdItemContainer_editorct_noBorder")):this.disabled||!this.editable?(this.el&&this.el.find(":input").addClass("k-state-disabled"),this.itemContainer&&this.itemContainer.el.find(".kdItemContainer_editorct").addClass("kdItemContainer_editorct_noBorder")):(this.el&&this.el.find(":input").removeClass("k-state-disabled"),this.itemContainer&&this.itemContainer.el.find(".kdItemContainer_editorct").removeClass("kdItemContainer_editorct_noBorder"));var t=KD.isGalaxyFormTheme(this.getFormTheme());if(t){var i=t?this.getFormTheme()+"-state-disabled":"k-state-disabled";this.disabled||!this.editable?$(".k-state-disabled",this.el).addClass(i):$("."+i,this.el).removeClass(i),this.el.find(".k-state-disabled").removeClass("k-state-disabled")}},setBackColor:function(e){this.component&&this.component.css("background-color",e)},setForeColor:function(e){this.component&&this.component.css("color",e)},setFocusSelectMode:function(e){},setEditable:function(e){if(this.editable=e,"kdcombo"!=this.config.xtype){var t=this.component&&this.el&&this.el.find("input");if(void 0!=t){0==t.length&&(t=this.el&&this.el.find("textarea")),0==t.length&&"input"==this.component[0].tagName.toLocaleLowerCase()&&(t=this.component),t&&t.length>0&&(0==e?t.attr("readonly",!0).addClass("k-state-disabled"):(t.removeAttr("readonly"),this.disabled||t.removeClass("k-state-disabled")));var i=KD.isGalaxyFormTheme(this.getFormTheme());if(i){var a=this.getFormTheme()+"-state-disabled";t&&t.length>0&&(0==e?$(".k-state-disabled",this.el).addClass(a).removeClass("k-state-disabled"):this.disabled||($("."+a,this.el).removeClass(a),this.el.find(".k-state-disabled").removeClass("k-state-disabled")))}}}},eidtBtnFilterType:["datefield","datetimefield","bosf7field","kdlangtextarea","kdfullsearch","kdlangtextfield","kdmultilingualdynamictext","timefield"],initEditButton:function(e){if(-1==this.eidtBtnFilterType.indexOf(e.xtype)){this.showEditButton=KD.getValue(e,"showEditButton",this.showEditButton);var t=this.config.height;0==t&&0!=this.config.metaHeight&&(t=this.config.metaHeight),void 0==t&&this.itemContainer&&this.itemContainer.config&&(t=this.itemContainer.config.height||this.itemContainer.config.metaHeight);var i=this.config.width;if(0==i&&0!=this.config.metaWidth&&(i=this.config.metaWidth),this.showEditButton&&this.el.css({width:i-17}),0!=this.showEditButton){var a=parseInt(t)>21?t-9:12;this.editerBtn=$("<div class='ui-editor-icon kendo-background-color' style='height:"+a+"px; line-height:"+(a-4)+"px;display:"+(this.showEditButton?"block":"none")+"'>...</div>"),this.el.parent().append(this.editerBtn);var n=this;this.editerBtn.click(function(){n.editor_DefaultButtonClick&&n.editor_DefaultButtonClick()})}}},setShowEditButton:function(e){-1!=this.eidtBtnFilterType.indexOf(this.config.xtype)&&e!=this.showEditButton&&(this.showEditButton=e,this.el&&this.el.find(".ui-editor-icon").length>0&&(this.el.css("width",this.showEditButton?this.config.width-17:this.config.width-6),this.el.find(".ui-editor-icon").css("display",this.showEditButton?"block":"none")))},updateStyle:function(e){if(this.el.css(e),this.component&&this.component.length){var t=this.component[0];t&&$(t).css(e)}},initCellComponent:function(e){var t=this;KDEditorProxy.superclass.initCellComponent.call(this,e),this.columnDescriptor&&this.initColumnDescriptorEditButton(this.config),this.component&&this.component.keyup&&this.component.keydown&&(this.component.off("keyup").on("keyup",function(e){t.onkeyup.call(t,e)}),this.component.off("keydown").on("keydown",function(e){t.onkeydown.call(t,e)}))},initColumnDescriptorEditButton:function(e){var t=!1;if(-1==this.eidtBtnFilterType.indexOf(e.xtype)&&(t=KD.getValue(e,"showEditButton",this.showEditButton)),0!=t){var i=this.el.parent("td"),a=i.height(),n=i.width();KD.isIeBrowser()&&this.el.css({width:n/3,height:a}),this.editerCloumnBtn=$("<input type='button' class='ui-cloumn-editor-icon'  value='...'  style=' padding: "+i.height()/3+"px 0px "+2*i.height()/3+"px 0px;display:"+(t?"inline-block":"none")+"'></input>"),this.el.parent().append(this.editerCloumnBtn),this.el.css({width:n-this.editerCloumnBtn.width()-2+"px",height:a}),KD.isFirefox()&&this.el.css({"float":"left"});var o=this;this.editerCloumnBtn.off("mousedown").on("mousedown",function(e){o.editor_DefaultButtonClick&&o.editor_DefaultButtonClick()})}},createInnerDom:function(){return $("<input>")},getKendoOptions:function(e){var t=this,i=void 0===e?t.config:e,a=KDEditorProxy.superclass.getKendoOptions.call(this);a.zoomIn=i&&i.zoomIn,a.editable=i&&i.editable,a.isFilterEditor=i&&i.isFilterEditor,a.labelAlign=i&&i.labelAlign;var t=this;t.getBaseId(),t.isGridEditor();if(a.change=function(e,i){if(1!=t.isInit){var a=void 0===i?$.isFunction(this.value)&&this.value()||"":i;return $.isFunction(t.getChangingValue)&&(a=t.getChangingValue.call(t,e,i)),t.onfilterchange&&null!=t.onfilterchange?(t.onfilterchange(e,a),void(t._value=a)):void(t.columnDescriptor?t.columnDescriptor.onchange.call(t.columnDescriptor,e,a,t.rowDataModel):t.onchange.call(t,e,a))}},this.onAttachOptions&&null!=this.onAttachOptions){var n=this.onAttachOptions();n&&$.extend(a,n)}return a},getTextAlign:function(){var e=this.config,t=KD.getValue(e,"defaultColAlignType",-1),i=KD.getValue(e,"labelAlign",t);switch(0==i&&(i=t),i){case 1:return"left";case 2:return"right";case 3:return"center";default:return""}},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.component&&(this.config.xtype&&(this.config.xtype.indexOf("kdlang")>=0||"kddynamictextfield"==this.config.xtype)?this.component.parent().css({width:"100%",border:"0px",height:this.elHeight,"line-height":this.innerHeight}):this.component.css({width:"100%",border:"0px",height:this.elHeight,"line-height":this.innerHeight}))},setInlineStyleValue:function(e){var t=this._getControlInput();t&&t.css&&t.css(e)},setHeight:function(e){if(e=parseFloat(e),!KD.isNaN(e)&&(e-=2,this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.find('[role="kdeditorct"]').height(e),this.el.height(e),this.component.height(e),this.isKendo()&&$.isFunction(this.getKendoCType)&&this.getKendoCType())){var t=this.component.data(this.getKendoCType());t&&t.setHeight&&t.setHeight(e)}},getGirdEditorOptions:function(e){({edittype:this.getCType()})},setRow:function(e){this._row=e},getRow:function(){return this._row?this._row:0},setParentRow:function(e){this._parentRow=e},getParentRow:function(){return this._parentRow?this._parentRow:0},setValue:function(e){this.isInit=!0,this._oldValue=this._value,this._value=e,this.asyncValueToUIText(e,!0);var t=this,i=setTimeout(function(){clearTimeout(i),t.isInit=!1},10);KD.isEmpty(e)||this.resetValidateMessage.call(this)},getValue:function(){return this._value},getProperty:function(e){if(!KD.isEmpty(e)&&e.split){for(var t=e.split(","),i={},a=0;a<t.length;a++){var n=t[a];KD.isEmpty(n)||(value=this[n],"undefined"!=typeof value&&(KD.isEmpty(value)?i[n]="Null":i[n]=value))}return KD.stringify(i)}return null},getSelectionStart:function(){return this.SelectionStart},setSelectionStart:function(e,t){if(this.SelectionStart=e,!t){var i=this._getControlInput();i&&(i=$(i),KDGetCursorPositon.setSelectionIndex(i[0],this.SelectionStart))}},onchange:function(e,t){this.isGridEditor()||this.commitValueToForm(t)},onkeyup:function(e){return!0},popListEdit:["kdlangtextfield","bosf7field","kdmultilingualdynamictext","kddynamictextfield"],onkeydown:function(e){if(13==e.keyCode){var t;this.isKendo()&&$.isFunction(this.getKendoCType)&&this.getKendoCType()?"bosf7field"==this.config.xtype?t=e&&e.currentTarget?e.currentTarget.value:void 0:this.popListEdit.indexOf(this.getConfig().xtype)>=0?(t=this.component.data(this.getKendoCType()).val(),t=t.number||t):t=this.component.data(this.getKendoCType()).value():t=this.component.val(),"promptBox"==this.getCType()&&(t=this.getValue().current?this.getValue().current.number:""),t&&t.format&&this.getFormat&&$.isFunction(t.format)&&$.isFunction(this.getFormat)&&(t=t.format(this.getFormat()));var i=this.getFormProxy(),a=new Object;a.value=t,i.fireCustomEvents.call(i,this.postKey,"EnterKeyPressed",KD.stringify(a)),this.moveToNextFocus(e)}return!0},moveToNextFocus:function(e){},commitValueToForm:function(e){if(!this.isInit){var t=this.getCommitData(e);this._value=t.value;var i=this.getFormProxy();this.fireUpdate?i.fireEvent.call(i,"UpdateValue",t.key,t.value,t.row):i.storeData.call(i,t.key,t.value,t.row,t.parentRow)}},getCommitData:function(e){var t={key:this.postKey,value:this.commitUITextToValue(e),row:this.getRow(),parentRow:this.getParentRow()};return this.mustInputToggleTips(e),t},mustInputToggleTips:function(e){this.visible&&!this.disabled&&this.mustInput&&(null==e||void 0==e||0==e.length?this.setValidateMessage(ResManager.LoadKDString("此字段是必填项，不能为空！","099002000000025")):this.resetValidateMessage(""))},commitUITextToValue:function(e){return void 0==e?null:null!=e.current?e.current:e},asyncValueToUIText:function(e){},setMustInput:function(e){this.mustInput=e&&1==e,this.itemContainer&&this.itemContainer.setMustInput&&this.itemContainer.setMustInput(this.mustInput)},setMustinput:function(e){this.setMustInput(e)},setFireUpdate:function(e){this.fireUpdate=e,this.config&&(this.config.fireUpdate=e)},isGridEditor:function(){return!(void 0===this.columnDescriptor)},validating:function(e){return this.checkMustInput(),this.visible&&!this.disabled&&this.mustInput&&this.isEmpty()?(this.setValidateMessage(ResManager.LoadKDString("此字段是必填项，不能为空！","099002000000025")),!1):(this.resetValidateMessage(),!0)},resetValidateMessage:function(){this._validateMessage="",this.itemContainer&&this.itemContainer.setValidateMessage&&this.itemContainer.setValidateMessage.call(this.itemContainer,!1,""),this.__relesePopMsg()},__openPopMsg:function(e){var t=this;t.__relesePopMsg(),t.popMsg=$('<div class="kd-validation-errmsg"><span>'+KD.htmlUtil.encode(e)+"</span></div>"),t.popMsg.kendoPopup({anchor:t.getControl(),origin:"bottom right",position:"top right",collision:"fit",adjustSize:{width:100,height:100},close:function(e){t.isPopMsgClosing||t.__relesePopMsg.call(t)}}).data("kendoPopup").open()},__relesePopMsg:function(){if(this.popMsg){this.isPopMsgClosing=!0;var e=this.popMsg.data("kendoPopup");e&&e.close&&(e.close(),e.destroy()),this.popMsg.remove(),this.popMsg=void 0,this.isPopMsgClosing=!1}},setValidateMessage:function(e){this._validateMessage=e,this.isGridEditor()&&this.__openPopMsg(e),this.itemContainer&&this.itemContainer.setValidateMessage&&this.itemContainer.setValidateMessage.call(this.itemContainer,!0,e)},getValidateMessage:function(){var e=KD.IsNullOrWhiteSpace(this.positionDescription)?"":this.positionDescription+".",t=KD.isEmpty(this.columnDescriptor)?this.config.labelText:this.columnDescriptor.headerText;return this.validateMessage="["+e+t+"] ",this.validateMessage},checkMustInput:function(){},isEmpty:function(){var e=this.getValue();e=this.getCommitData(e).value;var t=this.isEmptyValue(e);return t&&this.isDataMasking&&this.mustInput&&(t=this.isEmptyMkValue()),t},isEmptyValue:function(e){if(null==e||void 0==e||""==e||e.trim&&""==e.trim())return!0;if("object"==typeof e){if(0==e.length)return!0;for(var t in e)if("object"==typeof e[t]){if(!this.isEmptyValue(e[t]))return!1}else if(null!=e[t]&&""!=e[t])return!1;return!0}return!1},setEmptyTip:function(e){var t=this._getControlInput();t&&t.attr&&t.attr("placeholder",e)},_getControlInput:function(){var e=void 0;return this.component&&this.component.find&&(e=this.component.find(":input"),e.length<1&&this.el&&this.el.find&&(e=this.el.find(":input"))),e}}),function(){$.extend(KDEditorProxy.prototype,{isDataMasking:void 0,dataMaskingControlLists:["textfield","kdtextarea","kdlangtextarea","kdlangtextfield","numberfield","datefield","datetimefield"],dataMaskingExtendId:"DataMasking",setIsDataMasking:function(e){var t=this;if(t.isDataMasking=e,t.dataMaskingControlLists.indexOf(t.config.xtype)>=0&&t.itemContainer&&t.itemContainer.el){var i=t.getFormProxy();if(i&&i.setIncludeMKStatusControl&&i.setIncludeMKStatusControl.call(i,!0),t.isDataMasking){t.dataMaskingShowElement&&t.dataMaskingShowElement.remove&&(t.dataMaskingShowElement.remove(),delete t.dataMaskingShowElement),t.dataMaskingBtnElement&&t.dataMaskingBtnElement.remove&&(t.dataMaskingBtnElement.remove(),delete t.dataMaskingBtnElement);var a=$(t.input||t._getControlInput()),n=a.parent(),o=t.getBaseId()+"-"+t.dataMaskingExtendId,r=t.itemContainer&&t.itemContainer.el.find(".kdItemContainer_editorct")||t.el,s=$(r).width();t.dataMaskingShowElement=a.clone(),n.append(t.dataMaskingShowElement),t.dataMaskingShowElement.attr({id:o,readonly:!0}).css({color:"",opacity:1,width:s}).addClass("kd-element-desensitize"),t.setDataMaskingValue(t.dataMaskingData);var l=KD.getImageUrlByNameAndVersion("kd_icon_extend.png");t.dataMaskingBtnElement=$(kendo.format('<div class="kd-btn-desensitize-container" tabIndex="-1" title="{1}"><span class="kd-icon-btn-desensitize" style="background-image:url({0});"></span></div>',l,KD.getDataMaskTextTips())),n.append(t.dataMaskingBtnElement),t._setDataMaskingBtnPosition(t.dataMaskingBtnElement,r,!0),KD.isMobileOS()?(t.dataMaskingShowElement.focus(function(){t._getDataMaskingBtnVisible()&&t.dataMaskingBtnElement.show()}),t.dataMaskingShowElement.blur(function(){KD.delayInvoke(function(e){t.dataMaskingBtnElement.hasClass("kd-state-focus")?t.dataMaskingShowElement.focus():t.dataMaskingBtnElement.hide()})}),t.dataMaskingBtnElement.focus(function(){t.dataMaskingBtnElement.addClass("kd-state-focus")}),t.dataMaskingBtnElement.blur(function(){t.dataMaskingBtnElement.removeClass("kd-state-focus")})):t.itemContainer.el.hover(function(){t._getDataMaskingBtnVisible()&&t.dataMaskingBtnElement.show()},function(){t.dataMaskingBtnElement.hide()}),t.dataMaskingBtnElement.click(function(e){t._dataMaskingBtnClick.call(t,e)})}else t.setDataMaskingModel(KD.CONST.DataMaskModel.Closed)}},setIsMk:function(e){this.setIsDataMasking(e)},_getDataMaskingBtnVisible:function(){var e=!1;return this.isDataMasking&&this.dataMaskingModel!=KD.CONST.DataMaskModel.Closed&&this.dataMaskingModel!=KD.CONST.DataMaskModel.Locked&&(e=!0),e},_dataMaskingBtnClick:function(e){var t=this,i=t.getFormProxy(),a={};a.entrykey="",a.fieldkey=t.postKey,a.row="0",i&&i.fireEvent.call(i,KD.CONST.CustomEventName.ShowCVPFieldData,t.postKey,0)},_setDataMaskingBtnPosition:function(e,t,i){if(e=$(e),t=$(t),i){var a=t.width()-e.width();a=a>0?a:0,e.css({left:a})}},isEmptyMkValue:function(){var e=!0;return this.isDataMasking&&this.dataMaskingModel!=KD.CONST.DataMaskModel.Closed&&(e=KD.isEmpty(this.dataMaskingValue)),e},setDataMaskingValue:function(e){this.dataMaskingValue=KD.isEmpty(e)?"":e,this.dataMaskingShowElement&&this.dataMaskingShowElement.val(this.dataMaskingValue)},setMkVal:function(e){this.setDataMaskingValue(e)},setDataMaskingModel:function(e){this.dataMaskingModel=e,e==KD.CONST.DataMaskModel.Closed?(this.dataMaskingShowElement&&this.dataMaskingShowElement.hide(),this.dataMaskingBtnElement&&this.dataMaskingBtnElement.hide()):(e==KD.CONST.DataMaskModel.Normal||e==KD.CONST.DataMaskModel.Locked)&&this.dataMaskingShowElement&&this.dataMaskingShowElement.show()},setMkModel:function(e){this.setDataMaskingModel(e)}})}(),define("KDEditorProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDEditorProxy}}(this)),KDTextEditorProxy=KD.extend(KDEditorProxy,{}),define("KDTextEditorProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDTextEditorProxy}}(this)),function(e){KDInfoFlowPanelProxy=e.extend(KDFlowlayoutProxy,{beforeCreateContent:function(e){KDInfoFlowPanelProxy.__debugData(e),e.showtitle&&e.title&&(e.titleclass?this.el.append('<div class="kd-infopanel-title"><span class="kd-infopanel-title-icon"></span><span class="kd-infopanel-title-text '+e.titleclass+'"></span></div>'):this.el.append('<div class="kd-infopanel-title"><span class="kd-infopanel-title-icon"></span><span class="kd-infopanel-title-text"></span></div>'),this.el.find(".kd-infopanel-title .kd-infopanel-title-text").text(e.title)),e.hoverable&&this.el.addClass("kd-infopanel-hoverable")},afterCreateContent:function(e){},loadConfig:function(t){var i=this;if(t.isNeedPackEvent&&(i.innerEventList={},i._loadConfigComlete=!1),KDInfoFlowPanelProxy.superclass.loadConfig.call(i,t),t.isNeedPackEvent){i._loadConfigComlete=!0;var a=this.getFormProxy();for(var n in this.innerEventList){var o=this.innerEventList[n];for(var r in o){var s=o[r];a.fireCustomEventsNoData.call(a,s.cKey,s.functionName,e.stringify(s.parameter))}}i.innerEventList={}}t.bussinesssplitlineclass&&this.el.append('<div class="'+t.bussinesssplitlineclass+'"></div>')},registerEvent:function(e,t,i){var a=this.innerEventList[e];a||(a={},a[t]={cKey:e,functionName:t,parameter:[i]}),this.innerEventList[e]?this.innerEventList[e][t]?this.innerEventList[e][t].parameter.push(i):this.innerEventList[e][t]=a[t]:this.innerEventList[e]=a},createControl:function(e){KDInfoFlowPanelProxy.superclass.createControl.call(this,e),this.el.addClass("kd-infoflow-panel"),e.styleKey&&this.el.addClass(e.styleKey),0==e.isallowedit&&this.el.attr("isallowedit","false"),0==e.isshowedit&&this.el.attr("isshowedit","false")},release:function(){this.releaseCardDesginer(),KDInfoFlowPanelProxy.superclass.release.call(this)},releaseCardDesginer:function(){KDCardLayoutDesignerProxy.release.call(KDCardLayoutDesignerProxy)},setCardLayoutEditMode:function(t){var i=this.checkPage(t);if(!(i&&i.el.find(".kd-cardEditBtnList").length>0)){if($(".kd-H5CardButtomBtnList").length>0)return void e.Error.raise({msg:ResManager.LoadKDString("主页或者其他工作台处于编辑状态，请关闭编辑后再对当前工作台或者主页进行编辑。","0025710000008454")});KDCardLayoutDesignerProxy.setTarget(this),KDCardLayoutDesignerProxy.design()}},addCommFuncCards:function(e){KDCardLayoutDesignerProxy.addCommFuncCards&&KDCardLayoutDesignerProxy.addCommFuncCards.call(KDCardLayoutDesignerProxy,e,this)},setStdCardLayoutEditMode:function(t){var i=this.checkPage(t);if(!(i&&i.el.find(".kd-cardEditBtnList").length>0)){if($(".kd-H5CardButtomBtnList").length>0)return void e.Error.raise({msg:ResManager.LoadKDString("主页或者其他工作台处于编辑状态，请关闭编辑后再对当前工作台或者主页进行编辑。","0025710000008454")});var a=e.isEmpty(t.isnewstdconsole)?!0:e.equalsIgnoreCase(t.isnewstdconsole.toString(),"true")?!1:!0;KDCardLayoutDesignerProxy.setStdTarget(this,a),KDCardLayoutDesignerProxy.stdDesign(a)}},setSmartCardLayoutEditMode:function(t){var i=this.checkPage(t);if(!(i&&i.el.find(".kd-cardEditBtnList").length>0)){if($(".kd-H5CardButtomBtnList").length>0)return void e.Error.raise({msg:ResManager.LoadKDString("主页或者其他工作台处于编辑状态，请关闭编辑后再对当前工作台或者主页进行编辑。","0025710000008454")});var a=e.isEmpty(t.iseditmode)?null:t.iseditmode;KDCardLayoutDesignerProxy.setSmartCardTarget(this,a),KDCardLayoutDesignerProxy.design(!0)}},setSmartCardLayoutEditButtonBarVisible:function(e){KDCardLayoutDesignerProxy&&(e?KDCardLayoutDesignerProxy.showSmartCardBottom.call(KDCardLayoutDesignerProxy):KDCardLayoutDesignerProxy.outOfCardDesign.call(KDCardLayoutDesignerProxy))},setMonitorConsoleEditMode:function(t){var i=this.checkPage(t);if(!(i&&i.el.find(".kd-cardEditBtnList").length>0)){if($(".kd-H5CardButtomBtnList").length>0)return void e.Error.raise({msg:ResManager.LoadKDString("主页或者其他工作台处于编辑状态，请关闭编辑后再对当前工作台或者主页进行编辑。","0025710000008454")});KDCardLayoutDesignerProxy.setMonitorConsoleTarget(this),KDCardLayoutDesignerProxy.monitorDesign(!0)}},checkPage:function(e){var t;return e&&(t=e.pageid+"-"+e.key),KDCardLayoutDesignerProxy.targeCommontProxy&&t==KDCardLayoutDesignerProxy.targeCommontProxy.baseId?KDCardLayoutDesignerProxy.targeCommontProxy:KDCardLayoutDesignerProxy.targetStdProxy&&t==KDCardLayoutDesignerProxy.targetStdProxy.baseId?KDCardLayoutDesignerProxy.targetStdProxy:void 0},doDesignerCommand:function(e){KDCardLayoutDesignerProxy.doDesignerCommand&&KDCardLayoutDesignerProxy.doDesignerCommand.call(KDCardLayoutDesignerProxy,e)},doLayout:function(){if(KDInfoFlowPanelProxy.superclass.doLayout.call(this),this.config&&this.el){var t=this.config.styleKey||this.config.stylekey;if("kd-smartcard-businesscard"==t)this.el.removeClass("kd-infoflowpanel-card-group-Z"),this.el.width(this.config.width),this.el.offset().top>e.getBillHeadHeight()+200?this.el.addClass("kd-infoflowpanel-card-group-Z"):this.el.removeClass("kd-infoflowpanel-card-group-Z");else if("kd-smartcard-flowinfopanelcontainer"==t){var i=this.getFormProxy(),a=i&&i.el.find(".kd-mainconsole-operateContainer-external-panel").outerHeight()||0,n=e.getWindowHeight()-e.getBillHeadHeight()-e.CONST.FooterMainPanelHeight-a;this.el.css({"min-height":n-parseInt(this.el.css("margin-top"))-parseInt(this.el.css("margin-bottom"))}),i&&i.fireCustomEvents.call(i,"H5ClientCurrentWidth","H5ClientCurrentWidth",Math.ceil(this.el.width()).toString())}}},doDesignerStdConsoleCommand:function(e){KDCardLayoutDesignerProxy.doDesignerCommand&&KDCardLayoutDesignerProxy.doDesignerCommand.call(KDCardLayoutDesignerProxy,e)}}),$.extend(KDInfoFlowPanelProxy,{__debugData:function(e){}}),KDControlFactoryProxy.registerType("kdinfoflowpanel",KDInfoFlowPanelProxy)}(KD),define("KDInfoFlowPanelProxy",["KDFlowlayoutProxy","KD"],function(e){return function(){var t;return t||e.KDInfoFlowPanelProxy}}(this)),KDToggleFlowPanelProxy=KD.extend(KDControlProxy,{createControl:function(e){this.rendered=!1,this.activated=!0,this.config=e,this.isDynamicCreated=e&&e.isDynamicCreated,this.el=0!=$("#"+this.baseId).length?$("#"+this.baseId):this.createControlDom(),this.el.addClass("kd-mouseover-el kd-fluid-ct-title");var t=this.isKendo();return this.el.attr("id",this.baseId),this.el.dock=this.config.dock,KD.setAttachmentData(this.el,e),null==t&&(this.el.proxy=this),this.el},loadConfig:function(e){var t=this;this.key=e.id,this.config=e,e.height&&(this.config.metaHeight=e.height,this.elHeight=this.getHeight(e.height),this.innerHeight=this.getInnerHeight()),e.width&&(this.config.metaWidth=e.width),this.el.append($('<div class="kd-fluid-box"><span class="kd-fluid-ct-title-text"></span><span class="k-icon k-arrow-normal k-i-arrow-s kd-fluid-ct-title-extbtn"></span></div>')),this.setSync(KD.getValue(e,"sync",!1)),e.InlineStyle&&"string"==typeof e.InlineStyle&&(e.InlineStyle=KD.parseObject(e.InlineStyle)),this.InlineStyle=e.InlineStyle||{},this.InlineStyleValue=e.InlineStyleValue||"",e.font&&this.setFont(e.font),e.text&&($(".kd-fluid-ct-title-text",this.el).text(e.text),t.el.undelegate(".kd-fluid-box","click").delegate(".kd-fluid-box","click",function(e){t.onExtBtnClick.call(t,e)}))},onExtBtnClick:function(e){var t="kd-fluid-ct-title-extbtn-90deg",i=$(e.target),a="";i.hasClass("kd-fluid-box")?i=i.children().eq(1):i.hasClass("kd-fluid-ct-title-text")&&(i=i.parent().children().eq(1)),a=i.hasClass(t),a?i.removeClass(t):i.addClass(t);var n=i.closest(".kd-flowlayout").next();a?n.show():n.hide()}}),KDControlFactoryProxy.registerType("toggleFlowPanel",KDToggleFlowPanelProxy),define("KDToggleFlowPanelProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDToggleFlowPanelProxy}}(this)),function(e){KDInfoFlowItemProxy=e.extend(KDFlowlayoutProxy,{itemsRef:[],beforeCreateContent:function(e){KDInfoFlowPanelProxy.__debugData(e),e.showtitle&&e.title&&this.el.append('<div><span class="kd-infopanel-title-icon"></span><span class="kd-infopanel-title-text">'+e.title+"</span></div>"),e.hoverable&&(this.el.addClass("kd-infoitem-hoverable"),this.el.mouseenter(function(){var e=$(this).find("a.kd-h5cardconsole-refreshbtn");e.removeClass("kd-h5cardconsole-refreshbtn"),e.removeClass("kd-workbutton-notlink"),e.addClass("kd-h5cardconsole-refreshbtnhover")}),this.el.mouseleave(function(){var e=$(this).find("a.kd-h5cardconsole-refreshbtnhover");e.removeClass("kd-h5cardconsole-refreshbtnhover"),e.addClass("kd-h5cardconsole-refreshbtn")})),e.isspilit&&(this.el.addClass("kd-infopanel-spilt"),this.el.append('<div style="height:'+e.spiltcardheight+"px;width:"+e.spiltcardwidth+"px;left:"+e.spiltcardwidth+'px;top:30px" class="kd-infopanel-spiltdiv"></div>')),e.isallowedit&&0==e.isallowedit&&this.el.attr("isallowedit","false"),e.isshowedit&&0==e.isshowedit&&this.el.attr("isshowedit","false"),e&&e.maxHeight&&this.el.css({"max-height":parseInt(e.maxHeight)+21+"px"})},afterCreateContent:function(e){},doLayout:function(){KDInfoFlowItemProxy.superclass.doLayout.call(this)},loadConfig:function(t){t.preloadImage&&this.setPreloadImage.call(this,t.preloadImage);var i=this;KDInfoFlowItemProxy.superclass.loadConfig.call(i,t),t&&t.maxHeight&&this.childrenCt&&this.childrenCt.css({"max-height":t.maxHeight+"px"}),t.isaddbutton&&(this.el.attr("isaddbutton","true"),this.childrenCt.append('<a id="'+t.id+'_link" class="kd-addcardpanel-btn" href="#" title="点击添加待办事项" style="width:44px;height:44px;line-height:44px;position:relative;top:40px;left:80px"><img style="width: 100%; height: 100%; display:block;" src="../images/biz/default/MainConsole/H5CardLayout/MessageType/ADD.png"></a>'));var a=t.formid;t.formtype||"",t.pageId||"";if(i.itemsRef.length>0)for(var n=0;n<i.itemsRef.length;n++){var o=i.itemsRef[n];if(o.id==a){var r=$("<div></div>");r.css({"background-image":"url('../"+o.icon+"')",width:"100%",height:"100%","background-size":"100% 100%","background-repeat":"no-repeat"}),i.el.append(r);var s="区域大小：<br />";s+=i.el.width()+"x"+i.el.height(),r.append($("<div style='text-align: center;padding-top:"+i.el.height()/2+"px;color:blue;'>"+s+"</div>"));break}}else{var l=i.getControlFactoryProxy(),d=l.getParentFormProxy.call(l);if(!this.formLoaded){var c={id:i.key,formid:a,paramformid:t.paramformid,cardparminfo:t.cardparminfo,cardname:t.cardname,cardid:t.cardid,Seq:t.Seq,isPreView:e.getValue(t,"isPreView",!1),ishideprogressindicator:t.ishideprogressindicator,isautoheight:t.isautoheight,height:t.height},h=[c];this.el.attr("cardInfo",JSON.stringify(c));var u=null;if(t.cardid&&i.getParentProxy){var p=i.getParentProxy();p&&p.getParentProxy&&(u=p.getParentProxy())}u&&u.registerEvent&&u._loadConfigComlete===!1?u.registerEvent("FInfoPanelContainer","LoadInfoForms",c):d.fireCustomEventsNoData.call(d,"FInfoPanelContainer","LoadInfoForms",e.stringify(h)),this.formLoaded=!0}}},setPreloadImage:function(e){this.el.css("background-image","url("+e+")"),this.el.css("background-repeat","no-repeat"),this.el.css("background-position","center")},addDynamicForm:function(e){KDInfoFlowItemProxy.superclass.addDynamicForm.call(this,e),this.el.css("background-image",this.config.backgroundimage)},createControl:function(e){return KDInfoFlowItemProxy.superclass.createControl.call(this,e),this.el.addClass("kd-infoflow-item"),this.el},release:function(){this.formLoaded=!1,KDInfoFlowItemProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdinfoflowitem",KDInfoFlowItemProxy)}(KD),define("KDInfoFlowItemProxy",["KDFlowlayoutProxy","KD"],function(e){return function(){var t;return t||e.KDInfoFlowItemProxy}}(this)),function(e){KDCardsContainerProxy=e.extend(KDFlowlayoutProxy,{itemsRef:[],loadConfig:function(e){KDCardsContainerProxy.superclass.loadConfig.call(this,e)}}),KDControlFactoryProxy.registerType("kdcardslayout",KDCardsContainerProxy)}(KD),define("KDCardsContainerProxy",["KDFlowlayoutProxy","KD"],function(e){return function(){var t;return t||e.KDCardsContainerProxy}}(this)),function(){KDEditorFlexPanelProxy=KD.extend(KDContainerProxy,{createControl:function(e){KDEditorFlexPanelProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDEditorFlexPanelProxy.superclass.loadConfig.call(this,e)},loadChildren:function(e){if(!this.isChilderLoaded){var t=this;t.children||(t.children=[]);var i=e.items,a=t.getControlFactoryProxy();if(null!=i&&a)for(var n in i){var o=i[n];o.id=o.id?o.id.toUpperCase():void 0,o.parent=this.config.id,o.isNoneAbsPosition=!0;t.createInnerControl(o)}this.initchildren(),this.el.addClass("kd-flex-editorpanel kd-flex-ct-lrw"),this.isChilderLoaded=!0}},onAfterControlInited:function(e){e.el.addClass("kd-flex-item-cell")},doLayout:function(){KDEditorFlexPanelProxy.superclass.doLayout.call(this,this.config)}}),KDControlFactoryProxy.registerType("editorflexpanel",KDEditorFlexPanelProxy)}(),define("KDEditorFlexPanelProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDEditorFlexPanelProxy}}(this)),KDTableLayoutPanelProxy=KD.extend(KDContainerProxy,{tableEl:null,createControl:function(e){return KDTableLayoutPanelProxy.superclass.createControl(this,e)},loadChildren:function(e){if(!this.isChilderLoaded){var t=this;t.children||(t.children=[]);var i=e.items,a=e.colstyles,n=e.rowstyles,o=a.length,r=n.length;if(o&&o>0){for(var s=t.baseId+"_table",l='<table id="'+s+'"  cellspacing="0" cellpadding="0" >',d=0;r>d;d++){l+="<tr>";for(var c=0;o>c;c++){var h=s+"-td-"+d.toString()+"-"+c.toString();l+=g?'<td id="'+h+'">'+g.html()+"</td>":'<td id="'+h+'"></td>';
}l+="</tr>"}l+="</table>",tableEl=$(l),tableEl.dock=KD.dock.Fill;var u=t.el.find('div[data-kdid="'+t.el.getId()+'_fill"]');if(tableEl.appendTo(u.length>0?u:t.el),o&&o>0)for(var d=0;r>d;d++)for(var c=0;o>c;c++){var h=s+"-td-"+d.toString()+"-"+c.toString(),p=i[d*o+c],g=null,f=null;if(p.xtype&&p.xtype.length>0){"kditemcontainer"==p.xtype&&p.dock==KD.dock.Fill&&p.height&&(p.dock=KD.dock.None,i[d*o+c].dock=KD.dock.None);var f=t.controlFactoryProxy.createControl(p);f.parentProxy=t,t.children.push(f),g=f.getControl();var m=$("#"+h);m.append(g),f.loadConfig(p),f.el.css({top:0,margin:"2px 1px",left:0,"float":"none",position:"relative"})}}this.initchildren()}this.isChilderLoaded=!0}}}),KDControlFactoryProxy.registerType("kdtablelayoutpanel",KDTableLayoutPanelProxy),define("KDTableLayoutPanelProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDTableLayoutPanelProxy}}(this)),KDPopupPanelProxy=KD.extend(KDPanelProxy,{offsetLeft:0,offsetTop:0,loadConfig:function(e){KDPopupPanelProxy.superclass.loadConfig.call(this,e),this.setVisible(!1),e.zindex=KD.getValue(this.config,"zindex",8002),this.Zindex=e.zindex,this.el.css({"z-index":this.Zindex,"box-shadow":"1px 1px 1px 1px","-webkit-box-shadow":"1px 1px 1px 1px "}),this.el.addClass("kendo-panel-background-color  kendo-border-color");var t=this.el.attr("tabindex");void 0==t&&this.el.attr({tabindex:"-1"})},initComponent:function(){KDPopupPanelProxy.superclass.initComponent.call(this),this.setVisible(!1)},_bodyClickBind:!1,_fisrtShow:!0,show:function(){var e=this;if(e.closePopUpWins(),e.setPopContent(),void 0===e.config.placementtargetkey||0==e.config.placementtargetkey.length)e.el.css("left",e.offsetLeft),e.el.css("top",e.offsetTop);else{var t=e.getControlFactoryProxy().getCmp(e.config.placementtargetkey),i=t.getControl().offset();e.offsetLeft=i.left,e.offsetTop=parseInt(i.top)+parseInt(t.getControl().css("height")),e.el.css("left",e.offsetLeft),e.el.css("top",e.offsetTop)}e.el.show(),e._fisrtShow=!1,e.el.focus(),e.setPopClose()},setPopClose:function(){var e=this;0==this._bodyClickBind&&($("body").bind("click",function(t){var i=t.target||t.srcElement,a="none"!=e.el.css("display"),n=$(i).hasClass("kd-ui-blockingExtention-item");n||1!=a||0!=$(i).closest(this.el).length||e.closePopUpDirect()}),this._bodyClickBind=!0),this.el.bind("click",function(e){e.stopPropagation?e.stopPropagation():e.cancleBubble&&(e.cancleBubble=!0)}),this.el.unbind("blur").blur(function(t){var i=t.relatedTarget||document.activeElement;if("BODY"==i.tagName&&(i=void 0),i){i=$(i);var a=$(this),n="none"!=e.el.css("display"),o=$(a).hasClass("kd-ui-blockingExtention-item"),r=0==a.find(i).length?!1:!0;o||1!=n||r?r&&e.el.focus():e.closePopUpDirect()}})},setPopContent:function(){},setVisible:function(e){var t=this;t.visible=e,t._fisrtShow&&(e=!1,t.el.hide()),t.onAfterVisible.call(t,{visible:e})},closePopUpWins:function(){var e=document.activeElement.id,t=!1;void 0===e||0==e.length?t=!0:this.baseId&&this.baseId!=e&&0==this.el.find("#"+e).length&&(t=!0),t&&this.closePopUpDirect()},closePopUpDirect:function(){this.el.css("display","none")}}),KDControlFactoryProxy.registerType("kdpopup",KDPopupPanelProxy),define("KDPopupPanelProxy",["KDPanelProxy","KD"],function(e){return function(){var t;return t||e.KDPopupPanelProxy}}(this)),KDPopupMessageProxy=KD.extend(KDPopupPanelProxy,{pageId:"",orginFocus:"",offsetLeft:0,offsetTop:0,isNeedAutoClose:!0,communitySolutionCode:"",maskHtml:null,isFlowPopupWin:!1,UnCommunitySolutionSearchMode:!1,MesTipErrorUnStandVisible:!0,useNewStyle:!0,mesResult:{None:0,Ok:1,Cancel:2,Abort:3,Retry:4,Ignore:5,Yes:6,No:7,Robot:8,Club:9,CommunitySolution:10,CommunitySolutionSearching:11},createControl:function(e){if(void 0!=this.el){var t=this.el["data-attdata"]&&KD.parseObject(this.el["data-attdata"]);(KD.IsNullOrWhiteSpace(t)||!KD.IsNullOrWhiteSpace(t)&&"kdtablelayoutpanel"!=t.xtype)&&(this.orginFocus=document.activeElement&&document.activeElement.id?document.activeElement.id:void 0,this.closePopUpDirect(),this.timeOut&&self.clearTimeout(this.timeOut))}var i=KDPopupMessageProxy.superclass.createControl.call(this,e);return i},doLayout:function(){KDPopupMessageProxy.superclass.doLayout.call(this),this.el&&this.parentProxy&&this.el.width(this.parentProxy.el.width())},loadConfig:function(e){var t=e.mesType,t=parseInt(t);KD.isNaN(t)||(e.mesType=t),KDPopupMessageProxy.superclass.loadConfig.call(this,e),this.isNeedAutoClose=!0,this.otherset=KD.getValue(e,"otherset",{}),KD.isEmpty(this.otherset)||(this.isNeedAutoClose=KD.getValue(this.otherset,"allowautoclose",!0)),this.UnCommunitySolutionSearchMode=KD.CONST.UnCommunitySolutionSearchMode||!1,this.MesTipErrorUnStandVisible=0==KD.CONST.MesTipErrorUnStandVisible?!1:!0,this.communitySolutionCode=e.CommunitySolutionCode?KD.format(ResManager.LoadKDString("错误ID：{0}","0025710000004900"),e.CommunitySolutionCode):"";var i=this.getFormProxy().el,a=(i.offset(),new Object);if(a.width=i.css("width"),a.height="auto",a["min-height"]="80px",a["z-index"]=100,a["border-bottom"]="1px solid #363636",a.left=this._getFormPosition().left,this.el.css(a),this.el.addClass("kd-el-popmessage"),void 0==KD.CONST.IsEnableNewStyleOfTipbar){var n=KD.getConnectConfig(),o=n.IsEnableNewStyleOfTipbar+"";o=o.toLocaleLowerCase(),o=!("false"==o),KD.CONST.IsEnableNewStyleOfTipbar=o}this.useNewStyle=KD.CONST.IsEnableNewStyleOfTipbar,this.useNewStyle&&(this.el.addClass("kd-popmessage-style-galaxy"),this.el.css({"border-bottom":"none","box-shadow":"0 2px 6px 0 rgba(57,75,115,0.15)"})),this.pageId=KD.converToJqId(this.getFormProxy().dformConfig.pageId),this._edcodeHtmlElements()},_edcodeHtmlElements:function(){if(!KD.isEmpty(this.config.message)){var e=this.config.message+"";e=e.replace(/<br\/>/g,"\r\n").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"<br/>"),this.config.message=e}if(!KD.isEmpty(this.config.detail)){var t=this.config.detail+"";t=t.replace(/<br\/>/g,"\r\n").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"<br/>"),this.config.detail=t}},_getFormPosition:function(){var e={left:0,top:0,marginLeft:0,marginTop:0},t=parseInt(this.getFormProxy().el.css("left"));if(e.left+=isNaN(t)?0:t,"static"==this.getFormProxy().el.css("position")){var i=parseInt(this.getFormProxy().el.css("margin-left"));e.left+=isNaN(i)?0:i}return e},show:function(){var e=this;delete e.helpValue,this.orginFocus=document.activeElement&&document.activeElement.id?document.activeElement.id:void 0,this.setPopContent();var t=0,i=this.getFormProxy(),a=this.controlFactoryProxy.getCmp("BILLMENU");if(a&&a.el&&a.el.length>0&&(t=parseInt(a.el.css("height")),0>=t&&(t=0==t&&i&&i.mainMenu&&i.mainMenu.config?i.mainMenu.config.height||0:void 0==a.config.height?$("#"+a.baseId+"_TOOLBAR").height():a.config.height)),this.el.css("top",t),this.useNewStyle)switch(this.config.mesType){case KDMessageBox.KDMesBoxType.None:case KDMessageBox.KDMesBoxType.Ok:case KDMessageBox.KDMesBoxType.Normal:0==this.config.opts?this.el.addClass("kd-message-normal"):this.el.addClass("kd-message-question");break;case KDMessageBox.KDMesBoxType.Question:this.el.addClass("kd-message-question");break;case KDMessageBox.KDMesBoxType.Warning:this.el.addClass("kd-message-warring"),this.enabledMask();break;case KDMessageBox.KDMesBoxType.Error:this.el.addClass("kd-message-error"),this.enabledMask()}else switch(this.config.mesType){case KDMessageBox.KDMesBoxType.None:case KDMessageBox.KDMesBoxType.Ok:case KDMessageBox.KDMesBoxType.Normal:0==this.config.opts?(this.el.css("border-top","5px solid #319858"),this.el.css("background-color","#e8f5ec")):(this.el.css("border-top","5px solid #0297C8"),this.el.css("background-color","#E6EEF3"));break;case KDMessageBox.KDMesBoxType.Question:this.el.css("border-top","5px solid #0297C8"),this.el.css("background-color","#E6EEF3");break;case KDMessageBox.KDMesBoxType.Warning:this.el.css("background","#FFFAEA"),this.el.css("border-top","5px solid #F2B100"),this.enabledMask();break;case KDMessageBox.KDMesBoxType.Error:this.el.css("background","#F6EBEA"),this.el.css("border-top","5px solid #DC1313"),this.enabledMask()}this.appendViewSolutionsBtn(),this.adjustPopContentStyle(this.pageId),this.adjustTitleHeight();var n=this,o=this.el;n.isFlowPopupWin=!1;var r={top:$(window).scrollTop(),left:$(window).scrollLeft()};if(i.isPopUpFlowForm.call(i)||i.config&&i.config.isFlowForm&&i.dformConfig.isInPopWindow){n.isFlowPopupWin=!0,r.isFromPopupWin=!0;for(var s,l=0;10>l;l++)try{var d=i.getHostWindowProxy().el.childFormCt;if(d&&"true"==d.attr("allowscrollaction")){s=d;break}i=i.getParentFormByCurrentForm(i)}catch(c){continue}r.top=s?s.scrollTop():0,r.left=s?s.scrollLeft():0}o.show(function(){n.onScroll.call(n,{},r),n._adjustFluidPopMsg.call(n)}),this._fisrtShow=!1,this.setPopClose()},_showInteligentRobot:function(e){var t=e.pageId,i=($("<li></li>"),$("<li></li>"),$(kendo.format('<button title="'+ResManager.LoadKDString("点我能提供帮助喔~","014005000005596")+'"class="btn-intelrobot-popupmsg" id="{0}-ErrbtnRobot" type="button"></button>',t)));i.kendoButton({click:function(i){var n=e.getFormProxy();n.lockControl.call(n,e),n.fireCustomEvents.call(n,"MessageRobot$$","MessageRobot",KD.stringify({pageid:t,formid:e.formId,mestype:"Error",message:e.config.message,detailmes:e.config.detail,currentmesid:null})),a.hide()}});var a=i.kendoTooltip({position:"bottom left",animation:{close:{effects:"fade:out"}}}).data("kendoTooltip");e.el.find("#"+t+"-btn").append(i),e.el.find("#"+t+"-Errbtn").append(i)},setPopClose:function(){var e=this;if(0==this.config.opts&&this.isNeedAutoClose)switch(this.config.mesType){case KDMessageBox.KDMesBoxType.None:case KDMessageBox.KDMesBoxType.Ok:case KDMessageBox.KDMesBoxType.Normal:e.timeOut=self.setTimeout(function(){e.closePopUpWins.call(e)},1e3*KD.getLocalConfiguration().MessageDisTime),e.el.mouseover(function(t){self.clearTimeout(e.timeOut),e.timeOut=void 0}),e.el.mouseout(function(t){void 0==e.timeOut&&(e.timeOut=self.setTimeout(function(){e.closePopUpDirect.call(e)},1e3*KD.getLocalConfiguration().MessageDisTime))});break;case KDMessageBox.KDMesBoxType.Warning:case KDMessageBox.KDMesBoxType.Error:case KDMessageBox.KDMesBoxType.Question:}},setPopContent:function(){var e=this.pageId,t=this;this.el.empty();var i=this.getFormProxy(),a=i.config,n=i.isPopUpFlowForm(a),o=n?"-10px":"-20px",r=$(kendo.format('<div class="kd-msg-title" style= "min-height:25px;margin:10px 30px 0 20px;position:relative;"><span role="message" style="max-height: 250px;overflow-y:auto;overflow-x: hidden;display: block;color:black;word-break: break-all;">{0}<span class="kd-msg-detail kd-msg-btn-solute" style="margin-top: 0px; margin-left: 10px;display:none;" title="{1}">{2}</span></span><div id="{3}-label" class="kd-msg-closebtn-container" style="position: absolute;right:{4};top: -3px;"></div></div>',this.config.message,ResManager.LoadKDString("去社区查看知识或提问题","00214298000004011"),ResManager.LoadKDString("前往金蝶云社区获取更多帮助","00215181030037938"),e,o)),s='<div id="'+e+'-btn" class="kd-msg-btn-container" style= "margin-top:5px;margin-left:20px; margin-bottom: 8px;"></div>';$.browser.msie&&$.browser.version<=10&&r.find("span").css("overflow-y","inherit"),this.el.append(r),t.initMsgControl.call(t),this.el.append(s);var l=$(kendo.format('<div id="{0}-btnClose"class="kd-messageBox-close"></div>',e)),d=this.useNewStyle?this.el.find(".kd-msg-closebtn-container"):l;if(d.click(function(e){KD.isEmpty(t.config.mesId)||t.getFormProxy().afterMessageHandler(t.config.mesId,t.mesResult.None),t.closePopUpDirect()}),this.el.find(".kd-msg-closebtn-container").append(l),0==this.config.opts||1==this.config.opts){var c=$(kendo.format('<button id="{0}-btnOK" type="button">'+ResManager.LoadKDString("确定","0991733000003896")+"</button>",e));c.kendoButton({click:function(e){t.getFormProxy().lockControl.call(t.getFormProxy(),t),t.getFormProxy().afterMessageHandler(t.config.mesId,1),t.closePopUpDirect()}}),$("#"+e+"-btn").append(c)}else if(4==this.config.opts||3==this.config.opts){var h,u;6==this.config.opts?(h=$(kendo.format('<button id="{0}-btnYes" type="button">'+ResManager.LoadKDString("确定","0991733000003896")+"</button>",e)),u=$(kendo.format('<button id="{0}-btnOK" type="button">'+ResManager.LoadKDString("取消","0991733000003922")+"</button>",e))):(h=$(kendo.format('<button id="{0}-btnYes" type="button">'+ResManager.LoadKDString("是","0991733000003969")+"</button>",e)),u=$(kendo.format('<button id="{0}-btnNo" type="button">'+ResManager.LoadKDString("否","0991733000003970")+"</button>",e))),h.kendoButton({click:function(e){t.getFormProxy().lockControl.call(t.getFormProxy(),t),t.getFormProxy().afterMessageHandler(t.config.mesId,6),t.closePopUpDirect()}}),u.kendoButton({click:function(e){t.getFormProxy().lockControl.call(t.getFormProxy(),t),t.getFormProxy().afterMessageHandler(t.config.mesId,7),t.closePopUpDirect()}}),u.css("margin-left","10px"),$("#"+e+"-btn").append(h),$("#"+e+"-btn").append(u)}if(this.config.opts>=1&&4!=this.config.opts&&2!=this.config.opts&&6!=this.config.opts){var p=$(kendo.format('<button id="{0}-btnCancel" type="button">'+ResManager.LoadKDString("取消","0991733000003922")+"</button>",e));p.kendoButton({click:function(e){t.getFormProxy().lockControl.call(t.getFormProxy(),t),t.getFormProxy().afterMessageHandler(t.config.mesId,2),t.closePopUpDirect()}}),(1==this.config.opts||3==this.config.opts)&&p.css("margin-left","10px"),$("#"+e+"-btn").append(p)}if(2==this.config.opts||5==this.config.opts){var g=$(kendo.format('<button id="{0}-btnRetry" type="button">'+ResManager.LoadKDString("重试","0991733000003952")+"</button>",e));if(g.kendoButton({click:function(e){t.getFormProxy().lockControl.call(t.getFormProxy(),t),t.getFormProxy().afterMessageHandler(t.config.mesId,4),t.closePopUpDirect()}}),5==this.config.opts&&$("#"+e+"-btn").append(g),2==this.config.opts){var f=$(kendo.format('<button id="{0}-btnAbort" type="button">'+ResManager.LoadKDString("终止","0991733000005706")+"</button>",e));f.kendoButton({click:function(e){t.getFormProxy().lockControl.call(t.getFormProxy(),t),t.getFormProxy().afterMessageHandler(t.config.mesId,3),t.closePopUpDirect()}});var m=$(kendo.format('<button id="{0}-btnIgnore" type="button">'+ResManager.LoadKDString("忽略","0991733000005707")+"</button>",e));m.kendoButton({click:function(e){t.getFormProxy().lockControl.call(t.getFormProxy(),t),t.getFormProxy().afterMessageHandler(t.config.mesId,5),t.closePopUpDirect()}}),$("#"+e+"-btn").append(f),$("#"+e+"-btn").append(g),$("#"+e+"-btn").append(m)}}if(!KD.isEmpty(this.config.detail)||!KD.isEmpty(this.communitySolutionCode)){var v=$('<div id="'+e+'-Errdetails" class="kd-msg-detail-btn" style= "margin-top:5px;margin-left:20px"></div>'),y=this.config.detail&&this.config.detail.replace(/\r\n/gi,"<br/>")||"",b=KDMessageBox.KDMesBoxType.Error==this.config.mesType?this.communitySolutionCode+"<br/>":"",D=$(kendo.format('<div id="{0}-Errdetail" style= "overflow-y:auto;color:black;"><span style="display:inline-block;padding:5px 20px;" class="kd-msg-details">{1}{2}</span></div>',e,b,y));this.myShowDetails=!1,D.hide();var k=$(kendo.format('<a id="{0}-ErrbtnDetails" href="javascript:void(null)" >'+ResManager.LoadKDString("展开详情","0991733000005640")+"</a>",e));if(k.click(function(){t.showPopDetails()}),v.append(k),KD.isEmpty(this.config.detail)&&v.hide(),this.useNewStyle){if(v.append($('<span class="icon" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+'); "></span>')),this.el.append(D),D.insertBefore(this.el.find(".kd-msg-btn-container")),v.insertBefore(D),KDMessageBox.KDMesBoxType.Error==this.config.mesType){var C=this.MesTipErrorUnStandVisible?"inline-block":"none",x=$(kendo.format('<div class="kd-msg-btn-notunderstands" style="display:{2};"><a id="{0}-ErrbtnNotUnderstands" href="javascript:void(null)">{1}</a></div>',e,ResManager.LoadKDString("没看懂？","00215181030037731"),C));x.click(function(){$(this).text(ResManager.LoadKDString("已收到反馈","00215181030037794")).css("color","#BDBDBD");var e=t.getFormProxy();e&&e.fireCustomEvents("Kingdee.BOS.MesTips.ErrorSolutionsUnStand","Kingdee.BOS.MesTips.ErrorSolutionsUnStand",null)}),this.el.append(x)}}else this.el.append(v).append(D)}},initMsgControl:function(){if(!KD.isEmpty(this.config.msgcontrol)){var e=this,t=KD.isArray(this.config.msgcontrol)?this.config.msgcontrol[0]:this.config.msgcontrol;t=KD.parseObject(t),t.caption&&(t.caption=t.caption.replace(/\r\n/gi,"<br/>"));var i=$(kendo.format('<div id="{0}-msgcontrol" key="{1}" class="kdPopupMessageProxy_msgcontrol">{2}</div>',this.pageId,t.key,t.caption));this.el.append(i),KD.isEmpty(t.linkopen)||i.attr({linkopen:t.linkopen}),i.click(function(t){var i=t.currentTarget||t.target,a=e.getFormProxy(),n=$(i).attr("linkopen");KD.isEmpty(n)?a.fireEventNoData("MsgInnerControlEvent",$(i).attr("key"),"buttonclick",null,null,null):a.showWebURL([n])}),this.isNeedAutoClose=!1}},adjustPopContentStyle:function(e){if(this.useNewStyle){this.parentProxy&&("BOS_HtmlConsoleMain"==this.parentProxy.getFormId()||this.parentProxy.isPopUpFlowForm())&&this.el.width(this.el.width()-KD.getScrollBarHeight());var t=$(kendo.format('<div class="kd-msg-title-icon" style="background-image:url({0});"></div>',KD.getImageUrlByNameAndVersion("kd_icon_extend.png")));if(this.el.find(".kd-msg-title").css({margin:"0px","min-height":"25px"}).append(t),this.el.find('.kd-msg-title [role="message"]').css({color:"inherit","margin-right":"0px"}),this.el.find(".kd-msg-closebtn-container").css({right:"0px",top:"1px"}),this.el.find(".kd-msg-closebtn-container .kd-messageBox-close").css({"background-image":"url("+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+")"}),this.el.find(".kd-msg-btn-container").css({"margin-top":"10px","margin-left":"40px","margin-bottom":"10px"}),this.el.find(".kd-msg-detail:not(.kd-msg-btn-solute)").css({"margin-top":"0px","margin-left":"10px",display:"inline-block"}),this.el.find(".kd-msg-detail-btn").css({"margin-left":"40px","margin-top":"0px"}),KDMessageBox.KDMesBoxType.Error==this.config.mesType){var i=ClientAppProxy.Current.defaultLocalId.toString();"1033"==i?this.el.find('.kd-msg-title [role="message"]').css({"margin-right":"120px"}):this.el.find('.kd-msg-title [role="message"]').css({"margin-right":"70px"}),this.el.find(".kd-msg-detail-btn").css("display","inline-block")}this.el.find(".kd-msg-showdetail-btn").css({"float":"none","margin-left":"40px","margin-top":"3px"}),this.el.find(".kd-msg-details").css({"padding-left":"40px"})}},adjustTitleHeight:function(){if(this.parentProxy&&this.parentProxy.el&&$.isFunction(this.parentProxy.el.height)){var e=this.parentProxy.el.height(),t=this.el.height();if(e=e>0?e:300,t>e){var i=e-this.el.find(".kd-msg-btn-container").outerHeight(!0)-(this.el.find(".kd-msg-title").outerHeight(!0)-this.el.find('.kd-msg-title [role="message"]').outerHeight(!0));this.config.detail&&this.config.detail.length>0&&(i-=38),i=22>i?22:i,i+="px",this.el.find('.kd-msg-title [role="message"]').css({"max-height":i})}}},appendViewSolutionsBtn:function(){var e=this;if(e.config.mesType==KDMessageBox.KDMesBoxType.Error){var t=e.el.find(".kd-msg-title [role='message']"),i=function(t){var i=e.getFormProxy.call(e);if(t&&i&&i.__lasttipsearchs&&i.__lasttipsearchs.code==e.config.CommunitySolutionCode)return e.setCommunitySolutionCaption.call(e,i.__lasttipsearchs),!1;var a={};a.pageid=e.getPageId(),a.mestype=e.config.mesType+"",a.message=e.config.message+"",a.biztipsnumber=e.config.BizTipsNumber,a.CommunitySolutionCode=e.config.CommunitySolutionCode||"";var n="Kingdee.BOS.MesTips.ErrorSolutions",o="错误提示-去社区";if(t&&(n="Kingdee.BOS.MesTips.ErrorSolutionsSearching",o="错误提示-搜索解决方案中"),a.eventname=n,i){i.__lasttipsearchs={},i.__lasttipsearchs.code=e.config.CommunitySolutionCode,i.fireCustomEventsNoData.call(i,n,n,KD.stringify(a));var r={};r.opkey=n,r.opname=o,i.fireCustomEventsNoData.call(i,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(r))}return!0},a=!0;if(this.UnCommunitySolutionSearchMode)a=!1;else{var n=$(kendo.format('<span class="kd-msg-btn-solutesearching" style="margin-top: 0px;margin-left: 10px;color: rgba(145,144,165,0.6);">{0}</span>',ResManager.LoadKDString("搜索方案中","0025710000005521")));t.append(n),i(!0)}var o=this.el.find(".kd-msg-btn-solute"),r=!a||this.UnCommunitySolutionSearchMode?"inline":"none";o.css("display",r),o.click(function(){if(e.CommunitySolutionNavUri){var t=e.getFormProxy.call(e);if(t){t.fireCustomEventsNoData.call(t,"Kingdee.BOS.KnowledgeLinkOpen","Kingdee.BOS.KnowledgeLinkOpen",e.CommunitySolutionNavUri);var a={};a.opkey="Kingdee.BOS.KnowledgeLinkOpen",a.opname="错误提示-社区帮助",t.fireCustomEventsNoData.call(t,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(a))}}else i(!1)})}},setCommunitySolutionCaption:function(e){var t=this;if(t.config.mesType!=KDMessageBox.KDMesBoxType.Error)return t.CommunitySolutionNavUri=void 0,void(t.CommunitySolutionMoreUri=void 0);if(t.el){var i=t.getFormProxy.call(t),a=t.el.find(".kd-msg-title [role='message']"),n=a.find(".kd-msg-btn-solutesearching");n.is(":Visible")&&(n.hide(),e.hassolution?(a.find(".kd-msg-btn-solute").css("display","none"),e.urltitle&&(t.el.find(".kd-msg-solute-details").text(e.urltitle),t.el.find(".kd-msg-details-container").css("display","block")),e.hasmulti&&(t.el.find(".kd-msg-solute-morebtn").css("display","inline-block").off("click").on("click",function(){t.CommunitySolutionMoreUri&&KD.openPage(t.CommunitySolutionMoreUri,"_blank")}),t.CommunitySolutionMoreUri=e.multiurl)):(a.find(".kd-msg-btn-solute").text(ResManager.LoadKDString("前往金蝶云社区获取更多帮助","00215181030037938")),a.find(".kd-msg-btn-solute").css({display:"inline"})),t.CommunitySolutionNavUri=e.url),i&&KD.isObject(i.__lasttipsearchs)&&(i.__lasttipsearchs.hassolution=e.hassolution,i.__lasttipsearchs.url=e.url,i.__lasttipsearchs.urltitle=e.urltitle,i.__lasttipsearchs.hasmulti=e.hasmulti,i.__lasttipsearchs.multiurl=e.multiurl)}},appendHelpfulInvs:function(){var e=this.pageId,t=this,i=(t.config||{}).BizTipsMasterId||"",a=(t.config||{}).BizTipsNumber||"";if(!KD.isEmpty(i)||!KD.isEmpty(a)){var n=(t.config.mesType==KDMessageBox.KDMesBoxType.None||t.config.mesType==KDMessageBox.KDMesBoxType.Ok||t.config.mesType==KDMessageBox.KDMesBoxType.Normal)&&0==t.config.opts;if(!n){var o=$('<div class="kd-msg-helpfulinvest" style="text-align:right;padding-left:80px;margin-bottom: 5px;">').appendTo(this.el.find(".kd-msg-btn-container"));this.el.width()<400&&o.css({"padding-left":"20px"});var r=KD.format("invest_{0}_{1}",e,"helpfully"),s=KD.format("invest_{0}_{1}",e,"helpfuless");o.append(this.createHelpfulButton(e,r,ResManager.LoadKDString("有用","0025710000005351"),1,"helpfully")),o.append(this.createHelpfulButton(e,s,ResManager.LoadKDString("无用","0025710000005352"),-1,"helpfuless")),$(".kd-invest-helpful",o).click(function(e){var i=$(e.target).hasClass(".kd-invest-helpful")?$(e.target):$(e.target).closest(".kd-invest-helpful"),a=i.data()||{};t.helpValue=t.helpValue==a.value&&void 0!==t.helpValue?void 0:a.value,void 0===t.helpValue?($("#"+r).removeClass("kd-invest-helpfully-checked").addClass("kd-invest-helpfully"),$("#"+s).removeClass("kd-invest-helpfuless-checked").addClass("kd-invest-helpfuless")):1==t.helpValue?($("#"+r).removeClass("kd-invest-helpfully").addClass("kd-invest-helpfully-checked"),$("#"+s).removeClass("kd-invest-helpfuless-checked").addClass("kd-invest-helpfuless")):-1==t.helpValue&&($("#"+r).removeClass("kd-invest-helpfully-checked").addClass("kd-invest-helpfully"),$("#"+s).removeClass("kd-invest-helpfuless").addClass("kd-invest-helpfuless-checked"))})}}},fireHelpfulInvsData:function(){var e=this,t=1==e.helpValue?!0:-1==e.helpValue?!1:void 0;if(void 0!==t){var i=e.pageId,a=$(".kd-invest-helpful",e.el),n=a.data()||{};if(!KD.isEmpty(n)){var o=e.getFormProxy.call(e);o&&o.fireCustomEvents.call(o,"MsgHelpfulInvestigate$$","Helpful",KD.stringify({PageId:i,FormId:e.formId,MasterId:n.masterid,BizTipsMasterId:n.masterid,BizTipsNumber:n.number,InvestigateValue:KD.stringify({Helpful:t}),CurrentMesId:"",Message:e.config.message,Remark:""}))}}},enabledMask:function(){var e=$("<div></div>"),t=this.el.parent();0!=t.length&&(this.maskHtml?t.prepend(this.maskHtml):(e.css({position:"absolute",display:"block",width:"100%",height:t.height(),"background-color":"black",opacity:.5,"z-index":102}),this.el.css("z-index",103),this.maskHtml=e,t.prepend(e)))},showPopDetails:function(){var e=this.pageId;if(this.myShowDetails)this.el.css("height","auto",this.el),$("#"+e+"-Errdetail",this.el).hide(),$("#"+e+"-ErrbtnDetails",this.el).text(ResManager.LoadKDString("展开详情","0991733000005640")).removeClass("kd-state-active"),this.myShowDetails=!1;else{var t=300;if(this.parentProxy&&this.parentProxy.el&&$.isFunction(this.parentProxy.el.height)){var i=this.parentProxy.el.height()>0?this.parentProxy.el.height():300,a=this.el.css("top");a=parseInt(a),a=KD.isNaN(a)?1:a+1,i>this.el.height()+300+a||(t=i-this.el.outerHeight(!0)-a)}t=t>0?t:0,this.el.css({height:"auto"}),$("#"+e+"-Errdetail",this.el).show().css({height:"auto","max-height":t}),$("#"+e+"-ErrbtnDetails",this.el).text(ResManager.LoadKDString("收起详情","00215181030037730")).addClass("kd-state-active"),this.myShowDetails=!0}},closePopUpWins:function(){var e=document.activeElement&&document.activeElement.id,t=!1;null==e||void 0===e||0==e.length?t=!0:this.baseId&&this.el&&0==this.el.find("#"+e).length&&("ie"==KD.getCurrentBrowsType().type?t=!0:this.baseId!=e&&(t=!0)),t&&this.closePopUpDirect()},closePopUpDirect:function(){var e=this;if(e.fireHelpfulInvsData.call(e),KDFloatingManager.instance.setSink(this.getPageId(),this.el),KDFloatingManager.instance.release(this.getPageId(),this.el,{dock:"top"}),this.el&&(this.el.remove(),this.el=void 0),!this.maskHtml||this.config.mesType!=KDMessageBox.KDMesBoxType.Warning&&this.config.mesType!=KDMessageBox.KDMesBoxType.Error||(this.maskHtml.remove(),this.maskHtml=null),this.getFormProxy().children=$.grep(this.getFormProxy().children,function(t){return t.key!=e.config.id}),delete this.getControlFactoryProxy().controls[e.config.id],this.orginFocus=document.activeElement&&document.activeElement.id?document.activeElement.id:this.orginFocus,!KD.isEmpty(this.orginFocus)){var t=$("#"+this.orginFocus);t&&t.length&&t[0]&&$.isFunction(t.focus)&&t.focus()}},onActivated:function(){this._adjustFluidPopMsg()},onDeactivated:function(){},onScroll:function(e,t){(1!=this.isFlowPopupWin||1==t.isFromPopupWin)&&this._adjustFloat(e,t)},_adjustFloat:function(e,t){var i=this.el;if(i&&i.length>0&&i.is(":visible"))if(1!=this.isFlowPopupWin){var a=t.top;KDFloatingManager.instance.duckList[this.baseId]&&(a+=KDFloatingManager.instance.duckList[this.baseId].top.totalPx);var n=t.left;i.winOffset=t;var o=KD.CONST.IsBillHeadFloat?i.parent().offset().top-KD.getBillHeadHeight(!1):i.parent().offset().top,r=KD.CONST.IsBillHeadFloat?0:this.getFormProxy().el.offset().top,s=this.getFormProxy().el.height(),l=i.height();if(a>o&&r+s-l>a){var d={dock:"top",WidthOrHeightName:"width",ParentWidthOrHeightValue:i.width(),otherSideDockName:"left",otherSideDockValue:i.parent().offset().left-n};d.ParentWidthOrHeightValue>=5&&(KDFloatingManager.instance.setFloat(this.getPageId(),i,d),i.addClass("kd-menubar-el-floating"))}else i.hasClass("kd-el-floating")&&(KDFloatingManager.instance.setSink(this.getPageId(),i),i.removeClass("kd-menubar-el-floating"))}else i.css({left:t.left+"px",top:t.top+"px"})},_adjustFluidPopMsg:function(){var e=this,t=e.getFormProxy.call(e)||{},i=(t.dformConfig||{}).isFluid;if(i&&e.el&&e.el.outerHeight){var a=(e.el.height()||80)+(t.hasMenu?50:0),n=t.el?t.el.height()+1:1;n&&a>n?e.el.css({position:""}):e.el.css({position:"absolute"})}},createRedio:function(e,t,i,a,n){var o=KD.format('<div style="display:inline-block;margin-left:3px;"><input type="radio" id="{0}" name="{3}" value="{2}" class="k-radio" data-value="{4}" data-masterid="{5}" data-number="{6}" ><label class="k-radio-label" id="label_{0}" for="{0}">{1}</label></div>',t,i,a?"True":"False",e,privateId,(this.config||{}).BizTipsMasterId||"",(this.config||{}).BizTipsNumber||"");return $(o)},createHelpfulButton:function(e,t,i,a,n){var o="helpfully"==n?"kd-invest-helpfully":"kd-invest-helpfuless",r=kendo.format('<div id="{0}" class="kd-invest-helpful {2}" data-name="{3}" data-value="{4}" data-masterid="{5}" data-number="{6}" type="button"><span class="kd-invest-backIcon" style="background-image:url({7});"/><span>{1}</span></div>',t,i,o,e,a,(this.config||{}).BizTipsMasterId||"",(this.config||{}).BizTipsNumber||"",KD.getImageUrlByNameAndVersion("kd_icon_extend.png"));return $(r)}}),KDControlFactoryProxy.registerType("kdPopupMessage",KDPopupMessageProxy),define("KDPopupMessageProxy",["KDPopupPanelProxy","KD"],function(e){return function(){var t;return t||e.KDPopupMessageProxy}}(this)),KDPopupWorkPagesProxy=KD.extend(KDPopupPanelProxy,{loadConfig:function(e){KDPopupWorkPagesProxy.superclass.loadConfig.call(this,e);var t=KDMainTabControlProxy.getFavoriteKey(),i=$("#"+t).offset();this.offsetLeft=i.left-e.width+10,this.offsetTop=i.top+parseInt($("#"+t).css("height"))+8},setPopContent:function(){var e=this;this.el.empty(),this.currrentShowBaseId=this.tabScope.currentShowBaseId||"",this.setMainFloatPage();var t=0,i=ClientAppProxy.Current.rootForm.getControlFactoryProxy().childForms,a=this.getControlFactoryProxy().childForms,n=this._mergeForms(i,a);n=n.filter(function(e){return ClientAppProxy.Current.getAliveForm(e.dformConfig.pageId)});for(var o in n){var r=n[o],s=r.hostWindowProxy,l="",d="",c="";if(s&&(!r.dformConfig||"BOS_INFOPANEL"!=r.dformConfig.formid&&"BOS_HtmlMainSystemMenu"!=r.dformConfig.formid&&"BOS_MainSystemMenu"!=r.dformConfig.formid&&r.dformConfig.showType==KDDynamicFormShowType.NewTabPage)){l=r.dformConfig.getBillTitle(),hiddenclosebutton=r.dformConfig.hiddenclosebutton,d=s.getBaseId()+"-floatdiv",c=s.getBaseId()+"-floatbutton";var h=function(){var t=this.id.replace("-floatbutton","_c");$("#li_"+t).click(),e.closePopUpDirect()};t++,this.genFloatPageItem(d,c,l,h,s.getBaseId()==this.currrentShowBaseId,s.getBaseId(),hiddenclosebutton)}}this.setClosePageButtons();var u=26,p=KD.getCurrentFontsize();this.el.css("height",((t+3)*u+3)/p+"em"),KD.delayInvoke(function(i){var a=e.el.children(":first").outerHeight();a=u>a?u:a,e.el.css("height",((t+3)*a+3)/p+"em")})},_mergeForms:function(e,t){for(var i=[],a={},n=0;n<e.length;n++){var o=e[n];o&&o.baseId&&a&&(a[o.baseId]=!0,i.push(o))}for(var n=0;n<t.length;n++){var r=t[n];void 0!=r&&void 0==a[r.baseId]&&i.push(r)}return i},genFloatPageItem:function(e,t,i,a,n,o,r){var s=this,l=$('<div id="'+e+'" class="kendo-panel-background-color KDPopupWorkBtnStyle" style= "cursor:pointer;padding:5px 10px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"></div>'),d="";d=t==this.closeAllTabsBtnID||t==this.closeOtherTabsBtnID?"kd-ui-icon kd-ui-icon-none":1==n?"kd-ui-icon  kd-ui-icon-seek-right":"kd-ui-icon  kd-ui-icon-seek-file",l.append('<span class="'+d+'" style="display:block;float:left;"></span>'),this.el.append(l);var c=$(kendo.format('<a id="{0}" ctrlrole="linkButton" class="kendo-color ui-linkbutton" data-domcreated="true" tabindex="0" href="javascript:void(null)" style="display: inline; padding-left: 5px; width: 85%; overflow: hidden;"><span class="ui-lb-text" style="display: inline;">{1}</span></a>',t,KD.htmlUtil.encode(i)));if(l.click(function(e){a.id=t,e.clickDivID=t,a.call(a,e)}),c.css({"padding-left":"5px","float":"left"}),l.append(c),!r&&t!=this.closeAllTabsBtnID&&t!=this.closeOtherTabsBtnID&&"F64243A2-C674-44AD-ABC5-AC97BD0CCCE0"!=t){var h=$(kendo.format('<span style="position: absolute; display: block; right: 0px;" class="kd-ui-icon kd-ui-icon-none"></span>'));l.append(h),l.mouseenter(function(){h.addClass("KDfloatPageClose")}),l.mouseleave(function(){h.removeClass("KDfloatPageClose")}),h.click(function(e){s.tabScope.closeCurrentTabItemByPageId(o)})}},setMainFloatPage:function(){$popMessageThis=this;var e=this.tabScope&&this.tabScope.children[0].getBaseId();if(!KD.IsNullOrWhiteSpace(e)){var t=function(){$("#li_"+e+"_c").click(),$popMessageThis.closePopUpDirect()};this.genFloatPageItem("A807CDD8-CA82-4DCC-B266-CD404FDD0CA8","F64243A2-C674-44AD-ABC5-AC97BD0CCCE0",ResManager.LoadKDString("主页","099002000000094"),t,this.currrentShowBaseId==e);
}},closeOtherTabsBtnID:"A95D8289-C059-42C1-AB5E-7024846D4E1B_CloseOtherItem",closeAllTabsBtnID:"FB48007D-D2B5-4898-A071-E0A9EDF791A7_CloseAllItem",setClosePageButtons:function(){$popMessageThis=this;var e=this,t=function(t){e.closeItemsEvent(t),$popMessageThis.closePopUpDirect()};this.el.append('<div style="margin:0px 10px; border-top:1px dashed #D4d4d4;"></div>'),this.genFloatPageItem("FC83BDCD-7D4F-46A8-A272-AA745CDEC97C",this.closeOtherTabsBtnID,ResManager.LoadKDString("关闭其他页面","099002000000095"),t),this.genFloatPageItem("DEAA6880-1FBA-4C6F-B6DE-64D7D8FC2124",this.closeAllTabsBtnID,ResManager.LoadKDString("关闭所有页面","099002000000096"),t),$("#DEAA6880-1FBA-4C6F-B6DE-64D7D8FC2124").css("margin-bottom","10px")},closeItemsEvent:function(e){if(this.tabScope){var t=e.clickDivID;t==this.closeOtherTabsBtnID?this.tabScope.closeAllTabsExceptCurrent():t==this.closeAllTabsBtnID&&this.tabScope.closeAllTabs()}}}),KDControlFactoryProxy.registerType("kdPopupWorkPages",KDPopupWorkPagesProxy),define("KDPopupWorkPagesProxy",["KDPopupPanelProxy","KD"],function(e){return function(){var t;return t||e.KDPopupWorkPagesProxy}}(this)),KDPopupMainMenuProxy=KD.extend(KDPopupPanelProxy,{loadConfig:function(e){KDPopupMainMenuProxy.superclass.loadConfig.call(this,e);var t=KDMainTabControlProxy.getAllFeatureKey(),i=$("#"+t).offset(),a=i.left-e.width+10;this.offsetLeft=0>a?i.left:a,this.offsetTop=i.top+parseInt($("#"+t).height())+3,this.el.addClass("kendo-panel-background-color")}}),KDControlFactoryProxy.registerType("kdPopupMainMenuProxy",KDPopupMainMenuProxy),define("KDPopupMainMenuProxy",["KDPopupPanelProxy","KD"],function(e){return function(){var t;return t||e.KDPopupMainMenuProxy}}(this)),KDPopupErrMessageProxy=KD.extend(KDPopupMessageProxy,{pageId:"",myShowDetails:!1,loadConfig:function(e){KDPopupErrMessageProxy.superclass.loadConfig.call(this,e);this.getFormProxy();this.useNewStyle||this.el.css({border:"0px solid red","border-top-style":"solid","border-top-width":"5px","border-top-color":"#dc1313","border-bottom":"1px solid #363636","background-color":"#f6ebea"}),this.pageId=KD.converToJqId(this.getFormProxy().dformConfig.pageId)},setPopClose:function(){},setPopContent:function(){var e=this.pageId,t=this;this.el.empty();var i=$(kendo.format('<div class="kd-msg-title" style= "min-height:25px;margin:10px 5px 0 20px;position: relative;"><span role="message" style="max-height:250px;overflow-y: auto;overflow-x: hidden;display: block;color:black;word-break: break-all;margin-right:26px;">{0}<span class="kd-msg-detail kd-msg-btn-solute" style="margin-top: 0px; margin-left: 10px;display:none;" title="{1}">{2}</span></span><div id="{3}-Errlabel" class="kd-msg-closebtn-container" style="position: absolute;right: 10px;top: 10px;"></div></div>',this.config.message,ResManager.LoadKDString("去社区查看知识或提问题","00214298000004011"),ResManager.LoadKDString("前往金蝶云社区获取更多帮助","00215181030037938"),e)),a=$('<div id="'+e+'-Errbtn" class="kd-msg-btn-container" style= "margin-top:5px;margin-left:20px"></div>'),n=$('<div id="'+e+'-Errdetails" class="kd-msg-detail kd-msg-showdetail-btn" style= "margin-top:5px;margin-left:20px;float:right;padding-top:0px;margin-right: 26px"></div>'),o=this.config.detail&&this.config.detail.replace(/\r\n/gi,"<br/>")||"",r=$(kendo.format('<div id="{0}-Errdetail" style= "margin-top:15px;margin-left:20px;color:black;overflow-y: auto;"><span class="kd-msg-details">{1}<br/>{2}</span></div>',e,this.communitySolutionCode,o));$.browser.msie&&$.browser.version<=10&&i.find("span").css("overflow-y","inherit"),this.el.append(i);var s=$(kendo.format('<div class="kd-msg-details-container" style="display:none"><span class="kd-msg-details-title">{0}</span><span class="kd-msg-solute-details"></span><span class="kd-msg-solute-morebtn">{1}</span></div>',ResManager.LoadKDString("请点击查阅知识：","00215181030037737"),ResManager.LoadKDString("获取更多知识","00215181000017443")));this.el.append(s),t.initMsgControl.call(t),this.useNewStyle?(i.css({"margin-right":"0px"}),r.css({margin:"5px 0px"}),this.el.append(n),this.el.append(r),this.el.append(a),this.el.find(".kd-msg-solute-details").click(function(){t.CommunitySolutionNavUri&&KD.openPage(t.CommunitySolutionNavUri,"_blank")})):(this.el.append(a),this.el.append(n),this.el.append(r),this.el.find(".kd-msg-closebtn-container").css({right:"26px",top:"0px"}));var l=$(kendo.format('<div id="{0}-btnClose"class="kd-messageBox-close" style="position: absolute;"></div>',e)),d=this.useNewStyle?this.el.find(".kd-msg-closebtn-container"):l;d.click(function(e){t.handleStartAppForm.call(t),t.closePopUpDirect()}),this.el.find(".kd-msg-closebtn-container").append(l),r.hide(),this.myShowDetails=!1;var c=$(kendo.format('<button id="{0}-ErrbtnOK" type="button">'+ResManager.LoadKDString("确定","0991733000003896")+"</button>",e));if(c.kendoButton({click:function(e){t.handleStartAppForm.call(t),t.closePopUpDirect()}}),$("#"+e+"-Errbtn").append(c),this.useNewStyle){var h=this.MesTipErrorUnStandVisible?"inline-block":"none",u=$(kendo.format('<div class="kd-msg-btn-notunderstands" style="display:{2};"><a id="{0}-ErrbtnNotUnderstands" href="javascript:void(null)">{1}</a></div>',e,ResManager.LoadKDString("没看懂？","00215181030037731"),h));u.click(function(){$(this).text(ResManager.LoadKDString("已收到反馈","00215181030037794")).css("color","#BDBDBD");var e=t.getFormProxy();if(e){var i=t.config,a={};a.pageid=t.pageId||"",a.message=i.message||"",a.messagedetail=e.__lasttipsearchs&&e.__lasttipsearchs.urltitle||"",a.biztipsnumber=i.BizTipsNumber,a.eventname=KD.CONST.CustomEventName.KDErrorSolutionsUnStand,a.communitycode=i.CommunitySolutionCode,a.formid=t.getFormId()||"",e.fireCustomEvents(KD.CONST.CustomEventName.KDErrorSolutionsUnStand,KD.CONST.CustomEventName.KDErrorSolutionsUnStand,KD.stringify(a))}}),this.el.append(u)}if(this.config.detail&&this.config.detail.length>0||!KD.isEmpty(this.communitySolutionCode)){var p=$(kendo.format('<a id="{0}-ErrbtnDetails" href="javascript:void(null)" >'+ResManager.LoadKDString("展开详情","0991733000005640")+"</a>",e));p.click(function(){t.showPopDetails()}),n.append(p),this.useNewStyle&&n.append($('<span class="icon" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span>'))}else 0==n.children().length&&n.remove()},adjustPopContentStyle:function(e){KDPopupErrMessageProxy.superclass.adjustPopContentStyle.call(this,e),this.useNewStyle&&this.el.find('.kd-msg-title [role="message"]').css({"margin-right":"70px"})},handleStartAppForm:function(){if("BOS_HtmlConsoleMain"==this.formId&&KD.isStartAppVerify()&&ClientAppProxy&&ClientAppProxy.Current&&ClientAppProxy.Current.delayLoadData){var e=ClientAppProxy.Current.getAliveForm(ClientAppProxy.Current.delayLoadData);e&&e.loadData(),ClientAppProxy.Current.delayLoadData=null}}}),KDControlFactoryProxy.registerType("kdErrPopupMessage",KDPopupErrMessageProxy),define("KDPopupErrMessageProxy",["KDPopupMessageProxy","KD"],function(e){return function(){var t;return t||e.KDPopupErrMessageProxy}}(this)),KDIFrameProxy=KD.extend(KDControlProxy,{enableLoadCompleteEvent:!1,frameLoadComplete:!1,AdaptionFullBody:!1,_receiveMessageHandler:void 0,nodataTipObj:void 0,loadConfig:function(e){KDIFrameProxy.superclass.loadConfig.call(this,e);var t=this;this.frameLoadComplete=!1,t.enableLoadCompleteEvent=KD.getValue(e,"enableLoadCompleteEvent",!1),t._receiveMessageHandler=void 0,t.nodataTipObj=void 0;var i=this.getFrameName();if("kdwebbrowser"!=t.getConfig().xtype){var a="inhtml5=true&username="+ClientAppProxy.Current.CTX.UserName+"&locaid=2052";a+="&dbid="+ClientAppProxy.Current.CTX.DBid+"&token="+ClientAppProxy.Current.CTX.UserToken;a+="&aspnetsessionId="+KD.getAspNetSessionId();var n=t.innternelGetArgment();n&&n.length>0&&(a+="&"+n);var o=t.innternelGetUrl();o&&o.length>0&&(iframe=this.el.iframe=$("<iframe src='../Silverlight/IndexSL.aspx?"+a+"'></iframe>"),iframe.off("load").on("load",function(e){var i=$(t.contentDocument.body);i.css({height:"auto"});var a=i.innerHeight(),n=i.innerWidth();$(this).css({height:a,width:n,overflow:"hidden"}),t.enableLoadCompleteEvent&&t.frameLoadFinish.call(t,e)}),this.el.append(this.el.iframe))}else this.el.iframe=$('<iframe style="border:0px;"></iframe>'),this.el.append(this.el.iframe),this.source=KD.getValue(e,"source",""),this.setSource(this.source);this.el.iframe.attr("id",i),this.setAllowfullscreen(KD.getValue(e,"Allowfullscreen",!1))},getFrameName:function(){return this.getBaseId()+"-"+this.getKey()},innternelGetArgment:function(){return this.config.argment&&this.config.argment.length>0?this.config.argment:void 0},setAllowfullscreen:function(e){this.el.iframe&&this.el.iframe.attr("allowfullscreen",e)},setAdaptionFullBody:function(e){if(this.AdaptionFullBody=e,this.AdaptionFullBody){var t=KD.getWindowHeight();this.el&&this.el.parent().css("height",t),this.el&&this.el.parent().parent().css("height",t)}},setFrameData:function(e){this.frameData=e,this.frameLoadComplete&&(this.exeFrameFunc("initFrameData",this.frameData),this.frameData=null)},setNodataTips:function(e){if(KD.isObject(e)){var t=this;if(!this.nodataTipObj){var i=kendo.format('<div class="iframe-nodata-container"><div class="iframe-nodata"><div class="kd-icon"></div><div class="kd-text"></div><div class="kd-link-container"></div></div></div>');this.nodataTipObj=$(i),this.el.css({position:"relative"}).append(this.nodataTipObj)}var a=e.icon;if(!KD.isEmpty(a)){var n="url("+KD.getImageUrlByNameAndVersion(a)+")";this.nodataTipObj.find(".kd-icon").css({"background-image":n})}var o=e.textAlign||"center",r=e.text;KD.isEmpty(r)||(r=r.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"<br/>"),this.nodataTipObj.find(".kd-text").html(r).css({"text-align":o}));var s=this.nodataTipObj.find(".kd-link-container"),l=e.link;if(KD.isEmpty(l))s.hide();else{s.empty().show();var d=$(kendo.format('<div class="kd-link" eventKey="{0}">{1}</div>',KD.getValue(l,"key",""),KD.getValue(l,"text","")));s.append(d),d.on("click",function(){var e=$(this),i=e.attr("eventKey"),a=t.getFormProxy();a&&a.fireCustomEventsNoData.call(a,t.key,i,"")})}}else this.nodataTipObj&&this.nodataTipObj.hide()},initFrameDataDefault:function(){var e=this;KD.isEmpty(e.frameData)||(e.exeFrameFunc("initFrameData",e.frameData),e.frameData=null)},initFrameData:function(e){var t=this;t.frameData=e,t.initFrameDataDefault()},frameLoadFinish:function(e){var t=this;if(!this.frameLoadComplete&&this.frameData){var i=this.getFrameContext();if(!i||!i.initFrameData)return void KD.delayInvoke(function(){t.frameLoadFinish.call(t,e)},1e3);this.exeFrameFunc("initFrameData",this.frameData),this.frameData=null}var a=window.frames[this.getFrameName()];if(a&&a.contentWindow)try{a.contentWindow.KDFormProxy=this.getFormProxy(),a.contentWindow.KDIframeKey=this.getKey()}catch(e){this.frameLoadComplete=!0,KD.writeLog("frameLoadFinish",e.message,!0),a.KDFormProxy=this.getFormProxy(),a.KDIframeKey=this.getKey()}else a&&(a.KDFormProxy=this.getFormProxy(),a.KDIframeKey=this.getKey());this.frameLoadComplete=!0},initIframeEvents:function(e){var t=this,i=t.el.iframe;t.__initFrameHandler&&clearTimeout(t.__initFrameHandler),t.__initFrameHandler=setTimeout(function(){try{var e=$(i[0].contentWindow.document.body);KD.isIeBrowser()||e.click(function(e){t.simuIframEvents.call(t,e)})}catch(a){t.attachRootPanelClick.call(t),KD.writeLog("KDIFrameProxy.initIframeEvents~invoke()",a.message,!0)}},500)},attachRootPanelClick:function(){var e=this;try{$(document.body).off("click.KDIFrameProxy").on("click.KDIFrameProxy",function(){try{e.el.trigger("focusout")}catch(t){KD.writeLog("KDIFrameProxy.attachRootPanelClick~click.KDIFrameProxy()",t.message,!0)}})}catch(t){KD.writeLog("KDIFrameProxy.attachRootPanelClick()",t.message,!0)}},detachRootPanelClick:function(){try{$(document.body).off("click.KDIFrameProxy")}catch(e){KD.writeLog("KDIFrameProxy.detachRootPanelClick()",e.message,!0)}},simuIframEvents:function(e){var t=this,i=t.getFrameName();if("click"==e.type&&!t.isFocused){t.isFocused=!0,t.el.trigger("focus"),clearInterval(t.__focusMonoterHandler);var a=t.__focusMonoterHandler=setInterval(function(){var e=(document.activeElement||{}).id||"";KD.equalsIgnoreCase(i,e)||(t.isFocused=!1,t.el.trigger("focusout"),clearInterval(a))},800)}},getFrameContext:function(){var e=window.frames[this.getFrameName()],t=null;return t=e&&e.contentWindow?e.contentWindow:e},exeFrameFunc:function(e,t){var i=this.getFrameContext();if(KD.isArray(e)){var a=e[0],n=e[1];if(i&&a&&i[a])return void i[a](n)}i&&e&&i[e]?i[e](t):i&&i.initFrameData?i.initFrameData(t):KD.writeLog("KDIFrameProxy.exeFrameFunc()",KD.format("The Iframe not Load Complete, the function [{0}] is not found.",e),!0)},innternelGetUrl:function(){return this.config.url&&this.config.url.length>0?this.config.url:void 0},setSource:function(e,t){var i=this;if(e){var a=this.el.iframe.get(0);if(null!=a)try{KD.isDebug()||!KD.isEmpty(t)&&(KD.isEmpty(t)||1!=t)||(e=KD.getEncodeUrl(e));var n=e.toLowerCase();i._isInternalURl(n)&&(e=KD.getUrlRoot()+(e.startsWith("/")?e:"/"+e)),a.src=e}catch(o){}}i.source=e,i.enableLoadCompleteEvent&&i.el&&i.el.iframe?(i.frameLoadComplete=!1,i.el.iframe.off("load").on("load",function(e){i.frameLoadFinish.call(i,e)})):i.el&&i.el.iframe&&i.el.iframe.off("load").on("load",function(e){i.initIframeEvents.call(i,e)})},_isInternalURl:function(e){var t=!1;return t=!KD.IsNullOrWhiteSpace(e)&&!e.startsWith("k3cloud:")&&!e.startsWith("http://")&&!e.startsWith("https://")&&e.indexOf("html5")<=0&&e.indexOf("html5.7")<=0},setIsBrowserVisible:function(e){this.setVisible(e)},setIsBrowserClosed:function(e){null!=this.el&&$(this.el).remove()},getFormProxyPageId:function(){var e=this,t=e.getFormProxy();return t&&t.getPageId.call(t)||""},qingSetConfig:function(e){var t=this;e.selfpageid=t.getFormProxyPageId(),KD.QingDesktop();var i="";e.avatar&&(i="data:image/jpeg;base64,"+e.avatar,e.avatar=i),ClientAppProxy.Current.YunZhiJiaCosmicSysUserInfo=e,qing&&e&&!ClientAppProxy.Current.IsQingJSRegister&&(qing.register("getUserInfo",function(e){var t=ClientAppProxy.Current.YunZhiJiaCosmicSysUserInfo;e.success({success:!0,data:{oId:t.oId,eid:t.eid,avatar:t.avatar,userId:t.userId,userName:t.userName}})}),qing.register("getSsoToken",function(e){var i=t.getQingSsoToken("");e.success({success:!0,token:i})}),qing.register("getRuntimeConfig",function(e){var t=ClientAppProxy.Current.YunZhiJiaCosmicSysUserInfo;e.success({success:!0,saas:t.saas,language:t.language,appId:t.appId,systemId:"galaxy",style:{zIndex:2e4}})}),qing.register("getTransactionAuthCode",function(e){var i=e.data.widgetParams||{},a=t.getQingBillInfo(i.pageid);e.success({success:!0,authCode:a.authCode,billInfo:{billId:a.billId||"",billModelType:a.billModelType||"",billName:a.billName||"",billLink:KD.mergeUrl(KD.getUrlRoot(),a.billLink),creatorName:a.creatorName||"",creatorId:a.creatorId||"",createTime:a.createTime||"",createDate:a.createDate||""}})}),qing.register("callDesktop",function(i){var a=i.data;a.params.success=i.success,a.params.error=function(i){var a,n=t.QingBillInfo&&t.QingBillInfo.parentPageId||e.parentPageId;if(n){var o=ClientAppProxy.Current;a=o.getAliveForm.call(o,e.parentPageId)}a||(a=ClientAppProxy.Current.getRootForm()),"NOT_INSTALL"==i.errorCode?a&&a.showErrMsgStr.call(a,"云之家没安装"):i.success||a&&a.showErrMsgStr.call(a,"调用云之家失败："+i.code)},qing.call(a.apiName,a.params)}),ClientAppProxy.Current.IsQingJSRegister=!0),qing&&(ClientAppProxy.Current.IsQingJSRegister&&(qing.off("requestUserInfo"),qing.off("requestLoginCode")),qing.on("requestUserInfo",function(t){t({eid:e.eid,openId:e.oId})}),qing.on("requestLoginCode",function(e){var i=t.getYZJAppOpenCode()||"";e(i)}))},getQingSsoToken:function(e){var t=this,i=new KDRequest,a=ClientAppProxy.Current.getRootForm(),n="";return a?(i.serviceName=a.server.serviceName,i.url=a.server.url,i.scope=t,i.pageId=a.server.pageId,i.callback=function(e,t){a.onResponse.call(a,e,t),n=ClientAppProxy.Current.YunZhiJiaCosmicSsoToken||""},i.syncCall("CustomEvents","GetQingSSoToken","GetQingSSoToken","",null),n):e},getQingBillInfo:function(e){var t={},i=this,a=new KDRequest,n=i.getKey(),o=e?ClientAppProxy.Current.getAliveForm(e):i.getFormProxy();return o&&(a.serviceName=o.server.serviceName,a.url=o.server.url,a.scope=i,a.pageId=o.server.pageId,a.callback=function(e,i){o.onResponse.call(o,e,i);var a=o.controlFactoryProxy.getCmp(n);a&&(t=a.QingBillInfo||{})},a.syncCall("CustomEvents","GetQingBillInfo","GetQingBillInfo","",null)),t},getYZJAppOpenCode:function(){var e=this,t=new KDRequest,i=e.getFormProxy(),a=e.getKey(),n="";return i&&(t.serviceName=i.server.serviceName,t.url=i.server.url,t.scope=e,t.pageId=i.server.pageId,t.callback=function(e,t){i.onResponse.call(i,e,t);var o=i.controlFactoryProxy.getCmp(a);o&&(n=o.YZJAppOpenCode||"")},t.syncCall("CustomEvents","GetYZJAppOpenCode","GetYZJAppOpenCode","",null)),n},setQingBillInfo:function(e){this.QingBillInfo=e},setYZJAppOpenCode:function(e){this.YZJAppOpenCode=e},release:function(){var e=this;e.detachRootPanelClick(),e.releasePostMessage(),KDIFrameProxy.superclass.release.call(e)}}),function(e){e.extend(KDIFrameProxy.prototype,{setEnablePostMessage:function(t){t?this._receiveMessageHandler||(this._receiveMessageHandler=e.proxy(this._receiveMessageHandlerCore,this),window.addEventListener("message",this._receiveMessageHandler)):this.releasePostMessage()},_receiveMessageHandlerCore:function(e){this.onReceiveMessage(e.data)},postMessage:function(e){var t=this.getFrameContext();if(t&&t.postMessage){var i=KD.isString(e)?e:KD.stringify(e);t.postMessage({data:i},"*")}},onReceiveMessage:function(e){if(e){var t=this,i=KD.isString(e)?e:KD.stringify(e),a=this.getFormProxy();if(a){var n=KD.parseObject(e),o=n.pageid,r=!0,s=this.getPageId();if(o&&o!=s)r=!1;else{var l=ClientAppProxy.Current.getMainTab(),d=l&&l._getTabItemIndexbyAnyFormKey&&l._getTabItemIndexbyAnyFormKey.call(l,s,"item");d&&d.contentHeadEL&&d.contentHeadEL.hasClass&&!d.contentHeadEL.hasClass("k-state-active")&&(r=!1)}r&&a.fireCustomEventsNoData.call(a,t.key,KD.CONST.CustomEventName.WebbrowserMessage,i)}}},releasePostMessage:function(){this._receiveMessageHandler&&window.removeEventListener("message",this._receiveMessageHandler)}})}(jQuery),KDControlFactoryProxy.registerType("kdurlform",KDIFrameProxy),KDControlFactoryProxy.registerType("kdwebbrowser",KDIFrameProxy),define("KDIFrameProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDIFrameProxy}}(this)),function(e){KDInfoPanelProxy=e.extend(KDContainerProxy,{itemsRef:[],isLayoutEditor:!1,createControl:function(e){KDInfoPanelProxy.superclass.createControl.call(this,e);var t=e.backcolor||"";e.background=e.background||"",e.background&&(t=e.background),-1!=t.indexOf("#")&&9==t.length&&(t="#"+t.substr(3,t.length-1)),t&&t.length>1&&this.el.css("background-color",t),this.el.addClass("kdinfopanel")},release:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.release&&t.release.call(t),this.controlFactoryProxy.removeProxyInstance(t.key)}KDInfoPanelProxy.superclass.release.call(this)},loadConfig:function(e){var t=this;t.el.attr("data-kdid",t.baseId);var i=t.el.width();t.children||(t.children=[]);var a=e.children;for(var n in a){var o=a[n];i-=o.width}if(t.loadLayout(e,i),null!=a&&t.controlFactoryProxy){var r=t.el.height(),s=t.el.width();for(var n in a){var o=a[n];o.row||(o.row=0),o.col||(o.col=0);var l=t.controlFactoryProxy.createControl(o),d=t.getPositionId(o.row,o.col);l.positionKey=d,t.positionChildren(l,r,s),t.itemsRef.length>0&&l.setItemsRef(t.itemsRef),l.loadConfig(o),t.children.push(l),l.initchildren.call(l),r-=l.el.height(),s-=l.el.width()}}},positionChildren:function(e,t,i){var a=this,n=a.layoutGrid,o=e.positionKey,r=$("#"+o,n),s=r.height(),l={position:"relative"};s?$.extend(l,{height:s+"px"}):$.extend(l,{height:t+"px"});var d=r.width();s?$.extend(l,{width:d+"px"}):$.extend(l,{width:i+"px"}),e.el.css(l),e.el.appendTo(r)},loadLayout:function(e,t){var i=this;i.fw=i.el,i.fw.empty(),i.fw.css({height:"inherit",width:"100%",position:"relative"});var a='<table style="height:100%;width:100%;position:relative;" cellspacing="0" cellpadding="0"><tbody>',n={};if(i.emptyKvp={},e.children){for(var o=0;o<e.children.length;o++){var r=e.children[o],s=i.getPositionId(r.row,r.col);n[s]=r}for(var l=0;l<e.rows;l++){for(var d="<tr>",c=0;c<e.cols;c++){var s=i.getPositionId(l,c),r=n[s];if(r){r.width=r.width||"*",r.height=r.height||"*";var h=r.width.indexOf("*")>=0?r.width.replace("*","%"):r.width+"px";h&&"100%"!=h||(h="");var u=r.height.indexOf("*")>=0?r.height.replace("*","%"):r.height+"px";u&&"100%"!=u||(u=i.el.height()+"px");var p="";u&&"%"!=u&&(p+="height:"+u+";"),h&&"%"!=h&&(p+="width:"+h+";"),i.isLayoutEditor&&(p+="border:1px blue;border-style:solid;"),d+='<td id="'+s+'"'+(p?' style="'+p+'"':"")+"></td>"}else d+='<td id="'+s+'"></td>',i.emptyKvp[s]=s,i.emptyKvp.length=(i.emptyKvp.length||0)+1}d+="</tr>",a+=d}}a+="</tbody></table>",i.layoutGrid=$(a),i.layoutGrid.appendTo(i.fw);var g=i.emptyKvp.length?t/i.emptyKvp.length:0;if(g)for(var r in i.emptyKvp)$("#"+r,i.layoutGrid).css({width:g})},doLayout:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e],i=t.el.parent();if(i&&i.length){var a=i.height();t.el.css({height:a+"px",position:"relative"})}}},setItemsRef:function(e){this.isLayoutEditor=!0,this.itemsRef=e},getPositionId:function(e,t){var i=this,a=i.baseId+"_R"+e+"C"+t;return a}}),KDControlFactoryProxy.registerType("KDInfoPanel",KDInfoPanelProxy)}(KD),function(e){KDInfoItemProxy=e.extend(KDPanelProxy,{itemsRef:[],createControl:function(e){KDInfoItemProxy.superclass.createControl.call(this,e);var t=e.backcolor||"";e.background=e.background||"",e.background&&(t=e.background),-1!=t.indexOf("#")&&9==t.length&&(t="#"+t.substr(3,t.length-1)),t&&t.length>1&&this.el.css("background-color",t),this.el=this.el.KDInfoItem()},onReady:function(){},release:function(){this.controlFactoryProxy.removeProxyInstance(this.key),KDInfoPanelProxy.superclass.release.call(this)},setItemsRef:function(e){this.itemsRef=e,this.isLayoutEditor=!0},loadConfig:function(e){var t=this;if(e.isUrl)return void t.loadConfigUrl(e);var i=e.formid;e.formtype||"",e.pageId||"";if(t.itemsRef.length>0)for(var a=0;a<t.itemsRef.length;a++){var n=t.itemsRef[a];if(n.id==i){var o=$("<div></div>");o.css({"background-image":"url('../"+n.icon+"')",width:"100%",height:"100%","background-size":"100% 100%","background-repeat":"no-repeat"}),t.el.append(o);var r="区域大小：<br />";r+=t.el.width()+"x"+t.el.height(),o.append($("<div style='text-align: center;padding-top:"+t.el.height()/2+"px;color:blue;'>"+r+"</div>"));break}}else{var s=this.controlFactoryProxy.getParentFormProxy();if(!this.formLoaded){var l=[{id:t.key,formid:i,paramformid:e.paramformid,ishideprogressindicator:e.ishideprogressindicator}];s.fireCustomEventsNoData("FInfoPanelContainer","LoadInfoForms",JSON.stringify(l)),this.formLoaded=!0}}},addDynamicForm:function(e){KDInfoPanelProxy.superclass.addDynamicForm.call(this,e)},loadConfigUrl:function(e){var t=this,i=t.getBaseId()+"_iframe",a=e.url;t.waitingEl=t.waiting(function(){t.layoutpanel=$('<iframe id="'+i+'" src="'+a+'">'),t.layoutpanel.appendTo(t.getControl())},t),t.layoutpanel.bind("load",function(){t.waitingEl&&t.waitingEl.remove()})}}),KDControlFactoryProxy.registerType("KDInfoItem",KDInfoItemProxy)}(KD),function(e){e.fn.KDInfoItem=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDInfoItem.prototype,e.fn.KDControlBase.defaults,e.fn.KDInfoItem.defaults,t);return this.fw=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.fw.addClass("kdinfoitem"),this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDInfoItem.prototype={getType:function(){return"KDInfoItem"},getContent:function(){return this.layoutpanel},getDebugWebsite:function(){return"#"},waiting:function(t,i){var a=this,n=e('<div class="loading-indicator-overlay" style="left: 0px; top: 0px; width: 350px; height: 200px; position: releative; z-index: 5000;"><img src="../'+KD.getSubPath().toUpperCase()+'/content/themes/images/ui_loading.gif"></img></div>');return n.ready(function(){t&&t.call(i)}),n.appendTo(a.fw),n},loadConfig:function(e){},loadConfigIfram:function(t){var i=this,a=i.getBaseId()+"_iframe",n=t.formid,o=t.formtype||"",r=t.pageId||"",s=KD.getFormUrl(n,o,r);t.url=s,i.waiting=e('<div class="loading-indicator-overlay" style="left: 0px; top: 0px; width: 350px; height: 200px; position: releative; z-index: 5000;"><img src="../'+KD.getSubPath().toUpperCase()+'/content/themes/images/ui_loading.gif"></img></div>'),i.waiting.appendTo(i.fw),i.waiting.ready(function(){i.layoutpanel=e('<iframe id="'+a+'" src="'+s+'">'),i.layoutpanel.appendTo(i.fw)}),i.layoutpanel.bind("load",function(){i.waiting.remove()})}},e.fn.KDInfoItem.defaults={isMain:!1,metaHtml:"",defaults:{}}}(jQuery),define("KDInfoPanelProxy",["KDPanelProxy","KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDInfoPanelProxy}}(this)),KDHeadPanelProxy=KD.extend(KDContainerProxy,{isLeftFloatPanel:!1,stackorientation:0,minwidth:0,setmaxwidthbyelement:"",minwidthforie:0,createControl:function(e){KDHeadPanelProxy.superclass.createControl.call(this,e),this.el=this.el.KDPanel(),this.setStyle(e.style)},setStyle:function(e){var t=e;if(1==e)t="LeftHeadPanel";else if(2==e)t="TopHeadStackLayoutStyle";else if(3==e)return this.isLeftFloatPanel=!0,"RightHeadPanel";this.el.addClass(t)},getStyle:function(){var e=this.config?this.config.Style||"":"";return 1==e?"LeftHeadPanel":2==e?"TopHeadStackLayoutStyle":3==e?"RightHeadPanel":e},loadChildren:function(e){this.stackorientation=KD.getValue(e,"stackorientation",0),this.minwidth=KD.getValue(e,"minwidth",0),this.setmaxwidthbyelement=KD.getValue(e,"setmaxwidthbyelement",""),this.minwidthforie=KD.getValue(e,"minwidthforie",0);var t=this;t.children||(t.children=[]);var i=1==this.stackorientation?t.isLeftFloatPanel?4:0:-1,a=e.items;if(null!=a&&t.controlFactoryProxy)for(var n=a.length-1;n>=0;n--){var o=a[n],r=t.controlFactoryProxy.createControl(o),s=r.getControl();s.css({"float":"right",display:"inline-block"}),o.dock=-1==i?o.dock:i,s.dock=o.dock,t.el.addControl(s),r.loadConfig(o),t.children.push(r),i>-1&&r.el.css({left:"",position:"relative",width:"auto"})}this.initchildren();var l=t.getChildrenTotalSize();e.width=l.width;var d=t.minwidth>0?t.minwidth+"px":"";this.el.css({"float":"right",position:"relative",width:"100%","min-width":d,"text-algin":"right","overflow-x":"auto","white-space":"nowrap"}),KD.isEmpty(this.el.attr("tabindex"))&&this.el.attr("tabindex","-1"),KD.delayInvoke(function(e){t.doLayout()},1e3)},getChildrenTotalSize:function(){for(var e=this,t=0,i=0,a=0;a<e.children.length;a++){var n=e.children[a].getControl();n.is(":visible")&&(t+=n.outerWidth(!0),i+=n.outerHeight(!0))}return{width:t,height:i}},doLayout:function(){var e=this;if(KDHeadPanelProxy.superclass.doLayout.call(this),!KD.isEmpty(e.setmaxwidthbyelement)){var t=e.getFormProxy(),i=t&&t.baseId,a=!KD.isEmpty(i)&&kendo.format("{0}-{1}",i,e.setmaxwidthbyelement),n="",o=0;if(!KD.isEmpty(a)){var r=$("#"+a);r&&r.length&&(o=r.width()+5,n=kendo.format("calc(100% - {0}px)",o),this.el.css({"max-width":n}));var s=this.getChildrenTotalSize(),l=this.el.find(".kd_top_k3cloud_org .HeadMenuSplitButtonStyle");if(s.width>this.el.width()){var d=s.width-this.el.width()-1;1>d&&(d=0);var c=kendo.format("calc(100% - {0}px)",d);l.css("max-width",c)}else l.css("max-width","none")}}}}),KDHeadPanelProxy.isHeadPanel=function(e){return"headpanel"==e||"richstackpanel"==e},KDControlFactoryProxy.registerType("headpanel",KDHeadPanelProxy),KDControlFactoryProxy.registerType("richstackpanel",KDHeadPanelProxy),define("KDHeadPanelProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDHeadPanelProxy}}(this)),function(e){function t(){var e=void 0;try{e=ClientAppProxy.Current.getRootForm();for(var t in ClientAppProxy.Current.aliveForms){var i=ClientAppProxy.Current.aliveForms[t];if(i&&KD.isFunction(i.getFormId)&&KD.equalsIgnoreCase(i.getFormId.call(i),"BOS_HtmlConsoleMain")){e=i;break}}}catch(a){KD.writeLog(a.message,"",!0)}return e}function i(e){try{var i=e.keyCode||e.which||e.charCode;if(e&&e.shiftKey&&e.ctrlKey&&(83==i||KD.equalsIgnoreCase(e.key,"S"))){KD.stopPropagation(e);var a=t();a&&a.onDynamicFormKeyDown&&a.onDynamicFormKeyDown.call(a,e)}}catch(n){KD.writeLog(n.message,"",!0)}}e.fn.KDForm=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDForm.prototype,e.fn.KDControlBase.defaults,e.fn.KDForm.defaults,t);return i.el=e('<div dfom="el"></div>'),e(document.body).append(i.el),this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDForm.prototype={loadConfig:function(e){var t=this;t.title=e.billTitle,t.formConfig=e,t.titlevisible=KD.getValue(e,"titlevisible",!0),t.isCurrentFormModel=KD.getValue(e,"showType",void 0)==KDDynamicFormShowType.ModalInCurrentForm,t.ShowHideForm=KD.getValue(e,"ShowHideForm",!1),t.ActiveVerifyBannerTipFrom=KD.getValue(e,"activeVerifyBannerTip",!1),t.HiddenCloseButton=KD.getValue(e,"hiddenclosebutton",!1),t.Hiddencollapsebutton=KD.getValue(e,"hiddencollapsebutton",!0),t.dformWidth=e.width,t.dformHeight=e.height},getOuterHeight:function(e){var e=parseFloat(e);return e=KD.isNaN(e)?0:e,e+4+1.32*KD.getCurrentFontsize()},getOuterWidth:function(e){var e=parseFloat(e);return e=KD.isNaN(e)?0:e,e+1.18*KD.getCurrentFontsize()},getSizeExtPixel:function(){return 8},getOriginalZindex:function(){var e=0;return this.elDialog&&this.elDialog.wrapper&&(e=this.elDialog.wrapper.attr("originalZindex"),e=parseInt(e),KD.isNaN(e)&&(e=0)),e},setWindowTitle:function(e){this.title=e,this.elDialog&&this.elDialog.title&&this.elDialog.title(e)},setWindowWH:function(e,t){var i=this,a=parseFloat(e);a=KD.isNaN(a)?0:a;var n=parseFloat(t);n=KD.isNaN(n)?0:n,e&&(i.dformWidth=a),t&&(i.dformHeight=n),i.childFormCt.css({height:i.dformHeight,width:i.dformWidth});var o={height:i.dformHeight,width:i.dformWidth+2};i.data("kendoWindow").setOptions({width:o.width,minWidth:o.width,height:o.height,minHeight:o.height})},setWindowFloatTarget:function(t,i){var a=this,n=t?e(t).offset():void 0;if(n){var o=e(document.body).height()/2,r=e(document.body).width()/2,s=e(t).width(),l=t.height(),d=a.dformWidth;if(this.elDialog&&this.elDialog.wrapper&&this.elDialog.wrapper.outerWidth&&(d=this.elDialog.wrapper.outerWidth()),i){var c=i.position;if("left"==c){var h=KD.getBillHeadHeight();n.top=n.top<=h?h:n.top,s=0,l=0}}n.left>r&&(n.left=n.left-d+s,n.top=n.top+l),n.top>o&&(n.top=n.top-a.dformHeight),a.elDialog&&a.elDialog.wrapper.css({left:n.left+"px",top:n.top+"px"})}},toFront:function(){this.elDialog&&this.elDialog.toFront&&this.elDialog.toFront(),this.elDialog.wrapper.attr({originalZindex:this.elDialog.wrapper.css("z-index")})},hide:function(e){var t=this;if(t.proxy&&!e){var i=t.proxy.childForm;if(i){i.ishide=!0;var a=i.getControlFactoryProxy.call(i);for(var n in a.forms){var o=a.forms[n],r=o?o.dformConfig:void 0;if(r&&o&&r.parentPageId==i.pageId&&1!=o.ishide)return}}}t.isSelfTrigger=!0,t.collapseStateEl&&t.collapseStateEl.hide(),t.elDialog&&t.elDialog.close&&t.elDialog.close(),t.isSelfTrigger=!1},hideWindow:function(e){this.hide(e)},showWindow:function(t){this.elDialog&&this.elDialog.wrapper&&e(this.elDialog.wrapper).is(":visible")||this.show(void 0,{},t||this.isKeepInCache())},isKeepInCache:function(){var e=this;return e.childForm&&e.childForm.dformConfig&&e.childForm.dformConfig.keepInCache},setIsSpecialForm:function(e){this.isSpecialForm=e},getIsSpecialForm:function(){return 1==this.isSpecialForm},remove:function(){var t=this;t.elDialog.close(),t.removeCollapseStateEl(),KD.delayInvoke(function(){var i=t.parent();i.remove(),e("div[dfom='el']").remove()},200)},closeWindow:function(){this.hide()},isVerifyDialogFormTip:function(){return ClientAppProxy.Current.ActiveVerifyBannerTip||this.ActiveVerifyBannerTipFrom},resizeFormCtSize:function(){var e=this;this.proxy&&(this.proxy.config.isFormSizeChanged=!0);var t={height:e.height()-e.getSizeExtPixel(),width:e.width()-e.getSizeExtPixel()};e.childFormCt.css(t);
},addDynamicForm:function(t){var i=this;void 0==i.childFormCt&&(i.childFormCt=e('<div dfrom="childFormCt">')),t.appendTo||(t=t.el),t.appendTo(i.childFormCt),i.childFormCt.appendTo(i),KD.isFunction((ClientAppProxy.Current||{}).setWatermark)&&ClientAppProxy.Current.setWatermark({el:i.childFormCt})},LoadDynamicFormByParemeter:function(e,t){var i=this,a=i._childFormProxy=new KDDynamicFormProxy;a.setHostWindowProxy.call(a,this),a.createControl.call(a);var n=a.getControl.call(a);i.addDynamicForm(n),a.loadByParaObject.call(a,e,t)},removeModalformOverlay:function(){var e=this;e.modalformOverlay&&e.modalformOverlay.remove()},showDialog:function(t,i){var a=this,n=a.formConfig&&a.formConfig.sizetocontent,o={height:a.getOuterHeight(a.dformHeight)-a.getSizeExtPixel(),width:a.getOuterWidth(a.dformWidth)-a.getSizeExtPixel()},r={height:a.dformHeight,width:a.dformWidth};switch(n){case KD.CONST.FormSizeToContent.Manual:break;case KD.CONST.FormSizeToContent.Width:o.width="auto",r.width="auto";break;case KD.CONST.FormSizeToContent.Height:o.height="auto",r.height="auto";break;case KD.CONST.FormSizeToContent.WidthAndHeight:o={height:"auto",width:"auto"},r={height:"auto",width:"auto"}}a.childFormCt.css(r);var s=a.titlevisible;s&&this.formConfig&&this.formConfig.IsGrandTitle&&(s=!1);var l=this._actionDialogBtnsForm(),d={actions:l,title:s?a.title:!1,height:o.height,minHeight:o.height,width:o.width,minWidth:o.width,resizable:KD.getValue(t,"resizable",!0),modal:!1,visible:a.ShowHideForm?!1:!0,autoFocus:!1,beforeclose:function(e){return a.close&&a.close(),!1},close:function(i){a.removeModalformOverlay(),a.removeCollapseStateEl(),t&&t.closeback&&e.isFunction(t.closeback)&&t.closeback(a),a.closeback&&e.isFunction(a.closeback)&&a.closeback.call(a)},resize:function(){a.resizeFormCtSize.call(a),t&&t.resizeStop&&t.resizeStop.call(a)},resizeEnd:function(e){if(!KD.isHtml5Index()){var t=ClientAppProxy.Current.rootForm.el.height()-10,i=ClientAppProxy.Current.rootForm.el.width()-10,a=parseFloat(this.wrapper.css("top")),n=parseFloat(this.wrapper.css("left")),o=this.wrapper.height(),r=this.wrapper.width();(a+o>t||n+r>i)&&KD.CONST.IsBillHeadFloat?this.wrapper.addClass("kd-dynamicform-fixed"):this.wrapper.removeClass("kd-dynamicform-fixed")}},dragend:function(){if(!KD.isHtml5Index()){var e=ClientAppProxy.Current.rootForm.el.height()-15-72,t=ClientAppProxy.Current.rootForm.el.width()-35,i=parseFloat(this.wrapper.css("top")),a=parseFloat(this.wrapper.css("left"));i>e&&(this.wrapper.css({top:e}),this.options&&this.options.position&&(this.options.position.top=e)),a>t&&(this.wrapper.css({left:t}),this.options&&this.options.position&&(this.options.position.left=t));var n=this.wrapper.height(),o=this.wrapper.width();(i+n>e+72||a+o>t+25)&&KD.CONST.IsBillHeadFloat?this.wrapper.addClass("kd-dynamicform-fixed"):this.wrapper.removeClass("kd-dynamicform-fixed")}},deactivate:function(){a._deactivateFocusForm()},collapseBtnClick:function(){a.collapseDialogForm()}};if(t&&KD.apply(d,t),i&&a.elDialog&&a.elDialog.open){a.elDialog.setOptions(d);var c=a.collapseStateEl&&a.collapseStateEl.is(":visible");c||a.elDialog.center(),c?a.collapseStateEl.show():a.elDialog.open()}else a.kendoWindow(d),a.elDialog=a.data("kendoWindow"),a.elDialog.center(),a.removeCollapseStateEl();a.modalformOverlay=e('<div class="kd-overlay kd-FormDialog" style="z-index: 1000; opacity: 0.5;"></div>'),e("body").append(a.modalformOverlay),e(".k-header a[aria-label='Close']",a.elDialog.wrapper).attr({href:"javascript:void(0);"}).click(function(e){if(d.beforeclose){var t=d.beforeclose();t||e.stopPropagation()}}),e(".k-header a[aria-label=Collapsebtn]",a.elDialog.wrapper).attr({href:"javascript:void(0);"}).click(function(e){dialogOpts.collapseBtnClick&&(dialogOpts.collapseBtnClick(),e.stopPropagation())}),a._adjustFormLayout(!0)},show:function(t,i,a){var n=this;i=i||{};var o=t&&t.offset?t.offset()||{left:0,top:0}:void 0;if(o&&i.Placement){var r=t.height(),s=t.width();switch(i.Placement){case KD.CONST.FloatingPlacementType.BottomLeftToRight:o.left+n.dformWidth>e(document.body).width()&&(o.left=o.left+s-n.dformWidth+20),o.top+=r;break;case KD.CONST.FloatingPlacementType.BottomRightToLeft:o.top+=r,o.left=o.left+s-n.dformWidth}}else if(o){var l=e(document.body).height()/2,d=e(document.body).width()/2;o.left>d&&(o.left=o.left-n.dformWidth+e(t).width(),o.top=o.top+t.height()),o.top>l&&(o.top=o.top-n.dformHeight)}var c={height:n.getOuterHeight(n.dformHeight)-n.getSizeExtPixel(),width:n.getOuterWidth(n.dformWidth)-n.getSizeExtPixel()},h=!0;c.height>document.documentElement.clientHeight&&(c.height=document.documentElement.clientHeight,h=!1),c.width>document.documentElement.clientWidth&&(c.width=document.documentElement.clientWidth,h=!1),n.childFormCt.css({height:n.dformHeight,width:n.dformWidth});var u=n.titlevisible;u&&this.formConfig&&this.formConfig.IsGrandTitle&&(u=!1);var p=this._actionDialogBtnsForm(),g={actions:p,title:u?n.title:!1,height:c.height,minHeight:c.height<this.formConfig.metaHeight?c.height:this.formConfig.metaHeight,width:c.width,minWidth:c.width<this.formConfig.metaWidth?c.width:this.formConfig.metaWidth,resizable:KD.getValue(i,"resizable",!0),modal:!1,isCurrentFormModel:n.isCurrentFormModel||!1,visible:n.ShowHideForm?!1:!0,autoFocus:!1,animation:{close:{effects:"fade:out"}},beforeclose:function(e){return n.close&&n.close(),!1},close:function(t){n.removeModalformOverlay(),n.removeCollapseStateEl(),n.isSelfTrigger||(i&&i.closeback&&e.isFunction(i.closeback)&&i.closeback(n),n.closeback&&e.isFunction(n.closeback)&&n.closeback.call(n))},resize:function(e,t){n.resizeFormCtSize.call(n),i&&i.resizeStop&&i.resizeStop.call(n)},resizeEnd:function(e){if(!KD.isHtml5Index()){var t=ClientAppProxy.Current.rootForm.el.height()-10,i=ClientAppProxy.Current.rootForm.el.width()-10,a=parseFloat(this.wrapper.css("top")),n=parseFloat(this.wrapper.css("left")),o=this.wrapper.height(),r=this.wrapper.width();(a+o>t||n+r>i)&&KD.CONST.IsBillHeadFloat?this.wrapper.addClass("kd-dynamicform-fixed"):this.wrapper.removeClass("kd-dynamicform-fixed")}},dragend:function(){if(!KD.isHtml5Index()){var e=ClientAppProxy.Current.rootForm.el.height()-15-72,t=ClientAppProxy.Current.rootForm.el.width()-35,i=parseFloat(this.wrapper.css("top")),a=parseFloat(this.wrapper.css("left"));i>e&&this.wrapper.css({top:e}),a>t&&this.wrapper.css({left:t});var n=this.wrapper.height(),o=this.wrapper.width();(i+n>e+72||a+o>t+25)&&KD.CONST.IsBillHeadFloat?this.wrapper.addClass("kd-dynamicform-fixed"):this.wrapper.removeClass("kd-dynamicform-fixed"),KD.isIeBrowser()&&this.wrapper.focus()}},open:function(){},deactivate:function(){n._deactivateFocusForm()},collapseBtnClick:function(){n.collapseDialogForm()}};void 0!==i.title&&(g.title=i.title),i.modal&&(g.modal=i.modal),o&&(g.position={left:o.left,top:o.top});var f=!0;if(g.isCurrentFormModel){var m=n.proxy&&n.proxy.getFormProxy();m&&(n.modalformOverlay=e('<div class="kd-overlay kd-FormDialog" style="position: absolute; z-index: 10001; opacity: 0.5;"></div>'),f=!1,m.el.append(n.modalformOverlay))}if(a&&n.elDialog&&n.elDialog.open){delete g.width,delete g.height,n.initNLPDialogOpts(g),n.elDialog.setOptions(g);var v=n.collapseStateEl&&n.collapseStateEl.is(":visible");KD.isEmpty(g.position)&&!v&&n.elDialog.center(),v?n.collapseStateEl.show():n.elDialog.open()}else n.initNLPDialogOpts(g),n.kendoWindow(g),n.elDialog=n.data("kendoWindow"),KD.isEmpty(g.position)&&n.elDialog.center(),n.removeCollapseStateEl();e(".k-header a[aria-label=Close]",n.elDialog.wrapper).attr({href:"javascript:void(0);"}).click(function(e){if(g.beforeclose){var t=g.beforeclose();t||e.stopPropagation()}}),e(".k-header a[aria-label=Collapsebtn]",n.elDialog.wrapper).attr({href:"javascript:void(0);"}).click(function(e){g.collapseBtnClick&&(g.collapseBtnClick(),e.stopPropagation())}),h||n.el.css("overflow","auto"),KD.isIeBrowser()&&n.elDialog.wrapper.focus(),n._adjustFormLayout(!1,f)},_actionDialogBtnsForm:function(){var e=this,t=[];return e.Hiddencollapsebutton||t.push("Collapsebtn"),e.ShowHideForm&&t.push("Minimize"),e.ShowMaxButton&&t.push("Maximize"),e.HiddenCloseButton||t.push("Close"),t},updateCollapseStatesByFieldKey:function(e){if(!KD.isEmpty(e)){var t=this;if(this.verifyFormCollapseData){for(var i=0,a=this.verifyFormCollapseData.length,n=0;a>n;n++)if(this.verifyFormCollapseData[n].key==e){i=n;break}t.setVerifyFormCurrentIndex(i),t._updateCollapseFieldInfo(this.verifyFormCollapseData[i],i)}}},_updateCollapseFieldInfo:function(e,t){if(this.collapseStateEl){if(KD.isEmpty(e))return;t=KD.isEmpty(t)?0:t;var i=this,a=this.verifyFormCollapseData&&this.verifyFormCollapseData.length||0,n=e.name||"",o=i.collapseStateEl.find(".kd-collapsefrom-field-text");o.text(n),o.attr("title",n),i.collapseStateEl.find(".kd-collapsefrom-explanation").text(e.isNavigatable?this.locatableTipsText:this.unLocatableTipsText);var r=kendo.format("{0}/{1}",t+1,a);i.collapseStateEl.find(".kd-collapse-fieldCount").text(r)}},setCollapseDialogFormData:function(e){if(KD.isArray(e)){var t=this;t.verifyFormCollapseData=e,t.removeCollapseStateEl(),t.elDialog.open(),t.setVerifyFormCurrentIndex(0)}},setVerifyFormCurrentIndex:function(e){if(KD.isNumber(e)){var t=this;t.verifyFormCurrentIndex=e}},collapseDialogForm:function(){function t(){var e=o[i.verifyFormCurrentIndex].isNavigatable;i._updateCollapseFieldInfo(o[i.verifyFormCurrentIndex],i.verifyFormCurrentIndex);var t=ClientAppProxy.Current.getAliveForm(o[i.verifyFormCurrentIndex].pageId);e&&t.NavigateToField.call(t,o[i.verifyFormCurrentIndex])}var i=this,a=i.proxy&&i.proxy.getFormProxy();if(!KD.isEmpty(i.elDialog)){var n=function(e){e.originalEvent.dataTransfer.dropEffect="move",e.preventDefault()};if(!i.collapseStateEl){var o=i.verifyFormCollapseData||[];this.locatableTipsText=ResManager.LoadKDString("该字段支持定位","00215181000004707"),this.unLocatableTipsText=ResManager.LoadKDString("该字段需要您手动查找","00215181000008474"),i.verifyFormCurrentIndex=i.verifyFormCurrentIndex||0;var r=o.length,s=o[i.verifyFormCurrentIndex]&&o[i.verifyFormCurrentIndex].isNavigatable?this.locatableTipsText:this.unLocatableTipsText;i.collapseStateEl=e(kendo.format("<div class='kd-form-collapse-container' draggable='true'><div><span class='kd-arrow arrow-left'></span><span class='kd-collapsefrom-field-text' title='{0}'>{0}</span><span class='kd-collapse-fieldCount'>{4}/{3}</span><span class='kd-arrow arrow-right'></span><span class='kd-collapsefrom-expand'  style= 'background-image:url({1});'></span></div><div class='kd-collapsefrom-explanation'>{2}</div></div>",o[i.verifyFormCurrentIndex]&&o[i.verifyFormCurrentIndex].name,KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),s,r,i.verifyFormCurrentIndex+1)),i.collapseStateEl.find(".kd-collapsefrom-expand").click(function(){i.collapseStateEl.hide(),i.elDialog&&i.elDialog.wrapper.show(),e("body").off("dragover",n),a&&a.fireCustomEvents.call(a,null,"WindowExpand",null)}),i.collapseStateEl.find(".arrow-left").click(function(){0!=r&&(0==i.verifyFormCurrentIndex?i.setVerifyFormCurrentIndex(r-1):i.setVerifyFormCurrentIndex(i.verifyFormCurrentIndex-1),t())}),i.collapseStateEl.find(".arrow-right").click(function(){0!=r&&(i.verifyFormCurrentIndex==r-1?i.setVerifyFormCurrentIndex(0):i.setVerifyFormCurrentIndex(i.verifyFormCurrentIndex+1),t())}),i.collapseStateEl.find(".kd-collapsefrom-field-text").click(function(){var e=ClientAppProxy.Current.getAliveForm(o[i.verifyFormCurrentIndex].pageId),t=o[i.verifyFormCurrentIndex].isNavigatable;t&&e.NavigateToField.call(e,o[i.verifyFormCurrentIndex])});var l={top:0,left:0};i.collapseStateEl.on("mousedown",function(e){l.top=e.pageY-this.offsetTop,l.left=e.pageX-this.offsetLeft}),i.collapseStateEl.on("dragend",function(t){var a=t.pageY-l.top,n=t.pageX-l.left,o=e(this).width(),r=e(this).height();0>a?a=0:a+r>document.documentElement.clientHeight&&(a=document.documentElement.clientHeight-r),0>n?n=0:n+o>document.documentElement.clientWidth&&(n=document.documentElement.clientWidth-o),i.collapseStateEl.css({top:a,left:n})});var d=i.elDialog.wrapper.offset();d.left=d.left+i.elDialog.wrapper.width()-120,i.collapseStateEl.css(d),e("body").append(i.collapseStateEl),e("body").on("dragover",n)}i.elDialog.wrapper.hide(),i.collapseStateEl.show(),a&&a.fireCustomEvents.call(a,null,"WindowCollapse",null)}},removeCollapseStateEl:function(){var e=this;e.collapseStateEl&&(e.collapseStateEl.remove(),e.collapseStateEl=null)},_deactivateFocusForm:function(){var t=this;if(t.elDialog&&t.elDialog.wrapper){var i=t.elDialog.wrapper.siblings(".k-window");i.length<=0&&(i=e("body").find(".k-window"));var a=t.getdynamicFormCount(i),n=function(t,i){return e(t).attr("originalZindex")-e(i).attr("originalZindex")};i=i.filter(function(t){return e(this).is(":visible")}),i.sort(n);var o=i.last();a>=2&&(i.removeClass("kd-dynamicform-active"),o.addClass("kd-dynamicform-active")),o.find(".kd-floatingautohide").length>0&&o.find(".kd-floatingautohide").focus()}},_adjustFormLayout:function(t,i){var a=this;if(void 0==i&&(i=!0),a.elDialog&&a.elDialog.wrapper){a.elDialog.wrapper.attr({originalZindex:a.elDialog.wrapper.css("z-index"),tabindex:"-1"}),a.isNLPSearchForm()&&a.elDialog.wrapper.addClass("KD_NLP_SEARCH_POP_FORM_CONTAINER"),a.elDialog.wrapper.mousedown(function(t){a._mousedownForForm.call(a,t);var i=a.elDialog.wrapper.siblings(".k-window");i.push(a.elDialog.wrapper[0]),a.getdynamicFormCount(i)>=2&&(e(this).siblings(".k-window").removeClass("kd-dynamicform-active"),e(this).addClass("kd-dynamicform-active"))}),a.elDialog.wrapper.find(".k-window-titlebar").mousedown(function(t){a._mousedownForForm.call(a,t),e(this).focus()});var n=a.elDialog.wrapper.siblings(".k-window");if(n.push(a.elDialog.wrapper[0]),a.getdynamicFormCount(n)>=2&&(a.elDialog.wrapper.siblings(".k-window").removeClass("kd-dynamicform-active"),a.elDialog.wrapper.addClass("kd-dynamicform-active")),a.elDialog.wrapper.focus().focusout(function(t){var i;i=e(KD.isIeBrowser()?document.activeElement:t.relatedTarget),i.closest(".kd-dynamicform-active").length>0||e(this).removeClass("kd-dynamicform-active")}),t&&a.modalformOverlay&&i){var o=parseInt(a.elDialog.wrapper.css("z-index"));KD.isNaN(o)||(o-=1,a.modalformOverlay.css({"z-index":o}))}}},getdynamicFormCount:function(t){var i=0;if(KD.isEmpty(t))return i;for(var a=0;a<t.length;a++){var n=t[a];e(n).is(":visible")&&i++}return i},_mousedownForForm:function(e){if(this.elDialog&&this.elDialog.wrapper){var t=this.elDialog.wrapper.attr("originalZindex");t=parseInt(t),KD.isNaN(t)||this.elDialog.wrapper.css({"z-index":t})}},isNLPSearchForm:function(){var e=this,t="NLP_SEARCH"===((e||{}).formConfig||{}).FormTheme;return t},initNLPDialogOpts:function(t){var i=this;if(i.isNLPSearchForm()){i.addClass("NLP_SEARCH_POP_FORM"),i.childFormCt.css({height:"auto",width:i.dformWidth});var a=i,n=i.nlpMask=i.nlpMask||e('<div class="kd-form-nlp-back-mask"></div>'),o=t.open;KD.extendObject(t,{position:{left:(e(window).width()-i.dformWidth)/2,top:20},open:function(e){n&&n.remove().insertBefore(a),n=void 0,a=void 0,o&&o(e)},height:"auto",minHeight:35})}},attachEvents:function(e){var t=this;t.off("focusout").on("focusout",function(i){KD.delayInvoke(function(t){var i=KD.getActiveElement();t.isRealOutOfForm.call(t,i)&&(t.hide.call(t,!1),e&&e())},void 0,!1,t)})},isRealOutOfForm:function(t){var i=this,a=!0,n=".kd-floatingautohide";i.isNLPSearchForm()&&(n=".NLP_SEARCH_POP_FORM");var o=null!==t&&e(t).closest(n).length>0;return o=o||null!==t&&e("[aria-activedescendant="+e(t).attr("aria-activedescendant")+"]").closest(n).length>0,o=o||null!==t&&e(t).hasClass("kd-guidepromptintro-maskLayer")||null!==t&&e(t).closest(".kd-popover").length>0,a=!o}};var a="keyup";e(document.body).off(a,i).on(a,i),e.fn.KDForm.defaults={}}(jQuery),define("KDForm",["KD"],function(e){return function(){var t;return t||e.KDForm}}(this)),KDFormProxy=KD.extend(KDContainerProxy,{_cancelClose:!0,createControl:function(e){var t=this;this.el=$("<div></div>"),this.el.proxy=this,this.el=this.el.KDForm({close:function(e){t.onClose.call(t,e)}})},loadConfig:function(e){this.config=e,this.showType=e.showType,KDFormProxy.superclass.loadConfig.call(this,e)},isKeepInCache:function(){var e=this;return e.childForm&&e.childForm.dformConfig&&e.childForm.dformConfig.keepInCache},setTarget:function(e){this.targetProxy=e},setTargetEl:function(e){this.targetDirectlyEl=e},applyConfig:function(e){this.loadConfig(e)},doLayout:function(){KDFormProxy.superclass.doLayout.call(this),this.childForm&&(KD.layout.setInnerDFormSize(this),this.childForm.doLayout.call(this.childForm))},release:function(){KDFormProxy.superclass.release.call(this)},showDialog:function(){var e=this,t={resizable:KD.getValue(e.config,"resizable",!0),resizeStop:function(t){e.onResize.call(e,t)}};this.el.showDialog(t,this.isKeepInCache())},show:function(e){var t=this,i=t.config,a={resizable:KD.getValue(t.config,"resizable",!0),resizeStop:function(e){t.onResize.call(t,e)}};if(t.showType==KDDynamicFormShowType.Modal)t.showDialog(a,t.isKeepInCache());else{var n=t.targetProxy?t.targetProxy.getControl():this.windowFloatTarget||void 0;t.el.show(n,a,e||t.isKeepInCache()),0==i.openstyle.OpenType&&0==i.openstyle.ShowType&&0==i.titlevisible&&0==i.showmaxbutton&&0==i.resizable&&(t.el.prev(".k-window-titlebar").css({"background-color":"#fff",border:"none"}),this.el.prev(".k-window-titlebar").find("span.k-window-title").html(""))}},showFloatingAutoHide:function(e){var t=this,i={title:!1,resizable:KD.getValue(t.config,"resizable",!0),resizeStop:function(e){t.onResize.call(t,e)}};if(t.config&&t.config.FloatingPlacement&&(i.Placement=t.config.FloatingPlacement),t.showType==KDDynamicFormShowType.Modal)t.showDialog(i,t.isKeepInCache());else{var a=t.targetProxy?t.targetProxy.getControl():t.targetDirectlyEl||void 0,n=e||t.isKeepInCache();t.el.show(a,i,n),t.el.addClass("kd-floatingautohide").focus(),t.el.attachEvents(function(){KD.equalsIgnoreCase(t.config.formid,"BOS_YunZhiJiaCosmic")||t.dealAutoHideOrClose.call(t,n)})}t.defaultProxyFocus()},dealAutoHideOrClose:function(e){var t=this;this.el;t.__dealAutoHCH&&clearTimeout(t.__dealAutoHCH),t.__dealAutoHCH=setTimeout(function(){e?t.hide.call(t):t.close?t.close.call(t):t.el.remove()},500)},defaultProxyFocus:function(){var e=this,t=(e.childForm||{}).defaultFocusProxy;t&&KD.isFunction(t.focus)&&t.focus()},hide:function(e){var t=this;t.el.selfClick=!1,t.el.hide(e),t.showType==KDDynamicFormShowType.ModalInCurrentForm&&t.el.removeModalformOverlay()},hideWindow:function(e){this.hide(e)},close:function(){var e=this,t=e.getContentFormProxy(this);t&&(e.isKeepInCache()?(e._cancelClose&&(t.invokeCloseAction.call(t),e._cancelClose=!1),e.fireHideOrShowCustomEvents(!1),this.hideWindow(!0)):t.invokeCloseAction.call(t))},setWindowTitle:function(e){this.el&&this.el.setWindowTitle&&this.el.setWindowTitle(e)},setWindowWH:function(e,t){this.el&&this.el.setWindowWH&&this.el.setWindowWH(e,t)},setWindowFloatTarget:function(e,t){this.windowFloatTarget=e,this.el&&this.el.setWindowFloatTarget&&this.el.setWindowFloatTarget.call(this.el,e,t)},toFront:function(){this.el&&this.el.toFront&&this.el.toFront()},getOriginalZindex:function(){var e=this.el&&this.el.getOriginalZindex&&this.el.getOriginalZindex();return e=parseInt(e),KD.isNaN(e)&&(e=0),e},addDynamicForm:function(e){this.childForm=e;var t=e.getControl();this.el.addDynamicForm(t)},closeWindow:function(){var e=this;e.isKeepInCache()?(e.el&&e.el.data("kendoWindow")&&e.el.data("kendoWindow").close?e.el.data("kendoWindow").close():e.el&&e.el.hide?e.el.hide():e.hide(),KD.delayInvoke(function(){e.fireHideOrShowCustomEvents(!1)})):(e.el.remove(),KDFormProxy.superclass.closeWindow.call(e))},fireHideOrShowCustomEvents:function(e){var t=this,i=t.getContentFormProxy(this);i&&i.fireHideOrShowCustomEvents&&i.fireHideOrShowCustomEvents.call(i,e)},onClose:function(e){this.close()},onResize:function(e){var t=this;t.isResizing||(t.isResizing=!0,KD.delayInvoke(function(){t.doLayout.call(t),t.isResizing=!1},200))},setCoverWatermark:function(e){var t=this,i=(ClientAppProxy.Current||{}).setWatermark;KD.isFunction(i)&&i({el:t.el,config:e})}}),KDControlFactoryProxy.registerType("form",KDFormProxy),define("KDFormProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDFormProxy}}(this)),KDTabItemProxy=KD.extend(KDContainerProxy,{isSilverlightForm:!1,contentEL:void 0,contentHeadEL:void 0,tabStripEL:void 0,loadChildren:function(e){var t=e.items;if(null!=t)for(var i in t){var a=t[i];KD.layout.setCtOrientation(a,e.ctOrientation),KD.layout.setParentTabControlInfo(a,e)}KDTabItemProxy.superclass.loadChildren.call(this,e)},createControl:function(e){this.adjustTheDockMeta(e),this.rendered=!1,this.config=e,this.isDynamicCreated=e&&e.isDynamicCreated,this.el=$("<div tab='tab_el'></div>"),this.el.attr("id",this.baseId),this.el.dock=this.config.dock,KD.setAttachmentData(this.el,e),this.el.attr("data-attdata",this.el["data-attdata"]),this.visible=!0,this.isSilverlightForm=KD.getValue(this.config,"isSilverlightForm",!1),this.tabIconConfig=KD.getValue(this.config,"Entity",void 0),this.el.css({height:"100%",width:"100%"}),this.dom=$("<div tab='tab_dom'></div>"),this.dom.attr("id",this.baseId+"_c"),this.el=this.el.KDPanel(),this.el.appendTo(this.dom)},loadConfig:function(e){var t=this;this.el.css({"overflow-y":"overlay","overflow-x":"visible"}),KDTabItemProxy.superclass.loadConfig.call(t,e)},adjustTheDockMeta:function(e){var t=this.getFormId(),i=KDPanelProxy.getFormMetaPlugins(t);i&&i(e)},initComponent:function(e){if(void 0!==e){var t=this;t.options,this.getCType();if(this.parent=e,"tabpanel"==e.xtype&&e.component,KD.layout.isRelativeWidth(e.component))t.el.css({width:"100%"});else{var i=KD.layout.getCssWidth(e.component);t.el.css({width:i})}this.component=t.dom,this.tabStripEL=e.component.data(e.getKendoCType());var a={text:KD.htmlUtil.encode(this.config.title),encoded:!1,content:"<div id='"+this.baseId+"_content' tab='tab_content'><div>"};this.tabStripEL.append(a);var n=e.component.children("ul").children("li").length-1;this.initContentElement(n);var o=KD.layout.getActualHeight(e.el)-e.el.find("ul:first").height();t.el&&t.el.css({height:o}),t.dom.css({height:o}),t.component.ready(function(){t.doLayout.call(t)}),this.rendered=!0,this.setVisible(KD.getValue(this.config,"visible",!0),n)}},initContentElement:function(e){var t=this;t.contentEL=$(this.tabStripEL.contentElement(e)).css({padding:"0px",margin:"0px",border:"none"}).append(t.dom),t.contentHeadEL=$("li[aria-controls='"+t.parent.component.attr("id")+"-"+(e+1)+"']"),t.contentHeadEL.attr("id","li_"+this.baseId+"_c").attr("currId",this.baseId),t.contentHeadEL.addClass("contentHeadEL"),$("#"+this.baseId+"_content").remove(),"kdmaintab"==this.parent.config.xtype&&(0==e||1==e)&&t.contentHeadEL.find(".k-link").attr({title:this.config.title}),t.initTabClose(e)},initTabClose:function(e){var t=this,i=KD.getValue(this.config,"closable",!1),a=KD.getValue(this.config,"closableEvent",!1);if(i){var n=KD.getImageUrlByNameAndVersion("kd_icon_extend.png");t.contentHeadEL.append("<span class=' k-i-close mainTabCloseButton' style='cursor:hand;margin-top:5px; background-image:url("+n+");'>&nbsp;</span>"),$(".k-i-close",t.contentHeadEL).click(function(e){var i=$(this.parentNode),n={};n.closableEvent=a,n.headerItem=i,KD.delayInvoke(function(e){e=e||{};var i=e.closableEvent,a=e.headerItem;i&&a&&i.call(t,a)},void 0,void 0,n),i.hasClass("k-state-active")||KD.stopPropagation(e)})}},doLayoutInnerForFlowForm:function(){var e=this;if(e.parent&&e.parent.config&&"kdmaintab"==e.parent.config.xtype){var t=e.childForm,i=!1,a=!1;if(t?i=t.isFlowForm.call(t,t.config||t.dformConfig):a=i=0==this.config.PageIndex,i){var n=KD.getWindowHeight(!0)-KD.getBillHeadHeight(),o={"min-height":n,height:n};KD.getWindowHeight(!1)<=KD.CONST.MinClientHeight||KD.getWindowWidth(!1)<=KD.CONST.MinClientWidth?(o.height="auto",KD.CONST.IsBillHeadFloat=!1,this.el.addClass("kd-tab-minClient")):(o.height=n,KD.CONST.IsBillHeadFloat=!0,this.el.removeClass("kd-tab-minClient")),a?o["overflow-x"]="hidden":this.contentEL.addClass("kd-tab-form-container-ui-fluid"),this.contentEL.css(o),this.childForm&&this.childForm.onHostWindowProxyScroll&&this.childForm.onHostWindowProxyScroll.call(this.childForm,{target:this.contentEL})}}},doLayout:function(){var e=this.parent;if(e){var t=KDFlowlayoutProxy.isInVertical(this.config)?"auto":e.el.height()-e.el.find("ul:first").outerHeight(),i=KDFlowlayoutProxy.isInHorizontal(this.config)?"auto":e.el.width();if("kdmaintab"==this.parent.config.xtype&&this.doLayoutInnerForFlowForm(),this.el&&this.el.css({height:t}),this.el&&this.el.css({width:i}),this.dom.css({height:t,width:i}),KDFlowlayoutProxy.isFlowlayoutChild(this.config)||this.el&&this.el.doLayout&&this.el.doLayout.call(this.el,this.config),this.children&&this.children.length)for(var a=0;a<this.children.length;a++){var n=this.children[a];n&&n.doLayout&&n.doLayout.call(n)}this.childForm&&(KD.layout.setInnerDFormSize(this),this.childForm.doLayout&&this.childForm.doLayout.call(this.childForm))}},reLayout:function(){if(this.el&&this.el.doLayout&&this.el.doLayout.call(this.el,this.config),this.children&&this.children.length)for(var e=0;e<this.children.length;e++){var t=this.children[e];t&&t.doLayout&&t.doLayout.call(t)}this.childForm&&this.childForm.doLayout&&this.childForm.doLayout.call(this.childForm)},setVisible:function(e){var t=this;if(this.visible!=e&&(this.visible=e,e?(t.contentHeadEL.hasClass("k-state-active")&&t.contentEL.show(),t.dom&&t.dom.show(),t.contentHeadEL.show(),t.contentHeadEL.removeClass("k-state-disabled")):(t.contentEL.hide(),t.dom&&t.dom.hide(),t.contentHeadEL.hide(),t.contentHeadEL.addClass("k-state-disabled")),!e)){var i="#li_"+this.component[0].id,a=this.parent.component.find("li").index($(i,this.parent.component));a==this.parent.currentShowIndex&&this.parent.selectNextTabItem(a)}},closeWindow:function(e){this.parent.removeTabItem.call(this.parent,this),e&&this.childForm&&this.childForm.doCloseWindow.call(this.childForm)},addDynamicForm:function(e,t){this.childForm=e;var i=e.getControl(),a=this.el.getContent();e&&e.dformConfig&&e.dformConfig.billTitle?this.setTitle(e.dformConfig.billTitle):t&&t.billTitle&&this.setTitle(t.billTitle),i.appendTo(a)},setWindowTitle:function(e){var t=this.getWindowTitleElement();t&&"BOS_MainSystemMenuCard"!=this.config.id&&t.text(e)},setTitle:function(e){this.setWindowTitle(e)},getWindowTitleElement:function(){var e=this.baseId,t="#li_"+e+"_c";if($(t).length>0){var i=$(t).find("span.k-link");return $(i)}},onActivate:function(){var e=this,t=e.getControlFactoryProxy(),i=e.childForm||e.getFirstChildFormProxy(),a={key:this.getKey(),isChildForm:void 0!=e.childForm},n=!0;if(e.isMainTab&&e.contentEL){var o={height:e.contentEL.height(),width:e.contentEL.width()},r=e.__lastTabItemSize;r&&r.height==o.height&&r.width==o.width&&(n=!1),e.__lastTabItemSize=o}n&&e.doLayout.call(e),t&&KD.isFunction(t.setActivate)&&t.setActivate.call(t,!0,e),i&&KD.isFunction(i.activated)&&i.activated.call(i,a)},onDeactivate:function(){var e=this,t=e.getControlFactoryProxy(),i=e.childForm||e.getFirstChildFormProxy(),a={key:this.getKey(),isChildForm:void 0!=e.childForm};t&&KD.isFunction(t.setActivate)&&t.setActivate.call(t,!1,e),i&&KD.isFunction(i.activated)&&i.deactivated.call(i,a)},getFirstChildFormProxy:function(){var e=void 0;try{var t=$($(".kdform",this.el)[0]),i=KD.parseObject(t[getPropName()]("data-attdata")).id||"";e=ClientAppProxy.Current.getAliveForm(i)}catch(a){e=void 0}return e},setEntity:function(e){KD.isEmpty(e)||(this.config.iconConfig=e);var t=this,i=t.config&&t.config.iconConfig;if(i.showicon||i.showhelpicon){if(i.showicon){var a,n=KD.getUrlRoot()+"/"+i.icon,o=""==i.hoveicon?n:KD.getUrlRoot()+"/"+i.hoveicon;a=t.contentHeadEL.hasClass("k-state-active")?$(kendo.format('<span class="kd-tabIcon" style="background-image: url({0})"></span>',o)):$(kendo.format('<span class="kd-tabIcon" style="background-image: url({0})"></span>',n)),t.tabTipIconEl&&t.tabTipIconEl.remove(),t.tabTipIconEl=a,t.contentHeadEL.append(a)}if(i.showhelpicon){var r,s=i.helpicontooltip,l=KD.getUrlRoot()+"/"+i.helpicon,d=""==i.helphoveicon?l:KD.getUrlRoot()+"/"+i.helphoveicon;r=t.contentHeadEL.hasClass("k-state-active")?$(kendo.format('<span class="kd-tabHelpIcon" title="{0}" style="background-image: url({1})></span>',s,d)):$(kendo.format('<span class="kd-tabHelpIcon" title="{0}" style="background-image: url({1})></span>',s,l)),t.tabHelpIcon&&t.tabHelpIcon.remove(),t.tabHelpIcon=r,t.contentHeadEL.append(r)}t.contentHeadEL.css("cursor","pointer"),t.contentHeadEL.off("mouseenter").on("mouseenter",function(){a&&a.css("background-image","url("+o+")"),r&&r.css("background-image","url("+d+")")}),t.contentHeadEL.off("mouseleave").on("mouseleave",function(){t.contentHeadEL.hasClass("k-state-active")||(a&&a.css("background-image","url("+n+")"),r&&r.css("background-image","url("+l+")"))}),t.contentHeadEL.siblings().click(function(){a&&a.css("background-image","url("+n+")"),r&&r.css("background-image","url("+l+")")})}},setToolTip:function(e){this.contentHeadEL&&this.contentHeadEL.attr("title",e)},setItemStyleKey:function(e){e+="",this.contentHeadEL&&this.contentHeadEL.addClass(e)},setItemSortable:function(e){this.contentHeadEL&&(e?this.contentHeadEL.addClass("kd_sortable"):this.contentHeadEL.removeClass("kd_sortable"))}}),KDControlFactoryProxy.registerType("kdtabpage",KDTabItemProxy),define("KDTabItemProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDTabItemProxy}}(this)),KDTabControlProxy=KD.extend(KDContainerProxy,{FireSelChanged:!1,isMainTab:!1,MaxTabItemsCount:15,IsEnableLimit:!0,createInnerDom:function(){return $("<div></div>")},getKendoCType:function(){return"kendoTabStrip"},getKendoOptions:function(){var e=this,t=KDTabControlProxy.superclass.getKendoOptions.call(e);$.extend(t,{show:function(t){e.onShow.call(e,t)},animation:!1,select:function(t){e.onSelect.call(e,t)},contentLoad:function(e){},activate:function(t){e.onActivate.call(e,t)}});var i=KD.getEntryRole();return KD.getValue(e.config,"enableTabScroll",!1)&&"CP"!=i.toString().toUpperCase()?t.scrollable={distance:50}:t.scrollable=!1,t},loadConfig:function(e){var t=this;this.FireSelChanged=e.fireSelChanged||this.FireSelChanged,this.MaxTabItemsCount=KD.getValue(e,"maxtabitemscount",15),this.IsEnableLimit=KD.getValue(e,"isenablelimit",!0),KDTabControlProxy.superclass.loadConfig.call(t,e)},loadChildren:function(e){var t=e.items;null!=t&&this.addControls(t)},initComponent:function(){var e=this;if(KDTabControlProxy.superclass.initComponent.call(this),e.component.css({border:"none"}).find("ul").height("2.5em"),!KDFlowlayoutProxy.isInVertical(this.config)){var t=this.el.height();this.component.height(t)}var i=!0;this.children&&this.children.length>0&&1==this.children[0].visible&&(i=!1);var a=null;for(var n in this.children){var o=this.children[n];o.initComponent(e),o.loadConfig(o.config),0!=o.visible||this.config.selectedIndex&&this.config.selectedIndex!=n||1!=i||(this.config.selectedIndex=parseInt(n)+1,i=!1),o.visible&&null==a&&(a=n),o.doLazyAction.call(o)}this.initMoreButton(),this.initCloseKeyPress(),this.config.selectedIndex?this.setSelectedIndex(this.config.selectedIndex):this.setSelectedIndex(null==a?0:parseInt(a))},onAfterVisible:function(e){var t=this;if(KDTabControlProxy.superclass.onAfterVisible.call(t,e),e.visible!=e.oldVisible){var i=t.getControlFactoryProxy(),a=i.getCmp.call(i,t.config.parent);a&&a.doLayout&&a.doLayout.call(a)}},release:function(){this.isReleasing=!0,KDTabControlProxy.superclass.release.call(this)},initCloseKeyPress:function(){var e=this;e.component.keydown(function(t){var t=t||window.event;if(t&&27==t.keyCode){var i=(t.target,e.component.data(e.getKendoCType()).select());if(i&&i.length>=0){var a=$(".k-state-active",e.component).first().find(".k-i-close").first();a&&a.click()}}})},getChildProxy:function(e){if(void 0!=e)for(var t=0;t<this.children.length;t++){var i=this.children[t];if(e&&i&&i.baseId==e)return i}return null},onShow:function(e){var t=this,i=this.lastShowObj&&(this.lastShowObj.pageId||this.lastShowObj.page),a=this.getChildProxy(i),n=this.component.find("li").index($(".k-state-active",this.component)),o=$(".k-state-active",this.component).attr("currId");
i!=o&&a&&(a&&a.el&&(a.loaded?a.el.parent().removeClass("kd-tabs-unloadhide"):a.el.parent().addClass("kd-tabs-unloadhide")),a&&a.onDeactivate.call(a));var r=this.getChildProxy(o);if(KD.isEmpty(r),r&&!r.loaded&&(r.loadConfig(r.config),r.setParentVisible.call(r,!0)),r&&r.component&&r.component.removeClass("kd-tabs-unloadhide"),t.isMainTab&&1==n&&ClientAppProxy&&ClientAppProxy.Current&&ClientAppProxy.Current.delayLoadData){var s=ClientAppProxy.Current.getAliveForm(ClientAppProxy.Current.delayLoadData);s&&s.loadData(),ClientAppProxy.Current.delayLoadData=null}if(r&&r.onActivate.call(r),void 0==this.currentShowIndex)return this.currentShowIndex=0,this.currentShowBaseId=r.baseId,void this.setCurrentPageId(o);if(r&&this.FireSelChanged){var l=t.lastShowObj&&t.lastShowObj.index||0;KD.delayInvoke(function(){if(!t.isReleasing){var e=t.getFormProxy(),i=r.key;if(t.isMainTab&&(i&&KD.notShowMainFormHolder&&KD.notShowMainFormHolder[i]?$(".kd-bill-flow-bottom-placeholder").hide():$(".kd-bill-flow-bottom-placeholder").show()),t.isMainTab&&(0==n&&!KD.isStartAppVerify()||1==n))return void(0==n&&(KD.isEmpty(n)||KD.isEmpty(l)||n==l||e.fireCustomEvents.call(e,t.key,"Html5MainConsoleTabItemSelectedChange",KD.stringify({selectedItemIndex:n}))));if(t.isMainTab&&KD.isStartAppVerify()&&0==n){if(!t.showFirstIndex)return void(t.showFirstIndex=1);t.showFirstIndex++}e.fireEvent.call(e,"TabItemSelectedChange",t.key,n,i,l)}})}this.setCurrentPageId(o),this.currentShowBaseId=r&&r.baseId,this.currentShowIndex=n,t.setLastShowObject(n,o)},onSelect:function(e){},onActivate:function(e){this.doActivateChildLayout(e.contentElement)},doActivateChildLayout:function(e){if(this.component){if(!e){var t=this.component.data(this.getKendoCType()),i=t.select(),a=i.attr("aria-controls");e=$("#"+a)[0]}var n=e;if(KD.isArray(this.children)&&n){var o=$(n)[getPropName()]("id");for(var r in this.children){var s=this.children[r],l=s.getControl.call(s),d=l.parent().parent()[getPropName()]("id");if(s.isNeedLayout&&d==o)s.doLayout.call(s),s.isNeedLayout=!1;else if(d==o&&s.childForm){var c=s.childForm;c.recalcGridsVScroll&&c.recalcGridsVScroll.call(c)}}}}},activeTab:function(e){$("ul.k-tabstrip-items.k-reset.kdMainTabsHeaderExtend>li[id*="+e.selectpageid+this.getKey()+"]",this.component).click()},setSelectedKey:function(e){if(!KD.isEmpty(e)){var t=kendo.format("{0}{1}{2}{3}{4}","li_",this.getPageId(),"-",e,"_c");if(this.component)for(var i=this.component.data(this.getKendoCType()),a=i.items()||[],n=0;n<a.length;n++){var o=a[n],r=$(o).attr("id");if(t==r)return void i.select($(o))}}},addControls:function(e){this.children=[];for(var t,i=e.length,a=0;i>a;a++){t=e[a],KD.layout.setCtOrientation(t,this.config.ctOrientation),KD.layout.setItemTabControlKey(t,this.getKey());var n=this.getControlFactoryProxy().createControl(t);this.children.push(n)}},removeTabItem:function(e){if(this.children&&!(this.children.length<=0)){var t=!0,i=this.lastShowObj&&(this.lastShowObj.pageId||this.lastShowObj.page);i&&e&&e.contentHeadEL&&e.contentHeadEL.hasClass&&(t=e.contentHeadEL.hasClass("k-state-active"));for(var a=this.children.length,n=0;a>n;n++){var o=this.children[n],r=this.component.find("ul:first");if(o.baseId==e.baseId){var s=o.contentHeadEL.index();if(-1>=s)return;var l=r.find(o.contentHeadEL),d=-parseInt(l.css("left"));if(0==this.isEnoughWidth){var c=l.width()+this.itemMarginLeftWidth,h=r.width()-c;r.width()-c<this.component.width()&&(h=this.component.width()+100,this.isEnoughWidth=!0),r.width(h)}this.isEnoughWidth?(r.find(".defaultTabPrevNextContainer").css("visibility","hidden"),r.find("li:gt(0)").animate({left:0})):r.find("li:gt(0)").animate({left:(-d+c>=0?0:-d+c)+"px"});try{var u=this.component?this.component.data(this.getKendoCType()):void 0;if(u&&u.remove(s),this.removeByValue(this.children,o,"baseId"),u&&t){var p=-1;if(o&&o.childForm&&o.childForm.dformConfig&&o.childForm.dformConfig.originalParentPageId){var g=o.childForm.dformConfig.originalParentPageId;KD.isFunction(this.getSelectToPageId)&&(g=this.getSelectToPageId()||g),p=this._getTabItemIndexbyAnyFormKey(g)}0>p&&(p=(s=a-1)?s-1:s,p=this._getSelectIndexIgnoreDisAutoSel(p)),this.setSelectedIndex(p)}KD.isFunction(this.setSelectToPageId)&&this.setSelectToPageId(null)}catch(f){KD.writeError(f)}break}}}},_getSelectIndexIgnoreDisAutoSel:function(e){if(!KD.isNumber(e))return e;if(KD.isArray(this.children)){if(e>=this.children.length)e=this.children.length;else if(0>=e)return e;for(var t=e;t>=0;t--){var i=this.children[t];if(!i||!i.disAutoSel)break;e=t-1}}return e},removeByValue:function(e,t,i){for(var a=0;a<e.length;a++)if(e[a][i]==t[i]){e.splice(a,1);break}return e},isEnoughWidth:!0,add:function(e){if(this.IsEnableLimit&&this.children.length>=this.MaxTabItemsCount+2)return KD.Error.raise({msg:KD.format(ResManager.LoadKDString("不能打开当前功能页签。原因：超出了参数控制打开页签数的上限{0}个。建议：关闭不需要的页签或联系管理员取消控制参数（参数设置->基础管理->BOS平台）。","014002000008977"),this.MaxTabItemsCount)}),null;var t=this,i=this.createTabItemProxy();i.baseId=e.id+this.key,i.FormTheme=e.FormTheme,i.setControlFactoryProxy(this.getControlFactoryProxy()),e.closable=!e.hiddenclosebutton,KD.layout.setCtOrientation(e,this.config.ctOrientation),e.closableEvent=function(){t.closeTabItem(i)},i.createControl(e);i.getControl();return i.initComponent(t),i.loadConfig(i.config),"BOS_MainSystemMenuCard"!=e.id&&i.contentHeadEL.addClass("kd_sortable"),i.doLazyAction.call(i),this.children.push(i),e&&e.afterReady&&e.afterReady(),"NoSelectMainNewTabPage"!=e.FormTheme&&t.setSelectedIndex(this.component.children("ul").children("li").length-1),i},createTabItemProxy:function(){return new KDTabItemProxy},closeTabItem:function(e){this.closeWindowTest(e),1==e.isSilverlightForm&&this.removeTabItem(e)},closeOtherTabItem:function(e){if(!KD.isEmpty(e))for(var t=this,i=t.children.length,a=0;i>a;a++){var n=t.children[a];if(n!=e){var o=n.contentHeadEL.find(".k-i-close");n&&o&&!n.config.hiddenclosebutton&&t.closeTabItem(t.children[a])}}},closeTabItemByRight:function(e){if(!KD.isEmpty(e)){var t=this,i=t.children.indexOf(e);if(!(0>i))for(var a=t.children.length,n=i+1;a>n;n++){var o=t.children[n],r=o.contentHeadEL.find(".k-i-close");o&&r&&!o.config.hiddenclosebutton&&t.closeTabItem(t.children[n])}}},closeTabItemByLeft:function(e){if(!KD.isEmpty(e)){var t=this,i=t.children.indexOf(e);if(!(0>=i))for(var a=0;i>a;a++){var n=t.children[a],o=n.contentHeadEL.find(".k-i-close");n&&o&&!n.config.hiddenclosebutton&&t.closeTabItem(t.children[a])}}},closeWindowTest:function(e){if(e&&e.childForm){e.childForm.dformConfig.pageId;e.childForm.invokeCloseAction()}},doLayout:function(){if(this.config.dock!=KD.dock.None){var e={height:KDFlowlayoutProxy.isInVertical(this.config)?"auto":KD.layout.getActualHeight(this.el.parent()),width:KDFlowlayoutProxy.isInVertical(this.config)?KD.layout.getCssWidth(this.el.parent()):"auto"};this.config.dock==KD.dock.Left||this.config.dock==KD.dock.Right?e.width=this.config.width:(this.config.dock==KD.dock.Top||this.config.dock==KD.dock.Bottom)&&(e.height=this.config.height);var t=this.getParentProxy(),i=t&&t.xtype;if((this.config.dock==KD.dock.Left||this.config.dock==KD.dock.Right||this.config.dock==KD.dock.Fill)&&"kdexpandcontainer"==i&&(e.height-=17),this.el&&this.el.css(e),this.component&&this.component.css(e),this.children&&this.children.length){for(var a=0;a<this.children.length;a++){var n=this.children[a];n.isNeedLayout=!0}this.doActivateChildLayout()}}else if(KDFlowlayoutProxy.isFlowlayoutChild(this.config)){var e={height:KDFlowlayoutProxy.isInVertical(this.config)?"auto":this.el.parent().height(),width:KDFlowlayoutProxy.isInVertical(this.config)?KD.layout.getCssWidth(this.el.parent()):"auto"};if(this.el&&this.el.css(e),this.component&&this.component.css(e),this.children&&this.children.length){for(var a=0;a<this.children.length;a++){var n=this.children[a];n.isNeedLayout=!0}this.doActivateChildLayout()}}},click:function(e){var t=this.getFormProxy(),i=e.validation?t.validating(!0):!0},setStyleKey:function(e){this.component.addClass("KDDefalutTabControlStyle");var t="";switch(e.toString()){case"2":t="KDMyWorkTabControl";break;default:t=e}this.config.stylekey=t,KD.IsNullOrWhiteSpace(t)||this.component.addClass(this.config.stylekey),this.config.stylekey?("KDMyWorkTabControl"==this.config.stylekey&&(this.config.moreButtonContent=this.config.operatecontent||ResManager.LoadKDString("更多>","099002000000101")),"KDCPTabControlStyle"==this.config.stylekey&&1==this.config.showMoreButton&&(this.config.moreButtonContent=this.config.moreButtonContent),this.config.moreButtonContent&&this.addMoreButton()):this.removeMoreButton()},getStyleKey:function(){this.StyleKey=this.config.stylekey;var e="KDDefalutTabControlStyle ";if(this.StyleKey)return e+this.StyleKey;if(!this.StyleKey)switch(this.config.style.toString()){case"2":this.StyleKey="KDMyWorkTabControl"}return e+(this.StyleKey||"")},setMaxTabItemsCount:function(e){this.MaxTabItemsCount=parseInt(e)},setIsEnableLimit:function(e){this.IsEnableLimit="true"==e.toString()},initMoreButton:function(){this.StyleKey?("KDMyWorkTabControl"==this.StyleKey&&(this.config.moreButtonContent=this.config.operatecontent||ResManager.LoadKDString("更多>","099002000000101")),"KDCPTabControlStyle"==this.StyleKey&&1==this.config.showMoreButton&&(this.config.moreButtonContent=this.config.moreButtonContent),this.config.moreButtonContent&&this.addMoreButton()):this.removeMoreButton()},addMoreButton:function(){var e=this,t={id:e.baseId+"_moreButton",caption:this.config.moreButtonContent||ResManager.LoadKDString("更多","0991733000003986")+">",onclick:function(){var t=e.component.find("li").index($(".k-state-active",e.component)),i=e.getFormProxy();i.lockControl.call(i,e),e.getFormProxy().fireEvent("CustomEvents",t.toString(),"DoAttachCommand","More",{})},style:"float:right; margin: 0.5rem 1.2rem 0 0;"},i=kendo.format("<a id='{0}' href='javascript:void(null)' style='{2}'><span>{1}</span></a>",t.id,t.caption,t.style);moreButtonDom=$(i),moreButtonDom.addClass("kendo-color"),moreButtonDom.click(function(e){t.onclick()}),e.el.find("ul").append(moreButtonDom)},removeMoreButton:function(){var e=$this.baseId+"_moreButton";$("#"+e).remove()},showTabItem:function(e){var t=0;e=(e||"").toLocaleUpperCase();for(var i in this.children)if(this.children[i].key==e){t=i;break}this.children[t].Visiable=!0;var a=this.children[t]||{};a.setVisible&&a.setVisible.call(a,!0),$(this.component.find("ul>li")[t]).show();var n=this.component.data(this.getKendoCType());n.enable(n.tabGroup.children().eq(t),!0),"tabpanel"==this.xtype?0==n.select().length&&this.setSelectedIndex(t):this.setSelectedIndex(t)},hideTabItem:function(e){var t=this,i=-1;e=(e||"").toLocaleUpperCase();for(var a in this.children)if(this.children[a].key==e){i=a;break}if(-1!=i){selectItem=this.children[i]||{},selectItem.Visiable=!1,selectItem.setVisible&&selectItem.setVisible.call(selectItem,!1),$("#"+this.children[i].baseId+"_c",this.component).hide(),$(this.component.find("ul>li")[i]).hide();var n=this.component.data(this.getKendoCType());n.enable(n.tabGroup.children().eq(i),!1);var o=this.component.data(this.getKendoCType()).select();o&&o[0]&&o[0].id.indexOf(e+"_c")>0&&KD.delayInvoke(function(){t.selectNextTabItem(parseInt(i))},400)}},setSelectedIndex:function(e){if(this.component){var t=this.component.data(this.getKendoCType());if(t.items()<=0)return;if(void 0!=this.currentShowIndex&&this.currentShowIndex!=e){var i=t.items()[this.currentShowIndex];i=$(i),t.deactivateTab(i)}this.currentShowIndex=e;var a=t.items()[e];a=$(a),a&&a.length>0&&(this.currentShowBaseId=a.attr("currId"),this.setCurrentPageId(a.attr("currId")),a.hasClass("k-state-disabled")&&t.enable(a,!0),t.deactivateTab(a),t._click(a)),this.setLastShowObject(e,a.attr("currId"))}KD.isFunction(this.setSelectToPageId)&&this.setSelectToPageId(null)},getCurrentPageId:function(){return this.currentPageId},setCurrentPageId:function(e){this.currentPageId=e},setLastShowObject:function(e,t){this.lastShowObj={index:e,page:t}},setItemAttachValue:function(e,t){var i=-1;if(KD.isNaN(e)){for(var a in this.children)if(this.children[a].key==e){i=a;break}}else i=e;if(-1!=i&&this.children[i]&&"KDMyWorkTabItem"==this.children[i].config.stylekey){var n=$("#li_"+this.children[i].baseId+"_c",this.component).find(".attachValue");if(t=t.replace("(","").replace(")","").replace("（","").replace("）",""),0==n.length?$("#li_"+this.children[i].baseId+"_c",this.component).append('<span class="attachValue">'+t+"</span>"):n.text(t),""==t&&$("#li_"+this.children[i].baseId+"_c",this.component).find(".attachValue, .k-link").css({"margin-left":0}),"CP"!==KD.getEntryRole().toUpperCase()){var o=this.component.children("ul").find(".k-item").filter(function(e,t){return!$(t).hasClass("k-state-disabled")});this.component.children("ul").find(".k-item").css({padding:"0 "+(o.length>3?"3px":"4%")})}else{var r=KD.entryrolePlugins.getPlugin(KD.getEntryRole());r&&$.isFunction(r.setItemAttachStyle)&&r.setItemAttachStyle($(".attachValue",$("#li_"+this.children[i].baseId+"_c")))}}},setItemTitle:function(){if(2==arguments.length)var e=arguments[1],t=arguments[0];else if("object"==typeof arguments[0])var t=KD.IsNullOrWhiteSpace(arguments[0].index)?-1:arguments[0].index,e=arguments[0].value||"";if(this.children[t]){var i=this.children[t];i.setWindowTitle(e.toString());var a=$("#li_"+this.children[t].baseId+"_c",this.component).find(".attachValue");a.length>0&&a.text()&&this.setItemValue(t,a.text())}},setTitle:function(e,t,i){this.setTitleByPageid(e,t,i)},setTitleByPageid:function(e,t,i){if(e){for(var a,n=0;n<this.children.length;n++)if(this.children[n].key==e){a=this.children[n];break}if(a&&(t&&a.setWindowTitle(t),i)){var o=$("#li_"+a.baseId+"_c",this.component);o&&o.attr("title",i)}}},setTitleByIndex:function(e,t,i){var a;if(e>=0&&e<this.children.length&&(a=this.children[e]),a&&(t&&a.setWindowTitle(t),i)){var n=$("#li_"+a.baseId+"_c",this.component);n&&n.attr("title",i)}},setFireSelChanged:function(e){this.FireSelChanged!=e&&(this.FireSelChanged=e)},setItemStyleKey:function(e){for(var t in e)if(KD.isRunInForIn(t,e)){var i=e[t],a=KD.getValue(i,"key",""),n=KD.getValue(i,"stylekey","");if(a&&n){var o=this._getTabItemIndexbyAnyFormKey(a,"item");o&&o.setItemStyleKey&&o.setItemStyleKey.call(o,n)}}},setItemSortable:function(e){for(var t in e)if(KD.isRunInForIn(t,e)){var i=e[t],a=KD.getValue(i,"key",""),n=KD.getValue(i,"value","");if(a){var o=this._getTabItemIndexbyAnyFormKey(a,"item");o&&o.setItemSortable&&o.setItemSortable.call(o,n)}}},setItemToolTip:function(e){for(var t in e)if(KD.isRunInForIn(t,e)){var i=e[t],a=KD.getValue(i,"key",""),n=KD.getValue(i,"value","");if(a){var o=this._getTabItemIndexbyAnyFormKey(a,"item");o&&o.setToolTip&&o.setToolTip.call(o,n)}}},selectNextTabItem:function(e){var t=0;t=e==this.children.length-1?0:e+1,t!=this.currentShowIndex&&(this.children[t].visible?this.setSelectedIndex(t):this.selectNextTabItem(t))},getItemsCount:function(){var e=this,t=e.children.length,i=e.getFormProxy();i&&e.getFormProxy().fireEvent("CustomEvents",e.key,"ItemsCount",t)},closeAllAction:function(){for(var e=this,t=e.children.length,i=0;t>i;i++){var a=e.children[i],n=a.contentHeadEL.find(".k-i-close");a&&n&&!a.config.hiddenclosebutton&&e.closeTabItem(e.children[i])}},_getTabItemIndexOrItemObjectbyKey:function(e,t){for(var i,a=-1,n=0;n<this.children.length;n++)if(this.children[n].key==e){a=n,i=this.children[n];break}return KD.isEmpty(t)?a:i},_getTabItemIndexbyAnyFormKey:function(e,t){var i,a,n,o,r=-1,s=ClientAppProxy.Current.getAliveForm(e);if(s)for(var l=this._isNewTabPageForm(s),d=0;d<this.children.length;d++)if(a=this.children[d],l){if(a.key==e){r=d,i=this.children[d];break}}else if(n=$(a.el),o=$(s.el),n.find(o).length>0){r=d,i=this.children[d];break}return KD.isEmpty(t)?r:i},_isNewTabPageForm:function(e){var t=!1;return e&&e.dformConfig&&e.dformConfig.openstyle&&e.dformConfig.openstyle.ShowType==KDDynamicFormShowType.NewTabPage&&(t=!0),t}}),KDControlFactoryProxy.registerType("tabpanel",KDTabControlProxy),KDTabControlProxy_Galaxy=KD.extend(KDTabControlProxy,{initComponent:function(){var e=this;KDTabControlProxy_Galaxy.superclass.initComponent.call(this),e.el.addClass("kd-tab-galaxy-el"),e.component.find(".k-tabstrip-items").css({height:"4.5em"}),e.component.find(".k-tabstrip-items").append($('<div class="kd-tabcontrol-container-top">')),e.setSearchControl(this.config.SearchControl)},setSearchControl:function(e){if(!KD.isEmpty(e)){var t=this;if(e.visible)if(t.searchControlProxy)t.searchControlProxy.setVisible(!0);else{t.searchControlProxy=new KDFullSearchProxy,t.searchControlProxy._commonComponent=t._commonComponent;var i={};i.width=200,i.height=26,i.needPopup=!1,i.id=t.getBaseId()+"-search",i.parent=t.key,i.searchoptions=e,i.parentconfig=t.config,t.searchControlProxy.parentproxy=t,t.searchControlProxy.createControl.call(t.searchControlProxy,i),t.component.find(".k-tabstrip-items").append(t.searchControlProxy.el),t.searchControlProxy.loadConfig.call(t.searchControlProxy,i),t.searchControlProxy.initComponent.call(t.searchControlProxy,i),t.searchControlProxy.component.off("click"),t.searchControlProxy.setControlFactoryProxy(t.getControlFactoryProxy())}else t.searchControlProxy&&t.searchControlProxy.setVisible(!1)}},_commonComponent:function(){var e=this;e.component.find(".k-input").attr("placeholder",e.config.searchoptions.tips).css({margin:"0px"}).addClass("kendo-panel-background-color"),e.component.find(".k-select").addClass("kd-fullsearch-span"),e.component.find(".kd-editor-btn").off("click").on("click",function(){var t={};t.value=e.component.find(".k-input").val(),t.selectTabKey="";var i=e.getParentProxy(),a=$("#"+i.currentShowBaseId);if(a.length>0){var n=KD.parseObject(a.attr("data-attdata"));n&&!KD.isEmpty(n.id)&&(t.selectTabKey=n.id)}var o=e.getFormProxy();o.lockControl.call(o,e),o.fireEvent.call(o,"CustomEvents",e.config.parentconfig.id,"Kingdee.BOS.TabControl.Search",KD.stringify(t))})},setItemAttachValue:function(e,t){var i=-1;if(KD.isNaN(e)){for(var a in this.children)if(this.children[a].key==e){i=a;break}}else i=e;if(-1!=i&&this.children[i]){var n=$("#li_"+this.children[i].baseId+"_c",this.component).find(".attachValue");if(t=t.replace("(","").replace(")","").replace("（","").replace("）",""),0==n.length?$("#li_"+this.children[i].baseId+"_c",this.component).append('<span class="attachValue">'+t+"</span>"):n.text(t),""==t&&$("#li_"+this.children[i].baseId+"_c",this.component).find(".attachValue, .k-link").css({"margin-left":0}),"CP"!==KD.getEntryRole().toUpperCase()){var o=this.component.children("ul").find(".k-item").filter(function(e,t){return!$(t).hasClass("k-state-disabled")});this.component.children("ul").find(".k-item").css({padding:"0 "+(o.length>3?"3":"4%")})}else{var r=KD.entryrolePlugins.getPlugin(KD.getEntryRole());r&&$.isFunction(r.setItemAttachStyle)&&r.setItemAttachStyle($(".attachValue",$("#li_"+this.children[i].baseId+"_c")))}}},onShow:function(e){KDTabControlProxy_Galaxy.superclass.onShow.call(this,e)},release:function(){KD.isEmpty(this.searchControlProxy)||this.searchControlProxy.release.call(this),KDTabControlProxy_Galaxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("tabpanel_Galaxy",KDTabControlProxy_Galaxy),define("KDTabControlProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDTabControlProxy}}(this)),KDMainTabItemProxy=KD.extend(KDTabItemProxy,{disAutoSel:void 0,createControl:function(e){var t=this;t.isMainTab=!0,KDMainTabItemProxy.superclass.createControl.call(t,e),this.el.loadConfig=void 0,this.el.isMainTab=!0},loadConfig:function(e){var t=this;KDMainTabItemProxy.superclass.loadConfig.call(t,e),this.el.css({overflow:"visible"})},getFormConfigHeight:function(e){var t=KD.getWindowHeight();return KD.isUseSmallScreenModel(e,!0)&&($("body").addClass("kdmainformbg-listview-smallscreenmodel"),t=KD.getWindowHeight(),$("body").removeClass("kdmainformbg-listview-smallscreenmodel")),e.OriginalHeight>t-KD.getBillHeadHeight()?t-KD.getBillHeadHeight():e.OriginalHeight},onFlowFormScroll:function(e){this.contentEL&&e&&e.onHostWindowProxyScroll&&this.contentEL.off("scroll").on("scroll",function(t){e.onHostWindowProxyScroll.call(e,t)})},_updateUEStyle:function(e){e+="";var t=this.parent;if(t&&"kdmaintab"==t.xtype&&t.component&&(KD.equalsIgnoreCase(e,"kd-teamwork-console")||KD.equalsIgnoreCase(e,"kd-teamwork-message"))){if(this.contentHeadEL&&this.contentHeadEL.hasClass(e))return;var i=t.component.children(".k-tabstrip-items"),a=i.css("margin-left");a=parseFloat(a),a+=30,i.css({"margin-left":a+"px"}),KD.equalsIgnoreCase(e,"kd-teamwork-console")&&(i.find("li.k-item .kd_SystemMenu").css({left:"80px"}),i.find("li.k-first span.k-link").css({left:"50px"}))}},setItemStyleKey:function(e){this._updateUEStyle(e),KDMainTabItemProxy.superclass.setItemStyleKey.call(this,e)},setItemDisAutoSel:function(e){this.disAutoSel=KD.equalsIgnoreCase(e+"","true")},doLayout:function(){var e=12,t=this.parent;if(t){var i=KDFlowlayoutProxy.isInVertical(this.config)?"auto":t.el.height()-t.el.find("ul:first").height(),a=KDFlowlayoutProxy.isInHorizontal(this.config)?"auto":t.el.width();if("kdmaintab"==this.parent.config.xtype&&this.doLayoutInnerForFlowForm(),this.el&&this.el.css({height:i}),this.el&&this.el.css({width:"auto"==a?a:a-e}),this.dom.css({height:i,width:"auto"==a?a:a-e}),KDFlowlayoutProxy.isFlowlayoutChild(this.config)||this.el&&this.el.doLayout&&this.el.doLayout.call(this.el,this.config),this.children&&this.children.length)for(var n=0;n<this.children.length;n++){var o=this.children[n];o&&o.doLayout&&o.doLayout.call(o)}if(this.childForm){KD.layout.setInnerDFormSize(this);var r=this.childForm.el.css("height").replace("px","").replace("PX",""),s=this.childForm.dformConfig;if(s&&s.OriginalHeight&&s.showType==KDDynamicFormShowType.NewTabPage&&"auto"!=r&&parseFloat(r)>30){var l=KD.clientDetaHeight;s.isUseSmallScreenModel&&(l=0>l?0:l);var d=this.getFormConfigHeight(s)+l;this.childForm.el.height(d)}this.childForm.doLayout&&this.childForm.doLayout.call(this.childForm)}}}}),KDControlFactoryProxy.registerType("kdmaintabpage",KDMainTabItemProxy),KDMainTabItemFrameProxy=KD.extend(KDTabItemProxy,{createControl:function(){var e=this;KDMainTabItemFrameProxy.superclass.createControl.call(e),this.el=this.el.KDIFrame()},loadConfig:function(e){var t=this;KDMainTabItemFrameProxy.superclass.loadConfig.call(t,e),this.el.css({overflow:"visible"})},loadFormConfig:function(e){this.el.loadFormConfig(e)}}),KDControlFactoryProxy.registerType("kdmaintabpageframe",KDMainTabItemFrameProxy),function(e){e.fn.KDIFrame=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDIFrame.prototype,e.fn.KDControlBase.defaults,e.fn.KDIFrame.defaults,t);return this.fw=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDIFrame.prototype={getType:function(){return"kdiframe"},loadConfig:function(e){},loadFormConfig:function(e){try{var t=this,i=e.getFormUrl();t.fw.ready(function(){t.fw.attr("src",i)})}catch(a){}}},e.fn.KDIFrame.defaults={metaHtml:'<iframe scrolling="auto" src="#" class="formTabSalver">',defaults:{}}}(jQuery),define("KDMainTabItemProxy",["KDTabItemProxy","KD"],function(e){return function(){var t;return t||e.KDMainTabItemProxy}}(this)),KDMainTabControlProxy=KD.extend(KDTabControlProxy,{isMainTab:!0,isMaintabRightClick:!0,expandRightDiv:!0,isSetHelpPanelVisible:!1,isEnableNewHelpCenter:!1,isEnableSHSeviceVisible:!0,AllowHelpAssistant:!1,initComponent:function(){var e=this;e._initReceiveBrowerAutoSavePasswordControl(),KDMainTabControlProxy.superclass.initComponent.call(e),this.inintDisplay(),this.component.removeClass("ui-widget-content"),this.initExtMenu(this.config),this.initRightDiv(),this.initTabSortable(),this.initMainTabContextMenu()},_initReceiveBrowerAutoSavePasswordControl:function(){var e=this.el.children(".kd-container-receiveBrowerAutoSavePasswordControl");0==e.length&&(e='<div class="kd-container-receiveBrowerAutoSavePasswordControl"><input datarole="username" autocomplete="on"><input autocomplete="on" datarole="password" type="password"><input datarole="username" autocomplete="on"></div>'),this.el.append(e),$("body").append(e)},initRightDiv:function(){var e=this,t=$("<div id='maintabRightDiv' style=''></div>"),i=($("#MainPanel"),e.getFormId(),$('<div class="IconDiv dyapprise" data-role="btCloudApp"><span class="icon-cloudhub" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span></div>'));i.appendTo(t).bind("click",function(){var t=e.getFormProxy();t&&(t.fireCustomEvents.call(t,"ShowCloudPCApp","ShowCloudPCApp",null),t.fireEvent.call(t,"ButtonClick","btCloudApp","3",null))}),this._initRightFunctionGuidAndEmptyTip(i,{name:"btCloudApp",tooltip:{title:ResManager.LoadKDString("协同云","0991733000007537")}});var a=$('<div class="IconDiv dyapprise" data-role="btContactUs"><span class="icon-robert" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span></div>');a.appendTo(t).bind("click",function(){e._initRightFunctionGuidAndEmptyTip(a,{name:"btXsc",functionguid:{visible:!0,tooltip:{title:ResManager.LoadKDString("联系我们","0025710000005675")}}})}),this._initRightFunctionGuidAndEmptyTip(a,{name:"btXsc",tooltip:{title:ResManager.LoadKDString("联系我们","0025710000005675")}});var n=$('<div class="IconDiv dyapprise" data-role="btApprise"><span class="icon-Apprise" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span></div>');n.appendTo(t).bind("click",function(){var t=e.getFormProxy();if(t){var i=e.getCurrentFormId();t.fireCustomEvents.call(t,"ShowDyAppriseForm","ShowDyAppriseForm",i+",1"),t.fireEvent.call(t,"ButtonClick","btApprise","3",null)}}),this._initRightFunctionGuidAndEmptyTip(n,{name:"btApprise",tooltip:{title:ResManager.LoadKDString("满意度评价","0025710000003868")}});var o=$(kendo.format('<div class="iconDiv icon-expandandcollapse"><span class="kd-maintabRightDiv-expander kd-maintabRightDiv-expander-expand"><span class="kd-maintabRightDiv-expander-icon" style="background-image:url({0});"></span></span></div>',KD.getImageUrlByNameAndVersion("kd_icon_extend.png"))).appendTo(this.el);this.maintabRightDiv=t,this.toggleMaintabRightDiv=o,$('<div class="icondiv-masklayer"></div>').appendTo(t),t.appendTo(this.el),o.bind("click",function(t){e.onExpenderClick.call(e,t);var i=e.getFormProxy(),a=e.expandRightDiv?"1":"0";i&&i.fireCustomEvents.call(i,"ShowMaintabRightDiv","ShowMaintabRightDiv",a)}),1033==parseInt(ResManager.Language)&&(t.css("bottom","140px"),o.css("bottom","117px")),KD.isManagementSite()&&(a.remove(),i.hide(),n.hide(),o.hide())},onExpenderClick:function(e){var t=this;if(t.isMaintabRightClick){t.expandRightDiv=!t.expandRightDiv;var i=t.expandRightDiv?"kd-maintabRightDiv-expander-expand":"kd-maintabRightDiv-expander-collapse",a=t.expandRightDiv?"kd-maintabRightDiv-expander-collapse":"kd-maintabRightDiv-expander-expand",n=t.toggleMaintabRightDiv.find(".kd-maintabRightDiv-expander");t.expandRightDiv?(n.animate({width:"40px"},"slow"),n.addClass(i).removeClass(a),KD.delayInvoke(function(){t.maintabRightDiv.slideDown(),t.isMaintabRightClick=!0},1e3)):(t.maintabRightDiv.slideUp(),KD.delayInvoke(function(){n.animate({width:"20px"},"slow"),n.addClass(i).removeClass(a),t.isMaintabRightClick=!0},1e3)),t.isMaintabRightClick=!1}},setShowMaintabRightDivVisible:function(e){var t=this;switch(e){case"1":break;case"0":t.onExpenderClick()}},AddBtnForRightMenu:function(e){if(this.rightMenuOptions=this.rightMenuOptions||{},!KD.isEmpty(e)&&KD.isArray(e)){var t,i,a=this.el.find("#maintabRightDiv");for(var n in e)t=e[n],KD.isEmpty(t)||KD.isEmpty(t.name)||(this.rightMenuOptions[t.name]=$.extend(this.rightMenuOptions[t.name],t),i=a.find('[data-role="'+t.name+'"]'),0==t.visible?i.hide():i.show(),this._initRightFunctionGuidAndEmptyTip(i,t))}},setMainRightMenuVisible:function(e){if(!KD.isEmpty(e)){var t=KD.isArray(e)?e[0]:e;t?(this.maintabRightDiv&&this.maintabRightDiv.show(),this.toggleMaintabRightDiv&&this.toggleMaintabRightDiv.show()):(this.maintabRightDiv&&this.maintabRightDiv.hide(),this.toggleMaintabRightDiv&&this.toggleMaintabRightDiv.hide())}},setIsSHSeviceVisible:function(e){this.isEnableSHSeviceVisible=e},_initRightFunctionGuidAndEmptyTip:function(e,t){var i=this;if(e&&t){e=$(e);var a=kendo.format('<div class="kd-mainconsole-rightfunction-guid-container"><div class="kd-tipline"></div><div class="kd-innercontainer"></div><div>');if(!KD.isEmpty(t.tooltip)){var n=$(a).attr({datarole:"emptytip"}),o=n.find(".kd-innercontainer"),r=t.tooltip.title||"";r=r.replace("\r\n","<br>");var s=kendo.format('<div class="kd-title-container"><div class="kd-title">{0}</div></div>',r);if(o.append(s),KD.isEmpty(t.tooltip.content))n.css({top:"auto",bottom:"8%"});else{var l=kendo.format('<div class="kd-content-container"><div class="kd-content">{0}</div></div>',t.tooltip.content);o.append(l)}e.find('.kd-mainconsole-rightfunction-guid-container[datarole="emptytip" ]').remove(),e.append(n),n.click(function(e){return e.preventDefault(),!1})}if(!KD.isEmpty(t.functionguid)){var d="",c=KD.getImageUrlByNameAndVersion("kd_icon_extend.png");"btXsc"==t.name&&(a=kendo.format('<div class="kd-mainconsole-rightfunction-guid-container" tabIndex="-1"><div class="kd-tipline"></div><div>'),d="kd-log-robert");var h='.kd-mainconsole-rightfunction-guid-container[datarole="functionguid" ]';if(e.find(h).length>0&&t.functionguid.visible)return e.find(h+" .kd-innercontainer").unbind("mousedown"),e.find(h).remove(),i._initRightFunctionGuidAndEmptyTip(e,{name:t.name,tooltip:t.functionguid.tooltip}),!0;var u=kendo.format('<div class="kd-innercontainer kd-innercontainer-first" data-role="btContactUsXsc"><div class="kd-title-container"><div class="kd-title kd-contactus"><span class="kd-log-robert" style="background-image:url({1});"></span>{0}</div></div>',ResManager.LoadKDString("徐少春个人号","0025710000004848"),c);u+=kendo.format('<div class="kd-content-container"><div class="kd-content">{0}</div></div>',ResManager.LoadKDString("您可以与徐少春先生交流管理哲学与商业文明，也期待聆听您对于金蝶产品和服务的重要建议或反馈","0025710000005676")),u+="</div>",u+=kendo.format('<div class="kd-innercontainer kd-innercontainer-nthchild" data-role="btContactUsDianHua"><div class="kd-title-container"><div class="kd-title kd-contactus"><span class="kd-log-dianhua" style="background-image:url({1});"></span>{0}</div></div>',ResManager.LoadKDString("售前热线","0025710000005677"),c),u+='<div class="kd-content-container"><div class="kd-content kd-content-dianhua">4008-830-830</div></div>',u+="</div>",u+=kendo.format('<div class="kd-innercontainer kd-innercontainer-nthchild" data-role="btContactUsZiXun"><div class="kd-title-container"><div class="kd-title kd-contactus"><span class="kd-log-zixun" style="background-image:url({1});"></span>{0}</div></div>',ResManager.LoadKDString("售前在线咨询","0025710000005678"),c),u+=kendo.format('<div class="kd-content-container"><div class="kd-content">{0}</div></div>',ResManager.LoadKDString("为您推荐最合适的软件","0025710000005679")),u+="</div>",i.isEnableSHSeviceVisible&&(u+=kendo.format('<div class="kd-innercontainer kd-innercontainer-nthchild" data-role="btContactUsTiWen"><div class="kd-title-container"><div class="kd-title kd-contactus"><span class="kd-log-tiwen" style="background-image:url({1});"></span>{0}</div></div>',ResManager.LoadKDString("售后在线服务","0025710000005680"),KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png")),u+=kendo.format('<div class="kd-content-container"><div class="kd-content">{0}</div></div>',ResManager.LoadKDString("为您的每一次提问，提供匹配的答案","0025710000005681")),u+="</div>");var p=$(a).attr({datarole:"functionguid"});p.append(u),p.click(function(e){return e.preventDefault(),!1}),e.find('.kd-mainconsole-rightfunction-guid-container[datarole="functionguid" ]').remove(),e.append(p),e.find('.kd-mainconsole-rightfunction-guid-container[datarole="emptytip" ]').remove(),p.focus().blur(function(a){$(this).remove(),i._initRightFunctionGuidAndEmptyTip(e,{name:t.name,tooltip:t.functionguid.tooltip})});var g=t;p.find(".kd-innercontainer").unbind("mousedown").bind("mousedown",function(t){
var a=$(this).attr("data-role"),n="",o="",r="";if(p.find(".kd-innercontainer").unbind("mousedown"),e.find(h).remove(),i._initRightFunctionGuidAndEmptyTip(e,{name:g.name,tooltip:g.functionguid.tooltip}),"btContactUsXsc"==a?(a="btXsc",r="btXscAcount",n="Kingdee.BOS.btXscAcount",o="Kingdee.BOS.btXscAcountClick"):"btContactUsZiXun"==a?(r="btContactUsIMZiXun",n="Kingdee.BOS.ContactUsIM",o="Kingdee.BOS.ContactUsIMZiXun"):"btContactUsTiWen"==a?(r="btContactUsIMService",n="Kingdee.BOS.ContactUsIM",o="Kingdee.BOS.ContactUsIMService"):n="",n){var s=i.getFormProxy(),l=i.getRightMenuOptinsByName(a);l=$.extend(l,{pageid:i.getCurrentFormId()}),s&&(s.fireCustomEvents.call(s,n,o,KD.stringify(l)),s.fireEvent.call(s,"ButtonClick",r,a,null))}return t.preventDefault(),!1})}}},getRightMenuOptinsByName:function(e){var t={};if(!KD.isEmpty(e)&&!KD.isEmpty(this.rightMenuOptions))for(var i in this.rightMenuOptions)if(i==e){t=this.rightMenuOptions[i];break}return t},initTabSortable:function(){var e=this,t=e.component.data(e.getKendoCType());$("ul.k-tabstrip-items",this.component).kendoSortable({filter:".kd_sortable",container:"ul.k-tabstrip-items",hint:function(e){var t=e.hasClass("k-state-active")?"k-state-active":"";return $("<div id='hint' class='k-widget k-tabstrip k-floatwrap k-tabstrip-top'><ul class='k-tabstrip-items k-reset'><li class='k-item k-state-default contentHeadEL "+t+" k-tab-on-top'>"+e.html()+"</li>NaN")},cursor:"move",start:function(e){var t=e.item;return t.hasClass("k-first")?void e.preventDefault():void t.hasClass("k-state-active")},move:function(e){var t=e.target;return t.hasClass("k-first")?void e.preventDefault():void 0},change:function(i){var a=t.tabGroup.children(),n=Array.from(a).filter(function(e){return 0==$(e).find(".mainTabCloseButton").length}).length;if(i.newIndex=i.newIndex+n,i.oldIndex=i.oldIndex+n,0==i.newIndex)return void i.preventDefault();var o=a.eq(i.newIndex);i.oldIndex<i.newIndex?t.insertAfter(i.item,o):t.insertBefore(i.item,o),e._resortChildFormList.call(e,i.oldIndex,i.newIndex),this.currentShowIndex=i.newIndex,e.setLastShowObject.call(e,i.newIndex,i.item.attr("currId")),i.item.hasClass("k-state-active")||(e.setCurrentPageId.call(e,i.item.attr("currId")),t.activateTab(i.item))},end:function(e){}})},initMainTabContextMenu:function(){var e=this,t=$(kendo.format("<ul id='kd-maintab-context-menu'><li data-role='closeCurrent'>{0}</li><li data-role='closeOther'>{1}</li><li data-role='closeRightAll'>{2}</li><li data-role='closeLeftAll'>{3}</li><li data-role='closeAll'>{4}</li></ul>",ResManager.LoadKDString("关闭当前页签","00215181000007441"),ResManager.LoadKDString("关闭其他页签","00215181000008656"),ResManager.LoadKDString("关闭右侧页签","00215181000008657"),ResManager.LoadKDString("关闭左侧页签","00215181000007444"),ResManager.LoadKDString("关闭所有页签","00215181000007445"))),i=null;t.kendoContextMenu({target:e.component.find("ul.k-tabstrip-items"),open:function(t){var a=e,n=t.event&&t.event.target;return $(n)&&0==$(n).closest("li").find(".mainTabCloseButton").length?(t.preventDefault(),void(i=null)):(i=a.children.filter(function(e){return n.parentNode==e.contentHeadEL[0]})[0],void a.updateTabContextMenuItemVisible(t.item,a.children.indexOf(i)))},select:function(t){if(!KD.isEmpty(i)){var a=e,n=$(t.item).attr("data-role");switch(n){case"closeCurrent":a.closeTabItem.call(a,i);break;case"closeOther":a.closeOtherTabItem.call(a,i);break;case"closeRightAll":a.closeTabItemByRight.call(a,i);break;case"closeLeftAll":a.closeTabItemByLeft.call(a,i);break;case"closeAll":a.closeAllAction.call(a)}}}})},updateTabContextMenuItemVisible:function(e,t){if(!KD.isEmpty(e)&&-1!=t){e.find("li").removeClass("kd-maintab-contextMenu-item-hide");var i=this.component.find(".kdMainTabsHeaderExtend li"),a=Array.from(i).filter(function(e){return 0==$(e).find(".mainTabCloseButton").length}).length,n=e.find("li[data-role='closeLeftAll']"),o=e.find("li[data-role='closeRightAll']");t==a&&t==i.length-1?e.children().not("li[data-role='closeCurrent']").addClass("kd-maintab-contextMenu-item-hide"):t-a==0?n.addClass("kd-maintab-contextMenu-item-hide"):t==i.length-1&&o.addClass("kd-maintab-contextMenu-item-hide")}},_resortChildFormList:function(e,t){if(e=parseInt(e),t=parseInt(t),!KD.isNaN(e)&&!KD.isNaN(t)&&e<this.children.length&&t<this.children.length){var i=this.children.splice(e,1),a=this.children.splice(0,t);a.push(i[0]);var n=a.concat(this.children);this.children=n}},setLastShowObject:function(e,t){var i=this,a=i.getKey();i.lastShowObj={index:e,pageId:t,subFromId:t.substr(0,t.length-a.length),tabPage:t}},_btnMainWitdh:0,inintDisplay:function(){if("CloudProductTabsHeader"==this.config.stylekey){var e=this.component.width();this.displayPadding=(e-960)/2,this.marginRightWidth=this.displayPadding+15,this.component.find("ul li").first().css("margin-left","0px"),this.component.find("ul li").first().find(".k-link").html(""),this.leftRightBtnWidth=48}else"kdMainTabsHeader"==this.config.stylekey&&this.component.find("ul li").first().find(".k-link").html("&nbsp;&nbsp;&nbsp;&nbsp;")},getKendoCType:function(){return"kendomainTabControl"},loadConfig:function(e){var t=this;ClientAppProxy.Current.setMainTab(t);var i=t.getFormProxy();ClientAppProxy.Current.setMainConsoleForm(i),KDMainTabControlProxy.superclass.loadConfig.call(this,e),this.FireSelChanged=KD.getValue(e,"fireSelChanged",!0),0==e.style&&this.el.css("top","-2px"),this.setIsShowAllFuncBtn(KD.getValue(e,"isShowAllFuncBtn",!0))},release:function(){KDMainTabControlProxy.superclass.release.call(this)},setStyleKey:function(e){var t="";switch(e.toString()){case"0":t="kdMainTabsHeader";break;default:t=e}KD.IsNullOrWhiteSpace(t)||this.component.addClass(this.config.stylekey)},getStyleKey:function(){var e=this.config.stylekey||"";if(!e)switch(this.config.style.toString()){case"0":e="kdMainTabsHeader"}return this.config.stylekey=e,e},setIsShowAllFuncBtn:function(e){this.isShowAllFuncBtn!=e&&(this.isShowAllFuncBtn=e)},initExtMenu:function(e){var t=this;t.component.css({position:"relative"});var i,a,n,o,r=t.getControlFactoryProxy(),s=KDMainTabControlProxy.getFavoriteKey(),l=KDMainTabControlProxy.getAllFeatureKey();if("kdMainTabsHeader"==this.config.stylekey){var d='<div class="mainTabAdditionBtn" style="z-index:3;"><span id='+s+' class="mainTabFavorBtn"></span><span class="mainTabSplitLine"></span><span id='+l+' class="mainTabMenuBtn" titile='+ResManager.LoadKDString("所有功能","099002000000060")+"></span></div>",c=$(d);a=c.find("#"+s),i=c.find("#"+l);var h=new KDControlProxy;h.el=i,r.controls[l]=h;var u=new KDControlProxy;u.el=a,r.controls[s]=u;var p=t.component.find("ul>li").first()}else if("CloudProductTabsHeader"==this.config.stylekey){var g=t.component.find("ul").first();i=$("<div id="+l+' class="CloudAllFunctionBtn" style="top:'+(g.height()-28)+'px;" title='+ResManager.LoadKDString("所有功能","0025710030032351")+"></div>");var c=$("<div id="+s+' class="CloudAllOpenFormBtn" style="top:'+(g.height()-28)+"px;background-image:url("+KD.getImageUrlByNameAndVersion("kd_icon.png")+');"  title='+ResManager.LoadKDString("查看所有打开的页面列表","099002000000061")+"></div>"),f=KD.getCurrentFontsize()||12;f>12&&(i.addClass("CloudAllFunctionBtn_L"),c.addClass("CloudAllOpenFormBtn_L")),a=c,n=$('<div id=__kdHelpContainer class="kd_maintab_btn_help" style="top:'+(g.height()-22)+"px;background-image:url("+KD.getImageUrlByNameAndVersion("kd_icon.png")+');display:none;"  title='+ResManager.LoadKDString("帮助","0991733000003993")+"></div>"),t.toggleFullScreenBtn=o=$('<div id=__kdfullscreenContainer class="kd_maintab_btn_fullscreen" style="right:34px;top:'+(g.height()-22)+"px;background-image:url("+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"  title='+ResManager.LoadKDString("全屏","0141072000005453")+"></div>");var m=$('<div class="extendLeftDiv"></div>');m.css({width:20});var v=$('<div class="extendRightDiv"></div>');m.click(function(){return!1}),v.click(function(){return!1});var p=t.component.find("ul>li").first();p.append(c),p.append(n),p.append(o),p.append(m),p.append(v),g.addClass("kdMainTabsHeaderExtend").css({"margin-left":80,"margin-right":130});var y=this.marginRightWidth;0==this.isShowAllFuncBtn&&(i.css("display","none"),this.component.find("ul li").first().css("margin-left",this.marginRightWidth-27),y=-30),this._btnMainWitdh=y}i&&i.bind("click",function(e){return e.stopPropagation(),t.showFloatMainMenu(),!1}),a&&a.bind("click",function(e){return e.stopPropagation(),t.showFloatPages(),!1}),n&&n.bind("click",function(e){e.stopPropagation();var i=$(this),a=i.attr("lastOperatePageId"),n=t.getCurrentFormId();if(t.showHelpPages({isresetdata:a!=n}),a!=n||t.isEnableNewHelpCenter){i.attr({lastOperatePageId:n});var o=t.getFormProxy(),r=t.isShowFunctionGuid&&"__kdHelpContainer"==t.isShowFunctionGuid.key?"true":"";o.fireEvent.call(o,"CustomEvents","Kingdee.BOS.MainTabControl","Kingdee.BOS.MainTabControl.ShowHelper",KD.stringify({currentpageid:n,guidvisible:r})),o.fireEvent.call(o,"ButtonClick","btMainTabControlShowHelper","ShowHelper",null)}}),this._bindFullScreenBtnAction(o)},_bindFullScreenBtnAction:function(e){var t=this;if(e){var i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a={};i.forEach(function(e){e&&e[1]in document&&e.forEach(function(e,t){a[i[0][t]]=e})});e&&e.bind("click",function(e){e.stopPropagation();var i=$(this),n=document.documentElement,o=void 0;if(i.hasClass("kd-ui-exitfullscreen")){if(!n[a.fullscreenElement]){o=n[a.requestFullscreen];try{if(KD.isEmpty(o)){if(KD.isEmpty(window.ActiveXObject)){var r=new ActiveXObject("WScript.Shell");null!=r&&r.SendKeys("{F11}")}}else o.call(n)}catch(e){}}n=document,o=n[a.exitFullscreen]}else o=n[a.requestFullscreen];try{var s=!0;if(KD.isEmpty(o))if(KD.isEmpty(window.ActiveXObject)){var r=new ActiveXObject("WScript.Shell");null!=r&&r.SendKeys("{F11}")}else s=!1;else o.call(n);s&&t._setFullScreenBtnState(!1)}catch(e){}})}},_isFullscreen:function(){var e=$(window).height(),t=window.screen.height,i=!1;return i=e+45>=t},_setFullScreenBtnState:function(e){var t=this;if(t.toggleFullScreenBtn&&t.toggleFullScreenBtn.addClass){var i=function(){var e=t._isFullscreen();e?(t.toggleFullScreenBtn.addClass("kd-ui-exitfullscreen"),t.toggleFullScreenBtn.attr({title:ResManager.LoadKDString("退出全屏","0025710030033488")})):(t.toggleFullScreenBtn.removeClass("kd-ui-exitfullscreen"),t.toggleFullScreenBtn.attr({title:ResManager.LoadKDString("全屏","0141072000005453")}))};0==e?i():KD.delayInvoke(function(){i()})}},setExtendButtonVisible:function(e){e?($(".mainTabAdditionBtn").show(),$("#"+KDMainTabControlProxy.getFavoriteKey()).show()):($("#"+KDMainTabControlProxy.getFavoriteKey()).hide(),$(".mainTabAdditionBtn").hide())},setPluginButtonsVisible:function(e){this.isShowAllFuncBtn!=e&&(e?($("#"+KDMainTabControlProxy.getAllFeatureKey()).show(),this.component.find("ul li").first().css("margin-left",this.marginRightWidth+3),this._btnMainWitdh=this._btnMainWitdh+80,$("#div_"+KDMainTabControlProxy.getAllFeatureKey()).css("width",this._btnMainWitdh)):($("#"+KDMainTabControlProxy.getAllFeatureKey()).hide(),this.component.find("ul li").first().css("margin-left",this.marginRightWidth+3-50),this._btnMainWitdh=this._btnMainWitdh-80,$("#div_"+KDMainTabControlProxy.getAllFeatureKey()).css("width",this._btnMainWitdh)),this.setIsShowAllFuncBtn(e))},setHomePageButtonVisible:function(e){var t=this,i=t.component.find("ul li:first-child > span"),a=$(".mainTabAdditionBtn",t.component).next();e?(i.show(),KD.delayInvoke(function(){t.setSelectedIndex(0),a.css("width","64px")},400)):(i.hide(),t.component.find("ul > li").length>1&&KD.delayInvoke(function(){t.setSelectedIndex(1)},400),a.css("width","4px"))},add:function(e){KDMainDynamicFormProxy.doCloseKDTipButton();var t=this;KD.layout.setCtOrientation(e,this.config.ctOrientation);var i=KDMainTabControlProxy.superclass.add.call(t,e);return!i||!i.contentHeadEL||e.closable||"BOS_MainSystemMenuCard"!=e.id&&"SCP_MainSystemMenuCard"!=e.id||$(".k-link",i.contentHeadEL).text("").addClass("kd_SystemMenu"),null==i?null:i},createTabItemProxy:function(){return new KDMainTabItemProxy},addFrame:function(e){KD.layout.setCtOrientation(e,this.config.ctOrientation);var t=this,i=new KDMainTabItemFrameProxy;i.createControl(),i.loadConfig(e);var a=i.getControl();a.title=i.getTitle(),a.id=e.id;var n=t.el.addTabItem(a),o=n.getHeadElIdSelector();return t.el.setClosable(n.tabId,!0),t.items[n.tabId]=i,i.setHeadEl(o),i.setTabId(n.tabId),i.setOwner(t),e&&a.ready(function(){e.active&&t.selectById(n.tabId),e.afterReady&&e.afterReady()}),i},doLayout:function(){this._setFullScreenBtnState(),KDMainTabControlProxy.superclass.doLayout.call(this),this.component&&this.component.data&&this.component.data(this.getKendoCType())&&this.component.data(this.getKendoCType()).resize();var e=this.getFormProxy().getControlFactoryProxy(),t=e.getCmp("POPFLOATPAGES"),i=e.getCmp("POPFLOATMAINPAGE");(t?"block"!=t.el.css("display"):1)||this.showFloatPages(),(i?"block"!=i.el.css("display"):1)||this.showFloatMainMenu();var a=this.helpContainer&&this.helpContainer.is(":visible");a&&this.showHelpPages&&this.showHelpPages(),this.setGuidePosition&&this.setGuidePosition()},showFloatPages:function(){var e=this.getFormProxy().getControlFactoryProxy().getCmp("POPFLOATPAGES");if(null==e){var t={id:"POPFLOATPAGES",xtype:"kdPopupWorkPages",layout:"kdlayout",lineWrap:!1,ImageShowStyle:0,backgroundimage:"",border:!1,dock:0,height:150,hscroll:0,style:0,tabIndex:1001,vscroll:0,width:200,x:0,y:157,zindex:10014},i=this.getFormProxy().createInnerControl(t);i.tabScope=this,i.show(),i.rendered=!0}else{var a=KDMainTabControlProxy.getFavoriteKey(),n=$("#"+a).offset();e.offsetLeft=n.left-e.getConfig().width+10,e.show()}},showFloatMainMenu:function(){var e=this.getFormProxy().getControlFactoryProxy().getCmp("POPFLOATMAINPAGE");if(null==e){var t={id:"POPFLOATMAINPAGE",xtype:"kdPopupMainMenuProxy",layout:"kdlayout",lineWrap:!1,ImageShowStyle:0,backgroundimage:"",border:!1,dock:0,height:486,hscroll:0,style:0,tabIndex:1001,vscroll:0,width:786,x:0,y:157,zindex:10013},i=this.getFormProxy().createInnerControl(t);i.rendered=!0;var a='{"key":"POPFLOATMAINPAGE"}';this.getFormProxy().fireCustomEvents(this.getKey(),"LoadAllFeature",a)}else{var n=KDMainTabControlProxy.getAllFeatureKey(),o=$("#"+n).offset();e.offsetLeft=o.left-e.getConfig().width+10,e.show(),e.doLayout()}},focusTypeList:{1:{bordercolor:"#2386EE"},2:{bordercolor:"#FE7D00"},3:{bordercolor:"#F73D1B"},4:{bordercolor:"#FFBF00"},5:{bordercolor:"#1DBCBE"}},_getArticleFocusType:function(e){var t=this.focusTypeList[e];return KD.isEmpty(t)&&(t={bordercolor:"#1DBCBE",name:""}),t},getCurrentFormId:function(){if(KD.isArray(this.children)&&this.children.length>0){for(var e=this.getCurrentPageId(),t=this.children[0],i=0;i<this.children.length;i++)if(this.children[i].baseId==e){t=this.children[i];break}return 0==i?"":t.key}},_generalHelpPagesDataSource:function(e,t){if(!e)return[];var i=[],a={};if(e)for(var n=0;n<e.length;n++){var o=e[n];KD.isEmpty(o[5])&&(o[5]=ResManager.LoadKDString("知识","00214298000004799")),a={},a.key=o[0],a.title=o[1],a.type=this._getArticleFocusType(o[4]).bordercolor,a.typename=o[5],a.focusshowmodel=KD.isEmpty(o[5])?"kd-hidden":"",a.url=o[6],a.imgurl=o[7],a.itemtype=t||"knowledge",i.push(a)}return i},setUnAllowHelpCenter:function(e){this.isEnableNewHelpCenter=e,this.helpContainer&&this.isEnableNewHelpCenter&&this.helpContainer.hide()},setHelpPagesData:function(e){var t=this;if(e=e||{},this.helpContainer){var i=e.cloudHelpCenterData;void 0!=i?(this.helpContainer.hide(),this.isEnableNewHelpCenter=!0):this.isEnableNewHelpCenter=!1;var a=e.HKCJWT;if(void 0!=a){var n=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HKCJWT"]');a=KD.isArray(a)?a:[],a=this._generalHelpPagesDataSource(a,"commonproblem"),n.data("kendoListView")&&n.data("kendoListView").setDataSource(new kendo.data.DataSource({data:a.slice(0,6)}))}var o=e.HKGJJQ;if(void 0!=o){var r=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HKGJJQ"]');o=KD.isArray(o)?o:[],KD.isEmpty(o)?this.helpContainer.find('.knowledgepulldownlist select [value="HKGJJQ"]').remove():(o=this._generalHelpPagesDataSource(o,""),r.data("kendoListView")&&r.data("kendoListView").setDataSource(new kendo.data.DataSource({data:o.slice(0,6)})))}var s=e.HNCPGS;if(void 0!=s){var l=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HNCPGS"]');s=KD.isArray(s)?s:[],KD.isEmpty(s)||l.css({"padding-bottom":"10px"}),s=this._generalHelpPagesDataSource(s,""),l.data("kendoListView")&&l.data("kendoListView").setDataSource(new kendo.data.DataSource({data:s.slice(0,4)}))}var d=e.HNXSRM;if(void 0!=d){var c=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HNXSRM"]');c.css({"padding-bottom":"10px"}),d=KD.isArray(d)?d:[],KD.isEmpty(d)?this.helpContainer.find('.knowledgepulldownlist select [value="HNXSRM"]').remove():(d=this._generalHelpPagesDataSource(d,""),c.data("kendoListView")&&c.data("kendoListView").setDataSource(new kendo.data.DataSource({data:d.slice(0,4)})))}var h=e.HXTX;if(void 0!=h){var u=this.helpContainer.find('.kd_cloudusinghelp_article_list[kdrole="HXTX"]');h=KD.isArray(h)?h:[],h=this._generalHelpPagesDataSource(h,"HXTX"),u.data("kendoListView")&&u.data("kendoListView").setDataSource(new kendo.data.DataSource({data:h.slice(0,1)}))}this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HNCPGS"]').find(".kd_cloudusinghelp_quicklystart_container_item img").off("error").on("error",function(){var e=KD.getUrlSubRoot()+"/images/biz/default/MainConsole/H5CardLayout/loadfail03.png";$(this).attr("src",e)}),this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HNXSRM"]').find(".kd_cloudusinghelp_quicklystart_container_item img").off("error").on("error",function(){var e=KD.getUrlSubRoot()+"/images/biz/default/MainConsole/H5CardLayout/loadfail03.png";$(this).attr("src",e)}),KD.delayInvoke(function(){var e=t.helpContainer.find(".kd-ui-blockingExtention-item");e.hide()},1500)}if(this.helpAssistant){var p=this.helpAssistant&&this.helpAssistant.find(".kd_cloudusinghelp_header_container .kd_txt_title"),g=e.helptitle?e.helptitle:ResManager.LoadKDString("帮助助手","0025710000004792");p&&p.text(g);var f=e.NEWFET;if(void 0!=f){var m=this.helpAssistant.find('.kd_cloudusinghelp_article_list[kdrole="NEWFET"]');f=KD.isArray(f)?f:[],f=this._getHelpAssiatantItemSourse(f,"NEWFET"),m.data("kendoListView")&&m.data("kendoListView").setDataSource(new kendo.data.DataSource({data:f.slice(0,5)})),this._bindHelpAssistantData(m,e.NEWFET)}var v=e.YBTHPT,y=v.length;if(void 0!=v){0==v.length?this.articleWithTitleComponentFirst&&this.articleWithTitleComponentFirst.is(":visible")&&this.articleWithTitleComponentFirst.hide():this.articleWithTitleComponentFirst&&!this.articleWithTitleComponentFirst.is(":visible")&&this.articleWithTitleComponentFirst.show();var b=this.helpAssistant.find('.kd_cloudusinghelp_article_list[kdrole="YBTHPT"]');v=KD.isArray(v)?v:[],v=this._getHelpAssiatantItemSourse(v,"YBTHPT"),b.data("kendoListView")&&b.data("kendoListView").setDataSource(new kendo.data.DataSource({data:v.slice(0,16)})),this._bindHelpAssistantData(b,e.YBTHPT)}var D=e.YBTHPT1,k=D.length;if(void 0!=D){0==D.length?this.articleWithTitleComponentSecond&&this.articleWithTitleComponentSecond.is(":visible")&&this.articleWithTitleComponentSecond.hide():this.articleWithTitleComponentSecond&&!this.articleWithTitleComponentSecond.is(":visible")&&this.articleWithTitleComponentSecond.show();var b=this.helpAssistant.find('.kd_cloudusinghelp_article_list[kdrole="YBTHPT_1"]');D=KD.isArray(D)?D:[],D=this._getHelpAssiatantItemSourse(D,"YBTHPT1"),b.data("kendoListView")&&b.data("kendoListView").setDataSource(new kendo.data.DataSource({data:D.slice(0,16)})),this._bindHelpAssistantData(b,e.YBTHPT1)}var C=e.YBTHPT2,x=C.length;if(void 0!=C){0==C.length?this.articleWithTitleComponentThird&&this.articleWithTitleComponentThird.is(":visible")&&this.articleWithTitleComponentThird.hide():this.articleWithTitleComponentThird&&!this.articleWithTitleComponentThird.is(":visible")&&this.articleWithTitleComponentThird.show();var b=this.helpAssistant.find('.kd_cloudusinghelp_article_list[kdrole="YBTHPT_2"]');C=KD.isArray(C)?C:[],C=this._getHelpAssiatantItemSourse(C,"YBTHPT2"),b.data("kendoListView")&&b.data("kendoListView").setDataSource(new kendo.data.DataSource({data:C.slice(0,16)})),this._bindHelpAssistantData(b,e.YBTHPT2)}this.imgLinkedList&&this.imgLinkedList.timer&&(clearInterval(this.imgLinkedList.timer),this.imgLinkedList.timer=null);var w=e.LBTGRP;if(void 0!=w){var K=new this.initImgLinkedList;w=KD.isArray(w)?w:[],w=this._getHelpAssiatantItemSourse(w,"LBTGRP");for(var S=w.length>5?5:w.length,I=0;S>I;I++)K.listPush(w[I]);if(this.slideShowContainer&&this.slideShowContainer.remove(),K.length>0){this.imgLinkedList=K;var P=this._initImgShowComponent.call(this,K);this.imgLinkedList.imgComponent=P,this.imgLinkedList.head.slideBtn.addClass("kd-currentImg-slidebtn"),this.slideShowContainer=$('<div class="kd_cloudusinghelp_modular_container"></div>').append(P).appendTo(this.helpAssistant),K.timer=setInterval(function(){t.imgLinkedList.imgSlide()},3200),this._bindHelpAssistantData(P,e.LBTGRP)}}this.YBTHideLinesFirst=this.articleWithTitleComponentFirst.find(".kd-helpAssistant-linehide"),this.YBTHideLinesSecond=this.articleWithTitleComponentSecond.find(".kd-helpAssistant-linehide"),this.YBTHideLinesThird=this.articleWithTitleComponentThird.find(".kd-helpAssistant-linehide");var F='<div class="kd_cloudusinghelp_article_item_container kd-helpAssistant-articleWithTitle-cellLine kd-helpassistant-expandbtn-list" role="option" aria-selected="false"><sapn class="kd-helpassistant-expandbtn-text"></sapn><sapn class="kd-helpassistant-expand-arrow"></sapn></div>';y>6&&this.articleWithTitleComponentFirst.find(".kd_cloudusinghelp_article_list").append($(F)),k>6&&this.articleWithTitleComponentSecond.find(".kd_cloudusinghelp_article_list").append($(F)),x>6&&this.articleWithTitleComponentThird.find(".kd_cloudusinghelp_article_list").append($(F));var T=this.helpAssistant&&this.helpAssistant.find(".kd-helpassistant-expandbtn-list");T.off("click").on("click",function(e){var i,a=$(this),n=a.parent(".kd_cloudusinghelp_article_list"),o=n.attr("kdrole");switch(o){case"YBTHPT":i=t.YBTHideLinesFirst;break;case"YBTHPT_1":i=t.YBTHideLinesSecond;break;case"YBTHPT_2":i=t.YBTHideLinesThird}i.hasClass("kd-helpAssistant-linehide")?i.removeClass("kd-helpAssistant-linehide"):i.addClass("kd-helpAssistant-linehide");var r=a.find(".kd-helpassistant-expandbtn-text"),s=a.find(".kd-helpassistant-collapsebtn-text"),l=a.find(".kd-helpassistant-expand-arrow"),d=a.find(".kd-helpassistant-collapse-arrow");r.length?r.removeClass("kd-helpassistant-expandbtn-text").addClass("kd-helpassistant-collapsebtn-text"):s.length&&s.removeClass("kd-helpassistant-collapsebtn-text").addClass("kd-helpassistant-expandbtn-text"),l.length?l.removeClass("kd-helpassistant-expand-arrow ").addClass("kd-helpassistant-collapse-arrow"):d.length&&d.removeClass("kd-helpassistant-collapse-arrow").addClass("kd-helpassistant-expand-arrow ")})}},showHelpPages:function(e){var t=this;if(e=e||{},this.helpContainer){if(e.isresetdata){var i=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HKCJWT"]');i.data("kendoListView")&&i.data("kendoListView").setDataSource(new kendo.data.DataSource({data:[]}));var a=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HKGJJQ"]');a.data("kendoListView")&&a.data("kendoListView").setDataSource(new kendo.data.DataSource({data:[]}));var n=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HNCPGS"]');n.data("kendoListView")&&n.data("kendoListView").setDataSource(new kendo.data.DataSource({data:[]}));var o=this.helpContainer.find('.kd_cloudusinghelp_modular_container [kdrole="HNXSRM"]');o.data("kendoListView")&&o.data("kendoListView").setDataSource(new kendo.data.DataSource({data:[]}))}}else{this.helpContainer=$('<div class="kd_cloudusing_article_help_container" id="kd_cloudusing_article_help_container" tabIndex="0"></div> '),this.helpContainer.appendTo($("body")),this.helpContainer.css({top:this.component.offset().top});var r=$(kendo.format('<div class="kd_cloudusinghelp_header_container"><div class="kd_item kd_txt_title">{0}</div><div class="kd_item kd_btn_close" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon.png")+');" title="{1}"></div></div>',ResManager.LoadKDString("帮助助手","0025710000004792"),ResManager.LoadKDString("点击关闭","0025710000004793")));this.helpContainer.append(r),r.find(".kd_btn_close").click(function(e){t.imgLinkedList&&t.imgLinkedList.timer&&(clearInterval(t.imgLinkedList.timer),t.imgLinkedList.timer=null),t.helpContainer.hide(),t.isSetHelpPanelVisible=!1});var s=$('<div unselectable="on" kdrole="cloudhelpdocument" class="kd_cloudusinghelp_article_list"></div>').appendTo(this.helpContainer),l=$(kendo.format('<div class="kd_cloudusinghelp_article_item_container" ><div class="kd_item kd_title" style="cursor: pointer;width:100%;"><span class="kd-icon" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span><span class="kd-value">{0}</span></div></div>',ResManager.LoadKDString("用户帮助手册","0025710000004898"))).appendTo(s);l.click(function(e){var i=t.getFormProxy();i.fireEvent.call(i,"CustomEvents","Kingdee.BOS.MainTabControl","Kingdee.BOS.WikiHelp",KD.stringify({})),i.fireEvent.call(i,"ButtonClick","btWikiHelp","WikiHelp",null)});var d=$('<div unselectable="on" kdrole="HXTX" class="kd_cloudusinghelp_article_list" style="background:rgba(238,240,243,1)"></div>').appendTo(this.helpContainer),c=kendo.format('<div class="kd_cloudusinghelp_article_item_container" ><div class="kd_item kd_title" style="cursor: pointer;width:100%;"><span class="kd-icon" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');background-position: -43px -1509px"></span><span class="kd-value kd-newspecialtitle">{0}</span></div></div>',"#:title#");d.kendoListView({dataSource:[],template:c,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._helpItemClick(e,"HXTX")}});var h=($(kendo.format('<div class="kd_helpmanual_containerartitle">{0}</div>',ResManager.LoadKDString("业务知识","002014030034024"))).appendTo(this.helpContainer),$('<div class="kd_cloudusinghelp_modular_container"></div>').appendTo(this.helpContainer)),u=$(kendo.format('<div class="knowledgepulldownlist"><select style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png")+');background-position: 390px -264px"><option seleted="seleted" value="HKCJWT">{0}</option><option value="HKGJJQ">{1}</option></select></div>',ResManager.LoadKDString("常见问题","0025710000004795"),ResManager.LoadKDString("高阶技巧","0025710000004795"))).appendTo(h),p=u.find("option:selected").val()||"";u.find("select").change(function(e){p=t.toggleKnowledgeListVisible.call(this,p)});var g=$('<div unselectable="on" kdrole="HKCJWT" class="kd_cloudusinghelp_article_list"></div>').appendTo(h),f=kendo.format('<div class="kd_cloudusinghelp_article_item_container" style="margin:0 auto" title="{2}"><div class="kd_item kd_value">{1}</div><div class="kd_item kd_type {5}" style="border-color:{3};color:white;margin-right:5px;background-color:{3}">{4}</div><div class="kd_item kd_title {5}">{2}</div></div>',"#:url #","#:key #","#:title #","#:type #","#:typename #","#:focusshowmodel #");g.kendoListView({dataSource:[],template:f,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._helpItemClick(e)}});var m=$('<div unselectable="on"  kdrole="HKGJJQ" class="kd_cloudusinghelp_article_list kd-articlelist-hidden"></div>').appendTo(h),v=f;m.kendoListView({dataSource:[],template:v,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._helpItemClick(e)}});var y=$(kendo.format('<div class="kd_cloundusinghelp_btn_morecontent"><a>{0}</a></div>',ResManager.LoadKDString("更多内容","0025710000004798"))).appendTo(h);y.click(function(e){var i=t.getCurrentFormId(),a={},n=t.getFormProxy();a.currentpageid=i,n&&n.fireCustomEventsNoData("Kingdee.BOS.Knowledge","Kingdee.BOS.KnowledgeHotestMore",KD.stringify(a))});var b=$('<div class="kd_cloudusinghelp_modular_container"></div>').appendTo(this.helpContainer),D=$(kendo.format('<div class="knowledgepulldownlist"><select style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png")+');background-position: 390px -264px" ><option seleted="seleted" value="HNCPGS">{0}</option><option value="HNXSRM">{1}</option></select></div>',ResManager.LoadKDString("产品快速入门","00215181030034077"),ResManager.LoadKDString("业务快速入门","00215181030034078"))).appendTo(b),k=D.find("option:selected").val()||"",C=$('<div unselectable="on"  kdrole="HNCPGS" class="kd_cloudusinghelp_quicklystart_container"></div>').appendTo(b),x=kendo.format('<div class="kd_cloudusinghelp_quicklystart_container_item"  style="box-shadow: 0px 2px 10px 0px rgba(0,0,0,0.05);" title="{3}"><div class="kd_value">{1}</div><img class="kd_img_log" src="{2}"><div class="kd_title">{3}</div></div>',"#:url #","#:key #","#:imgurl #","#:title #");C.kendoListView({dataSource:[],template:x,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._helpItemClick(e)}});var w=$('<div unselectable="on"  kdrole="HNXSRM" class="kd_cloudusinghelp_quicklystart_container kd-articlelist-hidden"></div>').appendTo(b),K=x;w.kendoListView({dataSource:[],template:K,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._helpItemClick(e)}}),D.find("select").change(function(e){k=t.toggleKnowledgeListVisible.call(this,k)});var S=$(kendo.format('<div class="kd_cloundusinghelp_btn_morecontent"><a>{0}</a></div>',ResManager.LoadKDString("更多课程","0025710000004798"))).appendTo(b);S.click(function(e){var i=t.getCurrentFormId(),a={},n=t.getFormProxy();a.currentpageid=i,n&&n.fireCustomEventsNoData("Kingdee.BOS.Knowledge","Kingdee.BOS.KnowledgeNewestMore",KD.stringify(a))});var I=$('<div class="kd-ui-blockingExtention-item" style="display:none;height:100%;top:0px;"><div class="" style="height: 100%;top: 0px;background-color: #FFF;opacity: 0.5;position: absolute;width: 100%;"></div><img src="content/themes/images/ui_loading.gif"></div>');I.appendTo(this.helpContainer)}if(this.helpContainer)if(this.isEnableNewHelpCenter)this.helpContainer.hide();else{var P=this.component.offset();this.component.outerWidth(),$("body").outerWidth();this.helpContainer.show().css({height:this.component.height(),"min-height":$(window).height()-P.top}),this.helpContainer.off("focusout").focus().focusout(function(e){if(!t.isEnableNewHelpCenter){var i;if(KD.isIeBrowser())i=$(document.activeElement);else if(i=$(e.relatedTarget),null==e.relatedTarget)return;return i.closest(".kd_cloudusing_article_help_container").length>0||i.hasClass("kd-guidepromptintro-maskLayer")||i.closest(".kd-popover").length>0?void t.helpContainer.focus():void t.helpContainer.hide(700,function(){t.isSetHelpPanelVisible=!1})}})}},showHelpAssistant:function(){var e=this;if(!this.helpAssistant){this.helpAssistant=$('<div class="kd_cloudusing_article_help_container" id="kd_cloudusing_article_help_container" tabIndex="0"></div> '),this.helpAssistant.css({top:this.component.offset().top});var t=$(kendo.format('<div class="kd_cloudusinghelp_header_container"><div class="kd_item kd_txt_title">{0}</div><div class="kd_item kd_btn_close" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon.png")+');" title="{1}"></div></div>',ResManager.LoadKDString("帮助助手","0025710000004792"),ResManager.LoadKDString("点击关闭","0025710000004793")));
this.helpAssistant.append(t),t.find(".kd_btn_close").click(function(t){e.imgLinkedList&&e.imgLinkedList.timer&&(clearInterval(e.imgLinkedList.timer),e.imgLinkedList.timer=null),e.helpAssistant.hide(),e.isSetHelpPanelVisible=!1});var i=($('<div unselectable="on" kdrole="cloudhelpdocument" class="kd_cloudusinghelp_article_list"></div>').appendTo(this.helpAssistant),$('<div unselectable="on" kdrole="NEWFET" class="kd_cloudusinghelp_article_list kd-helparticle-notitle-list"></div>').appendTo(this.helpAssistant)),a=kendo.format('<div class="kd_cloudusinghelp_article_item_container" title="{0}"><div class="kd_item" style="width:100%;"><span class="kd-helpassistant-mainIcon" style="background-image:url(../{1});"></span><span data-url={3} class="kd-value kd-newspecialtitle kd-helparticle-link">{0}</span><span class="kd-helpassistant-leftIcon" style="background-image:url(../{2});"></span></div></div>',"#:title #","#:mainimg #","#:rightimg #","#:url #");i.kendoListView({dataSource:[],template:a,autoBind:!0,selectable:!0,navigatable:!0,change:function(t){e._helpItemClick(t,"NEWFET")}});var n=$('<div class="kd_cloudusinghelp_modular_container"></div>').appendTo(this.helpAssistant);this.articleWithTitleComponentFirst=n;var o=$('<div unselectable="on" kdrole="YBTHPT" class="kd_cloudusinghelp_article_list"></div>').appendTo(n),r=kendo.format('<div class="kd_cloudusinghelp_article_item_container kd-helpAssistant-articleWithTitle-cellLine {5} {6}" title="{2}" item-index="{1}"><span data-url="{0}" class="kd_item kd_title">{2}</span><span class="kd-helpassistant-leftIcon" style="background-image:url(../{3});"></span><sapn class="kd-helpassistant-articlewithtitle-arrow" style="display:{4};"></span></div>',"#:url #","#:index #","#:title #","#:rightimg #","#:arrowdisplay #","#:titlestyle #","#:eachlinestyle #");o.kendoListView({dataSource:[],template:r,autoBind:!0,selectable:!0,navigatable:!0,change:function(t){e._helpItemClick(t,"YBTHPT")}});var s=$('<div class="kd_cloudusinghelp_modular_container"></div>').appendTo(this.helpAssistant);this.articleWithTitleComponentSecond=s;var o=$('<div unselectable="on" kdrole="YBTHPT_1" class="kd_cloudusinghelp_article_list"></div>').appendTo(s),r=kendo.format('<div class="kd_cloudusinghelp_article_item_container kd-helpAssistant-articleWithTitle-cellLine {5} {6}" title="{2}" item-index="{1}"><span data-url="{0}" class="kd_item kd_title">{2}</span><span class="kd-helpassistant-leftIcon" style="background-image:url(../{3});"></span><sapn class="kd-helpassistant-articlewithtitle-arrow" style="display:{4};"></span></div>',"#:url #","#:index #","#:title #","#:rightimg #","#:arrowdisplay #","#:titlestyle #","#:eachlinestyle #");o.kendoListView({dataSource:[],template:r,autoBind:!0,selectable:!0,navigatable:!0,change:function(t){e._helpItemClick(t,"YBTHPT1")}});var l=$('<div class="kd_cloudusinghelp_modular_container"></div>').appendTo(this.helpAssistant);this.articleWithTitleComponentThird=l;var o=$('<div unselectable="on" kdrole="YBTHPT_2" class="kd_cloudusinghelp_article_list"></div>').appendTo(l),r=kendo.format('<div class="kd_cloudusinghelp_article_item_container kd-helpAssistant-articleWithTitle-cellLine {5} {6}" title="{2}" item-index="{1}"><span data-url="{0}" class="kd_item kd_title">{2}</span><span class="kd-helpassistant-leftIcon" style="background-image:url(../{3});"></span><sapn class="kd-helpassistant-articlewithtitle-arrow" style="display:{4};"></span></div>',"#:url #","#:index #","#:title #","#:rightimg #","#:arrowdisplay #","#:titlestyle #","#:eachlinestyle #");o.kendoListView({dataSource:[],template:r,autoBind:!0,selectable:!0,navigatable:!0,change:function(t){e._helpItemClick(t,"YBTHPT2")}}),this.helpAssistant.appendTo($("body"))}if(this.helpAssistant){var d=this.component.offset();this.component.outerWidth();this.helpAssistant.show().css({height:this.component.height(),"min-height":$(window).height()-d.top}),this.helpAssistant.off("focusout").focus().focusout(function(t){var i;if(KD.isIeBrowser())i=$(document.activeElement);else if(i=$(t.relatedTarget),null==t.relatedTarget)return;return i.closest(".kd_cloudusing_article_help_container").length>0||i.hasClass("kd-guidepromptintro-maskLayer")||i.closest(".kd-popover").length>0?void(e.helpAssistant&&e.helpAssistant.focus()):void(e.helpAssistant&&e.helpAssistant.hide(700,function(){e.imgLinkedList&&e.imgLinkedList.timer&&(clearInterval(e.imgLinkedList.timer),e.imgLinkedList.timer=null),e.isSetHelpPanelVisible=!1}))})}},_getHelpAssiatantItemSourse:function(e){if(!KD.isArray(e))return[];for(var t=[],i=0;i<e.length;i++){var a={},n=e[i];a.index=n[0],a.title=n[1],a.moredisplay=n[3]?"none":"inline-block",a.titlestyle=n[3]?"":"kd-helpassistant-articletitle",a.arrowdisplay=n[3]?"inline-block":"none",a.rightimg=n[5],a.url=n[6]?n[6]:"",a.mainimg=n[7],a.eachlinestyle=i>5?"kd-helpAssistant-linehide":"",t.push(a)}return t},_bindHelpAssistantData:function(e,t){if(KD.isArray(t)){var i;if(e&&e.find(".kd_cloudusinghelp_article_item_container").length)i=e.find(".kd_cloudusinghelp_article_item_container");else{if(!e||!e.children("span").length)return;i=e.find("span")}for(var a=0;a<t.length&&i[a];a++)$(i[a]).get(0).sourcedata=t[a]}},_initImgShowComponent:function(e){var t,a=this,n=e.head,o=$('<div class="kd-helpassistant-imgslideshow-container"></div>'),r=$('<div class="kd-helpassistant-slidebtn-container"></div>');for(i=0;i<e.length;i++)n.imgEl.appendTo(o),t=$('<span slide-index="'+i+'"></span>'),t.appendTo(r),n.slideBtn=t,n=n.next;o.append(r),e.slideShowContainer=o;var s=o.find("span"),l=r.children();return s.off("click").on("click",function(e){a._helpAssistantGroupClick(e,"LBTGRP")}),l.off("click").on("click",function(t){var i=$(this).attr("slide-index");e.slideTo(i)}),o.off("mouseover").on("mouseover",function(t){e.timer&&(clearInterval(e.timer),e.timer=null)}),o.off("mouseout").on("mouseout",function(t){e.timer=setInterval(function(){e.imgSlide()},3200)}),o},initImgLinkedList:function(){function e(e){var t=e.url;this.img=t,this.imgEl=$(kendo.format('<span data-url="{0}"><img src="data:image/jpg;base64,{1}"></span>',t,e.mainimg)),this.next=null}this.head=null,this.length=0,this.listPush=function(t){var i=new e(t);if(this.head){for(var a=this.head;a.next;)a=a.next;a.next=i}else this.head=i;this.length++},this.imgSlide=function(){var e=this.head;this.head.next&&(this.head=this.head.next);for(var t=this.head;t.next;)t=t.next;e.next=null,t.next=e;var i=this.imgComponent.find("img:visible");i.hide(300),this.head.imgEl.find("img").show(1e3),this.slideShowContainer.find("span.kd-currentImg-slidebtn").removeClass("kd-currentImg-slidebtn"),this.head.slideBtn.addClass("kd-currentImg-slidebtn")},this.slideTo=function(e){for(var t=this.head.slideBtn.attr("slide-index");t!=e;){var i=this.head;this.head.next&&(this.head=this.head.next);for(var a=this.head;a.next;)a=a.next;i.next=null,a.next=i,t=this.head.slideBtn.attr("slide-index")}var n=this.imgComponent.find("img:visible");n.hide(),this.head.imgEl.find("img").show(),this.slideShowContainer.find("span.kd-currentImg-slidebtn").removeClass("kd-currentImg-slidebtn"),this.head.slideBtn.addClass("kd-currentImg-slidebtn")}},handleHelpAssistantData:function(e){if(!KD.isArray(e))return!1;var t=this.getFormProxy(),i=this.getCurrentFormId(),a=this.isShowFunctionGuid&&"__kdHelpContainer"==this.isShowFunctionGuid.key?"true":"";this.showHelpAssistant();var n=e[0]&&KD.getValue(e[0],"forpageid",""),o={currentpageid:n||i,guidvisible:a,clickmodel:KD.getValue(e[0],"clickmodel",""),modelvalue:KD.getValue(e[0],"modelvalue",""),showred:KD.getValue(e[0],"showred",!1),otherp:e[0]};t.fireEvent.call(t,"CustomEvents","Kingdee.BOS.MainTabControl","Kingdee.BOS.MainTabControl.HelpAssistant",KD.stringify(o))},setAllowHelpAssistant:function(e){this.AllowHelpAssistant=e},setCloudUsinghelpVisible:function(e){if(this.isNeedCloudUsinghelp=e,this.helpContainer){var t=this.helpContainer.find('.kd_cloudusinghelp_article_list[role="introductionguide"] .kd_cloudusinghelp_Guid_container');e?t.show():t.hide()}},setGuide:function(e,t,i){KDMainTabControlProxy.superclass.setGuide.call(this,e,t,i),this.helpContainer&&this.helpContainer.addClass("kd-guidepromptintro-inner")},afterGuideClose:function(e){this.helpContainer&&(this.helpContainer.removeClass("kd-guidepromptintro-inner"),this.helpContainer.hide(),this.isSetHelpPanelVisible=!1)},_helpItemClick:function(e,t){if(e&&e.sender){var i=e.sender._current,a=i&&i.get(0),n=a&&a.sourcedata,o=e.sender.dataItem(e.sender.current())||{},r=o.url,s="bt"+(o.itemtype||"knowledge")+"LinkOpen",l={};l.apitype="help",l.searchtext="",l.location=t||"",l.currentpageid=this.getCurrentFormId(),l.openurl=r,l.data=n||[];var d=this.getFormProxy();d&&d.fireCustomEventsNoData("Kingdee.BOS.Knowledge","Kingdee.BOS.KnowledgeLinkOpen",KD.stringify(l)),d&&d.fireEvent.call(d,"ButtonClick",s,s,null)}},_helpAssistantGroupClick:function(e,t){var i=$(e.currentTarget),a=i&&i.get(0),n=a&&a.sourcedata,o=i.attr("data-url"),r="btknowledgeLinkOpen",s={};s.apitype="help",s.searchtext="",s.location=t||"",s.currentpageid=this.getCurrentFormId(),s.openurl=o,s.data=n||[];var l=this.getFormProxy();l&&(l.fireCustomEventsNoData("Kingdee.BOS.Knowledge","Kingdee.BOS.KnowledgeLinkOpen",KD.stringify(s)),l.fireEvent.call(l,"ButtonClick",r,r,null))},toggleKnowledgeListVisible:function(e){$(this).closest(".kd_cloudusinghelp_modular_container").find('[kdrole="'+e+'"]').addClass("kd-articlelist-hidden");var t=$(this).val()||$(this).children("option:selected").val()||"",i='[kdrole="'+t+'"]',a=$(this).closest(".kd_cloudusinghelp_modular_container").find(i);return a&&a.removeClass("kd-articlelist-hidden"),t},setHelpButtonVisible:function(e){var t=this.component.find("ul>li>#__kdHelpContainer");e?t.show():t.hide()},setHelpPanelVisible:function(e){var t=this.helpContainer,i=this.component.find("ul>li>#__kdHelpContainer");if(this.isEnableNewHelpCenter&&i&&i.length>0)return i.click(),void(this.isSetHelpPanelVisible=!0);if(!t&&i&&i.length>0)return i.click(),void(this.isSetHelpPanelVisible=!0);if(this.isSetHelpPanelVisible&&!KD.isEmpty(t)&&t.length>0)t.hide(),this.isSetHelpPanelVisible=!1;else if(i&&i.length>0)return i.click(),void(this.isSetHelpPanelVisible=!0)},setFunctionGuid:function(e){if(!KD.isEmpty(e)&&KD.isObject(e)){this.isShowFunctionGuid=e;var t=this.component.find("#"+e.key),i=t.find(".kd-ui-function-guid");e.visible?0==i.length?t.append($(kendo.format('<div class="kd-ui-function-guid" title="{0}"></div>',e.tooltip))):i.show():i.hide()}},setSelectToPageId:function(e){this.selectToPageId=e},getSelectToPageId:function(){return this.selectToPageId},setItemDisAutoSel:function(e){for(var t in e)if(KD.isRunInForIn(t,e)){var i=e[t],a=KD.getValue(i,"key",""),n=KD.getValue(i,"value",!1);if(a){var o=this._getTabItemIndexbyAnyFormKey(a,"item");o&&o.setItemDisAutoSel&&o.setItemDisAutoSel.call(o,n)}}},closeAllTabsExceptCurrent:function(){this.closeAllTabs(!0)},closeAllTabs:function(e){for(var t in this.children){var i=this.children[t];0==t||0==i.config.closable||1==e&&i.baseId==this.getCurrentPageId()||this.closeTabItem(i)}},closeCurrentTabItemByPageId:function(e){for(var t in this.children){var i=this.children[t];if(i.baseId==e){this.closeTabItem(i);break}}}}),KDMainTabControlProxy.getAllFeatureKey=function(){return"__AllFeatureContainer".toUpperCase()},KDMainTabControlProxy.getFavoriteKey=function(){return"__FavoriteContainer".toUpperCase()},KDMainTabControlProxy.isExtKey=function(e){return e==KDMainTabControlProxy.getAllFeatureKey()||e==KDMainTabControlProxy.getFavoriteKey()},KDControlFactoryProxy.registerType("kdmaintab",KDMainTabControlProxy),define("KDMainTabControlProxy",["KDTabControlProxy","KD"],function(e){return function(){var t;return t||e.KDMainTabControlProxy}}(this)),KDItemContainerProxy=KD.extend(KDControlProxy,{isLableHyperlink:!1,defEditorHeight:21,defInnerFontHeight:12,createControl:function(e){KDItemContainerProxy.superclass.createControl.call(this,e),KD.layout.isDock(e)||(e.width=KD.layout.getZoomInPx(e.width),e.labelWidth=KD.layout.getZoomInPx(e.labelWidth)),this.el=this.el.KDItemContainer({defEditorHeight:this.defEditorHeight,defInnerFontHeight:this.defInnerFontHeight}),this.height=KD.layout.isDock(e)?e.height:this.getHeight(e.height),this.innerHeight=this.getInnerHeight(),KD.layout.isDock(e)||e.height==this.defEditorHeight?KD.layout.isDock(e)||(e.item.height=e.height):e.item.height=this.getInnerHeightPx()+2;var t={"float":"left",height:this.height,display:"inline-block"};e.dock!=KD.dock.FieldSet&&(t.display="inline-flex"),(KDFlowlayoutProxy.getCtOrientation(e)||KD.layout.isFieldSet(e))&&delete t["float"],this.el.css(t)},loadConfig:function(e){var t=this;switch(t.config.metaHeight||(t.config.metaHeight=t.config.height),t.config.metaWidth||(t.config.metaWidth=t.config.width),e.dock){case KD.dock.Fill:e.width=KD.layout.getActualWidth(this.el.parent())-2,e.height=KD.layout.getActualHeight(this.el.parent())-2,e.item.height=e.height;break;case KD.dock.Top:case KD.dock.Bottom:e.width=KD.layout.getActualWidth(this.el.parent())-2;break;case KD.dock.Left:case KD.dock.Right:e.height=KD.layout.getActualHeight(this.el.parent())-2}this.el.loadConfig(e);var i=this.getParentProxy.call(this)||{};e.item.id=e.id+"-editor",e.item.labelText=e.labelText,e.item.PositionDescription=KD.getValue(e,"PositionDescription",""),e.item.parentTabControlKey=KD.getValue(e,"parentTabControlKey",""),KD.isEmpty(e.item.parentTabControlKey)&&(e.item.parentTabControlKey=e.parentTabControlKey=KD.getValue(i.config,"parentTabControlKey","")),e.item.parentTabItemKey=KD.getValue(e,"parentTabItemKey",""),KD.isEmpty(e.item.parentTabItemKey)&&(e.item.parentTabItemKey=e.parentTabItemKey=KD.getValue(i.config,"parentTabItemKey","")),e.item.parentTabItemTitle=e.item.PositionDescription||KD.getValue(e,"parentTabItemTitle",""),KD.isEmpty(e.item.parentTabItemTitle)&&(e.item.parentTabItemTitle=e.parentTabItemTitle=KD.getValue(i.config,"parentTabItemTitle","")),e.item.labelAlign=KD.getValue(e,"labelAlign",0);var a=e.width-e.labelWidth-KD.CONST.ItemContainerOtherWidth;e.item.width=0>a?0:a;var n=this.getControlFactoryProxy();this.editor=n.createControl.call(n,e.item),this.editor.setItemContainer.call(this.editor,this),this.el.setEditor.call(this.el,this.editor.getControl()),this.editor.loadConfig.call(this.editor,e.item);var o=this.el.find("[role=kdspanlabel]");if(t.isLableHyperlink=KD.getValue(e.item,"IsLableHyperlink",!1),0==(!t.isLableHyperlink||"bosf7field"!=t.config.item.xtype)&&(o.css({width:"auto"}).addClass("kd-label-hyperLink"),o.click(function(e){t.title_Click(e)})),this.setIsHyperlink(e.item.IsLableHyperlink&&"bosf7field"==t.config.item.xtype),this.editor.postKey=e.id,this.editor&&this.editor.setItemContaonerStyle){var r=this.config.height;(this.config.dock==KD.layout.fill||this.config.dock==KD.layout.left||this.config.dock==KD.layout.right)&&(r=KD.layout.getActualHeight(this.el)),this.editor.setItemContaonerStyle.call(this.editor,r)}},setRequestLock:function(e){var t=this.editor;t&&t.setRequestLock.call(t,e)},setServerLock:function(e){var t=this.editor;t&&t.setServerLock.call(t,e)},setViewLocked:function(e){var t=this.editor;t&&t.setViewLocked.call(t,e)},getHeight:function(e){return this.el.getHeight.call(this.el,e)},getInnerHeight:function(){return this.el.getInnerHeight.call(this.el,this.height)},getInnerHeightPx:function(){return this.el.getInnerHeightPx.call(this.el,this.height)},title_Click:function(e){var t=this.editor.getCommitData(this.editor._value),i=KD.isObject(t.value)?t.value.number:t.value;this.getFormProxy().fireEvent("FieldLabelClick",this.editor.postKey,0,i)},setIsHyperlink:function(e){this.isLableHyperlink=e;var t=this.el.find("[role=kdlabel]");e?t.css("text-decoration","underline"):t.css("text-decoration","blink")},initComponent:function(){if(KDItemContainerProxy.superclass.initComponent.call(this),this.editor.config.mustinput=this.editor.config.mustinput||this.config.mustinput||"false",this.editor.initComponent.call(this.editor),this.editor&&this.editor.setItemContaonerStyle){var e=0==this.config.height?this.height:this.config.height;(this.config.dock==KD.layout.fill||this.config.dock==KD.layout.left||this.config.dock==KD.layout.right)&&(e=KD.layout.getActualHeight(this.el)),this.editor.setItemContaonerStyle.call(this.editor,e)}this.editor&&this.editor.setMustInput&&this.editor.setMustInput.call(this.editor,this.config.mustinput||"false"),KD.isEmpty(this.config.disabled)||this.setDisabled(this.config.disabled)},setDisabled:function(e){if(this.editor&&this.editor.setDisabled)try{this.editor.setDisabled.call(this.editor,e)}catch(t){this.editor.disabled=e}},setValue:function(e){this.editor&&this.editor.setValue&&this.editor.setValue.call(this.editor,e)},setEmptyTip:function(e){this.editor&&this.editor.setEmptyTip&&this.editor.setEmptyTip.call(this.editor,e)},getValue:function(){return this.editor&&this.editor.getValue?this.editor.getValue.call(this.editor):void 0},isInView:function(){var e=!0;if(e=this.isVisible(),e&&this.dock==KD.dock.None&&this.config&&this.parentProxy){var t=KD.layout.getActualSize(this.parentProxy.el),i=this.config.x,a=this.config.y,n=i>0&&i<t.width,o=a>0&&a<t.height;n&&o||"auto"==this.parentProxy.el.css("overflow")||(e=!1)}return e},focus:function(e,t){var i=this,a=null;t=t?!0:!1;var n={preventScroll:t};if(i.editor){if(!this.isInView())return void KD.writeLog(KD.format("{0}.focus() Error",this.config.id),"the element is't in current view!",!0);a=void 0!=i.editor.component?i.editor.component:void 0!=i.editor.el?i.editor.el:i.editor;var o;if(a.hasClass("k-input"))o=a,o[0].focus(n);else{var r=a.find(".k-input");r.length>0?(o=r.first(),o[0].focus(n)):a&&a.focus&&(o=a,o[0].focus(n))}o&&o.select&&(KD.isEmpty(i.editor.focusSelectMode)||3==i.editor.focusSelectMode)&&o.select(),i.editor&&i.editor.focus&&i.editor.focus.call(i.editor,e)}},setMustInput:function(e){var t=this;if(this.editor.mustInput=this.config.mustinput=e,this.el&&this.el.setMustInput){var i=KD.getValue(this.config.item,"EmptyTip","");this.el.setMustInput.call(this.el,e,i)}var a=this.el.find("input").length>0?this.el.find("input"):this.el.find("textarea");("none"==a.css("display")||0==a.length)&&(a=this.el.find(".k-input").attr("tabindex","0")),e?(a.focus(function(){t.el.find(".kdItemContainer_editorct").addClass("kd_ui_mustinput")}),a.blur(function(){t.el.find(".kdItemContainer_editorct").removeClass("kd_ui_mustinput")})):(a.focus(function(){t.el.find(".kdItemContainer_editorct").addClass("kd_ui_warnning")}),a.blur(function(){t.el.find(".kdItemContainer_editorct").removeClass("kd_ui_warnning")}))},setValidateMessage:function(e,t){var i=this.el.find("[role=kderror]");e?this.el.addClass("kd-kditemcontainer-mustinput"):this.el.removeClass("kd-kditemcontainer-mustinput");var a=this.el.find("[role=kdmustinput]");i.attr("title",t),e?(this.el.find("input").addClass("kd_ui_validate_warnning"),this.el.find("textarea").addClass("kd_ui_validate_warnning")):(this.el.find("input").removeClass("kd_ui_validate_warnning"),this.el.find("textarea").removeClass("kd_ui_validate_warnning")),this.el.__setElVis(i,e),KD.getValue(this.getConfig(),"visible",!0)&&this.editor.mustInput?this.el.__setElVis(a,!e):this.el.__setElVis(a,!1)},setVisible:function(e){KDItemContainerProxy.superclass.setVisible.call(this,e),this.el&&this.el.setVisible&&this.el.setVisible.call(this.el,e),this.editor&&this.editor.setVisible&&this.editor.setVisible.call(this.editor,e)},onAfterVisible:function(e){KDItemContainerProxy.superclass.onAfterVisible.call(this,e),parseInt(this.config.dock)>0&&e&&void 0!=e.oldVisible&&void 0!=e.visible&&e.oldVisible!=e.visible&&this.parentProxy&&this.parentProxy.doLayout&&this.parentProxy.doLayout.call(this.parentProxy)},setCloudcontacts:function(e){var t=this.el,i=this.config;if(i.dock==KD.dock.None&&i.width>0){var a=e&&KD.isFunction(t.getExtWidth)?t.getExtWidth():0;e&&t.css({"max-width":i.width+a})}t&&t.setCloudcontacts&&t.setCloudcontacts(e)},updateDisplayText:function(){this.el&&this.el.updateDisplayText&&this.el.updateDisplayText.call(this.editor)},doLayout:function(){var e=this,t=e.config.dock,i={},a=KD.layout.getActualHeight(this.el.parent());if(t!=KD.dock.None){if(t==KD.dock.Fill?$.extend(i,{position:"initial",width:KD.layout.getActualWidth(this.el.parent())-2,height:a,parentHeight:a}):t==KD.dock.Top||t==KD.dock.Bottom?($.extend(i,{position:"initial",width:KD.layout.getActualWidth(this.el.parent())-2}),a=this.config.height||a):t==KD.dock.Left||t==KD.dock.Right?$.extend(i,{position:"initial",height:a,parentHeight:a}):$.extend(i,{position:"initial"}),i.width<0&&(i.width=0),i.width){delete i.parentHeight,this.el.show().css(i);var n=i.width-this.config.labelWidth-KD.CONST.ItemContainerOtherWidth,o=(KD.layout.getZoomInPx(i.height),{height:a-2,overflow:KD.layout.isDock(e.config)?"auto":void 0,width:0>n?0:n});$(".kdItemContainer_editorct",this.el).css(o),this.editor&&(this.editor.getXType&&"kdtextarea"==this.editor.getXType()&&KD.layout.isDock(e.config)&&(o.overflow="visible"),this.editor.updateStyle&&this.editor.updateStyle.call(this.editor,o))}if(this.editor&&this.editor.setItemContaonerStyle){var r=this.config.height;(this.config.dock==KD.layout.fill||this.config.dock==KD.layout.left||this.config.dock==KD.layout.right)&&(r=KD.layout.getActualHeight(this.el)),this.editor.setItemContaonerStyle.call(this.editor,r)}this.setGuidePosition&&this.setGuidePosition()}},setTitle:function(e){this.el.setTitle(e)},setToolTip:function(e){if(KDItemContainerProxy.superclass.setToolTip.call(this,e),this.editor&&this.editor.setToolTip&&this.editor.setToolTip.call(this.editor,e),e){var t=$('[role="kdspanlabel"]',this.el);t.length&&KD.isFunction(t.attr)&&t.attr({title:e})}},updateState:function(e){if(!this.isDontLazy())return void this.pushLazyAction("updateState",e);var t=this.editor.getType();if(e&&e.value&&("KDPictureProxy"==t||"KDFileUploadProxy"==t)){var i={},a="value";for(var n in e)"value"!=n.toLowerCase()?i[n]=e[n]:a=n;i[a]=e[a],KDItemContainerProxy.superclass.updateState.call(this,i)}else KDItemContainerProxy.superclass.updateState.call(this,e)},isItemContainer:function(){return!0},setTipsContent:function(e){if(KD.isObject(e)){var t=this.baseId+"-kdtooltip",i=e,a=this.el.find("label.k-checkbox-label");a.length||(a=this.el.find('div[role="kdlabel"]').children("span"));var n=this.getLineTipsDefConfig(t),o=this.getFormProxy(),r=o.createInnerControl(n);r.setIsOnlineTips.call(r,!0),r.setTipsData.call(r,i);var s=$.extend(r.getLineTipsOptions(),{position:"right"});a.attr("title",""),a.length&&a.kendoKDTooltip(s)}}}),KDControlFactoryProxy.registerType("kditemcontainer",KDItemContainerProxy),function(e){e.fn.KDItemContainer=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDItemContainer.prototype,e.fn.KDControlBase.defaults,e.fn.KDItemContainer.defaults,t?t:{});return i.content=""!=i.getMetaHtml()?e(i.getMetaHtml()).appendTo(i):i,i.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDControlBase.defaults={};var t="";KD.isIeBrowser()&&(t=" kdItemContainer_editorct_IEBrower"),e.fn.KDItemContainer.prototype={metaHtml:'<div class="kdItemContainer_label" role="kdlabel"><span style="width:100%;display:inline-block;white-space:nowrap;overflow:hidden;overflow-wrap:break-word;word-break:break-all;text-overflow:ellipsis;" role="kdspanlabel">label:</span></div><div class="kdItemContainer_editorct '+t+'" role="kdeditorct">  <div class="kdItemContainer_disablecover" role="kddisablecover" style="visibility: hidden;"></div></div><div class="kdItemContainer_mustinput" role="kdmustinput"></div><div class="kdItemContainer_error" role="kderror">!</div>',getType:function(){return"KDItemContainer"},getExtWidth:function(){return 18},getHeight:function(e){var t=this.defEditorHeight,i=this.defInnerFontHeight;return this.elHeight=parseInt((e?e:t)/i*100)/100+"em",this.elHeight},getInnerHeight:function(e){var t=this.defInnerFontHeight;return this.innerHeight=parseInt(100*(parseFloat(e||this.elHeight)-2/t))/100+"em",this.innerHeight},getInnerHeightPx:function(e){var t=this.defInnerFontHeight,i=parseFloat(e||this.elHeight)*t-2;return i},setTitle:function(e){if(this.find("[role=kdspanlabel]").html(e).attr("title",e),this.find(".kd-div-checkbox-setpadding")){var t=this.find(".kd-div-checkbox-setpadding").find("label").width(),i=this.find(".kdItemContainer_editorct").width();this.find(".kd-div-checkbox-setpadding").find("label").attr("title",e).html(e),this.find(".kdItemContainer_editorct").width(i+t)}},loadConfig:function(e){this.config=e,KD.setAttachmentData(this,e),KD.layout.setAbsolute(this,e),this.elHeight=KD.layout.isDock(e)?e.height:this.getHeight(e.height),this.innerHeight=KD.layout.isDock(e)?this.elHeight-2:this.getInnerHeight(),this.css({height:this.elHeight});var t=this.find("[role=kdlabel]"),i=(this.find("[role=kdspanlabel]"),this.find("[role=kdeditorct]")),a=this.find("[role=kderror]");this.__setElVis(a,!1);if((KDControlProxy.isBoxCtrl(e)||!e.labelWidth||e.labelWidth<5)&&(e.labelWidth=0,t.css({width:0,padding:0,margin:0}).hide()),KDControlProxy.isBoxCtrl(e)){var n={width:e.width-12,height:this.innerHeight,border:"0px"};KD.isFirefox()&&this.elHeight&&this.innerHeight&&(n["margin-top"]=(KD.isString(this.elHeight)?KD.convertToPX(this.elHeight.replace("em","")):this.elHeight)-(KD.isString(this.innerHeight)?KD.convertToPX(this.innerHeight.replace("em","")):this.innerHeight)+2+"px"),i.css(n)}else{var o=e.labelText;this.setTitle(o),t.css({width:e.labelWidth-5,"padding-right":"5px",height:this.innerHeight});var r=e.width-e.labelWidth-KD.CONST.ItemContainerOtherWidth;i.css({width:0>r?0:r,height:this.innerHeight})}this.config=e;var s=KD.getValue(e.item,"EmptyTip","");this.setMustInput(e.mustinput,s)},setEditor:function(e){var t=this.find("[role=kdeditorct]"),i=this.config,a=i&&(i.tooltip||i.labelText);this.editor=e,KDControlProxy.isBoxCtrl(i)&&e.find("label").attr("title",a),t.children().remove(),t.append(e),t.append(this.disableCoverEl)},setEditorStyle:function(t){var i=t;i.length>0&&("SELECT"==i[0].nodeName?(i=e("#ui-multiselect-btn-"+t.id+"_c"),i.css({width:"100%",border:"0px",height:this.innerHeight})):"checkbox"==i[0].type||"radio"==i[0].type||(i[0].parentNode.id==t.id?i.css({width:"100%",border:"0px",height:this.innerHeight}):i[0].parentNode.parentNode.parentNode.id==t.id?i.parent().parent().css({width:"100%",border:"0px",height:this.innerHeight}):i[0].parentNode.parentNode.parentNode.parentNode.id==t.id&&i.parent().parent().parent().css({width:"100%",border:"0px",height:this.innerHeight})))},setVisible:function(e){this.css&&(this.__setElVis(this,e),"hidden"==this.find("[role=kderror]").css("visibility")||"none"==this.find("[role=kderror]").css("display")?this.__setElVis(this.find("[role=kdmustinput]"),this.proxy.config&&this.proxy.config.mustinput?this.proxy.config.mustinput:!1):this.__setElVis(this.find("[role=kdmustinput]"),!1))},__setElVis:function(e,t){var i=e.css("display");0==t&&"none"!=i&&(e.lastDisplayCss=i);var a="inline-block";return this.config.dock!=KD.dock.FieldSet&&(a="inline-flex"),e.css({display:t?e.lastDisplayCss||a:"none"})},setMustInput:function(e,t){var i=this.find("[role=kdmustinput]"),a=this.find("[role=kderror]");KD.isEmpty(a)||"none"==a.css("display")||this.__setElVis(a,e).text(e?"*":" "),this.__setElVis(i,e).text(e?"*":" ");var n=this.find("input").attr("placeholder")||"";if(e)this.find("input").attr("placeholder",t),this.find("textarea").attr("placeholder",t);else{var o="";this.config&&this.config.item&&this.config.item.EmptyTip&&(o=this.config.item.EmptyTip),n.indexOf(t)>-1&&o!=t&&(this.find("input").removeAttr("placeholder",t),this.find("textarea").removeAttr("placeholder",t))}},setCloudcontacts:function(t){var i=this,a=i;if(t){if(a.children(".cloudcontacts").length>0)return;var n=e('<div class="cloudcontacts" title='+ResManager.LoadKDString("点此直接和他(她)联系，或交流分享工作中的点滴","0025710030032358")+'><i class="cloudcontacts-icon"></i></div>');a.append(n),n.click(function(e){var t=i.proxy.editor.postKey,a="CloudContacts$$",n=i.proxy.editor.getValue()||null,o=i.proxy.editor.cloudContactPhone||"",r={value:n,phone:o},s=i.proxy.getFormProxy();s.fireCustomEvents(t,a,KD.stringify(r),null),s.fireEvent("ButtonClick",t+"_CloudContacts$$",KD.stringify(r),null)})}else a.children(".cloudcontacts").length>0&&a.children(".cloudcontacts").eq(0).remove()},updateDock:function(e){if(e==KD.dock.Fill){var t=(this.find("[role=kdlabel]"),this.find("[role=kdeditorct]"));t.css({height:this.innerHeight,width:this.parent().width()})}}}}(jQuery),define("KDItemContainerProxy",["KDControlBase","KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDItemContainerProxy}}(this)),KDItemContainerProxy_Galaxy=KD.extend(KDItemContainerProxy,{defEditorHeight:21,defInnerFontHeight:12,createControl:function(e){this.rendered=!1,this.activated=!0,this.config=e,this.isDynamicCreated=e&&e.isDynamicCreated,this.el=0!=$("#"+this.baseId).length?$("#"+this.baseId):this.createControlDom(),this.el.addClass("kd-mouseover-el");var t=this.isKendo();this.el.attr("id",this.baseId),this.el.dock=this.config.dock,KD.setAttachmentData(this.el,e),null==t&&(this.el.proxy=this),this.attachFocusManager(),KD.layout.isDock(e)||(e.width=KD.layout.getZoomInPx(e.width),e.labelWidth=KD.layout.getZoomInPx(e.labelWidth)),this.el=this.el.KGItemContainer({defEditorHeight:this.defEditorHeight,defInnerFontHeight:this.defInnerFontHeight}),this.height=this.getHeight(e.height),this.innerHeight=this.getInnerHeight(),KD.layout.isDock(e)||e.height==this.defEditorHeight?KD.layout.isDock(e)||(e.item.height=e.height):e.item.height=this.getInnerHeightPx();var i={"float":"left",height:this.el._getGalaxyHeight(this.height,2.5),display:"inline-block"};(KDFlowlayoutProxy.getCtOrientation(e)||KD.layout.isFieldSet(e))&&delete i["float"],this.el.css(i).addClass("kg_itemContainer")},setDisabled:function(e){var t=e?"kgItemContainer_editorct_disable":"";this.el.find(".kgItemContainer_editorct").addClass(t),this.editor&&this.editor.setDisabled&&this.editor.setDisabled.call(this.editor,e);var i=KD.isEmpty(this.getFormTheme())?!1:!0,a=i?this.getFormTheme()+"-state-disabled":"k-state-disabled";i&&(e?$(".k-state-disabled",this.el).addClass(a).removeClass("k-state-disabled"):$("."+a,this.el).removeClass("k-state-disabled").removeClass(a))},loadConfig:function(e){var t=this;switch(t.config.metaHeight||(t.config.metaHeight=t.config.height),t.config.metaWidth||(t.config.metaWidth=t.config.width),e.dock){case KD.dock.Fill:e.width=KD.layout.getActualWidth(this.el.parent())-2,e.height=KD.layout.getActualHeight(this.el.parent())-21-20,e.item.height=e.height;break;case KD.dock.Top:case KD.dock.Bottom:e.width=KD.layout.getActualWidth(this.el.parent())-2;break;case KD.dock.Left:case KD.dock.Right:e.height=KD.layout.getActualHeight(this.el.parent())-20-21}this.el.loadConfig(e),e.item.id=e.id+"-editor",e.item.labelText=e.labelText,e.item.PositionDescription=KD.getValue(e,"PositionDescription","");var i=e.width-KD.CONST.ItemContainerGalaxy;e.item.width=0>i?0:i;var a=this.getControlFactoryProxy();this.editor=a.createControl.call(a,e.item),this.editor.setItemContainer.call(this.editor,this),this.el.setEditor.call(this.el,this.editor.getControl()),this.editor.loadConfig.call(this.editor,e.item);var n=this.el.find("[role=kdspanlabel]");if(t.isLableHyperlink=KD.getValue(e.item,"IsLableHyperlink",!1),0==(!t.isLableHyperlink||"bosf7field"!=t.config.item.xtype)&&(n.css({width:"auto"}).addClass("kd-label-hyperLink"),n.click(function(e){t.title_Click(e)})),this.setIsHyperlink(e.item.IsLableHyperlink&&"bosf7field"==t.config.item.xtype),this.editor.postKey=e.id,this.editor&&this.editor.setItemContaonerStyle){var o=this.config.height;(this.config.dock==KD.layout.fill||this.config.dock==KD.layout.left||this.config.dock==KD.layout.right)&&(o=KD.layout.getActualHeight(this.el)),this.editor.setItemContaonerStyle.call(this.editor,o)}},setItemTip:function(e){$(".kdItemContainer_Tip",this.el).text(e).show()},setValidateMessage:function(e,t){var i=this.el.find("[role=kderror]"),a=this.el.find("[role=kdmustinput]");
i.attr("title",t).text(t),e?(this.el.find("input").addClass("kd_ui_validate_warnning"),this.el.find("textarea").addClass("kd_ui_validate_warnning")):(this.el.find("input").removeClass("kd_ui_validate_warnning"),this.el.find("textarea").removeClass("kd_ui_validate_warnning")),this.el.__setElVis(i,e),e?$(".kgItemContainer_Bottom",this.el).addClass("kgItemContainer_BottomError"):$(".kgItemContainer_Bottom",this.el).removeClass("kgItemContainer_BottomError"),KD.getValue(this.getConfig(),"visible",!0)&&this.editor.mustInput?this.el.__setElVis(a,!e):this.el.__setElVis(a,!1)},doLayout:function(){var e=this,t=e.config.dock,i={},a=KD.layout.getActualHeight(this.el.parent());if(t!=KD.dock.None){if(t==KD.dock.Fill?$.extend(i,{position:"initial",width:KD.layout.getActualWidth(this.el.parent()),height:a,parentHeight:a}):t==KD.dock.Top||t==KD.dock.Bottom?($.extend(i,{position:"initial",width:KD.layout.getActualWidth(this.el.parent())}),a=this.config.height||a):t==KD.dock.Left||t==KD.dock.Right?$.extend(i,{position:"initial",height:a,parentHeight:a}):$.extend(i,{position:"initial"}),i.width<0&&(i.width=0),i.width){delete i.parentHeight,this.el.show().css(i);var n=i.width-KD.CONST.ItemContainerGalaxy,o=(KD.layout.getZoomInPx(i.height),{height:a-20-21,overflow:KD.layout.isDock(e.config)?"auto":void 0,width:0>n?0:n});$(".kdItemContainer_editorct",this.el).css(o),"kdtextarea"==this.editor.getXType()&&KD.layout.isDock(e.config)&&(o.overflow="visible"),this.editor.updateStyle.call(this.editor,o)}if(this.editor&&this.editor.setItemContaonerStyle){var r=this.config.height;(this.config.dock==KD.layout.fill||this.config.dock==KD.layout.left||this.config.dock==KD.layout.right)&&(r=KD.layout.getActualHeight(this.el)-20-21),this.editor.setItemContaonerStyle.call(this.editor,r)}}}}),KDControlFactoryProxy.registerType("kditemcontainer_Galaxy",KDItemContainerProxy_Galaxy),function(e){e.fn.KGItemContainer=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KGItemContainer.prototype,e.fn.KDControlBase.defaults,e.fn.KGItemContainer.defaults,t?t:{});return i.content=""!=i.getMetaHtml()?e(i.getMetaHtml()).appendTo(i):i,i.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDControlBase.defaults={},e.fn.KGItemContainer.prototype={metaHtml:'<div class="kgItemContainer_label" role="kdlabel"><span style="width:100%;display:inline-block;white-space:nowrap;overflow:hidden;overflow-wrap:break-word;word-break:break-all;text-overflow:ellipsis;" role="kdspanlabel">label:NaN</div><div class="kgItemContainer_mustinput" role="kdmustinput"></div><div style="clear: both;"></div><div class="kgItemContainer_editorct kg-hover-color" style="font-size:14px;" role="kdeditorct">  <div class="kdItemContainer_disablecover" role="kddisablecover" style="visibility: hidden;"></div></div><div class="kgItemContainer_Bottom" role="kdbottom"><div class="kgItemContainer_error"  role="kderror"></div><div class="kdItemContainer_Tip" style="display:none;">tip</div><div class="kdItemContainer_MinMax" style="display:none;">0/20</div></div>',getType:function(){return"KGItemContainer"},getExtWidth:function(){return 18},getHeight:function(e){var t=this.defEditorHeight,i=this.defInnerFontHeight;return this.elHeight=parseInt((e?e:t)/i*100)/100+"em",this.elHeight},getInnerHeight:function(e){this.defInnerFontHeight;return this.innerHeight=parseInt(100*parseFloat(e||this.elHeight))/100+"em",this.innerHeight},getInnerHeightPx:function(e){var t=this.defInnerFontHeight,i=parseFloat(e||this.elHeight)*t-2;return i},setTitle:function(e){if(this.find("[role=kdspanlabel]").html(e).attr("title",e),this.find(".kd-div-checkbox-setpadding")){var t=this.find(".kd-div-checkbox-setpadding").find("label").width(),i=this.find(".kdItemContainer_editorct").width();this.find(".kd-div-checkbox-setpadding").find("label").attr("title",e).html(e),this.find(".kdItemContainer_editorct").width(i+t)}},_getGalaxyHeight:function(e,t){var i=this.defInnerFontHeight;if(void 0!=e){t=void 0==t?0:41;var a=e.toString();if(a.indexOf("em")>0||a.indexOf("EM")>0){var n=parseFloat(a.replace("em","").replace("EM",""))+t/i*100/100;return n+"em"}if(a.indexOf("px")>0||a.indexOf("PX")>0){var n=parseFloat(a.replace("PX","").replace("px",""))+t;return n+"px"}return parseFloat(a)+t}},loadConfig:function(e){KD.setAttachmentData(this,e),KD.layout.setAbsolute(this,e),this.elHeight=this.getHeight(e.height),this.innerHeight=KD.layout.isDock(e)?this.elHeight:this.getInnerHeight(),this.css({height:this._getGalaxyHeight(this.elHeight,2.5)});var t=this.find("[role=kdlabel]"),i=this.find("[role=kdspanlabel]"),a=this.find("[role=kdeditorct]"),n=this.find("[role=kdbottom]"),o=this.find("[role=kderror]");this.__setElVis(o,!1);if((KDControlProxy.isBoxCtrl(e)||!e.labelWidth||e.labelWidth<5)&&(e.labelWidth=0,t.css({padding:0,margin:0}),i.html("&nbsp;&nbsp;")),KDControlProxy.isBoxCtrl(e)){var r={width:e.width-12,height:this.innerHeight,border:"0px"};KD.isFirefox()&&this.elHeight&&this.innerHeight&&(r["margin-top"]=(KD.isString(this.elHeight)?KD.convertToPX(this.elHeight.replace("em","")):this.elHeight)-(KD.isString(this.innerHeight)?KD.convertToPX(this.innerHeight.replace("em","")):this.innerHeight)+2+"px"),n.css("width",r.width),a.css(r)}else{var s=e.labelText;this.setTitle(s),t.css({width:"auto","padding-right":"5px",height:"21px"});var l=e.width-KD.CONST.ItemContainerGalaxy;a.css({width:0>l?0:l,height:this.innerHeight}),n.css("width",0>l?0:l)}this.config=e;var d=KD.getValue(e.item,"EmptyTip","");this.setMustInput(e.mustinput,d)},setEditor:function(e){var t=this.find("[role=kdeditorct]");this.editor=e,e.addClass("kg_editor").css("box-shadow","none"),t.children().remove(),t.append(e),t.append(this.disableCoverEl)},setEditorStyle:function(t){var i=t;i.length>0&&("SELECT"==i[0].nodeName?(i=e("#ui-multiselect-btn-"+t.id+"_c"),i.css({width:"100%",border:"0px",height:this.innerHeight})):"checkbox"==i[0].type||"radio"==i[0].type||(i[0].parentNode.id==t.id?i.css({width:"100%",border:"0px",height:this.innerHeight}):i[0].parentNode.parentNode.parentNode.id==t.id?i.parent().parent().css({width:"100%",border:"0px",height:this.innerHeight}):i[0].parentNode.parentNode.parentNode.parentNode.id==t.id&&i.parent().parent().parent().css({width:"100%",border:"0px",height:this.innerHeight})))},setVisible:function(e){this.css&&(this.__setElVis(this,e),"hidden"==this.find("[role=kderror]").css("visibility")||"none"==this.find("[role=kderror]").css("display")?this.__setElVis(this.find("[role=kdmustinput]"),this.proxy.config&&this.proxy.config.mustinput?this.proxy.config.mustinput:!1):this.__setElVis(this.find("[role=kdmustinput]"),!1))},__setElVis:function(e,t){var i=e.css("display");return 0==t&&"none"!=i&&(e.lastDisplayCss=i),e.css({display:t?e.lastDisplayCss||"inline-block":"none"})},setMustInput:function(e,t){var i=this.find("[role=kdmustinput]");this.__setElVis(i,e).text(e?"*":" ");var a=this.find("input").attr("placeholder")||"";if(e)this.find("input").attr("placeholder",t),this.find("textarea").attr("placeholder",t);else{var n="";this.config&&this.config.item&&this.config.item.EmptyTip&&(n=this.config.item.EmptyTip),a.indexOf(t)>-1&&n!=t&&(this.find("input").removeAttr("placeholder",t),this.find("textarea").removeAttr("placeholder",t))}},setCloudcontacts:function(t){var i=this,a=i;if(t){if(a.children(".cloudcontacts").length>0)return;var n=e('<div class="cloudcontacts" title='+ResManager.LoadKDString("点此直接和他(她)联系，或交流分享工作中的点滴","0025710030032358")+'><i class="cloudcontacts-icon"></i></div>');a.append(n),n.click(function(e){var t=i.proxy.editor.postKey,a="CloudContacts$$",n=i.proxy.editor.getValue()||null,o=i.proxy.editor.cloudContactPhone||"",r={value:n,phone:o},s=i.proxy.getFormProxy();s.fireCustomEvents(t,a,KD.stringify(r),null),s.fireEvent("ButtonClick",t+"_CloudContacts$$",KD.stringify(r),null)})}else a.children(".cloudcontacts").length>0&&a.children(".cloudcontacts").eq(0).remove()},updateDock:function(e){if(e==KD.dock.Fill){var t=(this.find("[role=kdlabel]"),this.find("[role=kdeditorct]")),i=this.find("[role=kdbottom]");t.css({height:this.innerHeight,width:this.parent().width()}),i.css("width",this.parent().width())}}}}(jQuery),define("KDItemContainerProxy_Galaxy",["KDItemContainerProxy","KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDItemContainerProxy_Galaxy}}(this)),KDItemContainerProxy_NLP_Search=KD.extend(KDItemContainerProxy,{initComponent:function(){var e=this;KDItemContainerProxy_NLP_Search.superclass.initComponent.call(e),$(".kdItemContainer_editorct",this.el).addClass("kdItemContainer_editorct-nlp-search")},doLayout:function(){var e=this;e.config.dock;e.config.item.labelWidth=this.config.labelWidth;var t={},i=KD.layout.getActualHeight(this.el.parent());if($.extend(t,{position:"initial",width:KD.layout.getActualWidth(this.el.parent())-2,height:i,parentHeight:i}),t.width<0&&(t.width=0),t.width){delete t.parentHeight,this.el.show().css(t);var a=t.width-this.config.labelWidth,n=(KD.layout.getZoomInPx(t.height),{height:i-2,overflow:"hidden",width:0>a?0:a,border:"none"});$(".kdItemContainer_editorct",this.el).css(n),"kdtextarea"==this.editor.getXType()&&KD.layout.isDock(e.config)&&(n.overflow="visible"),this.editor.updateStyle.call(this.editor,n)}if(this.editor&&this.editor.setItemContaonerStyle){var o=this.config.height;(this.config.dock==KD.layout.fill||this.config.dock==KD.layout.left||this.config.dock==KD.layout.right)&&(o=KD.layout.getActualHeight(this.el)),this.editor.setItemContaonerStyle.call(this.editor,o)}this.setGuidePosition&&this.setGuidePosition()}}),KDControlFactoryProxy.registerType("kditemcontainer_nlp_search",KDItemContainerProxy_NLP_Search),define("KDItemContainerProxy_NLP_Search",["KDItemContainerProxy"],function(e){return function(){var t;return t||e.KDItemContainerProxy_NLP_Search}}(this)),KDDoublePanelProxy=KD.extend(KDControlProxy,{createControlDom:function(){var e=$('<div class="ui_kddoublepanel_container"></div>');return e},loadConfig:function(e){this.config=e,KDDoublePanelProxy.superclass.loadConfig.call(this,e),this.loadChildren(e)},loadChildren:function(e){this.children=[];var t=e.items;null!=t&&this.addControls(t)},addControls:function(e){for(var t,i=e.length,a=0;i>a;a++){t=e[a],"kdtabpage"==t.xtype&&(t.xtype="panel");var n=this.getControlFactoryProxy().createControl(t);n.loadConfig(t),n.parentProxy=this,this.children.push(n);var o=n.getControl();o.removeAttr("class"),o.attr("style","height:100%;width:100%;"),this.el.append(o),n.initWidth=o.width(),n.initHeight=o.height()}this.initchildren()},initchildren:function(){if(this.children&&this.children.length>0){var e=this.children[0];this.resetChildConfig(e);var t=e.getControl();if(this.children.length>1){var i=this,a=this.children[1].getControl();a.css({background:"#ccc",display:"none"}),a.addClass("ui_kddoublepanel_hovepanel"),this.resetChildConfig(this.children[1]),t.hover(function(){$(".ui_kddoublepanel_hovepanel").each(function(){var e=$(this).attr("id");e!=a.attr("id")&&$(this).trigger("mouseout")}),$(this).hide(),i.config.floathove&&i.refreshHoveEl(i.children[1],"hove"),a.show()},function(){}),a.hover(function(){},function(){i.config.floathove&&i.refreshHoveEl(i.children[1],""),$(this).hide(),t.show()})}}},resetChildConfig:function(e){var t=e.getConfig(),i=e.getControl();t&&i&&(t.backgroundimage&&i.css({background:"url(../"+t.backgroundimage+")"}),t.background?i.css({"background-color":t.background}):t.backcolor&&i.css({"background-color":t.backcolor}),e.setInlineStyle(t.InlineStyle||{}))},refreshHoveEl:function(e,t){var i=e.getControl();e.getConfig();if(i)if("hove"==t){var a=this.el.offset().top,n=this.el.offset().left;i.appendTo("body"),i.css({left:n,top:a,height:e.initHeight+"px",width:e.initWidth+"px"}),i.addClass("ui_kddoublepanel_hove")}else i.removeClass("ui_kddoublepanel_hove"),i.css({left:0,top:0,height:"100%",width:"100%"}),i.appendTo("#"+this.baseId)},setFloatHove:function(e){this.config&&(this.config.floathove=e)}}),KDControlFactoryProxy.registerType("kddoublepanel",KDDoublePanelProxy),define("KDDoublePanelProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDDoublePanelProxy}}(this)),KDGroupFrameProxy=KD.extend(KDContainerProxy,{HeadWidth:0,browserType:null,controlTopPanel:$('<div class="kd-fieldset-container"></div>'),createControlDom:function(){var e=$('<fieldset class="ui_kdexpandcontainer_fieldset"><legend><span class="collapsible"></span></legend></fieldset>');return e},createControl:function(e){this.browserType=KD.getCurrentBrowsType().type,KDGroupFrameProxy.superclass.createControl.call(this,e);var t=this;this.titleContainer=this.el.find("legend"),this.fieldSet=this.el,this.titleContainer.find(".collapsible").click(function(){$(this).hasClass("collapsibled")?($(this).removeClass("collapsibled"),t.onIsExpandedChanged(!0)):($(this).addClass("collapsibled"),t.onIsExpandedChanged(!1))})},onIsExpandedChanged:function(e){var t=this.getFormProxy();t&&t.fireCustomEvents(this.getKey(),"IsExpandedChanged",e),this.updateExpandedStatus(e)},updateExpandedStatus:function(e){e?(this.fieldSet.removeClass("ui_kdexpandcontainer_collapsibled"),this.el.children().each(function(){$(this).is("legend")||$(this).removeClass("kd-kdexpandcontainer-visible")})):(this.fieldSet.addClass("ui_kdexpandcontainer_collapsibled"),this.el.children().each(function(){$(this).is("legend")||$(this).addClass("kd-kdexpandcontainer-visible")}))},loadConfig:function(e){KDGroupFrameProxy.superclass.loadConfig.call(this,e);var t=0;KD.isIeBrowser()&&(t=2),this.fieldSet.css({height:e.height-t||"auto",width:e.width-t||"auto"}),this.el.wrap(this.controlTopPanel),this.config=e,this.HeadWidth=KD.getValue(e,"headerwidth",0),this.AllowExpand=KD.getValue(e,"collapsible",!0),this.IsCollapsed=KD.getValue(e,"collapsed",!1),this.setAllowExpand(this.AllowExpand);var i=!1;i=this.setHearData(e.headercontrolkey,!0),e.headercontrolkey||(i=this.setHearData(e.headerdata,!1)),i||this.setHearData(e.title);var a=this.el.get(0);a&&(a.style.overflow=""),this.adjustElementPosition(),this.IsCollapsed&&(this.titleContainer.find(".collapsible").addClass("collapsibled"),this.onIsExpandedChanged(!this.IsCollapsed))},setHearData:function(e,t){var i=!1;if(e&&this.titleContainer){var a=this.titleContainer.find("[kd-role=head]"),n=this.getFormProxy();if(t&&this.config.headercontrolkey&&n){var o=this.controlFactoryProxy.controls[this.config.headercontrolkey.toUpperCase()];if(o){a.remove();var r=o.getControl();r.appendTo(this.titleContainer),this.HeadWidth<r.width()&&(this.HeadWidth=r.width()),this.headproxy=o}else n.showErrMsgStr(KD.format(ResManager.LoadKDString("未找到控件{0}","099002000000055"),this.config.headercontrolkey.toUpperCase()))}else if(n&&0==t){var s=KD.getValue(e,"id",""),l=this.controlFactoryProxy.controls[s.toUpperCase()];if(l){a.remove();var d=this.controlFactoryProxy.createControl(e);d.parentProxy=this,this.children.push(ctlProxy);var c=d.getControl();this.titleContainer.append(c),this.HeadWidth<c.width()&&(this.HeadWidth=c.width()),this.headproxy=d}}else if(this.config.title){a.remove();var h=kendo.format("<span  class='kd-kdexpandcontainer-title' title='{0}' kd-role=head>{0}</span>",this.config.title);this.titleContainer.append(h)}i=!0}return this.setHeadWidth(),i},setHeadWidth:function(){var e=this.AllowExpand?this.HeadWidth+16:this.HeadWidth;this.AllowExpand&&this.HeadWidth>0&&this.titleContainer&&this.titleContainer.width(e),this.setHeadContrlStyle()},setHeadContrlStyle:function(){var e=this.headproxy;if(e){var t=e.getConfig(),i=t.x+(this.AllowExpand?19:3),a=e.getControl(),n=KD.format("float:left;height:21px;position:relative;width:{0}px;left:{1}px;top:0px",t.width,i);if(a.attr("style",n),"kditemcontainer"==t.xtype){var o=a.find(".kdItemContainer_editorct");"kdcheckbox"==t.item.xtype||"kdradio"==t.item.xtype?o.css({width:o.width()+26,height:o.height()+5}):o.css({width:o.width()+26+t.labelWidth})}}},setText:function(e){this.title=e;var t=this.titleContainer.find(".kd-kdexpandcontainer-title");t.text(e)},setAllowExpand:function(e){this.AllowExpand=e?!0:!1,this.AllowExpand?this.titleContainer.find(".collapsible,.collapsibled").css({display:"inline-block"}):this.titleContainer.find(".collapsible,.collapsibled").css({display:"none"}),this.setHeadWidth()},adjustElementPosition:function(){var e=-20,t=this.el.children("div"),i=this.el.children("div:visible");KD.isFirefox()||$.each(t,function(t,i){var a=parseInt($(i).css("top"));$(i).css({top:a-e})}),$.each(i,function(e,t){var i=$(t).width();$(t).css({width:i-2})})}}),KDControlFactoryProxy.registerType("kdexpandcontainer",KDGroupFrameProxy),define("KDGroupFrameProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDGroupFrameProxy}}(this)),function(e){e.fn.KDListView=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDListView.prototype,e.fn.KDControlBase.defaults,e.fn.KDListView.defaults,t);return this.fw=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.css({"overflow-x":"auto","overflow-y":"hidden","word-wrap":"none","padding-left":"26px"}),this.options=t,this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDListView.prototype={getType:function(){return"KDListView"},getContent:function(){return this.fw},getBaseId:function(){return this.proxy.baseId},loadConfig:function(e){var t=this,i=t.getContent();i.attr("id",t.getBaseId())},setValue:function(t){var i=this,a=i.getContent();a.empty(),i.data=t;var a=i.getContent();a.ready(function(){var n=22;if(t[0]){var o=i.getDetail(t[0].items[0]),r=e(o);r.appendTo(e("body")),r[0]&&r[0].clientHeight>=20&&(n=r[0].clientHeight),e(r).remove()}var s=a.height();if(0>=s)return void KD["debugger"]("KDListView setValue,this control height is 0,please bug fix!",0>=s);for(var l=Math.floor(s/n),d=0,c=120,h=0;h<t.length;h++){var u=t[h];d+=u.items.length+1;for(var p=0;p<u.items.length;p++)c=c<u.items[p].width?u.items[p].width:c}var g=Math.ceil(d/l),f=g*c;a.css({width:f});for(var m=[],h=0;g>h;h++){var v=m[h]=e('<div style="float:left;height:'+s+"px;width:"+c+'px;">');v.appendTo(a)}for(var y=0,b=0,h=0;h<t.length;h++){var u=t[h],D="";D=i.getGroupMenu(u),b=Math.floor(y/l),e(D).appendTo(m[b]);var k=e('div[data-kdid="'+i.getBaseId()+u.id+'"]');if(k.bind("mouseover",{},function(){}),k.bind("mouseout",{},function(){}),y++,u.items)for(var p=0;p<u.items.length;p++){var C=u.items[p];D=i.getDetail(C);var x=e(D),w=i.getBaseId()+C.id+"_floatAddIcon",K=i.getBaseId()+C.id+"_floatOpenForm",S=i.getBaseId()+C.id+"_OtherSelIcon";x.bind("mouseover",{myItemId:w},function(e){i.showHideFavorButton(e.data.myItemId,!0)}),x.bind("mouseout",{myItemId:w},function(e){i.showHideFavorButton(e.data.myItemId,!1)}),b=Math.floor(y/l),x.appendTo(m[b]),y++,e("#"+K).bind("click",function(t){i.itemClick.call(i,e(t.currentTarget)),i.isCardLayout&&e(this).next().replaceWith(i.selectedIconDom)}),e("#"+w).bind("click",function(t){i.itemFavorClick.call(i,e(t.currentTarget)),i.isCardLayout&&e(this).replaceWith(i.selectedIconDom)}),e("#"+S).bind("click",function(t){i.itemFavorClick.call(i,e(t.currentTarget)),i.isCardLayout&&e(this).replaceWith(i.selectedIconDom)})}}})},itemClick:function(e){var t=this.getBaseId(),i=e[0].id;i=i.substring(t.length),i=i.replace("_floatOpenForm","");var a={key:t,selectItemId:i};this.options.onItemClick(a)},itemFavorClick:function(e){var t=this.getBaseId(),i=e.attr("id");i=i.substring(t.length);var a=i.substring(0,i.lastIndexOf("_")),n=i.substring(i.lastIndexOf("_")+1),o={key:t,selectItemId:a,actionKey:n};this.options.onFavorClick(o)},addFavorClick:function(e,t){var i=this.getBaseId(),a=t.attr("data-kdid");a=a.substring(i.length-1)},clearClick:function(e,t){var i=this.getBaseId(),a=t.attr("data-kdid");a=a.substring(i.length-1)},getDetail:function(e){var t=this,i={icon:e.icon,text:e.text,id:t.getBaseId()+e.id,width:e.width,tooltip:e.tooltip,isAdded:e.isAdded,isOtherAdded:e.isOtherAdded},a='<a id="'+i.id+'_floatAddIcon" class="kendo-color" style="float:right; width: 30px;display:none;" href="#" title="'+ResManager.LoadKDString("点击添加到常用功能","099002000000059")+'"><img with="18px" height="18px" src="../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/add_faction.png"></img></a>';this.selectedIconDom='<a href="#" style="position: relative;top:-3px"><img with="18px" height="18px" src="../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/redselected.png"></img></a>';var n='<a id="'+i.id+'_OtherSelIcon" title="'+ResManager.LoadKDString("添加到当前常用功能卡片","0025710000008245")+'" href="#" style="position: relative;top:-3px"><img with="18px" height="18px" src="../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/otherselected.png"></img></a>',o='<div class="kd-listview-detail" data-kdid="'+i.id+'" style="width:'+i.width+'px;"><a id="'+i.id+'_floatOpenForm"class="kendo-color" style="display:inline-block;width:'+(i.width-30)+'px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;" href="#'+i.id+'" title="'+i.tooltip+'">'+i.text+"</a>";return o+=i.isAdded?this.selectedIconDom+"</div>":i.isOtherAdded?n+"</div>":a+"</div>"},showHideFavorButton:function(t,i){i?e("#"+t).css("display","block"):e("#"+t).css("display","none")},getGroupMenu:function(e){var t=this,i={icon:e.icon,text:e.text,id:t.getBaseId()+e.id,width:e.items&&e.items[0]?e.items[0].width:120};return'<div class="kd-listview-item" data-kdid="'+i.id+'"style="width:'+i.width+'px;height:1em;">'+i.text+"</div>"},release:function(){var e=this;e.fw&&e.fw.remove(),e.fw=void 0,e.remove()},setIsCardLayout:function(e){this.isCardLayout=e}},e.fn.KDListView.defaults={metaHtml:'<div data-role="FLiSTVIEWContainer" style="height:inherit;width:auto;"></div>',defaults:{}}}(jQuery),define("KDListView",["KD"],function(e){return function(){var t;return t||e.KDListView}}(this)),function(e,t){function i(e){return function(t){var i=t.children(".k-animation-container");return i.length||(i=t),i.children(e)}}function a(t,i){for(var a;t&&"ul"!=t.nodeName.toLowerCase();)a=t,t=t.nextSibling,3==a.nodeType&&(a.nodeValue=e.trim(a.nodeValue)),s.test(a.className)?i.insertBefore(a,i.firstChild):i.appendChild(a)}function n(t){var i=t.children("div"),n=t.children("ul"),r=i.children(".k-icon"),s=t.children(":checkbox"),l=i.children(".k-in");t.hasClass("k-treeview")||(i.length||(i=e("<div />").prependTo(t)),!r.length&&n.length?r=e("<span class='k-icon' />").prependTo(i):n.length&&n.children().length||o(t)||(r.remove(),n.remove()),s.length&&e("<span class='k-checkbox-wrapper' />").appendTo(i).append(s),l.length||(l=t.children("a").eq(0).addClass("k-in k-link"),l.length||(l=e("<span class='k-in' />")),l.appendTo(i),i.length&&a(i[0].nextSibling,l[0])))}function o(t){var i=e(t),a=i.children("div"),n=i.children("ul"),o=a.children(".k-in"),r=o.find('[ishasChild="true"]'),s=!1;return(n.length>0||r.length>0)&&(s=!0),s}var r,s,r,l=window.kendo,d=l.ui,c=d.TreeView,h=(l.data,e.extend),u=(l.template,e.isArray,e.proxy,l.keys,"change"),p="undefined",g="k-treeview",f=".k-item";r=i(".k-group"),s=/k-sprite/;var m=c.extend({options:{name:"KDTreeView"},_nodes:function(t,i){var a,o=this,r=t.children("li");i=h({length:r.length},i),r.each(function(t,r){r=e(r),a={index:t,expanded:o._expanded(r)},n(r),o._updateNodeClasses(r,i,a),o._group(r)})},_remove:function(t,i){var a,o,r,s=this;return t=e(t,s.element),this.angular("cleanup",function(){return{elements:t.get()}}),a=t.parent().parent(),o=t.prev(),r=t.next(),t[i?"detach":"remove"](),a.hasClass("k-item")&&(n(a),s._updateNodeClasses(a)),s._updateNodeClasses(o),s._updateNodeClasses(r),t},_insertNode:function(t,i,a,o,s){var l,d,c,h,u=this,p=r(a),f=p.children().length+1,m={firstLevel:a.hasClass(g),expanded:!s,length:f},v="",y=function(e,t){e.appendTo(t)};for(c=0;c<t.length;c++)h=t[c],h.index=i+c,v+=u._renderItem({group:m,item:h});d=e(v);var b=this._isMutiSelectTree(),D=b?a.find(".k-checkbox-wrapper"):a.children(".k-in"),k=b?d.find(".k-checkbox-wrapper"):d.find(".k-in");if(D.addClass("kd-treenode-textcnt"),k.addClass("kd-treenode-textcnt"),b&&(this._changeChkTreeBackStyleEvent(D),this._changeChkTreeBackStyleEvent(k)),d.length){for(u.angular("compile",function(){return{elements:d.get(),data:t.map(function(e){return{dataItem:e}})}}),p.length||(p=e(u._renderGroup({group:m})).appendTo(a)),o(d,p),a.hasClass("k-item")&&(n(a),u._updateNodeClasses(a)),u._updateNodeClasses(d.prev().first()),u._updateNodeClasses(d.next().last()),u._updateNodeStyles(d,a),c=0;c<t.length;c++)h=t[c],h.hasChildren&&(l=h.children.data(),l.length&&u._insertNode(l,h.index,d.eq(c),y,!u._expanded(d.eq(c))));return d}},_refreshRoot:function(t){var i=this._renderGroup({items:t,group:{firstLevel:!0,expanded:!0}});if(this.root.length){this._angularItems("cleanup");var a=e(i),n=a.find(".kd-treenode-text").parent();n.addClass("kd-treenode-textcnt"),this.root.attr("class",a.attr("class")).html(a.html())}else this.root=this.wrapper.html(i).children("ul");this.root.attr("role","tree");for(var o=this.root.children(".k-item"),r=0;r<t.length;r++)this.trigger("itemChange",{item:o.eq(r),data:t[r],ns:d});this._angularItems("compile")},_refreshChildren:function(e,t,i){var a,o,s,l=this.options,c=l.loadOnDemand,h=l.checkboxes&&l.checkboxes.checkChildren;if(r(e).empty(),t.length)for(this._appendItems(i,t,e),o=r(e).children(),c&&h&&this._bubbleIndeterminate(o.last()),a=0;a<o.length;a++)s=o.eq(a),this.trigger("itemChange",{item:s.children("div"),data:this.dataItem(s),ns:d});else n(e)},_updateNodeClasses:function(e,t,i){var a=e.children("div"),n=e.children("ul"),r=this.templates;if(!e.hasClass("k-treeview")){i=i||{},i.expanded=typeof i.expanded!=p?i.expanded:this._expanded(e),i.index=typeof i.index!=p?i.index:e.index(),i.enabled=typeof i.enabled!=p?i.enabled:!a.children(".k-in").hasClass("k-state-disabled"),t=t||{},t.firstLevel=typeof t.firstLevel!=p?t.firstLevel:e.parent().parent().hasClass(g),t.length=typeof t.length!=p?t.length:e.parent().children().length,e.removeClass("k-first k-last").addClass(r.wrapperCssClass(t,i)),a.removeClass("k-top k-mid k-bot").addClass(r.cssClass(t,i));var s=a.children(".k-in"),l=s[0]&&"a"==s[0].nodeName.toLowerCase();if(s.removeClass("k-in k-link k-state-default k-state-disabled").addClass(r.textClass(i,l)),n.length||"true"==e.attr("data-hasChildren")||o(e)){var d=" k-icon ";a.children(".k-icon").removeClass("k-i-expand k-i-collapse").addClass(d+r.toggleButtonClass(i)),n.addClass("k-group")}}},_updateNodeStyles:function(e,t){var i,a=this,n=a._isMutiSelectTree(),o=e.parents(".k-treeview ul").length;i=o>15?15:o-1,o=o>15?15:o;var r,s="kd-treeIcon-level"+o,l="kd-treeIcon-level"+i,d="kd-treeInner-level"+o,c=e.children("div"),h=c.children(".k-icon"),u=t.children("div"),p=u.children(".k-icon");r=n?c.children(".k-checkbox-wrapper").children(":first-child"):c.children(".k-in").children(":first-child"),h.addClass(s+" kd-treeview-icon"),p.addClass(l+" kd-treeview-icon"),r.addClass(d)},_isMutiSelectTree:function(){return this.wrapper&&this.wrapper.hasClass("kd-treeview-mutiselect")?!0:!1},_changeChkTreeBackStyleEvent:function(t){t.off("mouseover").on("mouseover",function(t){var i=e(t.currentTarget);i.hasClass("k-state-selected")?i.removeClass("k-state-hover"):i.addClass("k-state-hover")}),t.off("mouseout").on("mouseout",function(t){var i=e(t.currentTarget);i.removeClass("k-state-hover")}),t.off("click").on("click",function(t){var i=e(t.currentTarget),a=i.parents(".kd-treeview"),n=i.parents("li").eq(0),o=a.find(".k-state-selected"),r=o.parents("li").eq(0);o.removeClass("k-state-selected"),r.removeClass("kd-treenode-iconhover"),i.addClass("k-state-selected"),n.addClass("kd-treenode-iconhover")})},select:function(t){var i=this,a=i.element;if(!arguments.length)return a.find(".k-state-selected").closest(f);if(t=e(t,a).closest(f),a.find(".k-state-selected").each(function(){var t=i.dataItem(this);t?(t.set("selected",!1),delete t.selected):e(this).removeClass("k-state-selected")}),t.length&&(i.dataItem(t).set("selected",!0),i._clickTarget=t,!i._isMutiSelectTree())){var n=i.wrapper&&i.wrapper.find(".kd-treenode-iconhover");n.removeClass("kd-treenode-iconhover"),t.addClass("kd-treenode-iconhover")}i.trigger(u)}});d.plugin(m)}(window.kendo.jQuery),define("KDTreeView",["KD"],function(e){return function(){var t;return t||e.KDTreeView}}(this)),KDListViewProxy=KD.extend(KDControlProxy,{createControl:function(e){var t=this;KDListViewProxy.superclass.createControl.call(this,e);var i={onItemClick:function(e){t.onItemClick.call(t,e)},onFavorClick:function(e){t.onFavorClick.call(t,e)}};this.el=this.el.KDListView(i)},loadConfig:function(e){KDListViewProxy.superclass.loadConfig.call(this,e);this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(e))},setValue:function(e){var t=this.config.dock;if(t==KD.dock.Fill||t==KD.dock.Left||t==KD.dock.Right||t==KD.dock.FieldSet){var i=KD.layout.getActualHeight(this.el.parent());this.el.height(i)}this.el.setValue(e)},setIsCardLayout:function(e){this.el.setIsCardLayout(e)},onItemClick:function(e){this.getFormProxy().fireEventNoData("ListViewClick",this.key,e.selectItemId)},onFavorClick:function(e){var t=this.key;"OtherSelIcon"==e.actionKey&&(t="OnChangeFuncCardId"),this.getFormProxy().fireEventNoData("ListViewAddFavorClick",t,e.selectItemId)}}),KDControlFactoryProxy.registerType("kdlistview",KDListViewProxy),define("KDListViewProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDListViewProxy}}(this)),function(e){function t(){var t=e.isIeBrowser();return t&&e.writeLog("Web Audio Api was not be supported by IE Browser.",!0),t}var i=168,a=500,n="kd-voice-rec-btn-disabled",o="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjA0NTQzNzA4MTc0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEzMjY5IiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTc4NS45IDQ1MS4ydjYwLjljMCA3MC4xLTIzLjQgMTMxLTcwLjEgMTgyLjgtNDYuOCA1MS45LTEwNC42IDgxLjYtMTczLjQgODkuMXY2Mi43aDEyMS43YzguMiAwIDE1LjQgMyAyMS40IDlzOSAxMy4xIDkgMjEuNGMwIDguMi0zIDE1LjQtOSAyMS40cy0xMy4yIDktMjEuNCA5SDM1OS44Yy04LjIgMC0xNS40LTMtMjEuNC05cy05LTEzLjItOS0yMS40IDMtMTUuNCA5LTIxLjQgMTMuMS05IDIxLjQtOWgxMjEuN1Y3ODRjLTY4LjgtNy42LTEyNi42LTM3LjMtMTczLjMtODkuMi00Ni44LTUxLjgtNzAuMS0xMTIuOC03MC4xLTE4Mi45VjQ1MWMwLTguMiAzLTE1LjQgOS0yMS40czEzLjEtOSAyMS40LTljOC4yIDAgMTUuNCAzIDIxLjQgOXM5IDEzLjIgOSAyMS40djYwLjljMCA1OC42IDIwLjggMTA4LjggNjIuNSAxNTAuNVM0NTMuMiA3MjUgNTExLjkgNzI1YzU4LjYgMCAxMDguOC0yMC44IDE1MC41LTYyLjVDNzA0LjIgNjIwLjggNzI1IDU3MC44IDcyNSA1MTJ2LTYwLjljMC04LjIgMy0xNS40IDktMjEuNHMxMy4xLTkgMjEuNC05YzguMiAwIDE1LjQgMyAyMS40IDkgNi4xIDYuMSA5LjEgMTMuMiA5LjEgMjEuNXpNNjY0LjIgMjY4LjZWNTEyYzAgNDEuOC0xNC45IDc3LjctNDQuNyAxMDcuNXMtNjUuNiA0NC43LTEwNy41IDQ0LjctNzcuNy0xNC45LTEwNy41LTQ0LjdTMzU5LjggNTU0IDM1OS44IDUxMlYyNjguNmMwLTQxLjggMTQuOS03Ny43IDQ0LjctMTA3LjUgMjkuOC0yOS44IDY1LjYtNDQuNyAxMDcuNS00NC43czc3LjcgMTQuOSAxMDcuNSA0NC43YzI5LjcgMjkuOCA0NC43IDY1LjYgNDQuNyAxMDcuNXoiIHAtaWQ9IjEzMjcwIiBmaWxsPSIjQTdCNUQzIj48L3BhdGg+PC9zdmc+",r=e.format("{0}/{1}?ver={2}",e.getUrlSubRoot(),"images/nlp/recording-animation.gif",e.getVersion()),s='<div class="kd-voice-recording-anict"><div style="width: 100%"><img class="kd-voice-recording-exit" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAP1BMVEUAAACDmMGAlMODlr6Al79/lryCmL5/k7+ClcB/lr+Cl76BlbyAlr9/lb2Bk76Blb2Blb+Ak7yAk72AlLyAlL1pYicLAAAAFXRSTlMAJSYnLC4vNDU4O0FERkdNV+bo6evt8TfSAAAAW0lEQVQY02NgIBJw8CPY3LxgilFQACbCJ8wOYbDAxPiEOWGSUDEkEagYighYDE0EKCYkgiYC1IWwF24XC6oY2BwUMajJLMhu5kRzMxeym3nANDMbwggmVmIDCwCP+gO+f5U2RwAAAABJRU5ErkJggg==" alt="exit"/></div><div class="kd-voice-recording-tips"><span style="color: rgb(127, 147, 188);">{@recodingTips@}</span></div><div class="kd-voice-recording-animation"><div style="width: 84px; height: 84px;"><img class="kd-voice-img" src="'+r+'" alt="recording" /></div></div>';
KDVoiceRecProxy=e.extend(KDControlProxy,{loadConfig:function(t){var i=this;if(KDVoiceRecProxy.superclass.loadConfig.call(i,t),i.config=t,!KDVoiceRecProxy.__resCache&&i.el){var a=i.el,n=KDVoiceRecProxy.__resCache=$('<div style="width:1px;height:1px;position:absolute;top:0px;opacity:0.1;"><img class="kd-voice-img" src="'+r+'" alt="recording" /></div>');e.delayInvoke(function(){n&&n.remove().appendTo(a),e.delayInvoke(function(){n&&n.remove(),n=void 0,a=void 0},500,!0)},500,!0)}},getRecTimeout:function(){var e=this,t=e.config.timeout||3e3;return t},updateConfig:function(t){var i=this;e.isEmpty(t)||$.extend(i.config,t),i.iatRecorder||(i.stopRecord(),delete i.iatRecorder);var a=i.config.relatedProxyInfo||{};if(!e.isEmpty(a)){var n=i.getFormProxy(),o=n.getControlProxy.call(n,a.key);o&&(i.targetProxy=o)}},updateTargetState:function(t,i){var a=this,n="kd-voice-inp-state-"+t,o="kd-voice-inp-state-"+i;if(a.targetProxy){var r=a.targetProxy,s=r.getControl();s&&s.removeClass(n),i&&"end"!=i&&"close"!=i&&"open"!=i?s&&s.addClass(o):s&&s.removeClass(o),e.writeLog("voice StatusChange: "+t+" -> "+i,"",!0)}},updateTargetValue:function(e){var t=this,i=t.config,a=i.relatedProxyInfo||{},n=i.fireTextBack,o=t.targetProxy,r=o?o.isItemContainer()?o.editor:o:void 0;if(n&&t.fireCustomEvent(t.key,"Kingdee.BOS.XPF.KDVoiceRecProxy.Text",{text:e}),r){var s={},l=r[a.valueMethod||"setValue"],d=r.onchange;d&&d.call(r,s,e),l&&l.call(r,e)}},createControl:function(e){var t=this;return KDVoiceRecProxy.superclass.createControl.call(t,e),t.__render(t.el),t.el},initRecorder:function(){var e=this,i=e.config;t()||e.iatRecorder||(e.iatRecorder=new IatRecorder({appId:i.appId||"",apiKey:i.apiKey||"",apiSecret:i.apiSecret||"",iatHost:i.iatHost||"",iatUrl:i.iatUrl||"",onWillStatusChange:function(t,i){e.onWillStatusChange(t,i)},onTextChange:function(t){e.onTextChange(t)},onOpen:function(t){e.onOpen(t)},onClose:function(t){e.onClose(t)},onError:function(t){e.onError(t)}}))},setDisabled:function(e){var t=this;t.disabled=e;var i=t.micBox?t.micBox[t.disabled?"addClass":"removeClass"]:void 0;i&&i.call(t.micBox,n)},showMic:function(e){var a=this;if(!t()&&(a.micBox&&a.micBox[e?"show":"hide"](),a.recodingBox))if(a.recodingBox[e?"hide":"show"](),a.__recBoxResize&&clearInterval(a.__recBoxResize),e)a.recodingBox.remove();else{var n=a.el.closest(".kd_bill_RootPanel"),o={height:i,position:""};n.height()>i&&$.extend(o,{position:"absolute"}),a.recodingBox.remove().css(o).appendTo(n).show(),a.recodingBox.find(".kd-voice-recording-exit").unbind("click").bind("click",function(e){a.stopRecord()}),a.__resizeRecBox()}},__resizeRecBox:function(){var e=this,t=e.recodingBox,i=e.__recBoxResize=setInterval(function(e){try{if(!e)return void clearInterval(i);var t=e.parent().height(),a=e.height();a>t?"relative"!=e.css("position")&&e.css({position:"relative"}):t>2.5*a&&"absolute"!=e.css("position")&&e.css({position:"absolute"})}catch(n){clearInterval(i)}},800,t)},setMicState:function(t,i){var a=this;if(t){var n=e.format("kd-voice-rec-{0}-btn",t);a.micBox&&a.micBox[i?"removeClass":"addClass"](n)}},startRecord:function(){var e=this;e.__debugStartRecord()||(e.setMicState("init"),e.initRecorder(),e.iatRecorder&&e.iatRecorder.start())},stopRecord:function(){var e=this;e.setMicState("init",!0),e.iatRecorder&&e.iatRecorder.stop(),e.showMic(!0)},releaseRecord:function(){var e=this;e.stopRecord(),e.iatRecorder&&e.iatRecorder.release(),e.iatRecorder=void 0},release:function(){var e=this;e.releaseRecord(),e.targetProxy=void 0,clearInterval(e.__recBoxResize),KDVoiceRecProxy.superclass.release.call(e)},fireCustomEvent:function(t,i,a){var n=this,o=n.getFormProxy(),r=e.isString(a)?a:e.stringify(a);o&&o.fireCustomEvents.call(o,t,i,r)},onWillStatusChange:function(e,t){var i=this;i.updateTargetState(e,t)},onTextChange:function(e){var t=this;t.__circleCheckUpdateVoiceText(e);var i=t.iatRecorder,a=void 0;e&&(a&&clearTimeout(a),a=setTimeout(function(){i&&i.stop(),clearTimeout(a),t.stopRecord()},t.getRecTimeout()))},onOpen:function(e){var t=this;t.setMicState("init",!0),t.showMic(!1)},onClose:function(e){var t=this;t.showMic(!0)},onError:function(t){var i=this;i.setMicState("init",!0),i.showMic(!0);var a=t.message;"error"==t.type&&(a=e.format("linked to voice server was failure. \r\n{0} ",i.config.iatUrl||"wss://iat-api.xfyun.cn/v2/iat")),i.fireCustomEvent(i.key,"Kingdee.BOS.XPF.KDVoiceRecProxy.Error",{message:a})},__circleCheckUpdateVoiceText:function(e){var t=this;t.__currentVoiceText=e,t.__circleCheckUpdateTH&&clearTimeout(t.__circleCheckUpdateTH),t.__circleCheckUpdateTH=setTimeout(function(e){e.__circleCheckUpdateTH&&clearTimeout(e.__circleCheckUpdateTH),e.updateTargetValue.call(e,e.__currentVoiceText)},a,t)},__render:function(i){t()&&e.writeLog(ResManager.LoadKDString("浏览器不支持WebAudioApi相关接口","0141072000005632"),"voice__render",!0);var a=this,r=ResManager.LoadKDString("请说，我正在听","0141072000005627"),l=o;a.micBox=$('<div class="kd-voice-rec-btn"><img class="kd-voice-img" src="'+l+'" alt="" /></div>').appendTo(i),a.disabled&&a.micBox.addClass(n),a.micBox.off("click").on("click",function(){a.micBox.hasClass(n)||a.startRecord()}),a.recodingBox=$(s.replace("{@recodingTips@}",r)),a.showMic(!0)},__debugTextRec:function(){var t=this;t.updateConfig({relatedProxyInfo:{key:"FNLPSEARCHTEXT",valueMethod:"setSearchText"}});e.delayInvoke(function(){t.onTextChange.call(t,"我本月的未审核采购订单。")},t.getRecTimeout())},__debugStartRecord:function(){var t=this,i=!1,a=e.getValue(t.config,"isDebug",!0),n=e.getValue(t.config,"isSimuTxt",!1);return a?(n?t.__debugTextRec():setTimeout(function(){t.stopRecord.call(t)},t.getRecTimeout()),t.showMic(!1),i=!0):i}}),KDControlFactoryProxy.registerType("kdvoicerec_iflytek",KDVoiceRecProxy)}(KD),function(e){IatRecorder=function(e){this.appId=e.appId||"",this.apiKey=e.apiKey||"",this.apiSecret=e.apiSecret||"",this.iatHost=e.iatHost||"iat-api.xfyun.cn",this.iatUrl=e.iatUrl||"wss://iat-api.xfyun.cn/v2/iat",this.onTextChange=e.onTextChange||function(){},this.onWillStatusChange=e.onWillStatusChange||function(){},this.onOpen=e.onOpen||function(){},this.onError=e.onError||function(){},this.onClose=e.onClose||function(){},this.status="close",this.language=e.language||"zh_cn",this.accent=e.accent||"mandarin",this.audioData=[],this.resultText="",this.resultTextTemp="",this.lanStrs={init_msg_setting_correct_xfinterface:ResManager.LoadKDString("请正确配置【迅飞语音听写（流式版）WebAPI】服务接口认证信息！","0141072000005628"),init_msg_runatserver_port:ResManager.LoadKDString("对不起：请在服务器环境下运行！","0141072000005629"),init_msg_runatserver_type:ResManager.LoadKDString("请在服务器如：WAMP、XAMPP、Phpstudy、http-server、WebServer等环境中运行！","0141072000005630"),browser_nosupper_websocket:ResManager.LoadKDString("浏览器不支持WebSocket!","0141072000005631"),browser_nosupper_webaudioapi:ResManager.LoadKDString("浏览器不支持WebAudioApi相关接口","0141072000005632"),browser_record_auth_failure:ResManager.LoadKDString("对不起：录音权限获取失败!","0141072000005633"),browser_record_auth_local_msg:ResManager.LoadKDString("获取浏览器录音功能，因安全性问题，需要在localhost 或 127.0.0.1 或 https 下才能获取权限！","0141072000005634"),browser_record_device_nofound:ResManager.LoadKDString("对不起：未识别到录音设备!","0141072000005635")},this.init()},IatRecorder.prototype={getLanString:function(e,t){return this.lanStrs[e]||t||""},getWebSocketUrl:function(){var e=this;return new Promise(function(t,i){var a=e.iatUrl,n=e.iatHost,o=(new Date).toGMTString(),r="hmac-sha256",s="host date request-line",l="host: "+n+"\ndate: "+o+"\nGET /v2/iat HTTP/1.1",d=CryptoJS.HmacSHA256(l,e.apiSecret),c=CryptoJS.enc.Base64.stringify(d),h='api_key="'+e.apiKey+'", algorithm="'+r+'", headers="'+s+'", signature="'+c+'"',u=btoa(h);a=a+"?authorization="+u+"&date="+o+"&host="+n,t(a)})},errorHandler:function(e,t){var i=this;i.onError({message:t,type:e})},init:function(){var t=this;try{if(t.appId&&t.apiKey&&t.apiSecret){var i=e.format("{0}/{1}/{2}",e.getUrlSubRoot(),e.getSubPath(),"script/thirdpart/iflytek/transcode.worker.js");t.webWorker=new Worker(i),t.webWorker.onmessage=function(e){for(var i=0;i<e.data.length;i++)t.audioData.push(e.data[i])}}else t.errorHandler("init",t.getLanString("init_msg_setting_correct_xfinterface"))}catch(a){t.errorHandler("init",t.getLanString("init_msg_runatserver_port")+a.message),e.writeLog(t.getLanString("init_msg_runatserver_type"),a.message+a.stack,!0)}},setStatus:function(e){var t=this;t.onWillStatusChange&&t.status!==e&&t.onWillStatusChange(t.status,e),t.status=e},setResultText:function(e){var t=this,i=e.resultText,a=e.resultTextTemp;t.onTextChange&&t.onTextChange(a||i||""),void 0!==i&&(t.resultText=i),void 0!==a&&(t.resultTextTemp=a)},setParams:function(e){var t=this,i=e.language,a=e.accent;i&&(t.language=i),a&&(t.accent=a)},toBase64:function(e){for(var t="",i=new Uint8Array(e),a=i.byteLength,n=0;a>n;n++)t+=String.fromCharCode(i[n]);return window.btoa(t)},connectWebSocket:function(){var t=this;return t.getWebSocketUrl().then(function(i){var a=void 0;try{if("WebSocket"in window)a=new WebSocket(i);else{if(!("MozWebSocket"in window))return t.errorHandler("connectServer",t.getLanString("browser_nosupper_websocket")),!1;a=new MozWebSocket(i)}t.webSocket=a,t.setStatus("init"),a.onopen=function(i){t.setStatus("ing"),e.delayInvoke(function(){t.webSocketSend.call(t)},500),t.onOpen(i)},a.onmessage=function(e){t.webSocketRes(e.data)},a.onerror=function(e){t.setStatus("error"),t.recorderStop(e),t.onError(e)},a.onclose=function(e){t.setStatus("close"),t.recorderStop(e),t.onClose(e)}}catch(n){t.onError(n)}})},release:function(){var t=this;try{t.__releaseAudio(),t.webWorker&&t.webWorker.terminate(),t.webWorker=void 0}catch(i){e.writeLog(i.message,i.stack,!0)}},__releaseAudio:function(){var t=this;t.__releaseAudioHr&&clearTimeout(t.__releaseAudioHr),t.__releaseAudioHr=setTimeout(function(){try{t.audioContext&&t.audioContext.close(),t.audioContext=void 0,t.scriptProcessor=void 0,t.mediaSource=void 0,t.webSocket&&t.webSocket.close(),t.webSocket=void 0,t.__releaseAudioHr=void 0,t=void 0}catch(i){e.writeLog(i.message,i.stack,!0)}},100)},recorderInit:function(){var e=this;try{if(e.audioContext=new(window.AudioContext||window.webkitAudioContext),e.audioContext.resume(),!e.audioContext)return e.errorHandler("audio_env",e.getLanString("browser_nosupper_webaudioapi")),!1}catch(t){if(!e.audioContext)return e.errorHandler("audio_env",e.getLanString("browser_nosupper_webaudioapi")),e.__releaseAudio(),!1}var i=function(t){e.scriptProcessor=e.audioContext.createScriptProcessor(0,1,1),e.scriptProcessor.onaudioprocess=function(t){if("ing"===e.status)try{e.webWorker.postMessage(t.inputBuffer.getChannelData(0))}catch(i){}},e.mediaSource=e.audioContext.createMediaStreamSource(t),e.mediaSource.connect(e.scriptProcessor),e.scriptProcessor.connect(e.audioContext.destination),e.connectWebSocket()},a=function(t){e.errorHandler("browser",e.getLanString("browser_record_auth_failure")),e.audioContext&&e.audioContext.close(),e.audioContext=void 0,e.webSocket&&1===e.webSocket.readyState&&e.webSocket.close()};if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){i(e)})["catch"](function(e){a(e)});else{if(!navigator.getUserMedia)return navigator.userAgent.toLowerCase().match(/chrome/)&&location.origin.indexOf("https://")<0?e.errorHandler("browser",e.getLanString("browser_record_auth_local_msg")):e.errorHandler("browser",e.getLanString("browser_record_device_nofound")),e.__releaseAudio(),!1;navigator.getUserMedia({audio:!0,video:!1},function(e){i(e)},function(e){a(e)})}},webSocketSend:function(){var e=this;if(1!==e.webSocket.readyState)return!1;var t=e.audioData.splice(0,1280),i={common:{app_id:e.appId},business:{language:e.language,domain:"iat",accent:e.accent,vad_eos:5e3,dwa:"wpgs"},data:{status:0,format:"audio/L16;rate=16000",encoding:"raw",audio:e.toBase64(t)}};e.webSocket.send(JSON.stringify(i)),e.handlerInterval=setInterval(function(){return e.webSocket&&e.audioData?1!==e.webSocket.readyState?(e.audioData=[],clearInterval(e.handlerInterval),!1):0===e.audioData.length?("end"===e.status&&(e.webSocket.send(JSON.stringify({data:{status:2,format:"audio/L16;rate=16000",encoding:"raw",audio:""}})),e.audioData=[],clearInterval(e.handlerInterval)),!1):void e.webSocket.send(JSON.stringify({data:{status:1,format:"audio/L16;rate=16000",encoding:"raw",audio:e.toBase64(e.audioData.splice(0,1280))}})):(clearInterval(e.handlerInterval),!1)},40)},webSocketRes:function(e){var t=this,i=JSON.parse(e);if(i.data&&i.data.result){for(var a=i.data.result,n="",o=a.ws,r=0;r<o.length;r++)n+=o[r].cw[0].w;a.pgs?("apd"===a.pgs&&t.setResultText({resultText:t.resultTextTemp}),t.setResultText({resultTextTemp:t.resultText+n})):t.setResultText({resultText:t.resultText+n})}0===i.code&&2===i.data.status&&t.webSocket.close(),0!==i.code&&t.webSocket.close()},recorderStart:function(){var e=this;e.audioContext?(e.audioContext.resume(),e.connectWebSocket()):e.recorderInit()},recorderStop:function(){var e=this;(!/Safari/.test(navigator.userAgent)||/Chrome/.test(navigator.userAgen))&&e.audioContext&&e.audioContext.suspend(),e.setStatus("end"),e.__releaseAudio()},start:function(){var e=this;e.recorderStart(),e.setResultText({resultText:"",resultTextTemp:""})},stop:function(){var e=this;e.recorderStop()}}}(KD),define("KDVoiceRecProxy",["KDControlProxy","crypto_js"],function(e){return function(){var t;return t||e.KDVoiceRecProxy}}(this)),KDGroupSearchMenuPanelProxy=KD.extend(KDControlProxy,{createControl:function(e){KDGroupSearchMenuPanelProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDGroupSearchMenuPanelProxy.superclass.loadConfig.call(this,e);this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(e))},setData:function(e){this.config.data=e,this.allitems={};var t=(e.cls,e.children);this.firstLvls=$('<div class="kdgrpSearchMenuBorder"><ul class="HoverPopSubMenuFirst"></ul></div>'),this.el.empty(),this.firstLvls.appendTo(this.el),this.subCats=$("<div></div>"),this.subCats.appendTo($(document.body)),this.subCatsShadow=$('<div class="smenucats-shadow"></div>'),this.subCatsShadow.appendTo($(document.body));for(var i=this.getBaseId(),a=0;a<t.length;a++){var n=t[a],o=this.firstLvls.find("ul");n.baseId=i;KDGroupSearchMenuPanelProxy.__createGroupMenuItem(n,o,this.subCats,this.el,this)}$(document.body).mouseup(function(){$(".smenucats").hide(),$(".smenucats-shadow").hide(),$(".smenuitem").removeClass("smenuitem-focused")})},onItemClick:function(e){var t=this,i=t.getFormProxy(),a=t.validation?i.validating(!0):!0;if(a){var n={Key:t.getKey(),ActionKey:"DefaultButton",Index:0,PKValue:e.key,FilterString:null};i.fireEvent("GroupSearchMenuPanelAction",n)}},setValue:function(e){this.el.setValue(e)}}),KDGroupSearchMenuPanelProxy=$.extend(KDGroupSearchMenuPanelProxy,{popLeftOffset:20,__createGroupMenuItem:function(e,t,i,a,n){var o=e,r={},s=KDGroupSearchMenuPanelProxy["__create"+o.cls];if(!s)return void alert(o.cls+" Not Found!");r=s(o,t,n);var l=KDGroupSearchMenuPanelProxy.__getMenuItemCatId(o);itemCatEl=$('<div data-kdid="'+l+'" class="smenucats" style="position:absolute;z-index:9999;"></div>').hide();var d=!(o&&o.children&&o.children.length>0),c=d?[]:o.children,h=d?{}:c[0],u={height:h.ContainerHeight||"auto",width:h.ContainerWidth||"0px"};itemCatEl.css(u);for(var p=0;p<c.length;p++){var g=c[p];g.baseId=o.baseId;var s=KDGroupSearchMenuPanelProxy["__create"+g.cls];if(!s)return void alert(g.cls+" Not Found!");var f=s(g,itemCatEl,n);p==c.length-1&&f.addClass(g.cls+"-last")}return itemCatEl.append('<div class="smenucats-left-border"/>'),itemCatEl.append('<div class="smenucats-left-gape"/>'),itemCatEl.appendTo(i),itemCatEl.get(0).itemEl=r?r.get(0):void 0,itemCatEl.hover(function(){$(this).show(),this.itemEl&&($(this.itemEl).addClass("smenuitem-focused"),$(".HoverPopSubMenuRightImg",this.itemEl).addClass("HoverPopSubMenuRightImg-focused"))},function(){$(this).hide(),this.itemEl&&($(this.itemEl).removeClass("smenuitem-focused"),$(".HoverPopSubMenuRightImg",this.itemEl).removeClass("HoverPopSubMenuRightImg-focused"))}),r},__getMenuItemCatId:function(e){return e.baseId+"-"+e.id+"-Cat"},__getMenuItemId:function(e){return e.baseId+"-"+e.id},__getMenuItemIcon:function(e,t){t=t||"mobile.png";var i="images/kdcontrol/KDGroupSearchMenuPanel/"+t;return e&&e.icon&&e.icon.indexOf("/")>0?e.icon:e&&e.icon?"images/biz/default/"+e.icon||i:i},__adjustPopOffset:function(e,t){var i=10,a=10,n={height:document.body.clientHeight,width:document.body.clientWidth},o=n.height-(e.top+t.height),r=n.width-(e.left+t.width);return i>o&&(o-=i,e.top+=o,e.detaHeight=o),a>r&&(r-=a,e.left+=r,e.detaWidth=r),e},__createHoverPopSubMenu:function(e,t,i){function a(){var e=$(this).offset(),t=$(this).height();e.left+=$(this).width()+KDGroupSearchMenuPanelProxy.popLeftOffset,$(".smenucats-shadow").hide(),$(".smenucats").hide();var i=$('[data-kdid="'+s+'"]'),a={width:i.width(),height:i.height()};e=KDGroupSearchMenuPanelProxy.__adjustPopOffset(e,a),e.detaHeight?$(".smenucats-left-gape",i).css({height:t,top:-1*e.detaHeight}):$(".smenucats-left-gape",i).css({height:t,top:0}),e=$.extend({"min-height":t},e),i.css(e).show(),e.top+=4,e.left+=3;var n=$.extend({},a,e);$(".smenucats-shadow").css(n).show(),$(".smenuitem").removeClass("smenuitem-focused"),$(this).addClass("smenuitem-focused"),$(".HoverPopSubMenuRightImg").removeClass("HoverPopSubMenuRightImg-focused"),$(".HoverPopSubMenuRightImg",this).addClass("HoverPopSubMenuRightImg-focused")}var n=e.baseId,o=e,r=KDGroupSearchMenuPanelProxy.__getMenuItemId(o),s=KDGroupSearchMenuPanelProxy.__getMenuItemCatId(o),l=o.icon?'<img class="HoverPopSubMenuImg" src="'+KDGroupSearchMenuPanelProxy.__getMenuItemIcon(o,"car.png")+'"/>':"",d=$('<li data-kdid="'+r+'" class="smenuitem '+o.cls+'">'+l+'<span data-kdkey="'+o.id+'" style="line-height:'+o.ContainerHeight+'px;" class="HoverPopSubMenuCaption">'+o.text+'</span><div class="HoverPopSubMenuRightImg"/></li>'),c=t.width()-KDGroupSearchMenuPanelProxy.popLeftOffset;return c=c>0?c:"90%",d.css({height:o.ContainerHeight,width:c}),$("span:first",d).bind("click",function(){var e=$(this).attr("data-kdkey");i&&i.onItemClick&&i.onItemClick.call(i,{baseId:n,key:e})}),d.hover(a,function(){$(".smenucats-shadow").hide(),$(".smenucats").hide(),$(this).removeClass("smenuitem-focused"),$(this).find(".HoverPopSubMenuRightImg").removeClass("HoverPopSubMenuRightImg-focused")}),d.mouseup(a),d.appendTo(t),d},__createHLabelContainer:function(e,t,i){var a=e.baseId,n=KDGroupSearchMenuPanelProxy.__getMenuItemId(e),o=$('<div data-kdid="'+n+'" class="smenuitem '+e.cls+'"><div class="HLabelContainerLable">'+(e.icon?'<div><img class="HLabelContainerLableImg" src="'+KDGroupSearchMenuPanelProxy.__getMenuItemIcon(e)+'"/></div>':"")+'<div><span data-kdkey="'+e.id+'" data-kdid="'+n+'-dock">'+e.text+"</span></div></div>");$('[data-kdid="'+n+'-dock"]',o).bind("click",function(){var e=$(this).attr("data-kdkey");i&&i.onItemClick&&i.onItemClick.call(i,{baseId:a,key:e})});var r=(KDGroupSearchMenuPanelProxy.__getMenuItemCatId(e),$('<div "data-kdid="'+n+'" style="width:'+(e.ContainerWidth-150-25)+'px" class="HLabelContainerChildCt">'));r.appendTo(o);for(var s=e.children,l=0;l<s.length;l++){var d=s[l];d.baseId=a;var c=KDGroupSearchMenuPanelProxy.__getMenuItemId(d),h=$('<span data-kdkey="'+d.id+'" data-kdid="'+c+'" class="smenuitem '+d.cls+'" style="color:#'+d.Forecolor.substring(3)+';">'+d.text+"</span>");h.bind("click",function(){var e=$(this).attr("data-kdkey");i&&i.onItemClick&&i.onItemClick.call(i,{baseId:a,key:e})}),h.appendTo(r)}return o.appendTo(t),o},__createPanelVContainerOnly:function(e,t,i){},__createImageContainer:function(e,t,i){var a=e,n=a.baseId,o=KDGroupSearchMenuPanelProxy.__getMenuItemId(a),r=KDGroupSearchMenuPanelProxy.__getMenuItemCatId(a),s=$('<li data-kdid="'+o+'" class="smenuitem '+a.cls+'"><div class="ImageContainerLable"><img class="ImageContainerImg" src="'+KDGroupSearchMenuPanelProxy.__getMenuItemIcon(a,"car.png")+'" title="'+a.text+'"/><span>'+a.text+"</span></div></li>"),l=a.ContainerWidth||t.width(),d=$('<div data-kdid="'+r+'" class="ImageContainerChildCt">');d.css({width:l-40-15,height:"inherit"});for(var c=a.children,h=0;h<c.length;h++){var u=c[h];u.baseId=n;var p=KDGroupSearchMenuPanelProxy.__createContainerOnly(u,d,i);p.appendTo(d)}return d.appendTo(s),s.appendTo(t),s},__createContainerOnly:function(e,t,i){var a=e,n=a.baseId,o=KDGroupSearchMenuPanelProxy.__getMenuItemId(a),r=(KDGroupSearchMenuPanelProxy.__getMenuItemCatId(a),$('<div data-kdid="'+o+'" class="smenuitem '+a.cls+'">'));r.css({width:t.width()});for(var s=a.children,l=0;l<s.length;l++){var d=s[l];d.baseId=n;var c=KDGroupSearchMenuPanelProxy.__getMenuItemId(a),h=$('<span data-kdkey="'+d.id+'" data-kdid="'+c+'" class="smenuitem '+d.cls+'" style="color:#'+d.Forecolor.substring(3)+';">'+d.text+"</span>");h.bind("click",function(){var e=$(this).attr("data-kdkey");i&&i.onItemClick&&i.onItemClick.call(i,{baseId:n,key:e})}),h.appendTo(r)}return r}}),KDControlFactoryProxy.registerType("schmnupanel",KDGroupSearchMenuPanelProxy),function(e){e.fn.KDGroupMenuItem=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDGroupMenuItem.prototype,e.fn.KDControlBase.defaults,e.fn.KDGroupMenuItem.defaults,t);return this.fw=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDGroupMenuItem.prototype={getType:function(){return"KDGroupMenuItem"},getContent:function(){return this.fw},loadConfig:function(e){this.getContent().css({height:e.height})}},e.fn.KDGroupMenuItem.defaults={metaHtml:"",defaults:{}}}(jQuery),define("KDGroupSearchMenuPanelProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDGroupSearchMenuPanelProxy}}(this)),KDProductsPanelProxy=KD.extend(KDControlProxy,{getPagerHeight:function(){var e=this.config&&this.config.data&&this.config.data.PagerVisible;return e?35:0},createControl:function(e){KDProductsPanelProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDProductsPanelProxy.superclass.loadConfig.call(this,e);this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(e))},getDisplayMode:function(){return this.config.displayMode||0},setDisplayMode:function(e){this.config.displayMode=e||0,this.setData(this.config.data||KDProductsPanelProxy.__getDefaultData())},setPagerVisible:function(e){this.config.data=this.config.data||KDProductsPanelProxy.__getDefaultData({PagerVisible:e}),this.setData(this.config.data)},UpdateEntity:function(e,t){this.config.items[e]=t,this.setData(this.config.data||KDProductsPanelProxy.__getDefaultData())},doLayout:function(){KDProductsPanelProxy.superclass.doLayout.call(this);var e=this.el.height()-this.getPagerHeight();if(e>0){var t={height:e};$(".KDProductsPanel-Content",this.el).css(t)}},setData:function(e){this.el.empty(),this.config.data=e;var t=e.CssOptions?KD.parseObject(e.CssOptions):{};this.el.css(t);var i=this.el.height()-this.getPagerHeight(),a={height:i};0>=i&&delete a.height,t.overflow&&(a.overflow=t.overflow);var n=$('<div class="KDProductsPanel-Content">').css(a).appendTo(this.el);if(e.PagerVisible){var o={rowcount:e.rowcount,pageIndex:e.PageIndex,pageSize:e.PageSize};KDProductsPanelProxy.__createFooterContent(o,this)}for(var r=0==this.getDisplayMode()?"__createProduct{0}BlockItem":"__createProduct{0}LineItem",s=e.items,l=0;l<s.length;l++){var d=s[l];r=r.replace("{0}",d.ModeKey);var c=KDProductsPanelProxy[r],h=c(d,n,this);h&&h.length&&h.appendTo(n)}$('<div style="clear:both;"/>').appendTo(n),$(".ProductsPanelItemFavorBtn",n).hide()},doLayout:function(){$(".KDProductsPanel-Content",this.el).css({height:this.el.height()-this.getPagerHeight()})},setValue:function(e){this.el.setValue(e)},onItemClick:function(e){var t=this,i=t.getFormProxy(),a=t.validation?i.validating(!0):!0;if(a){var n=e.ActionKey||"DefaultButton",o={Key:t.getKey(),ActionKey:n,Index:e.Index||0,Qty:e.Qty||0,PageSize:e.PageSize||0,PageIndex:e.PageIndex||0,PKValue:e.PKValue||null};KDProductsPanelProxy.__isAsync(e.actKey)?i.fireEvent("ProductsPanelAction",o):i.fireSyncEvent("ProductsPanelAction",o)}},setItemBtnClickFlyeffect:function(e,t){var i='<span style="position:absolute;font-size:1.5em;height:15px;width:auto;color:#FF7191;left:80px;top:250px;">+1</span>',a=$(".ProductsPanelItem",this.el).outerHeight(!1),n=$(".ProductsPanelItemQty",this.el).outerWidth(!1),o=e&&"/"==e.substring(0,1)?e.substring(1):e?e:"";o=o?"../../"+o:"",o=o?o:"../../images/biz/default/Common/Shopcar.png",$(".ProductsPanelItemBtn",this.el).each(function(){var e=$(this).attr("data-kdkvp"),r=JSON.parse(e);if(t==r.Index){var s=void 0;return $(".ProductsPanelItemBtn",this.el).each(function(e){if($(this).data().kdkvp.Index==t){s=$(this);var r=s.parent(),l=$(".ProductsPanelItemQty input",r).val(),d=$(i).text("+"+l).css({"padding-left":25,"padding-bottom":15,top:a-50,left:n-20,"background-image":"url("+o+")","background-repeat":"no-repeat"}).appendTo(r);return void d.show().animate({top:"-="+a/8+"px","font-size":"-=1em",left:"+=15px",opacity:"-=0.9"},"slow",function(){$(this).remove()})}}),!1}})}}),$.extend(KDProductsPanelProxy,{C_GotoPage:"GotoPage",C_OpenItem:"OpenItem",C_OpenImage:"OpenImage",__isAsync:function(e){return",DefaultButton,GotoPage,".indexOf(e)>0},__getDefaultData:function(e){return $.extend({items:[],rowcount:0,PageIndex:0,PageSize:1},e||{})},__getPrice:function(e){var t=e.PriceDisplayString;return t?t:KDProductsPanelProxy._getFormatMoney(e.Price,e.PriceDisplayFormat)},__getOriginalPrice:function(e){var t=e.OriginalPriceDisplayString;return t?t:KDProductsPanelProxy._getFormatMoney(e.OriginalPrice,e.OriginalPriceDisplayFormat)},__getStockQty:function(e){var t=e.StockQtyDisplayString;return t?t:KDProductsPanelProxy._getFormatDecimal(e.StockQty,e.QuantityMask)},__getKDKVPData:function(e){var t={Index:e.Index,PKValue:e.PKValue},i=JSON.stringify(t).replace(/"/g,"&quot;");return ret='data-kdkvp="'+i+'"',ret},__getQtyOptions:function(e){var t=e.QtydecimalPrecision?"bigdecimal":"integer",i={formatType:"number",dataType:t,operateState:"edit",decimalPrecision:e.QtydecimalPrecision||0,maxlength:13,value:e.Quantity,min:1,max:e.StockQty?e.StockQty:999999,disabled:e.ButtonDisabled,readonly:e.ButtonDisabled,width:e.Width/2};return i},__createFooterContent:function(e,t){var i=e.rowcount/e.pageSize,a=parseInt(i.toString());i>a&&(a+=1);var n=$('<div class="KDProductsPanel-Footer"><ul><li class="KDProductsPanel-PagerBtn KDProductsPanel-PagerLastBtns"><span><</span></li><li class="KDProductsPanel-Pagerlbl KDProductsPanel-PagerlblFirst"><span>...</span></li><li class="KDProductsPanel-PagerBtn KDProductsPanel-Pager"><span>1</span></li><li class="KDProductsPanel-PagerBtn KDProductsPanel-Pager"><span>2</span></li><li class="KDProductsPanel-PagerBtn KDProductsPanel-Pager"><span>3</span></li><li class="KDProductsPanel-PagerBtn KDProductsPanel-Pager"><span>4</span></li><li class="KDProductsPanel-PagerBtn KDProductsPanel-Pager"><span>5</span></li><li class="KDProductsPanel-Pagerlbl KDProductsPanel-PagerlblLast"><span>...</span></li><li class="KDProductsPanel-PagerBtn KDProductsPanel-PagerNextBtns"><span>></span></li><li class="KDProductsPanel-Pagerlbl" style="width:80px;"><span class="totalPager">'+ResManager.LoadKDString("共","099002000000115")+a.toString()+ResManager.LoadKDString("页","099002000000116")+'</span></li><li class="KDProductsPanel-Pagerlbl"><span>'+ResManager.LoadKDString("第","099002000002790")+'</span></li><li class="KDProductsPanel-Pagerlbl" style="width:50px;"><span class="input"></span></li><li class="KDProductsPanel-Pagerlbl"><span> '+ResManager.LoadKDString("页","099002000000116")+'</span></li><li class="KDProductsPanel-PagerBtnOk" style="width:50px;"><span>'+ResManager.LoadKDString("确定","099002000000004")+"</span></li></ul></div>");return t.el.append(n),$(".KDProductsPanel-Pagerlbl>.input",n).kendoKDNumberField({precision:0,max:1e3,min:1,maxlength:9,showButton:!1,isControlPrecision:!0,value:e.pageIndex,change:function(e,t){}}),e.pageIndex<=3&&$(".KDProductsPanel-PagerlblFirst",n).hide(),e.pageIndex>=a-2&&$(".KDProductsPanel-PagerlblLast",n).hide(),$(".KDProductsPanel-Pager",n).each(function(t){var i=t+e.pageIndex-2;1>i||i>a?$(this).hide():($(this).attr("data-pageindex",i),$("span",$(this)).html(i),i==e.pageIndex&&$(this).addClass("KDProductsPanel-PagerBtn-focused"))}),$(".KDProductsPanel-PagerLastBtns",n).click(function(i){var a=e.pageIndex-1;a=1>=a?1:a;var n=$(this).attr("data-kdkvp"),o=$.extend(JSON.parse(n||"{}"),{ActionKey:KDProductsPanelProxy.C_GotoPage,Index:-1,PageSize:e.pageSize,PageIndex:a});t&&t.onItemClick&&t.onItemClick.call(t,o)}),$(".KDProductsPanel-PagerNextBtns",n).click(function(i){var n=e.pageIndex+1;n=n>=a?a:n;var o=$(this).attr("data-kdkvp"),r=$.extend(JSON.parse(o||"{}"),{ActionKey:KDProductsPanelProxy.C_GotoPage,Index:-1,PageSize:e.pageSize,PageIndex:n});t&&t.onItemClick&&t.onItemClick.call(t,r)}),$(".KDProductsPanel-Pager",n).click(function(i){var a=$(this).attr("data-pageindex"),n=parseInt(a),o=$(this).attr("data-kdkvp"),r=$.extend(JSON.parse(o||"{}"),{ActionKey:KDProductsPanelProxy.C_GotoPage,Index:-1,PageSize:e.pageSize,PageIndex:n});t&&t.onItemClick&&t.onItemClick.call(t,r)}),$(".KDProductsPanel-PagerBtnOk",n).click(function(i){var o=$(".KDProductsPanel-Pagerlbl input",n).val(),r=parseInt(o);1>r&&(r=1),r>a&&(r=a);var s=$(this).attr("data-kdkvp"),l=$.extend(JSON.parse(s||"{}"),{ActionKey:KDProductsPanelProxy.C_GotoPage,Index:-1,PageSize:e.pageSize,PageIndex:r});t&&t.onItemClick&&t.onItemClick.call(t,l)}),n},__createProductBlockItem:function(e,t,i){var a=e;a.Unit||(a.Unit="");var n=20,o=20,r=function(){return n+o},s=KDProductsPanelProxy.__getKDKVPData(a),l=a.ButtonDisabled?"ProductsPanelItemBtn-disabled":"ProductsPanelItemBtn",d=KDProductsPanelProxy.__getOriginalPrice(a),c=$('<div class="ProductsPanelItem" '+s+'><div class="ProductsPanelItemImg" '+s+'><img src="'+KDProductsPanelProxy._getFormatImg(a.ImageUrl)+'" '+s+'></img><div class="ProductsPanelItemFavorBtn" '+s+' style="left:'+(a.Width-100)+'px;" title='+ResManager.LoadKDString("收藏","0025710030032344")+'></div></div><div class="ProductsPanelItemImgBottomGap"></div><div class="ProductsPanelItemCaption" '+s+'><span title="'+a.Caption+'">'+a.Caption+'</span></div><div class="ProductsPanelItemPrice"><span>'+KDProductsPanelProxy.__getPrice(a)+"</span></div>"+(d?'<div class="ProductsPanelItemOriginalPrice"><span>'+d+"</span></div>":"")+'<div class="ProductsPanelItemStockQty"><span>'+KDProductsPanelProxy.__getStockQty(a)+'</span></div><div class="ProductsPanelItemQty" style="border:1px solid rgb(225,225,225);"><input style="border:0;" value="'+a.Quantity+'" '+s+'></input><div style="display: inline-block; margin-left: 5px; line-height: 28px;position:relative;top:1px;"><span>'+a.Unit+'</span></div></div><div class="'+l+'" '+s+"><span>"+a.ButtonCaption+"</span></div></div>"),h=$.extend(a.CssOptions?JSON.parse(a.CssOptions):{},{width:a.Width,height:a.Height,overflow:"hidden"});c.css(h);var u={width:a.ImageWidth,height:a.ImageHeight};$(".ProductsPanelItemImg Img",c).css(u),u.left=(a.Width-a.ImageWidth)/2,$(".ProductsPanelItemImg",c).css(u);var p={color:a.CaptionColorString,"font-size":a.CaptionFontSize,"white-space":"normal",width:a.Width-r()};$(".ProductsPanelItemCaption",c).css(p);var g={color:a.PriceColorString,"font-size":a.PriceFontSize};$(".ProductsPanelItemPrice",c).css(g);var f={color:a.OriginPriceColorString,"font-size":a.OriginPriceFontSize};$(".ProductsPanelItemOriginPrice",c).css(f),c.mouseenter(function(){var e=$(this);$(".ProductsPanelItemFavorBtn",e).show(),e.addClass("ProductsPanelItem-hover")}),c.mouseleave(function(){var e=$(this);$(".ProductsPanelItemFavorBtn",e).hide(),e.removeClass("ProductsPanelItem-hover")});var m=KDProductsPanelProxy.__getQtyOptions(a);return m.width=m.width-(4*a.Unit.length+5)-1,$(".ProductsPanelItemQty input",c).KDNumerInput(m),KDProductsPanelProxy.__attachProductItemEventHandler(c,t,i),c},
__createProductSimpleVBlockItem:function(e,t,i){var a=20,n=20,o=function(){return a+n},r=e,s=KDProductsPanelProxy.__getKDKVPData(r),l=(r.ButtonDisabled?"ProductsPanelItemBtn-disabled":"ProductsPanelItemBtn",KDProductsPanelProxy.__getOriginalPrice(r)),d=$('<div class="ProductsPanelItem" '+s+'><div class="ProductsPanelItemImg" '+s+'><img src="'+KDProductsPanelProxy._getFormatImg(r.ImageUrl)+'" '+s+"></img>"+(r.FavorButtonVisible?'<div class="ProductsPanelItemFavorBtn" '+s+' style="left:'+(r.Width-100)+'px;"><span>收藏</span></div>':"")+'</div><div class="ProductsPanelItemImgBottomGap"></div><div class="ProductsPanelItemCaption" '+s+'><span title="'+r.Caption+'">'+r.Caption+'</span></div><div class="ProductsPanelItemPrice"><span>'+KDProductsPanelProxy.__getPrice(r)+"</span></div>"+(l?'<div class="ProductsPanelItemOriginalPrice"><span>'+l+"</span></div>":"")+"</div>"),c=$.extend(r.CssOptions?JSON.parse(r.CssOptions):{},{width:r.Width,height:r.Height});d.css(c);var h={color:r.CaptionColorString,"font-size":r.CaptionFontSize,"white-space":"normal",width:r.Width-o()};$(".ProductsPanelItemCaption",d).css(h);var u={color:r.PriceColorString,"font-size":r.PriceFontSize};$(".ProductsPanelItemPrice",d).css(u);var p={color:r.OriginalPriceColorString,"font-size":r.OriginalPriceFontSize};$(".ProductsPanelItemOriginalPrice",d).css(p);var g={width:r.ImageWidth,height:r.ImageHeight};return $(".ProductsPanelItemImg Img",d).css(g),g.left=(r.Width-r.ImageWidth)/2,$(".ProductsPanelItemImg",d).css(g),d.mouseenter(function(){var e=$(this);$(".ProductsPanelItemFavorBtn",e).show(),e.addClass("ProductsPanelItem-hover")}),d.mouseleave(function(){var e=$(this);$(".ProductsPanelItemFavorBtn",e).hide(),e.removeClass("ProductsPanelItem-hover")}),KDProductsPanelProxy.__attachProductItemEventHandler(d,t,i),d},__createProductSimpleHBlockItem:function(e,t,i){var a=10,n=10,o=function(){return a+n},r=e,s=KDProductsPanelProxy.__getKDKVPData(r),l=(r.ButtonDisabled?"ProductsPanelItemBtn-disabled":"ProductsPanelItemBtn",KDProductsPanelProxy.__getOriginalPrice(r)),d=$('<div class="ProductsPanelItem" '+s+'><div class="ProductsPanelItemImg" '+s+'><img src="'+KDProductsPanelProxy._getFormatImg(r.ImageUrl)+'" '+s+"></img>"+(r.FavorButtonVisible?'<div class="ProductsPanelItemFavorBtn" '+s+' style="left:'+(r.Width-100)+'px;"><span>收藏</span></div>':"")+'</div><div class="ProductsPanelItemSimpleHRightCT"><div class="ProductsPanelItemCaption" '+s+'><span title="'+r.Caption+'">'+r.Caption+'</span></div><div class="ProductsPanelItemPrice"><span>'+KDProductsPanelProxy.__getPrice(r)+"</span></div>"+(l?'<div class="ProductsPanelItemOriginalPrice"><span>'+l+"</span></div>":"")+"</div></div>"),c=$.extend(r.CssOptions?JSON.parse(r.CssOptions):{},{width:r.Width,height:r.Height,overflow:"hidden"});d.css(c);var h={width:r.ImageWidth,height:r.ImageHeight,left:"0px",display:"inline-block","vertical-align":"top"};$(".ProductsPanelItemImg",d).css(h),$(".ProductsPanelItemImg Img",d).css($.extend({},h)),$(".ProductsPanelItemSimpleHRightCT",d).css({width:r.Width-o()-r.ImageWidth,height:r.Height,display:"inline-block",overflow:"hidden"});var u={color:r.CaptionColorString,"font-size":r.CaptionFontSize,"white-space":"normal",padding:"15px 3px 0px 10px",height:"35px",overflow:"hidden",width:r.Width-o()-r.ImageWidth};$(".ProductsPanelItemCaption",d).css(u);var p={color:r.PriceColorString,"font-size":r.PriceFontSize,"padding-left":"10px"};$(".ProductsPanelItemPrice",d).css(p);var g={color:r.OriginalPriceColorString,"font-size":r.OriginalPriceFontSize};return $(".ProductsPanelItemOriginalPrice",d).css(g).hide(),d.mouseenter(function(){var e=$(this);$(".ProductsPanelItemFavorBtn",e).show(),e.addClass("ProductsPanelItem-hover")}),d.mouseleave(function(){var e=$(this);$(".ProductsPanelItemFavorBtn",e).hide(),e.removeClass("ProductsPanelItem-hover")}),KDProductsPanelProxy.__attachProductItemEventHandler(d,t,i),d},__createProductLineItem:function(e,t,i){var a=e,n=KDProductsPanelProxy.__getKDKVPData(a),o=a.ButtonDisabled?"ProductsPanelItemBtn-M1-disabled":"ProductsPanelItemBtn-M1",r=$('<div class="ProductsPanelItem-M1" '+n+'><div class="ProductsPanelItemImg-M1" '+n+'><img src="'+KDProductsPanelProxy._getFormatImg(a.ImageUrl)+'" '+n+'></img><div class="ProductsPanelItemFavorBtn-M1" '+n+' style="left:25px;"><span>*</span></div></div><div class="ProductsPanelItem-Column2-M1"><div class="ProductsPanelItemCaption-M1" '+n+'><span title="'+a.Caption+'">'+a.Caption+'</span></div><div class="ProductsPanelItemPrice-M1"><span>'+KDProductsPanelProxy.__getPrice(a)+'</span></div></div><div class="ProductsPanelItemQty-M1"><input value="'+a.Quantity+'" '+n+'></input></div><div class="'+o+'" '+n+"><span>"+a.ButtonCaption+"</span></div></div>"),s=({width:a.Width,height:a.Height},{color:a.CaptionColorString,"font-size":a.CaptionFontSize}),l={color:a.PriceColorString,"font-size":a.PriceFontSize};$(".ProductsPanelItemCaption-M1",r).css(s),$(".ProductsPanelItemPrice-M1",r).css(l),$(".ProductsPanelItemFavorBtn-M1",r).hide(),r.mouseenter(function(){var e=$(this);$(".ProductsPanelItemFavorBtn-M1",e).show(),e.addClass("ProductsPanelItem-M1-hover")}),r.mouseleave(function(){var e=$(this);$(".ProductsPanelItemFavorBtn-M1",e).hide(),e.removeClass("ProductsPanelItem-M1-hover")});var d=KDProductsPanelProxy.__getQtyOptions(a);return $(".ProductsPanelItemQty-M1 input",r).KDNumerInput(d),KDProductsPanelProxy.__attachProductItemEventHandler(r,t,i,1),r},__createProductSimpleHLineItem:function(e,t,i){return KDProductsPanelProxy.__createProductLineItem(e,t,i)},__createProductSimpleVLineItem:function(e,t,i){return KDProductsPanelProxy.__createProductLineItem(e,t,i)},__attachProductItemEventHandler:function(e,t,i,a){var n=a?"-M1":"";return $(".ProductsPanelItemFavorBtn"+n,e).click(function(e){var t=$(this).attr("data-kdkvp"),a=$.extend(JSON.parse(t||"{}"),{ActionKey:"AddFavor"});i&&i.onItemClick&&i.onItemClick.call(i,a)}),$(".ProductsPanelItemImg"+n+" img",e).bind("error",KDProductsPanelProxy._onImageError),$(".ProductsPanelItemImg"+n+" img",e).click(function(e){var t=$(this).attr("data-kdkvp"),a=$.extend(JSON.parse(t||"{}"),{ActionKey:KDProductsPanelProxy.C_OpenImage});i&&i.onItemClick&&i.onItemClick.call(i,a)}),$(".ProductsPanelItemCaption"+n,e).click(function(e){var t=$(this).attr("data-kdkvp"),a=$.extend(JSON.parse(t||"{}"),{ActionKey:KDProductsPanelProxy.C_OpenItem});i&&i.onItemClick&&i.onItemClick.call(i,a)}),$(".ProductsPanelItemBtn"+n,e).click(function(t){var a=$(this).attr("class")||"";if(!(a.indexOf("ProductsPanelItemBtn"+n+"-disabled")>=0)){var o=$(this).attr("data-kdkvp"),r=$.extend(JSON.parse(o||"{}"),{Qty:$(".ProductsPanelItemQty"+n+" input:first",e).val(),ActionKey:"DefaultButton"});i&&i.onItemClick&&i.onItemClick.call(i,r)}}),e},_onImageError:function(){var e=$(this).attr("src");$(this).attr("src",KDProductsPanelProxy._getFormatImg()),$(this).attr("title","Not Found!"+e),$(this).unbind&&$(this).unbind("error",KDProductsPanelProxy._onImageError)},_getFormatDecimal:function(e,t){var i=e;return KD.format(i,{formatType:"number",dataType:"bigdecimal",decimalPrecision:2})},_getFormatMoney:function(e,t){var i=e;return KD.format(i,{formatType:"currency",dataType:"integer",currencySymbol:t?t.substring(0,1):"",decimalPrecision:2})},_getFormatImg:function(e){var t="Images/biz/default/common/defaultproduct.png";return e||t}}),KDControlFactoryProxy.registerType("prodspanel",KDProductsPanelProxy),define("KDProductsPanelProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDProductsPanelProxy}}(this)),KDSwitchBarProxy=KD.extend(KDContainerProxy,{createControl:function(e){KDContainerProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDSwitchBarProxy.superclass.loadConfig.call(this,e);var t=this;t.el.addClass("kdswitchbar");var i={height:"inherit"},a=KD.entryrolePlugins.getPlugin(KD.getEntryRole());if(a&&$.isFunction(a.getMarginSize)){var n=a.getMarginSize.call(a,e);$.extend(i,{left:n.left})}t.el.css(i)},setMode:function(e){this.modeKey=e||""},getMode:function(){return this.modeKey||""},getFocusedClass:function(){return"kdswitchbutton-"+this.getMode()+"focused"},getSelectedClass:function(){return"kdswitchbutton-"+this.getMode()+"focused"},setFocused:function(e){var t=this,i=t.getFocusedClass(),a=t.controlFactoryProxy.getCmp(e);if(a){for(var n=a.getControl(),o=0;o<t.children.length;o++){var r=t.children[o],s=r.getControl();$("a:first",s).removeClass(i)}$("a:first",n).addClass(i)}},setSelected:function(e){var t=this,i=t.getSelectedClass(),a=t.controlFactoryProxy.getCmp(e);if(a){var n=a.getControl();$("a:first",n).addClass(i)}},clearSeleted:function(e){for(var t=this,i=t.getSelectedClass(),a=0;a<t.children.length;a++){var n=t.children[a],o=n.getControl();$("a:first",o).removeClass(i)}var r=t.controlFactoryProxy.getCmp(e);if(r){var s=r.getControl();$("a:first",s).addClass(i)}},loadChildren:function(e){var t=this;if(!t.isChilderLoaded){t.children||(t.children=[]);var i=t.el.parent().height(),a=t.config.leftPadding||35,n=t.config.rightPadding||35;$('<div style="display:inline-block;width:'+a+'px;height:inherit;">').appendTo(t.el),t.ctEl=$('<div style="display:inline-block;height:inherit;line-height:'+i+'px;">').appendTo(t.el),$('<div style="display:inline-block;float:right;width:'+n+'px;height:inherit;">').appendTo(t.el);var o=e.items;if(null!=o&&t.controlFactoryProxy)for(var r in o){var s=o[r];s.height=i;t.createInnerControl.call(t,s)}this.initchildren(),this.isChilderLoaded=!0}},setFocusedSimple:function(e){var t=this,i=t.getFocusedClass();$("li",t.ctEl).removeClass(i);var a=$('[data-kdid="'+e+'"',t.ctEl);a&&a.length&&a.addClass(i)},loadChildrenSimple:function(e){if(!this.isChilderLoaded){var t=this;t.children||(t.children=[]);var i=t.getFocusedClass(),a=t.config.leftPadding||35,n=t.config.rightPadding||35;$('<div style="display:inline-block;width:'+a+'px;height:inherit;">').appendTo(t.el),t.ctEl=$("<ul>").appendTo(t.el),$('<div style="display:inline-block;float:right;width:'+n+'px;height:inherit;">').appendTo(t.el);var o=e.items,r=t.getFormProxy();if(null!=o&&t.controlFactoryProxy)for(var s in o){var l=o[s];if(l.xtype&&"kdbutton"==l.xtype){var d=$('<li class="kdswitchbutton"><span></span></li>').appendTo(t.ctEl);$("span",d).text(l.text),d.attr("data-kdid",l.id),d.attr("data-validation",l.validation),d.attr("data-url",l.url);var c={width:l.width,height:"inherit",display:"inline-block"};d.css(c),d.click(function(e){$("li",$(this).parent()).removeClass(i);var t=$(this);t.addClass(i);var a=t.attr("data-kdid"),n=t.attr("data-validation"),o=d.attr("data-url");KDSwitchBarProxy.onItemClick(r,a,n,o)})}else{t.createInnerControl(l)}}this.isChilderLoaded=!0}},doLayout:function(){},createInnerControl:function(e){var t=this;e.dock=3,e.stylekey="BluePureRightAngleButtonStyle kdswitchbutton";var i={margin:"0px",top:"0px",position:"relative",height:"inherit",width:e.width+"px;"};e.InlineStyle=$.extend(e.InlineStyle||{},i);var a=t.controlFactoryProxy.createControl(e);t.children.push(a);var n=a.getControl();return n.appendTo(t.ctEl),a.loadConfig.call(a,e),a},initchildren:function(){for(var e in this.children){var t=this.children[e];t.initComponent();var i=t.getControl();i.css({position:"relative","float":"left",height:"inherit"}),t.doLazyAction.call(t),i.ready(function(){$("a:first",i).css({"line-height":i.height()+"px"}).css("height",i.height())})}}}),$.extend(KDSwitchBarProxy,{onItemClick:function(e,t,i,a){var n=i?e.validating.call(e,!0):!0;if(n){if(KD.isUrl(a))return void window.open(a);e.lockControl.call(e,this),e.fireEvent.call(e,"ButtonClick",t,"")}}}),KDControlFactoryProxy.registerType("switchbar",KDSwitchBarProxy),define("KDSwitchBarProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDSwitchBarProxy}}(this)),KDTravelPanelProxy=KD.extend(KDContainerProxy,{travePanelWidth:296,traveCopyBtnVisibleValue:[],traveSplitBtnVisibleValue:[],loadConfig:function(e){KDTravelPanelProxy.superclass.loadConfig.call(this,e),this.el.addClass("kd-travelPanel"),this.traveCopyBtnVisibleValue=KD.getValue(e,"traveCopyBtnVisibleValue",[]),this.traveSplitBtnVisibleValue=KD.getValue(e,"traveSplitBtnVisibleValue",[]),this._initTraveTemp(),this._initEvent()},_initTraveTemp:function(){var e=this,t=kendo.format("<div class='kd-traveWrap'><div class='kd-traveContain'><div class='kd-traveItems'><div class='kd-traveAdd'><img src='../images/biz/default/MainConsole/H5CardLayout/add.png' /><span>{0}</span></div></div></div><div class='kd-travePre kd-traveDisablePre'><span></span></div><div class='kd-traveNext kd-traveDisableNext'><span></span></div></div><div class='kd-traveContent'><span class='kd-traveContent-lineStyle kd-traveContent-LeftlineStyle'></span>{1}<span class='kd-traveContent-count'>0</span>{2}<span class='kd-traveContent-lineStyle kd-traveContent-RightlineStyle'></span></div><div class='kd-traveBottom'></div>",ResManager.LoadKDString("添加行程","0025372030032289"),ResManager.LoadKDString("共","0025710000004604"),ResManager.LoadKDString("个行程","0025372030037399"));this.el.html(t);var i=$(".kd-traveContain",this.el);i.width(this.el.width()-134);var a=$(".kd-traveItems",this.el);$(".kd-travePre>span",this.el).click(function(t){e._handlemove.call(e,a,!1)}),$(".kd-traveNext>span",this.el).click(function(t){e._handlemove.call(e,a,!0)}),$(".kd-traveAdd",this.el).click(function(t){e._handleAdd.call(e,t)})},_initEvent:function(){var e=this;$(".kd-cardDelete",this.el).on("click",function(t){e._handleDelete.call(e,t)}),$(".kd-traveItem",this.el).on("click",function(t){e._handleSelect.call(e,t)}),this.el.find(".kd-cardSplit").on("click",function(t){e._handleSplit.call(e,t)}),this.el.find(".kd-cardEdit").on("click",function(t){e._handleEdit.call(e,t)}),this.el.find(".kd-cardCopy").on("click",function(t){e._handleCopy.call(e,t)})},_handleAdd:function(e){var t=this.getFormProxy();t.lockControl.call(t,this),t.fireCustomEventsNoData.call(t,"kingdee.bos.travelPanel.addTrave",this.key,"addTrave")},_handleDelete:function(e){e.stopPropagation();var t=$(e.target).closest(".kd-traveItem"),i=$(".kd-traveItem",this.el).removeClass("kd-traveSelectItem").index(t),a=this.getFormProxy();a.lockControl.call(a,this),a.fireCustomEventsNoData.call(a,"kingdee.bos.travelPanel.deleteTrave",this.key,i)},_handleSelect:function(e){var t=$(e.target).closest(".kd-traveItem");if(!t.hasClass("kd-traveSelectItem")){var i=$(".kd-traveItem",this.el).removeClass("kd-traveSelectItem").index(t);t.addClass("kd-traveSelectItem");var a=this.getFormProxy();a.lockControl.call(a,this),a.fireCustomEventsNoData.call(a,"kingdee.bos.travelPanel.selectTrave",this.key,i)}},_handlemove:function(e,t){var i=this.travePanelWidth,a=this._getTransformDomX(e),n=$(".kd-traveContain",this.el).width();if(t){if(i=0-i,Math.abs(a)>=this.allTravePanelWidth-n)return void $(".kd-traveNext",this.el).addClass("kd-traveDisableNext");$(".kd-travePre",this.el).removeClass("kd-traveDisablePre")}else{if(a>=0)return void $(".kd-travePre",this.el).addClass("kd-traveDisablePre");$(".kd-traveNext",this.el).removeClass("kd-traveDisableNext")}var o=a+i;e.css({transform:"translateX("+o+"px)"}),o>=0&&$(".kd-travePre",this.el).addClass("kd-traveDisablePre"),Math.abs(o)>=n&&$(".kd-traveNext",this.el).addClass("kd-traveDisableNext")},_handleSplit:function(e){var t=$(e.target).closest(".kd-traveItem"),i=this.el.find(".kd-traveItem").index(t),a=this.getFormProxy();a.lockControl.call(a,this),a.fireCustomEventsNoData.call(a,"kingdee.bos.travelPanel.handleSplit",this.key,i)},_handleEdit:function(e){var t=$(e.target).closest(".kd-traveItem"),i=this.el.find(".kd-traveItem").index(t),a=this.getFormProxy();a.lockControl.call(a,this),a.fireCustomEventsNoData.call(a,"kingdee.bos.travelPanel.handleEdit",this.key,i)},_handleCopy:function(e){var t=$(e.target).closest(".kd-traveItem"),i=this.el.find(".kd-traveItem").index(t),a=this.getFormProxy();a.lockControl.call(a,this),a.fireCustomEventsNoData.call(a,"kingdee.bos.travelPanel.handleCopy",this.key,i)},_getTransformDomX:function(e){var t=e.attr("style");if(t&&t.match){var i=/translateX\(-?\d+/g,a=t.match(i);t=a&&a.length>0?a[0].replace("translateX(",""):0}else t=0;return parseInt(t)},_getTraveItem:function(e){var t=KD.isNaN(e.index)?"":e.index+1,i=this._templateFunc(kendo.format("<div class='kd-traveItem'><div class='kd-traveTop'><div class='kd-traveTotalTime'><span>{5}{6}</span></div><div class='kd-traveDelete'><span title='{3}' class='kd-cardEdit' style='background-image:url({1})'></span><span title='{4}' class='kd-cardCopy' style='background-image:url({1});'></span><span title='{0}' class='kd-cardSplit' style='background-image:url({1})'></span><span title='{2}' class='kd-cardEditItem kd-cardDelete' style='background-image:url({1})'></span></div></div><div class='kd-traveDetail'><div class='kd-traveFrom'><div class='kd-traveFromSite'><span style='height:16px;' class='kd-traveAdress'></span><span style='margin-left:3px' title='{{fromSite}}'>{{fromSite}}</span></div><div class='kd-traveFromDate'><span style='margin-left:13px'>{{fromDate}}</span></div></div><div class='kd-travePath'><span class='kd-travePathTip kd-travePathTip1' style='opacity:0.1985;'></span><span class='kd-travePathTip kd-travePathTip2' style='opacity:0.3956;'></span><span class='kd-travePathTip kd-travePathTip3' style='opacity:0.6038;'></span><span class='kd-travePathTip kd-travePathTip4' style='opacity:0.7992;'></span><span class='kd-travePathTip kd-travePathTip5' style=''></span><span class='kd-travePathTip-totalTime' title='{{totalTime}}'>{{totalTime}}</span></div><div class='kd-traveTo'><div class='kd-traveToSite'><span style='height:16px;' class='kd-traveAdress'></span><span style='margin-left:3px' title='{{toSite}}'>{{toSite}}</span></div><div class='kd-traveToDate'><span>{{endDate}}</span></div></div><div class='kd-traveSplic'></div></div><div class='kd-traveRemarkPanl'><div class='kd-traveRemark'><span title='{{remark}}'>{{remark}}</span></div><div class='kd-traveTotalCost'><span title='{{totalCost}}'>{{totalCost}}</span></div></div></div>",ResManager.LoadKDString("复制","014005030024903"),KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),ResManager.LoadKDString("删除","099002000000046"),ResManager.LoadKDString("编辑","0991733000003953"),ResManager.LoadKDString("拆分","0025372030032330"),ResManager.LoadKDString("行程","00215181000006207"),t),e);return i},_templateFunc:function(e,t){return e=e.replace(/\{\{\w+\.?\w+\}\}/g,function(e){var i=e.replace(/\{\{/g,"").replace(/\}\}/g,"").trim();return t[i]})},setSelect:function(e){this.selectedIndex=e,$(".kd-traveItem",this.el).removeClass("kd-traveSelectItem"),$($(".kd-traveItem",this.el)[e]).addClass("kd-traveSelectItem")},setData:function(e){if(this.data=e,this.allTravePanelWidth=this.travePanelWidth,$(".kd-traveItem",this.el).remove(),KD.isArray(e)&&this.el.find(".kd-traveContent-count").text(this.data.length),!KD.isEmpty(e)&&KD.isArray(e)){for(var t="",i=$(".kd-traveContain",this.el).width(),a=0;a<e.length;a++){var n=e[a];t+=this._getTraveItem(n),this.allTravePanelWidth+=this.travePanelWidth}$(t).insertBefore($(".kd-traveAdd",this.el)),this._reloadTraveBtnVisibleState();var i=$(".kd-traveContain",this.el).width();this.allTravePanelWidth>i&&$(".kd-traveNext",this.el).removeClass("kd-traveDisableNext"),this._initEvent()}},setTraveAddCradVisible:function(e){e?this.el.find(".kd-traveAdd").show():this.el.find(".kd-traveAdd").hide()},setTraveCopyButtonVisible:function(e){this.traveCopyBtnVisibleValue=e,this._setTraveBtnVisibleState(e,".kd-cardCopy")},setTraveSplitButtonVisible:function(e){this.traveSplitBtnVisibleValue=e,this._setTraveBtnVisibleState(e,".kd-cardSplit")},_setTraveBtnVisibleState:function(e,t){if(KD.isArray(e)&&this.el)for(var i=this.el.find(".kd-traveItem"),a=0;a<e.length;a++){var n=e[a].index,o=e[a].visible;if("all"==n){o?i.find(t).show():i.find(t).hide();break}if(n=parseInt(n),!KD.isNaN(n)){var r=$(i[n]);o?r.find(t).show():r.find(t).hide()}}},addTrave:function(e){var t=this._getTraveItem(e);$(t).insertBefore($(".kd-traveAdd",this.el)),this._reloadTraveBtnVisibleState()},_reloadTraveBtnVisibleState:function(){this.setTraveCopyButtonVisible(this.traveCopyBtnVisibleValue),this.setTraveSplitButtonVisible(this.traveSplitBtnVisibleValue)},deleteTrave:function(e){if(e=parseInt(e+""),!KD.isNaN(e)){var t=$(".kd-traveItem",this.el)[e];$(t).remove()}},doLayout:function(){KDTravelPanelProxy.superclass.doLayout.call(this);var e=$(".kd-traveContain",this.el).width(this.el.width()-134);this.allTravePanelWidth&&this.allTravePanelWidth>e&&$(".kd-traveNext",this.el).removeClass("kd-traveDisableNext")}}),KDControlFactoryProxy.registerType("travelPanel",KDTravelPanelProxy),define("KDTravelPanelProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDTravelPanelProxy}}(this)),KDAcctOrgStatisticTableProxy=KD.extend(KDControlProxy,{getCType:function(){return""},createControl:function(e){KDAcctOrgStatisticTableProxy.superclass.createControl.call(this,e),this.el.addClass("acctorgstatisticsTable"),$('<span style="text-algin:center;color:lightgray;">Account organization statistics table</span>').appendTo(this.el)},loadConfig:function(e){KDAcctOrgStatisticTableProxy.superclass.loadConfig.call(this,e),this.setDebugData()},setDebugData:function(){var e=this;KD.delayInvoke(function(){e.debugData||(e.debugData=e.getDebugData.call(e),e.setData.call(e,e.debugData))},1500)},initInnerContainer:function(){this.el.empty(),delete this.headers,delete this.rows,this.headers=[];var e=$('<div class="acctorgstatisticsHead">').appendTo(this.el);this.headers.push(e),e=$('<div class="acctorgstatisticsHead">').appendTo(this.el),$('<div style="height:1px;background:#92D0FF;position:relative;left:0px;top:50%;width:100%;"></div>').appendTo(e),this.headers.push(e),e=$('<div class="acctorgstatisticsHead">').appendTo(this.el),this.headers.push(e),this.rows=[];var t=$('<div class="acctorgstatisticsBody">').appendTo(this.el);this.rows.push(t)},setData:function(e){this.debugData=e,this.el.hide(),this.initInnerContainer();var t=e;if(t.headers)for(var i in t.headers){var a=t.headers[i],n=this.headers[i];for(var o in a){var r=a[o]||{},s=0==o?this.cellFirstTemplate:o==this.colCount-1?this.cellLastTemplate:this.cellTemplate,l=r.CssOptions,d=$(s).html(r?r.value||"":"");l&&d.css(l);var c=r.cls?"acctorgstatistics-"+r.cls:"";c&&$("<div>").addClass(c).appendTo(d),d.appendTo(n)}}if(e.rows)for(var i in t.headers){var h=t.rows[i],u=this.rows[i];u||(u=$('<div class="acctorgstatisticsBody">').appendTo(this.el),this.rows.push(u));for(var o in h){var r=h[o]||{},p=this.getLinkActionStr(r),s=0==o?this.cellFirstTemplate:o==this.colCount-1?this.cellLastTemplate:this.cellTemplate,g=r?r.value||"":"",f=p&&g?this.linkTempate.replace("{clickhandler}",p).replace("{text}",g):g,l=r.CssOptions,d=$(s).html(f);l&&d.css(l),d.appendTo(u)}}$('<div style="clear:both">').appendTo(this.el),this.el.show("slow")}}),$.extend(KDAcctOrgStatisticTableProxy.prototype,{colCount:13,cellFirstTemplate:'<div class="acctorgstatisticsCell acctorgstatisticsLineTitle"></div>',cellTemplate:'<div class="acctorgstatisticsCell"></div>',cellLastTemplate:'<div class="acctorgstatisticsCell acctorgstatisticsLineLastCell"></div>',linkTempate:'<a class="acctorgstatisticsCellLink" href="javascript:void(null)" onclick="{clickhandler}">{text}</div>',getLinkActionStr:function(e){if(void 0===e.row||void 0===e.key)return"";var t=$.extend({pageid:this.getPageId(),entrykey:this.getKey(),row:void 0,key:void 0},e),i=JSON.stringify(t).replace(/"/g,"&quot;"),a="KD.entryCellBtnClick("+i+")";return a},getDebugData:function(){var e={headers:[[null,{value:"2013",CssOptions:""},null,{value:"2014",CssOptions:""},null,null,null,null,null,null,null,null,null],[null,{value:"",cls:"bigCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"bigCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"},{value:"",cls:"smallCicle"}],[{value:"核算组织",CssOptions:""},{value:"11月"},{value:"12月"},{value:"1月"},{value:"2月"},{value:"3月"},{value:"4月"},{value:"5月"},{value:"6月"},{value:"7月"},{value:"8月"},{value:"9月"},{value:"10月"}]],rows:[[{value:"集团总部"},{value:"√",row:0,key:"F201311M",CssOptions:""},null,{value:"√"},null,{value:"√"},null,{value:"√"},{value:"√"},null,null,null,{value:"√"}],[{value:"蓝海机械"},{value:"√",CssOptions:""},{value:"√",row:1,key:"F201312M"},{value:"√",row:1,key:"F201401M"},null,null,{value:"√"},null,{value:"√"},null,null,null,null],[{value:"东方集团"},{value:"√",CssOptions:""},{value:"√",row:2,key:"F201312M"},{value:"√",row:2,key:"F201401M"},null,null,{value:"√"},null,{value:"√"},{value:"√"},{value:"√"},null,null]]};return e}}),KDControlFactoryProxy.registerType("kdacctorgstatistictable",KDAcctOrgStatisticTableProxy),define("KDAcctOrgStatisticTableProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDAcctOrgStatisticTableProxy}}(this)),KDTreeProxy=KD.extend(KDContainerProxy,{treeData:[],exceptData:{},getKendoCType:function(){return"kendoKDTreeView"},createInnerDom:function(){return $("<div tree='tree_All' class='kd-treeview' style='height: inherit;display: flex;'></div>")},getInputText:function(e){var t=$("input[type=hidden]",e).val();return t},ExpandedTrigerNodeClick:!1,ExpandedTrigerNodeSelect:!0,AfterDeleteSelectOther:!0,SelectLinkage:!0,MultNodeLastCollapse:!1,IsNotChildNodeDisabled:!1,treeNodeKeyMap:{},lastNodeTreeItem:{},getKendoOptions:function(){var e=this,t=KDTreeProxy.superclass.getKendoOptions.call(e),i=kendo.format("<span datarole='container' class='{6} kd-treenode-text' ishasChild='{7}'>{0}<input treeId='{1}' id='{4}_treeId_{1}' treeParentId='{2}' treeUid='{3}'  type='hidden' value='{1}' nodevisible='{5}'/></span> ","#= item.text #","#= item.id #","#= item.parentId #","#= item.uid #",e.baseId,"#= item.visible #","#= item.Style #","#= item.isParent#");return $.extend(t,{template:i,autoScroll:!0,autoBind:!0,dataTextField:"text",checkboxes:this.isMutli?{checkChildren:this.SelectLinkage,template:e._getNodeTempdate("checkboxes")}:!1,dataSource:[],dataBound:function(e){},select:function(t){if(e.component&&e.component.hasClass("kd-treeview-viewlocker"))return void t.preventDefault();var i=t.node,a=e.getInputText.call(e,i);e.writeLog("select:"+a+" name:"+i.text);var n=e.getDataItem(this.dataItems(),a);n&&n.cls&&"parentnode"==n.cls&&(!i||!i.children||i.children.length<2)&&e.loadSubTreeData(a,!1,!1),e.nodeClick.call(e,a)},expand:function(t){var i=t.node,a=e.getInputText.call(e,i);if(e.writeLog("expand:"+a+" name:"+i.innerText),e.getFormProxy().getHostWindowProxy()&&e.getFormProxy().getHostWindowProxy().el.focus(),e.ExpandedTrigerNodeClick)e.nodeClick.call(e,a);else{var n=e.getNodeDataByNodeId(a);if(n&&KD.isEmpty(n.children)&&!n.parentNodehasOnceClick)if(n.parentNodehasOnceClick=!0,0==e.ExpandedTrigerNodeSelect){var o=e.getDataItem(this.dataItems(),a);o&&o.cls&&"parentnode"==o.cls&&(!i||!i.children||i.children.length<2)&&e.loadSubTreeData(a,!1,!1)}else t.sender&&(t.sender.select.call(t.sender,$(i)),t.sender.options.select.call(t.sender,t))}},collapse:function(t){var i=t.node,a=e.getInputText.call(e,i);e.writeLog("collapse:"+a+" name:"+i.innerText),e.getFormProxy().getHostWindowProxy()&&e.getFormProxy().getHostWindowProxy().el.focus()},check:function(t){if(e.component&&e.component.hasClass("kd-treeview-viewlocker"))return void t.preventDefault();var i=t.node,a=$(i).attr("isfromserverchecked");if(KD.isEmpty(a)){var n=e.getInputText.call(e,i);e.writeLog("select:"+n+" name:"+i.text);var o=e.getDataItem(this.dataItems(),n);if(o&&o.cls&&"parentnode"==o.cls&&(!i||!i.children||i.children.length<2)){var r=e.isMutli&&o.checked?!0:!1;e.loadSubTreeData(n,r,!1)}e._synMultiSelectedModelNodeAppearance(t.node),e.nodeClick.call(e,n)}}}),t},_getNodeTempdate:function(e){var t=this,i="";return this.isMutli&&"checkboxes"==e&&(i=kendo.format("<span datarole='container' class='{6} kd-treenode-text' ishasChild='{7}'><input type='checkbox' tabindex='-1' id='id{4}_treeId_{1}' class='k-checkbox' {8}><label for='id{4}_treeId_{1}'class='k-checkbox-label k-checkbox-label-multiselect'>{0}</label></span>","#= item.text #","#= item.id #","#= item.parentId #","#= item.uid #",t.baseId,"#= item.visible #","#= item.Style #","#= item.isParent #","#= item.IsDisabled #")),i},convertToJqID:function(e){if(KD.isString(e)){e=e||"";var t=/\|/g;e=e.replace(t,"-w-"),t=/\*/g,e=e.replace(t,"--u--")}return e},JqIdToId:function(e){if(KD.isString(e)){e=e||"";var t=/-w-/g;e=e.replace(t,"|"),t=/--u--/g,e=e.replace(t,"*")}return e},getDataItem:function(e,t){for(var i=this,a=i.getAllDataItem(e),n=0;n<a.length;n++){var o=a[n];if(o.id==t)return o}return null},getAllDataItem:function(e,t){var i=this;void 0==t&&(t=[]);for(var a=0;a<e.length;a++){var n=e[a];if(t.push(n),void 0!=n.items&&null!=n.items){var o=n.items;i.getAllDataItem(o,t)}}return t},loadConfig:function(e){this.rootCfg={id:"0",text:ResManager.LoadKDString("全部","099002000000017"),parentId:"",IsCustomIcon:!1,icon:"topnode",IsExpanded:!0,cls:"topnode"},this.el.addClass("kd-treeView-el"),KDTreeProxy.superclass.loadConfig.call(this,e),this.treeData=[],this.resetLastNodeTreeItem(),this.treeNodeKeyMap={},this.ItemStepNum=KD.getValue(e,"itemstepnum",100),this.FireMoreDataClick=KD.getValue(e,"firemoredataclick",!1),this.enableDD=e.enableDD,this.isMutli=e.isMulti,this.el.css("overflow","auto"),this.ExpandedTrigerNodeClick=KD.getValue(e,"expandedtrigernodeclick",!1),this.IsNotChildNodeDisabled=KD.getValue(e,"isNotChildNodeDisabled",!1),this.ExpandedTrigerNodeSelect=KD.getValue(e,"ExpandedTrigerNodeSelect",this.ExpandedTrigerNodeSelect),this.AfterDeleteSelectOther=KD.getValue(e,"afterDeleteSelectOther",!0),this.SelectLinkage=KD.getValue(e,"selectlinkage",!0)},setRootVisible:function(e){this.rootVisible!=e&&(this.rootVisible=e,this.component&&this.bindDataSource())},setRootCfg:function(e){KD.isEmpty(e)||(this.rootCfg={id:e.id||"0",text:e.text||ResManager.LoadKDString("全部","099002000000017"),parentId:KD.isEmpty(e.parentid)?"":e.parentid,IsCustomIcon:KD.isEmpty(e.IsCustomIcon)?!1:e.IsCustomIcon,icon:e.icon||"topnode",IsExpanded:KD.isEmpty(e.IsExpanded)?!0:e.IsExpanded,cls:e.cls||"topnode"})},initComponent:function(){var e=this;this.requestDataIng=-1,this.expandAllTree=!1,KDTreeProxy.superclass.initComponent.call(this),this.component.on("dblclick",".k-in",function(t){var i=$(t.target).closest(".k-item"),a=e.getInputText.call(e,i);e.writeLog("dblclick:"+a),e.nodeDoubleClick(a)});var t=$(kendo.format("<div class='kd-treeview-morebutton'>{0}</div>",ResManager.LoadKDString("更多","014006000001531")));this.el.append(t),this.exceptData={},t.click(function(){e.loadAllMoreItemData()}),this.setRootVisible(KD.getValue(this.config,"rootVisible",!1)),this._setComponentForMultiSelectedModel()},setViewLocked:function(e){KDTreeProxy.superclass.setViewLocked.call(this,e),0==this.el.find(".kd-ui-viewlocker").length&&this.component.removeClass("kd-treeview-viewlocker")},setDataUrl:function(e){var t=this;this.requestDataIng=0;var i="";if(KD.isString(e)?this.dataUrl=e:KD.isObject(e)&&(i=e.requestMethod||i,this.dataUrl=e.url),this.dataUrl){this.dataUrl&&(this.server=new KDRequest,this.server.scope=this,this.server.type=i,this.server.callback=this.onResponse,this.server.errCallBack=function(){t.getFormProxy().setBusy(!1)}),this.getFormProxy().setBusy(!0);var a=this.RootNode&&this.RootNode.id?this.RootNode.id:this.rootCfg.id,n='&paramdata=["'+this.key+'","'+a+'"]';this.server.url=this.dataUrl+n,this.server.callByUrl()}},loadSubTreeData:function(e,t,i){var a=this;if(this.dataUrl){this.server=new KDRequest,this.server.scope=this,this.server.callback=function(e){a.getFormProxy().setBusy(!1),a.onResponseSubTreeData.call(a,e,t,i)},this.server.errCallBack=function(){a.getFormProxy().setBusy(!1)},this.getFormProxy().setBusy(!0);var n=(this.rootCfg.id,'&paramdata=["'+this.key+'","'+e+'"]');this.server.url=this.dataUrl+n,this.server.callByUrl()}},onResponseSubTreeData:function(e,t,i){
var a=this,n=a.getFormProxy(),o=KD.isString(e)?KD.parseObject(e):e;if(KD.isArray(o)){if(o.length>0)if(null!=o[0].actionname)n.doActions.call(n,e);else{if(o.length>this.ItemStepNum){for(var r=o.splice(this.ItemStepNum),s=0;s<r.length;s++){var l=r[s],d=KD.isEmpty(l.parentid)?"0":l.parentid;this.exceptData[d]||(this.exceptData[d]=[]),this.exceptData[d].push(l)}this.changedMoreVisible(!0)}for(var c=0;c<o.length;c++){var h=o[c];i&&"parentnode"==h.cls&&!h.children&&a.loadSubTreeData(h.id,t,i);var u=a.getNodeDataParentId(h),p=this.getNodeDataByNodeId(u);p&&(p.children=p.children||[],p.children.push(o[c]));var g=this.createNode(h,u),f=a.el.find('input[treeid="'+u+'"]').parents(".k-item").eq(0).data("uid"),m=a.component.data(this.getKendoCType()).findByUid(f),v=this.component.data(this.getKendoCType()).append(g,m);this.isMutli&&v&&v.find('input[type="checkbox"].k-checkbox')[getPropName()]("checked",t),this._synNodeVisibleState()}}}else n.doActions.call(n,e)},loadAllMoreItemData:function(){var e=0;for(var t in this.exceptData)if(KD.isRunInForIn(t,this.exceptData)){var i=this.exceptData[t];this.loadMoreItemData(t,i),KD.isEmpty(i)||e++}0==e&&this.changedMoreVisible(!1)},loadMoreItemData:function(e,t){if(KD.isArray(t)){var i={};i.parentid=e,t.length>this.ItemStepNum?(i.nodes=this.exceptData[e].splice(0,this.ItemStepNum),this.addNodes(i)):(i.nodes=this.exceptData[e],this.addNodes(i),this.exceptData[e].splice(0)),0==this.exceptData[e].length&&delete this.exceptData[e]}},changedMoreVisible:function(e){e?(this.component.css("height",this.el.height()-20),this.el.find(".kd-treeview-morebutton").show()):(this.component.css("height","inherit"),this.el.find(".kd-treeview-morebutton").hide())},getNodeDataParentId:function(e){var t=KD.getValue(e,"parentId","");return KD.isEmpty(t)&&(t=KD.getValue(e,"parentid","")),t=this.convertToJqID(t)},setNodes:function(e){var t=KD.getValue(e,"parentId",""),i=e.nodes;if(null!=i)if(KD.IsNullOrWhiteSpace(t))this.treeData=e&&e.nodes?e.nodes:[],this.bindDataSource();else{var a=this.getNodeByNodeId(t);null!=a&&this.addNodes(e,!0)}},replaceNodes:function(e){if(KD.isObject(e)){var t=this.getNodeDataParentId(e);if(!t||t==this._getRootNodeId())return void(this.RootNode?(this.RootNode.children=e.nodes||[],this.updateState({RootNode:this.RootNode})):this.updateState({RootNode:{children:e.nodes||[],id:t||""}}));var i=this.findTreeNode(this.treeData,t);if(i){i.children=[];var a=this.getNodeByNodeId(t);if(a)for(var n=$(a).children(".k-group").children(),o=this.component.data(this.getKendoCType()),r=0;r<n.length;r++)o.remove(n[r]);var s=e.nodes;if(s){s.length>this.ItemStepNum&&(s=this.subDataByItemStepNumload({id:t,children:s}));for(var l=0;l<s.length;l++)i.children.push(s[l]);var d=this.createDataSource(s,t);d&&0==d.length||(a?this.component.data(this.getKendoCType()).append(d,a):this.component.data(this.getKendoCType()).append(d),this._synNodeVisibleState())}}}},addNode:function(e){var t=this.getNodeDataParentId(e),i=this.getNodeDataByNodeId(t);i?(i.children=i.children||[],i.children.push(e)):KD.equalsIgnoreCase(t+"",this._getRootNodeId()+"")&&this.treeData.push(e);var a=this.createNode(e,t),n=this.getNodeByNodeId(t);this.component.data(this.getKendoCType()).append(a,n),this._synNodeVisibleState()},addNodes:function(e,t){var i=this.getNodeDataParentId(e),a=e.nodes;if(a){a.length>this.ItemStepNum&&(a=this.subDataByItemStepNumload({id:i,children:a}));var n=this.getNodeDataByNodeId(i);if(n){n.children=n.children||[],1==t&&(n.children=[],this.clearNodes(e));for(var o=0;o<a.length;o++)n.children.push(a[o])}else if(KD.equalsIgnoreCase(i+"",this._getRootNodeId()+""))for(var o=0;o<a.length;o++)this.treeData.push(a[o]);var r=this.createDataSource(a,i),s=this.getNodeByNodeId(i);r&&0==r.length||(s?this.component.data(this.getKendoCType()).append(r,s):this.component.data(this.getKendoCType()).append(r),this._synNodeVisibleState())}},deleteNode:function(e){var t=this,i=e?e.id:null;if(i){this.deleteNodeIng=!0;var a=t.getNodeDataByNodeId(i),n="";if(i=this.convertToJqID(i),a){var o=this.getNodeDataParentId(a),r=t.getNodeDataByNodeId(o);if(!r&&this.rootVisible&&(r={},r.children=this.treeData,r.id=this._getRootNodeId()),r){var s=r.children&&r.children.indexOf?r.children.indexOf(a):-1,l=r.children&&r.children.length;s>=0&&(r.children.splice(s,1),t.treeNodeKeyMap[a.id]&&delete t.treeNodeKeyMap[a.id]);var d=s;if(s==l-1&&s>=0&&(d=s-1),d=0>d?0:d,n=r.children&&r.children.length&&0!=this.AfterDeleteSelectOther?r.children[d].id:r.id,t.nodeClick.call(t,n),!r.children.length){var c=this.getNodeByNodeId(r.id);if(!KD.isEmpty(c)){var h=c.find(".kd-treeview-icon");h.remove()}}}}KD.delayInvoke(function(e){var a=t.getNodeByNodeId.call(t,i);if(null!=a){var n=t.getKendoCType.call(t),o=t.component.data(n).select(),r=o.parent(),s=($($("input[type='hidden']",o)[0]),null);t.component.data(n).remove(a);var l=t.getNodeByNodeId.call(t,e);s=l&&l.length>0&&0!=t.AfterDeleteSelectOther?l:r,null!=s&&t.component.data(n).select(s)}t.deleteNodeIng=!1,t._synNodeVisibleState()},void 0,void 0,n)}},refreshNode:function(e){e&&e.node&&(void 0!=e.node.text&&this.setNodeText(e.node.id,e.node.text),void 0!=e.node.Style&&this.setNodeStyle(e.node.id,e.node.Style))},getParentNode:function(e){var t=$("#"+this.baseId+"_treeId_"+e).parent().parent().parent(),i=t.parent().parent();return i},getFocusNode:function(e){var t=$("#"+this.baseId+"_treeId_"+e).parent().parent().parent();if(t.next&&t.next().length>0)return $("input[type='hidden']",t.next());if(t.prev&&t.prev().length>0)return $("input[type='hidden']",t.prev());if(t.parent&&t.parent().length>0){var i=$("input[treeId='"+e+"']",t),a=i.attr("treeParentId");return $("#"+this.baseId+"_treeId_"+a)}return null},onResponse:function(e){var t=this,i=e,a=t.getFormProxy();a.setBusy(!1);var n=jobj=KD.parseObject(i);if(KD.isArray(n)&&(n.length>0||0==n.length&&KD.isEmpty(this.treeData)))if(n[0]&&null!=n[0].actionname)a.doActions.call(a,n);else{var o=KD.getValue(this.rootCfg,"id","0");if(n.length>this.ItemStepNum){var r={id:o,children:n};this.treeData=this.subDataByItemStepNumload(r)}else n[0]&&n[0].id==o&&n[0].children&&n[0].children.length>this.ItemStepNum?this.treeData=this.subDataByItemStepNumload(n[0]):this.treeData=n;this.setNodeIsMutli(this.treeData,!1),this.bindDataSource()}else KD.isObject(jobj)&&a.doActions.call(a,[jobj]);this.requestDataIng++},bindDataSource:function(){var e=this,t=[];if(this.resetLastNodeTreeItem(),this.rootVisible){var i=ResManager.LoadKDString("全部","002549030021005"),a={id:KD.getValue(this.rootCfg,"id","0"),text:KD.htmlUtil.encode(KD.getValue(this.rootCfg,"text",i)),parentId:KD.getValue(this.rootCfg,"parentId","")};this.setCheckBoxCommand(a),a.children=this.treeData,t=this.createDataSource(a)}else t=this.createDataSource(this.treeData);var n=new kendo.data.HierarchicalDataSource({data:t});this.component.data(this.getKendoCType()).setDataSource(n),this.nodeDataSource=n;var o=this.getFormProxy();(void 0!=this.treeData||this.rootVisible&&void 0!=this.treeData)&&(o.lockControl.call(o,e),KD.delayInvoke(function(){o.fireCustomEvents.call(o,e.key,"TreeViewDataSourceChanged","")})),this.rootVisible&&e.component.data(this.getKendoCType()).expand(".k-item:first"),e.expandAllTree&&e.component.data(this.getKendoCType()).expand(".k-item"),e.MultNodeLastCollapse&&e.setMultNodeLastCollapse(!0),this._synNodeVisibleState()},clearNodes:function(e){if(!KD.isEmpty(e)){var t=KD.isObject(e)?e.parentId:e,i=this.getNodeDataByNodeId(t);if(i){i.children=[];var a=this.getNodeByNodeId(t);if(a)for(var n=$(a).children(".k-group").children(),o=this.component.data(this.getKendoCType()),r=0;r<n.length;r++)o.remove(n[r])}}},createDataSource:function(e,t){if(e&&e.actionName){var i=this.controlFactoryProxy.getParentFormProxy();i&&i.doAction.call(i,e.actionName,e.params)}var a=[];if(void 0==e||null==e)return a;if(KD.isArray(e))for(var n in e){var o=e[n];a.push(this.createNode(o,t||o.parentId))}else a.push(this.createNode(e,t||e.parentId));return a},createNode:function(e,t){this.requestDataIng++;var i="";null==e.text&&(e.text="."),i=KD.htmlUtil.encode(e.text)||"",""==i&&(i=".&nbsp;");var a={id:e.id||"",text:i,parentId:t||""};if(a.id=this.convertToJqID(a.id),e.cls&&(a.cls=e.cls),e.icon&&(KD.isBase64Str(e.icon)?a.imageUrl="data:image/png;base64,"+e.icon:a.imageUrl=KD.getUrlRoot()+"/"+e.icon),e.IsCutomIcon&&(a.IsCutomIcon=e.IsCutomIcon),e.Forecolor&&(a.Forecolor=e.Forecolor),e.children){for(var n=new Array,o=KD.isArray(e.children)?e.children:[e.children],r=0;r<o.length;r++){var s=o[r];n.push(this.createNode(s,e.id))}n.length>0&&(a.items=n)}var l=this._isHasChild(a);return l?(a.hasChildren=l,a.isParent=l,a.parentNodehasOnceClick=void 0):this.IsNotChildNodeDisabled&&(a.IsDisabled=e.IsDisabled?"disabled":""),a.Style=e.Style||"",this.treeNodeKeyMap[a.id]=a,a},setIsMutli:function(e){this.setMutliSelect(e)},setMutliSelect:function(e){this.isMutli=e,this._setComponentForMultiSelectedModel();var t=this.component.data(this.getKendoCType()),i=t.options;i.checkboxes=this.isMutli?{checkChildren:this.SelectLinkage,template:this._getNodeTempdate("checkboxes")}:!1,t.setOptions(i),t.setDataSource(t.dataSource)},_setComponentForMultiSelectedModel:function(){var e=this;e.isMutli?(e.component.addClass("kd-treeview-mutiselect"),e.component.on("dblclick",".k-checkbox-wrapper",function(t){var i=$(t.target).closest(".k-item"),a=e.getInputText.call(e,i);e.nodeDoubleClick(a)})):e.component.removeClass("kd-treeview-mutiselect")},_synMultiSelectedModelNodeAppearance:function(e){e=$(e),this.isMutli&&e&&e.length>0&&(this.component.find(".k-checkbox-label-multiselect").removeClass("kd-state-selected"),e.children("div").find(".k-checkbox-label-multiselect").addClass("kd-state-selected"))},setNodeIsMutli:function(e,t){for(var i in e){var a=e[i];a.IsMulti=this._isMutli,a.IsChecked=t,this.setCheckBoxCommand(a),null!=a.children&&this.setNodeIsMutli(a.children,!1)}},getSelIds:function(e){if(!this.isMutli)return e;for(var t="",i=$("input.k-checkbox:checked",this.component),a=0;a<i.length;a++){var n=i[a],o=$(n).closest("li[role=treeitem]"),r=this.getInputText(o);t+=r+","}return KD.isEmpty(t)?"":t.substr(0,t.length-1)},nodeClick:function(e){var t=new Object;if(null!=e){t.selids=this.JqIdToId(this.getSelIds(e)),t.curid=this.JqIdToId(e);var i=this.getFormProxy();i.lockControl.call(i,this),this.el.find(".kd-ui-viewlocker").length>0&&(this.el.find(".kd-ui-viewlocker").hide(),this.component.addClass("kd-treeview-viewlocker")),this.oldnodeId=e,i.fireEvent.call(i,"TreeNodeClick",this.key,JSON.stringify(t))}},nodeDoubleClick:function(e){var t=new Object;if(null!=e){t.selids=this.JqIdToId(this.getSelIds(e)),t.curid=this.JqIdToId(e);var i=this.getFormProxy();i.lockControl.call(i,this),i.fireEvent.call(i,"TreeNodeDoubleClick",this.key,JSON.stringify(t))}},setCheckBoxCommand:function(e){},getIsFolatTree:function(){var e=this,t=e.getFormProxy().getHostWindowProxy().config.xtype;return"kdpopup"==t||"kdPopupWorkPages"==t||"kdPopupMainMenuProxy"==t?!0:!1},select:function(e){var t=this;if(e=this.convertToJqID(e),this.oldnodeId!=e&&!KD.isEmpty(this.treeNodeKeyMap[e])){this.writeLog("API select:"+e);var i=this.expandNode(e);if(!(null==i||void 0==i||i.length<=0||KD.equalsIgnoreCase(e+"",t._getRootNodeId()+""))){var a=this.component.data(this.getKendoCType()).select();if(a.data("uid")!=i.data("uid")){var n=t.getNodeItemByNodeId(e);n&&n.cls&&"parentnode"==n.cls&&(!i||!i.children||i.children().length<2)&&t.loadSubTreeData(e,!1,!1),this.deleteNodeIng?KD.delayInvoke(function(){t.component.data(t.getKendoCType()).select(i)}):this.component.data(this.getKendoCType()).select(i),KD.isIeBrowser()&&this.requestDataIng<=0?KD.delayInvoke(function(){var i=t.getNodeByNodeId.call(t,e);KD.isEmpty(i)||t.nodeClick.call(t,e)},300):this.nodeClick(e)}}}},updateState:function(e){if(!this.isDontLazy())return void this.pushLazyAction("updateState",e);var t=this;if(e){if(e.RootNode){this.resetLastNodeTreeItem();var i=[],a=this.subDataByItemStepNumload(e.RootNode);a?t.treeData=e.RootNode.children=a:t.treeData=e.RootNode.children,e.rootVisible||KD.getValue(this.config,"rootVisible",!0)?(t.rootVisible&&null==e.RootNode.text&&(e.RootNode.text=ResManager.LoadKDString("全部","0025710030033446")),e.RootNode.id=KD.getValue(e.RootNode,"id","0"),t.setRootCfg(e.RootNode),t.treeData=e.RootNode.children,i=this.createDataSource(e.RootNode)):(t.treeData=e.RootNode.children,i=this.createDataSource(e.RootNode.children));var n=new kendo.data.HierarchicalDataSource({data:i}),o=t.component.data(this.getKendoCType());o.setDataSource(n),o.expand(".k-item:first"),t.nodeDataSource=n;var r=t.getFormProxy();r.lockControl.call(r,t),r.fireCustomEvents.call(r,t.key,"TreeViewDataSourceChanged","")}null!=e.expanded&&e.expanded&&(e.RootNode&&e.RootNode.text?(o.expand(o.findByText(e.RootNode.text)),t.expandNode(e.RootNode.id)):t.expandTree()),KDTreeProxy.superclass.updateState.call(t,e),this._synNodeVisibleState()}},subDataByItemStepNumload:function(e){var t=void 0;if(e&&KD.isArray(e.children)&&e.children.length>this.ItemStepNum){t=e.children.splice(0,this.ItemStepNum);var i=KD.getValue(e,"id","0");return this.exceptData[i]?this.exceptData[i]=this.exceptData[i].concat(e.children):this.exceptData[i]=e.children,this.changedMoreVisible(!0),t}return t},expandTree:function(){var e=this;e.expandAllTree=!0,e.component.data(this.getKendoCType()).expand(".k-item")},getNodeItemByNodeId:function(e){var t=this,i=null;return t.lastNodeTreeItem.nodeid==e?t.lastNodeTreeItem.nodeItem:(this.nodeDataSource&&this.nodeDataSource.get&&(i=t.nodeDataSource.get(e)),i||this.nodeDataSource&&this.nodeDataSource.fetch&&this.nodeDataSource.fetch(function(){i=t.nodeDataSource.get(e)}),t.resetLastNodeTreeItem({nodeid:e,nodeItem:i}),i)},resetLastNodeTreeItem:function(e){return KD.isObject(e)?void(this.lastNodeTreeItem=e):void(this.lastNodeTreeItem={})},getNodeByNodeId:function(e){var t=null,i=this.getNodeItemByNodeId(e);return i&&(t=this.component.data(this.getKendoCType()).findByUid(i.uid),0==t.length&&(t=null)),t},getNodeDataByNodeId:function(e,t){var i=null,a=t||this.treeData;if(a.id==e)i=a;else{var n=a.children||[];0==n.length&&KD.isArray(a)&&a.length>0&&(n=a);for(var o=0;o<n.length&&(i=this.getNodeDataByNodeId(e,n[o]),null==i);o++);}return i},findTreeNode:function(e,t){if(KD.isEmpty(e)||KD.IsNullOrWhiteSpace(t))return null;for(var i=0;i<e.length;i++){var a=e[i];if(a.id==t)return a;var n=this.findTreeNode(a.children,t);if(null!=n)return n}return null},setMultNodeLastCollapse:function(e){if(this.MultNodeLastCollapse=e?!0:!1,0!=this.MultNodeLastCollapse){var t=this.el.find('span[ishasChild="true"]').closest(".k-item").closest(".k-group").closest(".k-item"),i=this.component.data(this.getKendoCType());if(t.length>0&&i)for(var a=0;a<t.length;a++){var n=i.findByUid($(t[a]).data("uid"));i.expand(n)}}},setIsNotChildNodeDisabled:function(e){this.IsNotChildNodeDisabled=e?!0:!1},expandNode:function(e){e=this.convertToJqID(e);var t=this.getNodeByNodeId(e),i=this.component.data(this.getKendoCType());return i.expand(t),i.expandTo(e),t},setNodeStyle:function(e,t){var i=this;i.convertToJqID(e),nodeitem=i.getNodeByNodeId(e),nodeitem&&nodeitem.children(":not(.k-group)").find('[datarole="container"]').addClass(t),i._synNodeVisibleState()},setNodeText:function(e,t){var i=this;this.convertToJqID(e);var a=i.getNodeByNodeId(e);if(a){var n=KD.htmlUtil.encode(t)||"",o=a.children("div"),r=o.children(".k-in"),s=r.children(".kd-treenode-text").css("margin");i.component.data(i.getKendoCType()).text(a,n),r.children(".kd-treenode-text").css("margin",s)}this._synNodeVisibleState()},setNodeIcon:function(e,t){if(!KD.isEmpty(t)){var i=this.getNodeByNodeId(e),a=this.getNodeItemByNodeId(e);a&&(KD.isBase64Str(t)?a.imageUrl="data:image/png;base64,"+t:a.imageUrl=KD.getUrlRoot()+"/"+t),i&&i.find(">div:first-child img").attr("src",a.imageUrl),this._synNodeVisibleState()}},changeNode:function(e,t){var i=this.nodeDataSource.get(e),a=this.nodeDataSource.get(t);if(i&&a){var n=i.index<=a.index,o=this.component.data(this.getKendoCType()).findByUid(i.uid),r=this.component.data(this.getKendoCType()).findByUid(a.uid),s=a.index;a.index=i.index,i.index=s,n?this.component.data(this.getKendoCType()).insertBefore(r,o):this.component.data(this.getKendoCType()).insertAfter(r,o),this.component.data(this.getKendoCType()).select(r),this.nodeClick.call(this,e),this._synNodeVisibleState()}},writeLog:function(e){console.log},setNodeVisible:function(e){if(!KD.isEmpty(e)&&!KD.isEmpty(e.id)){this.isNeedSynVisibleState=!0;var t=this;t.expandTree();for(var i=[],a=0,n=e.id.length;n>a;a++){for(var o=a+1;n>o;o++)e.id[a]===e.id[o]&&(o=++a);i.push(e.id[a])}for(var r=0;r<i.length;r++)if("0"!==i[r]){var s=t.getNodeItemByNodeId(i[r]);s&&(s.visible=e.visible);var l=t.getNodeByNodeId(i[r]);if(l){var d=l.find(">div:first-child .k-in input");d.attr({nodevisible:e.visible})}}this._synNodeVisibleState()}},doLayout:function(){KDTreeProxy.superclass.doLayout.call(this),"none"==this.el.find(".kd-treeview-morebutton").css("display")?this.component&&this.component.css("height","inherit"):this.component&&this.component.css("height",this.el.height()-20)},setNodesChecked:function(e){if(!KD.isEmpty(e)){for(var t=this,i=e.split(","),a={},n=0;n<i.length;n++){var o=i[n],r=t.el.find('input[treeid="'+o+'"]').parents(".k-item").eq(0).data("uid"),s=t.component.data(this.getKendoCType()).findByUid(r);if(s&&s.length>0){t.component.data(t.getKendoCType()).select(s);var l=t.getNodeItemByNodeId(o);if(l&&l.cls&&"parentnode"==l.cls&&(!s||!s.children||s.children().length<2)){var d=this.isMutli?!0:!1;t.loadSubTreeData(o,d,!1)}if(KD.isEmpty(a)&&(a={nodeid:o,nodedom:s}),!this.isMutli)break;var c=jQuery.Event();s.attr({isfromserverchecked:"true"}),s.find('input[type="checkbox"].k-checkbox')[getPropName()]("checked",!0).trigger("change",c),s.removeAttr("isfromserverchecked")}}KD.isEmpty(a)||(t._synMultiSelectedModelNodeAppearance(a.nodedom),t.nodeClick(a.nodeid))}},setExpandedTrigerNodeClick:function(e){void 0!=e&&(this.ExpandedTrigerNodeClick=e)},setExpandedTrigerNodeSelect:function(e){void 0!=e&&(this.ExpandedTrigerNodeSelect=e)},setAfterDeleteSelectOther:function(e){void 0!=e&&(this.AfterDeleteSelectOther=e)},_getRootNodeId:function(){var e=this.RootNode&&this.RootNode.id?this.RootNode.id:this.rootCfg.id;return e},_isParent:function(e){var t=e||{},i=!1;return i="parentnode"==t.cls||"rootnode"==t.cls||"topnode"==t.cls||!KD.isEmpty(t.children)},_isHasChild:function(e){var t=e||{},i=!1;return i=("parentnode"==t.cls||"rootnode"==t.cls||"topnode"==t.cls)&&KD.isEmpty(t.children)},_synNodeVisibleState:function(){if(this.isNeedSynVisibleState)for(var e=this.component.find("li.k-item"),t=0;t<e.length;t++){var i=$(e[t]),a=i.find(">div:first-child .k-in input");"false"==a.attr("nodevisible")?i.hide():i.show()}}}),KDControlFactoryProxy.registerType("kdtree",KDTreeProxy),define("KDTreeProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDTreeProxy}}(this)),KDFloatTreeProxy=KD.extend(KDTreeProxy,{createInnerDom:function(){return $("<div tree='floatTree_Div'><div tree='floatTree_All' class='kd-treeview'></div></div>")},initCellComponent:function(e){var t=this.isKendo(),i=this.getConfig(),a=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(i);this.InlineStyle=$.extend(this.InlineStyle||{},a);var n=$.isFunction(this.getKendoOptions)&&this.getKendoOptions()||{};n.style=(n.style?n.style:"")+";"+KD.stringify(this.InlineStyle).replace(/{|}|"+/g,"").replace(/,/g,";");var o=this.createInnerDom();o.appendTo(document.body),this.component=$('div[tree="floatTree_All"]',o)[t](n),this.treeDiv=o,this.initTreeTitle(),this.initToolbar(),n.style&&this.component.css(n.style),n.tagClass&&this.component.addClass(n.tagClass),n.id&&this.component.attr("id",n.id),KDFlowlayoutProxy.getCtOrientation(i)&&this.el.css(a),this.setVisible(KD.getValue(this.config,"visible",!0)),this.component&&this.setDisabled(KD.getValue(this.config,"disabled",!1)),this.rendered=!0,this.setStylekey(KD.getValue(this.config,"Stylekey","")),this.setToolTip(this.config.tooltip||this.config.description||"")},initToolbar:function(){this.toolbarHeight=26;var e=this.config;if(e.tbar=e.treeTbar,e.treeTbar){e.treeTbar.actionKey="FloatTreeBarItemClick",e.treeTbar.id=this.key,e.treeTbar.dock=KD.dock.Top,e.treeTbar.height=this.toolbarHeight,this.tbarPxy=new KDKendoToolbarProxy,this.tbarPxy.setControlFactoryProxy(this.getControlFactoryProxy()),this.tbarPxy.baseId=this.baseId+"-FloatTreeBar",this.tbarPxy.createControl(e.treeTbar);var t=$("<div tree='floatTree_Bar'></div>");this.treeDiv.append(t),t.width(this.el.width()),t.append(this.tbarPxy.getControl()),this.tbarPxy.loadConfig(e.treeTbar),this.tbarPxy.initComponent(),t.hide()}},setBarItemStates:function(e){this.tbarPxy&&this.tbarPxy.setBarItemStates&&this.tbarPxy.setBarItemStates.call(this.tbarPxy,e)},initTreeTitle:function(){var e=this,t=$('<span class="k-widget k-combobox k-header" style="width:100%"><span class="k-dropdown-wrap k-state-default"><input class="k-input" value="请选择..." disabled="disabled" type="text" style="width: 100%;"><span tabindex="-1" unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s" >select</span></span></span></span>');t.click(function(i){e.component.width(e.el.width()),void 0==e.treePopup&&(e.treePopup=e.treeDiv.kendoPopup({anchor:t}).data("kendoPopup")),e.treePopup.visible()?(e.treePopup.close(),$("div[tree='floatTree_Bar']",e.treeDiv).hide()):(e.treePopup.open(),$("div[tree='floatTree_Bar']",e.treeDiv).show())}),this.el.append(t),this.treeTitle=t},nodeClick:function(e){var t=this.getNodeItemByNodeId(e);$(".k-input",this.treeTitle).val(t.text),KDFloatTreeProxy.superclass.nodeClick.call(this,e)},release:function(){this.tbarPxy&&this.tbarPxy.release(),this.treePopup&&this.treePopup.destroy(),this.treeTitle.remove(),KDFloatTreeProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdfloattree",KDFloatTreeProxy),define("KDFloatTreeProxy",["KDTreeProxy","KD"],function(e){return function(){var t;return t||e.KDFloatTreeProxy}}(this)),KDTreeProxy_NLP_Search=KD.extend(KDTreeProxy,{createControl:function(e){var t=this;KDTreeProxy_NLP_Search.superclass.createControl.call(t,e),t.el=t.el.KDPanel(),t.el.css({border:"0px solid"});var i=".kd-nlp-search-result-row";t.el.undelegate(i,"click").delegate(i,"click",function(e){t.onRowClick.call(t,e)})},release:function(){var e=this;try{var t=".kd-nlp-search-result-row";e.el.undelegate(t,"click")}catch(i){}},updateState:function(e){var t=this,i=(e.RootNode||{}).children;KD.isArray(i)&&(t.treeData=i,t.bindDataSource()),KDTreeProxy.superclass.updateState.call(t,e)},bindDataSource:function(){var e=this,t=e.getFormProxy(),i=e.storeData=e.createDataSource(e.treeData),a=!KD.isEmpty(e.treeData)||0===(e.treeData||[]).length;if(a&&(e.el.empty(),!KD.isEmpty(e.treeData)))for(var n in i)var o=i[n],r=e.createRow(o);a&&(t.lockControl.call(t,e),KD.delayInvoke(function(e){t.fireCustomEvents.call(t,e.key,"TreeViewDataSourceChanged","")},void 0,!1,e))},createRow:function(e){var t=this,i=e,a=KD.htmlUtil.encode(i.text),n=KD.htmlUtil.encode(i.subText),o=i.id,r=KD.format('<span>{0}</span><span style="text-align:right;flex-grow:1;color:#5582f3;">{1}</span>',a,n),s=KD.format('<div class="kd-nlp-search-result-row" style="min-height: 21px;" data-id="{0}">{1}</div>',o,r);return rowEl=$(s).appendTo(t.el),rowEl},createNode:function(e,t){var i=/\([0-9]{0,}\)/g,a=KDTreeProxy_NLP_Search.superclass.createNode.call(this,e,t),n=(a.text||"").match(i);return a.text=(a.text||"").replace(i,""),a.subText=(a.subText||(n||[])[0]||"").replace(/[\(\)]/g,""),a},getDateItem:function(e,t){var i=this,a={};t=t||"id";var n=e[t],o=i.storeData||[];for(var r in o){var s=o[r],l=s.id,d=KD.isString(n)?n:KD.stringify(n);if(KD.equalsIgnoreCase(d,l)){a=s;break}}return a},onRowClick:function(e){var t=this,i=$(e.currentTarget),a=i.data(),n=t.getDateItem(a),o="kd-nlp-search-result-row-select";$(KD.format(".{0}",o),t.el).removeClass(o),i.addClass(o),KD.isEmpty(n)||t.nodeClick(n.id)},nodeClick:function(e){var t=this,i={selids:"",curid:e};if(!KD.isEmpty(e)){var a=t.getFormProxy();a.lockControl.call(a,t),a.fireEvent.call(a,"TreeNodeClick",t.key,KD.stringify(i))}},select:function(e){var t=this,i=".kd-nlp-search-result-row",a=void 0;rowEls=$(i,t.el);for(var n=0;n<rowEls.length;n++){var o=rowEls[0],r=$(o).data(),s=KD.isString(r.id)?r.id:KD.stringify(r.id);if(KD.equalsIgnoreCase(s,e)){a=o;break}}void 0!==a&&t.onRowClick({currentTarget:a})},setNodes:function(e){},addNode:function(e){},addNodes:function(e,t){},deleteNode:function(e){},refreshNode:function(e){},clearNodes:function(e){},setIsMutli:function(e){},setMutliSelect:function(e){},setNodeIsMutli:function(e,t){},nodeDoubleClick:function(e){},setCheckBoxCommand:function(e){},expandTree:function(){},expandNode:function(e){},setNodeStyle:function(e,t){},setNodeText:function(e,t){},changeNode:function(e,t){},setNodeVisible:function(e){},setNodesChecked:function(e){},setExpandedTrigerNodeClick:function(e){},setAfterDeleteSelectOther:function(e){},getDebugData:function(){return[{children:[],id:"016498dacc874030944af9a30427068c",text:"应用菜单(1)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"b3e924e08fe04fe28bfd0b5b0751a8d1",text:"币别(3)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"4f6e3ba656bc4ee4b05e7a4cf3cc4fd4",text:"用户(11)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"29c8204811524a21919e8bfb66d1cc4f",text:"组织机构(16)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"8c18e77cb54d48cda09f808164d18970",text:"销售员(11)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"ce82d9c3110b40f9b975d17664c6983c",text:"员工(15)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"3dcd65a72f774248b8da1ec61cdda413",text:"费用报销单(53)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"b924c639f3194cc185f38b85d33d2750",text:"采购订单(23)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null},{children:[],id:"1e964bf01b24472a880ce6857a004448",text:"销售订单(12)",cls:null,xtype:null,parentid:null,icon:null,IsCustomIcon:!1,Forecolor:null,Style:null}]}}),KDControlFactoryProxy.registerType("kdtree_nlp_search",KDTreeProxy_NLP_Search),define("KDTreeProxy_NLP_Search",["KDTreeProxy"],function(e){return function(){var t;return t||e.KDTreeProxy_NLP_Search}}(this)),KDNLPSearchResultPanelProxy=KD.extend(KDControlProxy,{createControl:function(e){var t=this;try{var i=t.genUIID(),a=t.getFormProxy();KDNLPSearchResultPanelProxy.superclass.createControl.call(t,e),t.__helpDetalSummCls=".kd-nlp-search-result-detail-help-summ",t.__pageSize=20,t.__curPageIndex=0,t.groupsPanel=$("<div class='kd-nlp-search-result-groups' >"),t.waittingEl=t.getReqWaittingEl().appendTo(t.groupsPanel),t.hiddenFocus=$(KD.format("<input id='{0}__hiddenFocus' class='kd-nlp-search-result-hiddenFocus'/>",i)).appendTo(t.groupsPanel),t.topGroup=$("<div class='kd-nlp-search-result-top'>").appendTo(t.groupsPanel),t.groupHrGT=$("<hr class='kd-nlp-search-result-hr'>").hide(),t.middleGroup=$("<div class='kd-nlp-search-result-middle'>").appendTo(t.groupsPanel),t.moreLink=$("<div class='kd-nlp-search-result-row kd-nlp-search-help-morelink' data-key='moreLink' data-title='moreLink' data-type='moreLink' data-uiid='moreLink'>").attr({tabindex:"0",hidefocus:"true"}).css({"min-height":40}),t.groupHrGB=$("<hr class='kd-nlp-search-result-hr'>").hide().appendTo(t.groupsPanel),t.bottomGroup=$("<div class='kd-nlp-search-result-bottom'>").appendTo(t.groupsPanel),t.groupsPanel.appendTo(t.el),t.detailPanel=$("<div class='kd-nlp-search-result-detail' >"),t.topDetail=$("<div class='kd-nlp-search-result-top'>").appendTo(t.detailPanel),t.middleDetail=$("<div class='kd-nlp-search-result-middle' style='flex-grow:1;'>").appendTo(t.detailPanel),t.detailHrGB=$("<hr class='kd-nlp-search-detail-hr'>").hide().appendTo(t.detailPanel),t.bottomDetail=$("<div class='kd-nlp-search-result-bottom' style='min-height:5.5em;'>").appendTo(t.detailPanel),t.detailPanel.appendTo(t.el),t.el.attr({tabindex:"0",hidefocus:"true"}).addClass("kd-nlp-search-result-panel");var n=".kd-nlp-search-result-row",o=".kd-nlp-search-airec-detail-desc span",r=".kd-nlp-search-result-detail-action";t.el.undelegate(n,"click").delegate(n,"click",function(e){t.beginSingleClicking.call(t)&&t.onGroupItemClick.call(t,e)}).undelegate(n,"mouseenter").delegate(n,"mouseenter",function(e){t.onGroupItemMouseEnter.call(t,e)}).undelegate(n,"mouseout").delegate(n,"mouseout",function(e){t.onGroupItemMouseOut.call(t,e)}).undelegate(o,"click").delegate(o,"click",function(e){t.beginSingleClicking.call(t)&&t.onGroupItemClick.call(t,e)}).undelegate(r,"click").delegate(r,"click",function(e){t.beginSingleClicking.call(t)&&(t.hiddenFocus.focus(),t.onGroupItemClick.call(t,e))}),t.middleGroup.scroll(function(){t.moreLink.parent().length>0&&t.checkNeedMore(t.middleGroup,t.moreLink,function(e){e&&t.renderFastResult_page.call(t,!0)})}),t.el.keydown(function(e){var t=e.keyCode||e.which||e.charCode;(13==t||38==t||40==t)&&e.preventDefault()}),a&&a.el&&a.el.keydown&&a.el.keydown(function(e){t.onKeyOperHandler.call(t,e)})}catch(s){KD.writeLog(s.message,(s.stack||"").substr(0,200),!0)}return t.el},release:function(){var e=this;try{var t=".kd-nlp-search-result-row",i=".kd-nlp-search-airec-detail-desc span",a=".kd-nlp-search-result-detail-action";e.el.undelegate(t,"click").undelegate(t,"mouseenter").undelegate(t,"mouseout").undelegate(i,"click").undelegate(a,"click"),e.releaseFastResult(),e.releaseAiRec(),e.releaseSummaryPanel()}catch(n){KD.writeLog(n.message,(n.stack||"").substr(0,200),!0)}},genUIID:function(e){var t=(e||{}).uiid;return KD.isEmpty(t)&&(t=(e||{}).uiid=KD.format("U{0}",KD.Guid.NewGuid().ToString().replace(/\-/g,""))),t},getReqWaittingEl:function(){var e=$(KD.format('<img src="Content/themes/images/cloud_loading_galaxy.gif?ver={0}" class="kd-nlp-search-img-loading">',KD.getVersion()));return e},getDateItem:function(e,t){var i=this;if(e){var a={},n=(e.type||"").split(".")[0]||"";t=t||"uiid";var o=(i.resultValue||{})[n]||{},r=e[t],s=o.data||[];for(var l in s)if(KD.isRunInForIn(l,s)){var d=s[l],c=d.uiid,h=KD.isString(r)?r:KD.stringify(r);if(KD.equalsIgnoreCase(h,c)){a=d;break}}return a}},getSummaryAction:function(e,t){var i=void 0,a=((e||{}).summary||{}).action||[];for(var n in a)if(KD.isRunInForIn(n,a)){var o=a[n],r=t.uiid,s=o.uiid;if(KD.equalsIgnoreCase(r,s)){i=o;break}}return i},beginSingleClicking:function(){var e=this,t=!e.isSingleClicking;return t&&(e.isSingleClicking=!0,KD.delayInvoke(function(e){e.isSingleClicking=!1},1300,!0,e)),t},findNextOpeRow:function(e){var t=this,i=void 0,a=".kd-nlp-search-result-row.kd-nlp-search-result-row-select",n=".kd-nlp-search-result-row",o=$(a,t.groupsPanel);if(void 0===e)i=$(a,t.groupsPanel);else if(i=o[e?"prev":"next"](n),0==i.length){var r=o.data()||{};"searchCondition"!=r.type||e?"aiRec"==r.type&&e?(i=$(n,t.middleGroup).last(),0==i.length&&(i=$(n,t.groupsPanel).first())):"fastResult"==r.type&&(i=$(n,t.groupsPanel)[e?"first":"last"]()):(i=$(n,t.middleGroup).first(),0==i.length&&(i=$(n,t.groupsPanel).last()))}return i},onKeyOperHandler:function(e){var t=this,i=e.keyCode||e.which||e.charCode;switch(i){case 13:e.preventDefault(),selEl=t.findNextOpeRow(),selEl.length>0&&t.onGroupItemClick.call(t,{currentTarget:selEl[0]});break;case 40:case 38:e.preventDefault(),selEl=t.findNextOpeRow(38==i),selEl.length>0&&(selEl.hasClass("kd-nlp-search-help-morelink")?t.renderFastResult_page.call(t,!0):(t.scrollTo(selEl),t.onGroupItemMouseEnter.call(t,{currentTarget:selEl[0]})))}KD.isDebug()&&KD.writeLog("kd-nlp-search-result",i,!0)},onGroupItemClick:function(e){var t=this,i=$(e.currentTarget).data(),a=(i.type||"").indexOf("summary")>0,n=a?"rowuiid":"uiid",o=t.getDateItem(i,n),r=(o||{}).typeId,s=a?t.getSummaryAction(o,i):o.action;
KD.isEmpty(o)||KD.isEmpty(s)||(KD.equalsIgnoreCase("help",r)?(s.title=s.title||o.title,t.onHelpItemClick(s)):t.onItemClick(s))},onGroupItemMouseEnter:function(e){var t=this;$(".kd-nlp-search-result-row-select",t.el).removeClass("kd-nlp-search-result-row-select");var i=$(e.currentTarget).addClass("kd-nlp-search-result-row-select").data(),a=t.getDateItem(i);KD.isEmpty(a)||t.renderSummaryPanel(i,a)},onGroupItemMouseOut:function(e){},loadConfig:function(e){var t=this;KDNLPSearchResultPanelProxy.superclass.loadConfig.call(t,e),t.resultValue=t.getDefaultResultValue()},getFastResult:function(){var e=this;return(e.resultValue||{}).fastResult||{}},getAiRec:function(){var e=this;return(e.resultValue||{}).aiRec||{}},getSearchCondition:function(){var e=this;return(e.resultValue||{}).searchCondition||{}},getReqDataArgs:function(){var e=this,t=((((e.getSearchCondition()||{}).data||[])[0]||{}).action||{}).args||{},i=t.text||"",a=t.type||"",n={type:a,text:i};return n},getDefaultResultValue:function(){return{searchCondition:{ts:"0",data:[{}]},fastResult:{ts:"0",data:[{}]},aiRec:{ts:"0",data:[{}]},debug:!1}},getDefaultConditionValue:function(){return{ts:"0",data:[{img:"data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZmlsbDpjdXJyZW50Q29sb3I7b3ZlcmZsb3c6aGlkZGVuOyIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik02NzkuNjUxMjgxIDcyMy44NDU0NTZDNjE0LjMxNzQ1OSA3NzkuMTUxMzQ3IDUyOS44MDMyMjggODEyLjUgNDM3LjUgODEyLjVDMjMwLjM5MzIxOSA4MTIuNSA2Mi41IDY0NC42MDY3ODEgNjIuNSA0MzcuNUM2Mi41IDIzMC4zOTMyMTkgMjMwLjM5MzIxOSA2Mi41IDQzNy41IDYyLjVDNjQ0LjYwNjc4MSA2Mi41IDgxMi41IDIzMC4zOTMyMTkgODEyLjUgNDM3LjVDODEyLjUgNTI5LjgwMzIyOCA3NzkuMTUxMzQ3IDYxNC4zMTc0NTkgNzIzLjg0NTQ1NiA2NzkuNjUxMjgxTDkyOC4zNDcwOTQgODg0LjE1MjkwNkM5NDAuNTUwOTc4IDg5Ni4zNTY3OTEgOTQwLjU1MDk3OCA5MTYuMTQzMjA5IDkyOC4zNDcwOTQgOTI4LjM0NzA5NEM5MTYuMTQzMjA5IDk0MC41NTA5NzggODk2LjM1Njc5MSA5NDAuNTUwOTc4IDg4NC4xNTI5MDYgOTI4LjM0NzA5NEw2NzkuNjUxMjgxIDcyMy44NDU0NTZMNjc5LjY1MTI4MSA3MjMuODQ1NDU2ek00MzcuNSA3NTBDNjEwLjA4ODk4NCA3NTAgNzUwIDYxMC4wODg5ODQgNzUwIDQzNy41Qzc1MCAyNjQuOTExMDE2IDYxMC4wODg5ODQgMTI1IDQzNy41IDEyNUMyNjQuOTExMDE2IDEyNSAxMjUgMjY0LjkxMTAxNiAxMjUgNDM3LjVDMTI1IDYxMC4wODg5ODQgMjY0LjkxMTAxNiA3NTAgNDM3LjUgNzUweiIgc3R5bGU9ImZpbGw6IHJnYig0NCwgNDQsIDQ0KTsiPjwvcGF0aD48L3N2Zz4NCg==",title:"搜索数据",nluText:"01",typeName:"人员",action:{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168909"]}}}]}},getDefaultImgStr:function(e){var t=KD.format('<img class="{0}" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAVwklEQVR42tVd3Ytd13X//bbOjD4niWMR28INBZPgECeB2o4KfQy0D6YWiaDgon4EN68BQ59r8tYX98FtQ6EmIsT9wNC6UlDe+g+0uIaQOIYgKFQRVlJbrkeakTSau/pwzzl7fe0zM74zd6ILQjN3zj4fa6+99lq/31rrEBOfs69uPL69tX2OIs+BeEKAMxSeEggAgOB47PDd8L1AzP+AABx+mn9H2usNv7L/AwnIfFj9e38qEOYcIlLHYfi7O//wh+FYdYyY66v7GG5AnR/Q1xpuaLzvWySvE7gK8soxrFz612/xWkvGzL78nb++febevdl3AHxTZnJkeNgqeChxwwheT4aSVXrzU8d4AVBdVE9cOAYTx3nFcZMUrt/fHZ2mmPO6yR1vZ1A4chuQi105+vLlF3l9xwl45pXbzxeZvT6DrEWBao2O39uJyDV+UCgv+PkxbgW4O/UCERE3cYkGzw80kxhWXvid4TiqGzLndZPrV/Awn6VwXXjkwpUXu8v6WkX/8uwr69+GzN6cQdYGAWcCz74ffqbRIPs3cQ9VSPdQDMK0AppPmfQPXshqStQ/8+lNByH9z1bQ1byxTqYIQFErVgl/FHx/3lHYtL+rWyYJEVnjbPvN3//evW+nK+CZV24/T5E3BbPS0mpt11N7ps1Ba8lqZaG2oYOGDvaZZiL7h7CmDHUp+Wv0Iq+mIL1fKwh9jXCfZkOS8ZqjXMjEnCpTxkHjOQPL1y/3K4Gjzb+7/a4Aa9kGmgncaH8QfLZxDcu4saEFM9ELo7AudTWD9oFZNXX4ub/vQo7rVpvB4q6vBa/lnJsXdf/Do6aKItEMzo9Zx4mVJy+/wOsFAOYbLteqOUEQfjUxtGZILUG9eVKsLddehzYpZglDa3OdmHFp9wIinLYhWRm9iRqOKVRP0Li+N5Mcb6iaK+rNIByrz6kUSz1ff841bm59BwB49tWNx2db2/8tIke0e5eZn9Tc+A1SLTe9qWqtgNs4mbmK+kHUMq8rxa8MZcuZuJVi7TiHlZGsRqKh9c7ceHM2OhjOf9ab//B1KWW7rHS/2W1vbZ+DyJFBcINma8Fbk4TcvNCKUh+XaZoXDI1Hbk2M0Wa1pLVgtERErRoJnsowQcM4uxFr1ab29JTfbxRLmbbxEirOmD8/1arox81mR+T+1rlCkee8Z5P782Km2mqN8r29G2miJ8m13gm+uA3M29i60WpvZ7QWKKUoc+SDpXYgKP0BDA6AfT4AYZWLVC+LheluqS0HSWDG5zoQT1BoXMzo8zt/m8M8SLXHRiBVO+tmxxD0iEi6ZDNfPAqfTUEGOxziCxsTBA8HcyUQ8c+sPCA3qeb59KMk9y+jWzt7ohA8E/14rfHeZ+t1UerGJEY4SXAvkth5tRzVw4eHMEFNr2Vg9OOzzRBuQ9crFlb44//wbqbbkJ2TQHPfkgd1/QlEe40AyHKmm4mcslhO5j7VpSjCgJVwtMmDHJ1Wjh7QsNKY7gtWm6kErjSMUn1/Zz/ICDOMmyZDnB4mtx7HYCLrecU+t1HzIZgUt1dpS2zOfaobfW7v8+vNq8oiAlUBPBNzUxpqMCYt8YissyLG3HinOwR3ztYjM1HKZy/9PfXLF/Thq5lI5jY8YFv6+lLjCL85j/uKoDPeAyTHYVLBizI/wybEBiIpIViimySRevzgQTHcQBWUjWIHxcltvvEFBlhijFBlFIaJdmgNstF6vTGNBl2C64zi5cfgvheN5dBpn91koEwN7cOrmTbeiWTRowSQLQXQRnc4LvkYQ0iKIdVtrBf5AHUEgSF1k+GuP9hxvyC120yHQ+0kvy761SoqdRvzaMfF21Wl5W61iA6WEqR00EiRuGG2gLMRVFOrRCSOo9osKBqTyVf61PXtPqhMI7Er+QlskDuYxs4ghg5PR4qnC0phIARokEyx50HvG0umwWLdwXGcmF0h7hnios3cHY12WiYQ10QAOqgLiK5zKNjgSgiUZNUBQGfx9WgOCJhoUtLJUXuIw4XKsPyNb6zOq5wAu6krOyz5PmJNlI6qGwRL4uF45Qp8hFaccc/QfIC9vqRRvwti1bU7H8h490uU7RbJoly70HwUaSZY4+mEQiotcIbgAFjtGZZwIcM+Ex9EC0hsYIUcm/IBfADaBjyqnxwmIXIISpWy6fN3Fo+pXg2NG5mdGO0LaTy9QrAWkJPep3agsgfkAgulbbsQIXLzsDJoz2niRGfmMr6aHpAbgioZ450Kwrn9AR5Gd3zIwIiN2AU1Th5tp78hE5EqW8+w6Vb60OwJIRBTEIQ2Dyq+YMZm+fGQEPWKCaqAUjgyZRp7KoHepGLBqlyKun5R2E8hk4lD2BkG+XVUJxxtKqJgxgBocCkaeLpesp8+AZz/SofPf6bgk8fYzgKIUVj4fHRH8PNfCf7tJ/fx4aabiP7+Tp8UvHh2BV8+U/DpE8Qinw82BD95T/D9/7iP9zez1Wk9JyM/NuQHLb9eoX77r9bFornMyWjJsgzgzIeMG+hDxwV/8XtHcWKVO8kW0zNj5+b2PcFf/vsW/u9OjWRJ4PRJ4rvnV7F2bDHB+8/6XcFLl+7j/dueOfN8iHUw0iSBJAOkjAzTSCojoJ8MeA0N1FsJ8Top57+ygpOrnJYv1b8d5mT4+eQqce5LXUVi+/t+8Wy378IHgLWjxB8/c8SR73C5RUp+Dgj0Hlmh5QZKjdAqakmW6qPTYRxEk/nS2QGf/0zJBc/dafzUxH3utH1YAPjymYKD+jz1aITJ4ZLFqvlxHhUde+ho084KkjmeH1grBgrOUo7EpzJt3IXwd2GR8MljrHxEPxGL2vypz3DuwA2YRITKaRvuYMCeqCZPJwdgAk/PZsy6hk74I0EjbYnKtMD3IkY20k0O4kMqbCjz/hryG3E+FVBq+XUZAUIfbpswm2kOp8fT96raskfhp8HXQU4AKscbSB7j484V0FoTBD5iuP/Ozpq2VbS5NEj4ALjobgxMZXe25GNovSX08yj2wD4+38fnoDrPKEsYoFOezpPmme8qGt8PGV+iiBgVP3P/hQ4fIDNmuB2sCeLI+AW6diTl2c4SSTLmCjGFZ1s6jgmejgRPJw5I+EjikaXtAuKwqYjxV1MjeRxAOLxMFB+gtL84XpYK0B7TOpoBhzRNwsJaz2iTlyX+4dkZUN/IhxQt8ZFF095PlV9n8fzd4emlgafrjWpftT4zM8uTvEJrRWWAiOUDJuUHg8iWlA8QlYXmwmoxSU0RtqXCQQLkuoCfwt0Ga1yOCbLUaNw3JUAPVFGukp8STDdimnTmxqV1zPmSbJNJSIwlKSuXvApiOiSn8TJYgkY8bUv2fMAEnk8w2DCNp0c8X0z+5KK2/tflY9NJPIeAMRvc8+VGfhJ59BLIjgaeHpZ9ofGJiQV8cpO+t4couDeRZSkzJs0oXF9/zg3U3Crmw8f77zRKJyovEp7FMZuJuCWJPDDZpfC5Jzs1TLoEl/DAV4DEew3yEySpLg35QVAGYrmlgTa9wubkZ3k+3O0MEO1yy11o4mCDZUlQhM6qM7A0rPyg4ylX0FFNfPUaO1svm+T7i4x1Vj7wsVxxD26LpG5o09bvUfMNd0smdvVgN3z6ak2HiEbZaPnF0qYSNJjaoxGbjSSSeiCjE9abpFK4A4az143WEtyyyEa/H6Ccgw4n5acfOoFPCk2paISfi8pqmBPZDp6Arp+qAN1Hd6a1aPcQXSywXr+DkGJ+c+PgTNHNzUi0jGBgS34OmhnSaDxTVkw1oCSZyOOEuOBP5/eHlHPBz/93ls743m29x3wEVz9w+5DMCfSD+vzshuSApavqNPdpqvcljUorJakEWisCaRcZYf4O+MpJBeiR+OE729jY+rjmpnrQ4kzkxhbwo3dmZmmTwA/e2sb63f2fhFt3Bf/0dlU2DVq6ykeDGOuqT8BvzIpf/9rfbkiW3299fBo4wtfP5vn9wKeOA88/dQSfO13wiWN7s/Ue7fzoruDq+4IfvTPDh3fy6z98Avijpwu++Ajx0IIU5c1Nwc9uCP75beCDO9E0530ovLncWX782nf7CUirHqP/mlU5Gp5aeVQ6mzkr2dTnHuvFWo003EUz/jqm1MSEXo61X9ExMMftQKRkstG8eV6qFDvHFF9ozeTBrfDVMSIxv19XmRmSQlwhtvWgaJPow+YtmmViRiD5/xGEDyTCVxh/6DXh8/sJN/mRB8niKF9/ppHlLlY2OooNEjqFVDyboXeCZ9VkAu7W+4xkGXmmDMrzsrEjCSdy/7NjW3i+zraDxOcwfEhSH1Ba8gv1FVR8AOmKpTEWTsDl7hef3+82F3+7zfx+5z0Ru8PTmRX4MraRQYJcznEs1FRyV+FvDIxOoi1DsUl+fd0pRUMNkU+pmeAisKR8zO8nSrF8ryjmX8SuCk+Snz4J/OmzHZ56bPFczZsbgp/eEPzgrRlubtrnG+735Irg7GeJxz5RcGI1yeempxQDAzI+9+YW8N468J//A2xsSTDBo6DFdu1yvr2tr4CulOkt+O/+3aYwbG4SzE228aZ/7/9/+ATw6jdWsHaU++4W/vkPt/HBpi13OrUKnP8SsdpNcxDk7liK4a93t4FLP+0nAfkmuyf5wToshd4GGpMB49uz1act2ay++dVu34UPAKeOEhee1uWHc1X66meBoy3hEy5nyXsyEmLv4ZejHfDsb1QTTaIB0TsPJ9mctZc4mKDiN0OOiUV+45I0B3TkBmCTeJ967OCQmi8+wjHJdcj1f2yttfHSVX4iwXIm3G8Aj64hAIxZfUIGN+ucKr0zDBPZ6ZkSydgf30ImQ/0iDnKQuZo1yKqe08nVFouV5dwxRZz83AzPdGIl88wk8gES+RRRHILL2ZoXjNsOJhJqv1L4VS8pOQyC3DbsyNkypGbGcB8TBFGL2xYVcMW+QjpbGr7Yctx49UbcmfyaUOWSwA3kLgo2Dp4k0bVYut44mhhJMKYGK7cjJ2zb31ARGmPlpmqbE/LX3GqY1wlP9M6MDsNErwatGVzWCtA+u9iGTo10Xzagp8nkYLqoOvNsHB1rGi/S/l0BCPNI2PbtdF5QEnaDCX6zZHZEa5T1cMQZGE4LnxPVO2KjWbYIDVU2JxIr6jNeBrp5oPgePCG7OcmOEIf0Jcctg6ONSKSzyy3hI+m6lUXXasYFuhuMFTR04xILk9W7EkOn1NREDTLNo12f/0Mb8bokLttAiTtzwvtKD2ZAOJNEgYYZaiwtg7Y6NFYLHU7zzfXEZvvrrjB1D0jw/LEIGrarlKT58bEHzjI+hXQN9XaRx7gTOeRyorLp0kykeNPCCAOZyUjGd4RuysfQz4eqKQZHrWeS8QtVGS/LUH8wqd5nY8flTviESICa00NUmW+YLolN/UxPkWR8QdY2zIfoellmWuT6BS3vI9O1ZbIbk4MEjZVc62HtvddoqBhgwCbFeT5+fLcTni5OgzKX1TTpXlK2WvX9GbCcrHx2agVFR5Q7LhYfsIrAEk6SMqxhfGf86gae7ruaV1Np8fTlZytDOdto9+tp2noJG3j2Fz3E2H+J6KYRn8C26knGd0aHJfYHLcqiG6/HFCe3GnwccByACIZNB1Q6ldKLOh+vdM3WqzOaGCSb8mh2GuM7HUa3NjTPret+PRLiliUWDSVQOKaCKldM3mrBI4lzKxb9th11XcDlV0BYMWp8oZoi3XzUQw3FdC6PTZl8dLrUaCwtDHftgzVlGFIdEVAkNqAPj+dD/2xaLCdBY5MPKIxJQw7rFoOUepas9oVgWY74C6sqFLa7S9TI3oqZyLu4MJmMKTxfgLQvqT5uanzJyktD8tC4CTNUB8aqcTnwXM0PN2MByeZWXBXR3NDktQpiBmr23eZWnspiX/TgitnFejyt8SUwPcqdoO6/rEr0AyPkYgYCeOfGwU3Au7/UnPT8u/fWW3h+5GOl8TuQFxbeuNXG80Us9k8XmO3EBxTP+eoS+7TzuOkppMfSmKt/fFtw64ByNd/4sfWUSeCtXxBb25luR76XDaFnq+DeNvBf13wXd4UFQefMOiAugUD8eH794j0JL1Jg5jGowcjeB2NXgAB4+Djwh79FfOER4qHjXNjsvPtL4I0fY0xL8YzjyRXg6ceJR9eA4yu5XWcyPUyQn40t4MY68NYvgM37DTxfazYSPgDOC0rG8xsX74luBQn31qGpXEvb/x+hiVEriddHz/FFOQ23OH2BW/u9XwKTuBd+lgSn10GVe2nSgYwvo/Czike9rwVsSMPPrj+yd73gXj2iPZnQLlg3anWp88nGXxkqi9WnWp7g8Yvi+fvDB2iCJb4Ow/VpTtLtmL0/i7avQoanO0Bd52TmfaNrkqvoSUkKJnaLxy+K5+8DHyDx5ZlugyKjFc2y4XyNsSB2T6lU3VSVvcvbUUCKbqU2vAVJ9+rcKx6/KJ6/OB9AFyq7Pgfeq0jfMEGVuNp8UaYqXaA4jY58hJ1Qsb2J4HoauVB/L3j8onj+4nyA6V3gMsnEvZQg7ZIYzZHvm2VXlu6lLLZ/JiLvbDd/xg68C+Lxhz2+C822JZqkSNRAJSdVg5O/DGEiv58R6AsEkFI1/6rC/cDjD3t8p2scY/9/nd+PaJOz/P5Ggn3qjrpgptln2fmgYwS8D3j8YY/vLMEtxhWMeaCuf39WsCCN9/lih/qppL4gxANJQLMoHn/Y4zvftDXLZ7XdEGvOe5ko6qsT0n57RXwTkyDr4j2Fpy+Kxx/2+EKWWwHPZyRWinqrRTv3p2prSTqGxNIe0X2TTTBYSiOo22c8/jDHQ3CrUGbXff//6NsP2XMqCCsMPfKZ0pOIqdlo9/sJ9CIPFo8/1PEF1wsKrxrGJ3SGbb/Pt1YU5mamqPz4ojKwyVie2qw/3gFPXxSPP8zxM8HVAuGV/H2+sbs8HdoUcvCT7GhjegjVoR19AYO0kth2hacviscf8vgr5cjxcgmF25YzFccP9MVkjAUbpO+W4l5sDJv4pN/zazutfDw8fVE8/hDHb4O4VP7hPK8RuLjj+3xNF11Js+PGJkTFJ7a69/mKy0ST6oXqifAaJE6b8GCPv/jaeV4rAHCM5eWCsp4zYM6U0E0ErAYjRNM0mQkatRREGlFjUoKd8+sfyPHE+rFVvAz0WRHfe4HXUXiBgll8KTEbiGTGC0+9zzduQr8OePyyxwOYFeLC35zj9XECAOD1F3iZpbxUyFmw34oRMx220twZGo5YmxsPWE3l14eqfz744wsxA/HS35/n5TyJBsCfvCHPy0xeF5E1BDy/VSMWq8T9S9UMHo5d4OmYwNMfxPHAOokLWvhmBQyf7/8BL3fH+WQp5bVSyjbdmXTVN0MKiNgAq9BAsIYncBuZXraE3VMe8PHbELx2bAVPeuEDO2QR/tm/yONb93GuEM/NZniiFJwRkVNpTmZSPZhBsEF73HcZyvEgjS/ELQGuC3CVwBUQl147z2stGf8/HPSa5G+3lD4AAAAASUVORK5CYII=" alt=" ">',e||"");return t},setResultValue:function(e){var t=this;try{var i,a=KD.isArray(e)?e:[e],n={};for(var o in a)if(KD.isRunInForIn(o,a)){var r=a[o],s=r.ts||"0",l=r.key||" ",d=r.data,c=l.substr(0,1).toLocaleLowerCase()+l.substr(1);n[c]={ts:s,key:c,data:d},KD.equalsIgnoreCase(c,"searchCondition")&&(i=n[c])}KD.isEmpty(i)||t.beginRequstData(i),KD.isEmpty(n)||t.setResultValueCore(n)}catch(h){KD.writeLog(h.message,h.stack,!0)}},setResultValueCore:function(e){var t=this,i=(e||{}).fastResult||{},a=(e||{}).aiRec||{},n=(e||{}).searchCondition||{},o=t.getFastResult(),r=t.getAiRec();t.getSearchCondition();KD.isEmpty(n)||t.setSearchCondition(n),KD.isEmpty(i)||(t.releaseFastResult(o),t.setFastResult(i)),KD.isEmpty(a)||(t.releaseAiRec(r),t.setAiRec(a))},beginRequstData:function(e){var t=this;t.resultValue.searchCondition=e,t.beginBuzy(),t.fireCustomEvent(t.key,"FastResult",t.getReqDataArgs()),KD.delayInvoke(function(e){e.fireCustomEvent.call(t,e.key,"AiRec",t.getReqDataArgs())},300,!0,t)},initComponent:function(){var e=this;KDNLPSearchResultPanelProxy.superclass.initComponent.call(e)},onHelpItemClick:function(e){var t=this,i=((e||{}).args||[""])[0],a=(e||{}).isKeepOpen;return KD.isEmpty(i)&&KD.isEmpty(e)?void KD.writeLog("resultpanel_nlp_search",KD.format("url and action of {0} is all empty. priority: url>action>log.",e.title),!0):void(KD.isEmpty(i)?KD.isEmpty(e)||t.onItemClick(e):(window.open(KD.urlEncode(i),"_blank"),KD.equalsIgnoreCase((a||"false").toString(),"true")||t.hideFormProxy.call(t)))},onItemClick:function(e){var t=this,i=e.key,a=e.args||{},n=e.isKeepOpen;t.fireCustomEvent(t.key,i,a),KD.equalsIgnoreCase((n||"false").toString(),"true")||t.hideFormProxy.call(t)},fireCustomEvent:function(e,t,i){var a=this,n=a.getFormProxy(),o=KD.isString(i)?i:KD.stringify(i);n&&n.fireCustomEvents.call(n,e,t,o)},createFastResultRow:function(e){var t=this,i=e,a=KD.htmlUtil.encode(i.title),n=KD.htmlUtil.encode(i.subTitle||""),o=KD.htmlUtil.encode(i.typeName),r=i.icon,s=t.genUIID(i),l=i.rowSeq,d=$(KD.format('<div class="kd-nlp-search-result-row" style="min-height: 40px;" data-key="{0}" data-title="{0}" data-type="fastResult" data-uiid="{1}" data-rowseq="{2}"></div>',a,s,l));d.attr({tabindex:"0",hidefocus:"true"});var c=KD.isEmpty(r)?t.getDefaultImgStr():KD.format('<img src="{0}" alt=" ">',r);$(KD.format('<div class="kd-nlp-search-result-row-icon">{0}</div>',c)).appendTo(d);var h=$(KD.format('<div class="kd-nlp-search-result-row-title" title="{0}"></div>',a));return $("<span></span>").text(a).appendTo(h),$('<span class="kd-nlp-search-result-typename"></span>').text(o).appendTo(h),h.appendTo(d),KD.isEmpty(n)?h.css({width:242}):$(KD.format('<div class="kd-nlp-search-result-row-subtitle" title="{0}"></div>',n)).text(n).appendTo(d),d},createAiRecRow:function(e){var t=this,i=e;t.aiRecImgdata="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAATTUlEQVR42u1d+XMbRRbW37G1v3FTVPETxY9QlYuAkwCLAywUx8IugbA5HRI7cU4oSCrA7pIQNoEFEootCEdxJMuVEI4AOe0E3/Fty7ctW5JtyZb8tl9f093TM5JtWVLAU/XKsjRHz/e9973XPUcHAj7LAztH/rh0R2R54fbo0aXbI7WF2yMRYjBrvhZhWBHMCHaIYWCyy307h/+w9NnIgcId0cQsoNM0giFiiZimBX7hjuHFhTsi4VnwMk0EwZRg6ws+YWrF0u3R5CxgM2OILWLs6fmz4GeHBFckoD7Nyk525UjLCTThzgKT3UggmMtSc7bayU11REtUVufPApKTKCDYB7DDMAtGrix6NMB7uJdPo7eFve2yq4gitYG8HF7wA3k6lofDFoH8BXyIG/v/nq1DkzJ9P/lLSCD/QLeBPejYlpBig9yU79R1raQM5RUZgdwDb4KuAs0A/hP5TG3zALMtHkZ/C0nTCDII8STjN0tAWqArgBtA372537A+w/TfbcTYyMg1EYGcA8+BYV5rgk2ALWV2V2kvs0093sbXEduo5FjJMKTKRcRlT4ABvgm86ekq6DrY3dy62N+NXW5Tfyd2dylu1yuJcQhRo8MdFdaIuOwI8PR6xeM3e4He6wDOwb1zYyfcWYLWQW1Jsd3Y73xdso1DjCBEJcNChEuaZp6EQHa93pEaDXgCDAOoWwOcAktAfei5TtjxVh+8/ukgfP5jBE6Wj8C5mlGobIxRw88/XRyBz09G4PXPBuHZt/vhkee76LaSFCRERlJ6RGQjGgIzWeG45EZKjQO8AMUEfcNrPfAZAbu5YwzGx0Bagtu4n8XZ37aOcTj6UxRK9veS/XfICHIiw0IEiUxHlmY+NwQyD74pOYbXGx7PgGeg37+1A946OgidPeM66OP6Z9VM8F0EETLGiHX1JeCdL4fgge1CrlSJ4slbyxEhS27IPAmBTIPvlhzH6zWNR6nhwBduDsK7Xw3BUDjp6dUm4CYRXmbuJxxJwuFjYbh3i42IHkOWbJKUWRICMwK+IjnS62mo93DgudQUB+G5t3uZx8ftgE/WbBEhZUmxbhIRO9/pp22g0kRzRJcjS8RhNEmaIRICWQF/U4/u9eSkC0uD8PWpKJWHsbgBVhpEJBPMEgl/IsTnhCFJ4vOxM1FYuiXIEzaLBuoo6ZKQMwJsCdcKfi/1LPQw9PrFxe2wbHcHNLaPOUBMFvCE8r/5e4qIECaIR2sOjsHyF7tkNGiSJPLCDJGQEQKE5tvB75Zav3hDOxS90g0DoQQDPx0CTC83CPAC3hUJY/ZIEBYKJWHtHkYCzQ2ybPUjYWjaJAQyBb5IuG7wOyX4pQe6IUqSoAp+wqvK8fB4lyW52UhJpBcNlIwYQIS0rfRAD41SGwl2OZoeCYHp63564Bft6YRINCmBn2wESLBN4BUCEmlEBDU1F4goiDFDB1m7p9tNgpoTZIk6fSmaMgFO0mXDCnrC7dJkZ/nuIAnxhJNwJwO8BWj8O8EtaZJjEKJFgS3RG1KEJGBbn9rdIUmQOcEkIQP5IDAt6dGSrlPt0ITLwV9a2gpNwTH9JC0kSNCNpGqTnAkfMwnxTcpxPRLQ4oSA+ChLzIWl7ZQEkZixOlL7CVYpmnkC7NLDOlndTrVDwF+8vgWOnY5Qr9Lq8DFd//2qHgG48OyJCWbm/xPGemYesMqSGQVchuL8L5aoi9a3GdWRMnQh88HUoyAwde+3SA+v89FrFq1vhecPdrOTEienRoCHBPl6vQK0F/ATHknZMxGbEqSQgZHw/KFe4kxtTj/BTMqaFE0+IQem6v1u6RE93CAFf+mmFujsHpdeNZZOBCT0Cihp8XxhwE0lIqmQ5KqEEh7e7xEFwvAc7iUyihG9pMRJym4pmloUBKbs/VrVo+v+IiI9730T0sLZpbceCdjL+8VfCjy4CTGlSZhaRQkSPCNAiVKRC9De+3qQOpWaD4QUeUbBTBDg6f2G9Ny3uQWGhpIS/HSkJxUBrghQF1s0pOgTpCJCJQDP5f4trfTcxDUGpyqaXhQEpqP9WuIljcIGLnqmGQ4e7acNV8EfjxuDYqkIMDxfkAAW8CcsUqSVpX4R4CM/YwoJB48M0KKCSlFx5qIgkEnvxwYueqaJjm7ShpsnlCICkgk7CTLZmuCDG3yNhHS9Xy1JY3o1JCIBc8Hi9U16VaRGga0iyhwB+kinTfuF969/Neh4vwl+fBIRYMqQRxL2JMKPhBSDc6YExfjfDa922KOAV0TWwbqMRoBMvnqPV3h/wbpG+PSHQdlwLQfEwHMMKC0JmkjDPKTHc2jCpzdsShDa5z8MUSeTucBVEU1ehgJTkh+l7meVTxtt2B1FDaQHGdcabnq/1/i/lKCEe1zH1g/wLEOVHrFtEM8cHR0zesKa/IzqhueGTkajQFRE/CKOOxnPEAFa8uUXV9AjCtY1wYPbGnXgY+CqhBgJE3DqVB0cPHgc9rzymdv2uG0v2l7+V3zea/zOzbW95RivcDt06DicPdOgl6EeEYD24LZm6myic2YmYyFDmZEgTf+VYQcx5lPiDDkUEO/f+npQ6qWQIFOKzp9vhAULSuCKKx7OKyu4YzNcvNCq9YJVi40w2/pGBy00zGRsl6HUJASmpv+9bvlZ1wCvfdjj1n/FDhGPv+qqR/MOfGHXXPMYvP/eSc8IQAJe+6jXLkNaNRRKW4bSJEDXfxwVZINuQeoJ6BF3FF2CT06EXJ4jyKisDMJ11z1uPfGrrnoErr32LykBuv76xzOyDh4Lj2n77YYb/gb1dT1aBYTAi//xHAuKGmlvX6+GeoxqKEMEeOt/p6b/t6+9BN+fC7vAF550zz3PWU94//4jMDISg3h8HD788AcrScuW/RO6ugZIsp2AsrJ6mDPnGdc6+B3+huvguriNuQ7uG4+Bx8Jj4rFtbXr44d2eEvT9uQhxtnpLHugx8sB0Jcgc99d6v0b5SfT/9rV1cLoiKhuq5oDmxn7riRYXv+HqWO3d+6m2zi23rIVYbExbp7Ky2bUv/E5dcBvcVl0H920u2AZzX1de+Sh0d0Zd4KOd+jVKox2dTuYBogbiWoHaK84sAUYCFmP+GIpYft6+pg4u1ozoBHA78W2llYAjR065ALl4sVFbp6hoP9iWm256Wq6Dn20LbqvuC/dtLtgGW9tO/1JvjYByco4Y7YyAVt9EnAEChuwdMEzAxXoCXkgIuFAzDPERt/6fOF5hPckDB466APniizPaOg888IJrnWh0FK6+2knm+Bm/MxfcVt0X7ttcsA22tp36ud7l/Whl1SM02vVE3GkMzhmVUGYJsFRARBMXrq6FUxcikgDaYE5CY0Ov9SRvvnkFBIN9EozBwSjcdpu7RP3yy7NynSTpbW3c+KZrHfwOfxMLbmOug/vGY4gFj41tcLftEegMhjUC8LxGhgFOXogyAkjU+1ZC2SCAjf80SQK+OzNklSC0JUu2WUm48cZlVCpKSv7jAQazxx57CbZtewcKCkq9a3nyG66D63qtg8fAY+Exb7zxCes6f77/BZfnxwj4w4S746fDRG5rHQI2ZJMAYwhCJQAb9dHxAVfDBQHl51tonZ2vfQCnUvorVFd1uM5jeBjvGwI4/M0AzXdIwCI/AtTbVrJFwN7DXdRT1LBVc8H+f39BwztfwcdO4qGD31qTL3p/OEyqtPe7c0hACgnatK+FeoorfJVoOPljLdx667q8A3/unA208rG1G7U/TLw/NASw6bW2HEpQiiR8b0kNDVP0Fi8pQouGE3D8WAXse/Uo7HzhsG47D8OuneyvaruU73dNwsz9mMfbt+9/8N2JStLmpNNOi/bjeQ0SAu4rrct1EvYuQ29bVQXVDTEXAXELEa7RUsuo6bjtWnLcfiuJ64pW3H6RxTymbehEbTOVHgSfyE8VeR5t4erqbJah6XXEcGwEdXHhqmp4/+s+JwqG3cCrvWTXdQMfcxFimC8RFsAFEbb2oY0OO+Cj9PQP4t0R/YSAmmx2xCY3FIHesfLFRhqqSAJqZ2zYW4pcw9Z+RHh4vqfHq7eXmDbqPdxsVj0C/N4QwOqXm6j+Z2cowmMwTl4LtgzGoXcsWFkBdc1xSkKYR8KoXyR4DN7FTakw5cpyO2Hc564GG9k2z5dJN8zAH+QE1LWMkfOrorkuO4Nx6QxH00rIGY5G77htZSW8eriTNhp1M52knIoI6+0iqQiy3NlgG15WCVBlJ8J1H8+jZwBg30ddVGJZCZrF4ejJXJBZyPPAnesqoa0rQRuPXoTeNDzsn5TVoQtfQlRPjnl/n4pgr56uqHao9IQY+M0dCbh7Q7Wi/1m9IJP+JUmWB5gM7f+4ixJAI0GRIzMKUkWElyf7SoztkqLi/eaxVc0fVGQHwe/qB3j9kx4a2UL/c3NJ0veifBvNA6oMLVr7K1STXIAn0RcCmZiRBD9J8iIklsKjUyVXV32vlJnS88OsrX3c8zsJ+BVNY7CkqErKDw69Z/mi/ORuSxHl6IIVFVC8t4meCJrICRgJYV4hjaToNds8OJ6mWfdn6eFGIkq1E9I9HwdqsXcvvN9TfmbstpRJ35jFqiEWBVUw/+8X4YNj/fRkKAkhdqKhIYcIV5U0YvdUrwhJZz1V50WiVWv8kCI5WG5ie9t7AT4gg4sLVvxKHWoh9f76LN+YNYVbEzEZq1FQsOYinCEXMTo5CWo0iCrJT5pSAZ6Op5tyI3q2osoR4GMbOzn4Z6pHYdGaCur9ruSbs1sTtceS7Dfn6lFQSaPg4a1VUNs6Tj2rs88hQVRJakQIaTIjY6qmanzE8HgBvAAfgUfZqSZtfWgbcyDd+3Nxc27KXrH6cIaaC2ppzxgrovlPX4Annq+Bxo4kPcEuIxpEpSQSNRotXaOKDTMbHfYmZmRY3yas5By1ulGBx7YIyWntAagPJuHJF2qp41i1P+u3p6dzi7ooSfkDGqwiqpf9AvSkeU+Xw6qXL9ETxJPFSBDRICqlvpBCRlhP2hRMi2SJ3yVxBuA2qaEez48f7GXW0k16u+1JWPXiJQk+kx7e8VK1P6sPaKT1gJ77ESX0GClFZJQUk9l8QsIyEgkY4uhtSITwQBoVISdZC8BEvhDSIQAVJr43f5fbhxzQTY8XXo/gVzWN0yjFaMWoVaVHDLzl7hGlKTykhx5DR0l550zkAyThoS2V8EvVKLT0MACCHIzOPoWMAT06VEJSGd0u5BAqkqs4Dhoeu7mbgf9z5QhtE0ap1H0+5qNJT84e0vN6SDvFY6p0jGidyAc1sjRFEgpWl8H7pERFEFo5Ee29jiQIIgR4aoT4mZAWCXofs3YuM60C+B5m//2qj7SlXIKP0Sp1X152zIfHVKf4oLbIB7Q0VUiYR0J93vLzpLPWAOX1cQpOi0IGfm5XPFYQIwBWpUuVFBvgYn9ozdzK6uLwzCsNtA1UdmzgU93Plwe1p/iqAjsJlTQnoNfNW14GBSvLyF3HHVDblpAAmYR4md96KuDCaloT5OaBDihYVUaAL6POIDTfAb9Rgp9fryrwScjaEIXIB1YSuBzRxFzBJakM5j11DpasKYN/vdcOF0hENHfbAfSyFoM4c/tzdTF46V3SFpQb4vUYgbLa4Zqve35rHr6sYxqvq5EkrGOjppQIcuIiObNoOE+JmPfUWVi+qwbePtINp0mPNB2AbYT8QpLrm5930cpr7pPnuNyUM69f4fRyZbWjyE7+vq5mGi9sEo+xsuroEusnCElaWSGJEBGBoM0lZNy9rhyK/lEHuw61UEA/PtFP3gc6CMfOhqnh549PDNDfdh5sgTVk3bvINnOfPEu2F8CXca3/VXo9lZw1TrXjCX5evbBpmq8skyUqOWEqSSIaVldrRCBY80VUEJsrCKGgMpvzJDPxPyOMRxEHXUgNAo/7RukTXo9OgL12jEzqHPwie7bAz9lL+6i+KtEgErQkAvMDAcvJERd4ZJRzTy6TxAiT31PiDNBXVnGdF8DXGV7PX8ZxWb20b5qvrdSjoYl6opOkWaKmOYKQISIDCaGgYq8aiVFMfE/XWcn0nXk7kxrH44XWO15PJeeye23ltEhgeYER0cajgREhI4IOY9Sx6oRXTggm9WRBjGLie7oOjuFI0Jm3Y/JnHt9EO1dU6xWvd17c6rzqPv9f3JqhVxfToWwcScWIENJEwBJkSEJovqhjydswIWF0HerplxjoXOPpZUQDePHK+8v71cXpvLxbnSvA5+XdjjTxqFAjgxLSwElpoOBqViTAbuSAq6C3skjTgP8tvbw75evrvecNsL6+HomgUcHzBCdEksKJ0Yx/LwBnnq6AXjLJ19dnaWqTzE/kZiVhehM4MK91SHHMAVlasQO49wQOvfkygUNkZqYyzPkUJh2XxRQmfCrDGZzM0zcaZifxYZN5zvR0tjmfxqo/b6exotPZZm1C59mJ3OwTOmd9SvPZqQz1Kc1xwQnmcaL53M8pOZnJPAczN5ln1qczj4QR84C6FO4YXrx0ezQ5O53tTE/iTDAmWAdsCwmLFTkj4XcwoTNiixgH/BZkJ+ty9HuY0hwx9fJ8c0F9ook5G9XRb90IhoilS/PTWbBMYv2E6FHeY47Mgpp6eIFhRTAj2MlS02P5P+XRzzTj3d0mAAAAAElFTkSuQmCC";var a=KD.htmlUtil.encode(i.title),n=(KD.htmlUtil.encode(i.subTitle),KD.htmlUtil.encode(i.typeName)),o=(i.icon,t.genUIID(i)),r=$(KD.format('<div class="kd-nlp-search-result-row" style="min-height: 40px;" data-key="{0}" data-title="{0}" data-type="aiRec" data-uiid="{1}"></div>',a,o));$(KD.format('<div class="kd-nlp-search-result-row-icon"><img src="{0}" alt=" "></div>',t.aiRecImgdata)).appendTo(r);var s=$('<div class="kd-nlp-search-result-row-title"></div>');return $("<span></span>").text(a).appendTo(s),$("<span></span>").text(n).appendTo(s),s.appendTo(r),r},setSearchCondition:function(e){var t=this;t.resultValue.searchCondition=e,t.searchConditionImgdataSmall="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZmlsbDpjdXJyZW50Q29sb3I7b3ZlcmZsb3c6aGlkZGVuOyIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik02NzkuNjUxMjgxIDcyMy44NDU0NTZDNjE0LjMxNzQ1OSA3NzkuMTUxMzQ3IDUyOS44MDMyMjggODEyLjUgNDM3LjUgODEyLjVDMjMwLjM5MzIxOSA4MTIuNSA2Mi41IDY0NC42MDY3ODEgNjIuNSA0MzcuNUM2Mi41IDIzMC4zOTMyMTkgMjMwLjM5MzIxOSA2Mi41IDQzNy41IDYyLjVDNjQ0LjYwNjc4MSA2Mi41IDgxMi41IDIzMC4zOTMyMTkgODEyLjUgNDM3LjVDODEyLjUgNTI5LjgwMzIyOCA3NzkuMTUxMzQ3IDYxNC4zMTc0NTkgNzIzLjg0NTQ1NiA2NzkuNjUxMjgxTDkyOC4zNDcwOTQgODg0LjE1MjkwNkM5NDAuNTUwOTc4IDg5Ni4zNTY3OTEgOTQwLjU1MDk3OCA5MTYuMTQzMjA5IDkyOC4zNDcwOTQgOTI4LjM0NzA5NEM5MTYuMTQzMjA5IDk0MC41NTA5NzggODk2LjM1Njc5MSA5NDAuNTUwOTc4IDg4NC4xNTI5MDYgOTI4LjM0NzA5NEw2NzkuNjUxMjgxIDcyMy44NDU0NTZMNjc5LjY1MTI4MSA3MjMuODQ1NDU2ek00MzcuNSA3NTBDNjEwLjA4ODk4NCA3NTAgNzUwIDYxMC4wODg5ODQgNzUwIDQzNy41Qzc1MCAyNjQuOTExMDE2IDYxMC4wODg5ODQgMTI1IDQzNy41IDEyNUMyNjQuOTExMDE2IDEyNSAxMjUgMjY0LjkxMTAxNiAxMjUgNDM3LjVDMTI1IDYxMC4wODg5ODQgMjY0LjkxMTAxNiA3NTAgNDM3LjUgNzUweiIgc3R5bGU9ImZpbGw6IHJnYig0NCwgNDQsIDQ0KTsiPjwvcGF0aD48L3N2Zz4NCg==",t.searchConditionImgdata="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOoAAADoCAYAAADhXHhFAAAZfElEQVR42u2deXAb133HM9P8lc400zSZJnHaepreShs3beMmcdvEp2L5tmU5dmzHsqzLp+zYiXzINmPdomxdlizrFnWSuiVboijqomlRog7TkSXrvizJog4CXCyA3QV//b3FLvC4WAALEiAI4MuZj75vdt8+goP30V5v335l6dKlfwIA6N58RfxDRACAbgpEBQCiAgAgakf+4KP09Slb6Il3NtG48RtpKig8xHcnvkPxXULUImNuPf24bA0dHFxBbU/MIQKFz6D51PYH/k7FdwtRi4AJm+gt8aWicxevsOI7hqgFzMRaern/PEha7IjvWHzXELUAWbSXrn56AUXQkUsD8V2L7xyiFhgjP6Rt6MClhfjOIWqB8cISCqPzlhbiO4eoBXbYi45bmhTj4W/RivruR9QLnbY0Ed89RC0UUbdQb3TaEhWVv3uIClEBRIWoEBVAVIgKICpEhagAokJUiAogKkQFEBWiQlQAUSEqRAUQFaICiApRISqAqCUr6oef03WLdvIAbVByiO8eohYIe8/QNY2niEDpIb57iApRAUSFqBAVQFSICiAqRIWoAKJCVIgKICpEBRAVokJUAFEhKkQFEBWiAogKUSEqgKgQFUBUiApRAUSFqBAVQFSICiAqRIWoAKJCVIgKICpEpY+OEdUd7XoaTqT+XDtP5Odz5YNdEBWipmPgvPzM9zOrLvXnWryrdOY+qj0IUSEqRIWoEBWiQlSIClEhKkSFqBAVokJUiApRISpEhagQFaJCVIgKUSFq0Yn61VbVuL81oC/1K9ohv6L7uBxwQ1GNWMrlzqy/2BpRISpEhagpUJTwvyoBvVFRdU3A4uh2JkGTMgFrW01qL5ZJ0C/5DQ2iQlSImgS/X/8ZS3qBZQmyTKpJQEqmVUqLoJTmdvL28jI3rLaCdvu8V1Uv+o0gRIWoENVtT0r0bT7MPe4P6K0yfAjst1Mux9frfjvdkOu41Xdb39yiByAqRIWobqKqejnv2S7z+egVO61yLC0uS5m2vrwsWjYu22lil0VadS/6DF9nRB39AdGIdV3Psj2pP9fapvx8rnyw/QhEzbqo58/Tn7Kop1mSZpbmQjzlskg30tVPs16RUomuY1Ev45EvPOYGUR20turXsyzn3FACxlk7zbJiLeM0CUjpgYT2pGU2zT6jGZ0WokLUhCu9xkMsyGk3WKJTdsrleB1DSsOxzAvtt+eLSadY1PPotBAVojr3qAGtvz8gLiRpx1nCWLoh1zHLqnHMTrmctD1Rz84k9Zv9xhl0WogKUZ23ZQJaP5b1sMAvpVlW9UN2RjEOxzORaF0jvr2UrXY7cnsBqz2Rgeh2F32Rk+i0EBWiOggEjL4sywETRYunXE62XtGltOvoB7y3J6XVVnOLcQydFqJCVOceVdEeY0E+NQno8WR4EEKTnXLZXt9uGzcc7bnQJKVZvuDTD6HTQlSImijqoyzI3iialJpjmb5XkVJxLPOyPrF9J/reZr9+AJ0WokLUhKu+2sMs0y4v+KWMokmpOZYlIrchYDkb7bTLzT5tPzotRIWoTlGDxkMs144o+sfx1D9uldJElVJ1LHNZL9qy0yxb7bfKbTrav9Cif4JOC1EhasLwQeNXLMl2E1VK1bGMYWnr7JTLse0zhKWts9Mu8znqHnRaiApRE0YmGQ+wjJtNFCkVxzI3FH1LLOWy1/WJ7W3mAQ870WkhKkR1iqqG+/CebKMril4TSzfkOi4oUirRurE0CUhptfWlT/8YnRaiQtQEUY3eLMh6AUv0oZ0Cv5RuiLp2um3P8q2300SRUtrWH/tdxocX/MZ2dFqIClEdqKpxL0uy1g0WZ42dZlmxlnFGy/oaO92IbhtNuZxq/YUWYys6LUSFqE5Rw3Q37+VWRDGkNFawPCvtjJb1FXaaqEY8o+WVsZTLsfVSure/8nyLXotOC1EhasJYX+MuFqTKolLKSr9VFmmVY+lW37Es/XrVqIxltFz5pc+oRqeFqBA1cazvHTzMb4krqrE4lowipWKts9MTjvbaLbP4ssVYj04LUSFqoqi3sWwVAhZlgZ0mdlmkXI6tl1K1trXSrT15mVxX3v68T1+HTgtRIaoDny/UiwcbzBXwhaJYymV7PY8Ljqdirptjp1kOWMuStGfVi9eX2rDKc/nQdxU6LUSFqM6RSSG9J8s000SRkmFxZthpMVNKN+Q6jL2tSLmctL0ZX7a0Le/Mlz2nnmj2R13P+v2pP1fNwfx8rnxQfwyi5mBQvn4LX3l9L4ompeZYZrznt8oi/VYdf6xuYv107TnXi7a+bNErMV0opguFqIl71JtYkilRDCkZ1ZgcS7lsrQ9YZZHRsjbFTnfSt3/eZyyCqKUp6taDdP38bfSdQmFNI32zC5+eoRt4dNCEKJqUmmOZPoGnFY2lXI5tr0qpOpa5tu+A6355xaiAqKUp6tj1VDZwLg0oJJ5dSAPeWke/mlFP38jtEMKg/gsxAbeARxnFUi7H12uxtMrj7IyW9XI7o2hSao5lbu3r5XwxaS5EhaiFxpDF1H/pTvp2Luf1/TlLMlrAosRSLtvru4LzLcYsiApRC5Fhq+jRXO5R/5dHBA33gl8Jj7BTLnvdPm37zPkrxvsQFaIWKkv3tz8Ezt4QQr/+PyzJmzmiTMoyxzJXzrVEpkJUiFqovLeNfpSjp2fopyzIa0kYJqUbcp1sMOzcFWMyRIWohcrkGvpJrvaoP+FDzpdNFH1oLD2gBCOxNLHLIq227HTF8fuUoD707BV9AkSFqBA1YY+qXauokRcFLMtLdkbL+ot2RolIGXEsYxQpFWudEq/vt8oiLV6S0vw9Z69ExkNUiApREwbl03/xlKFDTFQpGZbneTvlsr2epZOSMddZKZft9e22cd+ez1HHQFSIClETRNX+g59cecbiaSmZiJQRa52dLvVbrbJIuRxrr902z7RvM/q7zrZERkJUiApRE0X9Ecs02CQgpUlkUDzdkOu41Xeu1wZJOcj6XYPk33/2cuStzohatTs/1H6eZnjc4fx9tq5mx/GOfXfrP6OyZbtpQCHzwX76l5yIekXRruFnUp8QiFcw2hl9HWO0LFIu2+udyG24tedl/RdX9DfxyFdpsucMle0+QwMKGf47vp+jp2fC/8ZPrfQViDe72SmX7fVO+CXIj9kpl5O1J9bZ6Vaf/xPoy6IOQ6eFqBDVOTIpTD/wKdojAn69xcN2uqIYj8QyWo5n0LC3i20vt+navl0WaZXPXNRfQaeFqBDVwaXWcA8W5EETJRxPF3xS+hzL2m1rteezyrH60jK33yfWfXE58jt0WogKURMG5Yf/mZ8Fvd+ij5R9HMvSr28N94mlG6KunUna/6Il8lt0WogKUZ0jk0L0j/xai3tNWqVsdSwzMaTMHJ7s+x47zTK3bWf09xj3nmrWn0enhagQNXFys7/nCzx3CvxS+h3LouVwLK3yHXZGy8addsrlFOsd7Rt38sikZ9BpISpEdRAK0fdZkl4mIePWWDI+qyzSZ9WxM+BY5rY+HW7bn7oceRKdFqJCVActLaG/FROcueGT0iyH4imXfY66ybZ3kthe6BYWdSA6LUSFqA6CQbqan1q5wUSRUnEs87LeQYui32inXE5WX7R1uoX6odNCVIia+DzqX/MsD//nCk/TEks35DrRcjxbHcu8rf/5qUvGY+i0pcmOE1RWf5wGNJxMFKCBl9fnmXyL+j1+JvU6E1X/WSzd8EvJ8LaxNMuqHst2bVntW/WvS1ZfZY5dNB5Bpy1N7EH5721NFODVlfkdbP/0/DyLyo+5fZdluVbgU7X/tjNa1q61MwpJSY5lZt1Y+qx1Pqm+vMxtvdj2RDM9hE4LUSFqoqjfEY+6udES0P7TTrkcr0NSkrWOUtR3krj9qUvUB50WokLUhEH5yl/yONtrLH4o5Q8VjeIZLV8TS7f67Zd5WG+3JTL6u45doPvQaSEqRE3kW+Ew9RDw6KAf2GnRQ8oerdF10bTryfXlZW7rHe1Zv6uH/PtPXKS70WkhKkR1DiEk+gsxjFAQktIs+0OxlMvx9eF/stPELidrT8p2daXtjzUbd6DT5p6dJ/kNcwfaaPUnEapqjNCihggt2x2hNZ+08QwNbRC1G+5R/5yHEf6dSUjKkGMZI0Yx2emGXMetPXNdKL69W/1D54xeECn7rGEhJ1Tr9FxFiPpMUummkQG6friSlJ6jAvTQFJVeXBSmd2t12rA/9/JOqqWy31bSgLn1iQKMWEcDxLp8MbQy/6L+2ZVg8GoBD374GzvdsdeJNMtSkr1dbHu5Tbf23dYfvKD3hFjZYW1TG/1hpUb3vKOmlNIrD7K4Y9Zp5p4YAx66WNSzRF8T91IFl1Q1ltFyPKPQVfGkq6z6V8Xrx9twby/1+kuX1O8dukg3QrLOsWiHQf1nBbMipxs3jgjQcwtCtHJvBKJmQ9TyrfTvIzfSW8OraTXTMKKaGt0YVUP7ugtjN9HBSdv4MCgJ0/iN1vN2En34GdGuk4lf9msriIYu63rELIOpOuGKfbn/DM8sjNAd43MnqBv3TQjR84vb2n0OMZEbRPUg6tR6umrERlrBclIx884WouqDmC6032yiu94JsziBLpXU5gbew943UaN+nZwutKREHV9LPYZvpDPFLqkNHxHQqqbSFfWR9yN0y2g1L4I6uXVckB6b2QZR04kq3nrMkh4pFUllWTccKD1RH5iq0w152osmPX/lq8mzt0cgaipRR9bQuFKTVD4MFuespSJq70latxJU5maWddZ2A6K6ibqmkb7GexalVEUVfPBZaYh678TuK2nsvJX39NO36BDVKeqYWrq1lCUVzN1Z/KLeP1nv9K2V28uD9OupYb6Fo9Gz83UaulSnYcsNemmxTk/O06nfDI0emKJRL653/YhAp35XxccGRJVFHbmJnip1UafVFbeoD041OnhlN0B3vB2k/rPDPABCp8kbwjRtYygt5R+E6ZUqgx6drtGtYzt220eMcFq1LwJRpfPT10pd1Ilbi1fU38xoMy/UZCrK7XwldsiCME3ZEPIkZzLG8Ygksaf95ZjMhe09UaW6oxDVhAcLDIOoxSvqLzPco93Ee7LBc3Wa6HHv6ZVRa3T69Xuaee80k8/zPI9kgqgQtahF7T0ps/PSX45R6fVlWlYFlZlSHTL/E7h5VGb3b9Odr/LFwLJKfnVh9YFEAVY20QCxLp9AVIialL6zMjvkvZPPRceuDedM0hg1YfrdEiOjc1dxCJzq3akl8ZhbJqJyXRrdAZyDDEbXdA08HNKzqE9VEA2e1/XMqU8t6pJdHWv37glh7+ej5Srv7cI0vSaUMXuP68SPGNK+EzrVfqrRnC3etntzuU49MxgZ9fZ6HaJ6FTWsE0UibRkzfnP7e5YdaaMjbD3iXdRiegpGPMB9k8e96X0TArTtgEa7joQ6REsgQvJPW1sb+XjZwS/Cabf9oEmnXmO9fc67x6vUcAKiQtQiEvXNFZrHc9IArd0b7rCkbqLKP2Jd04nk2zYeDVNFveZ5OOO0zTpEhajFM1XK7eXeOv7YdaFOSZpOVPGjG230eYq9q5D1xYXeDtMfmx6EqBC1OKjYYXjq9HfxoWT9oXCnRb3UapiHu6l+xPqj55MfXlfzua3XQ/Xqz9ogKkQtfF5a7G3vNGlD5/emMp+eDNPpizr3EXdpIyzrZ6eT/ccQpleXhTx97nEfagl/84KdVPZODQ1Y5nIrZEYdDRDr8sXEzXkQ9Ugz0YlLmcOzL8TaWLq3Y210hNWflp6o93qY5+j2coUasrA3dT+UDdGZS7rrXlZjifccc9+udr/maZjjwFkhDHgo5fuoxSDpRj4s9LJXenFRKCeSynx+VjOPapw/Zy/rSc9VH52W/j+ZnqMD5nk4RIWoBcusbd7OT2dtDedcVIE4L004BGZ59x13rz96rbfDXzFLIkSFqAXL6HXpb8vcNFKhuoOhLhFVcJkvNjl/TjW771VX7/F2fj27zoCoELVwEZNep+vkfSYHukxSQRNfZHL++NWIa92dR73dUx33gQZRIWrhMnB2+kPH/jPVLhVVoIQSRy/tPup+nnrn+PTnqcOWhyEqRC1cxICA9I+Ndb2o567oCXtVsad1q/vw1PSi/n4JRE3JgkaihbszZ+TG9lJ0pI2OMGV7aYn60LvpRX29Ktjlop5sThT1wBl3UQfOCmb8jCpExYCHguLRaek7+dDFXS+qOMwVe1AZt0NfwWPTVQ+3l7BHhagFTP+Z6UV9ck7XH/pmwn0T0ov6SiVEhagFzDPz0l9MEueA3VlUMalZur/hD6tw1ReiFvTjbelvz9w2Tum2km7Z7+0+qnjvqvx3T91GZWLw/fyGRAHKq6MD8/PFsJUQFaI6mFzjbY6klbuC3VLU9zd7E7WyMYKnZ1IhOv72DiBPxzJrR8fa6AgVu0pL1CruwF46+shV3fPwd0iF6mmuYefrGSEq7qMWFGKqkls8nOM90g3PUxv4Ubdbx6b/T+ZX/PZyPI8KUUviyq9gdWP3OvyducXbgHznFV+IClELkrc3eDtPHTS7++xVGw6HqM8kbzM8LGwwICpELXw2f97mebKwyh3dQ9TJG73tTe8oT3wWFaJC1AIenO/t8Pc3/KC22JvlU9K6g2GeCtTbfyzDloVd/966Y1S2+RANqD+eKABfAB0g1uUTiApRXVngcYIzwWuVal4PeQfOUj2/inHD/ja8ewa3Z4qLX7/r/ZURUzbkR9bXlwWz8rIoiIoBDwXLvI+871Vv5FkfFtV38XnphmBGLzZe19QGUSFq8YkqGDw7lJGskzbk/pbNziPivTOpJe3JM/jL8/y+sSKM1y5C1OIVVZzTeRkA0f4xOL7AdCg3km4/EKJBac5JhaR9Z7bRozMi/HrGgPnOmY+O4v2oELWIRRVM2aRn/Kbvh99VaWGdmtW96PTaEM85HEj7LpzH+XWR8belR2hefQQvMoaoxS+qYMiCUMayCvq9H6CqHZ07HJ6zJUgPTgl4eolyX0lSmxeWUMLYXoiKqViKkvpj3mZ/SMYDPGroDb5Cu6Q+mPa+a/3nIZq3LUgvL1HpnrcDnt907iapLOuWwxAV91GLXFTBNu7ofSapHZY1PlN9VNz+MwJ8yyRAr7CQz81X6fHpAbp/YoDPKzNrT0j6eApJbZ4Xsh6CqBD1VPFTwy84fmBy52XNFl4ljcm62F1WiApRi2/PesTbtKJdQa9xKvWb7V3UpyqIXq3S+JxXpbveVulpnnpG3F+FqBC1KPn4OJlz4xaSrIPnk+vRgLjfOmqdXgVRIWrRMpNfKtVrbCCvot7De8bpWyM0eF5qSe9PcX7NI5ciry/X3oeoELVoEY/FRd9Z07XCij1h2UrNvCItPsfqJqJB8xMlfXJ+G1+kSn9efQPLOmyZNgOiQtSiZvmeCD9MHsq5oGLc7gsLQ7Te5UmYNU3RvWf8nLSN7pvo/eKXkPW1Km0mRIWoRY949+hLi3n+ojHZ3cOKlz+JMbs1B9rS/P6orE8vpIwkjck6PBB5ZVl4NkSFqCXBDr7gNIffQyqk7T2xI7d0AubVWTHH0eKGiOvMDEll/ZTopU5c7BKyDq0Kz4GoELXk2MTnsuKB9AnVuvnaQ3Fe+8z8EA2eE6LnKkKm0G+s0My5hYWY6Yb9pUPcfunMHlzI+nJleC5EhaggR+xi5MfcOsyIQNvvl4bnQVSICnLEb6ZlaVAGy/q7yvB8iApRQQ5YsjOSvVtGLCsfmldAVIgKcsD49Xr2rjyzrC8uDi+AqBAV5HFCca/wRbCFEBWighwgrjRnU9YXFoUXF5yoI2voNYgKGbq9rBuzK+uQheElhSXqJnqq1EWdVgcRCoFJ5vtfszdiasiC8NKCEXVMLd1a6qLO3QkJSlfWUFVBiLqmkb42opqUUhZVTLgGCQptZsXsyfpsRWhZvkU9fI6+lVJU6zx1XKlK+s4WHglzEp2/0Hi3Nruy8nDI5fmSdM8p6ssefjWtqDPq6RvDN9KRUpOUjyRowwF0+oK9dVOtHRJjerMlK0/tsiIfon5ynn4g+5hUVMH4WurBsp4pJUlXNaGzFzB/3P0FPSmeksmmrK9Udekjcv33naMfO11MKapgaj1dNWIjrSiFw93qg+jsBclpCnLO3XeKbt5zkm4UPDs/NCpbsvLDAErNAbrNbjsX7DtDv9h7hq5pPEvfdPMwrag2b2+jH/Gk2W9xp17NNPDep7EQ4b/hk/JaOsliXp68na7MbqALa/fT4d2nqBEUDixm3Z7TtJTLT37WTN9x67M3jQg+nC1Zbxsb/HkqP7oCT6ICUIjcPDL4EE/HYkBUALo5t4wKPtgZWW8Yrvj6v0dfh6gA5HrPOkp9gG/d6B2afG1U4Inu8DdAVFAaso5R+2QqK19IKusunx+igpKh5xi1t1dZbxwZeKM7fXaICkrrnHWMei8/NK6l3JOOCgzrbp8booLS27OOVu9JJiufk77aHT8zRAUlSa9y9afXj1D+GJ9VXzkvzmO76+eFqKCkuXOK+ld3l4f+obt/TogKQAEAUQGAqAAAiAoARAUAQFQAAEQFAKICACAqAACiAgBRAQAQFQCICgCAqAAAiAoARAUAQFQAAEQFAKICACAqAACiAgBRAQAQFQCICgCAqAAAiAoARAUAQFQAAEQFAKICACAqABAVAABRAQAQFQCICgCAqAAAiAoARAUAQFQAAEQFAKICACAqAKUnKgCge/P/0Po6jblyBOUAAAAASUVORK5CYII=",t.topGroup.empty();var i=((e||t.getDefaultConditionValue()).data||[])[0]||{},a=KD.htmlUtil.encode(i.title||"search all data."),n=t.genUIID(i),o=$(KD.format('<div class="kd-nlp-search-result-row kd-nlp-search-result-row-select" style="min-height: 35px;" data-key="{0}" data-title="{0}" data-type="searchCondition" data-uiid="{1}"></div>',a,n));$(KD.format('<div class="kd-nlp-search-result-row-icon"><img src="{0}" alt=" "></div>',t.searchConditionImgdataSmall)).appendTo(o),$('<div class="kd-nlp-search-result-row-title"></div>').text(a).appendTo(o),o.appendTo(t.topGroup),t.renderSummarySearchCondition(i)},setFastResult:function(e){var t=this;parseInt((KD.getConnectConfig().portalNLPSearchLimit||"0").toString())||1e4;t.dataReady++,t.__curPageIndex=0,t.resultValue.fastResult=e,t.renderFastResult_page(!0),t.endBuzy()},renderFastResult_page:function(e,t){var i=this,a=!0,n=i.__curPageIndex*i.__pageSize,o=n+i.__pageSize,r=i.middleGroup,s=i.resultValue.fastResult,l=s.data||[],d=void 0;if(l.length<=o&&(o=l.length,a=!1),n>=l.length)return a=!1,void i.moreLink.remove();for(var c=n;o>c;c++){var h=l[c];h.rowSeq=c+1;var u=i.createFastResultRow(h);u.appendTo(r),c==n&&(d=u)}i.__curPageIndex+=1,a&&i.moreLink.remove().appendTo(r),e&&d&&d.length>0&&KD.delayInvoke(function(e){var i=e.scope;!t&&i.scrollTo.call(i,d),i.onGroupItemMouseEnter.call(i,{currentTarget:e.target})},300,!1,{scope:i,target:d[0]})},checkNeedMore:function(e,t,i){var a=e.offset().top,n=a+e.height(),o=t.offset().top,r=o>a&&n>o;KD.isFunction(i)&&(KD.isDebug()&&KD.writeLog("checkNeedMore",KD.format("target is {0}. target-Y = {1}, visibleTop = {2},visibleBottom = {3} ",r,o,a,n),!0),i(r))},setAiRec:function(e){var t=this;t.dataReady++,t.resultValue.aiRec=e;
var i=e.data||[],a=!1;for(var n in i)if(KD.isRunInForIn(n,i)){var o=i[n],r=t.createAiRecRow(o);r.appendTo(t.bottomGroup),a=!0}a?t.groupHrGB.show():t.groupHrGB.hide(),t.endBuzy(!0)},beginBuzy:function(){var e=this;e.waittingEl.remove().appendTo(e.groupsPanel),e.dataReady=0},endBuzy:function(e){var t=this;KD.delayInvoke(function(t){(t.dataReady>1||1==e)&&(t.waittingEl.remove(),t.dataReady=0)},800,!1,t)},renderSummaryPanel:function(e,t){var i=this;"fastResult"==e.type?i.renderSummaryFastResult(t):"aiRec"==e.type?i.renderSummaryAiRec(t):"searchCondition"==e.type&&i.renderSummarySearchCondition(t)},renderSummarySearchCondition:function(e){var t=this;t.middleDetail.empty(),t.bottomDetail.empty(),t.detailHrGB.hide();var i=(e.uiid,e.summary||{}),a=t.searchConditionImgdata,n=KD.htmlUtil.encode(e.title),o=KD.htmlUtil.encode(e.typeName),r=(i.action||[],t.getReqDataArgs()),s=KD.htmlUtil.encode(r.text),l=$('<div class="kd-nlp-search-condition-detail-desc">');$('<img class="kd-nlp-search-result-detail-icon" style="width:120px;height:120px;" src="'+a+'" alt="Search">').appendTo(l);var d=KD.format(ResManager.LoadKDString("在“{0}”中搜索“{1}”","0141072000005413"),o,s||n),c=KD.format("<div>{0}</div>",d);$(c).appendTo(l),l.appendTo(t.middleDetail)},renderSummaryAiRec:function(e){var t=this;t.middleDetail.empty(),t.bottomDetail.empty(),t.detailHrGB.hide();var i=e.uiid,a=e.summary||{},n=t.aiRecImgdata,o=KD.htmlUtil.encode(e.title),r=KD.htmlUtil.encode(e.typeName),s=(e.typeId,a.action||[]),l=s[0]||{},d=t.genUIID(l),c=l.key,h=(l.args,$("<div>"));$('<img class="kd-nlp-search-result-detail-icon" src="'+n+'" alt="AiRec">').appendTo(h);var u=KD.format('<span data-key="{0}" data-type="aiRec.summary.action" data-title={3} data-uiid="{1}" data-rowuiid="{2}">{3}</span>',c,d,i,o),p=KD.format(ResManager.LoadKDString("小K使用语义搜索为你找到“{0}”相关的“{1}”，请点击查看","0141072000005414"),u,r),g=KD.format('<div class="kd-nlp-search-airec-detail-desc">{0}</div>',p);$(g).appendTo(h),h.appendTo(t.middleDetail)},renderSummaryFastResult:function(e){var t=this;if(!t.renderSummaryFastResult_help(e)){t.middleDetail.empty(),t.bottomDetail.empty(),t.detailHrGB.show();var i=e.uiid,a=e.summary||{},n=a.icon,o=KD.htmlUtil.encode(a.title),r=a.fields||[],s=a.action||[],l=$("<div>"),d=KD.isEmpty(n)?t.getDefaultImgStr("kd-nlp-search-result-detail-icon"):KD.format('<img class="kd-nlp-search-result-detail-icon" src="{0}" alt="FastResult">',n);$(d).appendTo(l),$('<div class="kd-nlp-search-result-detail-title" >').text(o).appendTo(l);for(var c in r)if(KD.isRunInForIn(c,r)){var h=r[c],u=KD.htmlUtil.encode(h.key),p=KD.htmlUtil.encode(h.value);$('<div class="kd-nlp-search-result-detail-field" >').text(KD.format("{0} : {1}",u,p)).appendTo(l)}l.appendTo(t.middleDetail);var g=$('<div style="text-align: center;">');for(var c in s)if(KD.isRunInForIn(c,s)){var f=s[c],m=t.genUIID(f),v=KD.htmlUtil.encode(f.caption);$(KD.format('<button class="kd-nlp-search-result-detail-action" data-key="{0}" data-type="fastResult.summary.action" data-uiid="{1}" data-title="{2}" data-rowuiid="{3}">',f.key,m,v,i)).text(f.caption).appendTo(g)}g.appendTo(t.bottomDetail)}},renderSummaryFastResult_help:function(e){var t=this,i=!1,a=KD.equalsIgnoreCase((e||{}).typeId,"Help");if(a){t.middleDetail.empty(),t.bottomDetail.empty(),t.detailHrGB.show();var n=e.uiid,o=e.summary||{},r=(o.icon,KD.htmlUtil.encode(o.title)),s=o.desc||"",l=(KD.urlEncode(o.url||""),o.updateTime||""),d=o.viewCount||0,c=o.helpType||"",h=(o.fields||[],o.action||[]),u=$(KD.format('<div class="{0}">',t.__helpDetalSummCls.substr(1)));$('<div class="kd-nlp-search-result-detail-help-title" >').text(r).appendTo(u),$('<div class="kd-nlp-search-result-detail-help-subtitle">').append(KD.format("<span>{0}</span>",KD.format(ResManager.LoadKDString("更新于 {0}","0141072000004022"),l))).append(KD.format('<span><img src="{0}" alt="views"><span>{1}</span></span>',t.getHelpTypeImg(),c)).append(KD.format('<span><img src="{0}" alt="views"><span>{1}</span></span>',t.getHelpViewCountImg(),d)).appendTo(u),$('<div class="kd-nlp-search-result-detail-help-desc">').text(s).appendTo(u),u.appendTo(t.middleDetail);var p=$('<div style="text-align: center;">');for(var g in h)if(KD.isRunInForIn(g,h)){var f=h[g],m=t.genUIID(f),v=KD.htmlUtil.encode(f.caption);$(KD.format('<button class="kd-nlp-search-result-detail-action" data-key="{0}" data-type="fastResult.summary.action" data-uiid="{1}" data-title="{2}" data-rowuiid="{3}">',f.key,m,v,n)).text(f.caption).appendTo(p)}p.appendTo(t.bottomDetail),i=!0}return i},hideFormProxy:function(){var e=this,t=e.getFormProxy(),i=t.getHostWindowProxy.call(t);if(i&&KD.isFunction(i.hideWindow))i.hideWindow.call(i,!0);else{var a=t.getPageId.call(t);t&&t.closeWindow.call(t,[{pageId:a}])}},releaseFastResult:function(e){var t=this;t.middleGroup.empty()},releaseAiRec:function(e){var t=this;t.bottomGroup.empty()},releaseSummaryPanel:function(e){var t=this;t.topDetail.empty(),t.middleDetail.empty(),t.bottomDetail.empty()},getHelpTypeImg:function(){var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAMAAAAADbN2wMAAADZUlEQVRoBe1Y224aMRA1qKJEQkJBIC55aPplzV+0j3ls/yL9spKHcBGICKEoEQjoHFfjzu7aa3vZpEHdlcDj8Zy5+W6lHF8N/IeHh2O6vS4Z/X7fVBMN8/k82VCr1aaGQ0S9Xv8h65qeTqc3GaZkWL26urqqGeOj0UgClGlIcKliGiaTSbpNKWLeZbmRHO0tMLY8pnUhig9pJuoc0Xq9Vk9PTwkRK8AaUAImKumUh7gq4P+C1GmlICfH43GY5wBSinbd1VL48vIyD/d3bLDUxcWF6QfmydIMJskEzZ2X5ls7brFYqN1ul5bV9QzA18vaJTL/0arOx7QNA7J4J3HOoFmIUv6F6fdZmhkK98jdBk2HsRwpsW5jWRsOh98YlzBgSyoLxpQ8roHJjAubIh6FeQPMhgs2wOBer8eksq1XplEQQREIebXf75XcX2SbjQ4y8Pz8rB4fH214Ly8xEdIbHaOLKme8s8Sooqk5dgpQA2RoaF+7ZBIRSCEG0QhygiFPUd8fDodfElvR/1kGEosdjZzvNCK+Fs0B5hGtpNdUbllHwkAZqymM0NA2R0bnPGAPYsv0XhJkgDaRWDtGPgg5GAxUt9s1oBgiyAAUNhoNffxpNpsx+rOHLx+60+koRBT6BUcQqjAtF7ThSNBqtVIvLy+SlUsHG9hut2q5XOYqszUGGZjNZopmuA3v5QX1QVHlsB5kwOumEMBSIapJA9bbrJT20LzYecT+NGNP9i1+OBD4ZJwpokXr1ucJeeyVceqAZ74jC8CQ4xOITZkzAgiHehgSrc14xasyUGWgjAwkjnVS4alnSKnrVDp9s5f6nAH4lmCp5C1o+XIg7eUupFLwvdJBB5YQ53EZwLljs9lkXltD8EVlSgsADuAC0W639Y+2Nx0IAgL9Wl+pAUgnaR9XrVZL/8DHSw3elk45HUr9TL9aAGyASzwm44cPD/oIpozvzQI4ux44yzlw1qsQne7LGNLROs5+I3MGcOoVMzqVOYA8X5xnoRx9ugkXQpqon1AhA5/p8W+sGwL/cFGkOaOfoGnPuPc9WbvUOnvABQCfjN+w82T8Z6zz0AEMsKChCzpBx36FAiCDt2yInDA080JLiZU6Q/GQiw6gjOyzg2X0QnQAMlMyg+xUbCl1SN2xeir5KgMFM/AbUOplYyhWXZgAAAAASUVORK5CYII=";return e},getHelpViewCountImg:function(){var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAMAAAAADbN2wMAAAEsklEQVRoBe2ZS2hdRRiAz83N25ImTZqngoIFu7I2NLRYF25EkHZZpaILwYULxW4F3QhupYVSsLSLlpZ2aYsgCN20uLAPs1MoakGTm8S8DG0e5NXvP7n/OGfOzOk9IQqhZ2Du/PO//3/e50ZR3lJSgZGRkXWFBwYGSjFBkf39/dHo6GhMD0qo9Ba0CeOir1QqreFEuWR7JATxCuLZWILOL+vr6y9VJV5D4pbA/2HBn+vUhUql8rlrxpspSaWUpaWlaGpqyshIzutMzwKEUcrMzIzBEvFD03naAJNWDZxhf5NhP0dWpuvr6w91d3cnsmMEYPwaxk9V0G4RfoaxmRdcLMCoSsLblUkHTmacFoQGwd/TgTPMvb29ypNosX5XELEAvr6q1LGxMQUTrUwLQZgYpKOLQGC7KLONK+DtlIHEMNuOM3HKsr2B22PjfTCz8n1m5UUvzUWidBTlfS5e+l1dXRGTNJqbm4vm5+OlkWKrq6sb6uvru60EEwF676B4UAl2K4obGxttVAwjk8IpgohaiGxR11pULpePKdFtQ966fNpH8d+iXPomAiWyTT+7uLj4p/ZztsMsy1dsmZQBm1gd6Evg3rbxFrxA5O+ww1yzcAVYZKDIwP+dgcyVLM5MTEzsWF1dPcGqPkZ9EdQ09R57zWk2tO+FJ6sEDbBTvofCC1nCVdp9DO3F4KqPN2UApS1cZh/Smp3WJ+jiMHASQ6m7VcIAXg+i+I4rLP3W1taora0tWllZiSYnJ30sctOvYGTjBl3lMAbI9b7l5eWffZKdnZ1RU1NTghQ6bDDyDzbMXS5OA143hZSLVle54OSU8xV07eQKZxyNDeDNGR9zFk7O5oyyT2mxAU6hD0D8++JQakYrB3+ocPC/oLTYgHQw0kX+HinBbt0rrjxsQuc0J9whbhUPVN4MsiLI3zDwy9rP0zY3Nz/HhPjLlkkZECJjcpjBumkzZsFE/iszZ6+Px2tAGUnNUbaJK/RbFOe0V1H8Lga8q9jhLbpFBooMFBkoMlBkYFtmIPOwzIqI07o8Pj7+FofpcfiOUkMHakjNAoRr3D8u9/T0fLfZAzdXAHLNwOhZnI8/XYc82yxeriXIfsgNoubP4U8MoPpR5DqKzT1zsw7mlBvmAnfEvcC5OoIBcNc6uLa29gPZ3uEKhfrcdaOOjg7vLV9k5Cor3+fRG1KRwjMqj5hmbzDNfkwRQaQC4FX2PE7/RN3tEwjh5GHV3m6eMyG2GD87Oxu8k2cITvESGSKQ320e8ygQJHP8G7LzR17nRVZehbWWPLyWzk5enb/xpjhv4TY+0iuC18gnwPLoyF3kSVtrycNr62Q63WWBf5TA2R2FGYn9wDcYiZ2Kq6X1PaFdOfdPLZce6M82NDS8zr82qeSm1oCtgPVwgCC+pXq/Xtu8NizrQaq+niXj8g4NvUVtWRsm4xX6R8h6/J+OTVM4MwBlYkRagb+ifkwwiXWjPFvV4rRsUaeYzp8By2GXWWoKwNZAAGVG5jjtF+Dli9dWlPs4+yVOX6bN9QTOHYDPW/mMxzQ5jPED7GJDtLIV74JXqpRpcNPgHnBWyBZ9m+l1y/0ncoO1+C0yUGSgyMB2ysBj1h3DirX3pgoAAAAASUVORK5CYII=";return e},scrollTo:function(e){var t=$(e).get(0);t&&(KD.isFunction(t.scrollIntoViewIfNeeded)?t.scrollIntoViewIfNeeded():KD.isFunction(t.scrollIntoView)&&t.scrollIntoView())},doDebug:function(e){var t=this;KD.delayInvoke(function(e){var t=e.getDebugData();e.setResultValueCore.call(e,t)},800,!1,t)},getDebugData:function(){var e=this,t={searchCondition:{ts:"0",data:[{title:"搜索数据",text:"01",billFormId:"bos_user",typeName:"人员",action:{caption:"查看详情",key:"NLPSearch",args:{type:"User",text:"01",nluText:"01"}}}]},fastResult:{ts:"1600314192505",partUpdate:!1,data:e.getDebugMixData()},aiRec:{ts:"1600314192505",data:[{title:"01",typeId:"SemanticSearch",typeName:"人员",action:{key:"NLPSearch",args:{type:"User",text:"01",nluText:"01",semanticSearch:!0,billFormId:"bos_user",filters:[{field:"number",cp:"like",value:["01"]}]}},summary:{action:[{key:"NLPSearch",args:{type:"User",text:"01",nluText:"01",semanticSearch:!0,billFormId:"bos_user",filters:[{field:"number",cp:"like",value:["01"]}]}}],title:"01"}}]}};return t},getDebugPersonData:function(){var e=[{icon:"https://static.yunzhijia.com/space/c/photo/load?id=5b21e20250f8dd5ce87f5901&spec=80",title:"user01",subTitle:"下一代金蝶云测试2024",typeId:"User",typeName:"人员",action:{caption:"查看详情",key:"ShowBillForm",isKeepOpen:!0,args:{methodParam:["bos_user","168909"]}},summary:{action:[{caption:"查看详情",key:"ShowBillForm",isKeepOpen:"true",args:{methodParam:["bos_user","168909"]}}],icon:"https://static.yunzhijia.com/space/c/photo/load?id=5b21e20250f8dd5ce87f5901&spec=80",title:"user01",fields:[{key:"工号",value:"2563"},{key:"手机",value:"17755556660"},{key:"部门",value:"下一代金蝶云测试2024"},{key:"部门长名称",value:"下一代金蝶云测试2024"}]}},{icon:"http://static.yunzhijia.com/space/c/photo/load?id=5b2a04ca364a0f55c85eea40&spec=80",title:"18177770014",subTitle:"北方工业",typeId:"User",typeName:"人员",action:{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168943"]}},summary:{action:[{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168943"]}}],icon:"http://static.yunzhijia.com/space/c/photo/load?id=5b2a04ca364a0f55c85eea40&spec=80",title:"18177770014",fields:[{key:"工号",value:""},{key:"手机",value:"18177770014"},{key:"部门",value:"北方工业"},{key:"部门长名称",value:"下一代金蝶云测试2024_北方工业"}]}},{icon:"https://static.yunzhijia.com/space/c/photo/load?id=5b28a57b364a0f60a5ba6d6c&spec=80",title:"环球user001",subTitle:"环球集团ISC1",typeId:"User",typeName:"人员",action:{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168935"]}},summary:{action:[{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168935"]}}],icon:"https://static.yunzhijia.com/space/c/photo/load?id=5b28a57b364a0f60a5ba6d6c&spec=80",title:"环球user001",fields:[{key:"工号",value:"212312下次的消费"},{key:"手机",value:"18906191437"},{key:"部门",value:"环球集团ISC1"},{key:"部门长名称",value:"下一代金蝶云测试2024_环球集团ISC1"}]}},{icon:"https://static.yunzhijia.com/space/c/photo/load?id=5b2381e4db5aa609ec4e3b8f&spec=80",title:"环球user01",subTitle:"环球集团ISC1",typeId:"User",typeName:"人员",action:{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168930"]}},summary:{action:[{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168930"]}}],icon:"https://static.yunzhijia.com/space/c/photo/load?id=5b2381e4db5aa609ec4e3b8f&spec=80",title:"环球user01",fields:[{key:"工号",value:"303"},{key:"手机",value:"18906151705"},{key:"部门",value:"环球集团ISC1"},{key:"部门长名称",value:"下一代金蝶云测试2024_环球集团ISC1"}]}},{icon:"http://static.yunzhijia.com/space/c/photo/load?id=5b2383b99b521a106cfc6b1e&spec=80",title:"18177770013",subTitle:"北方工业",typeId:"User",typeName:"人员",action:{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168931"]}},summary:{action:[{caption:"查看详情",key:"ShowBillForm",args:{methodParam:["bos_user","168931"]}}],icon:"http://static.yunzhijia.com/space/c/photo/load?id=5b2383b99b521a106cfc6b1e&spec=80",title:"18177770013",fields:[{key:"工号",value:""},{key:"手机",value:"18177770013"},{key:"部门",value:"北方工业"},{key:"部门长名称",value:"下一代金蝶云测试2024_北方工业"}]}}];return e},getDebugHelpData:function(){var e=[{title:"云之家（苍穹-云之家）集成使用手册，云之家（苍穹-云之家）集成使用手册作者：孙文 2021/01/071. 操作前准备集成方案获取云之家（苍穹-云之家）集成使用手册作者：孙文 2021/01/071. 操作前准备集成方案获取",typeId:"Help",typeName:"帮助",action:{caption:"查看帮助",key:"OpenUrl",args:["","https://club.kdcloud.com/article/155632597341413120?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|2"]},summary:{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/155632597341413120?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|2"]}],type:"Help",title:"云之家（苍穹-云之家）集成使用手册，云之家（苍穹-云之家）集成使用手册作者：孙文 2021/01/071. 操作前准备集成方案获取云之家（苍穹-云之家）集成使用手册作者：孙文 2021/01/071. 操作前准备集成方案获取",desc:"云之家（苍穹-云之家）集成使用手册作者：孙文 2021/01/071. 操作前准备集成方案获取：https://pan.yunzhijia.com/s/MTE0Nzk4NSxkMzc2#/ 来自：云之家企业云盘 密码请查看云之家群“苍穹集成云产品交流群”公告1.1云之家连接配置1.1.1企业ID及通讯录同步密钥上述内容请在云之家所建团队中查询，具体路径为：企业ID：团队概况-&gt;团队总览-&gt;注册EID通讯录同步密钥：系统设置-&gt;系统集成-&gt;可编辑密钥1.1.2设置对应数据源将上述连接配置作为导入服务流程中所对应的云之家所对应数据源的连接配置2. 服务流程解析2.1组织初始化2.1.1节点解析可以通过修改“数据获取节点”中过滤条件，例如仅过滤长编码以“00!Org-00022”开头的，具体信息可以去对应组织结构表中查询T_ORG_STRUCTURE@BASEDATA，查询方式如下，通过组织编码（fnumber）到t_org_org表中搜索相应组织主键（fid），再通过查询出的组织（id）到T_ORG_STRUCTURE表中通过搜索相应组织长编码（flongnumber）；格式如下：select fid from t_org_org where fnumber =&#39; aaa &#39;;select flongnumber from T_ORG_STRUCTURE where forgid =&#39;???&#39;;注意：1. 预置的标准方案默认同步“非封存的行政组织”单元，请不要修改“fviewid = 1（行政组织视图）”及“fisfreeze = 0（非封存）”条件。2. 预置服务流程数据获取节点开头已默认为“//”,请针对不同需求进行实际修改；3. 请修改预置流程通知节点中对应消息接收人。对应最新的行政组织长名称，存在于多语言表中，因此需要通过脚本查询最新的长名称，如下：var sql = &quot;SELECT ffullname FROM T_ORG_STRUCTURE_L@BASEDATA WHERE fid = ? and flocaleid = &#39;zh_CN&#39;&quot;;var ffullname = query_value (tar, sql, [ORG_ID_LIST[i]], [BIGINT]);其余即为循环逐条同步，同步成功则会在ID映射表中新建对应的源/目标ID映射关系，其中调用了通过长名称查询云之家组织ID的接口（通过集成云外部系统API实现）将流程发布后即可立即执行，实现组织同步初始化（苍穹-云之家）执行后可在流程实例变量中查看各信息：2.2组织即时同步2.2.1节点解析通过orgId查询组织结构表中主键fid及长名称ffullnamevar sql = &quot;SELECT fid FROM T_ORG_STRUCTURE@BASEDATA WHERE forgid = ? and fviewid = 1 and fisfreeze = 0&quot;;FID = query_value (tar, sql, [DDBF[0].id], [BIGINT]);var sql = &quot;SELECT ffullname FROM T_ORG_STRUCTURE_L@BASEDATA WHERE fid = ? and flocaleid = &#39;zh_CN&#39;&quot;;FFULLNAME = query_value (tar, sql, [FID], [BIGINT]);通过源单ID去“云之家组织ID映射表列表 中查询对应云之家组织ID，存在则更新即可 ，不存在则走新建接口；对应更新操作接口实现：2.3人员初始化及即时同步2.3.1节点解析通过源系统人员信息，构造云之家新增人员接口所需内容（目前云之家接口可能有问题，邮箱不能正常同步，经反馈得知不支持同时传手机号及邮箱，如有类似需求，请联系云之家相应人员询问）注意：1. 目前预置人员初始化服务流程中，数据获取节点已设置过滤条件为固定值请修改为现场实际值，全量同步请删除对应过滤条件；2. 目前预置流程中，人员职位只会同步苍穹人员部门信息分录的首行中的职位信息，针对客户不同需求可以通过修改对应脚本来取特定条件分录，脚本修改可以联系集成服务云部门；3. 请修改预置流程通知节点中对应消息接收人。集成服务云使用指南：https://club.kdcloud.com/article/45312 集成服务云新特性发布汇总：https://club.kdcloud.com/article/146134 集成云常见问题处理合集: https://vip.kingdee.com/article/45556",url:"https://club.kdcloud.com/article/155632597341413120?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|2",updateTime:"2021-03-05",viewCount:39,helpType:"文章"}},{icon:null,title:"销售发票保存时报错：“发票不符合规则（蓝字发票数量大于等于0金额大于0、红字发票数量小于等于0金额小于0）",subTitle:null,typeId:"Help",subTitle:"帮助类型",typeName:"帮助",action:{caption:"查看帮助",key:"OpenUrl",args:{methodParam:["https://vip.kingdee.com/questions/14181/answers/19541?channel_level=金蝶云星空|私有云系列|搜索&amp;search_action=0|639|1|3"]}},summary:{title:"销售发票保存时报错：“发票不符合规则（蓝字发票数量大于等于0金额大于0、红字发票数量小于等于0金额小于0）",desc:"原因分析：为发票分录行的数量合计（１＋（－１））为０，导致整单校验发票数量报错，蓝字发票上整单数量和金额都应当大于0才能保存。解决方法：重新合并下推应收单使发票整单数量大于０，金额大于０即可。",url:"https://vip.kingdee.com/questions/14181/answers/19541?channel_level=金蝶云星空|私有云系列|搜索&amp;search_action=0|639|1|3",updateTime:"2019-06-28 19:11:48",viewCount:524,helpType:"问答",action:[{caption:"查看帮助",key:"OpenUrl",args:{methodParam:["https://vip.kingdee.com/questions/14181/answers/19541?channel_level=金蝶云星空|私有云系列|搜索&amp;search_action=0|639|1|3"]}}],type:"Help"}},{title:"云之家预览. 云之家预览配置1、登录苍穹进入云之家预览配置页面，应用—配置工具—参数配置—系统参数—公共参数",typeId:"Help",typeName:"帮助",action:{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/91928155694641152?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|3"]},summary:{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/91928155694641152?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|3"]}],type:"Help",title:"云之家预览",desc:"一、云之家预览配置1、登录苍穹进入云之家预览配置页面，应用—配置工具—参数配置—系统参数—公共参数2、输入相应参数—确认—保存。云之家正式url：http://api.kingdee.com二、云之家参数获取正式申请应用的开放平台地址是：http://cloud.kingdee.com/kae1、申请应用参考：http://cloud.kingdee.com/help/document/detail?item=267&amp;doc=1868 （1）注册用户（2）登录金蝶云开放平台（3）进入API 市场—进入API市场—我的应用—新建应用（4）如图应用ID和应用SECRET即为client_id和client_secret（5）查看账号信息，如图所示账号id即为uid（6）用刚创建的应用订阅服务：‘云通行证-授权认证’‘金蝶云盘’‘云通行证用户服务’3个服务2、注册企业参考：https://cloud.kingdee.com/help/document/detail?item=140&amp;doc=1823 （1）进入企业账号中心（2）注册企业（3）点击需要查找的企业名字（4）在地址栏即可找到tid的数值，如下图红框所示数字3、获取tidsecret（1）进入刚创建的应用—查看订阅服务‘云通行证-授权认证’（2）接口管理、找到get请求方式auth/user/access_token的接口（3）调试API（4）进入应用请求调试（5）调试的时候，接口参数填入如图参数client_id、client_secret、username、password参数值分别为上面步骤获取到的应用id、应用secret、注册的账号密码；然后点击底端的发送请求；获取如图结果的access_token值（6）进入刚创建的应用—查看订阅服务‘云通行证用户服务’（7）接口管理、找到passport/user/orgs的接口（8）调试API、并进入应用请求调试界面（9）调试的时候，接口参数填入如图参数access_token，参数值为第5步获取到的access_token的值然后点击底端的发送请求；在结果中找到tid所在分段的secret的值即为该tid的tidsecret",url:"https://club.kdcloud.com/article/91928155694641152?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|3",updateTime:"2020-09-15",viewCount:194,helpType:"文章"}},{title:"云之家客服电话, 【说明】云之家热线电话：4008308110, 1【说明】云之家热线电话：4008308110",typeId:"Help",typeName:"帮助",action:{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172548000774/answers/136127212561660947?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|1"]},summary:{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172548000774/answers/136127212561660947?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|1"]}],type:"Help",title:"云之家客服电话",desc:"【说明】云之家热线电话：4008308110",url:"https://club.kdcloud.com/questions/136127172548000774/answers/136127212561660947?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|1",updateTime:"2020-12-30",viewCount:38,helpType:"问答"}},{title:"云之家配置信息-创建群组 -- MC进行配置[图片]需要配置云之家创建群聊接口的URL：参数名：YunZhiJiaCreateGroupURL参数值",typeId:"Help",typeName:"帮助",action:{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/190720/answers/221203?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|4"]},summary:{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/190720/answers/221203?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|4"]}],type:"Help",title:"云之家配置信息-创建群组",desc:"1、MC进行配置[图片]需要配置云之家创建群聊接口的URL：参数名：YunZhiJiaCreateGroupURL参数值：/linkspace/open/imsdk/group/create2、启用公有云[图片]2.1、数据获取：先网页端登录“云之家”，找到“管理中心”2.2、配置eid、工作圈名称[图片]2.3、Keyfile获取[图片]2.4、通讯地址：https://www.yunzhijia.com3、“系统参数”相关配置与上述获取数据一致[图片]4、确定用户是否已经同步到苍穹和云之家5、重启服务",url:"https://club.kdcloud.com/questions/190720/answers/221203?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|4",updateTime:"2020-04-08",viewCount:154,helpType:"问答"}},{title:"怎么注销云平台/云之家账号 【方法】客户拨打云之家热线：4008308110，告知需要注销账号",typeId:"Help",typeName:"帮助",action:{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446342/answers/136127212544883716?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|5"]},summary:{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446342/answers/136127212544883716?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|5"]}],type:"Help",title:"怎么注销云平台/云之家账号",desc:"【方法】客户拨打云之家热线：4008308110，告知需要注销账号，客服人员会给客户推送一个验证码，将验证码告知客服即可申请注销。说明：该账号必须已经不在任何团队里（可以先联系管理员操作该账号离职，或者该账号自己登陆云之家申请退出团队）。",url:"https://club.kdcloud.com/questions/136127172514446342/answers/136127212544883716?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|5",updateTime:"2020-12-30",viewCount:46,helpType:"问答"}}];return e},getDebugMixData:function(){for(var e=this,t=[],i=e.getDebugPersonData(),a=e.getDebugHelpData(),n=0;10>n;n++){var o=i[n],r=a[n];!KD.isEmpty(o)&&t.push(o),!KD.isEmpty(r)&&t.push(r)}return t}}),KDControlFactoryProxy.registerType("resultpanel_nlp_search",KDNLPSearchResultPanelProxy),define("KDNLPSearchResultPanelProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDNLPSearchResultPanelProxy}}(this)),KDNLPSearchHelpResultProxy=KD.extend(KDControlProxy,{createControl:function(e){var t=this;return t.__pageSize=20,t.__curPageIndex=0,t.__helpDetalSummCls=".kd-nlp-search-result-detail-help-summ",t.__helpMoreCls=".kd-nlp-search-help-morelink",t.__helpRowCls=".kd-nlp-search-result-detail-help-title span",t.__helpRowCls_click="click",t.dataMap={},KDNLPSearchHelpResultProxy.superclass.createControl.call(t,e),t.groupsPanel=$("<div class='kd-nlp-search-help-groups'>").appendTo(t.el).hide(),t.detailPanel=$("<div class='kd-nlp-search-help-detail'>").appendTo(t.el),t.moreLink=$("<div class='kd-nlp-search-help-morelink'>"),t.el.addClass("kd-nlp-search-help-panel").css({height:"auto"}),t.el.undelegate(t.__helpRowCls,t.__helpRowCls_click).delegate(t.__helpRowCls,t.__helpRowCls_click,function(e){t.beginSingleClicking.call(t)&&t.onHelpItemClick.call(t,e)}),t.el.undelegate(t.__helpMoreCls,"click").delegate(t.__helpMoreCls,"click",function(e){t.beginSingleClicking.call(t)&&t.renderFastResult_helpPage.call(t)}),t.el},genUIID:function(e){var t=(e||{}).uiid;return KD.isEmpty(t)&&(t=(e||{}).uiid=KD.format("U{0}",KD.Guid.NewGuid().ToString().replace(/\-/g,""))),t},loadConfig:function(e){var t=this;KDNLPSearchHelpResultProxy.superclass.loadConfig.call(t,e),KD.isDebug()&&t.setResultValue(t.getDebugDataCore()),t.detailPanel.scroll(function(){t.moreLink.parent().length>0&&t.checkNeedMore(t.detailPanel,t.moreLink,function(e){e&&t.renderFastResult_helpPage.call(t)})})},setResultValue:function(e){var t=this;t.resultValue=KD.isArray(e)?e[0]:e,t.dataMap={},t.detailPanel.empty(),$(KD.format('<div class="{0}"></div>',t.__helpDetalSummCls.substr(1))).appendTo(t.detailPanel),t.renderFastResult_helpPage()},renderFastResult_helpPage:function(){var e=this,t=!0,i=$(e.__helpDetalSummCls,e.detailPanel),a=e.resultValue.content||[],n=e.__curPageIndex*e.__pageSize,o=n+e.__pageSize;if(n>=a.length)return t=!1,void e.moreLink.remove();a.length<=o&&(o=a.length,t=!1);for(var r=n;o>r;r++){var s=a[r];s.rowSeq=r+1;var l=e.renderFastResult_help(s);l&&l.appendTo&&l.appendTo(i)}e.__curPageIndex+=1,t&&e.moreLink.remove().appendTo(i)},renderFastResult_help:function(e){var t=this,i=void 0,a=KD.equalsIgnoreCase((e||{}).type,"Help");if(a){var n=t.genUIID(e),o=e.summary||e||{},r=(o.icon,o.rowSeq),s=KD.htmlUtil.decode(o.title),l=KD.htmlUtil.decode(o.desc||""),d=(KD.urlEncode(o.url||""),o.updateTime||""),c=o.viewCount||0,h=o.helpTypeIcon,u=KD.htmlUtil.decode(o.helpType||"");o.fields||[],o.action||[];t.dataMap[n]=e;var p=$(KD.format('<div tabindex="{0}" hidefocus="true" class="kd-nlp-search-help-detail-row" >',r)),g=$('<div class="kd-nlp-search-result-detail-help-title" >').appendTo(p);KD.isDebug()&&$('<span style="font-size:0.5em;margin-right:15px;">').text(r).attr("data-uiid",n).appendTo(g),$("<span>").text(KD.format("{0}",s)).attr("data-uiid",n).appendTo(g),$('<div class="kd-nlp-search-result-detail-help-desc">').text(l).appendTo(p),$('<div class="kd-nlp-search-result-detail-help-subtitle">').append(KD.format("<span>{0}</span>",KD.format(ResManager.LoadKDString("更新于 {0}","0141072000004022"),d))).append(KD.format('<span><img src="{0}" alt="views"><span>{1}</span></span>',t.getHelpTypeImg(u,h),u)).append(KD.format('<span><img src="{0}" alt="views"><span>{1}</span></span>',t.getHelpViewCountImg(),c)).appendTo(p),i=p}return i},beginSingleClicking:function(){var e=this,t=!e.isSingleClicking;return t&&(e.isSingleClicking=!0,KD.delayInvoke(function(e){e.isSingleClicking=!1},1300,!0,e)),t},getHelpTypeImg:function(e,t){var i=t||"",a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAMAAAAADbN2wMAAADfElEQVRoBe2ZT2sTURDAkzatGkiElgST4kXoQTxJPVTRD6AHxaPQ2ote9Av0Jr35BfSiF21BKV70oB9AQYQWTyLSozSxLQbc2GjS1PibmLfsbvftnyYpsbwHz5k3b/7vZHa6JhKalRT6+vp6S+DExERS4a4LuVRrSCFeqL1wMZZKpW0XQXtQnrRarRGFpxS3EFCljgmtce2FLdo10k6VaFFeBmmUHMf2qScC9WQy+ULM494XdiPIzQG421OB+D9bLBaXxDee/QqFMSV4J6bEHgG59FtKoCdp9TNg0wbdAindwdkSaR0Cv86ustvdwA7CDymXy5f96INJs3+h4h6/0hpgjTjXKKFFquFlFLctyxqvVqvzyE0hN4ncSSXnNRCYwNHR0WIulytTw69RpM2jKlMxYjc+ZTEINhqNElEmUB7E5rqLXaku6QgHYyBCkiKybGxsnOIBV+SFw16IKPavQypmEVZ4B/6itn9SNRnOR4XG+QnnOSCg9aNDy4Lbz9NZpnJv1iHPgLfZfaU6pJOuZjKZ+9ls9nuU+Km+a8jNIjcJv3TTtJLzGvCWqZTlaqFQOA+U15e96KgzKFy0CQ7EWaahBpQcBt7wbryytbVVkK6q6H5wXwb8FOloTgP2r0/H3C3dGAjNoEmRSVFoBnrHIC96eWezKzIARNXsGh1FgRKkudEsWzvAOrAEnKfZCTHJfL8M7wV4x6EPQRtRcgKdvUjbTRH8g6AlAuDHRTGrPVEIjfWbswVdJo5jbUrnH6cBJz0U5x2w/X/9dRIakmEwGTgEGXD1CWc8zqbkpAtOf5CG9Zn9lr1Eg3oHjL1oCxcRmmFfYp+WXqRTous9WoGgAHRGCKzM3T0CeuTHg8O3oS/gaMHvPoh2IAF4HKgMDw/fEdru7u5DwJjnPtZRF4DrXRZLYzjzGI4/D2frjqPvM2N37oVLmwDCc9RfDvME+pvfcO3mCYTnqL8c5gn0N7/h2rWzUJAos0yK/0bJ1mo1+YQsI8IZ9lnwaeahaaCvXhkCWe+BH+D/yP4EXkmn0xYfHC3wJrRYy9dQLA0a5s3NzRPNZvOBXKdSqbv5fP6bhrUrsjaA/UyjHk9ekdEbQiPrzwBXPfexjrphThtALO0dZhw9wsh8juMtnL/Jud0kwOUbxFPojxm1VzjX96P/wGX4hjEn+8ANG4MmA9Ez8BeZ92w5Gm065gAAAABJRU5ErkJggg==";return KD.isEmpty(t)&&(i="问答"==e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAMAAAAADbN2wMAAAFg0lEQVRoBe2ZTWhcVRSAZzJjIAmJqZhJMgPduGtddlHaKPhbsVgaMaBQV65UhBSk7tzoxiI0IHRXFP/QVUUopooVpJFCdSNk50YhE9IQE9D8QCYZvzOd8zjvvnvfe5O0pcg8GM655/+c+/POu1MoBJ6i0hcWFpqCF4vFuWq1OtFiKLFWqxUFhznZoxpCVLzZbF5uDer1+nWINyFMC9MKFWCeVpOqmQ5F2mq0nAuht7e3RjRfWGbBDhQvqwMl6DiCwggyI6kUJKqCyKRZ0mJEJVRhMnlPmPpTZ8qPFJTBDL2ruA/mCgmv8xh61GfgPqDFclhaWjrWaDTmbFxaTqVFVWKdzbrCIiTl5CklFCCeUKI7BxhrKK/lAcKnSrAhWFz5GtKkErKgKrzuE8TzmkuPqqRrxRXQsYanHgr9/f0HlOlCFRZ65EGFCGObiunOuobwU8q7P2EiBV+Ya2trBzY2NmZI7Shbo4rMr/wusUU+98lbWtABtZq1q8sq+XCZFJ7wNKuSb0MoLw+0MyzysQykFOvr63+7hlwl5ZPlRbKMLVpK2KB0D6hMtO6EgPEbylA4ODj4sOIuxNAbLs0swRYr5gDvdVdhaGhoxaV1Mo45IKInfMpSOsrxE/MzKnzwF2VrBrbnNWsjNgfKCCgqOwipwAxBnrUCXgciQC1LRBoddFbJxX2GXZnu+H9cgeAqsjmzms4wfo3fEVZXnVVzg8Ntenh4eNXK+fBUBxi+jsHjPkWllcvl46Ojo7/o2IVeB6urq8Oc/5nRqTEyusoGe07HFsaOCmHIBuvEeFvnBNnOWsOKJzLY6zEhBn3limVAFKfVs4WU4Et5J+iPrlxem4nH14zFMsCBbSnUwEUMv6kDC33ZDgwMPGRXVywD6q/9SmQnZFwEyOz9SLCNSHNgaTEHlpEHJ9oLrhxBHrW0fTnY2tpKtHdkNX7HHOzs7HxsjbXx3yxtzxksLi4eohyPWWNt/JKluQ5i71MVZLV8jcGXZLyysjLEavtud3d3XvkWsqNj3V5smYqgu/SoKYE2E3LWqOLItj6udSzQzUCWXmyZ5TUuxoh+QqB9vJFRgnkMH7KCWXioN01kIIaI5LCbSZoD5Mu+xld0vBlYY8zJj4yftDTBCUBamimMf+PyuuNuBboVuJcVyNzGWcFIG8Kh9Rbb+nFg4oXu05cjANmfgR/t9xjoOAEcl3jxfAic9gW3VxrJzIyPj78N3OnERu4EpBfe3NycI/COXhGdBCOyJDDf19c3ETr5XXveV40rxDK5IL323Q5e/OLjsPgSn24cvnHmDPAqk0vOYz5lH40KbhDEtz09Pd+D/4mM9CMH6W+eZXwKvN+n56Mhn2hPXLnUBELvYddIe/wOHfj5AC9Gxu45CB/EiOFB6o1kMAGm8AzV+ixs9zaHKt3ii+mRSqXyb5as5S8vLw9ub2//gY+KpftwfLzKaRXrRFUubQ/I53bmg/EXOg1ejI6MjPzDMjuV6eC2QDCWtASO5DE+NjZ2M4+cT4Zrgd99dA8tGEswAaY2cevoMSzHXuvPNh8vi8bF4itZMsJPiyWYAIEl7mXzOMsrwx6b5Lsx9gkX0k2LJbiJ25f4t8g+tT2QG4uQYx+dt/jzHKmyIRNf1T55gm/wvVSxFxJWLhicKFClKYQvWwUfzlJ4mquVT+DVLB/n64yl73lQ6QSvaF44FQpeDGRWb79/UOSN0ifnu9By5TITEAUqKA3cFWD0B6Fr6E6OmbmrNHYngZmNXa4ENLh2Q/fV3UpEAqeRezlvIydxdZSAJiJQlhanyHmSSb0Gtjo+nKDnSqXSubSrYp+e0vacgBpQ2D61TjJ+ht9BEqsSXOsuFVwuz+W98he/HzhVrqRtTGS6T7cC96oC/wF3z1bJsDPgGgAAAABJRU5ErkJggg==":"文章"==e?a:"课程"==e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAMAAAAADbN2wMAAADZUlEQVRoBe1Y224aMRA1qKJEQkJBIC55aPplzV+0j3ls/yL9spKHcBGICKEoEQjoHFfjzu7aa3vZpEHdlcDj8Zy5+W6lHF8N/IeHh2O6vS4Z/X7fVBMN8/k82VCr1aaGQ0S9Xv8h65qeTqc3GaZkWL26urqqGeOj0UgClGlIcKliGiaTSbpNKWLeZbmRHO0tMLY8pnUhig9pJuoc0Xq9Vk9PTwkRK8AaUAImKumUh7gq4P+C1GmlICfH43GY5wBSinbd1VL48vIyD/d3bLDUxcWF6QfmydIMJskEzZ2X5ls7brFYqN1ul5bV9QzA18vaJTL/0arOx7QNA7J4J3HOoFmIUv6F6fdZmhkK98jdBk2HsRwpsW5jWRsOh98YlzBgSyoLxpQ8roHJjAubIh6FeQPMhgs2wOBer8eksq1XplEQQREIebXf75XcX2SbjQ4y8Pz8rB4fH214Ly8xEdIbHaOLKme8s8Sooqk5dgpQA2RoaF+7ZBIRSCEG0QhygiFPUd8fDodfElvR/1kGEosdjZzvNCK+Fs0B5hGtpNdUbllHwkAZqymM0NA2R0bnPGAPYsv0XhJkgDaRWDtGPgg5GAxUt9s1oBgiyAAUNhoNffxpNpsx+rOHLx+60+koRBT6BUcQqjAtF7ThSNBqtVIvLy+SlUsHG9hut2q5XOYqszUGGZjNZopmuA3v5QX1QVHlsB5kwOumEMBSIapJA9bbrJT20LzYecT+NGNP9i1+OBD4ZJwpokXr1ucJeeyVceqAZ74jC8CQ4xOITZkzAgiHehgSrc14xasyUGWgjAwkjnVS4alnSKnrVDp9s5f6nAH4lmCp5C1o+XIg7eUupFLwvdJBB5YQ53EZwLljs9lkXltD8EVlSgsADuAC0W639Y+2Nx0IAgL9Wl+pAUgnaR9XrVZL/8DHSw3elk45HUr9TL9aAGyASzwm44cPD/oIpozvzQI4ux44yzlw1qsQne7LGNLROs5+I3MGcOoVMzqVOYA8X5xnoRx9ugkXQpqon1AhA5/p8W+sGwL/cFGkOaOfoGnPuPc9WbvUOnvABQCfjN+w82T8Z6zz0AEMsKChCzpBx36FAiCDt2yInDA080JLiZU6Q/GQiw6gjOyzg2X0QnQAMlMyg+xUbCl1SN2xeir5KgMFM/AbUOplYyhWXZgAAAAASUVORK5CYII=":a),i},getHelpViewCountImg:function(){var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAMAAAAADbN2wMAAAEsklEQVRoBe2ZS2hdRRiAz83N25ImTZqngoIFu7I2NLRYF25EkHZZpaILwYULxW4F3QhupYVSsLSLlpZ2aYsgCN20uLAPs1MoakGTm8S8DG0e5NXvP7n/OGfOzOk9IQqhZ2Du/PO//3/e50ZR3lJSgZGRkXWFBwYGSjFBkf39/dHo6GhMD0qo9Ba0CeOir1QqreFEuWR7JATxCuLZWILOL+vr6y9VJV5D4pbA/2HBn+vUhUql8rlrxpspSaWUpaWlaGpqyshIzutMzwKEUcrMzIzBEvFD03naAJNWDZxhf5NhP0dWpuvr6w91d3cnsmMEYPwaxk9V0G4RfoaxmRdcLMCoSsLblUkHTmacFoQGwd/TgTPMvb29ypNosX5XELEAvr6q1LGxMQUTrUwLQZgYpKOLQGC7KLONK+DtlIHEMNuOM3HKsr2B22PjfTCz8n1m5UUvzUWidBTlfS5e+l1dXRGTNJqbm4vm5+OlkWKrq6sb6uvru60EEwF676B4UAl2K4obGxttVAwjk8IpgohaiGxR11pULpePKdFtQ966fNpH8d+iXPomAiWyTT+7uLj4p/ZztsMsy1dsmZQBm1gd6Evg3rbxFrxA5O+ww1yzcAVYZKDIwP+dgcyVLM5MTEzsWF1dPcGqPkZ9EdQ09R57zWk2tO+FJ6sEDbBTvofCC1nCVdp9DO3F4KqPN2UApS1cZh/Smp3WJ+jiMHASQ6m7VcIAXg+i+I4rLP3W1taora0tWllZiSYnJ30sctOvYGTjBl3lMAbI9b7l5eWffZKdnZ1RU1NTghQ6bDDyDzbMXS5OA143hZSLVle54OSU8xV07eQKZxyNDeDNGR9zFk7O5oyyT2mxAU6hD0D8++JQakYrB3+ocPC/oLTYgHQw0kX+HinBbt0rrjxsQuc0J9whbhUPVN4MsiLI3zDwy9rP0zY3Nz/HhPjLlkkZECJjcpjBumkzZsFE/iszZ6+Px2tAGUnNUbaJK/RbFOe0V1H8Lga8q9jhLbpFBooMFBkoMlBkYFtmIPOwzIqI07o8Pj7+FofpcfiOUkMHakjNAoRr3D8u9/T0fLfZAzdXAHLNwOhZnI8/XYc82yxeriXIfsgNoubP4U8MoPpR5DqKzT1zsw7mlBvmAnfEvcC5OoIBcNc6uLa29gPZ3uEKhfrcdaOOjg7vLV9k5Cor3+fRG1KRwjMqj5hmbzDNfkwRQaQC4FX2PE7/RN3tEwjh5GHV3m6eMyG2GD87Oxu8k2cITvESGSKQ320e8ygQJHP8G7LzR17nRVZehbWWPLyWzk5enb/xpjhv4TY+0iuC18gnwPLoyF3kSVtrycNr62Q63WWBf5TA2R2FGYn9wDcYiZ2Kq6X1PaFdOfdPLZce6M82NDS8zr82qeSm1oCtgPVwgCC+pXq/Xtu8NizrQaq+niXj8g4NvUVtWRsm4xX6R8h6/J+OTVM4MwBlYkRagb+ifkwwiXWjPFvV4rRsUaeYzp8By2GXWWoKwNZAAGVG5jjtF+Dli9dWlPs4+yVOX6bN9QTOHYDPW/mMxzQ5jPED7GJDtLIV74JXqpRpcNPgHnBWyBZ9m+l1y/0ncoO1+C0yUGSgyMB2ysBj1h3DirX3pgoAAAAASUVORK5CYII=";return e},onHelpItemClick:function(e){var t=this,i=($(e.currentTarget).data()||{}).uiid||"",a=t.dataMap[i]||{},n=a.url||"",o=a.action;if(KD.isEmpty(n)&&KD.isEmpty(o))return void KD.writeLog("helpresult_nlp_search",KD.format("url and action of {0} is all empty. priority: url>action>log.",a.title),!0);if(KD.isEmpty(n)){if(!KD.isEmpty(o))for(var r in o)KD.isRunInForIn(r,o)&&t.onItemClick(o[r])}else window.open(KD.urlEncode(n),"_blank")},onItemClick:function(e){var t=this,i=e.key,a=e.args||{};t.fireCustomEvent(t.key,i,a)},fireCustomEvent:function(e,t,i){var a=this,n=a.getFormProxy(),o=KD.isString(i)?i:KD.stringify(i);n&&n.fireCustomEvents.call(n,e,t,o)},release:function(){var e=this;try{e.el.undelegate(e.__helpRowCls,e.__helpRowCls_click),e.el.undelegate(e.__helpMoreCls,"click"),e.detailPanel.off("mouseenter"),e.detailPanel=void 0,e.groupsPanel=void 0,e.moreLink=void 0,e.resultValue={},e.dataMap={}}catch(t){}},getDebugData:function(){var e={key:"Catalog",data:[this.getDebugDataCore()],partUpdate:!1,ts:"1615188168612"};return e},getDebugDataCore:function(){for(var e=this,t=100,i={name:"帮助",type:"Help",count:t,content:[]},a=e.getDebugDataContent(),n=0;t>n;n++)i.content.push(a[n]);return i},checkNeedMore:function(e,t,i){var a=e.offset().top,n=a+e.height(),o=t.offset().top,r=o>a&&n>o;KD.isFunction(i)&&(KD.isDebug()&&KD.writeLog("checkNeedMore",KD.format("target is {0}. target-Y = {1}, visibleTop = {2},visibleBottom = {3} ",r,o,a,n),!0),
i(r))},getDebugDataContent:function(){var e=[{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172548000774/answers/136127212561660947?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|1"]}],type:"Help",title:"云之家客服电话",desc:"【说明】云之家热线电话：4008308110",url:"https://club.kdcloud.com/questions/136127172548000774/answers/136127212561660947?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|1",updateTime:"2020-12-30",viewCount:38,helpType:"课程",helpTypeIcon:"../images/biz/default/MainConsole/person_default_headimage.png"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/155632597341413120?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|2"]}],type:"Help",title:"云之家（苍穹-云之家）集成使用手册",desc:"云之家（苍穹-云之家）集成使用手册作者：孙文 2021/01/071. 操作前准备集成方案获取：https://pan.yunzhijia.com/s/MTE0Nzk4NSxkMzc2#/ 来自：云之家企业云盘 密码请查看云之家群“苍穹集成云产品交流群”公告1.1云之家连接配置1.1.1企业ID及通讯录同步密钥上述内容请在云之家所建团队中查询，具体路径为：企业ID：团队概况-&gt;团队总览-&gt;注册EID通讯录同步密钥：系统设置-&gt;系统集成-&gt;可编辑密钥1.1.2设置对应数据源将上述连接配置作为导入服务流程中所对应的云之家所对应数据源的连接配置2. 服务流程解析2.1组织初始化2.1.1节点解析可以通过修改“数据获取节点”中过滤条件，例如仅过滤长编码以“00!Org-00022”开头的，具体信息可以去对应组织结构表中查询T_ORG_STRUCTURE@BASEDATA，查询方式如下，通过组织编码（fnumber）到t_org_org表中搜索相应组织主键（fid），再通过查询出的组织（id）到T_ORG_STRUCTURE表中通过搜索相应组织长编码（flongnumber）；格式如下：select fid from t_org_org where fnumber =&#39; aaa &#39;;select flongnumber from T_ORG_STRUCTURE where forgid =&#39;???&#39;;注意：1. 预置的标准方案默认同步“非封存的行政组织”单元，请不要修改“fviewid = 1（行政组织视图）”及“fisfreeze = 0（非封存）”条件。2. 预置服务流程数据获取节点开头已默认为“//”,请针对不同需求进行实际修改；3. 请修改预置流程通知节点中对应消息接收人。对应最新的行政组织长名称，存在于多语言表中，因此需要通过脚本查询最新的长名称，如下：var sql = &quot;SELECT ffullname FROM T_ORG_STRUCTURE_L@BASEDATA WHERE fid = ? and flocaleid = &#39;zh_CN&#39;&quot;;var ffullname = query_value (tar, sql, [ORG_ID_LIST[i]], [BIGINT]);其余即为循环逐条同步，同步成功则会在ID映射表中新建对应的源/目标ID映射关系，其中调用了通过长名称查询云之家组织ID的接口（通过集成云外部系统API实现）将流程发布后即可立即执行，实现组织同步初始化（苍穹-云之家）执行后可在流程实例变量中查看各信息：2.2组织即时同步2.2.1节点解析通过orgId查询组织结构表中主键fid及长名称ffullnamevar sql = &quot;SELECT fid FROM T_ORG_STRUCTURE@BASEDATA WHERE forgid = ? and fviewid = 1 and fisfreeze = 0&quot;;FID = query_value (tar, sql, [DDBF[0].id], [BIGINT]);var sql = &quot;SELECT ffullname FROM T_ORG_STRUCTURE_L@BASEDATA WHERE fid = ? and flocaleid = &#39;zh_CN&#39;&quot;;FFULLNAME = query_value (tar, sql, [FID], [BIGINT]);通过源单ID去“云之家组织ID映射表列表 中查询对应云之家组织ID，存在则更新即可 ，不存在则走新建接口；对应更新操作接口实现：2.3人员初始化及即时同步2.3.1节点解析通过源系统人员信息，构造云之家新增人员接口所需内容（目前云之家接口可能有问题，邮箱不能正常同步，经反馈得知不支持同时传手机号及邮箱，如有类似需求，请联系云之家相应人员询问）注意：1. 目前预置人员初始化服务流程中，数据获取节点已设置过滤条件为固定值请修改为现场实际值，全量同步请删除对应过滤条件；2. 目前预置流程中，人员职位只会同步苍穹人员部门信息分录的首行中的职位信息，针对客户不同需求可以通过修改对应脚本来取特定条件分录，脚本修改可以联系集成服务云部门；3. 请修改预置流程通知节点中对应消息接收人。集成服务云使用指南：https://club.kdcloud.com/article/45312 集成服务云新特性发布汇总：https://club.kdcloud.com/article/146134 集成云常见问题处理合集: https://vip.kingdee.com/article/45556",updateTime:"2021-03-05",viewCount:40,helpType:"文章1"},{type:"Help",title:"云之家预览",desc:"一、云之家预览配置1、登录苍穹进入云之家预览配置页面，应用-配置工具-参数配置-系统参数-公共参数2、输入相应参数-确认-保存。云之家正式url：http://api.kingdee.com二、云之家参数获取正式申请应用的开放平台地址是：http://cloud.kingdee.com/kae1、申请应用参考：http://cloud.kingdee.com/help/document/detail?item=267&amp;doc=1868 （1）注册用户（2）登录金蝶云开放平台（3）进入API 市场-进入API市场-我的应用-新建应用（4）如图应用ID和应用SECRET即为client_id和client_secret（5）查看账号信息，如图所示账号id即为uid（6）用刚创建的应用订阅服务：‘云通行证-授权认证’‘金蝶云盘’‘云通行证用户服务’3个服务2、注册企业参考：https://cloud.kingdee.com/help/document/detail?item=140&amp;doc=1823 （1）进入企业账号中心（2）注册企业（3）点击需要查找的企业名字（4）在地址栏即可找到tid的数值，如下图红框所示数字3、获取tidsecret（1）进入刚创建的应用-查看订阅服务‘云通行证-授权认证’（2）接口管理、找到get请求方式auth/user/access_token的接口（3）调试API（4）进入应用请求调试（5）调试的时候，接口参数填入如图参数client_id、client_secret、username、password参数值分别为上面步骤获取到的应用id、应用secret、注册的账号密码；然后点击底端的发送请求；获取如图结果的access_token值（6）进入刚创建的应用-查看订阅服务‘云通行证用户服务’（7）接口管理、找到passport/user/orgs的接口（8）调试API、并进入应用请求调试界面（9）调试的时候，接口参数填入如图参数access_token，参数值为第5步获取到的access_token的值然后点击底端的发送请求；在结果中找到tid所在分段的secret的值即为该tid的tidsecret",updateTime:"2020-09-15",viewCount:194,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/190720/answers/221203?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|4"]}],type:"Help",title:"云之家配置信息-创建群组",desc:"1、MC进行配置[图片]需要配置云之家创建群聊接口的URL：参数名：YunZhiJiaCreateGroupURL参数值：/linkspace/open/imsdk/group/create2、启用公有云[图片]2.1、数据获取：先网页端登录“云之家”，找到“管理中心”2.2、配置eid、工作圈名称[图片]2.3、Keyfile获取[图片]2.4、通讯地址：https://www.yunzhijia.com3、“系统参数”相关配置与上述获取数据一致[图片]4、确定用户是否已经同步到苍穹和云之家5、重启服务",url:"https://club.kdcloud.com/questions/190720/answers/221203?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|4",updateTime:"2020-04-08",viewCount:154,helpType:"课程"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446342/answers/136127212544883716?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|5"]}],type:"Help",title:"怎么注销云平台/云之家账号",desc:"【方法】客户拨打云之家热线：4008308110，告知需要注销账号，客服人员会给客户推送一个验证码，将验证码告知客服即可申请注销。说明：该账号必须已经不在任何团队里（可以先联系管理员操作该账号离职，或者该账号自己登陆云之家申请退出团队）。",url:"https://club.kdcloud.com/questions/136127172514446342/answers/136127212544883716?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|5",updateTime:"2020-12-30",viewCount:46,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/111890668993464064?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|6"]}],type:"Help",title:"苍穹和云之家的集成配置",desc:"关键字：轻应用、云之家集成、云之家扫码登录、扫码登录、流程助手如果需要做苍穹和云之家的集成，包括过配置轻应用，云之家扫码登录，流程助手等，配置步骤如下：一、在云之家申请轻应用1、云之家管理员登录后，在云之家管理中心-&gt;轻应用管理平页面中新建一个轻应用。获取云之家的appid和appSecret。2、配置移动端访问地址1)普通轻应用移动端访问地址配置方法：https://xxx.com/mobile.html? form=XXXX&amp;accountId=xxxxx&amp;appid=xxxxx地址内容说明如下：https://xxx.com/mobile.html：代表苍穹地址accountId ：苍穹租户的数据中心ID（多数据中心时需要配置）；appid：云之家appIdform：需要打开的表单编码 人人费用的form=er_mainpage_daily 人人差旅的form=er_mainpage 流程助手的form=wf_mobilelist_mob2)云之家扫码登录访问地址配置：云之家扫码登录配置和上面的步骤相同，配置地址如下公有云：https://yunzhijia.com/opencloud/openthird/qrlogin私有云：苍穹地址/ opencloud/openthird/qrlogin二、在苍穹中配置轻应用1、 登录MC（租户管理中心）-&gt;基础数据维护-&gt;环境公共配置项2、添加轻应用插件：在/root/config/common/prop 下添加插件kd.bos.login.thirdauth.app.yzj.YZJPrivateAppAuthticationAuth2（027以后的版本）3、 配置轻应用说明： 当有多个轻应用需要配置时，只需要新增追加最后一行,前面的配置无需添加和修改，即：租户ID.AppSecrest.XXXXXXX=XXXXXXXXX租户ID.mid 配置云之家工作圈的EID保存后发布，一般不需要重启，如果有问题，可以尝试重启。三、苍穹和云之家的人员同步如果苍穹和云之家的人员已经做过同步的此步骤无需再做。如果当前苍穹和云之家的人员没有同步可参考如下步骤进行同步：https://vip.kingdee.com/article/13044注意：如果苍穹和云之家已经有各自的组织人员数据并且不同步，此时只需要做账号的同步，即两边的数据进行绑定，不需要同步详细信息。常见问题分析：1、轻应用跳转界面为登录页面，需要手动输入用户名和密码：通常是轻应用中配置的URL不正确导致，请检查云之家中配置的轻应用URL地址的格式和参数。2、提示获取app的secret失败请检查租户ID.AppSecrest.XXXXXXX=XXXXXXXXX这个配置，特别注意A和S是大写，其他字母小写。3、提示找不到XXX用户1）检查轻应用中配置的URL中的数据中心accountId是否正确2）苍穹中的用户和云之家需要做同步账号。详细步骤参考如下文档：https://vip.kingdee.com/article/55974752027712000",url:"https://club.kdcloud.com/article/111890668993464064?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|6",updateTime:"2021-01-28",viewCount:533,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/13229?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|7"]}],type:"Help",title:"首页添加云之家订阅指引",desc:"1、登录到苍穹系统后，在首页页签下，点击右上角的调整布局按钮，界面底部弹出添加卡片入口；2、点击添加卡片，弹出选择卡片弹窗，通过左右切换图标切换到云之家订阅卡片，点击确定按钮，进入订阅号管理界面；3、进入订阅号管理界面后，选择需要关注的订阅号，点击确定按钮即订阅成功",url:"https://club.kdcloud.com/article/13229?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|7",updateTime:"2019-07-08",viewCount:149,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183441?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|8"]}],type:"Help",title:"云之家群组支持设置主题",desc:"云之家群组讨论、会审讨论支持设置主题，样式如下图所示1. 上方显示的是固定格式title：XXX的XXX单据2. 下方显示的设置的移动端单据主题1) 如果设置了“移动单据主题”（在单据流程属性中设置移动单据主题，如下图），则按照设置计算单据主题2) 如果没有，那么基础资料类型显示：“名称：XXX”单据类型显示：“单据编号：XXX”处理规则如下：1. 群组讨论、会审讨论1) 当人员数为2人的时候，是不创建单据主题，也就是正常的回话窗口；2个人以上才创建主题2) 群组讨论的参与人必须有openid（默认都有openid），当没有openid时不会被拉到群组讨论中2. 群组中的任何一个人都可以通过点“单据主题”进入到审批页面，处理任务1) 当任务没有处理时，打开的是“审批处理”页面2) 当任务已经处理后，打开的是“审批处理查看”页面3）如果是群组中新拉入的人员，这个人不是审批任务处理人，此人打开的是“审批处理查看”页面云之家配置信息-创建群组：https://club.kdcloud.com/questions/190720/answers/221203 ",url:"https://club.kdcloud.com/article/183441?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|8",updateTime:"2020-04-09",viewCount:147,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/14495/answers/19851?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|9"]}],type:"Help",title:"为什么收不到云之家\\短信\\邮件消息？",desc:"消息设置通过“系统云”-&gt;“系统管理”-&gt;“消息平台”进行设置。1、消息渠道可以启用/禁用云之家/短信/邮件，云之家和邮件默认为启用状态，只有启用状态的消息渠道才可以添加到发送渠道中。[图片]2、消息类型有报警、通知、任务、预警四种，发送渠道默认都是云之家消息（这四种消息类型的消息都通过云之家发送），见下图。[图片][图片]消息类型说明：报警：流程挂起时向管理员发送的错误消息；超出任务处理时限向任务处理人发送的报警消息通知：各个节点的离开节点时消息和进入节点时消息、消息节点消息、会审订阅结果、转交订阅结果任务：待办任务、转交任务、传阅、催办（待办任务和转交任务会显示在移动端的待办通知中；传阅和催办会显示在移动端的流程助手中）预警：接近任务处理时限或到达处理时限，向任务处理人发送的预警消息3、 消息模板用于设置收到消息的样式，默认模板为通过邮件收任务，其他没有设置模板的消息默认为单据编码[图片]常见的配置问题如下：1）消息渠道（云之家\\短信\\电子邮件）被禁用，导致收不到消息解决方式：在消息渠道列表启用云之家\\短信\\电子邮件后，在消息类型列表中重新添加发送渠道[图片][图片]2）消息渠道（云之家\\短信\\电子邮件）为启用状态，但消息类型没有配置消息发送渠道解决方式：确定消息类型，并在消息类型列表中重新添加发送渠道3）各个节点的出口消息和入口消息发送异常解决方式：请确认流程中节点的消息通知是否配置正确（此消息为启用状态且符合消息通知条件规则）[图片]4） 云之家收不到待办任务解决方式：需确认你的圈子是否开通了流程助手的功能。5） 邮件收不到解决方式：需要检查消息渠道中邮件的配置。[图片]6） 短信收不到解决方式：需要检查短信渠道的配置是否正确，标准产品的短信有许可的限制，如果配置正确，请确认是否需要购买许可。[图片]",url:"https://club.kdcloud.com/questions/14495/answers/19851?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|9",updateTime:"2019-07-02",viewCount:377,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/122028128586786560?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|10"]}],type:"Help",title:"人员兼职可设置上级，同步云之家",desc:"人员维护可以维护主职，设置上级；支持设置多个兼职，3.0版本以后支持兼职可设置上级，如图：支持同步云之家：在系统参数，打开同步组织、人员到云之家，然后编辑人员，保存时会自动同步到云之家。保存成功之后，登录云之家，查看同步情况：对比工号，姓名，手机号，是一致的。然后查看直接上级：检查兼职是否同步：",url:"https://club.kdcloud.com/article/122028128586786560?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|10",updateTime:"2021-01-21",viewCount:22,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172531223581/answers/136127212561660931?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|11"]}],type:"Help",title:"云之家团队下的业务部门名称如何修改？",desc:"【说明】打开网页版云之家，在【管理中心】--【组织架构】--【部门设置】下修改部门名称。",url:"https://club.kdcloud.com/questions/136127172531223581/answers/136127212561660931?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|11",updateTime:"2020-12-30",viewCount:20,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/94025346701554688/answers/94025346735109120?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|12"]}],type:"Help",title:"苍穹的组织人员全量同步到云之家（不推荐使用）",desc:"相关配置可先参考：[链接]https://vip.kingdee.com/article/170804步骤一：将云之家参数中的【禁用】按钮选中，然后保存[图片]步骤二：批量封存组织[图片]步骤三：选中云之家参数中的【同步组织人员至云之家】，然后保存[图片]步骤四：解封封存的组织。[图片]说明：以上方式不推荐使用，因为有些组织正在使用或者其他原因而封存不了。正常流程是，开启了云之家参数中的【同步组织人员至云之家】的前提下，新建组织或者修改组织保存后，会自动同步到云之家。若是存在不能封存的组织，请在【同步组织人员至云之家】开启的前提下，修改组织保存，即可同步成功",url:"https://club.kdcloud.com/questions/94025346701554688/answers/94025346735109120?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|12",updateTime:"2020-09-16",viewCount:181,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/149536/answers/177934?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|13"]}],type:"Help",title:"云之家、钉钉和企业微信中附件查看方式介绍",desc:"工作流移动端支持云之家、钉钉和企业微信，每种移动端对于附件的查看方式各有不同，具体如下：1.云之家审批页面附件查看方式：[图片]2.钉钉审批页面附件查看方式：[图片]3.企业微信审批页面附件查看方式：[图片]",url:"https://club.kdcloud.com/questions/149536/answers/177934?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|13",updateTime:"2020-01-06",viewCount:216,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/90761562482237696?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|14"]}],type:"Help",title:"发起云之家群聊配置从MC迁移至苍穹",desc:'【背景】从苍穹发起云之家群组沟通时，需要从MC中获取云之家的相关配置信息，主要是key文件和工作圈的EID，该配置主要配置在具体的租户的数据中心里（如下图），一个租户可以有多个数据中心，MC中又包含多个租户，总共就有n*m个数据中心，运维需要进行大量的配置然后发布，所以将配置迁移到苍穹的"系统云 -&gt; 配置工具 -&gt; 系统参数 -&gt; 系统服务云 -&gt; 基础服务 -&gt; 云之家参数"，对于需要该功能的客户单独配置即可。【改动点】将MC中的相关配置迁移到如下图中（系统云 -&gt; 配置工具 -&gt; 系统参数 -&gt; 系统服务云 -&gt; 基础服务 -&gt; 云之家参数）的位置，同时后台代码发起群组聊天调用云之家相关接口时不再从MC中取配置，而是从本地系统取。【具体详情】前提要求： 发起单人聊天或者群聊的前提要求是相关的人员必须已经与云之家完成人员同步，苍穹这边对应的人员openId字段不可以为空，openId为云之家人员的id。发起群聊的位置，人员列表中选中人员（已经完成与云之家同步过的人员），点击发起沟通即可1、原始情况：MC对应的数据中心里面配置了云之家的相关信息，苍穹没有配置，可以正常发起群聊，将配置删除，无法发起群聊；2、配置迁移后的情况：MC配置了云之家的相关信息，苍穹没有配置，点击发起群聊将无法发起；3、MC中的配置删除，苍穹正确配置云之家相关信息，选中人员正常发起群聊；4、苍穹配置错误的信息，群聊无法发起',url:"https://club.kdcloud.com/article/90761562482237696?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|14",updateTime:"2020-09-07",viewCount:137,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172883545090/answers/136127212578438184?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|15"]}],type:"Help",title:"云平台里面有企业，但是为什么云之家不显示？",desc:"【说明】请登录金蝶云平台，选中需要在云之家显示的企业--【通讯录】--【在云之家显示该企业勾选】：【是】。[图片]",url:"https://club.kdcloud.com/questions/136127172883545090/answers/136127212578438184?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|15",updateTime:"2020-12-30",viewCount:9,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172917099526/answers/136127212595215398?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|16"]}],type:"Help",title:"企业已经认证但是在云之家还显示未认证状态。",desc:"【说明】云平台的认证和云之家的认证是不同的哦，同步的只是组织架构。【操作步骤】在手机端-我的-管理员专区-企业认证里按照提示进行申请。【建议】云之家问题可以在手机端咨询云之家团队哦~",url:"https://club.kdcloud.com/questions/136127172917099526/answers/136127212595215398?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|16",updateTime:"2020-12-30",viewCount:10,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/70915295527003904?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|17"]}],type:"Help",title:"云之家流程助手支持按任意时间筛选",desc:"功能介绍云之家流程助手支持按任意时间筛选，如下图所示：相关链接工作流常见问题汇总: https://club.kdcloud.com/article/183140 工作流平台新特性发布：https://club.kdcloud.com/article/56392500931676161流程服务社区文档入口：https://club.kdcloud.com/article/183308 ",url:"https://club.kdcloud.com/article/70915295527003904?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|17",updateTime:"2020-07-14",viewCount:61,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183911?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|18"]}],type:"Help",title:"云之家【流程助手】待办任务显示当前审批节点名称",desc:"应用场景云之家流程助手待办任务显示当前审批节点名称，方便用户查看设置方式开启流程节点名称的“隐藏元素”属性运行效果：",url:"https://club.kdcloud.com/article/183911?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|18",updateTime:"2020-04-21",viewCount:174,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/55974752027712000?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|19"]}],type:"Help",title:"云之家单点登录苍穹，提示账号不存在的处理步骤",desc:"云之家单点登录苍穹时，是通过用户的openid去苍穹系统匹配。匹配成功则允许登录，否则提示账号不存在。因此出现这种提示，一般可以去苍穹系统的人员检查下openid是否正确。具体操作如下：在系统云-基础服务-组织管理-云之家差异对比菜单下，点击【同步云之家账号】按钮，系统会生成一份差异报告；双击差异报告进入差异详情界面；界面中展示了苍穹和云之家的openid值，如果有差异，则选中数据，点击选择同步按钮即可；",url:"https://club.kdcloud.com/article/55974752027712000?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|19",updateTime:"2020-06-03",viewCount:261,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/65833361927158016?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|20"]}],type:"Help",title:"WebAPI集成方案案例（苍穹-云之家人员集成演示案例）",desc:"云之家集成对象（查询服务、加载服务）示例注意：•本演示案例集所用苍穹实体不是真实的业务单据，没有关联数据表，如需实际执行，需要用开发平台打开元数据“”,点击保存以自动创建数据表。 •云之家的连接信息找企业的云之家管理员获取，建议集成方向始终保持从云之家到苍穹，如果需要双向集成务必谨慎。警告：集成云2.0要求必须有测试环境和正式环境，两套环境独立且不允许共享数据；所有方案必须首先在测试环境验证正确性，才能迁移到正式环境使用。免责声明　　本文档提供的演示案例绝对不可直接用于生产环境，仅作为WebAPI集成方案配置参考。如果因为使用这些方案而破坏云之家的数据，一切后果由方案的导入者和执行者承担。PPT：https://club.kdcloud.com/school/61461018178089216直播视频：https://club.kdcloud.com/school/liveCourse/65800761162278912",url:"https://club.kdcloud.com/article/65833361927158016?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|20",updateTime:"2020-09-03",viewCount:308,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/128831343596712192/answers/128831343596712193?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|21"]}],type:"Help",title:"智能洞察右侧栏/浮层出现人名，是否可以直接云之家和这个人沟通？",desc:"可以。先进行云之家同步之后（见附件文档），即可使用云之家和单据操作人云之家沟通。",url:"https://club.kdcloud.com/questions/128831343596712192/answers/128831343596712193?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|21",updateTime:"2020-12-21",viewCount:24,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/13044?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|22"]}],type:"Help",title:"一键搞定云之家的人员组织同步至金蝶云苍穹",desc:"客户一直在使用云之家产品，最近又要上线金蝶云苍穹，上线过程免不了要在新产品中做一些繁琐又耗时间的工作，比如人员组织初始化。现在为大家介绍下，在金蝶云苍穹中如何快速的将云之家中的人员组织同步到苍穹中。1、进入【系统云】-【配置工具】-【系统参数】页面，选中左树中的系统云-基础服务节点。在右侧的编辑页面，勾选“苍穹从云之家同步组织人员”参数，组织选择根组织，其他参数无需更改，然后保存。 2、在【系统云】-【基础服务】-【组织管理】菜单，打开【云之家差异对比】列表界面。点击【检查差异并同步】按钮，系统自动生成云之家和苍穹的差异报告，同时将云之家的正常差异部门同步到金蝶云苍穹。3、双击差异报告卡片，进入报告详情页。用户可对报告中状态为异常的数据进行确认，如果没有问题可以选中该数据点击【选择同步】按钮进行同步；若需要手工处理异常数据，也可进入组织人员功能页手动修正；",url:"https://club.kdcloud.com/article/13044?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|22",updateTime:"2019-07-10",viewCount:703,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446362/answers/136127212544883736?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|23"]}],type:"Help",title:"怎样将用户不同步到产品所在企业的云之家圈子里。",desc:"【说明】登录云平台，【注册用户列表】--【管理用户】-【人企分离】。",url:"https://club.kdcloud.com/questions/136127172514446362/answers/136127212544883736?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|23",updateTime:"2020-12-30",viewCount:11,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/171929?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|24"]}],type:"Help",title:"苍穹移动人人费用、人人差旅 云之家轻应用配置指导原创",desc:"示例：环境地址https://feature.kingdee.com:2024/baseline_b0备注: 输入地址后, 能直接进入到苍穹登录首页的就是环境地址, 后面不带任何参数, 比如formid=xxx什么的accountId666522411780278272accountId获取见文末轻应用配置云之家 -&gt; 工作台 -&gt; 轻应用管理移动端访问地址https://feature.kingdee.com:2024/baseline_b/mobile.html?accountId=738978929016048640#/form/er_mainpage_daily?accountId=738978929016048640协议://域名:端口/路由/mobile.html?accountId=租户id#/form/移动端人人费用首页?accountId=租户ID展开更多设置进行Web端及桌面端轻应用配置Web端访问配置https://feature.kingdee.com:2024/baseline_b/index.html?accountId=738978929016048640#/dform?formId=pc_main_console&amp;appNumber=exp协议://域名:端口/路由/index.html?accountId=租户id#/dform?formId=pc_main_console&amp;appNumber=应用IDPC端访问地址https://feature.kingdee.com:2024/baseline_b/index.html?accountId=738978929016048640#/dform?formId=pc_main_console&amp;appNumber=exp协议://域名:端口/路由/index.html?accountId=租户id#/dform?formId=pc_main_console&amp;appNumber=应用ID保存后立即生效URL汇总##人人费用-移动端&gt;https://feature.kingdee.com:2024/baseline_b/mobile.html?accountId=738978929016048640#/form/er_mainpage_daily?accountId=738978929016048640-Web端&gt;https://feature.kingdee.com:2024/baseline_b/index.html?accountId=738978929016048640#/dform?formId=pc_main_console&amp;appNumber=exp-PC端&gt;https://feature.kingdee.com:2024/baseline_b/index.html?accountId=738978929016048640#/dform?formId=pc_main_console&amp;appNumber=exp##人人差旅-移动端&gt;https://feature.kingdee.com:2024/baseline_b/mobile.html?accountId=738978929016048640#/form/er_mainpage?accountId=738978929016048640-Web端&gt;https://feature.kingdee.com:2024/baseline_b/index.html?accountId=738978929016048640#/dform?formId=pc_main_console&amp;appNumber=tra-PC端&gt;https://feature.kingdee.com:2024/baseline_b/index.html?accountId=738978929016048640#/dform?formId=pc_main_console&amp;appNumber=tra备注:1, 人人差旅和人人费用移动端配置的区别在于后面的参数form的值不一样人人差旅 - #/form/er_mainpage人人费用 - #/form/er_mainpage_daily2, 人人差旅和人人费用Web端和PC端的区别在于appNumber不一样人人差旅 - appNumber=tra人人费用 - appNumber=exp3, 大部分客户环境都是类似于 xxx.kdcloud.com, 配置轻应用的时候, 环境地址就是https://xxx.kdcloud.com/直接将这个地址带入到开头的环境地址进行配置即可, 不需要加后面类似于baseline_b/之类的4, 移动端轻应配置也可以如下配置, 以mobile.html后面带form参数的形式人人差旅:https://feature.kingdee.com:2024/baseline_b/mobile.html?accountId=738978929016048640&amp;form=er_mainpage人人费用https://feature.kingdee.com:2024/baseline_b/mobile.html?accountId=738978929016048640&amp;form=er_mainpage_daily如何获取accountId以环境地址https://feature.kingdee.com:2024/baseline_b/为例进入环境, 按F12键打开开发人员工具, 找打Network, 按F5刷新一下界面, getAllDatacenters.do就是获取所有accountId的, 将要配置的环境所对应的库的accountId复制出来即可",url:"https://club.kdcloud.com/article/171929?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|24",updateTime:"2020-01-17",viewCount:1320,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446348/answers/136127212544883722?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|25"]}],type:"Help",title:"云平台更换创始人提示操作失败？",desc:"【概述】云之家里操作了创始人离职，使用其他管理员在云之家将该离职人员在通讯录重新添加后，自动恢复创始人权限。然后去云平台操作更换创始人成功。说明：云平台变更了创始人，云之家创始人也同步变更。[图片]",url:"https://club.kdcloud.com/questions/136127172514446348/answers/136127212544883722?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|25",updateTime:"2020-12-30",viewCount:19,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/57910456592965632/answers/57910457415352064?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|26"]}],type:"Help",title:"设置好的财务指标去哪里查看？",desc:"打开与组织关联的云之家手机客户端，长按下方中央的“云之家”图标唤出小k，向小k询问“财务指标”并选择需要查看的组织就可以查询了。[图片]",url:"https://club.kdcloud.com/questions/57910456592965632/answers/57910457415352064?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|26",updateTime:"2020-07-21",viewCount:33,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446347/answers/136127212544883721?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|27"]}],type:"Help",title:"服务期外补丁申请流程",desc:"【路径】云之家--通用审批--服务期外补丁申请[图片]",url:"https://club.kdcloud.com/questions/136127172514446347/answers/136127212544883721?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|27",updateTime:"2020-12-30",viewCount:99,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446343/answers/136127212544883717?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|28"]}],type:"Help",title:"怎么查看轻应用的用户占用情况",desc:"【步骤】云之家--星空应用管家--点击对应的应用查看占用情况。[图片][图片]",url:"https://club.kdcloud.com/questions/136127172514446343/answers/136127212544883717?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|28",updateTime:"2020-12-30",viewCount:29,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183171?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|29"]}],type:"Help",title:"催办介绍",desc:"提单人可以在 消息中心-在办申请 中对已经提交的单据进行催办，让相应的审批人尽快处理紧急的提单，PC端和移动端（云之家、钉钉、企业微信）均支持此功能，如下图催办后，PC端和移动端（云之家、钉钉、企业微信）都能收到催办通知，通过点击可以快速跳转到审批页面，如下图所示：",url:"https://club.kdcloud.com/article/183171?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|29",updateTime:"2020-03-31",viewCount:127,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/53148741578198273?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|30"]}],type:"Help",title:"语音查询",desc:"适用场景：当用户需要查询组织的财务指标时，云苍穹系统为用户提供手机客户端的云之家小K语音功能，让用户可以随时随地随心所欲的查询想要查询的数据。操作指引：【云之家】-【小k】，唤出小k后，语音询问财务指标，然后选择需要查看的组织，小k便会显示出该组织的财务指标了。",url:"https://club.kdcloud.com/article/53148741578198273?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|30",updateTime:"2020-08-12",viewCount:26,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446351/answers/136127212544883725?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|31"]}],type:"Help",title:"怎么修改客户进在线咨询/提单的时候绑定的邮箱/手机号码？",desc:"需要登录云平台和云之家修改。云平台操作步骤:1、使用手机号码登录云平台：[链接]https://cloud.kingdee.com/qy2、然后右上角点击【账户设置】，然后在对应的邮箱/手机修改即可~[图片][图片]云之家操作步骤：1、使用手机号码登录云之家：[链接]https://www.yunzhijia.com 2、点击右上角的【我的账号】-【账号设置】，然后在对应的邮箱/手机修改即可~[图片]",url:"https://club.kdcloud.com/questions/136127172514446351/answers/136127212544883725?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|31",updateTime:"2020-12-30",viewCount:25,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183307?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|32"]}],type:"Help",title:"消息平台配置简介",desc:"消息平台配置苍穹平台默认内置了七个消息渠道，分别是云之家、邮件、短信、钉钉、企业微信、welink、生态云之家。可以在系统管理-&gt;消息平台-&gt;消息渠道进行禁用和启用（云之家和生态云之家不能同时启用），如图下图所示。禁用之后，苍穹的待办任务消息和普通消息都不会发送到相应的渠道。每个消息渠道可以自定义自己的参数，在消息渠道初始化时加载并且解析，如下图所示：支持设置相关的消息模板，如图下图所示，消息模板中可以选择表达式，选择单据上的某个字段。可以定义每个实体在某个消息渠道下的模板内容，比如系统默认内置了流程中待办任务对应的邮件模板。工作流引擎内置11个代办任务和消息场景方便用户使用消息中心应用开发手册V2.0：https://club.kdcloud.com/school/6110 ",url:"https://club.kdcloud.com/article/183307?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|32",updateTime:"2020-05-19",viewCount:641,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/90758312769207808?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|33"]}],type:"Help",title:"PC端附件支持多文件预览",desc:"用户场景：在PC端预览附件的时候，原有的实现是：当用户点击预览的时候，如 doc/xlsx/ppt 等类型的文件，会在浏览器中新建一个标签页，内容展示在新的标签页中，而图片则是在当前的页面进行切换预览。如果用户想要预览不同的文件的话，则需要不断点击预览，切换浏览器标签。新的实现是，当用户点击附件预览的时候，会在当前页面进行内容展示，用户可以通过左右按钮进行附件切换，预览不同的文件。如若用户想要比对当前网页内容以及附件内容的话，可以点击附件头部的“新页签打开”按钮，实现在新的页签打开该附件，预览内容。对于图片类型的文件，用户也可以通过鼠标进行图片移动，避免遮挡当前网页的内容。另外，对于 doc/xls/ppt 等 office 文档，用户还可以通过配置开关选择是否通过云之家的预览方式进行预览功能介绍：支持预览类型: doc/docx、xls/xlsx、ppt/pptx、pdf、txt、jpg/png/gif等常见图片格式图片支持放大缩小、旋转、移动office 文档类型的文件支持云之家预览office 文档类型、pdf 以及 txt 文件支持点击标题栏进行打印支持在浏览器新页签打开操作步骤：云之家预览方式配置在系统首页的应用页签中找到“配置工具”，在边栏选择系统参数，进入系统参数配置页面。在分类中选择公共参数，在附件配置中，点击云之家预览配置，如下图在弹窗中，我们可以看到有两种预览方式：默认方式：office 文档会被转换为 pdf 进行预览云之家预览方式: office 文档会通过云之家的页面进行预览选择完成后，保存配置即可。效果展示：图片（支持切换，放大，缩小，旋转）文档（默认方式）文档（云之家预览）",url:"https://club.kdcloud.com/article/90758312769207808?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|33",updateTime:"2020-12-24",viewCount:116,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446359/answers/136127212544883733?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|34"]}],type:"Help",title:"什么是MID?",desc:"【说明】MID就是EID,客户可以登录云之家，点击右上角的头像下面的【我的团队】查看。[图片]",url:"https://club.kdcloud.com/questions/136127172514446359/answers/136127212544883733?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|34",updateTime:"2020-12-30",viewCount:12,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/14766/answers/20074?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|35"]}],type:"Help",title:"如何在同一个审批节点收到不同的消息",desc:"在审批节点设置消息通知时可以设置条件，满足某条件发送某云之家/短信/邮件消息，如下图所示：[图片]",url:"https://club.kdcloud.com/questions/14766/answers/20074?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|35",updateTime:"2019-07-11",viewCount:97,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/76239392553119232?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|36"]}],type:"Help",title:"默认登录方式配置功能",desc:"苍穹目前支持多种登录方式，如何把常用的登录方式设置为默认呢？一、 功能介绍通过在登录页配置默认登录方式来确定该租户在进入登录页面时，默认出现的登录方式（目前支持账号密码登录，云之家扫码登录）。二、 设置步骤：1.应用-&gt;系统服务云-&gt;系统管理-&gt;登录页配置 2.在下拉框中选择在MC中给该租户配置的登录方式，例如账号密码登录，云之家扫码登录等，如图3.点击保存按钮，即可保存初始默认的登录方式三、 效果展示：1.设置默认登录方式为：账号密码登录，默认登录界面如下，2. 设置默认登录方式为：云之家扫码登录，默认登录界面如下，",url:"https://club.kdcloud.com/article/76239392553119232?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|36",updateTime:"2020-08-03",viewCount:196,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/114307282741038336?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|37"]}],type:"Help",title:"小K智能语音助手的标准技能有哪些？",desc:"初始化完成后，在不同的渠道（苍穹web端/云之家）可使用的标准技能有所不同。1、苍穹web端支持的标准技能包括：语音出差申请、财务指标查询、找单据和社区知识问答。2、云之家支持的标准技能包括：找人找应用、创建日程、语音出差申请、财务指标查询和社区知识问答。注意：使用语音出差申请和财务指标查询，需要企业已经购买人人差旅和AI财务服务模块。",url:"https://club.kdcloud.com/article/114307282741038336?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|37",updateTime:"2020-11-11",viewCount:40,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/61532959249255424/answers/61532960541184000?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|38"]}],type:"Help",title:"供应商如何使用手机进行协同业务？",desc:" 供应商协同云部分功能已经支持移动端应用，如果客户有用云之家，则可以用云之家直接打开移动端应用，如果没有云之家也可以通过直接通过url连接打开苍穹移动端。移动端url地址获取请参考[链接]https://club.kdcloud.com/article/61476573626888704 手机端点击连接就可以直接跳转到移动端苍穹的登录界面，输入供应商账号密码就能登录到供应商端移动应用界面。[图片]供应商移动端界面目前已支持查看通知公告、确认采购订单、订单发货功能。[图片]",url:"https://club.kdcloud.com/questions/61532959249255424/answers/61532960541184000?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|38",updateTime:"2020-06-18",viewCount:166,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172531223587/answers/136127212561660937?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|39"]}],type:"Help",title:"点击出库链接输入账号密码后报错：账号未激活，请进行激活！",desc:"【说明】账号在云平台已经激活了，请再次前往云之家 [链接]https://www.yunzhijia.com 激活后点击出库链接完成收货。[图片]",url:"https://club.kdcloud.com/questions/136127172531223587/answers/136127212561660937?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|39",updateTime:"2020-12-30",viewCount:25,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172917099542/answers/136127212611992581?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|40"]}],type:"Help",title:"在企业云平台的通讯录里面改名字和组织架构，都没有变动。",desc:"【说明】如 在通讯录里面修改姓名修改不了，变通方法：在注册用户列表里面离职再重新录入，可成功修改姓名。如组织架构调整不了，变通方法:登录云平台，点击【云之家管理中心】，在云之家的通讯录里面，点击所属部门。找到相应人员后勾选，点击：【人员移动】，选择对应的部门后，点击【确定】即可。[图片]",url:"https://club.kdcloud.com/questions/136127172917099542/answers/136127212611992581?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|40",updateTime:"2020-12-30",viewCount:8,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/91906450171441152/answers/91906450204995584?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|41"]}],type:"Help",title:"苍穹的对话机器人平台支持哪些端？",desc:"对话机器人平台根据场景的不同可以支持五种端配置。场景一：客户使用了金蝶办公协同产品云之家，可将对话机器人对接到云之家的原生端或轻应用端。1、云之家原生端：客户需要在当前所在工作圈的管理中心找到对应的工作圈EID，然后按照云之家原生端的appID编码规则填入。[图片]云之家工作圈管理员身份可查看的EID[图片]对话机器人平台的原生端2、轻应用端：如果用户希望在轻应用建立一个对话机器人，则可以利用管理员账号在云之家轻应用自建一个轻应用，然后绑定对话平台。这个流程可以参考该文档：[链接]https://ai.kingdee.com:9992/doc/bot_cosmos_docs/#/?id=_3-%e5%af%b9%e8%af%9d%e5%b9%b3%e5%8f%b0%e9%85%8d%e7%bd%ae[图片]场景二：客户没有使用云之家作为员工协同的产品。3、API对接：如果客户不需要在对话平台配置对话机器人的语音交互界面和引导语，只希望对话平台提供意图解析和词槽提取的能力，可以采用更为灵活的API对接形式。用户需要将对话平台生成的appID和秘钥配置在自己的系统参数中。[图片]4、企业微信端：企业日常办公协作如果是用的企业微信，则用户可以在企业微信的工作台建立一个类似于云之家轻应用的H5应用，按照企业微信所需要的参数配置即可。[图片]5、苍穹对接：如果客户是苍穹系统的客户，且没有使用云之家，又希望在web端使用小K的技能，那么可以采用这种方式，将苍穹对接端打开，将appID和秘钥填入苍穹的参数配置中。路径为：应用-AI服务云-小K智能助手-小K初始化。[图片]对话机器人平台的苍穹对接端[图片]小K智能助手的初始化配置",url:"https://club.kdcloud.com/questions/91906450171441152/answers/91906450204995584?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|41",updateTime:"2020-09-21",viewCount:58,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/85784112333966592?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|42"]}],type:"Help",title:"如何调用移动端App接口",desc:'介绍：在移动端的轻应用的开发过程中，常常需要调用App的能力，如拍照，扫码等，在苍穹平台中提供了两种调用方式1、callClientAppMethod方法2、executeClientCommand方法callClientAppMethod方法callClientAppMethod(ClientMethod method,Object args)method：app方法名args：调用该app方法需要的参数//调用扫描功能 MobileFormViewview=(MobileFormView)this.getView(); view.callClientAppMethod(ClientMethod.ScanQRCode,null); /** 如调用该App方法会有回调，则进该事件 */ @Override publicvoidcustomEvent(CustomEventArgse){ StringeventName=e.getEventName(); Stringvalue=e.getEventArgs(); Stringkey=e.getKey(); if(key.equals("callAppMethod")&amp;&amp;eventName.equals(ClientMethod.ScanQRCode.getValue())){ //youcode } }executeClientCommand方法executeClientCommand("callYZJApi", Map map);map：对象，包含method和args属性HashMapmap=newHashMap(); map.put("method","selectPic");//selectPic为云之家方法名 HashMapargs=newHashMap(); args.put("type","camera"); map.put("args",args);//args调用该云之家方法需要传递的参数 this.getView().executeClientCommand("callYZJApi",map); /** 如调用该App方法会有回调，则进该事件 */ @Override publicvoidcustomEvent(CustomEventArgse){ StringeventName=e.getEventName(); Stringvalue=e.getEventArgs(); Stringkey=e.getKey(); if(key.equals("callAppMethod")&amp;&amp;eventName.equals("selectPic")){ //youcode } }目前云之家App的大部分的方法可通过这两种方法调用，使用前需参考云之家App方法。钉钉部分支持，后续完善',url:"https://club.kdcloud.com/article/85784112333966592?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|42",updateTime:"2020-08-31",viewCount:137,helpType:"文章"
},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/109666960279152384/answers/109666960295929600?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|43"]}],type:"Help",title:"怎么开通和使用小k智能语音助手",desc:"进入AI服务云-小K智能语音助手应用，进行初始化。[图片]完成后，在苍穹web端顶部最右侧个人中心旁边会出现小K图标，点击即可开始使用小K。[图片]如你的企业同时正在使用云有云云之家，初始化完成后，在云之家移动端工作台右上角会出现小K图标，点击即可开始使用小K。[图片]",url:"https://club.kdcloud.com/questions/109666960279152384/answers/109666960295929600?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|43",updateTime:"2020-10-29",viewCount:67,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172933876758/answers/136127212746210319?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|44"]}],type:"Help",title:"因特殊情况需要用邮箱激活注册用户或者免激活。",desc:"申请邮箱激活或免激活流程：请金蝶分公司在云之家的【智能审批】-【申请邮箱激活或免激活】提交流程。审批通过后云平台开启。[图片]",url:"https://club.kdcloud.com/questions/136127172933876758/answers/136127212746210319?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|44",updateTime:"2020-12-30",viewCount:73,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/86788530365735936?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|45"]}],type:"Help",title:"流程助手功能简介",desc:"平台提供云之家轻应用【流程助手2.0】，它既可以对接苍穹工作流的待办任务，也可以对接EAS工作流的待办任务，默认为云之家的轻应用，需要对应的圈子开通才可以使用，开通之后，可以从云之家轻应用列表中进入，进入之后可以进行移动审批功能介绍支持单个审批支持批量审批支持搜索、过滤支持转交、传阅、群组讨论、协办、加签支持查看审批记录支持查看流程图已办任务支持撤回我的在办支持撤回、催办待办、已办、我的在办、我的已办列表，支持按照时间、单据类型筛选审批页面有标准版样式和新版样式，如下图：应用场景主要用于移动审批相关链接：消息平台开发手册：https://club.kdcloud.com/school/6110工作流常见问题汇总: https://club.kdcloud.com/article/183140 工作流平台特性汇总：https://club.kdcloud.com/article/56392500931676161流程服务社区文档入口：https://club.kdcloud.com/article/183308 ",url:"https://club.kdcloud.com/article/86788530365735936?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|45",updateTime:"2020-09-07",viewCount:196,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/50545044725693953?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|46"]}],type:"Help",title:"允许发送渠道待办介绍",desc:"功能介绍1. 允许发送渠道待办用于控制苍穹移动端待办任务，默认为开启状态2. 关闭后，通过消息渠道发送的待办任务均不能发送a. 云之家、邮件、短信、钉钉、企业微信、welink、生态云之家都收不到待办b. 协办、转交、加签类型待办任务不受此开关控制，依然可以在移动端收到待办c. PC端所有任务不受此开关控制3. 人工节点、审批节点、会审节点支持此属性应用场景总经理在处理任务时习惯在PC端处理，不希望移动端有待办任务通知；那么可以选中总经理节点，关闭“允许发送渠道待办”开关",url:"https://club.kdcloud.com/article/50545044725693953?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|46",updateTime:"2020-05-28",viewCount:156,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172900322322/answers/136127212595215373?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|47"]}],type:"Help",title:"企业平台上怎么能更改通讯录的手机号？",desc:"【操作步骤】1、在云平台通讯录页面，点击最下面的页签，进入【云之家管理中心】2、点击对应的人员，在【查看详情】里面修改。如图：[图片][图片][图片]",url:"https://club.kdcloud.com/questions/136127172900322322/answers/136127212595215373?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|47",updateTime:"2020-12-30",viewCount:18,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172531223583/answers/136127212561660933?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|48"]}],type:"Help",title:"客户收货后的产品还没有注册激活，但是，CDKEY丢失了怎么处理？",desc:"【说明】因为产品还没有注册激活，不能按照找回CDKEY流程提交找回申请。正确的找回流程如下：云之家-智能审批-金蝶中国后勤流程-【未注册产品找回CDK】（机构均可提交）",url:"https://club.kdcloud.com/questions/136127172531223583/answers/136127212561660933?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|48",updateTime:"2020-12-30",viewCount:19,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/13304?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|49"]}],type:"Help",title:"工作流消息中心与待办任务介绍",desc:"第一部分：消息中心介绍 1. 苍穹的消息主要分为四类，分别为报警、通知、任务、预警，每种类型的消息均可以配置以何种消息渠道发送出去，比如报警类的消息可以即时的以短信的方式通知。通知和预警类的消息可以只发系统消息。任务类的消息主要指的是待办任务，可以通过设置的消息渠道快速的推送给相关干系人。相关的设置可以在系统管理-消息平台-消息类型中设置。 2. 苍穹平台默认内置了六个消息渠道，分别是云之家，邮件、短信、企业微信、钉钉、welink。可以在系统管理-&gt;消息平台-&gt;消息渠道进行禁用和启用。禁用之后，苍穹的待办任务消息和普通消息都不会发送到相应的渠道。 每个消息渠道可以自定义自己的参数，在消息渠道初始化时加载并且解析。 3. 发送消息时，支持设置相关的消息模板，消息模板中可以选择表达式，选择单据上的某个字段。可以定义每个实体在某个消息渠道下的模板内容，比如系统默认内置了流程中待办任务对应的邮件模板。第二部分：待办任务移动端审批 流程中每个需要人工处理的节点都可以推送待办任务到相应的人，默认推送公有云云之家的待办通知，平台提供云之家轻应用【流程助手2.0】，它既可以对接苍穹工作流的待办任务，也可以对接EAS工作流的待办任务，有两个入口可以进行移动审批，下面分别介绍。 1. 通过云之家待办通知接入，如下图：点击待办任务之后，打开苍穹工作流的审批界面，如下图：可以同意、退回，也可以和相关审批人员、提单人进行讨论，或者转发，传阅等。 2. 通过流程助手2.0接入，进行移动端审批。流程助手2.0既可以接入EAS的流程待办，也可以接入苍穹的流程待办，默认为云之家的轻应用，需要对应的圈子开通才可以使用，开通之后，可以从云之家轻应用列表中进入，如下图： 点击某一个待办任务，即可打开任务进行审批。相关连接：待办消息如何与第三方APP集成",url:"https://club.kdcloud.com/article/13304?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|49",updateTime:"2020-04-22",viewCount:827,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/80589318384867072?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|50"]}],type:"Help",title:"移动端短信登录",desc:"客户场景：轻应用集成苍穹手机端下面以云之家轻应用为例1、 在轻应用配置管理中心配置页面链接，构造访问地址 示例： 域名：feature.kingdee.com访问地址配置：https://feature.kingdee.com:1026/patchbase/login-mobile.html?redirect=https%3A%2F%2Ffeature.kingdee.com%3A1026%2Fpatchbase%2Fmobile.html%3Fform%3Der_mainpage_daily2、 通过云之家打开轻应用基线主干测试，进入应用登录界面 3、 选择短信登录，通过短信登录的方式进入苍穹手机端4、点击登录界面的左下角：短信登录，进入短信登录界面5、 根据url构造的不同form进入对应的页面，下图进入人人费用的表单form=er_mainpage_daily",url:"https://club.kdcloud.com/article/80589318384867072?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|50",updateTime:"2020-08-24",viewCount:211,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/12569?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|51"]}],type:"Help",title:"如何在移动端查看我的分析报表",desc:"如果你在桌面端做好了数据可视化内容，想把它发布到移动端查看要怎么做呢？数据分析和数据斗方均支持一键发布到移动轻应用，我们在桌面端制作好图表后，点击【发布到】-【移动轻应用】，输入发布名称并选择发布路径后点击【确定】即可完成发布。发布后，在云之家的轻分析应用中就可以看到发布过来的数据可视化内容了：你还可以将它分享到云之家群组，发起针对数据的沟通协作。关于移动轻应用的更多功能介绍，请参考https://q.kdcloud.com/support/index.html?version=1.0&amp;docId=T06000000",url:"https://club.kdcloud.com/article/12569?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|51",updateTime:"2019-06-25",viewCount:166,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/162831?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|52"]}],type:"Help",title:"手机端怎样进行资产申请？",desc:"1.申请人如何申请？打开手机，在云之家中找到【人人资产】应用，打开应用，如下图显示：在右上方点击【申请资产】，即进入到资产申请页面，选择需要申请的资产明细，填写申请理由等资产信息后，点击提交，即进入到资产申请审批环节。如审批通过，可以在待办通知中查看到资产领用通知。进入到资产领用通知，确认资产明细信息后，点击签收，即完成了此次员工的资产申请。2.那审批人员如何审批？审批人员打开手机，会在云之家-待办通知中看到资产申请单的审批申请。点开审批申请，会看到这次资产申请单的明细信息，如果同意该员工的申请，则点击【同意】，如果不同意该员工的申请，则点击【驳回】，并写明原因，则流程会退回到该员工。",url:"https://club.kdcloud.com/article/162831?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|52",updateTime:"2019-11-22",viewCount:335,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/147136/answers/172756?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|53"]}],type:"Help",title:"如何与小K 智能语音助手团队取得联系？",desc:"我们为您提供2种联系方式，便于您随时随地的联系我们：①拨打4008-830-830，与售前取得联系；②云之家扫描下方二维码添加我们的同事为外部好友进行联系。[图片]",url:"https://club.kdcloud.com/questions/147136/answers/172756?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|53",updateTime:"2020-06-30",viewCount:37,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/61136186646782464/answers/61136187418534400?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|54"]}],type:"Help",title:"我在构建机器人的过程中遇到阻碍了，解决不了可以咨询谁？",desc:"我们为您提供2种联系方式，便于您随时随地的联系我们：①拨打4008-830-830，与售前取得联系；②云之家扫描下方二维码添加我们的同事为外部好友进行联系。[图片]",url:"https://club.kdcloud.com/questions/61136186646782464/answers/61136187418534400?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|54",updateTime:"2020-06-17",viewCount:30,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172548000781/answers/136127212561660954?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|55"]}],type:"Help",title:"怎么样特殊申请重新注册?",desc:"【概述】如客户目前正在更名中，流程无法马上通过，急需重新注册。或者由于客观原因无法马上提供所需资料但是后续补齐等情况。请联系金蝶分公司核实，并说明原因，云之家联系重新注册审核人员申请特殊重新注册。",url:"https://club.kdcloud.com/questions/136127172548000781/answers/136127212561660954?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|55",updateTime:"2020-12-30",viewCount:10,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172548000780/answers/136127212561660953?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|56"]}],type:"Help",title:"中间件/阿帕斯找回CDKEY流程是什么？",desc:"【说明】中间件的阿帕斯产品找回CDKEY，请将查询函填完以后加盖公章，云之家联系林乔梦申请找回或者邮件发送到邮箱：1017637009@qq.com申请找回。[图片][链接]13-金蝶天燕中间件CDKEY码查询函-2018.doc",url:"https://club.kdcloud.com/questions/136127172548000780/answers/136127212561660953?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|56",updateTime:"2020-12-30",viewCount:11,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172917099536/answers/136127212595215408?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|57"]}],type:"Help",title:"企业认证有什么好处？",desc:"【概述】 企业认证后才能保障您的合法权益，所以针对认证企业的客户，金蝶云提供如下功能：1.已认证企业可以永久下载所购买的金蝶ERP产品的许可证。2.企业认证通过后，对应云之家的企业也同步认证通过，可以享受免费电话，语音会议等等功能，具体点击[链接]查看更多云之家认证介绍3.对于某些自助服务，需要企业认证通过后才提供，方便您快速解决问题。4.在ERP产品中会显示您认证通过的公司名字，保障您使用产品的合法权益，在某些单据中也会显示您认证后的企业名字。",url:"https://club.kdcloud.com/questions/136127172917099536/answers/136127212595215408?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|57",updateTime:"2020-12-30",viewCount:10,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183305?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|58"]}],type:"Help",title:"消息中心-任务介绍",desc:"任务主要用于处理待办、查看流程的处理进展；个性化定制我的文件夹；设置自动处理规则等。待办任务待办任务：指待处理的任务1） 支持单条/批量处理任务2） 支持单条/批量转交（需在设计器开启“允许转交”）3） 支持导出Excel4） 支持传阅（设计器“允许传阅”默认为开启状态），“传阅消息接受人”在消息中心和其他渠道（如云之家）可收到传阅消息5） 支持查看单据6） 支持查看流程图7） 支持指定下一步处理人8） 支持协办（需在设计器开启“允许协办”）9） 支持云之家群聊沟通，群聊人员为审批记录的所有参与人，可通过在消息渠道中禁用云之家消息渠道来隐藏此按钮如何处理待办任务步骤：A提交一个费用报销单（如图1），审批人是B，那么B的待办任务中收到A提交的费用报销单（如图2），B点处理按钮可审批此单(如图3)图1图2图3已办任务已办任务列表中记录的是历史记录，把处理单据的信息都记录了下来,如下图所示：1） 支持撤回（逐级撤回），下个节点未审批时可撤回，详见工作流特性-撤回2） 支持传阅（设计器“允许传阅”默认为开启状态），“传阅消息接受人”在消息中心和其他渠道（如云之家）可收到传阅消息3） 支持查看单据、查看流程图在办申请在办申请：当前用户提交后正在处理的任务，由当前用户发起的、正在处理的申请1） 支持撤回（逐级撤回、整单撤回），详见工作流特性-撤回2） 支持催办，可向当前节点的处理人发送催办消息3） 支持查看单据、查看流程图已办申请已办申请：当前用户提交后处理完成的任务由当前用户发起的、已结束的申请，如下图所示：1） 支持查看单据、查看流程图我的转交我的转交：已转交给他人处理的任务，可以在这里跟踪，如下图所示：1） 支持传阅2） 支持撤回转交3） 支持查看单据、查看流程图我的文件夹我的文件夹：支持自定义文件夹，根据自定义规则把收到的任务显示在不同的文件夹中，如下图所示：自动处理设置自动处理设置：支持满足条件时自动转交、设置优先级、传阅，如下图所示：",url:"https://club.kdcloud.com/article/183305?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|58",updateTime:"2020-04-03",viewCount:344,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183139?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|59"]}],type:"Help",title:"流程管理员介绍",desc:"流程管理员分组织管理流程，并且可以包含下级，不同的管理员管理不同的组织。设置某人为流程管理员之后，此人会具有工作流服务的所有权限。流程管理员可以收到异常流程消息通知，比如：“大华深圳”的流程管理员是IERP，那么“大华深圳”组织及下级部门的流程出现异常时，IERP会收到云之家流程助手消息通知，如下图",url:"https://club.kdcloud.com/article/183139?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|59",updateTime:"2020-03-30",viewCount:221,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172933876766/answers/136127212746210327?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|60"]}],type:"Help",title:"登录云平台，使用同一个手机号码，但是有两个密码，分别用不同密码登录进去看到的企业等信息不一样",desc:"【原因】 有可能是同一个手机号码，一个在云企业平台上进行了注册，一个在云之家进行了注册。即可以理解为有两个账号，可以查看登录云企业平台后，查看个人信息中的ID是否是不同的两个。",url:"https://club.kdcloud.com/questions/136127172933876766/answers/136127212746210327?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|60",updateTime:"2020-12-30",viewCount:6,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172883545089/answers/136127212578438183?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|61"]}],type:"Help",title:"云平台新增注册用户，录入手机号码后，手机会自动变成其他号码？",desc:"【概述】1、可能这两个号码互相绑定了，请拨打云之家热线：4008308110或者联系云平台的人员申请将这两个手机号解绑。2、用管理员账号登录云平台，在【注册用户别表】处，勾选该员工，在【管理用户】下操作【员工离职】。3、重新在【添加用户】--【单个录入】重新新增注册用户。",url:"https://club.kdcloud.com/questions/136127172883545089/answers/136127212578438183?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|61",updateTime:"2020-12-30",viewCount:28,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/162832?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|62"]}],type:"Help",title:"手机端怎样进行资产退库、移交",desc:"由于一些原因，需要对名下的资产进行退库或移交，可以通过手机端方便处理。打开手机，在云之家【人人资产】应用中找到【我的资产】：选择需要操作的资产，点击进入到资产卡片页面，会看到下方有【转移】、【退库】两个按钮。以【退库】为例，点击【退库】按钮，录入事由，点击【提交】退库申请发起完成，可以在“在办事项”中看到当前退库单所处的流程资产管理员同意后，资产的退库就完成了。【移交】操作与【退库】类似，请参照进行。",url:"https://club.kdcloud.com/article/162832?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|62",updateTime:"2019-11-22",viewCount:333,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172548000791/answers/136127212561660964?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|63"]}],type:"Help",title:"更改产品使用权的流程？",desc:"【说明】金蝶软件产品使用权在关联公司之间转移，此时产品使用主体变更，符合“产品使用权转移”流程。产品使用权转移流程需要机构运营在云之家【智能审批】流程的“金蝶软件产品使用权转让申请”流程中发起，具体更详细的转让规则及所需资料可让客户直接联系分公司咨询。",url:"https://club.kdcloud.com/questions/136127172548000791/answers/136127212561660964?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|63",updateTime:"2020-12-30",viewCount:11,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/69031062638498816?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|64"]}],type:"Help",title:"移动端任务审批完成后如何跳转到第三方表单",desc:'需求描述移动端待办任务处理完成后，需要重定向到第三方表单目前处理策略1、集成云之家APP 1）待办任务列表：“系统参数”中勾选“返回云之家待办通知”，移动端审批处理完成后，会返回待办通知列表；“系统参数”中没有勾选“返回云之家待办通知”，移动端审批处理完成后，会跳转到流程助手页面待办列表 2）流程助手待办列表：任务处理完成后，会返回流程助手待办列表2、集成的其他渠道：钉钉、企业微信、WeLink、短信、邮件，任务处理完成后，显示的是当前任务的查看页面（即页面下方没有最初展现的处理任务按钮），该机制是由于苍穹目前暂时无法关闭集成的其他渠道页面解决方案通过扩展审批处理页面，增加扩展插件，来实现1. 扩展标准页面wf_approvalpagemobile_bac应用 - - 开发平台 - - 搜索 wf_approvalpagemobile_bac，找到这个页面并扩展2. 在扩展的页面中，禁用插件kd.bos.workflow.taskcenter.plugin.ApprovalPageMobilePluginNew新增并启用扩展的插件，例如kd.bos.workflow.taskcenter.plugin.ApprovalPageMobileDemoPlugina) 插件中关键代码参考给出的示例代码package kd.bos.workflow.taskcenter.plugin;import java.util.EventObject;import java.util.HashMap;import java.util.Map;import kd.bos.form.IClientViewProxy;import kd.bos.form.control.events.ItemClickEvent;import kd.bos.form.events.ClosedCallBackEvent;import kd.bos.form.events.OnGetControlArgs;public class ApprovalPageMobileZhangTaiPlugin extends ApprovalPageMobilePluginNew {@Overridepublic void afterCreateNewData(EventObject evt) { super.afterCreateNewData(evt);}@Overridepublic void onGetControl(OnGetControlArgs e) { super.onGetControl(e);}@Overridepublic void itemClick(ItemClickEvent evt) { super.itemClick(evt);}@Overridepublic void click(EventObject evt) { super.click(evt);}@Overridepublic void closedCallBack(ClosedCallBackEvent e) { String actionId = e.getActionId(); if("btntransfer".equals(actionId) || "approvalBtn".equals(actionId)){ //转交、同意or驳回操作，从成功页面回调后的情况 || 终止的情况 String operation = (String) e.getReturnData(); if(!"cancel".equals(operation)){ IClientViewProxy proxy = this.getView().getService(IClientViewProxy.class); Map&lt;String, String&gt; mpURL = new HashMap&lt;&gt;(2); mpURL.put("url",""); // 重定向的页面地址，比如 https://www.yunzhijia.com/ mpURL.put("noPushState", "true"); proxy.addAction("openUrl", mpURL); } }else { super.closedCallBack(e); }}}相关链接：工作流常见问题汇总: https://club.kdcloud.com/article/183140流程服务社区文档入口：https://club.kdcloud.com/article/183308',url:"https://club.kdcloud.com/article/69031062638498816?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|64",updateTime:"2020-07-09",viewCount:274,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/116238588102083072?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|65"]}],type:"Help",title:"基础服务云知识精选",desc:" 发布说明发布版本：V3.0适用范围：云苍穹基础系统服务部上线日期：每两周迭代更新 发布内容 1. 组织建模企业、行政组织查看>部门查看>组织形态查看>业务单元查看>行政组织引入引出查看>业务单元引入引出查看>业务单元分配部门查看>组织树支持显示编码以及按照编码查询组织查看>部门属性管理中如何添加属性查看>业务单元间协作查看>行政组织跨组织批量封存查看>行政组织支持旧组织封存并新增原组织（同级同名组织）查看>2. 人员建模人员查看>人员：左边树支持搜索查看>人员：发起沟通查看>3. 云之家同步云之家同步可设置不需同步的属性人员兼职可设置上级，同步云之家查看>4. 管控策略管控策略：介绍查看>管控策略：新特性：多级个性化、自动个性化查看>管控策略：基本操作介绍查看>管控策略：分配界面、分配查询界面支持包含下级查看>管控策略：查询下级数据查看>管控策略：小知识点总结（一）查看>管控策略：个性化数据变更控制策略查看>5. 角色和权限管理员查看>特殊数据权限查看>列表数据权限查看>权限问题FAQ1查看>权限问题FAQ2查看>字段权限查看>权限案例一查看>通用角色和业务角色的区别查看>6.登录默认登录方式配置功能查看>AD域登录配置查看>开启登录密码策略校验查看>通用SSO（单点登录）配置方案查看>如何隐藏登录界面中的“”记住账号密码”功能查看>移动端短信登录查看>手机验证码+密码双保险登录查看>不同数据中心配置不同域名来访问查看>7. 许可许可：苍穹许可获取同步查看>许可：定时同步查看>许可：自动释放禁用人员许可查看>许可：分配许可查看>许可：更新产品实例码查看>许可：连接配置列表出现许可信息“许可不足”分析详解查看>8. 编码规则编码规则：高级设置功能查看>编码规则：单据引入时，无编码查看>编码规则：单据引入时，有编码查看>编码规则：特殊化设置：受控组织、适用规则查看>编码规则：拓展设置：应用规则、流水号依据查看>编码规则：断号表查看>编码规则：最大号查看>编码规则：最大号与断号维护查看>",url:"https://club.kdcloud.com/article/116238588102083072?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|65",updateTime:"2021-03-05",viewCount:1061,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/42667332876304384?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|66"]}],type:"Help",title:"金蝶云•苍穹流程服务云特性汇总",desc:" 发布说明发布版本：苍穹V3.0适用范围：苍穹流程服务上线日期：每周迭代更新补丁号：BOS_V3.0.002 发布内容 流程设计中心加签（前加签、后加签）查看>指定下一步参与人查看>会审模式查看>节点复制查看>流程校验查看>单据字段修改及提交校验查看>自动审批查看>汇聚查看>任务处理时限控制查看>协办查看>委托报销查看>转交查看>参与人查看>条件规则查看>设计器流程导入导出查看>打印标识查看>插件查看>流程变量查看>审批要点查看>扩展按钮设置查看>决策项查看>设计器节点查看>允许发送渠道待办查看>条件规则优化查看>流程发布查看>工作流集成智能洞察查看>自动协办查看>单据分组后批量处理查看>参与人支持显示审批人部门与组织查看>上传流程附件查看>子流程功能介绍查看>页面参数查看>由审批人决定驳回后是否重新走流程查看>流程管理中心动态配置方案查看>管理中心导入导出查看>模拟测试查看>流程监控中心流程实例查看>任务监控查看>历史流程查看>基础资料工作流角色查看>常用审批意见查看>移动单据摘要查看>单据流程属性设置查看>组织类型查看>流程管理员查看>配置管理工作流协作关系查看>流程助手系统映射查看>流程助手系统类型查看>对象扩展属性查看>消息中心运行时流程图介绍查看>传阅查看>催办查看>撤回查看>消息中心-任务查看>消息中心-消息查看>消息中心与待办任务介绍查看>消息平台配置简介查看>待办消息与第三方APP集成查看>工作流审批记录支持自定义链接查看>审批记录和节点详情中支持html文本查看>支持预测流转路径及预估参与人查看>任务处理支持批量同意、批量驳回查看>单据未提交时支持查看流程图查看>移动端相关云之家【流程助手】待办人数显示当前审批节点名称查看>云之家群组支持设置主题查看>云之家流程助手支持按任意时间筛选查看>流程助手功能简介查看>系统参数工作流系统参数介绍查看>",url:"https://club.kdcloud.com/article/42667332876304384?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|66",updateTime:"2020-12-28",viewCount:1656,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172933876771/answers/136127212746210332?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|67"]}],type:"Help",title:"已认证的企业如何取消？",desc:"取消企业认证前提条件之一：1、该企业下面无产品。2、该产品绑定的企业认证信息不正确。3、存在两个或两个以上已认证的同名企业。4、需要更换云之家团队。【方法】拨打4008836836-0电话，提供公司名称全称申请取消。说明：正式的产品如果申请了退回企业认证，可能会导致软件无法使用。需尽快提交企业认证并跟进审核通过。",url:"https://club.kdcloud.com/questions/136127172933876771/answers/136127212746210332?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|67",updateTime:"2021-02-10",viewCount:25,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/135333469537814272/answers/135333469554591488?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|68"]}],type:"Help",title:"银企云私有化部署",desc:"银企私有云分为非容器化和容器化的部署方案：测试环境如果没有k8s平台，可以选择使用私包部署的方案，对应参考文档《金蝶银企云非容器化部署手册》正式环境需要用k8s平台完成银企云镜像的部署，参考文档《银企私有云容器化部署指导文档》目前已经推出银企云自动化部署k8s平台（支持单节点部署模式）。k8s平台搭建可前往：[链接]https://vip.kingdee.com/article/104540881780103936 下载部署工具，结合部署手册进行安装。银企云安全代理程序下载论坛地址：[链接]https://vip.kingdee.com/article/96917826920647425前置机代理程序下载论坛：[链接]https://vip.kingdee.com/article/95932679937684992说明：1、两份部署文档互有补充，建议先理解银企云的部署架构，了解哪些是共用组件，银企云依赖组件，银企云服务组件；2、非容器化部署可以省掉一部分组件的部署，比如ELK组件，银企云的补丁管理组件，dubbo监控组件，容器化部署所需组件必须全部部署；3、私包部署解压即可，不需要安装，根据文档，先搭建好基础组件的运行环境，然后调整银企云各服务组件的配置，最后按照启动顺序，依次将服务启动。4、回单云为单点登录，需要借助于银企云管理端进行跳转，这点不同于EAS回单代理程序，而且这里需要将回单云连接配置在Nginx上，需要SSL证书完成https配置，SSL证书可以使用客户已购买的证书，或者使用openSSL、jdk自带keytool工具制作，将生成的crt证书和私钥key配置在nginx上即可。部署（银企云、回单）手册下载地址：[链接]https://pan.yunzhijia.com/s/MTE4MTUxOSxiYmZm#/ 访问密码：w5ar来自：云之家企业云盘私包部署下载地址：[链接]https://pan.yunzhijia.com/s/MTE3OTY2NyxiY2I3#/ 访问密码：5y2f来自：云之家企业云盘镜像部署下载地址：[链接]https://pan.yunzhijia.com/s/MTE3OTY2Niw2Yzlm#/ 访问密码：fan7来自：云之家企业云盘数据库脚本：[链接]https://pan.yunzhijia.com/s/MTE4OTQ0MywzMGMx#/访问密码：a4aj来自：云之家企业云盘 关于nginx如何进行https配置操作，可以前往云盘下载工具与说明文档：[链接]https://pan.yunzhijia.com/s/MTE3OTY1OSw5MTdl#/ 访问密码：mi4r来自：云之家企业云盘----------------------------------------------------银企云许可申请------------------------------------------------------银企云正式、测试许可申请操作手册：[链接]https://pan.yunzhijia.com/s/MTE5MzQxNSwyYzk3#/ 访问密码：ymrd来自：云之家企业云盘----------------------------------------------------银企云补丁更新------------------------------------------------------银企云补丁（v1.2.1）：[链接]https://pan.yunzhijia.com/s/MTE5MzM5Nyw5YTA3#/ 访问密码：ssnj来自：云之家企业云盘银企云补丁流程：1、银企云业务管理平台以系统管理员身份，完成补丁包上传，补丁安装；2、补丁包中的私包文件将在独立补丁服务ebpatch内完成安装；3、当银企云容器重新启动时，自动获取补丁服务信息，如果有补丁更新，自动下载补丁包，完成容器内私包替换；4、待应用重启后，应用更新完成；5、以系统管理员身份重新登录银企云业务管理平台，进行数据库升级操作，如果未升级数据库，银企云后台调度将会停止工作；[图片][图片]银企云银行支持列表：[图片][图片]支持回单的银行列表：[图片]",url:"https://club.kdcloud.com/questions/135333469537814272/answers/135333469554591488?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|68",updateTime:"2021-01-08",viewCount:38,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183301?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|69"]}],type:"Help",title:"历史流程介绍",desc:"历史流程中记录已经结束的流程信息，包括终止的流程、废弃的流程及正常结束的流程。功能介绍支持导出历史流程支持查看单据支持查看流程图云之家异常待办是为了方便管理员处理、跟踪偶发性异常待办任务查看流程操作日志：记录流程流转过程中所有的操作信息，包括：节点名称、处理人、操作、操作日期、操作终端、处理意见、节点编码等等相关链接：金蝶云•苍穹流程服务云使用指南：https://club.kdcloud.com/article/183308 工作流平台特性汇总：https://club.kdcloud.com/article/42667332876304384工作流常见问题汇总: https://club.kdcloud.com/article/183140",url:"https://club.kdcloud.com/article/183301?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|69",updateTime:"2020-04-03",viewCount:185,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/155396801472658176?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|70"]}],type:"Help",title:"行政组织支持封存旧组织并新增原组织（同级同名组织）",desc:"客户场景：企业定期对组织及组织关联历史业务数据进行封存，同时新增相同名称的原组织做后续的业务，以此隔离历史数据，所以需要苍穹平台支持同级组织允许“启用和封存”同名，但当前启用的同级组织允许只有1个，封存的同级同名组织允许多个；实际业务场景中，企业同级部门不会出现同名情况，不同部门间会出现相同名称，如法人公司A下有财务部、行政部，法人公司B下面一样有 财务部、行政部等，但不会出现 法人公司A下同时有2个财务部；所以：苍穹平台支持：1、组织可用状态下，同级组织不允许同名，不同级组织允许同名2、组织封存状态下，同级组织 允许多个同名封存组织，同级组织允许 1个可用组织和多个封存组织同名业务流程：路径：系统服务云-&gt;基础服务-&gt;组织管理-&gt;行政组织1、组织可用状态下同级组织不允许同名：不同级组织允许同名：2、组织封存状态下：同级组织允许多个同名组织封存，同级组织允许 1个可用组织和多个封存组织同名：该特性支持 组织变更，组织增量（如 引入、云之家同步、苍穹平台接口同步等）判断组织变更：组织名称修改、组织修改上级等组织增量：见其它知识贴引入（包括更新/新增）：https://vip.kingdee.com/article/127508224378334208云之家同步：https://club.kdcloud.com/article/170804",url:"https://club.kdcloud.com/article/155396801472658176?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|70",updateTime:"2021-03-04",viewCount:6,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/67266822227217408?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|71"]}],type:"Help",title:"采购协同、供应协同应用简介",desc:" 采购协同旨在帮助企业采购业务和供应商无缝对接，实现采购无纸化、实时化、移动化，可大幅减轻采购员的下单工作量，加快供应商的接单相应速度，减少沟通成本。采购协同除了将采购和库存信息传递给供应商外，还可实现账务系统和付款信息同步，让供应商能够实时了解回款进度，减少线下沟通。为了实现采购员和供应商业务员能够实时了解业务状况，采购协同支持移动应用，用户直接用手机就可以查询到业务信息，平台也已经实现采购方和供应商的消息提醒，内容可自定义，消息方式可配置短信、云之家、钉钉等。业务流程图：",url:"https://club.kdcloud.com/article/67266822227217408?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|71",updateTime:"2020-07-04",viewCount:254,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172917099559/answers/136127212611992598?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|72"]}],type:"Help",title:"重新注册申请，但是申请的过程中提示：此序列号不能申请特征码修改 ？",desc:"【概述】请确认您的产品是否是智能卡产品。1、如果是非注册用户的智能卡产品，不需要提交重新注册，直接操作升级智能卡即可。2、如果是注册用户的智能卡产品，请说明理由并联系经销商/分公司核实后，由分公司云之家联系重新注册审核人员申请修改软件特征码。（需提供产品序列号、CDKEY、新软件特征码、《重新注册申请表》、营业执照）",url:"https://club.kdcloud.com/questions/136127172917099559/answers/136127212611992598?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|72",updateTime:"2020-12-30",viewCount:9,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183306?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|73"]}],type:"Help",title:"消息中心-消息介绍",desc:"消息消息通知消息分报警消息、预警消息和通知消息，用户可以通过消息链接快速跳转到处理界面消息通知场景：1.会审订阅结果2.转交订阅结果3.重新设置参与人订阅结果4.各个节点（审批节点、人工节点、会审节点、自动节点）的出口消息和入口消息 1）支持在不同的条件下收到不同的消息 2）支持不同的人收到不同的消息 3）支持消息内容插入表达式 4）发送时机支持：节点离开时、节点进入时、同意、驳回/不同意 5）消息渠道支持云之家、企业微信、钉钉、短信、邮件等 6）支持发送链接：在消息中心-消息页签收到链接，也可以通过渠道接收链接，通过链接可以查看单据5.消息节点消息 1）支持在不同的条件下收到不同的消息 2）支持不同的人收到不同的消息 3）支持消息内容插入表达式 4）消息渠道支持云之家、企业微信、钉钉、短信、邮件等 5）支持发送链接：在消息中心-消息页签收到链接，也可以通过渠道接收链接，通过链接可以查看单据6.传阅、催办消息预警消息场景：1.任务处理时限控制：任务过期之前或任务过期时发送预警消息报警消息场景： 1.流程挂起：给管理员发送错误消息2.任务处理时限控制：任务过期之后发送报警消息相关链接：金蝶云•苍穹流程服务云使用指南：https://club.kdcloud.com/article/183308 消息中心使用手册：https://club.kdcloud.com/school/6110消息中心问题汇总：https://club.kdcloud.com/school/66550632017825280",url:"https://club.kdcloud.com/article/183306?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|73",updateTime:"2020-12-22",viewCount:739,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/106339061089970432?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|74"]}],type:"Help",title:"2020-09-10 BOS_V2.0.036 系统服务云前端新特性",desc:" 发布说明发布版本：V2.0H1适用范围：所有客户上线日期：2020-09-24补丁号：BOS_V2.0.036 发布内容 功能优化优化设计器中控件悬停样式查看>bug修复修复附件面板自定义按钮内容显示不全问题新增功能新增附件预览支持云之家预览功能新增财务报表查找、替换、格式刷功能查看>新增设计器样式属性“字体粗细”查看>新增单据体批量属性编辑中列标题处全选复选框功能新增移动端工具栏方案查看>新增移动端组合控件功能查看>新增移动端录入模板单据头字段分组功能查看>新增移动端设计器标签方案功能查看>新增移动端设计器字段快速绑定功能查看>新增多选F7已选项拖拽排序功能",url:"https://club.kdcloud.com/article/106339061089970432?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|74",updateTime:"2021-01-14",viewCount:45,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/152428/answers/182477?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|75"]}],type:"Help",title:"消息设置常见问题",desc:"场景1：出差申请单总经理同意后，如何给提单人发送云之家消息通知“您提交的出差申请单已经审核通过”操作步骤：选中总经理节点-&gt;消息通知-&gt;离开节点时消息，添加消息接收人，并设置发送时机及消息内容，如下图所示：[图片][图片]运行效果：[图片][图片]场景2：移动端收到的流程助手消息不好看，如何自定义消息模板操作步骤：系统管理-&gt;消息平台-&gt;消息模板，新建流程任务，设置待办的消息模板，如下图所示：[图片]运行效果：[图片]流程任务其他场景：[图片]场景3：当有待办时，通过发送消息提醒，如何选当前节点参与人？操作步骤:在参与人类型中添加业务插件（JAVA插件或脚本），如下图所示：详见工作流插件开发指南（含样例）V2.0（P3参与人插件）https://club.kdcloud.com/school/6107[图片][图片]场景4：PC端单据审批详情界面，如何隐藏“发起群聊沟通”操作按钮？操作步骤：系统管理-&gt;消息渠道，把云之家禁用[图片]场景5：发起公众号能不能取消操作步骤：在配置工具-系统参数里将公众号取消勾选[图片]",url:"https://club.kdcloud.com/questions/152428/answers/182477?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|75",updateTime:"2020-03-15",viewCount:330,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/124883947334331392?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|76"]}],type:"Help",title:"金蝶云・苍穹V3.0系统设置新特性发布",desc:"V3.0重大特性1. 调度作业增加消息通知：调度作业执行后可以通过云之家、邮件给作业负责人发送失败或者成功通知，可在调度作业中设置消息的接收人和内容。https://club.kdcloud.com/article/94451878628398336V3.0重要特性汇总系统设置1. 新增了审计日志服务https://vip.kingdee.com/article/99168469610237696调度计划1. 增加了调度计划cron表达式方式设置的功能https://vip.kingdee.com/article/944490813296202242. 增加了调度作业支持设置发送通知的功能https://vip.kingdee.com/article/94451878628398336相关链接金蝶云·苍穹 系统服务云使用指南https://club.kdcloud.com/article/84379300303902464系统服务云新特性发布汇总https://club.kdcloud.com/article/76620611719369216",url:"https://club.kdcloud.com/article/124883947334331392?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|76",updateTime:"2020-12-10",viewCount:186,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/96325554084748288?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|77"]}],type:"Help",title:"移动端收款认领操作指引",desc:"一、入口1、云之家应用：通过“收款认领”和“认领中心”两个应用分别进入业务员收款认领和财务人员确认收款的操作界面2、消息通知：以下场景会发送系统消息到云之家“金蝶云苍穹消息助手”公众号，并提供相应链接进入处理 1）财务人员通知用户进行收款认领 2）财务人员取消通知认领 3）财务人员驳回认领单二、业务员认领收款1、认领：可在“认领通知”列表查看所有通知到当前用户的认领通知单，可查看通知单信息，并对财务未确认的通知单进行认领操作，填写相关信息后，提交收款认领单，即完成收款认领；提交后的收款认领单，可在“处理中”列表查询，财务确认后可在“已完成”列表查询2、申诉：可在“认领通知”列表对财务已确认的认领通知单，发起申诉，填写相关信息后，提交申诉类型收款认领单，即完成对通知单的申诉3、变更：可在“已完成”列表，查询财务已确认的收款认领单，如需变更，可点击“变更”按钮，填写变更后的信息后提交即生成一张变更类型的收款认领单4、修改：可在“已完成”列表，查询申诉中的收款认领单，在财务确认之前可发起对原单的变更，点击“修改“按钮，填写修改后的信息后提交即生成一张调整类型的收款认领单5、合并：对于同一笔收款分为多笔流水的情况，业务员可在移动端对多笔收款进行合并/取消合并的操作。点击“合并”按钮，选择需要合并的多笔数据后，进行合并，合并后自动跳转至合并生成的认领单。三、财务人员确认收款财务人员可通过“认领中心“应用，在移动端实时对认领通知单进行以下操作：1、 确认认领结果2、 取消确认认领结果3、 取消通知认领4、 驳回5、 转发",url:"https://club.kdcloud.com/article/96325554084748288?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|77",updateTime:"2020-11-16",viewCount:116,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/13403?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|78"]}],type:"Help",title:"打造个性化首页",desc:"1、登录金蝶云苍穹系统，在首页界面点击右上角调整布局按钮，首页变成编辑态；2、进入编辑态便可打造个性化首页；1）点击底部的添加卡片，弹出选择卡片弹窗，可供选择的卡片类型包括快速发起卡片、单据统计卡片、多项单据统计卡片、云之家订阅卡片等，用户可根据个人喜好选择合适的卡片类型，并且订阅自己关注的内容；2）选好卡片类型，并完成卡片内容设置后，首页桌面会生成刚刚设置的卡片；3）可随意拖动卡片位置；4）可通过拖动设置卡片大小；3、完成首页设置后点击完成按钮出操作确认，会提示是否修改为个性化方案，点击中间的个性化按钮，即设置成功；4、切换方案。点击右上角的切换方案按钮，弹出首页方案列表，用户可以根据喜好切换方案。",url:"https://club.kdcloud.com/article/13403?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|78",updateTime:"2019-07-11",viewCount:474,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172950653960/answers/136127212746210345?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|79"]}],type:"Help",title:"个人身份证可以认证k3产品吗？",desc:"【答案】原则上k/3的产品必须以企业名称认证，如有特殊情况需要用个人身份证认证的，需要申请。请您提供软件的购买合同并说明原因，由经销商/分公司云之家联系产品线负责人（k/3wise、k/3cloud联系韩革缨、EAS产品线负责人徐昊），和 企业认证审核人员：刘思（金蝶云平台部/云支付与账号中心产品部）申请。一般一个工作日内审核。审核通过后即可进行个人认证。谢谢！",url:"https://club.kdcloud.com/questions/136127172950653960/answers/136127212746210345?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|79",updateTime:"2020-12-30",viewCount:15,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172933876759/answers/136127212746210320?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|80"]}],type:"Help",title:"产品可以个人的名义认证吗？",desc:"【说明】原则上k/3的产品必须以企业名称认证，如有特殊情况需要用个人身份证认证的，需要申请。请您提供软件的购买合同并说明原因，由经销商/分公司云之家联系产品线负责人（k/3wise、k/3cloud联系韩革缨、EAS产品线负责人徐昊），和 企业认证审核人员：刘思（金蝶云平台部/云支付与账号中心产品部）申请。一般一个工作日内审核。审核通过后即可进行个人认证。谢谢！",url:"https://club.kdcloud.com/questions/136127172933876759/answers/136127212746210320?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|80",updateTime:"2020-12-30",viewCount:12,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172950653972/answers/136127212746210357?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|81"]}],type:"Help",title:"如何做产品转移/企业合并",desc:"【说明】请您按照以下格式填写信息申请产品转移。谢谢！（1、产品对应的企业名称需要与ICRM一致。2、新企业必须是已认证的。）金蝶中国的产品（EAS、k/3wise、k/3cloud、OA、S-HR）请分公司云之家联系欧媛妍。[链接] 转移原因：需转移的产品序列号：建议：在申请产品转移前，请将注册用户批量导出备份。产品转移后，有可能会导致注册用户丢失或者禁用。可操作注册用户批量删除，再批量导入之前备份的注册用户表格。如未丢失，则不需要此操作。",url:"https://club.kdcloud.com/questions/136127172950653972/answers/136127212746210357?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|81",updateTime:"2020-12-30",viewCount:21,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/68750958678587648?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|82"]}],type:"Help",title:"人人资产V2.0H1发布新特性啦！",desc:"特性一：资产申请员工个人发起资产申请，支持工作流审批，提交后进入审批流程流转，经上级领导和资产管理员审批后在固定资产模块生成资产领用单。资产管理在资产领用单中分配资产给领用人，提交后进入流程流转，员工收到资产后对领用单进行签收，完成资产领用。支持单据流转情况查看。特性二：资产移交员工选择个人资产发起资产移交，维护接收人等信息后，提交进入审批流程流转，经资产管理员审批、接收人签收后完成资产移交。支持单据流转情况查看。特性三：资产退库员工选择个人资产发起资产退库，提交进入审批流程流转，经库管员签收后完成资产退库。支持单据流转情况查看。特性四：个人资产查看人人资产首页片式展示员工个人资产情况。特性五：员工自助盘点（移动端）盘点任务负责人通过云之家发送订阅消息给资产使用人，员工通过【人人资产】移动轻应用完成扫码盘点、反馈未盘到原因，盘点结果同步更新盘点记录。",url:"https://club.kdcloud.com/article/68750958678587648?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|82",updateTime:"2020-07-30",viewCount:127,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/106343017576693504?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|83"]}],type:"Help",title:"2020-09-24 BOS_V2.0.037 系统服务云前端新特性",desc:" 发布说明发布版本：V2.0H1适用范围：所有客户上线日期：2020-10-08补丁号：BOS_V2.0.037 发布内容 功能优化优化悬浮菜单，支持右下角悬浮菜单定制功能查看>优化PC端附件，支持多文件同时预览功能查看>优化总账账表界面，调整滚动条颜色和大小优化常用过滤和方案过滤，支持长日期范围选择时分秒功能优化移动端附件，支持云之家预览图片时能够进行图片列表切换功能优化向导控件，支持设置文字位置为左右结构，并且能自适应屏幕宽度bug修复修复单据体折叠情况下,表格未加载完毕时调用接口导致表格不渲染的问题修复欢迎页面提示语言与环境不一致问题新增功能新增接口控制附件的上传、下载按钮的显示和隐藏功能查看>新增PC端第三方系统idm单点登录苍穹系统功能新增图片字段“默认图片”属性新增图片字段裁剪图片功能查看>新增报表合计行功能新增支持配置字段默认属性：字段风格、标题位置查看>",url:"https://club.kdcloud.com/article/106343017576693504?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|83",updateTime:"2021-01-14",viewCount:54,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/14814/answers/20115?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|84"]
}],type:"Help",title:"苍穹部署流程说明",desc:"1，苍穹公有云部署说明部署流程如下：[图片]说明：1）签订合同后，按可以要求时间，提供2个环境给客户：生产环境和沙箱环境；生产环境用于客户生产业务使用，沙箱环境用于可以测试，二开验证等。2）签订合同前，可以申请体验环境，体验环境有效期为1个月，特殊情况，可以延期。3）苍穹公有云特点：快速开通、产品快速迭代、投入少、安全性高。2，苍穹私有云部署说明部署流程如下：[图片]说明：1）签订合同后，需要通过云之家的审批流程进行申请“私有云环境部署流程”。",url:"https://club.kdcloud.com/questions/14814/answers/20115?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|84",updateTime:"2019-07-11",viewCount:1027,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/91238810590966272/answers/91238810826262528?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|85"]}],type:"Help",title:"在使用对话机器人平台之前，需要知道哪些基本概念？",desc:"1、机器人为用户直接提供对话技能的统一入口称为机器人，企业需要为机器人组装技能，选定唯一的租户，并且为机器人配置端信息。用户通过端输入（文字、语音）直接访问机器人。2、端用户与机器人交互的通道。不同端的界面配置信息不同，目前支持的端有云之家原生、云之家轻应用、企业微信和API对接。3、技能技能是指在特定对话场景下的对话能力（例如苍穹财务指标查询技能，云之家使用帮助技能），包括系统技能和自定义技能。自定义技能又分为【任务型技能】和【问答型技能】。预置技能为苍穹对话平台预置的通用场景对话能力，如确认、取消等。4、任务型技能任务型技能在多轮对话中可以准确理解用户需求（意图）和执行任务所需的关键信息（词槽），适用于需要根据不同对话意图和词槽信息给出不同对话答复的对话场景。能够在一些特定的对话场景下高精准地理解并满足用户需求，提高任务执行的完成度，提升用户体验与用户在交互过程中的满意度和愉悦度。比如“提交出差申请”、“设置日程提醒”和“查询财务指标”等等。任务型技能包含了一系列意图的集合，说明某个场景下所包含的所有的意图。例如用户在出差场景下，不仅需要填出差申请单，还可能需要预订出差的机票。那么【出差申请】这个技能下，可能包含两个意图：【填写出差申请单】和【预订机票】。5、问答型技能通过维护知识问答对，实现用户对于各种规则制度、政策法规等信息的查询。适用于问题问法多样，但答案相对固定的对话场景。6、意图说明用户在某个场景下的具体目的。例如用户去出差前必须要提出差申请单，那可能会说：“我要去北京出差”，那么【填写出差申请单】就是用户的意图。7、词槽是满足用户对话意图时的关键信息，分为必须和非必须两类。例如出发时间、出发地、返回时间、目的地和出差事由是提交出差申请单要填写的5个关键信息，这些就是【提交出差申请】这个意图的词槽。8、对话样本对话样本就是真实对话场景下用户表达意图的句子，通过样本的标注来明确在用户说的具体句子里，该如何理解对话意图，哪些词是重要信息，对应的词槽是什么。对话平台通过训练对话样本来实现对话意图的理解，并以此优化算法模型，提高准确度。[图片]9、产品线产品线是实现任务型技能所需业务能力的业务系统类型定义，包括平台级（苍穹、星空、EAS等产品线，由平台管理员定义）、租户级（特定租户的业务系统类别，由租户管理员定义）两类产品线。10、业务接口每个产品线需要提供可被平台调用的业务接口定义，包括接口的入参和出参等。一个产品线可提供多个业务接口，实现不同的业务能力。11、业务系统产品线的具体实例，包括服务器地址，相关认证信息的定义等。一个业务系统属于某一个产品线，一个产品线可以有多个具体的业务系统实现。12、租户具体使用对话机器人的企业，一个租户可以拥有多个机器人，但只能有一个机器人能部署到该组会对应的云之家工作圈的原生渠道。如未配置原生机器人，系统则会默认根据企业云之家工作圈的ERP属性，使用平台管理员配置的的相应ERP专版机器人。",url:"https://club.kdcloud.com/questions/91238810590966272/answers/91238810826262528?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|85",updateTime:"2020-09-09",viewCount:29,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/12782?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|86"]}],type:"Help",title:"消息中心应用介绍",desc:"消息中心是工作流平台提供的全员应用，可收集各业务的任务和消息数据，集中在消息中心查询、处理，同时支持移动和PC两种客户端，任务处理的同时也可以进行社交化的单点或者建群交流。允许用户根据条件设置任务个性化优先级，收录文件夹，并提供任务自动转交、传阅给他人处理等功能。与此同时，消息中心提供丰富API接口，供业务发送、获取、处理不同种类消息数据，并提供消息渠道、消息类型、消息模板功能，实现消息的可配置化，提升消息使用灵活性。消息中心主要特性：1， 提供消息渠道的定义和设置功能，可基于不同的渠道类型设置多个短信、邮件或云之家、钉钉、企业微信的消息发送渠道。在消息渠道的配置中，业务可以根据实际需求，个性化修改处理类、启用状态、以及云之家公众号等属性信息。消息渠道配置信息，保存之后、即时生效可用。2， 提供消息类型设置功能，并预置任务、报警、预警和通知四种类型，与消息渠道组合使用，为用户提供多样化的消息接收终端。3， 提供消息模板设置功能，用户可定义多种消息的表现样式和内容，作用于不同消息场景，从而达到消息主题、内容的配置使用目的。在出厂版本中提供了工作流五种场景（代办、催办、转交、传阅、协办）的预置消息模板。4， 细化任务类型为代办、已办、在办申请和已办申请，并根据不同的业务单据进行菜单分类，同时提供任务处理所需的众多功能，如转交、驳回、传阅、催办、协办、查看流程图、指定下一步参与人、撤回、驳回任务再次提交等。5， 提供自定义文件夹设置功能，可按规则分类存放属于自己的任务，帮助提升用户对任务分类和管理的极致体验。6， 提供任务自动处理规则设置功能，支持任务自动化转交、定义任务优先级（紧急/重要）、并提供任务传阅等功能的入口。7， 提供任务、消息列表强大查询功能，比如快速查询、属性查询、方案查询等。8， 门户首页提供任务、消息各类显示卡片，可以清晰直观了解消息状态；个人中心、门户头像支持即时更新未读消息、未处理待办的数量，点击进入消息中心，快速定位任务消息，提升用户便捷性操作。",url:"https://club.kdcloud.com/article/12782?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|86",updateTime:"2019-11-20",viewCount:282,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172917099523/answers/136127212595215395?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|87"]}],type:"Help",title:"购买了两套产品，一套产品是用自己的手机认证，一套是同事手机认证，怎么将产品转移到自己手机号码下面去？",desc:"【概述】请您按照以下格式填写信息反馈审核，审核通过后，工程师再帮客户申请产品转移。谢谢配合！（1、产品对应的企业名称需要与ICRM一致2、新企业必须是已认证的）【说明】金蝶中国的产品（EAS、k/3wise、k/3cloud（私有云）、OA、S-HR）请分公司云之家联系欧媛妍。申请模板如下：转移原因：需转移的产品序列号：企业名称：建议：在申请产品转移前，请将注册用户批量导出备份。产品转移后，有可能会导致注册用户丢失或者禁用。可操作注册用户批量删除，再批量导入之前备份的注册用户表格。如未丢失，则不需要此操作。",url:"https://club.kdcloud.com/questions/136127172917099523/answers/136127212595215395?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|87",updateTime:"2020-12-30",viewCount:9,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/171177?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|88"]}],type:"Help",title:"流程服务云精选知识合辑【金蝶云苍穹】",desc:"知识太多看不过来？知识精选系列特别梳理了流程服务云2019年发布的知识帖，整理了必读必看的知识点，供大家参考解惑！点击文字即可阅读哟~一、工作流服务金蝶云・苍穹V2.0 工作流平台新特性发布如何找组织部门负责人如何处理离职员工的待办任务待办消息如何与第三方APP集成自动处理设置创建了好多个出差申请单的流程，提单时应该走哪个？设置了工作流角色但流程为什么没有找到参与人新建向导最后一步的单据状态设置是什么意思？新建流程操作指引条件规则的操作符包含、不包含、属于集合、不属于集合的说明与区别为什么收不到云之家\\短信\\邮件消息？如何初步处理挂起的流程二、消息中心工作流消息中心与待办任务介绍还想看更多？更多金蝶云苍穹产品知识、操作指引、热门问题尽在社区知识库！点击链接直达知识库(电脑端打开）☞https://club.kdcloud.com/knowledge",url:"https://club.kdcloud.com/article/171177?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|88",updateTime:"2019-12-25",viewCount:603,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/114674837284523520?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|89"]}],type:"Help",title:"金蝶云·苍穹V3.0 轻分析新特性",desc:"本次金蝶云·苍穹V3.0发版，轻分析发布了以下新特性：1、新增“地图库”应用，可通过该应用的地图设计器自定义地图模板，为数据斗方的“地图”图表类型提供地图模板。2、仪表板支持发布到移动轻应用，并授权给指定的用户或角色。3、仪表板支持云之家沟通、邮件定时推送及移动端定时推送。4、仪表板新增日期范围、多行文字、页签控件、按钮组、弹窗选择器组件。5、数据斗方支持单据联查，数据来源包含业务实体时，可设置联查到业务实体所对应的单据列表页面。6、数据斗方新增GIS地图图表类型。7、可视化内容发布后可在发布管理中直接修改发布方案。8、数据建模支持多分录关系模型。9、移动轻应用支持多数据中心切换。10、移动轻应用支持企业微信、钉钉集成。11、业务主题、仪表板支持携带移动轻应用发布信息导入导出。12、轻分析中心改造，支持树形结构及多页签打开。",url:"https://club.kdcloud.com/article/114674837284523520?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|89",updateTime:"2020-11-12",viewCount:330,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/68761537485330176?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|90"]}],type:"Help",title:"人人资产-开启员工个人资产便捷式管理新时代",desc:"产品简介：人人资产轻应用秉承金蝶云苍穹“人人、体验、生态”的设计理念，以“人“为核心，为员工个人资产业务提供便捷的移动端和PC端入口。员工可通过人人资产快速发起资产申请、进行资产移交或退库、实时查看审批进度，使得员工个人资产管理更加方便、透明、高效。同时人人资产也提供了移动端员工个人资产自助盘点功能，为员工个人资产盘点提供便利，提升企业资产盘点效率。我们的方案：移动端资产申请、移交、退库解决方案a.员工可在手机端查询个人名下资产、在办查询及发起云之家沟通b.员工可在手机端发起、处理资产申请、转移、退库 2.移动端资产盘点解决方案 员工可在手机端对个人名下资产进行扫码盘点，或者反馈盘亏原因。结果自动回传并更新盘点记录。 3.PC端申请、移交、退库解决方案 员工可在PC端查询个人名下资产，查看单据流转情况。 员工可在PC端发起、处理资产申请、转移、退库，",url:"https://club.kdcloud.com/article/68761537485330176?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|90",updateTime:"2020-07-08",viewCount:181,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/138618/answers/163917?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|91"]}],type:"Help",title:"订单的消息怎么启用？什么时候发送？ ",desc:"为促进信息的及时准确传递，订单管理支持消息推送。启用消息推送步骤如下打开系统云-系统管理-消息平台-消息渠道，选中需要启用的消息渠道，如短信、电子邮件、云之家等，点击【启用】即可，如下图[图片]发送消息时间节点：1. 采购方在订单管理中新增一条订单，并且审核完成后，对应的供应商联系人收到一条消息，通知有一条新订单待处理；2. 供应商端发货后，对应的采购方收货人收到一条消息，通知订单已发货；3. 采购方收货后点击退货，退货单审核完成后，对应的供应商联系人收到一条消息，通知订单有退货需处理。",url:"https://club.kdcloud.com/questions/138618/answers/163917?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|91",updateTime:"2019-11-14",viewCount:59,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172514446341/answers/136127212544883715?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|92"]}],type:"Help",title:"金蝶软件产品使用权（含租赁权）转让/调整流程怎么走？",desc:"【操作方法】本业务在云之家智能审批流程的金蝶软件产品使用权转让/调整申请流程中发起。具体申请流程如下： [图片]1.1.1 申请提交资料要求：须提交资料（相关的资料模板，请联系对应的分公司获取） 一、使用权转让 1、客户之间的关联关系证明材料 2、软件产品使用权（租赁权）转让协议 3、待转让/调整产品的相关软件销售合同扫描件 4、金蝶软件产品使用权（含租赁权）转让声明函（分销客户提交） 二、调整纠错1、客户之间的关联关系证明材料 2、金蝶软件产品使用权（含租赁权）转让声明函（分销客户提交） 3、待转让/调整产品的相关软件销售合同扫描件 ",url:"https://club.kdcloud.com/questions/136127172514446341/answers/136127212544883715?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|92",updateTime:"2020-12-30",viewCount:15,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/162893?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|93"]}],type:"Help",title:"金蝶云·苍穹V2.0 轻分析新特性",desc:"本次金蝶云·苍穹V2.0发版，轻分析发布了以下新特性：1、数据建模数据源支持TiDB、达梦、Greenplum、GaussDB、Apache Drill。2、数据建模支持OpenAPI数据源，包括“RESTful数据集”和“程序数据集”两种来源。3、数据建模中“自定义SQL”支持插入系统变量，支持通过系统变量控制数据权限。4、数据斗方新增环形图图表类型。5、数据分析多选框过滤器改造，支持“多选列表”及“多选弹窗选择器”两种模式，其中通过“多选弹窗选择器”可以对备选值进行筛选，筛选结果支持增量式全选。6、数据分析的可视化结果支持通过邮件定时推送。7、数据分析及数据斗方的可视化结果支持通过云之家群聊机器人定时推送。8、提供业务主题及仪表板的补丁预置解决方案，支持苍穹各业务领域以补丁形式发布轻分析内容。9、仪表板执行时，从数据斗方卡片上的“数据分析”图标打开数据分析时，会根据卡片上使用到的字段自动生成数据分析方案。",url:"https://club.kdcloud.com/article/162893?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|93",updateTime:"2019-11-21",viewCount:573,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/43655566745731072/answers/43655568108879872?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|94"]}],type:"Help",title:"​对公借款或者对公报销时，直接付款给供应商，怎么让提单人及时知晓已付款？",desc:"1、系统支持费用单据（借款单、出差申请单（借）、对公报销单、差旅费报销单、对公报销单）在全部付款时，向提单人发送消息。具体操作步骤如下：步骤一:在【系统管理-消息平台-消息模板】编制消息模板，目前系统预置了“借款单”、“出差申请单”、“费用报销单”、“对公报销单”、“差旅费报销单”的消息模板，用户可以选择模板进行修改，如果不需要发送消息，直接删除对应的模板即可，如下图:[图片]步骤二:在模板中，可以编辑发送消息的渠道和消息内容，目前消息渠道支持云之家、短信、邮件，只能选择其中一种。[图片]步骤三: 消息模板编辑完成后，在【系统管理-消息平台-消息渠道】启用对应的渠道即可。[图片]",url:"https://club.kdcloud.com/questions/43655566745731072/answers/43655568108879872?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|94",updateTime:"2020-04-30",viewCount:159,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172917099537/answers/136127212611992576?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|95"]}],type:"Help",title:"为什么一定要认证？",desc:"【说明】没有做企业认证的产品的许可有效期只有8天，企业认证后的产品的许可才是正式的许可。企业认证后才能保障您的合法权益，所以针对认证企业的客户，金蝶云提供如下功能：1.已认证企业可以永久下载所购买的金蝶ERP产品的许可证。2.企业认证通过后，对应云之家的企业也同步认证通过，可以享受免费电话，语音会议等等功能。3.对于某些自助服务，需要企业认证通过后才提供，方便您快速解决问题。4.在ERP产品中会显示您认证通过的公司名字，保障您使用产品的合法权益，在某些单据中也会显示您认证后的企业名字。",url:"https://club.kdcloud.com/questions/136127172917099537/answers/136127212611992576?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|95",updateTime:"2020-12-30",viewCount:12,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/45549?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|96"]}],type:"Help",title:"集成云2.0费用配置操作说明",desc:"金蝶云苍穹-集成服务云使用指南请参考https://club.kdcloud.com/article/45312数据集成方案和启动方案请到云之家企业云盘下载，地址：https://pan.kingdee.com/s/MTE0MTA0NSwwODM0#/ 来自：云之家企业云盘EAS部署与设置：已支持EAS8.0,8.2,8.5,8.6版本，请下载费用报销最新补丁，并安装完成。EAS最新补丁信息可查看 https://vip.kingdee.com/article/137143146508814848 苍穹费用设置：一、 导入单据启动方案并启用1、 路径：打开应用【集成管理】→【启动方案】→【导入方案】，导入出差申请单、出差借款单、差旅报销单、费用申请单、借款单、费用报销单、对公报销单和还款单的启动方案。2、 选择启动方案，启用。二、 导入基础资料启动方案1、路径：打开应用【集成管理】→【启动方案】→【导入方案】，导入并启用，基础资料启动方案包括费用项目、出差类型。其他基础资料可以先导入，再建立映射关系。注意：这里基础资料的同步指的是EAS往苍穹同步，不包括苍穹往EAS同步。三、 值转换规则映射路径：打开应用【集成管理】→【值转换管理】→【值转换规则】，以币别为例来说明。1、 找到币别的置转换规则F2976389，选中，点【同步数据】、【自动匹配】，最后可以通过【查看匹配结果】来检查源系统和目标系统的币别是否映射正确。2、 用同样的方法和步骤把出差类型23D8BFF8、结算方式31730CBB、交通工具-交通工具D64008CD、建立源单据和目标单据之间的映射。3、 单据状态映射关系需要手工新建，包括正向3C0F23B和反向9848876E四、 集成方案默认配置为苍穹单据提交即同步到EAS，如果苍穹单据需要审核通过同步到EAS,首先需要在启动方案里修改触发事件为审核通过（同时工作流里需要配置 &quot;审核通过&quot;操作，这两个地方的操作务必相同）；其次，在数据集成方案-目标数据处理里配置操作：审核通过_集成云。注意：选择苍穹单据提交即同步到EAS时，苍穹相关单据的工作流不要启用；选择苍穹单据审核通过同步到EAS时，EAS相关单据的工作流也不要启用。五、 EAS新建单据，提交 如果苍穹单据提交即同步，检查EAS单据字段，以及EAS审核中、审核通过，等待付款、已付款、取消付款，删除付款单、生成凭证或删除凭证等各环节反写是否正确。如果苍穹单据审核通过同步，检查EAS单据字段，以及EAS等待付款、已付款、取消付款，删除付款单、生成凭证或删除凭证等各环节反写是否正确。",url:"https://club.kdcloud.com/article/45549?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|96",updateTime:"2021-02-25",viewCount:1606,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/questions/136127172933876738/answers/136127212729433092?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|97"]}],type:"Help",title:"订货的时候是公司名称，怎样以个人名义激活并认证？",desc:"【答案】系统在激活产品//认证企业的时候，会核对出库订单跟企业云平台两个地方的客户名称。如果不一致，不允许激活产品或者企业认证。方法：1、将云平台的客户名称请修改成出库订单的客户名称，并提交出库订单的企业名称激活产品/认证企业。2、请联系金蝶分公司走出库订单的《更改公司名称》流程，流程走完后再在云平台激活产品/认证企业。注：如果是个人认证，请您提供软件的购买合同并说明原因，联系您的经销商，由经销商/分公司发邮件/云之家联系张剑云kite@kingdee.com，闵刚mingang@kingdee.com和刘思si_liu@kingdee.com。一般一个工作日内审核。审核通过后即可进行个人认证。",url:"https://club.kdcloud.com/questions/136127172933876738/answers/136127212729433092?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|97",updateTime:"2020-12-30",viewCount:12,helpType:"问答"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/155692615382179584?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|98"]}],type:"Help",title:"企业微信（苍穹-企业微信）集成使用手册",desc:"企业微信（苍穹-企业微信）集成使用手册作者：何进刚 2021/01/26许可说明：企业微信的连接走WebAPI连接许可，WebAPI有许可的情况下才可以使用。集成方案获取：https://pan.yunzhijia.com/s/MTE0Nzk4NSxkMzc2#/ 来自：云之家企业云盘 密码请查看云之家群“苍穹集成云产品交流群”公告1. 连接类型检查连接类型是否启用，如未启用，请点击启用按钮2.配置连接配置新增连接配置，连接类型选择企业微信，填写编码、名称后保存（如选不到企业微信，请检查连接类型是否启用，如果仍然选不到，点击连接类型超链接内的刷新环境按钮）3.填写配置信息如需做苍穹-企业微信部门及人员同步，需开启企业微信的通讯录同步功能，开启API编辑通讯录权限。 登录用户为企业微信中企业ID，登录密码填写企业微信中通讯录同步的Secret，域名填写qyapi.weixin.qq.com4.测试连接情况配置后点击测试按钮，查看是否连接成功5.导入方案及服务流程5.1 导入数据集成方案数据集成方案行政组织(苍穹-企业微信）初始化(KDADMIN_ORG(IERP-WeChat)Init)导入后,如提示需要选择数据源，前往数据源页面选择相应的系统连接注：导入启动方案，默认过滤不可执行，防止误操作，根据现场实际情况需要调整相应的过滤条件。5.2导入部门增量同步服务流程邮件通知接收人请修改。5.3导入苍穹-企业微信人员初始化（IERP-WeChat）集成方案注：导入启动方案，默认过滤不可执行，防止误操作，根据现场实际情况需要调整相应的过滤条件。5.4导入人员增量同步服务流程邮件通知接收人请修改。其他6.注册企业微信第一步：登录企业微信网页，注册一个企业：https://work.weixin.qq.com/wework_admin/loginpage_wx?etype=expired#index第二部：填写信息并扫码绑定微信第三步：进入后台，点击通讯录同步第四步：添加权限第五步：打开api编辑权限，然后保存第六步：获取企业id和密码获取企业id：获取密码：资料1、微信管理后台：https://work.weixin.qq.com/wework_admin/frame#contacts 2、微信api文档：https://work.weixin.qq.com/api/doc/90001/90148/90455集成服务云使用指南：https://club.kdcloud.com/article/45312 集成服务云新特性发布汇总：https://club.kdcloud.com/article/146134 集成云常见问题处理合集: https://vip.kingdee.com/article/45556",url:"https://club.kdcloud.com/article/155692615382179584?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|98",updateTime:"2021-03-05",viewCount:40,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/61095129595376640?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|99"]}],type:"Help",title:"苍穹 智能数据洞察应用--使用节点、网页端（PC端右侧栏）和移动端效果速看",desc:"网页端单据使用节点审核方案配置完成，在两个用户节点可以使用：1、单据提单人：单据编辑完成保存、提交之后，右侧栏可以实时看到检查结果。2、单据审核人：打开单据源单 或 消息中心（工作流审批节点）或 共享任务中心（共享审批节点）查看单据时，单据右侧栏会出现检查结果，如下图所示。 右侧栏展示效果如下图所示 1、上方标题栏处（部分①）展示决策评分以及决策建议等信息，审批过程中修改了单据内容保存后，点击右侧按钮可重算评分。2、下方自定义分类（部分②）每一个部分（框）以卡片形式存在，配置方案中一个分类对应一个卡片。3、卡片内展示每个分类下的检查项结果；不同检查项类型的展示与交互方式，详见检查项配置指南。移动端数据洞察效果移动端审批效果依然需要在PC端智能数据洞察应用中进行方案配置，检查项结果在云之家应用程序-流程助手轻应用 中查看。（除需要获得智能数据洞察应用使用权限外，还需要获得云之家应用程序及流程助手轻应用使用权限）。[流程助手]轻应用待办页签列表，打开任意一张待审核单据查看详情，单据主题下方出现小K头像和数据洞察的结果提示，例如下图红框区域所示。 上右图单据详情页点击红框行任意位置，可跳转至数据洞察（即检查结果）页面查看详情，如下图所示。 样式重大变化：3.0版本即将对智能数据洞察侧边栏面板的展示方式重大修改，即可以通过触发洞察专用“灯泡”图标按钮打开洞察面板内容，单据侧边栏形式将会取消（共享任务中心和消息中心仍然保留原有单据右侧栏的展示方式）。点击面板外任意区域，面板收起。重新点击“灯泡”按钮，检查内容重新执行。单据内容修改时，已打开的浮层面板收起，修改完毕保存后，再次点击图标，洞察内容重新计算；切换单据时，已打开的浮层面板收起，若需再次查看洞察内容，再次点击图标，洞察内容重新计算；上述改动有以下价值：1）所有单据和基础资料表单均可以通过配置方案实现洞察（不需要业务单据添加自定义控件代码）；2）不占据单据原有信息区域，便于单据展示更多字段信息；3）便于后续更多数据洞察场景扩展；注意：现阶段右侧栏和浮层样式会同时存在，后续浮层改造完成，右侧栏会取消，敬请期待！",url:"https://club.kdcloud.com/article/61095129595376640?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|99",updateTime:"2020-12-18",viewCount:279,helpType:"文章"},{action:[{caption:"查看帮助",key:"OpenUrl",args:["https://club.kdcloud.com/article/183140?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|100"]}],type:"Help",title:"金蝶云•苍穹流程服务云常见问题汇总",desc:"1. 参与人相关设置了工作流角色但流程为什么没有找到参与人https://club.kdcloud.com/questions/14768/answers/20076 如何设置同一节点的待办任务由不同的参与人审批https://club.kdcloud.com/questions/14837/answers/20143 如何找直接上级和间接上级https://club.kdcloud.com/questions/14767/answers/20075 如何找组织部门负责人https://club.kdcloud.com/questions/14852/answers/20170 工作流角色配置时如何选择行政部门https://club.kdcloud.com/questions/98004965200985856/answers/98004965251317504二次开发如何扩展工作流协作关系https://club.kdcloud.com/article/132662. 插件相关工作流插件使用常见问题https://club.kdcloud.com/questions/151787/answers/181473每个节点上都要设置驳回时撤销操作吗？https://club.kdcloud.com/questions/67933624758124800/answers/67933625865589248流程调用操作插件无属性值的问题https://club.kdcloud.com/questions/152217/answers/182124 工作流插件开发-工作流任务时限控制插件https://club.kdcloud.com/article/182110 工作流插件开发-监听器或自动节点及其撤回业务插件https://club.kdcloud.com/article/146461 工作流插件开发-条件规则外部接口插件https://club.kdcloud.com/article/146460 工作流插件开发-参与人插件https://club.kdcloud.com/article/146459 工作流插件开发-工作流流转记录格式化业务插件https://club.kdcloud.com/article/162254 3. 集成相关待办消息如何与第三方APP集成https://club.kdcloud.com/article/13305 苍穹工作流和EAS工作流的集成方案https://club.kdcloud.com/questions/151786/answers/181471 4. 进入流程相关设置都是对的，但是提单后为什么没有进流程https://club.kdcloud.com/questions/53490204396251648/answers/53490205134884097单据提交后不进入流程问题https://club.kdcloud.com/questions/152218/answers/182126 怎么看我提交的单据是不是进流程了https://club.kdcloud.com/questions/14499/answers/19853 创建了好多个出差申请单的流程，提单时应该走哪个https://club.kdcloud.com/questions/14494/answers/19850 单据提交后进入流程，然后又进行撤回操作，用户如何看这个单据是否提交过呢？ https://vip.kingdee.com/questions/128867033717977344/answers/128867033734754560如何按照所属组织过滤寻址https://vip.kingdee.com/questions/129238858482711808/answers/1292388584994890245. 变量相关介绍一个流程变量的使用场景https://club.kdcloud.com/article/14800 使用变量来实现循环某个节点的案例https://club.kdcloud.com/article/45383 6. 消息相关云之家、钉钉和企业微信中附件查看方式介绍https://club.kdcloud.com/questions/149536/answers/177934 消息设置常见问题https://club.kdcloud.com/questions/152428/answers/182477 移动端任务审批完成后如何跳转到第三方表单https://club.kdcloud.com/article/69031062638498816如何设置系统公告？https://vip.kingdee.com/questions/129269813670505472/answers/129269813687282688如何在同一个审批节点收到不同的消息 https://club.kdcloud.com/questions/14766/answers/20074为什么收不到云之家\\短信\\邮件消息 https://club.kdcloud.com/questions/14495/answers/198517. 异常处理如何初步处理挂起的流程？https://club.kdcloud.com/questions/14764/answers/20072 常见异常问题https://club.kdcloud.com/article/183303审核失败后业务提示信息为什么是null？https://club.kdcloud.com/questions/85769947967757568/answers/85769948286327552工作流流转日志中报插件没有找到的错误（mservice-qing）https://club.kdcloud.com/questions/152151/answers/1819478. 向导相关工作流快速入门https://club.kdcloud.com/questions/14854/answers/20172新建向导最后一步的单据状态设置是什么意思？https://club.kdcloud.com/questions/14496/answers/19852如何修改流程的标识？https://vip.kingdee.com/questions/129257087179206912/answers/1292570871959841289．审批相关线上加决策项条件后不支持动态驳回https://club.kdcloud.com/questions/195318/answers/226210 消息中心我的任务如何设置任务分类https://club.kdcloud.com/questions/14828/answers/20130 驳回时提示“没有预计算到节点，请联系管理员查看”https://club.kdcloud.com/questions/69020310389084160/answers/69020311630268416如何实现仅允许单人加签场景https://club.kdcloud.com/questions/95941582565421824/answers/95941582582199040审批提交增加CustomEvent事件控制提交弹出提示https://club.kdcloud.com/article/68702865111601152人工节点再次提交审批策略https://club.kdcloud.com/article/182667工作流实现自定义审批页面操作指引https://club.kdcloud.com/article/182569消息中心“协办”“转交”“传阅”“催办”这几个名字能改吗？https://vip.kingdee.com/questions/106392667633516288/answers/106392667683847936如何在审批处理时修改单据上的卡片分录字段？https://vip.kingdee.com/questions/106401008678349056/answers/106401008695126272如何自定义平台的审批记录数据源https://vip.kingdee.com/questions/129247209744281856/answers/129247209744281857重复审批人自动审批时如何自定义审批意见？ https://vip.kingdee.com/questions/129273681875758080/answers/129273681892535296如何设置自动转件、自动传阅、任务优先级？ https://club.kdcloud.com/questions/14856/answers/20174如何处理离职员工的待办任务？https://club.kdcloud.com/questions/14855/answers/20173为什么审批记录没有倒序排列？https://club.kdcloud.com/questions/14853/answers/20171如果节点同时满足跳过条件、业务申请人和审批人相同时审批、自动审批和重复审批人控制，执行顺序是什么？ https://club.kdcloud.com/questions/17696/answers/23131苍穹工作流审批案例之不同审批节点看到不同的界面（布局） https://club.kdcloud.com/article/115028417581222656?fromAction=POST_ARTICLE设置单据字段可编辑、显示，为什么没有起作用？ https://vip.kingdee.com/questions/154585647288464896/answers/154585647288464896 10.管理中心相关已经发布的流程可以删除吗？https://club.kdcloud.com/questions/195323/answers/226214 管理中心修改后的流程如何同步到设计器？https://vip.kingdee.com/questions/129260193614967040/answers/12926019363174425611. 流程图相关如何在容器内打开流程图？https://club.kdcloud.com/questions/84591439879195904/answers/84591440348486400如何调用工作流中的“查看流程图”操作？https://club.kdcloud.com/questions/62950113437387008/answers/6295011483031014412．云之家相关云之家配置信息-创建群组https://club.kdcloud.com/questions/190720/answers/221203 13. 条件规则相关条件规则可以在哪里设置？https://vip.kingdee.com/school/130400775532455168 条件规则-比较符-属于集合和不属于集合如何使用https://vip.kingdee.com/school/131449223555193088条件规则的操作符包含、不包含、属于集合、不属于集合的说明与区别https://club.kdcloud.com/questions/58613/answers/95960相关链接金蝶云•苍穹流程服务云使用指南：https://club.kdcloud.com/article/183308",url:"https://club.kdcloud.com/article/183140?channel_level=金蝶云苍穹|金蝶云苍穹|搜索&search_action=云之家|169|1|100",updateTime:"2021-03-03",viewCount:2741,helpType:"文章"}];return e}}),KDControlFactoryProxy.registerType("helpresult_nlp_search",KDNLPSearchHelpResultProxy),define("KDNLPSearchHelpResultProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDNLPSearchHelpResultProxy}}(this)),function(e){var t={C_TYPE_SPLITER:1,C_TYPE_ITEM:0};KDBillDashBoardProxy=e.extend(KDControlProxy,{allItemHide:!1,operateGuiding:!1,_lastWinOffset:{top:0,left:0,deta:3},scrollActionId:0,expendChangedData:void 0,getType:function(){return"KDBillDashBoardProxy"},createControl:function(t){var i=this;i.config=t;var a=KDBillDashBoardProxy.superclass.createControl.call(i,t);a.addClass("kd-billdashboard").off("click mouseleave").on("click",function(t){e.stopPropagation(t)}).on("mouseleave",function(e){var t=new Date;if(!(t-i.datetime<500)){var a={top:parseInt(i.el.css("top")||0),left:document.body.clientWidth-parseInt(i.el.css("width")||0)},n=0,o=i.el.outerWidth(!0)+n,r=i.el.outerHeight(!0)+n,s=e.clientX,l=e.clientY;a.left<s&&a.left+o>s&&a.top<l&&a.top+r>l&&a.left+o>l||i.onMouseOut.call(i,e)}}),i.expand=i.config.expand,$('<div class="kd-billdashboard-leftplaceholder">').appendTo(a),i.itemsPanel=$('<div class="kd-billdashboard-itemsPanel" '+(i.expand?"":'style="display:none"')+">").appendTo(a),i.itemsPanelContent=$('<div class="kd-billdashboard-itemsPanelContent">').appendTo(i.itemsPanel),i.itemsPanelBottom=$('<div class="kd-billdashboard-itemsPanelBottom"><span class="kd-billdashboard-itemsPanelBottom-label">'+ResManager.LoadKDString("返回顶部","0025710030032343")+"</span></div>").appendTo(i.itemsPanel).off("click","span").on("click","span",function(e){i.onTopClick.call(i,e)}),i.expander=$('<div class="kd-billdashboard-expander kd-billdashboard-expander-expand" style="background-image:url('+e.getImageUrlByNameAndVersion("kd_big_icon_extend.png")+');">').appendTo(a).off("click mouseenter mouseout").on("click",function(e){i.onExpenderClick.call(i,e)}).on("mouseenter",function(e){}),i.el.off("click",".kd-billdashboard-itemlink").on("click",".kd-billdashboard-itemlink",function(e){var t=$(e.target).closest(".kd-billdashboard-item"),a=i.rootView.data("kendoListView"),n=a.dataItem(t);i._clearSelected(),n.set("selected",!0),i.onClick.call(i,e,n)}),i.el.off("click",".kd-billdashboard-itemcheck").on("click",".kd-billdashboard-itemcheck",function(e){var t=$(e.target).closest(".kd-billdashboard-item"),a=i.rootView.data("kendoListView").dataItem(t);a.locked||(a.set("expand",!a.expand),i.onCheck.call(i,e,a))})},doLayout:function(){var t=this,i=e.clientVisualHeight,a=150,n=parseInt(t.el.css("top"))||120,o=t.itemsPanelBottom.height()||50,r=t.expander.height()||118,s=i-a-n-o,l=t.rootView.data("kendoListView"),d=l?l.dataItems():void 0,c=l?46.59*d.length:i,h=c>s+o;t.itemsPanelContent.css({"max-height":s});var u=h?(s+o-r)/3:(c-r)/3;t.expander.css({top:u>0?u:3}),this._anchorPointDoLayout()},showTips:function(){var t=this,i=e.getTipsConfiguration(),a=e.parseObject(e.storage.getItem("isShowedTips")||"{}");if(1!=t.allItemHide&&i.showBillDashBoardTips&&!e.equalsIgnoreCase(a.state+"","true")){if($(".kd-billdashboardtips-container").length>0)return;var n=function(t){t=t||{};var i=" ";t.anchor==e.dock.Top&&(i=" kd-anchor-top");var a=$(kendo.format('<div class="billdashboardtip-container {5} {6}" style="z-index:{0};"><div class="tip-logo" style="background-image:url({1});"></div><div class="tip-content">{2}</div><div class="tip-steps-container"><span class="tip-steps">{3}</span><span class="tip-next">{4}</span></div><div class="tip-line"></div></div>',t.zIndex,t.logoUrl,t.content,t.steps,t.btnText,t.roleClass,i));return a},o=function(){t.operateGuiding=!0;var i=$('<div class="kd-billdashboardtips-container"></div>'),a=$('<div class="kd-fullscreen-shawdow"></div>');i.append(a),t.AnchorPointProxy.el.append(i);var o=e.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),s=a.css("z-index");s=parseInt(s)+1;var l={};l.zIndex=s,l.logoUrl=o,l.content=ResManager.LoadKDString("新版本支持单据页签定位，为您迅速切换页签信息。","0991733030036573"),l.steps="1/3",l.btnText=ResManager.LoadKDString("下一步","0025710030032403"),l.roleClass="billdashboardtip-anchorpointer",l.anchor=e.dock.Top;var d=n(l);i.append(d),i.find(".billdashboardtip-anchorpointer .tip-next").on("click",function(){t.operateGuiding=!1,t.AnchorPointProxy.el.find(".kd-billdashboardtips-container").remove(),c&&c.removeClass&&(c.removeClass("kd-guidepromptintro-outer"),c.find(".kd-tips-mask").remove()),r("1")});var c=t.AnchorPointProxy.component;c.addClass("kd-guidepromptintro-outer");var h=$('<div class="kd-tips-mask"></div>');c.find(".k-tabstrip-items").append(h),h.click(function(e){t.AnchorPointProxy.el&&t.AnchorPointProxy.el.find(".billdashboardtip-anchorpointer .tip-next").click()});var u=c.offset();d.css({left:u.left+10,top:u.top+c.outerHeight(!0)+10})},r=function(a){t.operateGuiding=!0;var o=$('<div class="kd-billdashboardtips-container"></div>'),s=$('<div class="kd-fullscreen-shawdow"></div>');t.el.append(s).addClass("kd-guidepromptintro-outer"),t.expander.append(o);var l=e.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),d=s.css("z-index");d=parseInt(d)+1;var c={};if(c.zIndex=d,c.logoUrl=l,"1"==a){c.content=ResManager.LoadKDString("点击展开侧边栏。","0991733030035990"),c.steps="2/3",c.btnText=ResManager.LoadKDString("下一步","0025710030032403"),c.roleClass="billdashboardtip-nextstep";var h=n(c);o.append(h),o.find(".billdashboardtip-container .tip-next").on("click",function(){t.el.find(".kd-billdashboardtips-container").remove(),t.el.find(".kd-fullscreen-shawdow").remove(),t.onExpenderClick({},void 0,!0),t.operateGuiding=!1,r("2"),t.expander.find(".kd-tips-mask").remove()});var u=$('<div class="kd-tips-mask"></div>');t.expander.append(u),u.click(function(e){t.el.find(".billdashboardtip-container .tip-next").click()})}else{c.content=ResManager.LoadKDString("您可选择隐藏暂不使用的单据页签，若不使用该侧边栏可以点击收起。","0991733000016134"),c.btnText=ResManager.LoadKDString("完成学习","0991733000004995"),c.roleClass="billdashboardtip-gotit";var h=n(c);o.append(h),o.find(".billdashboardtip-container .tip-next").on("click",function(){t.el.find(".kd-billdashboardtips-container").remove(),t.el.find(".kd-fullscreen-shawdow").remove();var a=i||{};a.showBillDashBoardTips=!1;var n=e.parseObject(e.storage.getItem("TipsConfiguration")||"{}");n[e.generateUserHashID()]=a,e.storage.setItem("TipsConfiguration",e.stringify(n)),t.sendTipsState(),t.operateGuiding=!1,t.itemsPanel.removeClass("kd-guidepromptintro-outer"),t.expander.removeClass("kd-guidepromptintro-outer"),t.itemsPanel.find(".kd-tips-mask").remove(),t.el.removeClass("kd-guidepromptintro-outer")}),t.itemsPanel.addClass("kd-guidepromptintro-outer");var u=$('<div class="kd-tips-mask"></div>');t.itemsPanel.append(u)}var p=t.expander;if(p.length>0){p.addClass("kd-guidepromptintro-outer");p.position();h.css({right:p.outerWidth(!0)+15,top:5})}};t.AnchorPointProxy&&t.AnchorPointProxy.component&&t.AnchorPointProxy.component.find(" > ul > li:visible").length>0?o():r("1")}},_showTipsoldstyle:function(){var t=this,i=e.getTipsConfiguration(),a=e.parseObject(e.storage.getItem("isShowedTips")||"{}");if(1!=t.allItemHide&&i.showBillDashBoardTips&&a.state&&!e.equalsIgnoreCase(a.state.toString(),"true")){var n=$('<div class="kd-fullscreen-shawdow"></div>'),o=$('<div class="billdashboardtip-nextstep"><div class="tip-content">'+ResManager.LoadKDString("鼠标划到这里<br>会弹出控制面板","0025710030032402")+'</div><span class="tip-next">'+ResManager.LoadKDString("下一步","0025710030032403")+'</span><div class="tip-line"></div></div>'),r=$('<div class="billdashboardtip-gotit"><div class="tip-content">'+ResManager.LoadKDString("勾选显示功能<br>取消勾选隐藏功能","0025710030032404")+'</div><span class="tip-ok">'+ResManager.LoadKDString("我知道了","0025710030032401")+'</span><div class="tip-line"></div></div>');if($(".billdashboardtip-nextstep").length<1){$("body").append(n).append(o).append(r),("3076"==ResManager.Language||"2052"==ResManager.Language)&&($(".billdashboardtip-gotit, .billdashboardtip-nextstep").css({padding:"1em 1.6em 1em 1.6em",width:"10em"}),$(".billdashboardtip-nextstep .tip-line").css({"margin-left":"11em"}),$(".billdashboardtip-gotit .tip-line").css({"margin-left":"8em"}));var s=e.getCurrentBrowsType();"ie"==s.type&&($(".billdashboardtip-nextstep .tip-line").css({"margin-top":"-2.6em","margin-left":"10em"}),"1033"==ResManager.Language&&($(".billdashboardtip-nextstep .tip-line").css({"margin-top":"-3.6em","margin-left":"14em"}),$(".billdashboardtip-gotit .tip-line").css({"margin-top":"11.8%",width:"5.5em"}))),$(".billdashboardtip-nextstep .tip-next").click(function(){$(".billdashboardtip-nextstep").remove(),t.onExpenderClick(),$(".billdashboardtip-gotit").length<1&&$("body").append(r),t.el.position().top-120>0&&$(".billdashboardtip-gotit").css("top",t.el.position().top-120+"px"),$(".billdashboardtip-gotit").show(),$(".billdashboardtip-gotit .tip-ok").click(function(){$(".kd-fullscreen-shawdow,.billdashboardtip-gotit").remove(),i.showBillDashBoardTips=!1;var a=e.parseObject(e.storage.getItem("TipsConfiguration")||"{}");a[e.generateUserHashID()]=i,e.storage.setItem("TipsConfiguration",e.stringify(a)),t.sendTipsState()})})}}},sendTipsState:function(){var t=ClientAppProxy.Current.rootForm;if(t){t.fireEventNoData.call(t,"CustomEvents","Kingdee.BOS.KDBillDashBoard.isShowedTips","Kingdee.BOS.KDBillDashBoard.sendTipsStateClick",null,[]);var i={};i.opkey=this.getKey()+".Kingdee.BOS.KDBillDashBoard.sendTipsStateClick",i.opname="流式布局操作提示语",t.fireCustomEventsNoData.call(t,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",e.stringify(i))}},_clearSelected:function(){for(var e=this,t=e.rootView.data("kendoListView"),i=t.dataItems(),a=0;a<i.length;a++)i[a].selected&&i[a].set("selected",!1)},onTopClick:function(e){var t=this.getFormProxy();t&&t.scrollToTop&&t.scrollToTop.call(t)},onBodyClick:function(e){},__isMeOrChild:function(e){return $(e).closest(".kd-billdashboard").attr("id")==this.getBaseId()},onMouseEnter:function(e){var t=this;t.expand||this.__isMeOrChild(e.target)&&t.onExpenderClick.call(t,e)},onMouseOut:function(e){var t=this;t.expand&&(this.__isMeOrChild(e.relatedTarget)||t.onExpenderClick.call(t,e))},onClick:function(e,t){if(t&&t.expand&&t.enabled){var i=this.getFormProxy();i&&i.scrollToTarget&&(i.scrollToTarget.call(i,t.targetKey),e&&!e.fromAnchorPointProxyActivate&&this._setAnchorPointItemOption(t,{},!0))}},onCheck:function(e,t){var i=this.getFormProxy();i&&i.expandTarget&&(i.expandTarget.call(i,t.targetKey,t.expand),this._fluidStateChanged(t))},loadConfig:function(t){var i=this;KDBillDashBoardProxy.superclass.loadConfig.call(i,t),i.expendChangedData=void 0,i.el.css({position:"fixed","float":"right"}),i.setItems(t.items),i.showTips(),e.delayInvoke(function(){i.el.css({left:"",top:"",overflow:"visible"}),i.refreshAltBizStyle.call(i)})},initComponent:function(){var e=this;KDBillDashBoardProxy.superclass.initComponent.call(e),e.setVisible(!e.allItemHide)},setItems:function(i){var a=null,n=this,o=$.isArray(i)?i:i.items,r=[];if(n.rootView&&(a=n.rootView.data("kendoListView"),a.destroy(),n.itemsPanelContent.empty()),o&&0==o.length)return void(n.allItemHide=!0);for(var s=0,l=0;l<o.length;l++){var d=e.cloneObject(o[l]),c=d.type==t.C_TYPE_SPLITER;if(0!=e.getValue(d,"visible",1)){var h=(e.getValue(d,"text","")||"").trim();h&&s++;var u=c?"kd-billdashboard-spliter":"kd-billdashboard-item";d.cls=d.cls!=u?u+" "+d.cls:u,d.targetKey=c?"":(d.targetKey||"").toUpperCase(),d.visCls=h||c?"":"display:none;",r.push(d)}}n.rootView=$('<ul class="kd-billdashboard-listview" style="border:none;">').appendTo(n.itemsPanelContent),a=n.rootView.kendoListView({template:'<li class="#:cls# #if(selected){# kd-billdashboard-itemselected #}# " style="#:visCls#" data-kdTargetKey="#:targetKey#">#if(type==1){#<div/>#}else{#<div style="width:20%;"><div class="kd-billdashboard-itemcheck #if(expand){# kd-ui-blue-accept #}#"><div class="#if(locked){# kd-billdashboard-itemchecklocked #}#"></div></div></div><div style="width:80%;"><span class="kd-billdashboard-itemlink" title="#:text#">#:text#</span></div>#}#</li>',
dataSource:{data:r,schema:{model:{id:"index",fields:{index:{type:"number"},targetKey:{type:"string"},text:{type:"string"},expand:{type:"boolean"},selected:{type:"boolean"},visCls:{type:"string"}}}}}}),n.allItemHide=0==s,this._initAnchorPointComponent({items:o})},updateItems:function(e){for(var t=this,i=($.isArray(e)?e:e.items)||[],a=0;a<i.length;a++){var n=i[a];t.setItemOption(n)}},setItemOption:function(t){if(!e.isEmpty(this.rootView)){for(var i=this,a=i.rootView.data("kendoListView"),n=a.dataItems(),o=0;o<n.length;o++){var r=n[o];if(e.equalsIgnoreCase(r.targetKey,t.targetKey)){r.expand!=t.expand&&r.expand!=t.expand&&(e.isValidProp(t,"expand")&&r.set("expand",t.expand),i.onCheck({},r)),t.refreshDashBoard&&(e.isValidProp(t,"text")&&r.set("text",t.text),e.isValidProp(t,"locked")&&r.set("locked",t.locked),e.isValidProp(t,"enabled")&&r.set("enabled",t.enabled),e.isValidProp(t,"visible")&&(r.visible=t.visible,r.set("visCls",t.visible?"":"display:none;"))),this._setAnchorPointItemOption(t,r);break}}for(var s=[],l=0,o=0;o<n.length;o++){var r=n[o],d=(e.getValue(r,"text","")||"").trim();d&&e.getValue(r,"visible",1)&&l++,r&&r.expand&&s.push(r.targetKey)}return i.allItemHide=0==l,i.setVisible(!i.allItemHide),s}},onExpenderClick:function(t,i,a){var n=this;if(!n.expanding&&(1!=n.operateGuiding||a)){n.expanding=!0,n.expand=!n.expand;var o=n.expand?"kd-billdashboard-expander-expand":"kd-billdashboard-expander-collapse",r=n.expand?"kd-billdashboard-expander-collapse":"kd-billdashboard-expander-expand";n.expander.addClass(r).removeClass(o),n.expand?(e.isIeBrowser()?n.itemsPanel.css("display",""):n.itemsPanel.show("fadeIn"),n.itemsPanelContent.focus()):e.isIeBrowser()?n.itemsPanel.css("display","none"):n.itemsPanel.hide("fadeOut"),n.expanding=!1,n.datetime=new Date,n._commitFluidChangedData()}},onScroll:function(e,t){this._adjustFloat(e,t)},_adjustFloat:function(t,i){var a=this.AnchorPointProxy&&this.AnchorPointProxy.el;if($("body").find(a).length>0&&a.length>0&&"none"!=a.css("display")&&a.parent().length>0){e.isEmpty(this.topPosition)&&(this.topPosition=a.css("top"));var n=i.top;KDFloatingManager.instance.duckList[this.baseId]&&(n+=KDFloatingManager.instance.duckList[this.baseId].top.totalPx);var o=i.left;a.winOffset=i;var r=a.parent().children(".kd-menubar-el-placeholder");0==r.length&&(r=$(kendo.format('<div class="kd-menubar-el-placeholder" style="z-index:-9999;display:none;width:1px;height:{0}px">',a.height())),a.parent().prepend(r));var s=this.getFormProxy().el.offset(),l=e.CONST.IsBillHeadFloat?s.top-e.getBillHeadHeight(!1):s.top,d=e.CONST.IsBillHeadFloat?0:s.top,c=this.getFormProxy().el.height(),h=a.height();if(n>l&&d+c-h>n){var u={dock:"top",WidthOrHeightName:"width",ParentWidthOrHeightValue:e.layout.getActualWidth(a),px:0,otherSideDockName:"left",otherSideDockValue:a.parent().offset().left-o};KDFloatingManager.instance.setFloat(this.getPageId(),a,u),a.hasClass("kd-el-floating")&&r.show(),a.addClass("kd-menubar-el-floating")}else a.hasClass("kd-el-floating")?(r.hide(),KDFloatingManager.instance.setSink(this.getPageId(),a),a.css({top:this.topPosition}).removeClass("kd-menubar-el-floating")):(r.hide(),a.removeClass("kd-menubar-el-floating"));this._syncAnchorPointSelect(t,i),this._lastWinOffset=$.extend(this._lastWinOffset,i)}},getSetting:function(){var t=this,i={items:[]};if(t.rootView)for(var a=t.rootView.data("kendoListView"),n=a.dataItems(),o=0;o<n.length;o++){var r=n[o];if(r.targetKey){var s={index:r.index,targetKey:r.targetKey,expand:!!r.expand,selected:!!r.selected};i.items.push(s)}}else i.items=e.cloneObject(t.config.items);return i},setSetting:function(t){if(!e.isEmpty(this.rootView)){var i=this,a=!1,n=t.items,o=i.rootView.data("kendoListView"),r=o.dataItems();i._clearSelected();for(var s=0;s<n.length;s++){var l=n[s];if(l.targetKey)for(var d=0;d<r.length;d++){var c=r[d];l.targetKey==c.targetKey&&(c.set("expand",l.expand),!a&&l.selected&&(a=!0,c.set("selected",l.selected)))}}}},getLayoutSetting:function(){if(this._commitFluidChangedData(),!e.isEmpty(this.rootView)){var t=this,i={items:[]},a=t.rootView.data("kendoListView"),n=a&&a.dataItems();if(!e.isEmpty(n))for(var o=0;o<n.length;o++){var r=n[o];if(r.targetKey){var s={targetKey:r.targetKey,expand:r.expand};i.items.push(s)}}return 0==i.items.length?null:i}},loadLayoutSetting:function(e){},_fluidStateChanged:function(e){if(e){this.expendChangedData=this.expendChangedData||{};var t=e.targetKey,i={cls:e.cls,dirty:e.dirty,enabled:e.enabled,expand:e.expand,id:e.id,index:e.index,locked:e.locked,selected:e.selected,targetKey:e.targetKey,text:e.text,type:e.type,uid:e.uid,visCls:e.visCls};this.expendChangedData[t]=i}},_getFluidChangedData:function(){var t;if(!e.isEmpty(this.expendChangedData)){t=[];for(var i in this.expendChangedData)if(e.isRunInForIn(i,this.expendChangedData)){var a=this.expendChangedData[i];if(a){var n={targetKey:a.targetKey,key:a.targetKey,expand:a.expand};t.push(n)}}}return t},_commitFluidChangedData:function(){var t=this._getFluidChangedData();if(!e.isEmpty(t)){var i=this.getFormProxy();i&&(i.fireEventNoData.call(i,e.CONST.CustomEventName.FluidDashBoardChanged,this.key,t,[]),this.expendChangedData=void 0)}},release:function(){var e=this;e.itemsPanel.off("blur"),e.itemsPanelBottom.off("click","div"),e.expander.off("click"),e.el.off("click",".kd-billdashboard-itemlink"),e.el.off("click",".kd-billdashboard-itemcheck")},getVisKeys:function(){for(var e=this.getSetting(),t=[],i=0;i<e.items.length;i++){var a=e.items[i];a.expand&&t.push(a.targetKey)}return t},refreshAltBizStyle:function(){var e=this.getFormProxy();e&&e.refreshFluidBizAltStyle.call(e)}}),function(i){i.extend(KDBillDashBoardProxy.prototype,{anchorPointProxyHeight:36,anchorPointKey:"-KDBillDashBoarAnchorPoint",_initAnchorPointComponent:function(e){var t=this.getFormProxy();this.anchorPointProxyHeight=t?t.anchorPointProxyHeight:this.anchorPointProxyHeight,this._initAnchorPointProxyContainer(e),this._initAnchorPointProxy(e)},_initAnchorPointProxyContainer:function(t){var i=this;this.AnchorPointProxyContainer=new KDFlowlayoutProxy;var a={};a.id=i.getBaseId()+this.anchorPointKey+"Container",a.xtype="kdflowlayoutpanel",a.ctOrientation="vertical",a.dock=e.dock.None,a.fromClient=!1,a.height=this.anchorPointProxyHeight,i.AnchorPointProxyContainer.setControlFactoryProxy.call(i.AnchorPointProxyContainer,i.getControlFactoryProxy()),i.AnchorPointProxyContainer.createControl.call(i.AnchorPointProxyContainer,a),i.el.after(i.AnchorPointProxyContainer.el),i.AnchorPointProxyContainer.loadConfig.call(i.AnchorPointProxyContainer,a),i.AnchorPointProxyContainer.initComponent.call(i.AnchorPointProxyContainer,a)},_initAnchorPointProxy:function(t){var a=this;t=t||{},a.AnchorPointProxy=new KDTabControlProxy,this.AnchorPointProxy.setBaseId(a.getPageId()+this.anchorPointKey),a.AnchorPointProxy.onActivate=function(t){var n=this.getPageId(),o=this.config?this.config.items:[],r=i(t.item),s="onClick",l=a.AnchorPointProxy.component.children("ul.k-tabstrip-items").children("li.k-item:visible").first();i(l).attr("id")==i(r).attr("id")&&(s="onTopClick");for(var d=0;d<o.length;d++){var c=o[d]||{},h=c.id;if(e.equalsIgnoreCase(this.currentPageId,n+"-"+h)){t.fromAnchorPointProxyActivate=!0,r.attr({fromAnchorPointProxyActivate:!0}),this.parentproxy&&this.parentproxy[s]&&this.parentproxy[s].call(this.parentproxy,t,c),e.delayInvoke(function(e){var t=i(e);t.attr({fromAnchorPointProxyActivate:""})},1e3,!0,r);break}}a.AnchorPointProxy.component.children("ul.k-tabstrip-items").children("li.k-item.kd-state-active").removeClass("kd-state-active"),r.removeClass("k-state-active").addClass("kd-state-active")},a.AnchorPointProxy.showTabItem=function(t,a){var n=-1;for(var o in this.children)if(e.isRunInForIn(o,this.children)&&this.children[o].key==t){n=o;break}if(!(0>n)){var r=this.children[n];if(!e.isEmpty(r)){r.Visiable=!0,i(this.component.find("ul>li")[n]).show();var s=this.component.data(this.getKendoCType());e.isEmpty(s)||(s.enable(s.tabGroup.children().eq(n),!0),a&&this.setSelectedIndex(n))}}},a.AnchorPointProxy.hideTabItem=function(t){var a=-1;for(var n in this.children)if(e.isRunInForIn(n,this.children)&&this.children[n].key==t){a=n;break}if(-1!=a){var o=this.children[a];if(!e.isEmpty(o)){o.Visiable=!1,i("#"+o.baseId+"_c",this.component).hide(),i(this.component.find("ul>li")[a]).hide();var r=this.component.data(this.getKendoCType());e.isEmpty(r)||r.enable(r.tabGroup.children().eq(a),!1)}}},a.AnchorPointProxy.setControlFactoryProxy.call(a.AnchorPointProxy,a.getControlFactoryProxy());var n={};n.height=this.anchorPointProxyHeight,n.id=a.getPageId()+this.anchorPointKey,n.parent=a.key,n.stylekey="KDBillDashboardTabControl",n.items=a._loadAnchorPointChildren(t.items),n.parentconfig=a.config,n.enableTabScroll=!0,n.ctOrientation=KDFlowlayoutProxy.vertical,n.dock=e.dock.Top,a.AnchorPointProxy.parentproxy=a,a.AnchorPointProxy.createControl.call(a.AnchorPointProxy,n),a.AnchorPointProxyContainer.el&&a.AnchorPointProxyContainer.el.append(a.AnchorPointProxy.el),a.AnchorPointProxy.loadConfig.call(a.AnchorPointProxy,n),a.AnchorPointProxy.initComponent.call(a.AnchorPointProxy,n),a.AnchorPointProxy.el.css({position:"relative","float":"inherit"}).addClass("kd-tabstrip-anchorpoint");var o=this.AnchorPointProxy.component.children("ul.k-tabstrip-items"),r=this.AnchorPointProxy.el.children(".k-tabstrip-wrapper");r.css({"padding-top":this.anchorPointProxyHeight-o.height()}),o.css({height:"auto","max-height":"2.5em"})},_loadAnchorPointChildren:function(i){for(var a=e.cloneObject(i||[]),n=[],o=0;o<a.length;o++){var r=a[o]||{};if(r.type!=t.C_TYPE_SPLITER){r.PageIndex=r.index,r.hscroll=0,r.id=this._getAnchorPointKeyByTargetKey(r.targetKey),r.title=r.text,r.vscroll=0,r.xtype="kdtabpage",r.visible=0!=r.expand&&0!=r.visible;var s=e.getValue(r,"text","");e.isEmpty(s)&&(r.visible=!1),n.push(r)}}return n},_anchorPointDoLayout:function(){if(this.AnchorPointProxy&&this.AnchorPointProxy.doLayout&&this.AnchorPointProxy.component){var t=this.AnchorPointProxy.component.data(this.AnchorPointProxy.getKendoCType());if(t&&t.resize)try{this.AnchorPointProxy.doLayout.call(this.AnchorPointProxy),t.resize()}catch(i){e.writeLog("KDBillDashBoardProxy._anchorPointDoLayout()",i.message,!0)}}},_syncAnchorPointSelect:function(e,t){if(this.AnchorPointProxy&&this.AnchorPointProxy.component){var i=this.AnchorPointProxy.component.children("ul.k-tabstrip-items").children("li.k-item.k-state-active,li.k-item.kd-state-active");if(!i.attr("fromAnchorPointProxyActivate")){var a=t||{};this._lastWinOffset=this._lastWinOffset||{};var n=a.top-this._lastWinOffset.top>0;this.scrollActionId++,this._syncAnchorPointSelectCore(i,n,null,a,this.scrollActionId)}}},_getNextActiveTab:function(e,t,a){var n,o=i(t);if(a=a||{},a.top<=5&&this.AnchorPointProxy&&this.AnchorPointProxy.component)n=this.AnchorPointProxy.component.children("ul.k-tabstrip-items").children("li.k-item:visible").first();else for(var r=0;50>r;r++){if(o=e?o.next():o.prev(),o=i(o),o.length>0&&o.is(":visible")){n=o;break}if(0==o.length){n=o;break}}return n},_syncAnchorPointSelectCore:function(t,a,n,o,r){if(r==this.scrollActionId){var s,l=!1;o=o||{},o.top<=5&&this.AnchorPointProxy&&this.AnchorPointProxy.component?(s=this.AnchorPointProxy.component.children("ul.k-tabstrip-items").children("li.k-item:visible").first(),l=!0):s=this._getNextActiveTab(a,t,o),s=i(s);var d=this,c=d.getFormProxy(),t=d._getAnchorPointItemBytabItemId(s.attr("currid"));if(t){var h=l?l:c.checkTargetIsShowInWindow.call(c,t.targetKey,a,n,o,r);if(e.isObject(h))n=h.formContainer||n,o=h.windowoffset||o,r=h.currentScrollActionId||r,this._syncAnchorPointSelectCore(s,a,n,o,r);else if(h){var u=this.AnchorPointProxy.component.children("ul.k-tabstrip-items").children("li.k-item.k-state-active,li.k-item.kd-state-active");u.removeClass("k-state-active").removeClass("kd-state-active"),s.addClass("kd-state-active")}}}},_setAnchorPointItemOption:function(t,a,n){var o={},r=!0;if(!e.isEmpty(t)&&this.AnchorPointProxy){var s=e.isValidProp(t,"visible"),l=e.isValidProp(t,"expand");if(s&&(o.visible=t.visible),l&&(o.expand=t.expand,o.visible=t.expand),s||l){var d=0!=t.visible&&0!=t.expand;if(a){var c=t.text||a.text;void 0!=c&&e.isEmpty(c)&&(d=!1)}try{0==d?this.AnchorPointProxy.hideTabItem.call(this.AnchorPointProxy,this._getAnchorPointKeyByTargetKey(t.targetKey)):(this._setAnchorPointVisible.call(this,!0),this.AnchorPointProxy.showTabItem.call(this.AnchorPointProxy,this._getAnchorPointKeyByTargetKey(t.targetKey),n))}catch(h){e.writeLog("KDBillDashBoardProxy._setAnchorPointItemOption()",h.message,!0)}var u=0;u=this.AnchorPointProxy.component&&this.AnchorPointProxy.component.children("ul.k-tabstrip-items").height(),r=5>u?!1:!0,this._anchorPointDoLayout();try{this._setAnchorPointVisible.call(this,r)}catch(h){e.writeLog("KDBillDashBoardProxy._setAnchorPointItemOption()",h.message,!0)}}e.isValidProp(t,"text")&&(this.AnchorPointProxy.setTitle.call(this.AnchorPointProxy,t.text),o.text=t.text,o.title=t.text);var p=this.AnchorPointProxy.config.items||[];for(index=0;index<p.length;index++)if(e.equalsIgnoreCase(p[index].targetKey,t.targetKey)){i.extend(p[index],o);break}}},_getAnchorPointItemBytabItemId:function(t){for(var i,a=this.AnchorPointProxy.config.items,n=this.getPageId(),o=0;o<a.length;o++){var r=a[o]||{},s=r.id;if(e.equalsIgnoreCase(t,n+"-"+s)){i=r;break}}return i},_getAnchorPointKeyByTargetKey:function(e){var t=e+this.anchorPointKey;return t},_setAnchorPointVisible:function(t){var a=this;try{if(a.AnchorPointProxy){var n=a.AnchorPointProxy.visible;if(void 0!=n&&n!=t){a.AnchorPointProxy.setVisible.call(a.AnchorPointProxy,t),a.AnchorPointProxyContainer&&a.AnchorPointProxyContainer.setVisible.call(a.AnchorPointProxyContainer,t);var o=a.getFormProxy();a.onScroll.call(a,{},i.extend({top:0,left:0},o&&o._lastWinOffset))}}}catch(r){e.writeLog("KDBillDashBoardProxy._setAnchorPointItemOption()",r.message,!0)}}})}(jQuery),KDControlFactoryProxy.registerType("kdbilldashboard",KDBillDashBoardProxy)}(KD),define("KDBillDashBoardProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDBillDashBoardProxy}}(this)),KDBizQuickViewProxy=KD.extend(KDControlProxy,{maxLimit:4,Items:[],isInit:!0,isExMessageMonitor:!1,showLoadingIcon:"kd-quicklist-count-loading",isH5DataCard:!1,isH5SubSystemToDoListCard:!1,isH5SmartMonitorMessageStatisticCard:!1,isPreView:!1,createControl:function(e){KDBizQuickViewProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDBizQuickViewProxy.superclass.loadConfig.call(this,e),this.setRequestLock(!0),this.isExMessageMonitor=KD.getValue(e,"isExMessageMonitor",this.isExMessageMonitor),this.maxLimit=this.isExMessageMonitor?3:this.maxLimit,this.maxLimit=KD.getValue(e,"maxLimit",this.maxLimit),this.el.css({"max-width":"980.25px"})},_getTemplate:function(e){var t,i="";if((!e.viceText||parseInt(e.viceText.length)<=0)&&(i=this.showLoadingIcon),this.isExMessageMonitor)t=kendo.format('<div id="{0}" class="kd-quicklist-panel" style="{1} width:{2}%;"><div class="kd-quicklist-item kendo-font-family" style=""><div class="kd-quicklist-count {3}"><span class="kd-quicklist-count-richtext" title="{4}">{4}</span></div><div class="kd-quicklist-title" title="{5}">{5}</div></div> </div>',e.id,e.InlineStyle,100/this.maxLimit,i,e.viceText,e.text);else{var a=!KD.isEmpty(e.quickListClass)&&!KD.IsNullOrWhiteSpace(e.quickListClass)&&e.quickListClass;t=kendo.format('<div id="{0}" class="kd-quicklist-panel {7}" style="width:{1}%;"><div class="kd-quicklist-img"><img></div><div class="kd-quicklist-item kendo-font-family" style="{2} background-image:{3};"><div class="kd-quicklist-count {4}"><span class="kd-quicklist-count-richtext" title="{5}">{5}</span></div><div style="text-align:center"><div class="kd-quicklist-title" title="{6}">{6}</div></div><div class="kd-quicklist-refreshtime"></div></div></div>',e.id,(100-3*this.maxLimit*2)/this.maxLimit,e.InlineStyle,e.icon,i,e.viceText,e.text,a)}return t},_getItems:function(){var e;this.Items=[];for(var t,i,a=0;a<this.maxLimit;a++){switch(a){case 0:t=this.isExMessageMonitor?"background-color: #EEF5FF;color: #5BB9FF;font-family: inherit;":"background-color: #A0D65C;color: #EFF8E4;font-family: inherit;";break;case 1:t=this.isExMessageMonitor?"background-color: #EEF5FF;color: #6093EF;font-family: inherit;":"background-color: #FDBF52;color: #FEF6E7;font-family: inherit;";break;case 2:t=this.isExMessageMonitor?"background-color: #EEF5FF;color: #A9A6F7;font-family: inherit;":"background-color: #FF8989;color: #FFFBFA;font-family: inherit;";break;case 3:t=this.isExMessageMonitor?"font-family: inherit;":"background-color: #7DA7FB;color: #FCFEFD;font-family: inherit;"}i=this.isExMessageMonitor?'url("content/themes/images/icon_quickView_threeTap'+(a+1)+'.png") ':"",e={index:a,id:"defaultId_"+a,text:ResManager.LoadKDString("未绑定业务","0025710030033500"),viceText:"",enabled:!0,cls:"",InlineStyle:"",icon:i,selected:!0},this.Items.push(e)}this.data.sort(function(e,t){return parseInt(e.index)>parseInt(t.index)?1:-1});for(var n=this.data.length>this.maxLimit?this.maxLimit:this.data.length,o=0;n>o;o++)t=this.Items[o].InlineStyle,i=this.Items[o].icon,this.Items[o]=$.extend(this.Items[o],this.data[o]),this.Items[o].InlineStyle.replace(",",";").replace("{","").replace("}",""),this.Items[o].InlineStyle=t+this.Items[o].InlineStyle,this.Items[o].icon.length>0?this.Items[o].icon="url("+this.Items[o].icon+")":this.Items[o].icon=i},doLayout:function(){KDBizQuickViewProxy.superclass.doLayout.call(this),this.el.css({width:"100%"})},setItems:function(e){var t=this;if(this.isH5DataCard=e.IsH5DataCard,this.isH5SubSystemToDoListCard=e.isH5SubSystemToDoListCard,this.isH5SmartMonitorMessageStatisticCard=e.isH5SmartMonitorMessageStatisticCard,this.isInit){this.el.css({margin:"0em auto"});var t=this;this.data=$.isArray(e)?e:e.items,this.isExMessageMonitor=KD.getValue(e,"isExMessageMonitor",this.isExMessageMonitor),this.maxLimit=this.isExMessageMonitor?3:this.maxLimit,this.maxLimit=KD.getValue(e,"maxLimit",this.maxLimit);var i=e&&e.isSmartCardLayout,a=e&&e.noPermission;if(i&&a){var n=ResManager.LoadKDString("很抱歉，暂时没有相关数据~","0141072000005298"),o=kendo.format('<div class="kd-quicklist-noData"><img src="{0}" onerror="this.onerror=null;this.src=&quot;{0}&quot;"><p>{1}</p></div>',"../images/biz/default/MainConsole/H5CardLayout/icon_task_NoData.png",n);return this.NodataTips=$(o),void this.el.append(this.NodataTips)}if(this.component=$('<div class="kd-quicklist-listview" style="border:none;height:100%;">').appendTo(this.el),this._getItems(),this.isExMessageMonitor){var r={"border-left":"1px solid silver"};this.component.addClass("kd-quicklist-threeView").css(r)}else i?this.component.css("margin","0").addClass("kd-quicklist-fourView"):this.component.css("margin","0 -3%").addClass("kd-quicklist-fourView");for(var s=0;s<t.Items.length;s++){var l=$(t._getTemplate(t.Items[s]));this.isExMessageMonitor&&t.Items[s].icon&&l.css("background-image",t.Items[s].icon),l.click(function(e){t._onClick(e)}),this.component.append(l)}1==a&&(l.find(".kd-quicklist-item").removeClass("kd-quicklist-item"),1==e.IsH5DataCard?l.find(".kd-quicklist-count").removeClass(this.showLoadingIcon).css({"text-align":"center",height:"50px"}).append("<div class='kd-quicklist-nocontent'>"):e.isH5SubSystemToDoListCard&&l.find(".kd-quicklist-count").removeClass(this.showLoadingIcon).css({"text-align":"center",height:"50px"}).append("<div class='kd-quicklist-nocontent kd-quicklist-subsystemnocontent'>"),l.find(".kd-quicklist-title").css({"font-size":"1.17em",color:"#666666","margin-top":"10px","text-align":"center"}),l.find(".kd-quicklist-title").text(ResManager.LoadKDString("当前用户无权查看数据","0025710000008894")),l.find(".kd-quicklist-title").attr("title",ResManager.LoadKDString("当前用户无权查看数据","0025710000008894"))),this.isPreView=e.isPreView,this.isPreView&&(this.isH5DataCard?(l.find(".kd-quicklist-count").css({"min-height":"90px",color:"#7F93BC"}),l.find(".kd-quicklist-count-richtext").css({"font-size":"7em"}),l.find(".kd-quicklist-title").css({"font-size":"1.17em",color:"#666666","margin-top":"10px"}),l.addClass("kd-quicklist-panelCard"),l.find(".kd-quicklist-count-richtext").text(e.items[0].viceText),l.find(".kd-quicklist-count").removeClass(this.showLoadingIcon)):this.isH5SubSystemToDoListCard&&(l.find(".kd-quicklist-count").css({"min-height":"60px",color:"#7F93BC"}),l.find(".kd-quicklist-count-richtext").css({"font-size":"4em",color:"#7F93BC"}),l.find(".kd-quicklist-title").css({"font-size":"1.17em",color:"#666666","margin-top":"1px"}),l.addClass("kd-quicklist-panelCard"))),this.isPreView=!1,this.isInit=!1}else{for(var s=0;s<e.items.length;s++){var d=e.items[s].id.toString(),l=$("#"+e.items[s].id,this.component);if(e.IsH5DataCard||e.isH5SubSystemToDoListCard||l.parent().find(".kd-quicklist-count").removeClass(this.showLoadingIcon),l.find(".kd-quicklist-count").removeClass(this.showLoadingIcon),l.find(".kd-quicklist-title").attr("title",e.items[s].text),l.find(".kd-quicklist-title").html(e.items[s].text),this.isH5DataCard)l.find(".kd-quicklist-count").css({"min-height":"90px",color:"#7F93BC"}),l.find(".kd-quicklist-count-richtext").css({"font-size":"7em"}),l.find(".kd-quicklist-title").css({"font-size":"1.17em",color:"#666666","margin-top":"10px"}),l.addClass("kd-quicklist-panelCard"),e.refreshTime&&l.find(".kd-quicklist-refreshtime").text(ResManager.LoadKDString("取数时间：","0025710000008895")+e.refreshTime);else if(this.isH5SubSystemToDoListCard)l.find(".kd-quicklist-count").css({"min-height":"60px",color:"#7F93BC"}),e.refreshTime&&l.find(".kd-quicklist-refreshtime").text(ResManager.LoadKDString("取数时间：","0025710000008895")+e.refreshTime),l.find(".kd-quicklist-count-richtext").css({"font-size":"4em",color:"#7F93BC"}),l.find(".kd-quicklist-title").css({"font-size":"1.17em",color:"#666666","margin-top":"1px"}),l.addClass("kd-quicklist-panelCard");else if(this.isH5SmartMonitorMessageStatisticCard)switch(s){case 0:l.find(".kd-quicklist-count-richtext").css({color:"#202020"});break;case 1:l.find(".kd-quicklist-count-richtext").css({color:"#28C490"});break;case 2:l.find(".kd-quicklist-count-richtext").css({color:"#FC8655"})}d.indexOf("unbindScheme")<0&&(l.find(".kd-quicklist-count-richtext").attr("title",e.items[s].viceText),l.find(".kd-quicklist-count-richtext").text(e.items[s].viceText),l.find(".kd-quicklist-title").text(e.items[s].text)),this.isH5DataCard=!1,this.isH5SubSystemToDoListCard=!1}this.isH5SmartMonitorMessageStatisticCard=!1}},_onClick:function(e){var t=$(e.currentTarget).closest(".kd-quicklist-panel");0==t.length&&(t=$(e.target).closest(".kd-quicklist-panel")),t.removeClass("k-state-selected");var i=this.getFormProxy();i.lockControl.call(i,this),i.fireEventNoData.call(i,"NaviOperAction","Click",null,0,t.attr("id"),null,null)},timer:null,start:function(e){var t=this;3>e&&(e=3),null==this.timer&&(this.timer=KD.setInterval(function(){var e=t.getFormProxy();e.fireEvent.call(e,"QueryProgressValue",t.key,0)},1e3*e,"KDBizQuickViewProxy.start()"))},timeStop:function(){null!=this.timer&&(clearInterval(this.timer),this.timer=null)},release:function(){clearInterval(this.timer),KDBizQuickViewProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdbizquickview",KDBizQuickViewProxy),KDStdBizQuickBiew=KD.extend(KDBizQuickViewProxy,{naviOperActionArgs:{ClickOper:"Click",DelOper:"Del",EditOper:"Edit",AddOper:"New"},loadConfig:function(e){KDStdBizQuickBiew.superclass.loadConfig.call(this,e),this.el.css({"max-width":""})},_getItems:function(e){var t;this.Items=[];var i,a,n=e?e:this.maxLimit;n=this.data.length>this.maxLimit?this.maxLimit:this.data.length;for(var o=0;n>o;o++){switch(o){case 0:i=this.isExMessageMonitor?"background-color: #EEF5FF;color: #5BB9FF;font-family: inherit;":"background-color: #A0D65C;color: #EFF8E4;font-family: inherit;";break;case 1:i=this.isExMessageMonitor?"background-color: #EEF5FF;color: #6093EF;font-family: inherit;":"background-color: #FDBF52;color: #FEF6E7;font-family: inherit;";break;case 2:i=this.isExMessageMonitor?"background-color: #EEF5FF;color: #A9A6F7;font-family: inherit;":"background-color: #FF8989;color: #FFFBFA;font-family: inherit;";break;case 3:i=this.isExMessageMonitor?"font-family: inherit;":"background-color: #7DA7FB;color: #FCFEFD;font-family: inherit;"}t={index:o,id:"defaultId_"+o,text:ResManager.LoadKDString("未绑定业务","0025710030033500"),viceText:"",enabled:!0,cls:"",InlineStyle:"",icon:"",selected:!0},this.Items.push(t)}this.data.sort(function(e,t){return parseInt(e.index)>parseInt(t.index)?1:-1});for(var r=this.data.length>this.maxLimit?this.maxLimit:this.data.length,s=0;r>s;s++)i=this.Items[s].InlineStyle,a=this.Items[s].icon,this.Items[s]=$.extend(this.Items[s],this.data[s]),this.Items[s].InlineStyle.replace(",",";").replace("{","").replace("}",""),this.Items[s].InlineStyle=i+this.Items[s].InlineStyle,this.Items[s].icon.length>0?this.Items[s].icon="url("+this.Items[s].icon+")":this.Items[s].icon=a},_getTemplate:function(e){var t,i="";(!e.viceText||parseInt(e.viceText.length)<=0&&!e.isstdaddcard)&&(i=this.showLoadingIcon);var a=e.textcolor||!KD.isEmpty(e.textcolor)?e.textcolor:"#7f93bc",n=!KD.isEmpty(e.quickListClass)&&!KD.IsNullOrWhiteSpace(e.quickListClass)&&e.quickListClass;return t=kendo.format('<div id="kd_stdtodolistcard_{0}" data-key="{0}" class="kd-quicklist-panel kd-stdconsoletodolist-card kd-stdtodolist-panel {7}"><div><div class="kd-billlistcard-btnlist"><a data-key="{0}" class="kd-h5cardconsole-refreshbtn"></a><a data-key="{0}" href="#" class="kd-billlistcard-edit">{9}</a><a data-key="{0}" class="kd-billlistcard-delete">{10}</a></div><div class="kd-quicklist-displaytitle"><div class="kd-quicklist-headertitle" title="{8}">{8}</div></div><div class="kd-quicklist-item kd-stdtodolist-item kendo-font-family" style="{2} background-image:{3};"><div class="kd-quicklist-count {4}"><span class="kd-quicklist-count-richtext" style="color:{11}" title="{5}">{5}</span></div><div style="text-align:center"><div class="kd-quicklist-title" title="{6}">{6}</div></div><div class="kd-quicklist-refreshtime"></div></div>',e.id,1,e.InlineStyle,e.icon,i,e.viceText,e.text,n,e.forname,ResManager.LoadKDString("编辑","002014030024518"),ResManager.LoadKDString("移除","002014030035640"),a)},_getAddItemTemplate:function(){var e=this.getFormProxy()&&this.getFormProxy().baseId,t=e&&kendo.format("{0}_link",e),i=kendo.format('<div id="{1}_kd_stdtodolistcard_addCard" style="display:none" class="kd-quicklist-panel kd-stdtodolist-panel kd-stdconsole-adddiv"><a id="{1}_link" class="kd-stdaddcardpanel-btn kd-stdconsole-addbtn" href="#" title="{0}"><img class="kd-stdconsole-addbtnimg" src="../images/biz/default/MainConsole/H5CardLayout/MessageType/ADD.png"></a></div>',ResManager.LoadKDString("点击添加待办事项","002014030035350"),t);return i},_itemNaviOperClick:function(e,t,i,a){var n=this,o=i;a&&(o=a);var r=n.getFormProxy();r.lockControl.call(r,n),r.fireEvent.call(r,"NaviOperAction",t,o,0,i,null,null)},_onClick:function(e){var t=$(e.currentTarget).closest(".kd-quicklist-panel");0==t.length&&(t=$(e.target).closest(".kd-quicklist-panel")),t.removeClass("k-state-selected");var i=this.getFormProxy(),a={};if(a.height=t.height(),"absolute"==t.css("position")||"fixed"==t.css("position")||"relative"==t.css("position"))$.extend(a,{top:0,left:0});else{a.width=t.width();var n=t.position();a.top=n.top,a.left=n.left}$('<div class="kd-ui-viewlocker">').css(a).appendTo(t),KD.delayInvoke(function(){$(".kd-ui-viewlocker",t).remove()},300),i.fireEventNoData.call(i,"NaviOperAction","Click",null,0,t.attr("data-key"),null,null)},setItems:function(e){var t=this;if(this.isH5DataCard=e.IsH5DataCard,this.isH5SubSystemToDoListCard=e.isH5SubSystemToDoListCard,this.isInit){this.el.css({margin:"0em auto"});var t=this;this.data=$.isArray(e)?e:e.items,this.maxLimit=KD.getValue(e,"maxLimit",this.maxLimit);var i=e&&e.isSmartCardLayout,a=e&&e.noPermission;if(i&&a){var n=ResManager.LoadKDString("很抱歉，暂时没有相关数据~","0141072000005298"),o=kendo.format('<div class="kd-quicklist-noData"><img src="{0}" onerror="this.onerror=null;this.src=&quot;{0}&quot;"><p>{1}</p></div>',"../images/biz/default/MainConsole/H5CardLayout/icon_task_NoData.png",n);return this.NodataTips=$(o),this.component=$('<div class="kd-quicklist-listview kd-quicklist-fourView kd-quicklist-biillistcard" style="border:none;height:100%;">'),this.component.append(this.NodataTips),this.el.append(this.component),void this.el.css({"min-height":"160px"})}this.component=$('<div class="kd-quicklist-listview" style="border:none;height:100%;">').appendTo(this.el);var r=i?e.items.length:null;this._getItems(r),this.component.addClass("kd-quicklist-fourView").addClass("kd-quicklist-biillistcard");for(var s=0;s<t.Items.length;s++){var l=$(t._getTemplate(t.Items[s]));t._bindItemClickEvent(l,t),this.component.append(l)}if(1==a&&(l.find(".kd-quicklist-item").removeClass("kd-quicklist-item"),l.find(".kd-quicklist-title").css({"font-size":"1.17em",color:"#666666","margin-top":"10px","text-align":"center"}),l.find(".kd-quicklist-title").text(ResManager.LoadKDString("当前用户无权查看数据","0025710000008894")),l.find(".kd-quicklist-title").attr("title",ResManager.LoadKDString("当前用户无权查看数据","0025710000008894"))),this.component){var d=$(t._getAddItemTemplate());d.click(function(){t._itemNaviOperClick.call(t,this,t.naviOperActionArgs.AddOper,"addcard")}),this.component.append(d)}this.isInit=!1}else for(var s=0;s<e.items.length;s++){var c="kd_stdtodolistcard_"+e.items[s].id.toString(),l=$("#"+c,this.component);if(!l||0==l.length)return;e.IsH5DataCard||e.isH5SubSystemToDoListCard||l.parent().find(".kd-quicklist-count").removeClass(this.showLoadingIcon),l.find(".kd-quicklist-count").length>0&&l.find(".kd-quicklist-count").removeClass(this.showLoadingIcon),e.items[s]&&(e.items[s].textcolor&&l.find(".kd-quicklist-count-richtext").css({color:e.items[s].textcolor}),e.items[s].forname&&l.find(".kd-quicklist-headertitle").text(e.items[s].forname),e.items[s].text&&(l.find(".kd-quicklist-title").attr("title",e.items[s].text),l.find(".kd-quicklist-title").html(e.items[s].text)),c.indexOf("unbindScheme")<0&&(l.find(".kd-quicklist-count-richtext").attr("title",e.items[s].viceText),l.find(".kd-quicklist-count-richtext").text(e.items[s].viceText),l.find(".kd-quicklist-title").text(e.items[s].text))),this.isH5DataCard=!1,this.isH5SubSystemToDoListCard=!1}},setEditCardMode:function(e){var t=this,i=this.component.children(".kd-quicklist-noData");if(i&&i.length>0){i.hide();var a=$(t._getAddItemTemplate());a.show(),a.click(function(){t._itemNaviOperClick.call(t,this,t.naviOperActionArgs.AddOper,"addcard")}),this.component.append(a)}else $(".kd-stdconsole-adddiv",this.el).css("display","inline-block"),$(".kd-billlistcard-edit",this.el).css("display","inline-block"),$(".kd-billlistcard-delete",this.el).css("display","inline-block")},setDeleteCard:function(e){var t="kd_stdtodolistcard_"+e.toString(),i=$("#"+t,this.component);i.length>0&&$(i).hide()},setAddNewStdCard:function(e){var t=this,i=$(t._getTemplate(e));t._bindItemClickEvent(i,t);var a=t.component&&t.component.find(".kd-stdconsole-adddiv");a.length>0&&a.before(i),i.find(".kd-billlistcard-edit").css("display","inline-block"),i.find(".kd-billlistcard-delete").css("display","inline-block")},_bindItemClickEvent:function(e,t){var i=t;e.find(".kd-quicklist-item").click(function(e){i._onClick(e)}),e.find("a.kd-billlistcard-edit").click(function(){var e=$(this).attr("data-key");i._itemNaviOperClick.call(i,this,i.naviOperActionArgs.EditOper,e)}),e.find("a.kd-billlistcard-delete").click(function(){var e=i.component.find(".kd-stdconsoletodolist-card:visible"),t=$(this).attr("data-key"),a=e.length<=1?"lastcard":t;i._itemNaviOperClick.call(i,this,i.naviOperActionArgs.DelOper,t,a)})}}),KDControlFactoryProxy.registerType("kdstdbizquickview",KDStdBizQuickBiew),define("KDBizQuickViewProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDBizQuickViewProxy}}(this)),KDSpreadProxy=KD.extend(KDControlProxy,{data:null,formulamode:0,createControl:function(e){this.config=e,this.el=$('<div style="width:100%;height:100%;"></div>');
this.getCType();return this.el.attr("id",this.baseId),this.el.dock=this.config.dock,KD.setAttachmentData(this.el,e),e.data&&(this.data=e.data),this.el},loadConfig:function(e){KDSpreadProxy.superclass.loadConfig.call(this,e),this.localToolbar(),this.initSpreadWithToolBar(this.data,0),this.hideUnusedButton(),this.setData(this.data,0)},hideUnusedButton:function(){var e=$(this.el).find("div.k-tabstrip-wrapper");e.css("display","none")},initComponent:function(){KDSpreadProxy.superclass.initComponent.call(this)},barItemClick:function(e,t){var i=e.el.data("kendoSpreadsheet"),i=this.el.data("kendoSpreadsheet"),a=i.activeSheet();if(a){a.selection()}switch(t){case"toolbarFormula":if(0==this.formulamode)return void alert(ResManager.LoadKDString("请先进入公式模式，再进行公式编辑！","0025710030034364"));var n=e.getFormProxy();n&&n.fireEvent.call(n,"ButtonClick",t,"click");break;case"kds_rptshowinfo":var n=e.getFormProxy();n&&n.fireEvent.call(n,"ButtonClick",t,"click");break;case"kds_formulaparams":var n=e.getFormProxy();n&&n.fireEvent.call(n,"ButtonClick",t,"click");break;case"showFormual":this.formulamode=1,this.setData(this.data,1);break;case"showData":this.formulamode=0,this.setData(this.data,0)}},initSpreadWithToolBar:function(e,t){var i=this,a="toolbarFormula",n=[],o={};o.type="button",o.text=ResManager.LoadKDString("报表公式","0025710030033445"),o.spriteCssClass="k-icon k-font-icon k-i-cog",o.click=function(){i.barItemClick(i,a)},n.push(o),o={},o.type="button",o.text=ResManager.LoadKDString("显示公式","0025710030034365"),o.spriteCssClass="k-icon k-font-icon k-i-filter",o.click=function(){i.barItemClick(i,"showFormual")},n.push(o),o={},o.type="button",o.text=ResManager.LoadKDString("显示数据","0025710030034366"),o.spriteCssClass="k-icon k-font-icon k-i-exception",o.click=function(){i.barItemClick(i,"showData")},n.push(o),o={},o.type="button",o.text=ResManager.LoadKDString("报表参数","0025710030034168"),o.spriteCssClass="k-icon k-font-icon k-i-exception",o.click=function(){i.barItemClick(i,"kds_formulaparams")},n.push(o),o={},o.type="button",o.text=ResManager.LoadKDString("报表披露信息","0025710030034167"),o.spriteCssClass="k-icon k-font-icon k-i-exception",o.click=function(){i.barItemClick(i,"kds_rptshowinfo")},n.push(o),this.el.kendoSpreadsheet({toolbar:{data:n}})},setValue:function(e){this.formulamode=0,this.setData(e.items[0].data,0)},showData:function(){this.formulamode=0,this.setData(this.data,0)},showFormual:function(){this.formulamode=1,this.setData(this.data,1)},setData:function(e,t){this.data=e;var i=3;this.data.sheets&&(i=this.data.sheets.length);var a=this.el.data("kendoSpreadsheet");a.toolbar=!1,a.sheetsbar=!1;var n=!1;this.data.editmode&&(this.data.editmode="edit")&&(n=!0);var o=[],r={};if(this.data.sheets.length>0)for(var s=0;s<this.data.sheets.length;s++){var l={},d=[];l.name=this.data.sheets[s],l.rows=d;var c=200;this.data.rowscount&&(c=parseInt(this.data.rowscount[s]));var h=26;this.data.columnscount&&(h=parseInt(this.data.columnscount[s]));for(var u=0;c>u;u++){for(var p={},g=[],f=0;h>f;f++){var m={};g.push(m)}p.cells=g,d.push(p)}var v=[];l.columns=v;for(var f=0;h>f;f++){var y={};v.push(y)}o.push(l)}if(r.sheets=o,this.data.data.length>0)for(var s=0;i>s;s++)for(var b=this.data.data[s],D=o[s],u=0;u<b.length;u++){var k=b[u];if(3==k.length){var C=parseInt(k[0]),x=parseInt(k[1]),w=D.rows[C];w.cells[x].value=k[2]}if(4==k.length){var C=parseInt(k[0]),x=parseInt(k[1]),w=D.rows[C];0==t?w.cells[x].value=k[2]:k[3].length>0?w.cells[x].value="="+k[3]:w.cells[x].value=k[2]}if(5==k.length){var C=parseInt(k[0]),x=parseInt(k[1]),w=D.rows[C];w.cells[x].value=k[2];var K={};K.dataType="custom",K.from="false",K.allowNulls=!0,K.type="reject",K.titleTemplate=k[4],K.messageTemplate=k[4],w.cells[x].validation=K;var S=this.isNumber(k[2]);S&&(w.cells[x].textAlign="right")}}if(this.data.columns.length>0)for(var s=0;s<this.data.columns.length;s++)for(var b=this.data.columns[s],D=o[s],u=0;u<b.items.length;u++){var I=b.items[u];2==I.length&&(D.columns[parseInt(I[0])].width=parseInt(I[1]))}if(this.data.rows.length>0)for(var s=0;s<this.data.rows.length;s++)for(var b=this.data.rows[s],D=o[s],u=0;u<b.items.length;u++){var P=b.items[u];if(2==P.length){var w=D.rows[parseInt(P[0])];w.height=parseInt(P[1])}}if(this.data.spans.length>0)for(var s=0;s<this.data.spans.length;s++){for(var b=this.data.spans[s],D=o[s],F=[],u=0;u<b.items.length;u++){var T=b.items[u];if(4==T.length){var _=parseInt(T[0])+1,A=String.fromCharCode(65+parseInt(T[1])),L=parseInt(T[2]),M=parseInt(T[3]),E=_+L-1,B=String.fromCharCode(65+(parseInt(T[1])+M-1));F.push(A+_+":"+B+E)}}F.length>0&&(D.mergedCells=F)}for(var R in this.data.namestyle){var N="",H="",O="",V="",j={},z={},U={},q={},G="",W=0;N=this.data.namestyle[R].fsize?this.data.namestyle[R].fsize:"",H=this.data.namestyle[R].fbold?this.data.namestyle[R].fbold:"",V=this.data.namestyle[R].ha?this.data.namestyle[R].ha:"",O=this.data.namestyle[R].va?this.data.namestyle[R].va:"",this.data.namestyle[R].bl&&(this.data.namestyle[R].bl.color&&(G=this.data.namestyle[R].bl.color.toLowerCase(),j.color=G),this.data.namestyle[R].bl.width&&(W=this.data.namestyle[R].bl.width,j.size=parseInt(W))),this.data.namestyle[R].bt&&(this.data.namestyle[R].bt.color&&(G=this.data.namestyle[R].bt.color.toLowerCase(),U.color=G),this.data.namestyle[R].bt.width&&(W=this.data.namestyle[R].bt.width,U.size=parseInt(W))),this.data.namestyle[R].br&&(this.data.namestyle[R].br.color&&(G=this.data.namestyle[R].br.color.toLowerCase(),z.color=G),this.data.namestyle[R].br.width&&(W=this.data.namestyle[R].br.width,z.size=parseInt(W))),this.data.namestyle[R].bb&&(this.data.namestyle[R].bb.color&&(G=this.data.namestyle[R].bb.color.toLowerCase(),q.color=G),this.data.namestyle[R].bb.width&&(W=this.data.namestyle[R].bb.width,q.size=parseInt(W)));for(var J=this.data.cellstyle[R],s=0;s<J.length;s++){var Q=J[s];if(3==Q.length){var C=parseInt(Q[0]),x=parseInt(Q[1]),X=parseInt(Q[2]),D=o[X],Y=D.rows[C].cells[x],S=this.isNumber(Y.value);N.length>0&&(Y.fontSize=N),H.length>0&&(Y.bold=H.toLowerCase()),V.length>0?Y.textAlign=V.toLowerCase():S&&(Y.textAlign="right"),O.length>0&&(Y.verticalAlign=O.toLowerCase()),j.size&&(Y.borderLeft=j),U.size&&(Y.borderTop=U),z.size&&(Y.borderRight=z),q.size&&(Y.borderBottom=q)}}}if(a.fromJSON(r),!n){var Z=$(this.el).find('[data-role="sheetsbar"]'),ee=Z.find("a.k-spreadsheet-sheets-bar-add");ee.css("display","none");var te=Z.find("span.k-spreadsheet-sheets-remove");te.css("display","none")}$(this.el).find("span.kd-spreadribbonbar-button")},setFormula:function(e){var t=this.el.data("kendoSpreadsheet"),i=t.activeSheet();if(i){var a=i.selection();a&&a.value("="+e[0])}},isNumber:function(e){return"NaN"==parseFloat(e).toString()?!1:!0},initFormula:function(){kendo.spreadsheet.defineFunction("acct",function(e,t,i,a,n,o,r){return null}).args([["x1","string"],["x2","string"],["x3","string"],["x4","string"],["x5","string"],["x6","string"],["x7","string"]])},localToolbar:function(){kendo.spreadsheet&&kendo.spreadsheet.messages.view&&(kendo.spreadsheet.messages.view=$.extend(!0,kendo.spreadsheet.messages.view,{errors:{shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet."},tabs:{home:ResManager.LoadKDString("主页","0025710030034367"),insert:ResManager.LoadKDString("插入","0025710030034368"),data:ResManager.LoadKDString("工具","0025710030034369")}})),kendo.spreadsheet&&kendo.spreadsheet.messages.toolbar&&(kendo.spreadsheet.messages.toolbar=$.extend(!0,kendo.spreadsheet.messages.toolbar,{addColumnLeft:"Add column left",addColumnRight:"Add column right",addRowAbove:"Add row above",addRowBelow:"Add row below",alignment:"Alignment",alignmentButtons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"},backgroundColor:ResManager.LoadKDString("背景颜色","0025710030034370"),bold:ResManager.LoadKDString("粗体","0025710030034371"),borders:ResManager.LoadKDString("边框","0025710030034372"),copy:ResManager.LoadKDString("拷贝","0025710030034373"),cut:ResManager.LoadKDString("剪切","0025710030034374"),deleteColumn:ResManager.LoadKDString("删除列","0025710030034375"),deleteRow:ResManager.LoadKDString("删除行","0991733000003960"),excelExport:"Export to Excel...",filter:"Filter",fontFamily:ResManager.LoadKDString("字体","0025710030034376"),fontSize:ResManager.LoadKDString("字体大小","0991733000004034"),format:ResManager.LoadKDString("自定义格式...","0025710030034377"),formatTypes:{automatic:"Automatic",number:"Number",percent:"Percent",financial:"Financial",currency:"Currency",date:"Date",time:"Time",dateTime:"Date time",duration:"Duration",moreFormats:"More formats..."},formatDecreaseDecimal:"Decrease decimal",formatIncreaseDecimal:"Increase decimal",freeze:"Freeze panes",freezeButtons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"},italic:"Italic",merge:"Merge cells",mergeButtons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"},paste:ResManager.LoadKDString("粘贴","0025710030034378"),quickAccess:{redo:"Redo",undo:"Undo"},sortAsc:"Sort ascending",sortDesc:"Sort descending",sortButtons:{sortSheetAsc:"Sort sheet A to Z",sortSheetDesc:"Sort sheet Z to A",sortRangeAsc:"Sort range A to Z",sortRangeDesc:"Sort range Z to A"},textColor:"Text Color",textWrap:"Wrap text",underline:"Underline",validation:"Data validation..."}))}}),KDControlFactoryProxy.registerType("kdspread",KDSpreadProxy),define("KDSpreadProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDSpreadProxy}}(this)),KDBizYunzhijiaProxy=KD.extend(KDControlProxy,{createControl:function(e){KDBizYunzhijiaProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDBizYunzhijiaProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDBizYunzhijiaProxy.superclass.initComponent.call(this)},showIMSDK:function(e){var t=this,i=function(){if(imCloud)try{t.el.show();new imCloud({eid:e.eid,data:e.data,container:t.el})}catch(i){t.el.hide()}};if(imCloud)return void i();try{KD.delayInvoke(function(){t.showIMSDK()},500)}catch(a){t.el.hide()}},timer:null,start:function(e){var t=this;null==this.timer&&(this.timer=KD.setInterval(function(){var e=t.getFormProxy();e.fireEvent.call(e,"QueryProgressValue",t.key,0)},1e3*e,"KDBizYunzhijiaProxy.start()"))},timeStop:function(){null!=this.timer&&clearInterval(this.timer)},release:function(){clearInterval(this.timer),KDBizYunzhijiaProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdbizYunzhijia",KDBizYunzhijiaProxy),define("KDBizYunzhijiaProxy",["KDControlProxy"],function(e){return function(){var t;return t||e.KDBizYunzhijiaProxy}}(this)),KDAudioPlayProxy=KD.extend(KDControlProxy,{defaultAudioOnServer:"/Audio/defaultaudio.mp3",imgUrl:"content/themes/images/sound_24x24.png",createControl:function(e){return KDAudioPlayProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDAudioPlayProxy.superclass.loadConfig.call(this,e),this.el.addClass("kd-audioplay-container")},initCellComponent:function(){var e=KD.getUrlRoot()+this.defaultAudioOnServer;KD.IsNullOrWhiteSpace(this.config.audioonserver)||(e=KD.getValue(this.config,"audioonserver",e),e.indexOf("http")<0&&(e=KD.getUrlRoot()+e)),this.component=$('<audio src="'+e+'" controls="controls"></audio>'),this.el.append(this.component).css({"max-width":this.config.width+"px"}),this.component.hide(),this.img=$("<img src='"+this.imgUrl+"' />"),this.el.append(this.img),this.setVisible(KD.getValue(this.config,"visible",!0)),this.setStylekey(KD.getValue(this.config,"Stylekey","")),this.setToolTip(this.config.tooltip||this.config.description||""),this.audio=this.component[0]},play:function(e){var t=this;KD.delayInvoke(function(e){t.playCore.call(t,e)},void 0,void 0,e)},playCore:function(e){try{this.audio&&this.audio.play&&this.audio.play()}catch(t){}},stop:function(e){this.audio&&this.audio.pause&&this.audio.pause()}}),KDControlFactoryProxy.registerType("kdaudioplay",KDAudioPlayProxy),KDMediaPlayProxy=KD.extend(KDControlProxy,{hideVolumeClass:"kd-volume-hide",muteState:!1,loadConfig:function(e){KDMediaPlayProxy.superclass.loadConfig.call(this,e),this.el.addClass("k-mediaplayer-el")},initComponent:function(){KDMediaPlayProxy.superclass.initComponent.call(this);var e=this;e.component.click(function(t){e.setMediaMute(!1)})},createInnerDom:function(){return $("<div></div>")},getKendoCType:function(){return"kendoMediaPlayer"},getKendoOptions:function(){var e=KDMediaPlayProxy.superclass.getKendoOptions.call(this);return $.extend(e,{autoPlay:!0,autoRepeat:!1,volume:100,fullScreen:!0,mute:!1,navigatable:!0,forwardSeek:!0,media:null,messages:{pause:ResManager.LoadKDString("暂停","0991733000007131"),play:ResManager.LoadKDString("播放","0991733000007132"),mute:ResManager.LoadKDString("静音","0991733000007133"),unmute:ResManager.LoadKDString("取消静音","0991733000007134"),quality:"Quality",fullscreen:ResManager.LoadKDString("全屏","0141072000005453")},volumeChange:function(){},pause:function(){}}),e},doLayout:function(){KDMediaPlayProxy.superclass.doLayout.call(this),this.component&&this.component.css({height:"100%",width:"100%"});var e=this.getKendoControl();e&&e.resize()},setValue:function(e){var t=this;t.setMediaPlayCore.call(t,e)},setVolumeVisible:function(e){this.component&&(e?this.component.removeClass(this.hideVolumeClass):this.component.addClass(this.hideVolumeClass))},setMediaMute:function(e){this.muteState=e;var t=this.getKendoControl();if(t&&t.mute)try{t.mute(e)}catch(i){}},setMediaPlayCore:function(e){var t=this.getKendoControl();if(t){var i=this;t._toolBar&&t._toolBar.wrapper&&t._toolBar.wrapper.find("a").removeAttr("href"),t.media({title:"",source:e}),1==i.muteState&&t.mute(i.muteState),KD.delayInvoke(function(){if(t)try{t.play()}catch(e){t._paused=!0,t&&t.pause()}},1e3)}},getKendoControl:function(){var e;return this.kendoControl?e=this.kendoControl:this.component&&(this.kendoControl=e=this.component.data("kendoMediaPlayer")),e},play:function(e){var t=this;KD.delayInvoke(function(e){t.playCore.call(t,e)},void 0,void 0,e)},playCore:function(e){try{var t=this.getKendoControl();t&t.play&&t.play()}catch(i){}},stop:function(e){try{var t=this.getKendoControl();t&&t.stop&&t.stop()}catch(i){}}}),KDControlFactoryProxy.registerType("kdmediaplay",KDMediaPlayProxy),define("KDAudioPlayProxy",["KDControlProxy"],function(e){return function(){var t;return t||e.KDAudioPlayProxy}}(this)),KDExpresserProxy=KD.extend(KDEditorProxy,{dataStatusChange:!1,currentFocusInput:null,currentFocusPosition:null,_transDispRegexCache:{},outdivSizeW:"",_replaceKeyWord:{},loadConfig:function(e){KDExpresserProxy.superclass.loadConfig.call(this,e)},initCellComponent:function(){this._initControl(),this.createExpressTemplate(),this.setSetStore()},_getNodeId:function(e,t){for(var i in e)if(KD.isRunInForIn(i,e)){var a={Key:e[i].id,Value:e[i].text};t[a.Key]=a.Value,e[i].children&&e[i].children.length>0&&this._getNodeId(e[i].children,t)}},setSetStore:function(e){var t=this;e=e||{},this.data=e;var i=[],a=KD.getValue(e,"itemstore",null);if(null!=a&&KD.isArray(a))for(var n=0;n<a.length;n++)i.push(a[n]);else a={},a.text=ResManager.LoadKDString("计算项目","00215181000006521"),a.children=[],i.push(a);this.mapData={},t._getNodeId(i,this.mapData);var o,r=KD.getValue(e,"functionsstore",null);o=r&&KD.isArray(r)?r:this.getDefaultFunctionsStore();var s={};s.text=ResManager.LoadKDString("函数","0025710030033447"),s.children=o,i.push(s);var l,d=KD.getValue(e,"operatorsstore",null);l=d&&KD.isArray(d)?d:this.getDefaultOperatorsStore();var c={};c.text=ResManager.LoadKDString("操作符","0025710030033448"),c.children=l,i.push(c);var h,u=KD.getValue(e,"privatevarstore",null);h=u&&KD.isArray(u)?u:this.getDefaultPrivateVarStore();var p={};p.text=ResManager.LoadKDString("私有变量","0025710030033449"),p.children=h,i.push(p);for(var g={id:"numbers",text:ResManager.LoadKDString("数字","0025710030033450"),desc:ResManager.LoadKDString("数字","0025710030033450")},f=[],n=0;10>n;n++){var m={};m.id=n,m.text=n,m.value=n,f.push(m)}f.push({id:".",text:ResManager.LoadKDString("小数点","0025710030033451"),value:ResManager.LoadKDString("小数点","0025710030033451")}),g.children=f,i.push(g);var v=this.createDataSource(i),y=new kendo.data.HierarchicalDataSource({data:v}),b=this.el.find("#"+this.baseId+"-treeContent"),D=b.data("kendoTreeView");if(D&&D.setDataSource)D.setDataSource(y);else{b.kendoTreeView({animation:!1,dataSource:v,template:"<span ParentId='#= item.parentId #' ExpData='#= item.id #' id='#= item.id #' >#= item.text #</span>",select:function(e){2==e.node.childNodes.length?$("[role='group']:last",t.$leftDiv).html(e.node.childNodes[0].innerText):1==e.node.childNodes.length&&$("[role='group']:last",t.$leftDiv).html(e.node.innerText)}})}b.off("dblclick").on("dblclick",".k-in",function(e){var i=e.target.innerText;t.dataStatusChange=!0,0==e.target.offsetParent.innerText.indexOf(ResManager.LoadKDString("加","0025710030033452"))&&(i=$(e.target).attr("expdata")?$(e.target).attr("expdata"):$("span[expdata]",e.target).attr("expdata")),i==ResManager.LoadKDString("小数点","0025710030033451")&&(i=".");var a=$(this).children("span").attr("expdata");if(t.currentFocusInput){var n=t.currentFocusInput.children(".kd-express-itemTree").attr("expdata",a),o=$(this).children("span").attr("id");t.currentFocusInput.children("span[id]").attr("id",o);var r=n.val(),s=KDGetCursorPositon.getSelectionIndex($(n)[0]);r=r.substr(0,s)+i+r.substr(s),n.val(r),t.currentFocusPosition=s+i.length,KDGetCursorPositon.setSelectionIndex(n[0],s+i.length)}else{var l=$(".kd-express-itemTree:first").val();$(".kd-express-itemTree:first").val(l+i).attr("expdata",a)}})},commitField:function(){1==this.dataStatusChange&&(this.getFormProxy().storeData(this.postKey,this.getSetting(),0),this.dataStatusChange=!1)},asyncValueToUIText:function(e){if(!KD.isEmpty(e)){var t=this;this.value=e;var i=e.substr(e.indexOf("FormulaDisplay")-1,e.lastIndexOf("FormulaDisplay")+1);if(i){var a=kendo.guid(),n=$("<div id="+a+"></div>");n.append($(i)).appendTo($("body"));for(var o=n.children("formuladisplay").children("item"),r=[],s="",l=0;l<o.length;l++){if(l>0){var d=$(t.item).off().on("click",function(e){t._getCurFocusItemRow(e,this)});this.addNewNodeRow(d)}var c=this.setItemDatalist($(o[l]));r.push(c)}var h=this.el.find(".kd-expressEditor");$(s).appendTo(h);var u=h.children("div");$("#"+a).remove();for(var p=0;p<u.length;p++){var g=r[p]&&r[p][0];if(g){$(u[p]).children(".kd-express-itemTree").val(g.expdatatext),$(u[p]).children(".kd-txtDesc").val(g.expdescriptiontext);var f=$(u[p]).children("span").children("input[expnodedata]").data("kendoDropDownList");f&&f.text(g.expnodedatatext),g.childrenlist.length>0&&this.setChildrenNodeRowText($(u[p]),g.childrenlist)}}}}},setChildrenNodeRowText:function(e,t){if(!KD.isEmpty(t))for(var i=0;i<t.length;i++){var a=this,n=t[i];this.currentFocusInput=e;var o=$(a.item).off().on("click",function(e){a._getCurFocusItemRow(e,this)});this.addNodeChildrenRow(o);var r=e.children("[children]"),s=r.children("[item]");s=$(s[i]),s.children(".kd-express-itemTree").val(n.expdatatext),s.children(".kd-txtDesc").val(n.expdescriptiontext);var l=s.children("span").children("input[expnodedata]").data("kendoDropDownList");l&&l.text(n.expnodedatatext),n.childrenlist&&n.childrenlist.length>0&&this.setChildrenNodeRowText(s,n.childrenlist)}},setItemDatalist:function(e){for(var t=[],i=0;i<e.length;i++){var a={};if(a.expdatatext=$(e[i]).children("expdata").text(),a.expnodedatatext=$(e[i]).children("expnodedata").text(),a.expdescriptiontext=$(e[i]).children("expdescription").text(),a.childrenlist=[],$(e[i]).children("children").children("item").length>0){var n=$(e[i]).children("children").children("item"),o=this.setItemDatalist(n);a.childrenlist=o}t.push(a)}return t},setDisabled:function(e){if(this.disabled=e,e?(this.el.find(":input").addClass("k-state-disabled"),this.itemContainer&&this.itemContainer.el.find(".kdItemContainer_editorct").addClass("kdItemContainer_editorct_noBorder")):(this.el.find(":input").removeClass("k-state-disabled"),this.itemContainer&&this.itemContainer.el.find(".kdItemContainer_editorct").removeClass("kdItemContainer_editorct_noBorder")),this.masklayerDiv||(this.masklayerDiv=$('<div class="kd-ui-masklayerDiv" style="display:none;">'),this.el.append(this.masklayerDiv)),e?this.masklayerDiv.css({"z-index":1e3,display:"block",top:"0px",left:"0px"}):this.masklayerDiv.css({display:"none"}),this.$outDiv){var t=this.$outDiv.data("kendoSplitter");t&&t.size(".k-pane:first",this.outdivSizeW)}},getSetting:function(){var e=this.getXMLStrValue();return e},getXMLStrValue:function(){var e="<?xml version='1.0'?><Root><Formula>{0}</Formula><FormulaDisplay LocalId='{2}'>{1}</FormulaDisplay></Root>",t=$(".kd-expressEditor",this.el).children(),i=kendo.guid(),a="<formula id="+i+" style='display:none'></formula>",n="<FormulaDisplay id="+i+"_dis style='display:none'></FormulaDisplay>";$("body").append($(a)).append($(n));var o=this.setXMLNode(t,i),r=this.setXMLNode(t,i+"_dis",!0);o.children("item").children("parentid").remove(),o.find("children").removeAttr("id"),r.children("item").children("parentid").remove(),r.find("children").removeAttr("id");var s=o.html(),l=r.html();return $("#"+i).remove(),$("#"+i+"_dis").remove(),e=kendo.format(e,s,l,ResManager.Language),e=e.replace(/item/g,"Item").replace(/expnodedata/g,"ExpNodeData").replace(/expdata/g,"ExpData").replace(/children/g,"Children").replace(/expdescription/g,"ExpDescription").replace(/parentid/g,"ParentId").replace(/id/g,"Id")},setXMLNode:function(e,t,i){for(var a=kendo.template("<Item><Children id='#= uid #'></Children><ExpNodeData>#= ExpNodeData #</ExpNodeData><ExpData>#= ExpData #</ExpData><ExpDescription>#= ExpDescription #</ExpDescription><Id>#= Id #</Id><ParentId>#= ParentId #</ParentId></Item>"),n=0;n<e.length;n++){var o=$(e[n]),r=o.children("span.kd-express-logic").children("input[expnodedata]").attr("expnodedata");KD.IsNullOrWhiteSpace(r)&&(r="sentence");var s=o.children("input[expdata]").val();i?(r=o.children("span.kd-express-logic").text().trim(),s=o.children("input[expdata]").val()):s=this.transDispText2Data(s,this.mapData,new Array);var l=o.children("input[ExpDescription]").attr("ExpDescription"),d=o.children("span[parentid]").attr("parentid"),c=o.children("span[id]").attr("id"),h=kendo.guid(),u={ExpNodeData:r,ExpData:KD.htmlUtil.encode(s),ExpDescription:KD.htmlUtil.encode(l),ParentId:d,Id:c,uid:h},p=a(u),g=o.children("div[children]").children();g.length>0?($(p).appendTo($("#"+t)),this.setXMLNode($(g),h,i)):$(p).appendTo($("#"+t))}return $("#"+t)},transDispText2Data:function(e,t,i){var a=" "+this.replaceKeyWord(e)+" ";if(KD.IsNullOrWhiteSpace(a))return"";if(KD.isEmpty(i)){i=[];for(var n in t)i.push({key:n,value:t[n]});i=KD.quickSort(i,"value")}for(var o=void 0,r=i.length-1;r>=0;r--){var s=i[r],n=s.key,l=s.value;if(n&&l){if(o=this._transDispRegexCache[l+","+n],void 0===o){var d=this.replaceKeyWord(l);o=new RegExp(d,"g"),this._transDispRegexCache[l+","+n]=o}o.test(a)&&(a=a.replace(o,n))}}return this._reavertKeyWord(a)},_reavertKeyWord:function(e){this._initReplaceKeyWord();var t=e;for(var i in this._replaceKeyWord)KD.isRunInForIn(i,this._replaceKeyWord)&&(t=t.replace(new RegExp(this._replaceKeyWord[i],"g"),i));return t},_initReplaceKeyWord:function(){KD.isEmpty(this._replaceKeyWord)&&(this._replaceKeyWord["%"]="%C",this._replaceKeyWord._="_C")},replaceKeyWord:function(e){this._initReplaceKeyWord();var t=e;for(var i in this._replaceKeyWord)KD.isRunInForIn(i,this._replaceKeyWord)&&(t=t.replace(i,this._replaceKeyWord[i]));return t},createDataSource:function(e,t){var i=[];if(KD.isArray(e)){for(var a in e)if(KD.isRunInForIn(a,e)){var n=e[a];i.push(this.createNode(n,t||n.parentId))}}else i.push(this.createNode(e,t||e.parentId));return i},createNode:function(e,t){null==e.text&&(e.text=".");var i={id:e.id||"",text:KD.htmlUtil.encode(e.text)||"",parentId:t||""};if(e.cls&&(i.cls=e.cls),e.icon&&(i.icon=e.icon),e.IsCutomIcon&&(i.IsCutomIcon=e.IsCutomIcon),e.Forecolor&&(i.Forecolor=e.Forecolor),e.children){var a=new Array;for(var n in e.children)if(KD.isRunInForIn(n,e.children)){var o=e.children[n];a.push(this.createNode(o,e.id))}a.length>0&&(i.items=a)}return i},_initControl:function(){this.initSplitter(),this.initToolBar(),this.logRowsNumber()},initSplitter:function(){var e=this,t='<div id="'+this.baseId+'-express_out" style="height:100%"><div id="'+this.baseId+'-express_left"><div id="'+this.baseId+'-treeContent"></div><div></div></div><div id="'+this.baseId+'-mainContent"></div></div>';e.el.append(t),e.outdivSizeW=.26*e.el.width()+"px",this.$outDiv=$("#"+this.baseId+"-express_out",this.el).kendoSplitter({panes:[{collapsible:!0,size:e.outdivSizeW,scrollable:!1,max:.3*e.el.width()+"px"},{collapsible:!0,scrollable:!1}]}),this.$leftDiv=$("#"+this.baseId+"-express_left",this.el).kendoSplitter({orientation:"vertical",panes:[{collapsible:!0,size:"90%"},{collapsible:!0,scrollable:!1}]}),this.el.mainContent=$("#"+this.baseId+"-mainContent",this.el)},initToolBar:function(){var e=this.getControlFactoryProxy(),t=this,i={};i={id:"toolbar",xtype:"toolbar",dock:"1",height:"35px",items:[{xtype:"button",id:"tbNewRow",showTitle:!0,tooltipType:"title",icon:"Tbtn_insert.gif",showprocessbar:!1,text:ResManager.LoadKDString("新增行","0991733000003955")},{xtype:"button",id:"tbDeleteRow",showTitle:!0,tooltipType:"title",icon:"Tbtn_deleteline.gif",showprocessbar:!1,shortcut:"Shift + Delete",text:ResManager.LoadKDString("删除行","0991733000003960")},{shortcut:"Shift + Insert",xtype:"button",id:"tbInsertRow",tooltipType:"title",icon:"Tbtn_insert.gif",showprocessbar:!1,showTitle:!0,text:ResManager.LoadKDString("插入行","0991733030033489")},{xtype:"button",id:"tbNewSubRow",showTitle:!0,tooltipType:"title",icon:"Tbtn_insert.gif",showprocessbar:!1,text:ResManager.LoadKDString("新增下级","0025710030033494")}]},this.toolbarproxy=e.createControl(i),this.toolbarproxy.loadConfig(i),this.toolbarproxy.initComponent(),this.toolbarproxy.getControl().appendTo(this.el.mainContent),this.toolbarproxy.clickHandler=function(e){if(!($(e.target).hasClass("k-state-disabled")||$(e.target).hasClass("kd-menubtn-disabled")||$(e.target).parent().hasClass("k-state-disabled")||$(e.target).parent().hasClass("kd-menubtn-disabled"))){t.dataStatusChange=!0,menuItemElId=$(".kdmenuitem-content",e.target)[getPropName()]("id"),key=this.getButtonKey(menuItemElId);var i=$(t.item).off().on("click",function(e){t._getCurFocusItemRow(e,this)});i.children("span[id]").attr("id",kendo.guid()),i.find(":text").not(":first").blur(function(){$(this).is("[expdescription]")&&$(this).attr("expdescription",$(this).val())}),"tbNewRow"==key&&t.addNewNodeRow(i),"tbDeleteRow"==key&&t.currentFocusInput&&t.deleteNodeRow(),"tbInsertRow"==key&&t.currentFocusInput&&t.insertNodeRow(i),"tbNewSubRow"==key&&t.currentFocusInput&&t.addNodeChildrenRow(i)}}},addNodeChildrenRow:function(e){var t=this;if(!KD.isEmpty(e)){1==t.currentFocusInput.find("div[children]").length?e.appendTo(t.currentFocusInput.find("div[children]").last()):e.appendTo(t.currentFocusInput.children("div[children]"));var i=t.currentFocusInput.children("span[id]").attr("id");e.children("span[parentid]").attr("parentid",i),t._getCustomKendoDropDownList(),t.stripRows.append(t.getRowButton())}},addNewNodeRow:function(e){var t=this;t.currentFocusInput?t.currentFocusInput.after(e):t.el.expressEdit.append(e),t.stripRows.append(t.getRowButton()),t._getCustomKendoDropDownList()},deleteNodeRow:function(){var e=this,t=e.currentFocusInput.find("div[item]").length;e.currentFocusInput.remove(),e.currentRowsCount-=t+1;var i=e.currentRowsCount-1;i>=0?$(".kd-express-logRows:gt("+i+")").remove():$(".kd-express-logRows").remove(),e.currentFocusInput=null},insertNodeRow:function(e){var t=this;t.currentFocusInput.before(e);var i=t.currentFocusInput.children("span[parentid]").attr("parentid");e.children("span[parentid]").attr("parentid",i),t._getCustomKendoDropDownList(),t.stripRows.append(t.getRowButton())},currentRowsCount:0,createExpressTemplate:function(){var e=this;this.baseId;this.item=kendo.format('<div item style="padding: 5px 0px 0px 15px;"><input class="kd-express-logic"  ExpNodeData/><input type="text" class="kd-express-itemTree" ExpData></span><label class="itemDesc" >'+ResManager.LoadKDString("说明：","0025710030034212")+'</label><input type="text" class="kd-txtDesc" ExpDescription/><span id={0}></span><span parentid></span><div children></div></div>',kendo.guid());var t=kendo.format('<div class="kd-expressEditor"></div>');this.el.expressEdit=$(t).append($(this.item).on("click",function(t){e._getCurFocusItemRow(t,this)})).appendTo(this.el.mainContent),this._getCustomKendoDropDownList(),this.el.expressEdit.find(":text").not(":first").blur(function(){$(this).is("[expdescription]")&&$(this).attr("expdescription",$(this).val())}),e.el.expressEdit.find(".kd-txtDesc").off("change").on("change",function(){$(this).attr("expdescription",$(this).val()),e.dataStatusChange=!0}),this.stripRows.append(this.getRowButton())},logRowsNumber:function(){this.stripRows=$("<div>").addClass("kd-express-stripRowNumber"),this.el.mainContent.append(this.stripRows)},getRowButton:function(){this.currentRowsCount++;var e=$("<div>").addClass("kd-express-logRows").text(this.currentRowsCount);return e},_getCurFocusItemRow:function(e,t){this.currentFocusInput=$(t);var i=this.currentFocusInput.children(".kd-express-itemTree");this.currentFocusPosition=KDGetCursorPositon.getSelectionIndex($(i)[0]),e.stopPropagation()},_getCustomKendoDropDownList:function(){var e=this,t=this.getDefaultNodeStore();$("[ExpNodeData]").kendoDropDownList({dataSource:t,dataTextField:"text",dataValueField:"id",change:function(t){var i=e.currentFocusInput.find("input[expnodedata]");i.attr("expnodedata",this.value()),e.dataStatusChange=!0}}),e.el.expressEdit.find(".kd-txtDesc").off("change").on("change",function(){$(this).attr("expdescription",$(this).val()),e.dataStatusChange=!0})},getDefaultOperatorsStore:function(){var e=[{id:"+",text:ResManager.LoadKDString("加(+)","0025710030033453"),desc:""},{id:"-",text:ResManager.LoadKDString("减(-)","0025710030033454"),desc:""},{id:"*",text:ResManager.LoadKDString("乘(*)","0025710030033455"),desc:""},{id:"/",text:ResManager.LoadKDString("除(/)","0025710030033456"),desc:""},{id:">",text:ResManager.LoadKDString("大于(>)","0025710030033457"),desc:""},{id:"<",text:ResManager.LoadKDString("小于(<)","0025710030033458"),desc:""},{id:"=",text:ResManager.LoadKDString("等于(=)","0025710030033459"),desc:""},{id:"==",text:ResManager.LoadKDString("逻辑等于(==)","0025710030033460"),desc:ResManager.LoadKDString("逻辑等于 ==","0025710030033479")},{id:"(",text:ResManager.LoadKDString("左括号","0025710030033480"),desc:ResManager.LoadKDString("左括号 (","0025710030033481")},{id:")",text:ResManager.LoadKDString("右括号","0025710030033482"),desc:ResManager.LoadKDString("右括号 )","0025710030033483")}];return e},getDefaultFunctionsStore:function(){var e=[{id:"GetDate()",text:ResManager.LoadKDString("取日期()","0025710030033461"),desc:""},{id:"GetYear()",text:ResManager.LoadKDString("取年()","0025710030033462"),desc:""},{id:"GetMonth()",text:ResManager.LoadKDString("取月()","0025710030033463"),desc:""},{id:"GetDay()",text:ResManager.LoadKDString("取日()","0025710030033464")},{id:"Round(,)",text:ResManager.LoadKDString("截尾(数值,小数位数)","0025710030033465"),desc:""}];return e},getDefaultPrivateVarStore:function(){var e=[{id:"private_date",text:ResManager.LoadKDString("日期","0025710030033466"),desc:""},{id:"private_cYear",text:ResManager.LoadKDString("当前年","0025710030033467"),desc:""}];return e},getDefaultItemsStore:function(){[{id:"base",text:ResManager.LoadKDString("基本","0025710030033468"),children:[{id:"[Base.Expire]",text:ResManager.LoadKDString("[基本.应发工资]","0025710030033469"),desc:""},{id:"[Base.mustbe]",text:ResManager.LoadKDString("[基本.实发工资]","0025710030033470"),desc:""}]},{id:"minus",text:ResManager.LoadKDString("扣减","0025710030033471"),
children:[{id:"[minus.Duse]",text:ResManager.LoadKDString("[扣减.扣减项]","0025710030033472"),desc:""}]},{id:"plus",text:ResManager.LoadKDString("加项","0025710030033473"),children:[{id:"[plus.Addition]",text:ResManager.LoadKDString("[加项.奖金]","0025710030033474"),desc:""}]}];return itemsStore},getDefaultNodeStore:function(){var e={};return e=[{id:"sentence",text:" ",desc:"",ctrl:0},{id:"if",text:ResManager.LoadKDString("如果","0025710030033475"),desc:"",ctrl:2},{id:"elseif",text:ResManager.LoadKDString("否则如果","0025710030033476"),desc:"",ctrl:1},{id:"else",text:ResManager.LoadKDString("否则","0025710030033477"),desc:"",ctrl:0},{id:"then",text:ResManager.LoadKDString("则","0025710030033478"),desc:"",ctrl:0}]}}),KDControlFactoryProxy.registerType("kdexpression",KDExpresserProxy),define("KDExpresserProxy",["KDEditorProxy","KD","KDGetCursorPositon"],function(e){return function(){var t;return t||e.KDExpresserProxy}}(this)),function(e,t){function i(e){for(;e.length;)a(e),e=e.parent()}function a(e){var t=e.data(n.ns+"title");t&&(e.attr("title",t),e.removeData(n.ns+"title"))}var n=window.kendo,o=n.ui,r=o.Tooltip,s=n.ui.Popup,l=(n.data,e.extend),d=(n.template,e.isArray,e.proxy),c=e(document),h=(n.keys,"show"),u="hide",p="k-content-frame",g="_tt_active",f="aria-describedby",m='<div role="tooltip" class="k-widget k-tooltip#if (!autoHide) {# k-tooltip-closable#}# #=personalClass#">#if (!autoHide) {# <div class="k-tooltip-button"><a href="\\#" class="k-icon k-i-close">close</a></div> #}#<div class="k-tooltip-content"></div>#if (callout){ #<div class="k-callout k-callout-#=dir#"></div>#}#</div>',v=(n.template("<iframe frameborder='0' class='"+p+"' src='#= content.url #'>This page requires frames in order to show content</iframe>"),{bottom:{origin:"bottom center",position:"top center"},top:{origin:"top center",position:"bottom center"},left:{origin:"center left",position:"center right",collision:"fit flip"},right:{origin:"center right",position:"center left",collision:"fit flip"},center:{position:"center center",origin:"center center"}}),y={bottom:"n",top:"s",left:"e",right:"w",center:"n"},b=".kendoTooltip",D=r.extend({options:{name:"KDTooltip"},_mouseleave:function(t){if(this.popup){var a=e(t.currentTarget),o=a.offset(),r=t.pageX,s=t.pageY;o.right=o.left+n._outerWidth(a),o.bottom=o.top+n._outerHeight(a);var l=this.popup.wrapper.offset();if(l.right=l.left+n._outerWidth(this.popup.wrapper),l.bottom=l.top+n._outerHeight(this.popup.wrapper),r>o.left&&r<o.right&&s>o.top&&s<o.bottom)return;if(r>l.left&&r<l.right&&s>l.top&&s<l.bottom)return;this.popup.close()}else i(e(t.currentTarget));clearTimeout(this.timeout)},_initPopup:function(){var t=this,i=t.options,a=e(n.template(m)({callout:i.callout&&"center"!==i.position,dir:y[i.position],autoHide:i.autoHide,personalClass:i&&i.attributes&&i.attributes["class"]||""}));t.popup=new s(a,l({activate:function(){var e=this.options.anchor,a=e[0].id||t.element[0].id;a&&(e.attr(f,a+g),this.element.attr("id",a+g)),i.callout&&t._positionCallout(),this.element.removeAttr("aria-hidden"),c.on("keydown"+b,t._documentKeyDownHandler),t.trigger(h)},close:function(){t.trigger(u)},copyAnchorStyles:!1,animation:i.animation},v[i.position])),a.css({width:i.width,height:i.height}),t.content=a.find(".k-tooltip-content"),t.arrow=a.find(".k-callout"),i.autoHide?a.on("mouseleave"+b,d(t._mouseleave,t)):a.on("click"+b,".k-tooltip-button",d(t._closeButtonClick,t))}});o.plugin(D)}(window.kendo.jQuery),define("KDTooltip",function(){}),KDKendoTooltipProxy=KD.extend(KDControlProxy,{isOnlineTips:!1,tipsType:{onlinetips:0},tipsData:{},wrapperClass:"kd-onlineTips-wrapper",initComponent:function(){},loadConfig:function(e){},getLineTipsOptions:function(){var e={position:"bottom",content:this.initToolTipsContent()||"",callout:!0,attributes:{"class":this.getAttributesClass()},showAfter:ClientAppProxy.Current&&ClientAppProxy.Current.getLineTipsDelayMillisec()};return e},initToolTipsContent:function(){if(this.isOnlineTips&&!KD.isEmpty(this.tipsData)){var e=this.getOnlineTipsObj(this.tipsData),t=this.initOnlineTipsContent(e);return t}return!1},getKendoCType:function(){return"kendoKDTooltip"},setTipsData:function(e){this.tipsData=e},getOnlineTipsObj:function(e){if(!KD.isEmpty(e)){var t={};return t.id=KD.IsNullOrWhiteSpace(e.id)?"":e.id,t.itemid=KD.IsNullOrWhiteSpace(e.itemid)?"":e.itemid,t.text=e.text?e.text:"",t.url=e.url?e.url:"",t.tiptype=e.tiptype?e.tiptype:"",t.tiptitle=e.title?e.title:ResManager.LoadKDString("查看详情","002014030036491"),t}},initOnlineTipsContent:function(e){var t=this,i=e.id,a=(e.itemid,e.text),n=e.url,o=e.tiptype,r=e.tiptitle,s=KD.isEmpty(n)?"":kendo.format('<a class = "kd-onlinetips-link" target="_blank">{0} ></a>',r),l=$(kendo.format('<div class="kd-onlinetips-container" data-id="{2}" data-type="{3}"><div class="kd-menu-onlinetips-maincontent"><div class="kd-onlinetip-detail-container"><span class="kd-onlinetip-detail">{0}{4}</span></div><div class="kd-onlinetips-opinion-container"><div class="kd-onlinetips-opinion-feeling"><div class="kd-onlinetips-evaluation kd-onlinetips-evaluation-satisfied"><span class="kd-onlinetips-satisfied"></span><span>'+ResManager.LoadKDString("有用","00215181000008524")+'</span></div><div class="kd-onlinetips-evaluation kd-onlinetips-evaluation-unsatisfied"><span class="kd-onlinetips-unsatisfied"></span><span>'+ResManager.LoadKDString("没用","00215181000007301")+'</span></div><a class="kd-onlinetips-nevershow">'+ResManager.LoadKDString("不再显示","00215181000008526")+'</a></div><div class="kd-onlinetips-textarea-container"><div class="kd-onlinetips-triangle"></div><span>'+ResManager.LoadKDString("请问出了什么问题","00215181000008527")+'</span><div class="kd-onlinetips-opinion-selection"><button type="button">'+ResManager.LoadKDString("信息不准确","00215181000007304")+'</button><button type="button">'+ResManager.LoadKDString("不是想要的","00215181000008529")+'</button><button type="button">'+ResManager.LoadKDString("不会操作","00215181000008530")+'</button><button type="button">'+ResManager.LoadKDString("信息不完整","00215181000007307")+'</button><button type="button">'+ResManager.LoadKDString("没什么用","00215181000007308")+'</button></div><textarea class="kd-onlinetips-opinion-textarea" placeholder="'+ResManager.LoadKDString("您的反馈可以帮助我们更好的改进产品和服务，更好的提升您的使用体验","00215181000007309")+'"></textarea><button class="kd-onlinetips-opinion-cancel" type="button">'+ResManager.LoadKDString("取消","002014030021133")+'</button><button class="kd-onlinetips-opinion-commit" type="button">'+ResManager.LoadKDString("提交","002014030021476")+"</button></div></div></div></div>",a,n,i,o,s));return this.onlineTipsComponent=l,this.attachOnlineTipsEvent.call(t,e),l},setIsOnlineTips:function(e){this.isOnlineTips=e},attachOnlineTipsEvent:function(e){var t=this,i=this.onlineTipsComponent,a=e.url,n=this.getFormProxy();$(".kd-onlinetips-evaluation-satisfied",i).off("click").on("click",function(e){var t=$(this),a=i.find(".kd-onlinetips-unsatisfied"),o=i.find(".kd-onlinetips-textarea-container");t.find(".kd-onlinetips-satisfied").addClass("kd-onlinetips-satisfied-hover"),a.removeClass("kd-onlinetips-unsatisfied-hover"),o.hide();var r={};r.useful="有用",n&&n.fireCustomEvents("Kingdee.BOS.LineTipsFeedbackSubmit","Kingdee.BOS.LineTipsFeedbackSubmit",JSON.stringify(r))}),$(".kd-onlinetips-evaluation-unsatisfied",i).off("click").on("click",function(e){var t=$(this),a=i.find(".kd-onlinetips-satisfied"),n=i.find(".kd-onlinetips-textarea-container");t.find(".kd-onlinetips-unsatisfied").addClass("kd-onlinetips-unsatisfied-hover"),a.removeClass("kd-onlinetips-satisfied-hover"),n.show()}),$(".kd-onlinetips-opinion-selection button",i).off("click").on("click",function(e){var t=$(this);t.hasClass("kd-state-selected")?t.removeClass("kd-state-selected"):t.addClass("kd-state-selected")}),$(".kd-onlinetips-link",i).off("click").on("click",function(e){var i=t.tipsData&&t.tipsData.id;n&&n.fireCustomEventsNoData("Kingdee.BOS.LineTipsInfoLinkOpen","Kingdee.BOS.LineTipsInfoLinkOpen",a+"|"+(i||""))}),$(".kd-onlinetips-nevershow",i).off("click").on("click",function(e){t.onlineTipsComponent.parent(".k-tooltip-content").parent(".kd-onlineTips-wrapper").parent().remove();var i=t.tipsData&&t.tipsData.id;t.tipsData=null,n&&n.fireCustomEvents("Kingdee.BOS.LineTipsNoMoreDisplayClick","Kingdee.BOS.LineTipsNoMoreDisplayClick",i)}),$(".kd-onlinetips-opinion-commit",i).off("click").on("click",function(e){var a=t,o=i.find(".kd-onlinetips-textarea-container"),r=i.find(".kd-onlinetips-unsatisfied");if(a.feedbackPop)a.feedbackPop.fadeIn();else{var s=$('<div class="kd-onlinetips-feedbackPop"><span class="kd-onlineTips-feedback-icon"></span><span class="kd-onlineTips-feedback-tip">'+ResManager.LoadKDString("感谢您的反馈","00215181000008540")+"<span></div>");a.feedbackPop=s,s.appendTo(a.onlineTipsComponent).fadeIn().css("display","flex")}KD.delayInvoke(function(){r.removeClass("kd-onlinetips-unsatisfied-hover"),a.feedbackPop.fadeOut(),o.hide()},1500);var l=i.find("textarea.kd-onlinetips-opinion-textarea"),d=l.val();l.val("");var c=i.find(".kd-onlinetips-opinion-selection button.kd-state-selected"),h=[];c.each(function(e,t){h.push($(t).text())}),selTxt=h.join();var u=a.tipsData,p=u.id||"",g=u.menu||"",f=u.tiptype||"",m={};m.menu=g,m.id=p,m.tiptype=f,m.useful="无用",m.cflag=selTxt,m.content=d,n&&n.fireCustomEvents("Kingdee.BOS.LineTipsFeedbackSubmit","Kingdee.BOS.LineTipsFeedbackSubmit",JSON.stringify(m))}),$(".kd-onlinetips-opinion-cancel",i).off("click").on("click",function(e){var t=i.find(".kd-onlinetips-textarea-container");t.hide()})},getAttributesClass:function(){return this.wrapperClass}}),KDControlFactoryProxy.registerType("kdtooltip",KDKendoTooltipProxy),define("KDKendoTooltipProxy",["KDControlProxy","KDTooltip","KD"],function(e){return function(){var t;return t||e.KDKendoTooltipProxy}}(this)),KDStoryboardProxy=KD.extend(KDControlProxy,{Items:[],barsNum:5,loadConfig:function(e){KDStoryboardProxy.superclass.loadConfig.call(this,e)},createControl:function(e){KDStoryboardProxy.superclass.createControl.call(this,e)},setItems:function(e){if(null!=e){this.barsNum=e.barsNum,this._getItems(e.pushitem),this.data=$.isArray(e)?e:e.pushitem,this.component=$('<ul class="kd-stroyboad-list" style="border:none;list-style-type:none;">').appendTo(this.el);for(var t=0;t<this.Items.length;t++){var i=$(this._getTemplate(this.Items[t]));this.component.append(i)}this._rollTitle({line:e.line,speed:e.speed,timespan:e.timespan},this.component)}},_getTemplate:function(e){var t=kendo.format('<li id="{0}" class="kd-console-k3news-li" index="{1}" style="display:{2};"><div class="kd-console-k3news-img"><img src="{3}"></div><div class="kd-console-k3news-link"><a target="_blank" style="margin-left:0.75em" href="{4}"><div class="kd-console-k3news-contentdiv">{5}</div></a></div></li>',e.id,e.index,e.isDisplay,e.image,e.url,e.name);return t},_getItems:function(e){var t,i=0,a="block";this.Items=[];var n=this.barsNum;lis=[],$.each(e,function(o){a=i>n-1?"none":"block",t={index:i,id:"itemId_"+e[o].id,backgroundColor:e[o].backgroundColor,name:e[o].name,url:e[o].entryUrlReal,isDisplay:a,image:e[o].image},lis.push(t),i++}),this.Items=lis},_rollTitle:function(e,t,a){if(!e)var e={};var n=t,o=this.barsNum;n.timer=null,n.lineH=n.find("li:first").height(),n.line=e.line?parseInt(e.line,15):parseInt(n.height()/n.lineH,10),n.speed=e.speed?parseInt(e.speed,10):3e3,n.timespan=e.timespan?parseInt(e.timespan,13):5e3,0==n.line&&(t.line=1),n.upHeight=0-n.line*n.lineH,n.scrollUp=function(){n.animate({marginTop:n.upHeight},n.speed,function(){for(i=1;i<=n.line;i++)n.find("li:first").appendTo(n);var e=0;$.each(t.find("li"),function(){e>o-1?$(t.find("li")[e]).hide():$(t.find("li")[e]).show(),e++}),n.css({marginTop:0})})},n.hover(function(){clearInterval(n.timer)},function(){n.timer=KD.setInterval(function(){n.scrollUp()},n.timespan,"KDStoryboardProxy._rollTitle()")}).mouseout()},timer:null,start:function(e){var t=this;null==this.timer&&(this.timer=KD.setInterval(function(){var e=t.getFormProxy();e.fireEvent.call(e,"QueryProgressValue",t.key,0)},1e3*e,"KDStoryboardProxy.start()"))},timeStop:function(){null!=this.timer&&clearInterval(this.timer)},release:function(){clearInterval(this.timer),KDStoryboardProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdstoryboard",KDStoryboardProxy),define("KDStoryboardProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDStoryboardProxy}}(this)),KDTreeMenuProxy=KD.extend(KDControlProxy,{data:null,currentBusinessGroupIndex:0,iconPath:"",controlHeight:0,normarlNodeStyle:"kd-state-normal",loadConfig:function(e){KDTreeMenuProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDTreeMenuProxy.superclass.initComponent.call(this),this.component=$(kendo.format('<div class="kd-allmenu-tree kd-allmenu-rightmenutree" style="width:100%;">')),this._checkComponentHeight(),this.el.append(this.component),this.businessGroups=$(kendo.format('<ul class="kd-site-accordion">')),this.cardDetails=$('<ul unselectable="on" class="k-list k-reset">'),this.component.append(this.businessGroups).append(this.cardDetails)},_checkComponentHeight:function(){if(this.component){var e=0,t=this.getFormProxy();if(!t||t.dformConfig&&t.dformConfig.openstyle&&t.dformConfig.openstyle.ShowType==KDDynamicFormShowType.NewTabPage)e=KD.getWindowHeight()-KD.getBillHeadHeight();else{var i=t&&t.hostWindowProxy,a=i&&i.el&&i.el.childFormCt;e=a?a.height():this.controlHeight}this.component.css({height:e+"px"})}},doLayout:function(){this._checkComponentHeight(),KDTreeMenuProxy.superclass.doLayout.call(this)},setData:function(e,t){var i=this;void 0==e&&(e=[]),this.controlHeight=e.controlheight,this.setBusinessGroupNavigation(e,t);var a=function(e){var t=$(e.target),a=t.parent(),n=a.find("input.k-checkbox"),o=!n.is(":checked");n[getPropName()]("checked",o);var r=t.attr("parentid"),s=t.attr("formid"),l={formId:s,checked:o,groupId:r};KD.delayInvoke(function(e){var t=i.getFormProxy();t&&t.fireCustomEvents.call(t,i.key,i.updateValueAction,KD.stringify(e),null)},5,void 0,l),r==s&&KD.stopPropagation(e)};i.el.find(".kd-tabnewstyle-head .kd-treemenu-checkbox-container .k-checkbox-label").click(a),i.el.find(".kd-tabsnewsyle-list .kd-treemenu-checkbox-container .k-checkbox-label").click(a)},select:function(e){},setSelectNode:function(e){if(this.el){var t=this._getButtonIdByCardId(e,2),i=this.el.find("#"+t);if(0==i.length)t=this._getButtonIdByCardId(e,1),i=this.el.find("#"+t);else if(!i.is(":visible")){var a=i.parent().find(".kd-tabnewstyle-head");a.click()}i.click()}},setBusinessGroupNavigation:function(e,t){var i,a=this;t&&a.businessGroups.addClass("kd-site-newstyleaccordion");var n=e.isformcommonfuncard;if(a.businessGroups.empty(),null!=e)if(null==e.children)i=e[0],t?a.__buildMenuItemNewStyle(i,a,n):a._buildMenuItem(i);else for(var o=0;o<e.children.length;o++)i=e.children[o],t?a.__buildMenuItemNewStyle(i,a,n):a._buildMenuItem(i,a,n)},__buildMenuItemNewStyle:function(e,t,i){var a,n,o,r,s,l=t,d=this,c=e.selected&&1==e.selected?!0:!1,h=KD.getValue(e,"haschild",""),u=h===!1?this.normarlNodeStyle:"";KD.isMacOS()&&!KD.isChrome()&&(u+=" kd-state-mac"),n=c?"kd-nav-menutreenewstyle-select kd-nav-menutreenewstyle-expand":"";var p=e.icon&&!KD.isEmpty(e.icon)?e.icon:"Default",g="kd-tabnewstyle-icon-"+p,f="kd-tabnewstyle-icon-"+p+"_hover",m=KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),v=d._getCheckboxTemplate({cardId:e.id||"",parentId:e.id||""});a=$(kendo.format('<li id="parentli_{0}" formid="{0}" title="{1}" class="{2} {8}"><div class="kd-tabnewstyle-head" formid="{0}" haschild="{9}"><div style="background-image:url({6});" class="kd-tabnewstyle-icon {3}" icon="{4}">{7}</div><div title="{1}" class="kd-tabnewstyle-content">{1}</div><div class="kd-tabnewstyle-pointer {5}"></div></div></li>',e.id,e.title,n,c?f:g,p,c?"kd-tabnewstyle-pointerbottom":"",m,v,u,h)),c?$.each(e.cardList,function(e,t){o=t.selected&&1==t.selected?"kd-nav-childmenutreenewstyle-select":"",r=t.selected&&1==t.selected?"display:block":"display:none",s=KD.isEmpty(t.showFormId)?"":t.showFormId;var i=d._getCheckboxTemplate({cardId:t.cardId||"",parentId:$(a).attr("formid")}),n=$(kendo.format('<ul id="childnav_{0}" formid="{0}" class="kd-tabsnewsyle-list {2}" style="display:block" title="{1}" showform="{3}"><li id="childnavli_{0}"><div class="kd-mainfunction-item-container"><div class="kd-divchildnewstyle-triple"></div>{4}<div title="{1}" class="kd-divchildnewstyle-content"><span class="kd-divchildnewstyle-contentspan">{1}</span></div></div></li></ul>',t.cardId,t.cardTitle,o,s,i));a.append(n)}):$.each(e.cardList,function(e,t){o=t.selected&&1==t.selected?"kd-nav-childmenutreenewstyle-select":"",r=t.selected&&1==t.selected?"display:block":"display:none",s=KD.isEmpty(t.showFormId)?"":t.showFormId;var i=d._getCheckboxTemplate({cardId:t.cardId||"",parentId:$(a).attr("formid")}),n=$(kendo.format('<ul id="childnav_{0}" formid="{0}" class="kd-tabsnewsyle-list {2}" title="{1}" showform="{3}"><li id="childnavli_{0}"><div class="kd-mainfunction-item-container"><div class="kd-divchildnewstyle-triple"></div>{4}<div title="{1}" class="kd-divchildnewstyle-content"><span class="kd-divchildnewstyle-contentspan">{1}</span></div></div></li></ul>',t.cardId,t.cardTitle,o,s,i));a.append(n)}),a.children("div").unbind("mouseover").bind("mouseover",function(e){var t=$(this).find(".kd-tabnewstyle-icon");-1==$(this).parent().attr("class").indexOf("kd-nav-menutreenewstyle-select")&&(t.addClass("kd-tabnewstyle-icon-"+t.attr("icon")+"_hover"),t.removeClass("kd-tabnewstyle-icon-"+t.attr("icon")))}),a.children("div").unbind("mouseout").bind("mouseout",function(e){var t=$(this).find(".kd-tabnewstyle-icon");-1==$(this).parent().attr("class").indexOf("kd-nav-menutreenewstyle-select")&&(t.removeClass("kd-tabnewstyle-icon-"+t.attr("icon")+"_hover"),t.addClass("kd-tabnewstyle-icon-"+t.attr("icon")))}),a.children("div").unbind("click").bind("click",function(e){var t=$(this),i=t.parent();if(!i.hasClass(d.customDisableStyleKey)){t.find(".kd-tabnewstyle-pointer")&&t.find(".kd-tabnewstyle-pointer").toggleClass("kd-tabnewstyle-pointerbottom");var a=t.parent().siblings();$.each(a,function(e,t){var i=$(a[e]),n=i.find(".kd-tabnewstyle-icon");i.attr("class").indexOf("kd-nav-menutreenewstyle-select")>-1&&(n.removeClass("kd-tabnewstyle-icon-"+n.attr("icon")+"_hover"),n.addClass("kd-tabnewstyle-icon-"+n.attr("icon")))}),t.parent().siblings(":not(."+d.normarlNodeStyle+")").removeClass("kd-nav-menutreenewstyle-select"),t.nextAll(".kd-tabsnewsyle-list").slideToggle(20),t.nextAll(".kd-tabsnewsyle-list").css("background","#ECF0F9"),t.parent("li").addClass("kd-nav-menutreenewstyle-select");var n=t.attr("haschild");if(KD.equalsIgnoreCase(n+"","false")){d.el.find(".kd-tabsnewsyle-list.kd-nav-childmenutreenewstyle-select").removeClass("kd-nav-childmenutreenewstyle-select");var o=d.getFormProxy(),r="selectMenu",s=t.attr("formid"),l="";o&&o.fireEvent.call(o,"NaviOperAction",r,s,0,l,null,null)}}}),a.children("ul").unbind("click").bind("click",function(e){var a=$(this),n=a.parent("li").siblings();$.each(n,function(e,t){var i=$(n[e]),a=i.find(".kd-tabnewstyle-icon");i.attr("class").indexOf("kd-nav-menutreenewstyle-select")>-1&&(a.removeClass("kd-tabnewstyle-icon-"+a.attr("icon")+"_hover"),a.addClass("kd-tabnewstyle-icon-"+a.attr("icon")))});var o=a.parent("li"),r=o.find(".kd-tabnewstyle-icon"),s=o.find(".kd-tabnewstyle-icon").attr("class");o.addClass("kd-nav-menutreenewstyle-select"),o.siblings().removeClass("kd-nav-menutreenewstyle-select"),o.siblings().children().removeClass("kd-nav-childmenutreenewstyle-select"),a.siblings().removeClass("kd-nav-childmenutreenewstyle-select"),a.addClass("kd-nav-childmenutreenewstyle-select"),s&&!KD.isEmpty(s)&&-1==s.indexOf("_hover")&&(r.addClass("kd-tabnewstyle-icon-"+r.attr("icon")+"_hover"),r.removeClass("kd-tabnewstyle-icon-"+r.attr("icon")));var l=t.getFormProxy(),d="selectMenu",c=a.attr("formid"),h=a.attr("showform");if(l.fireEvent.call(l,"NaviOperAction",d,c,0,h,null,null),"false"===i){var u=$(a.parent()).index(),p=(document.documentElement.clientHeight,0);a.parent().parent("ul").children("li").each(function(e,t){u>=e&&(p+=$(a.parent().parent()).children("li").eq(e).height())})}}),l.businessGroups.append(a)},_getCheckboxTemplate:function(e){e=e||{};var t=kendo.format('<span data-role="checkbox" class="kd-treemenu-checkbox-container"><input type="checkbox" onclick="return false;" style="height:16px;display: inline-block;" class="k-checkbox gridCheck gridCheckCell"  checked="checked" ><label class="k-checkbox-label" for=":before" formid={0} parentid="{1}"></label></span>',e.cardId,e.parentId);return t},_getButtonIdByCardId:function(e,t){var i="";return e=KD.isEmpty(e)?"":e,i=1==t?"parentli_"+e:"childnav_"+e},_buildMenuItem:function(e,t,i){var a=e.selected&&1==e.selected?!0:!1;parentliclass=a?"kd-nav-menutree-select":"",nav=$(kendo.format('<li id="parentli_{0}" title="{1}" class="{2}"><div class="kd-tab-head"><div title="{1}" class="kd-newstyletab-content">{1}</div></div></li>',e.id,e.title,parentliclass)),a?$.each(e.cardList,function(e,t){childulclass=t.selected&&1==t.selected?"kd-nav-childmenutree-select":"",childulisvisible=t.selected&&1==t.selected?"display:block":"display:none";var i=$(kendo.format('<ul id="childnav_{0}" formid="{0}" class="kd-tabs-list {2}" style="display:block" title={1}><li id="childnavli_{0}"><div><div title="{1}" class="kd-divchild-content">{1}</div></div></li></ul>',t.cardId,t.cardTitle,childulclass));nav.append(i)}):$.each(e.cardList,function(e,t){childulclass=t.selected&&1==t.selected?"kd-nav-childmenutree-select":"",childulisvisible=t.selected&&1==t.selected?"display:block":"display:none";var i=$(kendo.format('<ul id="childnav_{0}" formid="{0}" class="kd-tabs-list {2}" title={1}><li id="childnavli_{0}"><div><div title="{1}" class="kd-divchild-content">{1}</div></div></li></ul>',t.cardId,t.cardTitle,childulclass));nav.append(i)}),nav.children("div").click(function(e){var t=$(this);t.parent().siblings().removeClass("kd-nav-menutree-select"),t.nextAll(".kd-tabs-list").slideToggle(20),t.nextAll(".kd-tabs-list").css("background","#ECF0F9"),$(".kd-tab-head").css("background","#FFFFFF"),t.parent("li").addClass("kd-nav-menutree-select")}),nav.children("ul").click(function(e){var a=$(this);a.parent().addClass("kd-nav-menutree-select"),a.parent().siblings().removeClass("kd-nav-menutree-select"),a.parent().siblings().children().removeClass("kd-nav-childmenutree-select"),a.siblings().removeClass("kd-nav-childmenutree-select"),a.addClass("kd-nav-childmenutree-select");var n=t.getFormProxy(),o="selectMenu",r=a.attr("formid"),s=a.attr("title");if(n.fireEvent.call(n,"NaviOperAction",o,r,0,s,null,null),"false"===i){var l=$(a.parent()).index(),d=document.documentElement.clientHeight,c=0;a.parent().parent("ul").children("li").each(function(e,t){l>=e&&(c+=$(a.parent().parent()).children("li").eq(e).height())}),c>d-90&&a.parent().parent("ul").children("li").each(function(e,t){l>e&&$(t).find("ul.kd-tabs-list").css({display:"none"})})}}),this.businessGroups.append(nav)},release:function(){KDTreeMenuProxy.superclass.release.call(this)}}),function(){$.extend(KDTreeMenuProxy.prototype,{updateValueAction:"UpdateValue",customVisibleStyleKey:"kd-state-hidden",customDisableStyleKey:"kd-state-disabled",editModelStyleKey:"kd-mainconsole-function-edit",editModel:"",isEditModel:function(){var e=1==this.editModel;return e},setEditModel:function(e){this.editModel=e,1==e?this.el.addClass(this.editModelStyleKey):this.el.removeClass(this.editModelStyleKey)},setConsoleMenuVisible:function(e){if(KD.isArray(e)&&this.component){var t=this.component.find("."+this.customVisibleStyleKey);t.removeClass(this.customVisibleStyleKey);var i=this.component.find(".kd-treemenu-checkbox-container input.k-checkbox");i[getPropName()]("checked",!0);for(var a=0;a<e.length;a++){var n=e[a];if(n){var o=this._getButtonIdByCardId(n.formId,2),r=this.el.find("#"+o),s=r.find(".kd-treemenu-checkbox-container input.k-checkbox");0==r.length&&(o=this._getButtonIdByCardId(n.formId,1),r=this.el.find("#"+o),s=r.find(".kd-tabnewstyle-head .kd-treemenu-checkbox-container input.k-checkbox"));var l=0==n.checked?!1:!0;0==l?r.addClass(this.customVisibleStyleKey):r.removeClass(this.customVisibleStyleKey),s[getPropName()]("checked",l)}}}},setConsoleMenuDisabled:function(e){if(KD.isArray(e)&&this.component)for(var t=0;t<e.length;t++){var i=e[t];if(i){var a=this._getButtonIdByCardId(i.formId,2),n=this.el.find("#"+a);0==n.length&&(a=this._getButtonIdByCardId(i.formId,1),n=this.el.find("#"+a));var o=1==i.disabled?!0:!1;1==o?n.addClass(this.customDisableStyleKey):n.removeClass(this.customDisableStyleKey)}}}})}(),KDControlFactoryProxy.registerType("kdtreemenu",KDTreeMenuProxy),define("KDTreeMenuProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDTreeMenuProxy}}(this)),KDNavigationBarProxy=KD.extend(KDControlProxy,{selectIndex:0,createControlDom:function(){return $('<div class="ui_kdwizardtitle"></div>')},loadConfig:function(e){var t=this,i={display:"inline-block"};if(t.config=e,KDNavigationBarProxy.superclass.loadConfig.call(t,e),t.selectIndex=KD.getValue(e,"selectedIndex",0),t.config.itemclick=KD.getValue(e,"itemclick",!1),e.margin){var a=KD.layout.kdRangeSize2HTMLRangeSize(e.margin),n=KD.layout.getRangeSizeStyleValue("margin",a);$.extend(i,n)}if(e.padding){var o=KD.layout.kdRangeSize2HTMLRangeSize(e.padding),n=KD.layout.getRangeSizeStyleValue("padding",o);$.extend(i,n)}t.el.css(i),t.setData(t.config)},setSelectedIndex:function(e){e!=this.selectIndex&&(this.selectIndex=e,this.updateStatus())},setDisabledClass:function(e,t){1==t?(e.is("span")&&e.removeClass("ui_state_itemdisabled"),e.hasClass("triangle_right")&&e.removeClass("triangle_right_itemdisabled"),e.hasClass("triangle_top_bottom")&&e.removeClass("triangle_topbottom_itemdisabled")):-1==t&&(e.is("span")&&e.addClass("ui_state_itemdisabled"),e.hasClass("triangle_right")&&e.addClass("triangle_right_itemdisabled"),e.hasClass("triangle_top_bottom")&&e.addClass("triangle_topbottom_itemdisabled"))},updateStatus:function(){if(this.selectIndex>=0){var e=this;this.el.children().each(function(){var t=$(this).attr("kd-data");t==e.selectIndex?e.setDisabledClass($(this),1):e.setDisabledClass($(this),-1),$(this).unbind("click"),$(this).removeClass("itemcanclick"),e.config.itemclick&&($(this).addClass("itemcanclick"),$(this).bind("click",function(){e.onItemClick($(this))}))})}},onItemClick:function(e){var t=e.attr("kd-data");if(t!=this.selectIndex){this.setSelectedIndex(parseInt(t));var i=this.getFormProxy();i&&i.fireCustomEvents(this.getKey(),"WizardTitleClick",this.selectIndex)}},setItemCanClick:function(e){e||(e=!1),this.config.itemclick=e,this.updateStatus()},setHeight:function(e){},setData:function(e){if(e&&e.items){this.el.find("div").remove(),this.el.find("span").remove();var t=0,i=e.items;i.items&&(i=i.items),this.config.items=i;for(var a in i){var n=i[a];t++;1==t?this.addHeaderDom(n.name,0):t==e.items.length?this.addTailDom(n.name,t-1):this.addBodyDom(n.name,t-1)}-1==this.selectIndex&&(this.selectIndex=0),this.updateStatus()}},addHeaderDom:function(e,t){t||(t=0);var i="<span kdrole=header kd-data="+t+">"+e+"</span>";return i+="<div kdrole=header kd-data="+t+" class='triangle_right'></div>",this.el.append(i),$(i)},addTailDom:function(e,t){t||(t=0);var i="<div kdrole=tail kd-data="+t+" class='triangle_top_bottom'></div>";return i+="<span kdrole=tail kd-data="+t+">"+e+"</span>",this.el.append(i),$(i)},addBodyDom:function(e,t){t||(t=0);var i="<div kdrole=body kd-data="+t+" class='triangle_top_bottom'></div>";return i+="<span kdrole=body kd-data="+t+">"+e+"</span>",i+="<div kdrole=body kd-data="+t+" class='triangle_right'></div>",this.el.append(i),$(i)}}),KDControlFactoryProxy.registerType("kdwizardtitle",KDNavigationBarProxy),define("KDNavigationBarProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDNavigationBarProxy}}(this)),KDOrgChartProxy=KD.extend(KDControlProxy,{rgChartNodeW:150,rgChartNodeH:60,rgChartNodeOutW:170,rgChartNodeOutH:80,rootNode:null,rgChartNodeLayout:null,_drawGrounpLine:function(e,t){var i=(new this.draw.Path).moveTo(t.x+this.rgChartNodeW/2,t.y+this.rgChartNodeH).lineTo(t.x+this.rgChartNodeW/2,e.y-(this.rgChartNodeOutH-this.rgChartNodeH)/2).lineTo(e.x+this.rgChartNodeW/2,e.y-(this.rgChartNodeOutH-this.rgChartNodeH)/2).lineTo(e.x+this.rgChartNodeW/2,e.y);this.surface.draw(i)},_drawCircle:function(){var e=new geom.Circle([20,20],20),t=new draw.Circle(e).stroke("green",1);this.surface.draw(t)},_getTrueLength:function(e){for(var t=e.length,i=0,a=0;t>a;a++)i+=e.charCodeAt(a)>128?2:1;return i},_cutString:function(e,t){for(var i=e.length,a=i,n=0,o=0;i>o;o++)if(e.charCodeAt(o)>128){if(!(t>n+2)){a=o;break}n+=2}else{if(!(t>n+1)){a=o;break}n+=1}return a},_writeTextOnCanvas:function(e){for(var t="",i=e.fname,a=e.y,n=1;this._getTrueLength(i)>0;n++)t=this._cutString(i,23),this._drawText(i.substr(0,t).replace(/^\s+|\s+$/,""),e),i=i.substr(t),e.y=e.y+18;e.y=a},_drawText:function(e,t){var i=new this.draw.Text("",[t.x+7,t.y+10],{cursor:"pointer",stroke:{color:"black",width:0},opacity:1});i.content(e),this.surface.draw(i)},_drweImage:function(e,t){var i=new this.geom.Rect([e.x,e.y],[this.rgChartNodeW,this.rgChartNodeH]),a=new this.draw.Image("Content/themes/Images/btn_orgNode.png",i);this.surface.draw(a),t&&this._drawGrounpLine(e,t),this._writeTextOnCanvas(e)},_drawRect:function(e){var t=new this.geom.Point(210,0),i=new this.geom.Rect(t,[150,56]),a=new this.draw.Rect(i,{cursor:"pointer",stroke:{color:"black",width:1},fill:{color:"silver"}});this.surface.draw(a)},setOrgChartXml:function(e){if(void 0!=e.orgchartmetadata.OrgChartXml){e.orgchartmetadata.OrgChartXml.sort(function(e,t){var i=parseFloat(e.fdeptid),a=parseFloat(t.fdeptid);return!KD.isNaN(i)&&!KD.isNaN(a)&&i>a?1:-1});var t=this;$("#"+this.baseId+"_surface").remove(),this.drawDiv=$('<div id="'+this.baseId+'_surface" style="width:100%;height:100%;overflow:auto;"></div>'),this.el.append(this.drawDiv),this.draw=kendo.drawing,this.geom=kendo.geometry,this.surface=this.draw.Surface.create($("#"+this.baseId+"_surface")),this.orgChartList=e.orgchartmetadata.OrgChartXml;for(var i in e.orgchartmetadata.OrgChartXml)e.orgchartmetadata.OrgChartXml[i].ChildNum=this._getChildNum(e.orgchartmetadata.OrgChartXml[i]);this._getNodePosition(),$(this.surface._rootElement).css("width",this._getCanvasWidth()+"px"),t._generateOrgChart()}},_getCanvasWidth:function(){for(var e=0,t=0;t<this.rgChartNodeLayout.length;t++)e=e<this.rgChartNodeLayout[t]?this.rgChartNodeLayout[t]:e;return e},_getChildNum:function(e){e.childNode=[];var t=0;for(var i in this.orgChartList)1==this.orgChartList[i].fisroot&&(this.rootNode=this.orgChartList[i]),e.fdeptid==this.orgChartList[i].fparentid&&(t++,e.childNode.push(this.orgChartList[i]));return t},_getNodePosition:function(){if(this.rgChartNodeLayout=new Array,this.rootNode.y=0,this.rootNode.x=500,this.rootNode.childNode.length>0)for(var e=0;e<this.rootNode.childNode.length;e++)this.rootNode.childNode[e].y=(this.rootNode.childNode[e].fdepth-1)*this.rgChartNodeOutH,this.rootNode.childNode.length%2==0?this.rootNode.childNode[e].x=this.rootNode.x+this.rgChartNodeW/2+(e-this.rootNode.childNode.length/2)*this.rgChartNodeOutW:this.rootNode.childNode[e].x=this.rootNode.x+(e-parseInt(this.rootNode.childNode.length/2))*this.rgChartNodeOutW,this.rootNode.childNode[e].x<this.rgChartNodeLayout[this.rootNode.childNode[e].fdepth]&&this._adjustmentNodePosition(this.rootNode.childNode[e],this.rgChartNodeLayout[this.rootNode.childNode[e].fdepth]),this.rootNode.childNode[e].x<0&&this._adjustmentNodePosition(this.rootNode.childNode[e],0),this._getChildNodePosition(this.rootNode.childNode[e]),this.rgChartNodeLayout[this.rootNode.childNode[e].fdepth]=this.rootNode.childNode[e].x+this.rgChartNodeOutW},_getChildNodePosition:function(e){if(e.childNode.length>0)for(var t=0;t<e.childNode.length;t++)e.childNode[t].y=(e.childNode[t].fdepth-1)*this.rgChartNodeOutH,e.childNode.length%2==0?e.childNode[t].x=e.x+this.rgChartNodeW/2+(t-e.childNode.length/2)*this.rgChartNodeOutW:e.childNode[t].x=e.x+(t-parseInt(e.childNode.length/2))*this.rgChartNodeOutW,
e.childNode[t].x<this.rgChartNodeLayout[e.childNode[t].fdepth]&&this._adjustmentNodePosition(e.childNode[t],this.rgChartNodeLayout[e.childNode[t].fdepth]),e.childNode[t].x<0&&this._adjustmentNodePosition(e.childNode[t],0),this._getChildNodePosition(e.childNode[t]),this.rgChartNodeLayout[e.childNode[t].fdepth]=e.childNode[t].x+this.rgChartNodeOutW},_adjustmentNodePosition:function(e,t){var i=(t-e.x)/this.rgChartNodeOutW*this.rgChartNodeOutW,a=e.x;e.fdeptid==this.rootNode.fdeptid?e.x=e.x+(t-e.x)/this.rgChartNodeOutW*this.rgChartNodeOutW/2:e.x=e.x+(t-e.x)/this.rgChartNodeOutW*this.rgChartNodeOutW,this._adjustParentNodePosition(e,i,a,!0)},_adjustParentNodePosition:function(e,t,i,a){for(var n in this.orgChartList)if(e.fparentid==this.orgChartList[n].fdeptid){var o=this.orgChartList[n].x;i<this.orgChartList[n].x&&this.orgChartList[n].fdeptid!=this.rootNode.fdeptid?this.orgChartList[n].x=this.orgChartList[n].x+t:this.orgChartList[n].x=this.orgChartList[n].x+t/2,this._adjustParentNodePosition(this.orgChartList[n],t,o,!1)}},_generateOrgChart:function(){var e=this.rootNode;if(e){var t=e;this._drweImage(t,null),this._generateChart(t)}},_generateChart:function(e){var t=e.childNode?e.childNode:[],i=[];if(t.length>0)for(var a=0;a<t.length;a++)i=t[a],this._drweImage(t[a],e),this._generateChart(t[a])}}),KDControlFactoryProxy.registerType("kdorgchart",KDOrgChartProxy),define("KDOrgChartProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDOrgChartProxy}}(this)),SqlStorageType={SqlImage:34,SqlText:35,SqlUniqueidentifier:36,SqlTinyint:48,SqlSmallint:52,SqlInt:56,SqlSmalldatetime:58,SqlReal:59,SqlMoney:60,SqlDatetime:61,SqlFloat:62,SqlnText:99,SqlBit:104,SqlDecimal:106,SqlNumeric:108,SqlSmallmoney:122,SqlBigInt:127,Sqlvarbinary:165,Sqlvarchar:167,SqlBinary:173,Sqlchar:175,SqlTimestamp:189,SqlSysname:231,Sqlnvarchar:231,Sqlnchar:239,SqlXML:241},KDMobilePageEditorProxy=KD.extend(KDControlProxy,{indexEnumSource:[{name:ResManager.LoadKDString("标题1","099002000000067"),value:"0"},{name:ResManager.LoadKDString("标题2","099002000000068"),value:"1"},{name:ResManager.LoadKDString("标题3","099002000000069"),value:"2"},{name:ResManager.LoadKDString("第二行1","099002000000070"),value:"10"},{name:ResManager.LoadKDString("第二行2","099002000000071"),value:"11"},{name:ResManager.LoadKDString("第二行3","099002000000072"),value:"12"},{name:ResManager.LoadKDString("第三行1","099002000000073"),value:"20"},{name:ResManager.LoadKDString("第三行2","099002000000074"),value:"21"},{name:ResManager.LoadKDString("第三行3","099002000000075"),value:"22"},{name:ResManager.LoadKDString("顺序行排列","099002000000076"),value:"100"}],variabletypeEnumSource:[{name:ResManager.LoadKDString("简单文本","099002000000077"),value:"SimpleText"},{name:ResManager.LoadKDString("基础资料编码","099002000000078"),value:"BaseDataField_Code"},{name:ResManager.LoadKDString("基础资料名称","099002000000079"),value:"BaseDataField_Name"},{name:ResManager.LoadKDString("金额","099002000000080"),value:"Money"},{name:ResManager.LoadKDString("数量","099002000000081"),value:"Count"},{name:ResManager.LoadKDString("数值","099002000000082"),value:"Float"},{name:ResManager.LoadKDString("短日期","099002000000083"),value:"ShortDateTime"},{name:ResManager.LoadKDString("长日期","099002000000084"),value:"LongDateTime"}],loadConfig:function(e){KDMobilePageEditorProxy.superclass.loadConfig.call(this,e),this.noShowTitle=KD.getValue(this.config,"noShowTitle",!1),this.titleProxy=this.genTitle(),this.skinColorProxy=this.genSkinColor(),this.genConfigContainer()},genTitle:function(){var e=new Object;e.id="LIGHTAPPTITLE",e.x=10,e.y=5,e.width=255,e.height=25,e["z-index"]=1,e.labelText=ResManager.LoadKDString("轻应用标题:","099002000000062"),e.labelWidth=80,e.disabled=!1,e.xtype="kditemcontainer";var t=new Object;t.disabled=!1,t.editable=!0,t.xtype="textfield",e.item=t;var i=this.getControlFactoryProxy().createControl(e);this.el.append(i.getControl()),i.loadConfig(e),i.initComponent();var a=this;return i.editor&&(i.editor.onchange=function(e,t){a.titleChange(e,t)}),i.editor&&i.editor.setDisabled(!1),this.titleContainerProxy=i,i.editor},titleChange:function(e,t){this.PreviewView&&this.PreviewView.find(".previewViewHeader").text(t)},genSkinColor:function(){this.el.append('<span style="position:absolute;top:5px;left:255px;line-height:23px;">皮肤颜色:</span>');var e=new Object;e.id="LIGHTAPPSKINCOLOR",e.x=310,e.y=5,e.width=200,e.height=20,e["z-index"]=2,e.xtype="kdpopupcolor",e.isfield=!1,e.showdefaultbutton=!0,e.showmorecolorbutton=!0,e.shownocolorbutton=!0,e.showborder=!0;var t=this.getControlFactoryProxy().createControl(e);this.el.append(t.getControl()),t.loadConfig(e),t.initComponent();var i=this;return t.onchange=function(e,t){i.skinColorChagne(e,t),this.oldValue=this._value,this._value=t},t},skinColorChagne:function(e,t){this.PreviewView&&this.PreviewView.find(".previewViewHeader").css("background-color",t),this.rowChange(t,!1)},genConfigContainer:function(){var e=$('<div style="position:absolute;top:35px;left:5px;width:100%;"></div>');this.el.append(e),this.VeriableView=this.genVeriableView(e),this.PreviewView=this.genPreviewView(e)},rowChange:function(e,t,i){var a=this.tagGrid.dataItems(),n=new Object;n.header=this.titleProxy.getValue(),n.veriablelable=this.VeriableView.find(".veriableLable").text(),n.previewlable=this.PreviewView.find(".previewViewLable").text(),n.templatekey="SimpleGrid",n.maincolor=this.skinColorProxy.getValue(),void 0!=e&&(n.maincolor=e);for(var o=[],r=0;r<a.length;r++){var s=a[r],l={};l.isselected="1"==s.isselected?!0:!1,l.fieldtype=parseInt(s.fieldtype),l.index=parseInt(s.index.value),l.id=s.fid,l.header=s.header,l.variabletype=s.variabletype.value,l.forecolor=s.forecolor,l.SLforecolor=this.formatSLColor(l.forecolor),l.isBaseDataField=s.isBaseDataField,o.push(l)}if(n.variableitems=o,!i){var d=this.getFormProxy();d.lockControl.call(d,this),d.fireEvent.call(d,"CustomEvents","DataChanged","OnMobilePageInfoChanged",this.formatSLData(n))}t||this.setData(n,!0)},formatSLData:function(e){var t=$.extend(!0,{},e);if(t.maincolor=this.formatSLColor(t.maincolor),t&&t.variableitems)for(var i=0;i<t.variableitems.length;i++){var a=t.variableitems[i];a.forecolor=a.SLforecolor}var n=JSON.stringify(t);return n},genVeriableView:function(e){var t=KD.layout.getActualHeight(e.parent())-40,i=$('<div class="veriableDiv" style="float:left;width:420px;height:'+t+'px; border:0px"><div class="veriableLable" style="background:#F1F1F1;height:25px;padding-left:10px;line-height:25px;"></div></div>');e.append(i);var a=this,n={id:this.baseId+"VeriableView",width:"100%",editable:!0,dataSource:{data:[],id:"Number",autoSync:!1,schema:{model:{fields:{id:{editable:!1},fid:{editable:!1},fieldtype:{editable:!1},isselected:{editable:!1,type:"boolean"},header:{editable:!0},index:{editable:!0},variabletype:{editable:!0},forecolor:{editable:!1},SLforecolor:{editable:!0},isBaseDataField:{editable:!1}}}}},columns:[{field:"id",hidden:!0,title:" "},{field:"fid",hidden:!0,title:" "},{field:"fieldtype",hidden:!0,title:" "},{field:"isselected",width:30,title:" ",hidden:"kdlightapp"==a.config.xtype?!0:!1,editable:!1,template:'<div data-role="checkbox" class="kd-grid-celldiv" ><input type="checkbox" onclick="return false;" class="k-checkbox gridCheck gridCheckCell"  data-field="Visible" data-rowId="#= id-1 #"  #= isselected ?  checked="checked":"" # /><label class="k-checkbox-label" for=":before"></label></div>'},{field:"header",width:70,template:'<span class="kd-grid-cellspan" title =" #= header #">#= header # </span>',headerTemplate:'<span class="k-link">'+ResManager.LoadKDString("变量名称","099002000000063")+"</span>"},{field:"index",headerTemplate:'<span class="k-link">'+ResManager.LoadKDString("显示位置","099002000000064")+"</span>",template:"#= index.name #",width:30,editor:function(e,t){var i=$('<input  required data-text-field="name" data-value-field="value"  data-bind="value:'+t.field+'"/>').appendTo(e).kendoDropDownList({height:"250px",dataSource:{data:a.indexEnumSource}});i.data("kendoDropDownList").list.width(100)}},{field:"variabletype",width:30,headerTemplate:'<span class="k-link">'+ResManager.LoadKDString("变量类型","099002000000065")+"</span>",template:"#= variabletype.name #",editor:function(e,t){var i=a.variabletypeEnumSource;t.model.isBaseDataField||(i=i.filter(function(e){return~e.value.indexOf("BaseDataField")?void 0:!0})),$('<input  required data-text-field="name" data-value-field="value"  data-bind="value:'+t.field+'"/>').appendTo(e).kendoDropDownList({dataSource:{data:i}})}},{field:"forecolor",hidden:!0},{field:"SLforecolor",width:35,headerTemplate:'<span class="k-link">'+ResManager.LoadKDString("字体颜色","099002000000066")+"</span>",template:"<span style='width:25px;height:20px;margin-top:8px;display:inline-block;background-color:#: forecolor #'></span><span>#: SLforecolor # </span>",editor:function(e,t){$('<input  required data-bind="value:forecolor" />').appendTo(e).kendoColorPicker({palette:"websafe",value:t.model.forecolor,buttons:!1,preview:!0,change:function(){var t=this.value();t=a.formatSLColor(t),$(".k-selected-color",e).text(t)}}),$(".k-selected-color",e).width(68).css({"text-align":"center","line-height":"18px"}).text(t.model.SLforecolor)}}],save:function(e){KD.delayInvoke(function(){a.rowChange(void 0,!1)},5)}},o=$("<div style='height:"+(t-25)+"PX;'></div>");return i.append(o),this.tagGrid=o.kendoGrid(n).data("kendoGrid"),i.delegate(".k-headerCheckbox-label","click",function(){var e=this,t=$(".gridCheck",$(e).parent());if(t.length){var i=!t.is(":checked"),n=t.data();field=n.field,t[getPropName()]("checked",i);var o=$(e).closest(".k-grid").data("kendoGrid");o.table.find(".gridCheckCell")[getPropName()]("checked",i);for(var r=o.dataItems(),s=0;s<r.length;s++)r[s].isselected=i;a.rowChange(void 0,!1)}}),i.delegate('.kd-grid-celldiv[data-role="checkbox"]',"click",function(e){var t=this,i=$(".gridCheck",$(t)),n=!i.is(":checked");i.data();i[getPropName()]("checked",n),$(t).closest(".k-grid").data("kendoGrid").dataItems()[$(this).parent().parent().index()].isselected=n,a.rowChange(void 0,!1)}),i},genPreviewView:function(e){var t=KD.layout.getActualHeight(e.parent())-40,i=$('<div class="previewViewDiv" style="float:left;width:'+(this.el.width()-440)+"px;height:"+t+'px; border:1px solid #E2E2E2;margin-left:10px;"><div class="previewViewLable" style="background:#F1F1F1;height:25px;padding-left:10px;line-height:25px;"></div><div class="previewViewHeader" style="height: 30px;background-color:#c94430;line-height:30px;padding-left:10px;color:white;font-size:14px;"></div><div class="previewViewTable" style="height:'+(t-25-30)+'px;overflow:auto;"></div></div>');return e.append(i),i},variableindexArray:[0,1,2,10,20,100,100,100,100,100,100],setData:function(e,t){this.PreviewView.find(".previewViewTable").empty(),this.titleProxy.setValue(e.header);var i=this.formatHtmlColor(e.maincolor);this.skinColorProxy.component.data(this.skinColorProxy.getKendoCType()).value(i),this.skinColorProxy.setValue(i),this.VeriableView.find(".veriableLable").text(e.veriablelable),this.PreviewView.find(".previewViewLable").text(e.previewlable),this.PreviewView.find(".previewViewHeader").css("background-color",i),e.noHeader||this.PreviewView.find(".previewViewHeader").text(e.header);var a=new Array,n=this.getTableMeta(),o="",r=1,s={};for(var l in e.variableitems){var d=e.variableitems[l],c=new Object;if(c.id=l,c.fid=d.id,c.fieldtype=d.fieldtype,c.isBaseDataField=d.isBaseDataField,c.isselected=KD.getValue(d,"isselected",!0),c.header=d.header,c.index={},c.index.value=d.index||this.variableindexArray[l],d&&0==d.index&&(c.index.value=d.index),this._isKeyInList(this.indexEnumSource,c.index.value)||(c.index.value="100"),c.index.name=this._getNameByValue(this.indexEnumSource,c.index.value),c.variabletype={},c.variabletype.value=this.initVariableType(d.variabletype,d.fieldtype),c.variabletype.name=this._getNameByValue(this.variabletypeEnumSource,c.variabletype.value),c.forecolor=this.getFormatColorString(d.forecolor,c.variabletype.value,c.index.value),c.SLforecolor=this.formatSLColor(c.forecolor),a.push(c),c.isselected){var h=this.getFormatString(c.header,c.variabletype.value,c.index.value.toString(),l.toString());"100"==c.index.value?(s["1"+r]=this.getFormatString(c.header,c.variabletype.value,c.index.value.toString(),"1"),s["2"+r]=this.getFormatString(c.header,c.variabletype.value,c.index.value.toString(),"2"),s["3"+r]=this.getFormatString(c.header,c.variabletype.value,c.index.value.toString(),"3"),o+='<span style="line-height:'+this.trHeight+";display:block;color:"+c.forecolor+'; width:100%">{'+r+"auto100Object}</span>",r++):n=this.replaceHtml(n,c,h,l.toString())}}for(var u={1:o,2:o,3:o},p=1;r>p;p++){var g="{"+p+"auto100Object}";u={1:u[1].replace(g,s["1"+p]||""),2:u[2].replace(g,s["2"+p]||""),3:u[3].replace(g,s["3"+p]||"")}}n=n.replace("{value100}",u[1]).replace("{1value100}",u[2]).replace("{2value100}",u[3]);var f=new kendo.data.DataSource({data:a,schema:{model:{fields:{id:{editable:!1},fid:{editable:!1},fieldtype:{editable:!1},isselected:{editable:!1,type:"boolean"},header:{editable:"kdlightapp"==this.config.xtype?!1:!0},index:{editable:!0},variabletype:{editable:!0},isBaseDataField:{editable:!1}}}}});this.tagGrid.setDataSource(f),n=n.replace(/\{\w*\}/g,""),this.PreviewView.find(".previewViewTable").append(n),this.rowChange(void 0,!0,t)},trHeight:"25px",replaceHtml:function(e,t,i,a){var i=this.getFormatString(t.header,t.variabletype.value,t.index.value.toString(),a.toString());return e=e.replace("{title"+t.index.value+"}",t.header).replace("{value"+t.index.value+"}",i).replace("{1value"+t.index.value+"}",i).replace("{2value"+t.index.value+"}",i),e=e.replace("{color"+t.index.value+"}",t.forecolor).replace("{1color"+t.index.value+"}",t.forecolor).replace("{2color"+t.index.value+"}",t.forecolor)},_isKeyInList:function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i].value.toString()==t.toString())return!0;return!1},_getNameByValue:function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i].value.toString()==t.toString())return e[i].name;return""},initVariableType:function(e,t){if(KD.IsNullOrWhiteSpace(e))switch(t){case SqlStorageType.SqlDatetime:case SqlStorageType.SqlSmalldatetime:e="ShortDateTime";break;case SqlStorageType.SqlMoney:case SqlStorageType.SqlSmallmoney:e="Money";break;case SqlStorageType.SqlBigInt:case SqlStorageType.SqlInt:e="Count";break;case SqlStorageType.SqlDecimal:case SqlStorageType.SqlFloat:e="Count";break;default:e="SimpleText"}return e},getFormatColorString:function(e,t,i){return KD.IsNullOrWhiteSpace(e)?e=this.getInitForeColor(t):e.length>7?"#"+e.substr(3):e},formatSLColor:function(e){return KD.IsNullOrWhiteSpace(e)?e:e.length>7?e.toUpperCase():"#FF"+e.replace("#","").toUpperCase()},formatHtmlColor:function(e){return KD.IsNullOrWhiteSpace(e)?e:e.length>7?e.replace("#FF","#").toUpperCase():e.toUpperCase()},getInitForeColor:function(e){switch(e){case"SimpleText":return"#2d2b2b";case"BaseDataField_Code":return"#0070c0";case"BaseDataField_Name":return"#0070c0";case"Money":return"#c94430";case"Count":return"#2d2b2b";case"Float":return"#2d2b2b";case"ShortDateTime":return"#ec8b2b";case"LongDateTime":return"#ec8b2b";default:return"#2d2b2b"}},getFormatString:function(e,t,i,a){var n="",o=new Date;switch(t){case"SimpleText":n=e;break;case"BaseDataField_Code":n="JC00001234";break;case"BaseDataField_Name":n=e;break;case"Money":n="25354";break;case"Count":n="2351";break;case"Float":n="12345.12";break;case"ShortDateTime":n=o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate();break;case"LongDateTime":n=o.toLocaleString();break;default:n=e}return"0"!=i&&"1"!=i&&"2"!=i&&(n=e+":"+n),n},getTableMeta:function(){return'<table class="previewTable" cellspacing="0" cellpadding="0" style="width:100%;font-size:14px;"><tr style="height:40px;background-color:#F1F1F1;word-break: break-all;"><th style="width:100px">{title0}</th><th>{title1}</th><th>{title2}</th></tr><tr><td style="color:{color0}">{value0}</td><td style="color:{color1}">{value1}</td><td style="color:{color2}">{value2}</td></tr><tr style="margin-top:10px;"><td colspan="3"><div style="margin-top:10px;width:315px;overflow:hidden"><span style="color:{color10}">{value10}</span><span style="color:{color11}">{value11}</span><span style="color:{color12}">{value12}</span></div></td></tr><tr><td colspan="3"><div style="width:315px;overflow:hidden"><span style="color:{color20}">{value20}</span><span style="color:{color21}">{value21}</span><span style="color:{color22}">{value22}</span></div></td></tr><tr ><td colspan="3"><div style="border-bottom:1px solid #E2E2E2;">{value100}</div></td></tr><tr ><td style="color:{1color0}">{1value0}</td><td style="color:{1color1}">{1value1}</td><td style="color:{1color2}">{1value2}</td></tr><tr ><td colspan="3"><div style="width:315px;overflow:hidden"><span style="color:{1color10}">{1value10}</span><span style="color:{1color11}">{1value11}</span><span style="color:{1color12}">{1value12}</span></div></td></tr><tr ><td colspan="3"><div style="width:315px;overflow:hidden"><span style="color:{1color20}">{1value20}</span><span style="color:{1color21}">{1value21}</span><span style="color:{1color22}">{1value22}</span></div></td></tr><tr ><td colspan="3"><div style="border-bottom:1px solid #E2E2E2;">{1value100}</div></td></tr><tr ><td style="color:{2color0}">{2value0}</td><td style="color:{2color1}">{2value1}</td><td style="color:{2color2}">{2value2}</td></tr><tr ><td colspan="3"><div style="width:315px;overflow:hidden"><span style="color:{2color10}">{2value10}</span><span style="color:{2color11}">{2value11}</span><span style="color:{2color12}">{2value12}</span></div></td></tr><tr ><td colspan="3"><div style="width:315px;overflow:hidden"><span style="color:{2color20}">{2value20}</span><span style="color:{2color21}">{2value21}</span><span style="color:{2color22}">{2value22}</span></div></td></tr><tr><td colspan="3"><div style="border-bottom:1px solid #E2E2E2;">{2value100}</div></td></tr></table>'}}),KDControlFactoryProxy.registerType("kdmobilepageeditor",KDMobilePageEditorProxy),define("KDMobilePageEditorProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDMobilePageEditorProxy}}(this)),KDLightAppEditorProxy=KD.extend(KDMobilePageEditorProxy,{indexEnumSource:[{name:ResManager.LoadKDString("标题1","099002000000067"),value:"0"},{name:ResManager.LoadKDString("标题2","099002000000069"),value:"2"},{name:ResManager.LoadKDString("第二行1","099002000000070"),value:"10"},{name:ResManager.LoadKDString("第二行2","099002000000072"),value:"12"},{name:ResManager.LoadKDString("第三行1","099002000000073"),value:"20"},{name:ResManager.LoadKDString("第三行2","099002000000075"),value:"22"},{name:ResManager.LoadKDString("顺序行排列","099002000000076"),value:"100"}],loadConfig:function(e){KDLightAppEditorProxy.superclass.loadConfig.call(this,e),this.titleContainerProxy.setVisible(!1)},variableindexArray:[0,2,10,12,20,22,100,100,100,100,100,100],genSkinColor:function(){this.el.append('<span style="display:none;position:absolute;top:5px;left:25px;line-height:23px;">皮肤颜色:</span>');var e=new Object;e.id="LIGHTAPPSKINCOLOR",e.x=90,e.y=5,e.width=200,e.height=20,e["z-index"]=2,e.xtype="kdpopupcolor",e.isfield=!1,e.visible=!1,e.showdefaultbutton=!0,e.showmorecolorbutton=!0,e.shownocolorbutton=!0,e.showborder=!0;var t=this.getControlFactoryProxy().createControl(e);this.el.append(t.getControl()),t.loadConfig(e),t.initComponent();var i=this;return t.onchange=function(e,t){i.skinColorChagne(e,t),this.oldValue=this._value,this._value=t},t},genConfigContainer:function(){var e=$('<div style="position:absolute;top:0px;left:5px;width:100%;"></div>');this.el.append(e),this.VeriableView=this.genVeriableView(e),this.PreviewView=this.genPreviewView(e)},setData:function(e,t){e.noHeader=!0,KDLightAppEditorProxy.superclass.setData.call(this,e,t),$(".HeaderLabel",this.el).text(e.header),$(".grouptitleleft",this.el).text(e.grouptitleleft),$(".grouptitleright",this.el).text(e.grouptitleright),$(".linkmantitleleft",this.el).text(e.linkmantitleleft),$(".linkmantitleright",this.el).text(e.linkmantitleright)},replaceHtml:function(e,t,i,a){this.getFormatString(t.header,t.variabletype.value,t.index.value.toString(),a);return e=e.replace("{title"+t.index.value+"}",t.header).replace("{value"+t.index.value+"}",this.getFormatString(t.header,t.variabletype.value,t.index.value.toString(),1)).replace("{1value"+t.index.value+"}",this.getFormatString(t.header,t.variabletype.value,t.index.value.toString(),2)).replace("{2value"+t.index.value+"}",this.getFormatString(t.header,t.variabletype.value,t.index.value.toString(),3)),e=e.replace("{color"+t.index.value+"}",t.forecolor).replace("{1color"+t.index.value+"}",t.forecolor).replace("{2color"+t.index.value+"}",t.forecolor)},getFormatColorString:function(e,t,i){if(KD.IsNullOrWhiteSpace(e)){switch(i.toString()){case"0":case"2":e="#3f3f2f";break;case"10":case"12":case"20":case"22":e="#999999";break;default:e="#2d2b2b"}return e}return e.length>7?"#"+e.substr(3):e},titleChange:function(){},getFormatString:function(e,t,i,a){var n="",o=new Date;switch(o.setDate(o.getDate()-parseInt(a)),t){case"SimpleText":n=e+a;break;case"BaseDataField_Code":n="0"==a?"JC000001":"1"==a?"JC0002121":"2"==a?"JC01245621":"JC54514";break;case"BaseDataField_Name":n=e+a;break;case"Money":n="0"==a?"100.00":"1"==a?"2,531.00":"2"==a?"560.00":"190,845.00";break;case"Count":n="0"==a?"100":"1"==a?"2531":"2"==a?"560":"190845";break;case"Float":n=0==i?"100.00":"1"==i?"2,531.00":"2"==i?"560.00":"190,845.00";break;case"ShortDateTime":n=o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate();break;case"LongDateTime":n=o.toLocaleString();break;default:n=e+i}return"0"!=i&&"1"!=i&&"2"!=i&&(n=e+":"+n),n},genPreviewView:function(e){var t=KD.layout.getActualHeight(e.parent())-40,i=$('<div class="previewViewDiv" style="float:left;width:'+(this.el.width()-440)+"px;height:"+t+'px; border:1px solid #E2E2E2;margin-left:10px;"><div class="previewViewLable" style="background:#F1F1F1;height:25px;padding-left:10px;line-height:25px;"></div><div class="previewViewHeaderLabel" style="height: 40px;text-align:center;line-height:40px;font-size:18px;background:#F1F1F1"><span class="HeaderLabel" style="font-weight:bolder;"></span></div><div class="previewViewHeader" style="height: 40px;background-color:#c94430;line-height:40px;color:white;font-size:18px;"><span class="grouptitleleft" style="float:left;"></span><span class="grouptitleright" style="float:right;padding-right:5px;"></span></div><div class="previewViewHeader" style="display:none;margin-top:1px;height: 40px;background-color:#c94430;line-height:40px;color:white;font-size:18px;"><span class="linkmantitleleft" style="float:left;"></span><span class="linkmantitleright" style="float:right;padding-right:5px;"></span></div><div class="previewViewTable" style="height:'+(t-40-40-40+15)+'px;overflow:auto;"></div></div>');return e.append(i),i},getTableMeta:function(){return'<table class="previewTable" cellspacing="0" cellpadding="0" style="width:100%;font-size:14px;"><tr indexrow="title" style="height:40px;background-color:#F1F1F1;word-break: break-all;"><th style="width:100px">{title0}</th><th align="right" style="padding-right:15px;">{title2}</th></tr><tr indexrow="0"><td style="color:{color0}"><span>{value0}</span></td><td align="right" style="padding-right:15px;color:{color2}"><span>{value2}</span></td></tr><tr indexRow="1"><td colspan="2"><div style="width:315px;overflow:hidden"><span style="color:{color10}">{value10}</span><span style="color:{color12}">{value12}</span></div></td></tr><tr indexRow="2" ><td colspan="2"><div style="width:315px;overflow:hidden"><span style="color:{color20}">{value20}</span><span style="color:{color22}">{value22}</span></div></td></tr><tr indexRow="3"><td colspan="2"><div style="border-bottom:1px solid #E2E2E2;">{value100}</div></td></tr><tr indexRow="4"><td style="color:{1color0}">{1value0}</td><td align="right" style="padding-right:15px;color:{1color2}">{1value2}</td></tr><tr indexRow="5"><td colspan="2"><div style="width:315px;overflow:hidden"><span style="color:{1color10}">{1value10}</span><span style="color:{1color12}">{1value12}</span></div></td></tr><tr indexRow="6"><td colspan="2"><div style="width:315px;overflow:hidden"><span style="color:{1color20}">{1value20}</span><span style="color:{1color22}">{1value22}</span></div></td></tr><tr indexRow="7"><td colspan="2"><div style="border-bottom:1px solid #E2E2E2;">{1value100}</div></td></tr><tr indexRow="8"><td style="color:{2color0}">{2value0}</td><td align="right" style="padding-right:15px;color:{2color2}">{2value2}</td></tr><tr indexRow="9"><td colspan="2"><div style="width:315px;overflow:hidden"><span style="color:{2color10}">{2value10}</span><span align="right" style="color:{2color12}">{2value12}</span></div></td></tr><tr indexRow="10"><td colspan="2"><div style="width:315px;overflow:hidden"><span style="color:{2color20}">{2value20}</span><span align="right" style="color:{2color22}">{2value22}</span></div></td></tr><tr indexRow="11"><td colspan="2"><div style="border-bottom:1px solid #E2E2E2;">{2value100}</div></td></tr></table>'}}),KDControlFactoryProxy.registerType("kdlightapp",KDLightAppEditorProxy),define("KDLightAppEditorProxy",["KDMobilePageEditorProxy","KD"],function(e){return function(){var t;return t||e.KDLightAppEditorProxy}}(this)),KDLayoutEditorProxy=KD.extend(KDPanelProxy,{_items:[],_itemLayouts:[],splitbarSize:4,_selectLayoutIndex:void 0,loadConfig:function(e){KDLayoutEditorProxy.superclass.loadConfig.call(this,e),this._initRootBar()},setData:function(e){this._loadDataConfig(e)},setSelectLayoutIndex:function(e){if(this._selectLayoutIndex!=e&&this._itemLayouts.length>0&&e>-1&&e<this._itemLayouts.length){this._selectLayoutIndex=e;var t=this._itemLayouts[e];this._loadItemsLayout(t)}},_loadDataConfig:function(e){this._items=KD.getValue(e,"items",[]),this._itemLayouts=KD.getValue(e,"layouts",[]),delete this._selectLayoutIndex,this._updateLayoutByIndex(0)},_updateLayoutByIndex:function(e){this.setSelectLayoutIndex(e)},_initRootBar:function(){var e=this,t="<div class='kdLayoutEditorRootBar'>"+ResManager.LoadKDString("宽","0991733000003897")+"：<input class='kdLayoutEditorWidth' value='0'/> "+ResManager.LoadKDString("高","0991733000003898")+"：<input class='kdLayoutEditorHeight' value='0'/> <span class='k-block k-error-colored' style='font-size: 1.2em;margin-left: 50px;'>"+ResManager.LoadKDString("仅仅完成了显示，操作未完成。如需要操作请使用wpf客户端","0991733000003899")+"</span></div>",i=$(t);this._rootBar=i,this.el.append(this._rootBar);var a={step:1,format:"n0",min:0,decimals:0,value:0,change:function(t){e.onRootSizeChange(t)}};this._rootWitdhBtn=$(".kdLayoutEditorWidth",this.el).kendoNumericTextBox(a).data("kendoNumericTextBox"),this._rootHeightBtn=$(".kdLayoutEditorHeight",this.el).kendoNumericTextBox(a).data("kendoNumericTextBox")},onRootSizeChange:function(e){if(void 0!=this._selectLayoutIndex){var t=this._rootWitdhBtn.value(),i=this._rootHeightBtn.value(),a=this._itemLayouts[this._selectLayoutIndex];a.width=t.toString(),a.height=i.toString(),this._loadItemsLayout(a)}},_tempBtnList:"",_proxyDeal:function(e){var t=this.getControlFactoryProxy().createControl(e);this.el.append(t.getControl()),t.setItemsRef(this._items),t.loadConfig(e),t.initComponent()},_loadItemsLayout:function(e){this.firstResize=!0;var t=$("<div editor='root' class='kdEditorLayoutRoot' style='margin-left: auto;margin-right: auto;background-color: rgba(60, 70, 80, 0.10);'></div>"),i=e.tempwidth||e.width,a=e.height||e.tempheight;return t.css({width:parseInt(i)+this.splitbarSize,height:parseInt(a)+this.splitbarSize}),this._rootWitdhBtn.value(i),this._rootHeightBtn.value(a),this._rootInfoDiv?(this._rootInfoDiv.remove(),this.el.append(t),this._rootInfoDiv=t):(this.el.append(t),this._rootInfoDiv=t),!e.children||e.children.length<=0&&"KDLayoutTemplateStyle"==this.getStyleKey()?void this._addCellBtnList(t):(this._loadItemsLayoutCore(e,t,0,i,a),void(this.firstResize=!1))},getPositionId:function(e,t,i){var a=this.baseId+"_level_"+e+"_R_"+t+"_C_"+i;return a},_getSizeKP:function(e,t,i,a){for(var n={heightKP:{},widthKP:{},cKP:{}},o={},r={},s={},l=0;l<e.children.length;l++){var d=e.children[l],c=this.getPositionId(t,d.row,d.col);o[c]=d,r[d.row]={value:d.height||"*"},s[d.col]={value:d.width||"*"};var h=!1;d.tempwidth&&d.tempwidth.indexOf&&d.tempwidth.indexOf("*")>=0&&(h=!0),s[d.col].isFullTag=h}if(1!=e.cols)for(var l in s){var u=s[l].value;if(u.indexOf("*")>=0){var p=0;p=0==l?void 0==s[1]?0:s[1].value:s[0].value,s[l].value=parseInt(i.replace("px",""))-p}else s[l].value=u}if(2==e.rows)for(var l in r){var u=r[l].value;if(u.indexOf("*")>=0){var g=0;g=0==l?void 0==r[1]?0:r[1].value:r[0].value,r[l].value=parseInt(a.replace("px",""))-g,r[l].isFullTag=!0}else r[l].value=u,r[l].isFullTag=!1}return n.cKP=o,n.heightKP=r,n.widthKP=s,n},_addCellBtnList:function(e){var t=this,i=$("<div class='kdLayoutEditorBtnList'></div>");if(e.append(i),"KDLayoutTemplateStyle"==this.getStyleKey()){var a=$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("拆分行","0991733000003900")+"</button>"),n=$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("拆分列","0991733000003901")+"</button>");i.append(a),a.after(n),a.kendoButton({click:function(i){t._onSplittBtnClick.call(t,i,!0,e)}}),n.kendoButton({click:function(i){t._onSplittBtnClick.call(t,i,!1,e)}});$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("删除","0991733000003902")+"</button>"),$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("置为填充","0991733000003903")+"</button>")}else{var o=$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("添加","0991733000003904")+"</button>");$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("删除","0991733000003902")+"</button>"),$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("替换","0991733000003905")+"</button>"),$("<button class='kdLayoutEditorBtn' type='button'>"+ResManager.LoadKDString("设置","0991733000003906")+"</button>");i.append(o)}},_onSplittBtnClick:function(e,t,i){var a=this;a.firstResize=!0;var n=$("<div class='kdEditorLayoutTable' editor='table'></div>"),o=($(e.event.target),0),r=0;if(i.parent().hasClass("kdEditorLayoutCellContent")){i=$(i.parent()),i.children().remove();var s=KD.parseObject(i.attr("cellobject"));r=s.displayWidth,o=s.displayHeight}else i.hasClass("kdEditorLayoutRoot")&&(r=this._rootWitdhBtn.value(),o=this._rootHeightBtn.value());var l=t?2:1,d=t?3:4;i.append(n);var c={displayWidth:r,displayHeight:o,rows:l,cols:d};n.css({height:o,width:r}).attr("tableobject",KD.obj2str(c));var h=$("<div class='kdEditorLayoutRow' editor='row'></div>"),u=$("<div class='kdEditorLayoutRow' editor='row'></div>");n.append(h);var p=$('<div class="kdEditorLayoutRowContent" editor="rowContent"></div>'),g=$('<div class="kdEditorLayoutRowContent" editor="rowContent"></div>');p.appendTo(h);var f={displayWidth:r,rows:l,cols:config.cols,row:1},m={displayWidth:r,rows:l,cols:config.cols,row:2};f.displayHeight=t?o/2:o,m.displayHeight=o/2;var v=$('<div class="kdEditorLayoutCell" editor="cell"></div>'),y=$('<div class="kdEditorLayoutCell" editor="cell"></div>'),b=$('<div class="kdEditorLayoutCellContent" editor="cellContent"></div>'),D=$('<div class="kdEditorLayoutCellContent" editor="cellContent"></div>'),k=$("<div editor='cellSize' class='kdEditorLayoutCellSize'></div>"),C=$("<div editor='cellSize' class='kdEditorLayoutCellSize'></div>"),x={rows:l,cols:d},w={rows:l,cols:d};t?(n.append(u),m.isFullHeight=!0,x.displayWidth=r,w.displayWidth=r,x.displayHeight=o/2,w.displayHeight=o/2,w.isFullHeight=!0,g.appendTo(u).attr("rowobject",KD.obj2str(m)),p.append(v).attr("rowobject",KD.obj2str(f)),b.appendTo(v),g.append(y),D.appendTo(y),n.kendoSplitter({orientation:"vertical",resize:function(e){a.onResize(e)},panes:[{size:o/2-this.splitbarSize+"px",scrollable:!1,resizable:!0},{scrollable:!1,resizable:!0}]})):(p.append(v).css({height:o}).attr("rowobject",KD.obj2str(f)),b.appendTo(v),p.append(y),D.appendTo(y),
x.displayHeight=o,w.displayHeight=o,x.displayWidth=r/2,w.displayWidth=r/2,w.isFullWidth=!0,p.kendoSplitter({orientation:"horizontal",resize:function(e){a.onResize(e)},panes:[{size:r/2-this.splitbarSize+"px",scrollable:!1,resizable:!0},{scrollable:!1,resizable:!0}]})),b.append(k),this._addCellBtnList(k),D.append(C),this._addCellBtnList(C),this.addCellSizeLine(k,x),this.addCellSizeLine(C,w),a.firstResize=!1},onLayoutTemplateChanged:function(){},onLayoutChange:function(){},addCellSizeLine:function(e,t){e.find(".kdEditorLayoutSizeLine:first").parent().remove();var i="<div style='padding-top:30px;'><span class='kdEditorLayoutSizeLine'>"+ResManager.LoadKDString("区域大小 ","0991733000003907")+t.displayWidth+"X"+t.displayHeight;t.isFullWidth?i+="<br/>"+ResManager.LoadKDString("宽度为剩余填充","0991733000003908"):t.isFullHeight&&(i+="<br/>"+ResManager.LoadKDString("高度为剩余填充","0991733000003909")),i+="</span></div>",e.append($(i)),$(e.parent()).attr("cellobject",KD.obj2str(t))},_loadItemsLayoutCore:function(e,t,i,a,n){var o=this;if(e.children&&!(e.children.length<=0)){var r=$("<div class='kdEditorLayoutTable' editor='table'></div>");tbObj={displayWidth:a,displayHeight:n,rows:e.rows,cols:e.cols},t.append(r),r.css({height:n,width:a}).attr("tableobject",KD.obj2str(tbObj));for(var s=this._getSizeKP(e,i,a,n),l=s.cKP,d=s.heightKP,c=s.widthKP,h=[],u="KDLayoutTemplateStyle"==this.getStyleKey()?!0:!1,p=0;p<e.rows;p++){var g=$("<div class='kdEditorLayoutRow' editor='row'></div>");r.append(g);var f=0,m=$('<div class="kdEditorLayoutRowContent" editor="rowContent"></div>'),v={displayWidth:a,rows:e.rows,cols:e.cols,row:p};m.appendTo(g);var y={scrollable:!1,resizable:u};if(1==e.rows)m.css("height",n),y.size=n,v.displayHeight=n;else{var b=void 0==d[p]?0:d[p].value;m.css("height",b-this.splitbarSize+"px"),y.size=b-this.splitbarSize,v.displayHeight=b,v.isFullHeight=0==b?!1:d[p].isFullTag}m.attr("rowobject",KD.obj2str(v)),h.push(y);for(var D=[],k=0;k<e.cols;k++){var C=this.getPositionId(i,p,k),x=l[C];if(x){f++;var w={scrollable:!1,resizable:u},K=$('<div class="kdEditorLayoutCell" editor="cell"></div>');m.append(K);var S=$('<div class="kdEditorLayoutCellContent" editor="cellContent"></div>');S.appendTo(K);var I=1==e.cols?a:c[k].value+"px",P=2==e.rows?d[p].value+"px":n,F=1==e.cols?a:c[k].value-this.splitbarSize+"px",T=P;w.size=F;var _={displayWidth:I.replace("px",""),displayHeight:P.replace("px",""),rows:e.rows,cols:e.cols,row:p,col:k};if((d[p].isFullTag||c[k].isFullTag)&&(1==e.rows?(delete w.size,_.isFullWidth=!0):d[p].isFullTag&&(_.isFullHeight=!0)),x.children&&x.children.length>0)S.attr("cellobject",KD.obj2str(_)),this._loadItemsLayoutCore(x,S,i+1,I,T);else{var A=S;if("KDInfoItem"==x.xtype){var L=this._LoadInfoItem(x);S.append(L),L.css({height:T,width:F}),A=L}var M=$("<div editor='cellSize' class='kdEditorLayoutCellSize'></div>");A.append(M),this._addCellBtnList(M),this.addCellSizeLine(M,_)}D.push(w)}}0==f?m.append($("<div>"+ResManager.LoadKDString("无cell，仅仅存在row","0991733000003910")+"</div>")):f>1&&m.kendoSplitter({orientation:"horizontal",panes:D,resize:function(e){o.onResize(e)}})}e.rows>1&&r.kendoSplitter({orientation:"vertical",panes:h,resize:function(e){o.onResize(e)}})}},firstResize:!1,onResize:function(e){var t=e.sender.element.children(".k-pane"),i=$($(t[0]).find(".kdEditorLayoutCellContent:first"));if(!this.firstResize){var a=$($(t[1]).find(".kdEditorLayoutCellContent:first")),n=KD.parseObject(i.attr("cellobject")),o=KD.parseObject(a.attr("cellobject")),r="vertical"==e.sender.orientation?!0:!1,s=r?$(t[0]).height():$(t[0]).width(),l=parseInt(s)+this.splitbarSize,d=r?parseInt(n.displayHeight)+parseInt(o.displayHeight):parseInt(n.displayWidth)+parseInt(o.displayWidth),c=d-l;r?(n.displayHeight=l,o.displayHeight=c):(n.displayWidth=l,o.displayWidth=c);var h=i.find(".kdEditorLayoutCellSize:first"),u=a.find(".kdEditorLayoutCellSize:first");this.addCellSizeLine(h,n),this.addCellSizeLine(u,o)}},_LoadInfoItem:function(e){for(var t=0;t<this._items.length;t++){var i=this._items[t];if(e.formid==i.id){var a=$("<div class='kdEditorLayoutKDInfoItem' editor='KDInfoItem'></div>");return a.css({"background-image":"url('../"+i.icon+"')","background-size":"100% 100%","background-repeat":"no-repeat"}),a}}return $("<div editor='KDInfoItem'>"+ResManager.LoadKDString("居然没有找到item","0991733000003911")+"</div>")}}),KDControlFactoryProxy.registerType("kdlayouteditor",KDLayoutEditorProxy),define("KDLayoutEditorProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDLayoutEditorProxy}}(this)),KDPivotGridProxy=KD.extend(KDContainerProxy,{loadConfig:function(e){KDPivotGridProxy.superclass.loadConfig.call(this,e),this.dataDetails={}},getKendoCType:function(){return"kendoKDPivotGrid"},createInnerDom:function(){return $(kendo.format('<div id="{0}_pivotgrid" style="">',this.baseId,this.el.width()))},getKendoOptions:function(){var e,t=KD.getValue(this.config,"isNeedShowDollay",!1),i={filterable:!0,height:this.el.height()-2,reorderable:!1,sortable:!1,messages:{measureFields:ResManager.LoadKDString("拖拽统计项到此","0991733000003912"),columnFields:ResManager.LoadKDString("拖拽列组到此","0991733000003913"),rowFields:ResManager.LoadKDString("拖拽行组到此","0991733000003914"),fieldMenu:{info:ResManager.LoadKDString("输入关键字筛选列表项:","0991733000003915"),sortAscending:ResManager.LoadKDString("升序排列","0991733000003916"),sortDescending:ResManager.LoadKDString("降序排列","0991733000003917"),filterFields:ResManager.LoadKDString("内容筛选","0991733000003918"),filter:ResManager.LoadKDString("筛选","0991733000003919"),include:ResManager.LoadKDString("数组筛选","0991733000003920"),title:ResManager.LoadKDString("数组筛选","0991733000003920"),clear:ResManager.LoadKDString("清除","0991733000003921"),ok:ResManager.LoadKDString("确定","0991733000003896"),cancel:ResManager.LoadKDString("取消","0991733000003922"),operators:{contains:ResManager.LoadKDString("包含","0991733000003923"),doesnotcontain:ResManager.LoadKDString("不包含","0991733000003924"),eq:ResManager.LoadKDString("等于","0991733000003925"),neq:ResManager.LoadKDString("不等于","0991733000003926"),isempty:ResManager.LoadKDString("为空","0991733000003927"),isnotempty:ResManager.LoadKDString("不为空","0991733000003928"),endswith:ResManager.LoadKDString("结束于","0991733000003929"),startswith:ResManager.LoadKDString("开始于","0991733000003930")}}}};if(this.dataDetails&&this.dataDetails.columnsName){var a,n,o={},r={},s=[],l=[],d=[];o.fields={},r.dimensions={},r.measures={};for(var c=0;c<this.dataDetails.columnsName.length;c++){if(this.dataDetails.ColumsAndStore&&this.dataDetails.ColumsAndStore.AggregateFields)for(var h=0;h<this.dataDetails.ColumsAndStore.AggregateFields.length;h++){a=this.dataDetails.ColumsAndStore.AggregateFields[h].FieldKey,n=this.dataDetails.ColumsAndStore.AggregateFields[h].Caption,o.fields[a]={type:"number"},r.dimensions[a]={caption:n},e=t?"{0:c}":"{0:n2}",this.dataDetails.ColumsAndStore.AggregateFields[h].format&&(e="{0:"+this.dataDetails.ColumsAndStore.AggregateFields[h].format+"}");var u=n,p=n+ResManager.LoadKDString("（平均）","0991733000003931");r.measures[u]={field:a,caption:n,format:e,aggregate:"sum"},r.measures[p]={field:a,caption:n,format:e,aggregate:"average"},0==c&&(d[h]=u)}if(this.dataDetails.ColumsAndStore&&this.dataDetails.ColumsAndStore.ColumnFields)for(var h=0;h<this.dataDetails.ColumsAndStore.ColumnFields.length;h++)a=this.dataDetails.ColumsAndStore.ColumnFields[h].FieldKey,o.fields[a]={type:"string"},r.dimensions[a]={caption:this.dataDetails.ColumsAndStore.ColumnFields[h].Caption},0==c&&s.push({name:a,caption:this.dataDetails.ColumsAndStore.ColumnFields[h].Caption,expand:0==h});if(this.dataDetails.ColumsAndStore&&this.dataDetails.ColumsAndStore.RowFields)for(var h=0;h<this.dataDetails.ColumsAndStore.RowFields.length;h++)a=this.dataDetails.ColumsAndStore.RowFields[h].FieldKey,o.fields[a]={type:"string"},r.dimensions[a]={caption:this.dataDetails.ColumsAndStore.RowFields[h].Caption},0==c&&l.push({name:a,caption:this.dataDetails.ColumsAndStore.RowFields[h].Caption,expand:0==h})}var g={data:this.data,schema:{},measures:[]};g.schema.model=o,g.schema.cube=r,g.columns=s,g.rows=l,g.measures=d,i.dataSource=g}return i},initComponent:function(){KDPivotGridProxy.superclass.initComponent.call(this),this.el.addClass("kd-pivot-table-extend"),this._bindCellClick()},_loadPage:function(){var e=this;this.pivotgrid=this.component.data("kendoPivotGrid"),this.kendoPivotConfigurator=$(kendo.format('<div id="{0}_kendoPivotConfigurator" style="width: 300px; float:left">',this.baseId)),this.kendoPivotConfiguratorOption={dataSource:e.pivotgrid.dataSource,filterable:!1,height:e.pivotgrid.options.height,messages:e.pivotgrid.options.messages,messages:{measures:e.pivotgrid.options.messages.measureFields,columns:e.pivotgrid.options.messages.columnFields,rows:e.pivotgrid.options.messages.rowFields,measuresLabel:"Measures",columnsLabel:"Columns",rowsLabel:"Rows",fieldsLabel:"Fields"}},this.kendoPivotConfigurator.kendoPivotConfigurator(this.kendoPivotConfiguratorOption),this.el.append(this.kendoPivotConfigurator).append(this.component)},createDyanmicList:function(e,t){if(this.dataDetails.columnsName=e.columns,this.dataUrl=KD.getUrlRoot()+"/"+t,this.dataUrl&&this.dataUrl.length>0){var i='&paramdata=["'+this.getKey()+'",0,2147483647,null]',a=this.dataUrl+i,n=new KDRequest;n.scope=this,n.url=a,n.callback=this.onResponse,n.errCallBack=null,n.callByUrl()}},createColumsAndStore:function(e){this.dataDetails.ColumsAndStore=e;for(var t=!1,i=!1,a=0;a<this.dataDetails.ColumsAndStore.ColumnFields.length;a++)if(this.dataDetails.ColumsAndStore.ColumnFields[0].IsShowTotal){t=!0;break}for(var a=0;a<this.dataDetails.ColumsAndStore.RowFields.length;a++)if(this.dataDetails.ColumsAndStore.RowFields[0].IsShowTotal){i=!0;break}void 0!=e.IsShowGrandTotal&&(i=t=e.IsShowGrandTotal),t?this.el.removeClass("kd-pivot-notShowColToatal"):this.el.addClass("kd-pivot-notShowColToatal"),i?this.el.removeClass("kd-pivot-notShowRowToatal"):this.el.addClass("kd-pivot-notShowRowToatal")},_getCellValue:function(e){var t={},i=[];t.ColumnField=i;var a=[];t.RowField=a;var n=[];t.DataField=n;for(var o,r,s=0;s<e.columnTuple.members.length-1;s++){if(o=null,r=null,e.columnTuple.members[s].hasChildren&&e.columnTuple.members[s].children.length>0){if(0==s)break}else e.columnTuple.members[s].hasChildren?(o=e.columnTuple.members[s].parentName||e.columnTuple.members[s].name.split("&")[0],r=e.columnTuple.members[s].name.split("&")[1]):(o=e.columnTuple.members[s].parentName||e.columnTuple.members[s].name.split("&")[0],r=e.columnTuple.members[s].caption);if(null!=o){var l={};l[o]=r,i.push(l)}}for(var s=0;s<e.rowTuple.members.length;s++){var d={};if(o=null,r=null,e.rowTuple.members[s].hasChildren&&e.rowTuple.members[s].children.length>0){if(0==s)break}else e.rowTuple.members[s].hasChildren?(o=e.rowTuple.members[s].parentName||e.rowTuple.members[s].name.split("&")[0],r=e.rowTuple.members[s].name.split("&")[1]):(o=e.rowTuple.members[s].parentName||e.rowTuple.members[s].name.split("&")[0],r=e.rowTuple.members[s].caption);null!=o&&(d[o]=r,a.push(d))}var c={};return c[this._getMeasureName(e.measure.name)]=e.dataItem.value,n.push(c),t},_getMeasureName:function(e){for(var t=0;t<this.dataDetails.ColumsAndStore.AggregateFields.length;t++)if(this.dataDetails.ColumsAndStore.AggregateFields[t].Caption==e)return this.dataDetails.ColumsAndStore.AggregateFields[t].FieldKey},_onCellClick:function(e,t){var i=this;i.prevClickCellInfo="";var a=i.pivotgrid.cellInfoByElement(e);if(a){var n=i._getCellValue(a);i.prevClickCellInfo!=KD.stringify(n)&&(i.prevClickCell&&i.prevClickCell.length>0&&i.prevClickCell.removeClass("kd-ui-pivotGirdClickCell"),e.addClass("kd-ui-pivotGirdClickCell"),i.getFormProxy().fireCustomEvents(t,"GetPivotGridCellData",KD.stringify(n)),i.prevClickCellInfo=KD.stringify(n),i.prevClickCell=e)}},_bindCellClick:function(){var e=this;e.pivotgrid=this.component.data(this.getKendoCType()),e.pivotgrid.wrapper.off("click",".k-grid-content td").on("click",".k-grid-content td",function(t){var i=$(this);KD.delayInvoke(function(){e._onCellClick(i,"CellClick")},250)}),e.pivotgrid.wrapper.off("dblclick",".k-grid-content td").on("dblclick",".k-grid-content td",function(t){e._onCellClick($(this),"CellDoubleClick")})},_addTips:function(){var e=$('<span style=" display: inline-block;">'+ResManager.LoadKDString("温馨提示：HTML5暂未完美支持该功能，请使用WPF客户端进行相关操作","0991733030034192")+"</span>"),t=this.component.data(this.getKendoCType());t&&t.columnFields&&t.columnFields.append(e)},onResponse:function(e){var t=this;KD.isObject(e)||(e=KD.parseObject(e)),this.data=[];for(var i,a,n=0;n<e.rows.length;n++){i={};for(var o=0;o<this.dataDetails.columnsName.length;o++)a=this.dataDetails.columnsName[o].dataIndex,i[a]=e.rows[n][o];this.data.push(i)}this.dataDetails.columnsName[0]&&(this.sortField=this.dataDetails.columnsName[0].dataIndex,this.data.sort(function(e,i){return parseInt(e[t.sortField])>parseInt(i[t.sortField])?1:-1})),this.component.empty();var r=this.getKendoOptions();this.component[this.getKendoCType()](r),this._bindCellClick(),this._addTips()},"export":function(){KDMessageBox.show({msg:ResManager.LoadKDString("请使用WPF客户端导出。","0991733030034193"),type:KDMessageBox.KDMesBoxType.ok})},printPreview:function(){KDMessageBox.show({msg:ResManager.LoadKDString("请使用WPF客户端预览。","00214298000004257")})},Print:function(){this.print()},print:function(){KDMessageBox.show({msg:ResManager.LoadKDString("请使用WPF客户端打印。","00214298000007763")})}}),KDControlFactoryProxy.registerType("kdpivodgrid",KDPivotGridProxy),define("KDPivotGridProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDPivotGridProxy}}(this)),function(e){var t=window.kendo,i=t.ui,a=i.Widget,n=a.extend({_uid:null,inputEl:null,_text:null,init:function(t,i){var n=this,o=n.options;e.extend(o,i),n._uid=(new Date).getTime()+"_texField",a.fn.init.call(n,t,i),n.input=n.inputEl=e(t),this.inputEl.addClass("k-textbox").attr({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),n.inputEl.id&&""!=n.inputEl.id||(n.inputEl.id=n._uid,n.inputEl.attr("id",n._uid)),n.enable(i.disable),n.editable(i.editable),n.max(i.maxLength),n.min(i.minLength),n.height(i.height),n.inputEl.change(function(e){if(i.change){n.isChanged=!0;var t=n.inputEl.val();n.fireChange.call(n,e,t)}}),n.inputEl.keydown(function(e){n.isChanged=!0,i.keydown&&i.keydown.call(this,e)}),n.inputEl.keyup(function(e){i.keyup&&i.keyup.call(this,e)})},options:{name:"KDTextField",IsInput:!1},fireChange:function(e,t){var i=this;i.isChanged&&(delete i.isChanged,i.options.change&&i.options.change(e,t))},value:function(e){return void 0!=e&&(this._text=e,this.inputEl.val(e)),this.inputEl.val()},max:function(e){e=parseFloat(e),KD.isNaN(e)?this.inputEl.removeAttr("maxlength"):this.inputEl.attr("maxlength",e)},min:function(e){e=parseFloat(e),KD.isNaN(e)?this.inputEl.removeAttr("minlength"):this.inputEl.attr("minlength",e)},editable:function(e){0==e?this.inputEl.attr("readonly",!0):this.inputEl.removeAttr("readonly")},enable:function(e){var t=this,i=t.options,a=void 0!=e?!e:!1;return i.disable=a,void 0!==a?(1==a?t.inputEl.attr("disabled",a):t.inputEl.removeAttr("disabled",a),i.disable):void 0},height:function(e){e=parseInt(e),KD.isNaN(e)||this.inputEl.css({"padding-top":"0em","padding-bottom":"0em"}).height(e)},destroy:function(){var e=this,t=e.input?e.input.val():"";KD.isMobileOS()&&t!=e._text&&(e.isChanged=!0),e.fireChange({},t)}});i.plugin(n)}(jQuery),define("KDTextField",["KD"],function(e){return function(){var t;return t||e.KDTextField}}(this)),KDTextFieldProxy=KD.extend(KDTextEditorProxy,{getKendoCType:function(){return"kendoKDTextField"},getKendoOptions:function(){var e=KDTextFieldProxy.superclass.getKendoOptions.call(this);return e.IsInput=!0,e.isLeaveChange=KD.getValue(this.config,"isFromTreeGrid",!1),e.minLength=KD.getValue(this.config,"minLength",void 0),e.maxLength=KD.getValue(this.config,"maxLength",void 0),this.columnDescriptor&&this.config.height&&(e.height=KD.getValue(this.config,"height",void 0)),e},getGirdEditorOptions:function(){var e={};return e},initComponent:function(){KDTextFieldProxy.superclass.initComponent.call(this)},beforeTreeEditorClose:function(e){var t=this;if(t.columnDescriptor&&this.component&&this.component.data&&this.component.data(this.getKendoCType())&&this.component.data(this.getKendoCType()).value){var i=this.component.data(this.getKendoCType()).value();void 0!=i&&null!=i&&t.columnDescriptor.onchange.call(t.columnDescriptor,e,i,t.rowDataModel)}},setItemContaonerStyle:function(e){KDTextFieldProxy.superclass.setItemContaonerStyle.call(this,e)},editor_DefaultButtonClick:function(){var e=this.getFormProxy();e&&e.fireEvent.call(e,"F7ButtonClick",this.postKey,this.component.data(this.getKendoCType()).value(),this.getRow())},asyncValueToUIText:function(e){this.component.data(this.getKendoCType()).value(e)},setItemContaonerStyle:function(e){this.component&&this.component.css({width:"100%",border:"0px",height:e+"px","line-height":e+"px"})},commitUITextToValue:function(e){return KDTextFieldProxy.superclass.commitUITextToValue.call(this,e)},setMinLength:function(e){this.config.minLength=e;var t=this.component.data(this.getKendoCType());void 0!=e&&t&&t.min&&t.min(e)},setMaxLength:function(e){this.config.maxLength=e;var t=this.component.data(this.getKendoCType());void 0!=e&&t&&t.max&&this.component.data(this.getKendoCType()).max(e)},onkeydown:function(e){var t=this,i=e.keyCode||e.which||e.charCode;if(KDTextFieldProxy.superclass.onkeydown.call(this,e),t.columnDescriptor&&this.component&&this.component.data){var a=t.getValue(),n=this.component.data(this.getKendoCType()).value();a==n||37!=i&&39!=i&&38!=i&&40!=i&&13!=i&&9!=i||t.columnDescriptor.onchange.call(t.columnDescriptor,e,n,t.rowDataModel)}t.config&&t.config.showEditButton&&"119"==i&&t.editor_DefaultButtonClick()},setDisabled:function(e){KDPopupColorProxy.superclass.setDisabled.call(this,e),e?(this.component&&this.component.addClass("k-state-disabled"),this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.find(".kdItemContainer_editorct").addClass("k-state-disabled")):this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.find(".kdItemContainer_editorct").removeClass("k-state-disabled")},setEmptyTip:function(e){$("input",this.el).attr("placeholder",e)},setToolTip:function(e){$("input",this.el).attr("title",e)},setShowEditButton:function(e){this.config.showEditButton!=e&&(this.config.showEditButton=e,KDTextFieldProxy.superclass.initEditButton.call(this,this.config))}}),KDControlFactoryProxy.registerType("textfield",KDTextFieldProxy),KDControlFactoryProxy.registerType("kdscantext",KDTextFieldProxy),KDScantextExtProxy=KD.extend(KDTextFieldProxy,{onkeydown:function(e){if(13==e.keyCode){var t;t=this.isKendo()&&$.isFunction(this.getKendoCType)&&this.getKendoCType()?this.component.data(this.getKendoCType()).value():this.component.val(),t&&t.format&&this.getFormat&&$.isFunction(t.format)&&$.isFunction(this.getFormat)&&(t=t.format(this.getFormat()));var i=this.getFormProxy(),a=new Object;a.value=t,i.fireCustomEvents.call(i,this.postKey,KD.CONST.CustomEventName.KDScanTextChangedCustomEvent,KD.stringify(a)),this.moveToNextFocus(e),this.component.val("")}return!0}}),KDControlFactoryProxy.registerType("kdscantextext",KDScantextExtProxy),KDTextFieldProxy_Galaxy=KD.extend(KDTextFieldProxy,{initComponent:function(){var e=this;KDTextFieldProxy_Galaxy.superclass.initComponent.call(e),e.setMinLength(KD.getValue(e.config,"minLength",void 0)),e.setMaxLength(KD.getValue(e.config,"maxLength",void 0)),$("input",e.el).off("focus").on("focus",function(t){var i=e.component.data(e.getKendoCType()).value();e.updateMinMaxUI.call(e,(i||"").length)}).off("blur").on("blur",function(t){e.hideMinMaxUI.call(e)})},updateMinMaxUI:function(e){if(this.editable&&!this.disabled){void 0==e&&(e=0);var t=this.el.closest(".kg_itemContainer");if(t&&t.length>0){var i=$(".kdItemContainer_MinMax",t);if(i&&i.length>0){var a=this.config.maxLength;void 0!=a?i.text(e+"/"+a).show():i.hide()}}}},hideMinMaxUI:function(){var e=this.el.closest(".kg_itemContainer");if(e&&e.length>0){var t=$(".kdItemContainer_MinMax",e);t&&t.length>0&&t.hide()}},onkeyup:function(e){var t=this.component.data(this.getKendoCType()).value(),i=KDTextFieldProxy_Galaxy.superclass.onkeyup.call(this,e);return this.updateMinMaxUI((t||"").length),i}}),KDControlFactoryProxy.registerType("textfield_Galaxy",KDTextFieldProxy_Galaxy),KDControlFactoryProxy.registerType("kdscantext_Galaxy",KDTextFieldProxy_Galaxy),define("KDTextFieldProxy",["KDTextEditorProxy","KDTextField","KD"],function(e){return function(){var t;return t||e.KDTextFieldProxy}}(this)),KDComboBoxProxy=KD.extend(KDEditorProxy,{isAssistData:!1,assistDataType:"",changeListeners:[],isMulti:!1,listHieght:0,storeing:!1,getKendoCType:function(){return"kendoDropDownList"},getGirdEditorOptions:function(){return""},createBoxControlDom:function(){return $("<input>")},initComponent:function(){this.component=this.createBoxControlDom().appendTo(this.el)[this.getKendoCType()](this.getKendoOptions());var e=this.component.data(this.getKendoCType());if(e.span){var t=this.config.width;this.config.metaWidth!=this.config.width&&0==this.config.width&&(t=this.config.metaWidth),e.span.css({width:t,height:this.el.parent().height()})}$(".k-dropdown",this.el).css({width:t,"border-width":0,"padding-left":0,height:this.el.parent().height()}),$("span",this.el).css({border:"none"}),$(".k-input",this.el).css({"padding-top":"0em",width:this.el.width()-$(".k-select",this.el).width()}),this.setVisible(KD.getValue(this.config,"visible",!0)),this.myStore=KD.getValue(this.config,"store",null),this.comboxpopup=e.popup,this.setStore(this.myStore)},initCellComponent:function(e){if(KDComboBoxProxy.superclass.initCellComponent.call(this,e),this.columnDescriptor){var t=this.component.data(this.getKendoCType());this.comboxpopup=t.popup}},updateStyle:function(e){if(KDComboBoxProxy.superclass.updateStyle.call(this,e),this.component.css({"overflow-y":"hidden"}),this.el.css({overflow:"hidden"}),e){var t=this.component.data(this.getKendoCType());if(t.span){var i=e.width,a=e.height;KD.isEmpty(i)||(t.span.css({width:i}),$(".k-dropdown",this.el).css({width:i})),KD.isEmpty(a)||(t.span.css({height:a}),$(".k-dropdown",this.el).css({height:a}))}}},getKendoOptions:function(){var e=this,t=KDComboBoxProxy.superclass.getKendoOptions.call(this);return $.extend(t,{dataSource:[],autoBind:!0,height:300,animation:KD.isMobileOS()?{}:!1,autowidth:!0,dataTextField:"name",dataValueField:"value",template:'<span title="#: name #" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;">#: name #</span>',select:function(e){e.item&&(e.sender._open=!1,e.item.hasClass("k-state-hover")||KD.isMobileOS()||e.preventDefault())},open:function(t){var i=t.sender.popup;if(i&&i.element){var a=i.element;a&&a.css&&(a.css({width:"auto"}),a.addClass("kd-dropdown-list-container"))}e.checkVisibleOfPopitems.call(e)},close:function(e){}}),t},onchange:function(e,t){var i=this;if(i.isMulti){var a=[];KD.isArray(t)&&($.each(t,function(e,t){KD.isEmpty(t)||a.push(t)}),t=a.join(","))}KDComboBoxProxy.superclass.onchange.call(i,e,t)},commitUITextToValue:function(e){return KDComboBoxProxy.superclass.commitUITextToValue.call(this,e)},checkVisibleOfPopitems:function(){var e=this.getEnumSource(),t=this.component&&this.component.data(this.getKendoCType());if(!KD.isEmpty(e)&&KD.isArray(e)&&t)for(var i=t.ul&&t.ul.find("li"),a=0;a<e.length;a++){var n=e[a],o=void 0!=n.visible?n.visible:!0;o||i&&i.eq(a).css("display","none")}},asyncValueToUIText:function(e){KDComboBoxProxy.superclass.asyncValueToUIText.call(this,e),this.component&&this.component.data(this.getKendoCType()).value(e)},getValue:function(){return this.component.data(this.getKendoCType()).value()},getText:function(){var e="";return e=$.isFunction(this.component.data(this.getKendoCType()).text)?this.component.data(this.getKendoCType()).text():this.component.find(".ui-poplistedit-displayname").text()},setDisabled:function(e){this.disabled=e;var t=this.isKendo();if(this.itemContainer){var i=this.itemContainer.el.find(".kdItemContainer_editorct");e?i.addClass("kdItemContainer_editorct_noBorder"):i.removeClass("kdItemContainer_editorct_noBorder")}var a=this.component.data(t);return t&&a.enable?(e&&a._inputWrapper&&a._inputWrapper.removeClass("k-state-hover"),a.enable(!e)):void 0},setBackColor:function(e){this.el&&this.el.find(".k-dropdown-wrap").css("background-color",e)},setForeColor:function(e){KDComboBoxProxy.superclass.setForeColor.call(this,e);var t=this.getKendoCType(),i=this.component.data(t);this.component&&i&&i.span&&i.span.css("color",e)},setStore:function(e){if(null!=e){this.storeing=!0,this.isInit=!0;var t=this.getEnumSource(e),i=this.getKendoOptions();i.dataSource=t,t&&t.length>=1&&(i.filter="contains"),this.comboxpopup&&this.comboxpopup.destroy&&this.comboxpopup.destroy(),this.component&&(this.component[this.getKendoCType()](i),this.comboxpopup=this.component.data(this.getKendoCType()).popup);var a=this._value,n=t&&t.filter(function(e){return e.value==a?!0:void 0});if(KD.isEmpty(n)&&(this._value=t&&t[0]&&t[0].value||null),this.asyncValueToUIText(this._value),this.storeing=!1,this.isInit=!1,this.component){var o=this.component.data(this.getKendoCType());o&&o.filterInput&&KD.setAsynchronousFilter(o.filterInput)}}},getEnumSource:function(e){if(this.formatStore&&!e)return this.formatStore;var t=!1;this.config.mustinput=KD.isString(this.config.mustinput)?"true"==this.config.mustinput:this.config.mustinput,e&&0==e.Count&&!this.MustInput&&(t=!0);var i=this.formatStore=KDComboBoxProxy.getEnumSource(e,t);return i},loadStore:function(e){this.setStore(e)},release:function(){this.comboxpopup&&this.comboxpopup.destroy&&this.comboxpopup.destroy(),KDComboBoxProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdcombo",KDComboBoxProxy),$.extend(KDComboBoxProxy,{getEnumSource:function(e,t){var i=[];if(e)for(var a=0;a<e.length;a++){var n=e[a],o=KDComboBoxProxy.converItemToText(n[1]),r=KDComboBoxProxy.converItemToText(n[0]),s=n.length>3?"1"==n[3].toString():!0;i.push({alias:o,name:o,value:r,visible:s})}return t&&i.push({alias:"",name:"",value:""}),i},converItemToText:function(e){var t=KD.htmlUtil.encode((e||"").replace(/&/g,"{and}").replace(/>/g,"{a1d}").replace(/</g,"{a2d}")).replace(/{and}/g,"&").replace(/{a1d}/g,">").replace(/{a2d}/g,"<");return t}}),KDComboBoxProxy_Galaxy=KD.extend(KDComboBoxProxy,{initComponent:function(){KDComboBoxProxy_Galaxy.superclass.initComponent.call(this);var e=this.component.data(this.getKendoCType());e.span&&e.span.css({height:this.el.parent().height()-2}),$(".k-dropdown",this.el).css({height:this.el.parent().height()-2})},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.el&&this.el.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight}),$(".k-dropdown",this.el).css({height:this.el.height()-2})},getKendoOptions:function(){var e=this,t=KDComboBoxProxy_Galaxy.superclass.getKendoOptions.call(e);return $.extend(t,{open:function(t){var i=t.sender.popup;if(i){var a=i.element;if(a&&a.css){a.css({width:"auto"});var n=e.getFormTheme()+"-popup";a.addClass(n)}}}}),t},setDisabled:function(e){var t=this;if(KDComboBoxProxy_Galaxy.superclass.setDisabled.call(t,e),this.itemContainer){var i=this.itemContainer.el.find(".kgItemContainer_editorct");e?i.addClass("kgItemContainer_editorct_disable"):i.removeClass("kgItemContainer_editorct_disable")}}}),KDControlFactoryProxy.registerType("kdcombo_Galaxy",KDComboBoxProxy_Galaxy),define("KDComboBoxProxy",["KDTextEditorProxy","KD"],function(e){return function(){var t;return t||e.KDComboBoxProxy}}(this)),function(e,t){function i(t){for(var i=t||".k-animation-container",a=e(i),n=0;n<a.length;n++)0==a[n].children.length&&e(a[n]).remove()}var a=window.kendo,n=a.ui,o=n.Widget,r=a.support,s=(a.caret,a.keys,r.placeholder,e.extend),l=".kendoKDPopListEdit",d="mousedown"+l,c="click"+l,h="keydown"+l,u="keyup"+l,p="focus"+l,g="focusout"+l,f="k-state-focused",m=o.extend({onBeforeCreateChild:function(e,t){},onAfterCreateChild:function(e,t){},onInitContent:function(){},onInitDataListPanel:function(){},onButtonClick:function(e){},onKeyDown:function(e){},onKeyUp:function(e){},onChange:function(e,t){},fireValidate:function(e){var t=this;t.options&&t.options.validate&&t.options.validate(e)},fireChange:function(e,t){var i=this;i.isChanged&&(delete i.isChanged,i.options.change&&i.options.change(e,t))},onLoadOptions:function(e){},onPopOpen:function(e){},onPopClose:function(e){},onFocus:function(e){},onLostFocus:function(e){var t=this,i=t.getInputValue();t.fireChange(e,i)},getInput:function(){return this.input},getDisplayer:function(){return this.displayer},getDefButton:function(){return this.button},getDataList:function(){return this.dataList},init:function(t,i){var n=this;n.ns=l,o.fn.init.call(n,t,i),t=n.element.on(p,e.proxy(n._focusHandler,n));var r=e(this.element).closest("td"),s=i.height;s&&!KD.isNumber(s)&&(s=s.indexOf("em")>0?parseFloat(s)*KD.getCurrentFontsize():parseFloat(s)),n.options.height=s||n.options.height||r.height(),n.options.width=n.options.width||r.width(),n._inputWrapper=e(t).parent(),n.initComponent(t,i),a.notify(n)},initComponent:function(t,i){var a=this;a.containerWrap=e('<span class="k-widget k-header kd-popListEdit-warp" style="display:inline;border:0px;"/>').appendTo(t),a.container=e('<span class="k-dropdown-wrap k-state-default" style="border:0px;">').appendTo(a.containerWrap),a.onBeforeCreateChild(t,i),a.createDefButton(),a.createInput(),a.createDisplayer(),a.onAfterCreateChild(t,i),a.onInitContent(),a._loadOptions(i)},createInput:function(){var t=this,i='<input class="k-input" style="width:100%;padding-bottom:0em;padding-top:0em;">';t.options.isTextArea&&(i='<textarea class="k-input" style="width:100%; overflow-y:auto; ">'),t._focused=t.input=e(i).appendTo(t.container),isNaN(parseInt(t.options.maxLength))||t._focused.attr("maxlength",parseInt(t.options.maxLength));var a=t.options.FontSize?t.options.FontSize:KD.getCurrentFontsize();t.input.css({color:"transparent","font-size":a}).off(h).on(h,e.proxy(t._keydown,t)).off(u).on(u,e.proxy(t._keyup,t)).off(p).on(p,e.proxy(t._inputFocus,t)).off(g).on(g,e.proxy(t._inputFocusout,t)).off("compositionend").on("compositionend",e.proxy(t._keyup,t)).attr({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),t.options.height>0&&t.input.height(t.options.height-2);var n,o=0;t.button&&"none"!=t.button.css("display")&&(o=t.button.width()),t.options.width>0?n=t.options.width-o:e("body").find(t.element).length>0?(n=t.element.width()-o,0>n&&(n=KD.layout.getActualWidth(t.element)-o)):n="100%",t.input.css({width:n})},createDisplayer:function(){var t=this;t.displayer=e('<span class="ui-poplistedit-displayname">').appendTo(t.container).on(c,e.proxy(t._displayerFocus,t));var i=t.input.height();if(i>0&&t.displayer.height(i),t.displayer.css({width:t.input.css("width"),"font-size":t.input.css("font-size")}),"right"==t.options.textAlign&&t.displayer.css({"margin-left":"-0.6em","padding-right":"0.6em"}),t.options.isTextArea)t.displayer.css({"word-break":"break-all","word-warp":"break-word","overflow-y":"auto"});else{var a=t.displayer.height();!KD.isNaN(a)&&a>0?t.displayer.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","line-height":a+"px"}):t.displayer.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"})}},createDefButton:function(){var t=this;t.button=e('<span unselectable="on" class="k-select kd-editor-btn" style="border: none;cursor:pointer;" role="button"><span unselectable="on" class="k-icon '+t.options.buttonCls+'" style="right: 2px; border: none;">select</span></span>').appendTo(t.container),t.options.showButton||t.button.hide().parent().css({"padding-right":0});var i=KD.isMobileOS()?c:d;t.button.on(i,function(e){if(t.isPopup()){if("voucherbosf7field"!=t.options.xtype){
var i=t.popup.data("kendoPopup");return void(i&&i.close())}t.input.focus()}return t.focus.call(t,e),t.options.disabled||t._buttonClick.call(t,e),!1})},options:{name:"KDPopListEdit",autoBind:!0,showButton:!0,needPopup:!0,buttonCls:"k-i-search",btnKeyCode:119,isTextArea:!1,isTrimDisplay:!0,pop:{origin:"bottom left",position:"top left"},changeImm:!1,isFilterEditor:!1,zoomIn:!1,template:""},setOptions:function(e){var t=this;return o.fn.setOptions.call(t,e),t._loadOptions(e),t},destroy:function(){var e=this,t=e.getInputValue();e.fireChange({},t),e.element&&e.element.off(p),e.input&&e.input.off(h).off(u).off(p).off("compositionend").remove(),e.button&&e.button.off(d).remove(),e.dataList&&e.dataList.off(p).remove(),e.popup&&e.popup.off(d).off(c).remove(),e.displayer&&e.displayer.off(c).remove(),i(".k-kdpoplistedit-popclosed"),i(".k-animation-container")},enable:function(e){var t=this;t.options.disabled=!e,e?(t.input.removeAttr("disabled").removeClass("k-state-disabled"),t.container.removeClass("k-state-disabled"),t.options.showButton&&t.button.show().parent().css({"padding-right":""})):(t.input.attr("disabled","disabled").addClass("k-state-disabled"),t.container.addClass("k-state-disabled"),t.options.showButton&&t.button.hide().parent().css({"padding-right":0})),0==t.options.editable?(t.input.attr("readonly","true").addClass("k-state-uneditorable"),t.displayer.addClass("k-state-uneditorable")):(t.input.removeAttr("readonly","true").removeClass("k-state-uneditorable"),t.displayer.removeClass("k-state-uneditorable"))},focus:function(e){var t=this;return t._focusHandler(),t},isPopup:function(){var e=this,t=e.options.needPopup&&e._initPopup()&&e.popup.data("kendoPopup");return t&&t.visible()},openPopup:function(){var e=this;if(!e.isPopup()&&e.popup){var t=e.popup.data("kendoPopup");t&&t.open()}return t&&t.element&&"fullsearch"==t.element.attr("pop-type")&&t.wrapper&&t.wrapper.css("top","38px"),e},closePopup:function(){var e=this;if(e.isPopup()){var t=e.popup.data("kendoPopup");t&&t.close(),e.focus()}return e},value:function(e){return e!=t?this._setInputValue(e):void 0},val:function(e){var i=this;return e===t?i.coreValue():(i._setInputValue(e),i.coreValue(e),i.isFocused?i.showDisplayer(!1):i.showDisplayer(!0,i.displayValue()),i.coreValue())},coreValue:function(e){var i=this;return e!==t&&(this._inputText=e),i._inputText},displayValue:function(){return this.coreValue()},showDisplayer:function(e,i){var a=this,n=KD.isEmpty(a.options.focusedShowDisplayer)?!0:a.options.focusedShowDisplayer;if(e===t||e||0==a.options.editable&&"bosf7field"!=a.options.xtype&&n){a.getInput().css({color:"transparent"});var o=a.getInput().val();KD.isEmpty(o)||a.getInput().css({opacity:0}),0!=a.options.isTrimDisplay&&i&&i.trim&&(i=i.trim()),i=i==t?"":i,a._adjustDisplayerFontFamily(a.getDisplayer(),i),a.getDisplayer().html(KD.convertToHtmlString(KD.htmlUtil.encode(i))).show(),0!=a.options.isNeedAutoTip&&a.getDisplayer().attr("title",i)}else a.getDisplayer().hide(),a.getInput().css({color:"",opacity:1}).show()},updateDisplayer:function(){var e=this,t=e.displayValue();e._adjustDisplayerFontFamily(e.getDisplayer(),t),e.getDisplayer().text(t).attr("title",t)},_adjustDisplayerFontFamily:function(e,t){if(("KDNumberField"==this.options.name||"KDBosF7"==this.options.name)&&e){var i=KD.getFontFamilyByCurrencySymbol(t);e.css({"font-family":i})}},updateInput:function(e){var t=this;t.input.val(e)},getInputValue:function(){var e=this;return e.input.val()},_displayerFocus:function(){this.options.disabled||(this.showDisplayer(!1),this._focusHandler())},_initPopup:function(){var t=this;if(t.popup||!t.options.needPopup)return t.popup;var i=KD.layout.getActualWidth(this.element)>0?KD.layout.getActualWidth(this.element):null,a=(t.options.pop.width||t.options.width||i||300)*(t.options.zoomIn?1.5:1),n=a;if(t.options.pop&&t.options.pop.autoWidth&&(a="auto"),t.popup=e('<div unselectable="on" style="padding:1px;">').css({width:a,"min-width":n}),KD.isGalaxyFormTheme(t.options.FormTheme)){var o=t.options.FormTheme+"-popup";t.popup.addClass(o)}t.popup.appendTo(e("document.body")).hide(),t.options.pop.origin&&t.options.pop.origin.indexOf("right")>=0&&t.popup.css("margin-left","4px"),t.dataList=e('<div unselectable="on">').appendTo(t.popup);var r={anchor:t.options.zoomIn?t.getInput()||t.element:t.element,origin:t.options.pop.origin||"bottom left",position:t.options.pop.position||"top left",collision:t.options.pop.collision||"fit",close:function(e){if("bosf7field"===t.options.xtype||"voucherbosf7field"==t.options.xtype){if(e.sender.element.children(".k-list-container").remove(),e.sender.element.find(".f7grid-pager-more")&&e.sender.element.find(".f7grid-pager-more").removeAttr("disabled").removeClass("f7grid-pager-disabledmore"),"voucherbosf7field"==t.options.xtype)return t.onPopClose&&t.onPopClose.call(t,e),void e.sender.element.children(".k-animation-container").hide();e.sender.element.children(".k-animation-container").remove()}e.sender.element.parent().addClass("k-kdpoplistedit-popclosed").hide(),t.onPopClose&&t.onPopClose.call(t,e)},open:function(e){t.popup.css("font-size",""),e.sender.element.parent().removeClass("k-kdpoplistedit-popclosed"),t.onPopOpen&&t.onPopOpen.call(t,e)},activate:function(e){},deactivate:function(e){}};return t.options.pop&&t.options.pop.animation&&(r.animation=t.options.pop.animation),t.popup.kendoPopup(r).data("kendoPopup"),t.dataList.on(p,function(e){t._focusHandler.call(t)}),t.onInitDataListPanel(),t.popup},_loadOptions:function(e){var t=this;e.value&&t.val(e.value);var i=this.options;this.options=s(i,e,{change:i.change,keydown:i.keydown,keyup:i.keyup}),t.onLoadOptions(e),t.updateDisplayer()},_focusHandler:function(){this.input.focus()},_buttonClick:function(e){var t=this;t.onButtonClick(e),t.options.buttonClick&&t.options.buttonClick(e)},_keydown:function(e){var t=this,i=t.getInputValue();t.onKeyDown(e),t.options.keydown&&t.options.keydown(e),13==e.keyCode&&t.fireChange(e,i),27!=e.keyCode&&13!=e.keyCode||!t.isPopup()||t.closePopup()},_keyup:function(e){var t=this,i=t.getInputValue();if(t.coreValue(i),i!==t._oldText){if(t._change(e,i),e.cancel)return t.updateInput(t._oldText),!1;t._oldText=i}t.onKeyUp(e),t.options.keyup&&t.options.keyup(e),e.keyCode==t.options.btnKeyCode&&t._buttonClick(e)},_setInputValue:function(e){var i=this;i.updateInput(e),(e!=t||null!=e)&&(this._oldText=e)},_change:function(e,t){var i=this;i.onChange(e,t),e.cancel||(i.isChanged=!0,i.options.changeImm&&i.fireChange(e,t))},_inputFocus:function(e){var t=this;t.isFocused=!0,t._inputWrapper.addClass(f),t._zoomIn(!0),t.showDisplayer(!1),t.onFocus(e)},_inputFocusout:function(e){var t=this,i=t.getInputValue(),a=KD.getCurrentBrowsType();"ie"==a.type&&"11.0"==a.ver&&"KDBosF7"==this.options.name&&(i=t._oldText),t.isFocused=!1,t._inputWrapper.removeClass(f),t.showDisplayer(!0,t.displayValue()),t.onLostFocus(e),t.isPopup()&&t.element.blur(),t._zoomIn(!1)},_zoomIn:function(e){var t=this;if(t.options.zoomIn)if(e){var i=t.getInput().closest('td[role="gridcell"]');t.textAlign=i.css("text-align")||"",i.addClass("kd-zoomin-edit").css("text-align",""),t.getInput().addClass("kd-zoomin-edit").css({height:1.1*t.options.height,width:1.5*t.options.width})}else{var i=t.getInput().closest('td[role="gridcell"]');i.removeClass("kd-zoomin-edit").css("text-align",t.textAlign||""),t.getInput().removeClass("kd-zoomin-edit").css({"text-align":"",width:"100%"})}},_refreshDataList:function(){},delayInvoke:function(e,t){var i=setTimeout(function(){try{e&&e()}finally{clearTimeout(i)}},t||5);return i},setHeight:function(e){this.input.height(e),this.displayer.height(e),1!=this.options.isTextArea&&this.displayer.css({"line-height":e+"px"})}});n.plugin(m)}(window.kendo.jQuery),define("KDPopListEdit",["KD"],function(e){return function(){var t;return t||e.KDPopListEdit}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.KDPopListEdit,o=".kendoKDMultiSelectBox",r="click"+o,s=window.kendo.ui.KDPopListEdit.extend({options:{name:"KDMultiSelectBox",autoBind:!0,buttonCls:"k-i-arrow-s",pop:{autoWidth:!0}},isAutoClose:!0,onInitDataListPanel:function(){var t=this,a=this.options&&this.options.controlProxy&&this.options.controlProxy.baseId?this.options.controlProxy.baseId:"",n=KD.IsNullOrWhiteSpace(a)?"":a+"_dataListdiv",o=t.dataList.attr("id");KD.IsNullOrWhiteSpace(o)&&t.dataList.attr("id",n),t.popup?t.popup.addClass("kd-mutiselectbox-list-container"):t.dataList.addClass("kd-mutiselectbox-list-container"),t.dataList.append(e('<div class="kd-list-search-container" style="height: 30px;display:none;"></div>')),t.dataView=e('<ul unselectable="on" style="max-height:330px;overflow-y:auto;" class="k-list k-reset" tabindex="-1">').appendTo(t.dataList),t.btnList=e(KD.format("<div class='kd-multiSelectBtnList'><div class='kd-multiSelectOK kd-link k-button btn-gray btn KDButton kd-button-letterspacing'>{0}</div><div class='kd-multiSelectCancel kd-link k-button btn-gray btn KDButton kd-button-letterspacing'>{1}</div></div>",ResManager.LoadKDString("确定","099002000000004"),ResManager.LoadKDString("取消","0991733000003922"))).appendTo(t.dataList),t.dataView.append(i.format('<li class="k-item k-itemAll" ><input id="{0}" onclick="return false;"  class="k-checkbox k-checkboxAll" type="checkbox" /><button type="" class="k-checkbox-label k-checkbox-Alllabel k-checkbox-button" for="{0}">'+ResManager.LoadKDString("全部","099002000000017")+"</button></li>",KD.Guid.NewGuid().ToString()+"_all")),t.dataView.removeClass("k-widget"),t.getInput().width(0),KD.isMacOS()&&t.dataView.find(".k-checkbox-button").css("float","none"),t.setSearchControl(t.options.filter),t.dataView.find(".k-checkbox-Alllabel").off("click").on("click",function(i){var a=e("input[type='checkbox']",e(i.target).parent()),n=!a.is(":checked"),o=t.dataView.find("input[type='checkbox']");o.each(function(){this.checked=n})}),e(".kd-multiSelectOK",t.btnList).off("click").on("click",function(e){t.isAutoClose=!1;var i=t._getValue(!0);i!=t.oldValueStr&&(t._setText(),t.handlerChangeValue()),t.closePopup(),t.isAutoClose=!0}),e(".kd-multiSelectCancel",t.btnList).off("click").on("click",function(e){t.isAutoClose=!1;var i=t._getValue(!0);i!=t.oldValueStr&&(t.value(t.oldValue),t._setText()),t.closePopup(),t.isAutoClose=!0})},onPopClose:function(e){if(this.isAutoClose){var t=this._getValue(!0);t!=this.oldValueStr&&(this.value(this.oldValue),this._setText())}},init:function(t,i){var a=this;n.fn.init.call(a,t,i),t=a.element.on(r,e.proxy(a._ClickHandler,a)),a.options.height>0&&a.displayer.css("line-height",a.options.height-4+"px")},oldValue:[],_ClickHandler:function(e){if(this.editable){var t=this;t.openPopup()}},syncAllHeadValue:function(){var t=this.dataView.find("input[type='checkbox']");if(t.length<=1)return void(e(".k-checkboxAll",this.dataView)[0].checked=!1);e(".k-checkboxAll",this.dataView)[0].checked=!0;for(var i=0;i<t.length;i++){var a=e(t[i]);if(!a.hasClass("k-checkboxAll")&&!a[0].checked){e(".k-checkboxAll",this.dataView)[0].checked=!1;break}}},handlerChangeValue:function(){var e=this._getValue(!1);this.oldValue=e,this.oldValueStr=this._getValue(!0),this.options.change.call(this,this,e)},_keyup:function(){},_keydown:function(){},enable:function(e){this.editable=e},setDataSource:function(t){var a=this;a.onLoadOptions(a.options),a._initPopup();for(var n=e(".k-item",a.dataView),o=0;o<n.length;o++){var r=e(n[o]);r.hasClass("k-itemAll")||r.remove()}var s="";KD.isMacOS()&&(s=" float:none;");for(var o=0;o<t.length;o++){var l=t[o];if(l.visible){var d=i.format('<li class="k-item" dataItemId="{2}"><input id="{0}" class="k-checkbox k-checkboxItem" onclick="return false;" name="{1}" value="{2}"  type="checkbox" /><button type="button" for="{0}" style="word-break:keep-all;white-space:nowrap;text-overflow:ellipsis;{3}"  class="k-checkbox-label k-checkbox-button" title="{1}" value="{2}">{1}</button></li>',KD.Guid.NewGuid().ToString()+this.options.dataValueField,KD.htmlUtil.encode(l[this.options.dataTextField])||"&nbsp",l[this.options.dataValueField],s);a.dataView.append(d)}}a.popup.css({"max-height":"360px",overflow:"auto"}),a.dataView.find(".k-checkbox-label").bind("click",function(t){var i=e("input[type='checkbox']",e(t.target).parent());if(!i.hasClass("k-checkboxAll")){var n=!i.is(":checked");i[0].checked=n,a.syncAllHeadValue()}})},setSearchControl:function(t){var i=this,a=this.dataList.find(".kd-list-search-container");if(t){if(!i.searchControlProxy){i.searchControlProxy=e('<span class="k-list-filter"><input class="k-textbox" tabindex="0" aria-disabled="false" style="display: inline-block;"><span class="k-icon k-i-search"></span></span>'),a.append(i.searchControlProxy);var n=parseFloat(i.dataView.css("max-height"));n=KD.isNaN(n)?330:n,i.dataView.css({"max-height":n-30}),i.searchControlProxy.find("input.k-textbox").on("keyup",function(t){i._filter.call(i,e(this).val())})}a.show()}else a.hide()},_filter:function(e){var t=this;if(t.options&&t.options.controlProxy)for(var i=t.options.controlProxy.formatStore,a=t.options.dataTextField||"name",n=t.options.dataValueField||"value",o=t.dataView.find("li.k-item"),r=0;r<i.length;r++){var s=i[r],l=s[a]||"",d=t._getItemByServerId(s[n],o);d.hasClass("k-itemAll")||(l.indexOf(e)>=0?d.show():d.hide())}},_getItemByServerId:function(t,i){for(var a,n,o=i||this.dataView.find("li.k-item"),r=0;r<o.length;r++)if(n=e(o[r]),n.attr("dataItemId")==t){a=o[r];break}return e(a)},showDisplayer:function(e,i){var a=this;a.getInput().width(0),e===t||e?a.getDisplayer().text(i).show().attr("title",i):a.getDisplayer().show()},_setText:function(){var t=this,i=t.dataView.find(":checked").map(function(){return e(this).siblings("button").text()}).toArray(),a=i.toString().replace(/,/g,", ").replace(ResManager.LoadKDString("全部, ","0025710030034187"),"");a==ResManager.LoadKDString("全部","0025710030033446")&&(a=""),t.getDisplayer().text(a).attr("title",a)},_getValue:function(t){var i=this,a=i.dataView.find(":checked:not(.k-checkboxAll)").map(function(){return e(this).val()}).toArray();return t?a.toString().replace(/,/g,","):a},value:function(i){var a=this;if(a.dataView!=t){if(i===t)return a._getValue(!1);var n=a.dataView.find("input[type='checkbox']");if(i.length>=0&&n.length>0){var o=e(i).map(function(){return this+""}).toArray();n.each(function(){e(this).hasClass("k-checkboxAll")||(this.checked=-1!==e.inArray(this.value,o))}),a._setText(),a.oldValue=a._getValue(!1),a.oldValueStr=a._getValue(!0),a.syncAllHeadValue()}}}});window.kendo.ui.plugin(s)}(window.kendo.jQuery),define("KDMultiSelectBox",["KDPopListEdit"],function(e){return function(){var t;return t||e.KDMultiSelectBox}}(this)),KDMultiComboBoxProxy=KD.extend(KDComboBoxProxy,{isMulti:!0,getKendoCType:function(){return"kendoKDMultiSelectBox"},createControl:function(e){e.xtype="kdmulticombo",KDMultiComboBoxProxy.superclass.createControl.call(this,e)},getKendoOptions:function(){var e=KDMultiComboBoxProxy.superclass.getKendoOptions.call(this);return e.autoClose=!0,delete e.height,e.valueTemplate='<span title="#: alias #" class="toolTip"> #: alias #</span>',e.controlProxy=this,e.filter=!0,e},createBoxControlDom:function(){return $("<div></div>")},setStore:function(e){if(null!=e){this.storeing=!0,this.isInit=!0;var t=this.component.data(this.getKendoCType());t.setDataSource(this.getEnumSource(e)),this.asyncValueToUIText(this._value),this.storeing=!1,this.isInit=!1}},asyncValueToUIText:function(e){!e||"string"!=typeof e&&"number"!=typeof e?this.component.data(this.getKendoCType()).value(e):(e=e.toString(),this.component.data(this.getKendoCType()).value(e.split(",")))},setDisabled:function(e){KDMultiComboBoxProxy.superclass.setDisabled.call(this,e),e?(this.component.find(".k-dropdown-wrap").addClass("k-state-disabled"),this.component.find(".k-input").addClass("k-state-disabled")):(this.component.find(".k-dropdown-wrap").removeClass("k-state-disabled"),this.component.find(".k-input").removeClass("k-state-disabled"))},setSearchControlVisible:function(e){if(!KD.isEmpty(e)&&this.component){var t=this.component.data(this.getKendoCType());t.setSearchControl.call(t,e)}},updateStyle:function(e){if(KDMultiComboBoxProxy.superclass.updateStyle.call(this,e),e){var t=this.component.data(this.getKendoCType());if(t.displayer&&t.container){var i=t.button?t.button.width():0,a=parseInt(e.width-i),n=e.height;KD.isEmpty(a)||(t.displayer.css({width:a}),t.container.css({width:a}),t.popup&&t.popup.css({"min-width":e.width,width:"auto"})),KD.isEmpty(n)||(t.displayer.css({height:n}),t.container.css({height:n}))}}},setForeColor:function(e){KDMultiComboBoxProxy.superclass.setForeColor.call(this,e),this.component&&this.component.find(".k-dropdown-wrap").css("color",e)}}),KDControlFactoryProxy.registerType("kdmulticombo",KDMultiComboBoxProxy),define("KDMultiComboBoxProxy",["KDComboBoxProxy","KDMultiSelectBox","KD"],function(e){return function(){var t;return t||e.KDMultiComboBoxProxy}}(this)),KDEditComboBoxProxy=KD.extend(KDTextFieldProxy,{enableDefaultButtonClick:!1,disableDropdownListPopup:!1,isOpenEventVoucher:!1,getKendoCType:function(){return"kendoComboBox"},getKendoOptions:function(){var e=this,t=KDComboBoxProxy.superclass.getKendoOptions.call(this);return $.extend(t,{dataSource:[],height:300,autoBind:!0,dataTextField:"name",dataValueField:"value",filter:"contains",open:function(t){e.disableDropdownListPopup&&t.preventDefault();var i=t.sender&&t.sender.popup;if(i&&i.element){var a=i.element;a&&a.addClass&&a.addClass("kd-dropdown-list-container")}},change:function(t,i){var i=this.value();return e.isMulti&&(i=i.join(",")),e.onfilterchange&&null!=e.onfilterchange?(e.onfilterchange(event,i),void(e._value=i)):void(e.columnDescriptor?e.columnDescriptor.onchange.call(e.columnDescriptor,t,i,e.rowDataModel):e.onchange.call(e,t,i))},filtering:function(t){var i=t.filter&&t.filter.value,a=e.getFormProxy(),n=e.getRow();if(e.isOpenEventVoucher&&a){var o={row:n,value:i};".."==i?a&&a.fireCustomEvents.call(a,e.postKey,"VoucherEditCombo.CopyLastRow",KD.stringify(o)):"//"==i&&a&&a.fireCustomEvents.call(a,e.postKey,"VoucherEditCombo.CopyFirstRow",KD.stringify(o))}if(e.serviceDataMethodName&&e.serviceDataServiceName){var r=t.sender?t.sender.text():i;e.getDynamicStore.call(e,r)}var s=window.event&&window.event.target;s&&$(s).hasClass("k-i-close")&&this.close()}}),t},getDynamicStore:function(e){var t=this;t.searchValue=e,clearTimeout(this.timeoutId),t.timeoutId=setTimeout(function(){try{if(void 0!==t.oldSearchValue&&(t.searchValue||"")==t.oldSearchValue)return;t.oldSearchValue=t.searchValue,t.serviceDataMethodName&&t.serviceDataServiceName&&t.getDynamicStoreCore.call(t,t.searchValue)}catch(e){KD.writeError(e)}},200)},getDynamicStoreCore:function(e){var t=e;this.searchValue=t;var i=new KDRequest;this.formProxy||this.getFormProxy();i.serviceName=this.serviceDataServiceName,i.methodName=this.serviceDataMethodName,i.scope=this,i.callback=this._onResponse,i.errcallback=function(e){};var a=new KDServiceClient;a.executeService.call(a,i,t)},_onResponse:function(e){var t=KD.isString(e)?KD.parseObject(e):e,i=t&&t.store;i=i||null,this.setStore(i,!1)},createControl:function(e){KDEditComboBoxProxy.superclass.createControl.call(this,e),this.enableDefaultButtonClick=KD.getValue(e,"enableDefaultButtonClick",!1),this.disableDropdownListPopup=KD.getValue(e,"disableDropdownListPopup",!1),this.isOpenEventVoucher=KD.getValue(e,"isOpenEventVoucher",!1),this.serviceDataMethodName=KD.getValue(e,"methodName",""),this.serviceDataServiceName=KD.getValue(e,"serviceName","")},initComponent:function(){this.component=$("<input>").appendTo(this.el).kendoComboBox(this.getKendoOptions()),this.setVisible(KD.getValue(this.config,"visible",!0)),$(".k-combobox",this.el).css({width:this.config.width,border:"none",height:this.el.parent().height()}),$(".k-input",this.el).css({height:this.el.parent().height()}),$(".k-select",this.el).css({top:this.el.parent().height()-21+"px"}),$(".k-i-close",this.el).css({"margin-top":"-2px",right:"1.9em"}),$(".k-dropdown-wrap",this.el).css({border:"none"}),this.myStore=KD.getValue(this.config,"store",null),this.setStore(this.myStore)},editor_DefaultButtonClick:function(){if(this.enableDefaultButtonClick){var e=this.getFormProxy(),t=this.getKendoControl();if(t){t._inputFocusout();var i=t.value();e&&e.fireEvent.call(e,"F7ButtonClick",this.postKey,i,this.getRow())}}},_updateEditorButtonStyle:function(){var e=this,t=e.getKendoControl();if(t){var i=t.wrapper;i&&(e.columnDescriptor&&i.find(".k-dropdown-wrap").css({"padding-bottom":"0px"}),e.enableDefaultButtonClick&&(i.find(".k-dropdown-wrap").css({"background-color":"transparent"}),i.find(".k-select .k-icon").removeClass("k-i-arrow-s").addClass("k-i-search"),i.find(".k-select").off("click").on("click",function(t){e.editor_DefaultButtonClick(t)})))}},initCellComponent:function(e){KDComboBoxProxy.superclass.initCellComponent.call(this,e),this._updateEditorButtonStyle()},getKendoControl:function(){var e=null;return this.component&&(e=this.component.data(this.getKendoCType())),e},isPopup:function(e){var t=!1;if((38==e||40==e)&&this.component){var i=this.getKendoControl();i&&i.popup&&i.popup.wrapper&&(t=i.popup.wrapper.is(":visible"))}return t},setStore:function(e,t){if(null!=e){this.storeing=!0,this.isInit=!0;var i=new kendo.data.DataSource({data:this.getEnumSource(e)}),a=this.getKendoControl();a&&(a.setDataSource(i),0==t?a.listView&&a.listView.options&&(a.listView.options.skipUpdateOnBind=!0):this.asyncValueToUIText(this._value)),this.storeing=!1,this.isInit=!1}},loadStore:function(e){this.setStore(e)},setIsTextEditable:function(){this.config.isTextEditable=val,this.component.data(this.getKendoCType()).readonly(val)},setIsOpen:function(e){e?this.component.data(this.getKendoCType()).open():this.component.data(this.getKendoCType()).close()},getEnumSource:function(e){var t=[];if(e)for(var i=0;i<e.length;i++){var a=this.GetItemName(e[i]);t.push({name:a,value:a})}return t},GetItemName:function(e){var t="";if(KD.isArray(e)){var i=e.length;i>2?i=1:i-=1,t=i>=0?e[i]+"":""}else t=e+"";return t=KD.isEmpty(t)?" ":t}}),KDControlFactoryProxy.registerType("kdeditcombo",KDEditComboBoxProxy),KDEditComboBoxProxy_Galaxy=KD.extend(KDEditComboBoxProxy,{initComponent:function(){KDEditComboBoxProxy_Galaxy.superclass.initComponent.call(this);var e=this.component.data(this.getKendoCType());e.span&&e.span.css({height:this.el.parent().height()-2}),$(".k-dropdown",this.el).css({height:this.el.parent().height()-2})},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.el&&this.el.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight}),$(".k-combobox",this.el).css({height:this.el.height()-2}),$(".k-dropdown-wrap",this.el).css({height:this.el.height()-2})}}),KDControlFactoryProxy.registerType("kdeditcombo_Galaxy",KDEditComboBoxProxy_Galaxy),define("KDEditComboBoxProxy",["KDTextFieldProxy","KDComboBoxProxy","KD"],function(e){return function(){var t;return t||e.KDEditComboBoxProxy}}(this)),KDComboBoxProxy_NLP_Search=KD.extend(KDComboBoxProxy,{loadConfig:function(e){var t=this;KDComboBoxProxy_NLP_Search.superclass.loadConfig.call(t,e),t.fireUpdate=!0},initComponent:function(){var e=this;KDComboBoxProxy_NLP_Search.superclass.initComponent.call(e),e.el.addClass("kd-nlp-search-combo"),e.checkEl=$('<img style="width:16px;height:16px" src="data:image/svg+xml;base64,PHN2ZyB0PSIxNTkwODIxODgxNDY4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI1NzciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj4NCiAgICA8cGF0aCBkPSJNODIyLjQ2NCAyNjUuMzQ0YTI4LjI1NiAyOC4yNTYgMCAwIDAtNDMuMDcyIDEuMzEybC0zNTIuOTYgNDE3LjY2NC0xODEuOTItMjEyLjk5MmEyOC4yODggMjguMjg4IDAgMCAwLTQzLjEwNC0xLjA4OCAzNy4xMiAzNy4xMiAwIDAgMC0wLjk2IDQ4LjI1NmwyMDQuMDk2IDIzOC45NDRjNS43NiA2Ljc1MiAxMy42OTYgMTAuNTYgMjIuMDE2IDEwLjU2aDAuMDk2YTI5LjA4OCAyOS4wODggMCAwIDAgMjIuMDQ4LTEwLjY1Nkw4MjMuNjggMzEzLjZjMTEuNTItMTMuNzI4IDExLjAwOC0zNS4zMjgtMS4yMTYtNDguMjU2Ig0KICAgICAgICAgIHAtaWQ9IjI1NzgiIGZpbGw9IiM1NTgyRjMiPjwvcGF0aD4NCjwvc3ZnPg0K" alt="hook">')},getKendoOptions:function(){var e=this,t=KDComboBoxProxy_NLP_Search.superclass.getKendoOptions.call(e),i=e.config.labelWidth||0;return $.extend(t,{template:'<span title="#: name #" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;">#: name #</span>',open:function(t){var a=t.sender.popup;if(a&&a.element){var n=a.element;n&&n.addClass("kd-nlp-search-combo-poppanel"),n&&n.css&&n.css({left:-2-i,width:230+i,"max-height":350,"border-radius":4,"background-color":"white","overflow-y":"auto",padding:"10px 0","list-style":"none","box-shadow":"0 0 6px 0 rgba(0, 0, 0, 0.3)"}),e.checkEl.remove(),e.checkEl.insertBefore($(".k-state-selected span",n))}}}),t},setStore:function(e){var t=this;if(null!=e){t.storeing=!0,t.isInit=!0;var i=t.getEnumSource(e);KD.isArray(i)&&"null"==(i[0].name||"null")&&i.splice(0,1);var a=t.getKendoOptions();a.dataSource=i,t.comboxpopup&&t.comboxpopup.destroy&&t.comboxpopup.destroy(),t.component&&(t.component[t.getKendoCType()](a),t.comboxpopup=t.component.data(t.getKendoCType()).popup);var n=t._value,o=i&&i.filter(function(e){return e.value==n?!0:void 0});KD.isEmpty(o)&&(t._value=i&&i[0]&&i[0].value||null),t.asyncValueToUIText(t._value),t.storeing=!1,t.isInit=!1}},setItemContaonerStyle:function(e){var t=this;KDComboBoxProxy_NLP_Search.superclass.setItemContaonerStyle.call(t,e)},updateStyle:function(e){var t=this;KDComboBoxProxy_NLP_Search.superclass.updateStyle.call(t,e),$(".k-widget, .k-dropdown, .k-header",t.el).css({width:"auto"}),$("span .k-input",t.el).css({width:"auto","margin-right":"0.5em","padding-top":"0.5em","padding-left":"1.5em","padding-right":"0.8em"})}}),KDControlFactoryProxy.registerType("kdcombo_nlp_search",KDComboBoxProxy_NLP_Search),define("KDComboBoxProxy_NLP_Search",["KDComboBoxProxy"],function(e){return function(){var t;return t||e.KDComboBoxProxy_NLP_Search}}(this)),KDHtmlEditorProxy=KD.extend(KDEditorProxy,{getKendoCType:function(){return"kendoEditor"},createInnerDom:function(){return $("<textarea></textarea>")},asyncValueToUIText:function(e){KDHtmlEditorProxy.superclass.asyncValueToUIText.call(this,e),e=KD.htmlUtil.decode(e),this.component&&this.component.data(this.getKendoCType()).value(e)},onchange:function(e,t){this.isGridEditor()||(t=this.component.data(this.getKendoCType()).encodedValue(),this.commitValueToForm(t))},getKendoOptions:function(){var e=KDHtmlEditorProxy.superclass.getKendoOptions.call(this);return $.extend(e,{resizable:{content:!0,toolbar:!0}}),e}}),KDControlFactoryProxy.registerType("kdhtmleditor",KDHtmlEditorProxy),define("KDHtmlEditorProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDHtmlEditorProxy}}(this)),KDBOSF7Proxy=KD.extend(KDEditorProxy,{_lookuploadoneLimit:5,_isLocatedFirstRow:!1,IsF7CustomField:!1,isSqlFilterSearch:!1,timeoutId:null,setLookuploadoneLimit:function(e){this._lookuploadoneLimit=parseInt(e);var t=ClientAppProxy.Current.getClientUserPaSetting();null!=t&&t.SetAttribute("LookUpDisplayLimit",this._lookuploadoneLimit||5)},getLookuploadoneLimit:function(){var e=ClientAppProxy.Current.getClientUserPaSetting();if(null!=e){var t=e.GetAttribute("LookUpDisplayLimit");null!=t&&(this._lookuploadoneLimit=parseInt(t))}return this._lookuploadoneLimit||5},getKendoCType:function(){return"kendoKDBosF7"},getKendoOptions:function(){var e=this,t=KDBOSF7Proxy.superclass.getKendoOptions.call(this);if($.extend(t,this.config,{lookuplimit:e.getLookuploadoneLimit(),controlProxy:e,change:function(t,i){if(1!=e.isInit){var a=void 0===i?$.isFunction(this.value)&&this.value()||"":i;return e.onfilterchange&&null!=e.onfilterchange?(e._value=a,e.asyncValueToUIText(a),void e.onfilterchange(t,a)):void e.onchange.call(e,t,i)}},lostfocus:function(t){if(e.oldSearchValue=void 0,(null==t.relatedTarget||"f7grid-pager-more"!==t.relatedTarget.className)&&(t.isValueChanged&&e.fireValueByNumber.call(e,t.curentInputValue||""),e.isSqlFilterSearch)){var i=e.parentProxy,a=i&&i.getKendoGrid(),n=a&&a.dataSource&&a.dataSource.data(),o=e.component&&e.component.data(e.getKendoCType()),r=e.getRow();n&&n[r]&&o&&(o.displayValue()!=o.coreValue()?n[r].Value="":n[r].Value=o.coreValue())}},keydown:function(t){e.onkeydown.call(e,t)},keyup:function(t){e.onkeyup.call(e,t)},buttonClick:function(t){e.onButtonClick.call(e,t)},selectItem:function(t){if(e.onfilterchange&&null!=e.onfilterchange){var i=e.component.data(e.getKendoCType()).valData();return void e.onfilterchange(this,i)}if(e.config&&e.config.isForBatchFilter&&e.columnDescriptor){var i=e.component.data(e.getKendoCType()).valData();return void e.columnDescriptor.onchange.call(e.columnDescriptor,null,i,e.rowDataModel)}e.onSelect.call(e,null,t)},moreClick:function(t){e.onMoreClick.call(e,t)},matchTypeChange:function(t,i){e.onMatchTypeChange.call(e,t,i)},setLookupLikeMatchValue:function(t){e.LookupLikeMatchValue=t},pageSizeChange:function(t,i){e.onPageSizeChange.call(e,t,i)},onMatchFieldChange:function(t,i){e.onMatchFieldChange.call(e,t,i)}}),this.columnDescriptor){var i=this.config.IsF7CustomField;this.config.lookup&&(i=this.config.lookup.IsF7CustomField),this.IsF7CustomField=i||!1}return t},setLookup:function(e){this.config.lookup=e,this.IsF7CustomField=e.IsF7CustomField||this.IsF7CustomField;var t=this.component.data(this.getKendoCType());t.setLookup(e)},setAllowAutoList:function(e){this.config.AllowAutoList=e;var t=this.component&&this.component.data(this.getKendoCType());t&&t.setAllowAutoList(e)},setToolTip:function(e){if(KDBOSF7Proxy.superclass.setToolTip.call(this,e),!KD.isEmpty(e)){var t;this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.find&&(t=this.itemContainer.el.find('[role="kdlabel"] [role="kdspanlabel"]')),t.length>0&&t.attr("title",e)}},initComponent:function(){var e=this;e.getBaseId();e.component=e.el[e.getKendoCType()](e.getKendoOptions()),this.rendered=!0;var t=$("input",e.component);t.off("compositionstart").on("compositionstart",function(t){e.compositionObj={starttime:new Date}}).off("compositionend").on("compositionend",function(t){e.compositionObj=void 0,e.getBaseDataList(!1)}),KD.isEmpty(this.EmptyTip)||this.setEmptyTip(this.EmptyTip),e.config.defaultFocus&&e.setDefaultFocus()},onPageSizeChange:function(e,t){this.setLookuploadoneLimit(t),this.getBaseDataList(!1,!0)},onMatchTypeChange:function(e,t){if(KD.isArray(t)){ClientAppProxy.Current.setLookupLikeMatchType(t[1]);var i=ClientAppProxy.Current.getRootForm();i&&i.fireEventNoData.call(i,"CustomEvents",this.postKey,"Kingdee.BOS.LookUpLikeMatchChanged",KD.stringify(t),null)}else ClientAppProxy.Current.setLookupLikeMatchTypeSilent(t);this.getBaseDataList(!1,!0)},onMoreClick:function(e){this.getBaseDataList(!0)},onMatchFieldChange:function(e,t){var i=this,a=i.getFormProxy();a.fireCustomEvents.call(a,i.postKey,"Kingdee.BOS.PartSearchFieldChanged",t),i.getBaseDataList(!1,!0)},onkeyup:function(e){KDBOSF7Proxy.superclass.onkeyup.call(this,e);var t=e.keyCode;if(!KD.keyBoard.isFuncKey(t)){var i=this;KD.IsNullOrWhiteSpace(i.searchValue)&&13==t||i.getBaseDataList(!1)}},setIsF7CustomField:function(e){this.IsF7CustomField=e||this.IsF7CustomField},fireValueByNumber:function(e){var t=1==this.IsF7CustomField?"SetItemValueByField":"SetItemValueByNumber",i=this,a=i.getFormProxy(),n=i.getRow();if(!i.isFiringByNumber){if(void 0!=i.config.isForBatchFilter&&i.config.isForBatchFilter){var o=e;return void(i.columnDescriptor&&i.columnDescriptor.onchange.call(i.columnDescriptor,null,o,i.rowDataModel))}i.isFiringByNumber=!0,KD.delayInvoke(function(){if(i.fireClientNewRow(),a.fireEventNoData.call(a,t,i.postKey,e,n,null),i.onfilterchange&&null!=i.onfilterchange){var o=i.component.data(i.getKendoCType())._value;KD.IsNullOrWhiteSpace(o.name)&&(o.name=e),i.onfilterchange(event,o)}i.isFiringByNumber=!1})}},fireClientNewRow:function(e){if(this.config.isKeyInputCell){var t=this,i=t.getFormProxy();if(!e){this.getCommitData(this._value)}t.config.isKeyInputCell&&i.fireCustomEvents.call(i,t.postKey,"PostDataOnly","")}},
onkeydown:function(e){var t=this;if(13==e.keyCode){var i=e&&e.currentTarget?e.currentTarget.value:void 0;if(void 0!==i&&t.fireValueByNumber(i),this.self&&this.self.panel)return!1}KDBOSF7Proxy.superclass.onkeydown.call(this,e)},onButtonClick:function(e){if(1!=this.disabled){var t=this.getCommitData(this._value),i=this.getFormProxy(),a="";return"object"==typeof t.value?KD.isObjectEmpty(t.value)||null===t.value||(a=t.value&&t.value[1]?t.value[1]||"":t.value.number||""):a=t.value||"",this.config&&this.config.isForBatchFilter?i&&i.fireEvent.call(i,"FilterGridF7ButtonClick",this.config.ownerKey,t.key,a,t.row):(this.fireClientNewRow(!0),i&&i.fireEvent.call(i,"F7ButtonClick",t.key,a,t.row)),!0}},isPopup:function(e){return(38==e||40==e)&&this.component&&this.component.data(this.getKendoCType())?this.component.data(this.getKendoCType()).isPopup():!1},onSelect:function(e,t){if(this._setValidateMessage(t),KD.IsNullOrWhiteSpace(this.ProxyKey)){var i=t,a=this.getFormProxy();this.fireClientNewRow(),a.fireEventNoData.call(a,"SetItemValueByIDFromClient",this.postKey,i.toString(),this.getRow(),null)}},isEmpty:function(){var e=this.getValue();return e=this.getCommitData(e).value,"string"==typeof e?!0:this.isEmptyValue(e)},onchange:function(e,t){this._setValidateMessage(t),this._value=t,this.getBaseDataList(!1)},setValue:function(e){KDBOSF7Proxy.superclass.setValue.call(this,e)},_setValidateMessage:function(e){this.visible&&!this.disabled&&this.mustInput&&(this.isEmptyValue(e)?this.setValidateMessage(ResManager.LoadKDString("此字段是必填项，不能为空！","099002000000025")):this.resetValidateMessage())},getBaseDataList:function(e,t){var i=this;e?i.getBaseDataListCore.call(i,i.searchValue,!0):t?i.getBaseDataListCore.call(i,i.searchValue,!1):(clearTimeout(this.timeoutId),i.timeoutId=setTimeout(function(){try{if(i.compositionObj&&i.compositionObj.starttime&&new Date-i.compositionObj.starttime<1e3)return;if(i.compositionObj=void 0,i.searchValue=$("input",i.component).val(),KD.IsNullOrWhiteSpace(i.searchValue)&&(i.searchValue||"").length>1&&(i.searchValue=" "),void 0!==i.oldSearchValue&&(i.searchValue||"")==i.oldSearchValue&&(!i.isGridEditor()||" "!=i.searchValue))return;i.oldSearchValue=i.searchValue,i.getBaseDataListCore.call(i,i.searchValue,!1)}catch(e){KD.writeError(e)}},200))},getBaseDataListCore:function(e,t){if(0!=this.config.AllowAutoList){var i=$.trim(e);this.searchValue=i;var a=this.LookupLikeMatchValue||ClientAppProxy.Current.getLookupLikeMatchType(),n=KD.stringify({incontent:i,match:a}),o=new KDRequest,r=this.formProxy||this.getFormProxy();o.serviceName=r.server.serviceName,o.url=r.server.url,o.scope=this,o.pageId=r.server.pageId,o.callback=this._onResponse;var s=this.getLookuploadoneLimit();t?(this.ReqMoreClickParamer=!0,this.startLoadDataRow+=s):(this.startLoadDataRow=0,this.ReqMoreClickParamer=!1),this.config&&this.config.isForBatchFilter?o.call("GetFilterLookupList2MoreV2",this.config.ownerKey,this.postKey,n,this.getRow(),this.startLoadDataRow+1,this.startLoadDataRow+s,null):KD.IsNullOrWhiteSpace(this.ProxyKey)?o.call("GetLookupList2More",this.postKey,n,this.getRow(),this.startLoadDataRow+1,this.startLoadDataRow+s):o.call("GetFilterLookupList2More",this.ProxyKey,this.postKey,n,this.getRow(),this.startLoadDataRow+1,this.startLoadDataRow+s)}},_onResponse:function(e){var t=this,i=KD.parseObject(e),a=i.actions||[],n=KD.isArray(i)?i[0]:void 0;if(n&&n.actionname&&a.push(n),a&&a.length){var o=t.getFormProxy();return void o.doActions.call(o,a)}if(i&&i.data&&0!=i.data.length?$("div[class='ui-f7grid-pager'] > span").css("display","none"):$("div[class='ui-f7grid-pager'] > span").css("display","block"),KD.isArray(i)){var r=t.getFormProxy();r&&r.doActions.call(r,i)}else{var s=t.component.data(t.getKendoCType());if(i.limitNumber=this.getLookuploadoneLimit(),i.isMore=t.ReqMoreClickParamer,s&&s.setData(i),this._isLocatedFirstRow&&this.config.AllowAutoList)this._setFocusGridRow(0,s);else if(this.config.AllowAutoList){var l=this.getDataGridRows(this.searchValue,i.data);l>-1&&this._setFocusGridRow(l,s)}}},_setFocusGridRow:function(e,t){if(!KD.isEmpty(t)){e=KD.isEmpty(e)?0:e;var i=t.dataView,a=i.data("kendoGrid"),n=a.tbody.find("tr:eq("+e+")");n&&n.length>0&&(t.keyboardLocal=!0,a.current(n),a.select(n),t.keyboardLocal=!1)}},getDataGridRows:function(e,t){if(!KD.isEmpty(e)&&!KD.isEmpty(t))for(var i=0;i<t.length;i++)if($.inArray(e,t[i])>-1)return i;return-1},getGirdEditorOptions:function(e){var t={};return t},setItemContaonerStyle:function(e){var t=this;KDBOSF7Proxy.superclass.setItemContaonerStyle.call(t,e)},asyncValueToUIText:function(e,t){var i=this,a={name:"",number:""};if("string"==typeof e)a={name:e,number:e};else if($.isArray(e))if(e.length>=2){if(a={name:e[0],number:e[1]},e.length>=3){a.precision=e[2],a.existPrecision=!0,a.precisions=[];for(var n=2;n<e.length;n++)a.precisions.push(e[n])}}else a={name:e[0],number:e[0]};else"object"==typeof e&&(a=e);var o=KD.getCurrentBrowsType(),r="ie"==o.type&&"11.0"==o.ver&&i&&void 0!=i.onfilterchange&&(void 0==t||0==t);i.component&&i.component.data(i.getKendoCType())&&(r?i.component.data(i.getKendoCType()).valData(a):i.component.data(i.getKendoCType()).val(a)),i.oldSearchValue=void 0},loadConfig:function(e){KDBOSF7Proxy.superclass.loadConfig.call(this,e),this.IsF7CustomField=e.IsF7CustomField||!1,this._isLocatedFirstRow=KD.getValue(e,"IsLocatedFirstRow",this._isLocatedFirstRow)},commitValueToForm:function(e){var t=this.getCommitData(e);t&&t.current&&KDBOSF7Proxy.superclass.commitValueToForm.call(this,e)},release:function(){var e=this,t=e.component&&e.component.data(e.getKendoCType());t&&t.destroy(),e.el&&e.el.remove(),e.component&&e.component.remove()},setIsLocatedFirstRow:function(e){this._isLocatedFirstRow=e||!1,this.config&&(this.config.IsLocatedFirstRow=this._isLocatedFirstRow)},setDefaultFocus:function(){var e=this;KD.delayInvoke(function(){var t=e.component&&e.component.data(e.getKendoCType());t&&t.input.focus()},0)},setBackColor:function(e){KDBOSF7Proxy.superclass.setBackColor.call(this,e),this.component&&(this.component.find(":input").css("background-color",e),this.component.find(".k-dropdown-wrap").css("background-color",e))},setForeColor:function(e){KDBOSF7Proxy.superclass.setForeColor.call(this,e),this.component&&this.component.find(".k-dropdown-wrap").css("color",e)},_setPostKey:function(e){this.postKey=e},setIsSqlFilterSearch:function(e){this.isSqlFilterSearch=e}}),KDControlFactoryProxy.registerType("bosf7field",KDBOSF7Proxy),KDBOSF7Proxy_Galaxy=KD.extend(KDBOSF7Proxy,{getKendoOptions:function(){var e=KDBOSF7Proxy_Galaxy.superclass.getKendoOptions.call(this);return e.FontSize=14,e.FormTheme=this.getFormTheme(),e},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.component&&this.component.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight})}}),KDControlFactoryProxy.registerType("bosf7field_Galaxy",KDBOSF7Proxy_Galaxy),KDBOSF7Proxy_Voucher=KD.extend(KDBOSF7Proxy_Galaxy,{popupDefaultHeight:280,popupDefaultWidth:384,popupWidth:void 0,getKendoOptions:function(){var e=KDBOSF7Proxy_Voucher.superclass.getKendoOptions.call(this);return e.animation={close:{duration:0,hide:!0}},e},onkeyup:function(e){var t=e.keyCode;if(13==t){var i=this.searchValue;this.searchValue="",KDBOSF7Proxy_Voucher.superclass.onkeyup.call(this,e),this.searchValue=i}else KDBOSF7Proxy_Voucher.superclass.onkeyup.call(this,e)},_onResponse:function(e){var t=this.component.data(this.getKendoCType());if(t&&t.popup&&(t.dataList.show(),t.dynamicformContainer&&(t.dynamicformContainer.hide(),t.popup))){var i=t.popup.data("kendoPopup");i.wrapper&&i.wrapper.height(this.popupDefaultHeight),KD.isEmpty(this.popupWidth)||(t.popup.width(this.popupWidth),delete this.popupWidth),i._position.call(i)}KDBOSF7Proxy_Voucher.superclass._onResponse.call(this,e)}}),KDControlFactoryProxy.registerType("voucherbosf7field",KDBOSF7Proxy_Voucher),define("KDBosF7Proxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDBosF7Proxy}}(this)),KDFlexFieldProxy=KD.extend(KDTextFieldProxy,{displayNameSpecies:2,dispalySeparator:".",loadConfig:function(e){e.showEditButton=!0,KDFlexFieldProxy.superclass.loadConfig.call(this,e),this.config.namespecies&&(this.displayNameSpecies=this.config.namespecies),this.config.separator&&(this.dispalySeparator=this.config.separator)},setDisplayNameSpecies:function(e){this.displayNameSpecies=e},setSeparator:function(e){this.dispalySeparator=e},editor_DefaultButtonClick:function(){if(!this.disabled){var e=this;e.columnDescriptor?KD.delayInvoke(function(){var t=e.getFormProxy(),i=t.getChangeData(!0);t.fireEvent.call(t,"FlexTriggerClick",e.postKey,e.component.data(e.getKendoCType()).value(),e.getRow(),i)}):e.getFormProxy().fireEvent("FlexTriggerClick",e.postKey,e.component.data(e.getKendoCType()).value(),e.getRow())}},asyncValueToUIText:function(e){"string"==typeof e?this.component.data(this.getKendoCType()).value(e):this.component.data(this.getKendoCType()).value(this.getDisplayValue(e))},setFocus:function(){this.component.focus()},isEmpty:function(){var e=this.component.data(this.getKendoCType()).value(),t=this.isEmptyValue(e);return t&&this.isDataMasking&&this.mustInput&&(t=this.isEmptyMkValue()),t},getDisplayValue:function(e){if(null==e)return"";if(e.Count>0&&null!=e[0]&&"array"!=typeof e[0])return"";var t=[],i="";for(var a in e){var n=e[a];if(!(n.length<5||"0"==n[4])){var o=n[0];if(null!=o){var r=n[3];if("object"==typeof o&&"60523"!=r){var s=o.length>1?o[0]:null;s&&s.length>0&&t.push(s)}else{var l=o;if(null!=r&&l&&l.length>0)if("175"==r)"false"==l.toLowerCase()?t.push(ResManager.LoadKDString("否","099002000000006")):"true"==l.toLowerCase()&&t.push(ResManager.LoadKDString("是","099002000000005"));else if("56"==r||"106"==r)"0"!=l&&t.push(l);else if("60523"==r){var s="";s=2==this.displayNameSpecies?o.length>1?o[0]:null:1==this.displayNameSpecies?o.length>1?o[1]:null:o.length>1?o[1]+"/"+o[0]:null,KD.IsNullOrWhiteSpace(s)||t.push(s)}else{var s="";s=l.replace('"',""),s=$.trim(s),KD.IsNullOrWhiteSpace(s)||t.push(s)}}}}}if(t.length>0)for(var a in t)i+=a==t.length-1?t[a]:t[a]+this.dispalySeparator;return i}}),KDControlFactoryProxy.registerType("kdflextextfield",KDFlexFieldProxy),define("KDFlexFieldProxy",["KDTextFieldProxy","KD"],function(e){return function(){var t;return t||e.KDFlexFieldProxy}}(this)),KDTextFieldProxy_NLPSearch=KD.extend(KDTextFieldProxy,{delayReqMis:300,getDefaultHolderText:function(){return ResManager.LoadKDString("按 ctrl + shift + s， 随时快速唤起智能搜索。","0141072000005415")},loadConfig:function(e){var t=this;KDTextFieldProxy_NLPSearch.superclass.loadConfig.call(t,e),t.fireUpdate=!0},setRelatedProxy:function(e){var t=this;t.relatedProxyInfo=e},updateRelatedProxyState:function(e){var t=this,i=t.relatedProxyInfo||{};if(!KD.isEmpty(i.key)){var a=t.getFormProxy(),n=a.getControlProxy.call(a,i.key);if(n){var o={key:i.key,visible:void 0===e?!0:e};void 0!=i.height&&(o.height=i.height),n.updateState.call(n,o)}}},setDefaultFocus:function(){var e=this,t=e.getFormProxy();t&&(t.defaultFocusProxy=e),e.focus()},setPlaceHodlerTexts:function(e){var t=this;t.holderTexts=e||t.getDebugHolderTexts(),t.holderTexts.push(t.getDefaultHolderText())},getKendoOptions:function(e){var t=this,i=KDTextFieldProxy_NLPSearch.superclass.getKendoOptions.call(t,e);return i.changing=function(e,t){},i},initComponent:function(){var e=this;e.lastUpdateValue="",KDTextFieldProxy_NLPSearch.superclass.initComponent.call(e),e.el.addClass("kd-text-nlp-search"),$("input",e.el).css({width:"100%",height:"100%",border:"0px solid"}),e.setEmptyTip(e.getDefaultHolderText()),e.delInpEl=$('<img class="kd-text-nlp-search-inpdel" style="display:none;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaBAMAAABbZFH9AAAALVBMVEUAAABmmcxahO9Wg/JWgvNWgvJXg/FWgvJWgvJVgvJxlfRyl/SMqveLqvb1+P8ZbyMkAAAAD3RSTlMABR9laIWWq7KzvLzFxvg0lMVQAAAAdElEQVQY02NgoBVgMitPVoBxGD1mzpzZIgDlic4EgUAozxPMmwLV1Tlz5czZM2dAdDLPnP1m5r2VMw3APLaZM8+deTtzZgKYxz5z5tx3N2fOLIDx5rw7CeOBVN55A1PJPHPWW4QpqDag2o7mMlRXo/qIDAAAa4E+CaTxLEQAAAAASUVORK5CYII=" alt="del">'),e.delInpEl.appendTo(e.el).off("click").on("click",function(t){e.asyncValueToUITextCore.call(e,""),e.onkeyup.call(e,t),e.focus.call(e)})},onkeyup:function(e){var t=this,i=(new Date).getTime();t.lastKeyUpTime=i,t.circleReqCheck(),t.updateDisplayDelInpEl(),KDTextFieldProxy_NLPSearch.superclass.onkeyup.call(t,e)},updateDisplayDelInpEl:function(){var e=this;e.__displayDelInpElHandler&&(clearTimeout(e.__displayDelInpElHandler),e.__displayDelInpElHandler=void 0),e.__displayDelInpElHandler=setTimeout(function(e){e.displayDelInpEl.call(e,KD.isImeInputing),KD.isImeInputing&&e.circleImeInputingCheck.call(e,function(e){e.displayDelInpEl.call(e)}),KD.writeLog("updateDisplayDelInpEl ","",!0),clearTimeout(e.__displayDelInpElHandler),e.__displayDelInpElHandler=void 0},500,e)},circleImeInputingCheck:function(e){var t=this;t.__circleImeInputingCheckHandler&&(clearTimeout(t.__circleImeInputingCheckHandler),t.__circleImeInputingCheckHandler=void 0),t.__circleImeInputingCheckHandler=setTimeout(function(t){KD.isImeInputing?t.circleImeInputingCheck.call(t,e):KD.isFunction(e)&&e.call(t,t),clearTimeout(t.__circleImeInputingCheckHandler),t.__circleImeInputingCheckHandler=void 0},700,t)},circleReqCheck:function(){var e=this,t=(new Date).getTime(),i=t-(e.lastKeyUpTime||t);i>e.delayReqMis&&!KD.isImeInputing?e.requestSearch():(e.__circleReqCheckTH&&clearTimeout(e.__circleReqCheckTH),e.__circleReqCheckTH=setTimeout(function(e){e.__circleReqCheckTH&&clearTimeout(e.__circleReqCheckTH),e.circleReqCheck.call(e)},e.delayReqMis/3,e)),e.setRadomHolderText()},setRadomHolderText:function(e){var t=this;KD.isEmpty(t.holderTexts)&&t.setPlaceHodlerTexts(),(!t.setRadomHolderTextRunning||e)&&(t.setRadomHolderTextRunning=!0,KD.delayInvoke(function(e){e.setRadomHolderText.call(e,!0);var t=(new Date).getTime(),i=t-(e.lastHolderTime||0);if(i>3e3){var a=parseInt((Math.random()*(e.holderTexts.length+1)).toString()),n=e.holderTexts[a]||e.getDefaultHolderText();e.setEmptyTip.call(e,n),e.lastHolderTime=t}},2e3,!1,t))},requestSearch:function(){var e=this;e.__circleReqTH&&clearTimeout(e.__circleReqTH),e.__circleReqTH=setTimeout(function(e){e.__circleReqTH&&clearTimeout(e.__circleReqTH);var t=$("input",e.el).val();e.delayReqUpdateValue=!1,t!=e.lastUpdateValue&&e.commitValueToForm.call(e,t)},void 0,e)},displayDelInpEl:function(e){var t=this,i=$("input",t.el).val(),a=!KD.isEmpty(i);a?t.delInpEl.show():t.delInpEl.hide(),e||t.updateRelatedProxyState(a)},asyncValueToUIText:function(e){},setSearchText:function(e){var t=this;KDTextFieldProxy_NLPSearch.superclass.setValue.call(t,e),t.asyncValueToUITextCore.call(t,e),t.lastUpdateValue=e,t.displayDelInpEl()},focus:function(e){var t=this;KD.delayInvoke(function(e){$("input",e.el).focus()},500,!1,t)},asyncValueToUITextCore:function(e){var t=this;KDTextFieldProxy_NLPSearch.superclass.asyncValueToUIText.call(t,e)},commitValueToForm:function(e){var t=this;e!=t.lastUpdateValue&&KDTextFieldProxy_NLPSearch.superclass.commitValueToForm.call(t,e)},commitUITextToValue:function(e){var t=this,i=KDTextFieldProxy_NLPSearch.superclass.commitUITextToValue.call(t,e);return t.lastUpdateValue=i,i},release:function(){var e=this;try{KDTextFieldProxy_NLPSearch.superclass.release.call(e)}catch(t){}},getDebugHolderTexts:function(){var e=[];return e}}),KDControlFactoryProxy.registerType("textfield_nlp_search",KDTextFieldProxy_NLPSearch),define("KDTextFieldProxy_NLPSearch",["KDTextFieldProxy"],function(e){return function(){var t;return t||e.KDTextFieldProxy_NLPSearch}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.Widget,o=n.extend({_uid:null,txtAreaEl:null,_text:null,init:function(t,i){var a=this;a._uid=(new Date).getTime()+"_textarea",n.fn.init.call(this,t,i);var o=1==i.isborder?"":"border:0px;";a.input=a.txtAreaEl=e('<textarea style="height: inherit; width: inherit; '+o+'line-height: 21px; resize: none;padding: 0em 2px;">'),a.txtAreaEl.addClass("k-textbox").attr({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),a.txtAreaEl.id&&""!=a.txtAreaEl.id||(a.txtAreaEl.id=a._uid,a.txtAreaEl.attr("id",a._uid)),a.txtAreaEl.change(function(e){if(i.change){a.isChanged=!0;var t=a.txtAreaEl.val();a.fireChange.call(a,e,t)}}),a.txtAreaEl.keydown(function(e){a.isChanged=!0,i.keydown&&i.keydown.call(this,e)}),a.txtAreaEl.keyup(function(e){i.keyup&&i.keyup.call(this,e)}),e(t).append(a.txtAreaEl)},options:{name:"KDTextArea"},fireChange:function(e,t){var i=this;i.isChanged&&(delete i.isChanged,i.options.change&&i.options.change(e,t))},value:function(e){return e!=t&&(this._text=e,this.txtAreaEl.val(KD.htmlUtil.decode(this._text))),this._text},enable:function(e){return e!=t&&this.txtAreaEl.attr("disabled",!e),!this.txtAreaEl.attr("disabled")},destroy:function(){var e=this,t=e.input?e.input.val():"";e.fireChange({},t),e.txtAreaEl&&e.txtAreaEl.remove(),delete e.txtAreaEl}});a.plugin(o)}(window.kendo.jQuery),define("KDTextArea",["KD"],function(e){return function(){var t;return t||e.KDTextArea}}(this)),KDTextAreaProxy=KD.extend(KDEditorProxy,{FireEnterCustomEvent:!1,getKendoOptions:function(){var e=KDTextAreaProxy.superclass.getKendoOptions.call(this),t=this;return e.isLeaveChange=KD.getValue(this.config,"isFromTreeGrid",!1),e.change=function(e,i){return t.onfilterchange?(t.onfilterchange(e,i),void(t._value=i)):void(t.columnDescriptor?t.columnDescriptor.onchange.call(t.columnDescriptor,e,i,t.rowDataModel):t.onchange.call(t,e,i))},e.isborder=!(void 0==t.columnDescriptor),e},setFireEnterCustomEvent:function(e){this.FireEnterCustomEvent=e},beforeTreeEditorClose:function(e){var t=this;if(t.columnDescriptor&&this.component&&this.component.data&&this.component.data(this.getKendoCType())&&this.component.data(this.getKendoCType()).value){var i=this.component.data(this.getKendoCType()).value();void 0!=i&&null!=i&&t.columnDescriptor.onchange.call(t.columnDescriptor,e,i,t.rowDataModel)}},focus:function(e){this.input&&this.input.focus&&(this.input.focus(),-1==this.focusSelectMode?this.setSelectionStart(this.SelectionStart):0==this.focusSelectMode||(1==this.focusSelectMode?this.setSelectionStart(0,!0):2==this.focusSelectMode||(3==this.focusSelectMode?(this.setSelectionStart(0,!0),this.input.select()):this.input.select())))},setFocusSelectMode:function(e){this.focusSelectMode=e},initComponent:function(){KDTextAreaProxy.superclass.initComponent.call(this);var e=this,t=this.component.find("textarea");e.input=e.input||t,this.el.css({height:"100%"}),this.component.css({width:"100%",height:"100%"}),t.off("blur").on("blur",function(t){e.selectedPos=e._onBlur.call(e,t)}),t.off("keydown").on("keydown",function(t){(!e.fireUpdate||e.FireEnterCustomEvent)&&13==t.keyCode&&e.onchange(t,$(this).val())}),this.setMinLength(KD.getValue(this.config,"minLength",void 0)),this.setMaxLength(KD.getValue(this.config,"maxLength",void 0))},setMinLength:function(e){this.config.minLength=e;var t=this.component.data(this.getKendoCType());if(void 0!=e)if(t&&t.min)this.component.data(this.getKendoCType()).min(e);else{var i=this.el.find("textarea");i.attr("minlength",e)}},setMaxLength:function(e){this.config.maxLength=e;var t=this.component.data(this.getKendoCType());if(void 0!=e)if(t&&t.max)this.component.data(this.getKendoCType()).max(e);else{var i=this.el.find("textarea");i.attr("maxlength",e)}},setDisabled:function(e){if(KDTextAreaProxy.superclass.setDisabled.call(this,e),KD.isIeBrowser()){var t=this.el.find("textarea");e?(t.removeAttr("disabled").attr("readonly",e),!KD.isEmpty(this.EmptyTip)&&KD.isEmpty(this._val)?t.css("color","#8f8f8f"):t.css("color","inherit")):0!=this.editable&&t.removeAttr("readonly")}e?(this.component&&this.component.addClass("k-state-disabled"),this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.find(".kdItemContainer_editorct").addClass("k-state-disabled")):this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.find(".kdItemContainer_editorct").removeClass("k-state-disabled")},setForeColor:function(e){KDTextAreaProxy.superclass.setForeColor.call(this,e),this.el.find("textarea").css("color",e)},setBackColor:function(e){KDTextAreaProxy.superclass.setForeColor.call(this,e),this.el.find("textarea").css("background-color",e)},insertText:function(e){var t=this.component.find("textarea"),i=KDGetCursorPositon.getSelectionIndex($(t)[0]),a=this.getValue();a=a.substring(0,i)+e+a.substring(i),this.setValue(a),KDGetCursorPositon.setSelectionIndex($(t)[0],i+e.length)},backspaceText:function(){var e=this.getValue();if(this.selectedPos.selectedStart==this.selectedPos.selectedEnd){var t=e.lastIndexOf("");e=e.substring(0,t-1)}else e=e.substring(0,this.selectedPos.selectedStart)+e.substring(this.selectedPos.selectedEnd),this.selectedPos.selectedStart=this.selectedPos.selectedEnd=this.getValue().lastIndexOf("");this.setValue(e)},setItemContaonerStyle:function(e){if(this.elHeight||(this.elHeight=(e-2)/KD.getCurrentFontsize()+"em"),this.innerHeight||(this.innerHeight="1.75em"),this.component){var t=this.component.find("textarea"),i="1.416em";this.onfilterchange&&(i=this.component.height()+"px"),t.css({width:"inherit",border:"0px",height:"inherit",margin:"0em","line-height":i,"overflow-y":"auto"})}},_onBlur:function(e){var t=e.target||e.currentTarget||this.component.find("textarea"),i=t.selectionStart,a=t.selectionEnd,n=KDGetCursorPositon.getSelectionIndex($(t)[0]);return this.setSelectionStart(n,!0),{selectedStart:i,selectedEnd:a}},asyncValueToUIText:function(e){null==e&&(e=""),this.component&&this.component.children&&this.component.children(0)&&this.component.children(0).val(e)},onkeydown:function(e){if(!this.fireUpdate||this.FireEnterCustomEvent){if(13==e.keyCode&&!e.altKey){var t=this.component.children(0).val();"promptBox"==this.getCType()&&(t=this.getValue().current?this.getValue().current.number:"");var i=this.getFormProxy(),a=new Object;a.value=t,i.fireCustomEvents.call(i,this.postKey,"EnterKeyPressed",KD.stringify(a)),this.onfilterchange&&(this.onfilterchange(e,t),this._value=t,e.preventDefault())}this.config&&this.config.showEditButton&&"119"==e.keyCode&&this.editor_DefaultButtonClick()}},editor_DefaultButtonClick:function(){var e=this.getFormProxy();e&&e.fireEvent.call(e,"F7ButtonClick",this.postKey,this.component.data(this.getKendoCType()).value(),this.getRow())},commitUITextToValue:function(e){return KDTextAreaProxy.superclass.commitUITextToValue.call(this,e)},onchange:function(e,t){return this.isGridEditor()?void this.columnDescriptor.onchange.call(this.columnDescriptor,e,t,this.rowDataModel):void this.commitValueToForm(t)},getGirdEditorOptions:function(){var e={};return e},createInnerDom:function(){return $("<div></div>")},getKendoCType:function(){return"kendoKDTextArea"},setOnlyDisplayText:function(e){if(this.component.children("textarea").attr("readonly",e&&1==e),this.itemContainer&&this.itemContainer.el){var t=this.itemContainer.el.find(".kdItemContainer_editorct");t.length>0&&(e?t.addClass("kdItemContainer_editorct_noBorder"):t.removeClass("kdItemContainer_editorct_noBorder"))}}}),KDControlFactoryProxy.registerType("kdtextarea",KDTextAreaProxy),KDTextAreaProxy_Galaxy=KD.extend(KDTextAreaProxy,{initComponent:function(){var e=this;KDTextAreaProxy_Galaxy.superclass.initComponent.call(this),$("textarea",this.el).off("focus").on("focus",function(t){var i=e.component.children(0).val();e.updateMinMaxUI.call(e,(i||"").length)}).off("blur").on("blur",function(t){e.hideMinMaxUI.call(e)});var t=this.el.closest(".kgItemContainer_editorct");t&&t.length>0&&this.el.css({height:t.height()})},setItemContaonerStyle:function(e){var t=this;if(KDTextAreaProxy_Galaxy.superclass.setItemContaonerStyle.call(t,e),this.component){var i=this.component.find("textarea");i.css("padding","0px")}},updateMinMaxUI:function(e){if(this.editable&&!this.disabled){void 0==e&&(e=0);var t=this.el.closest(".kg_itemContainer");if(t&&t.length>0){var i=$(".kdItemContainer_MinMax",t);if(i&&i.length>0){var a=this.config.maxLength;void 0!=a?i.text(e+"/"+a).show():i.hide()}}}},hideMinMaxUI:function(){var e=this.el.closest(".kg_itemContainer");if(e&&e.length>0){var t=$(".kdItemContainer_MinMax",e);t&&t.length>0&&t.hide()}},onkeyup:function(e){var t=this.component.children(0).val(),i=KDTextAreaProxy_Galaxy.superclass.onkeyup.call(this,e);return this.updateMinMaxUI((t||"").length),i}}),KDControlFactoryProxy.registerType("kdtextarea_Galaxy",KDTextAreaProxy_Galaxy),define("KDTextAreaProxy",["KDEditorProxy","KDTextArea","KD"],function(e){return function(){var t;return t||e.KDTextAreaProxy}}(this)),KDPasswordFiledProxy=KD.extend(KDEditorProxy,{value:null,editable:!0,disable:!1,isColumnDescript:!0,_ischange:void 0,loadConfig:function(e){KDPasswordFiledProxy.superclass.loadConfig.call(this,e),this.isColumnDescript=!1},initCellComponent:function(e){KDPasswordFiledProxy.superclass.initCellComponent.call(this,e);var t=this;this.getOptions();this.component=$("<input autocomplete='new-password' id='component_"+this.baseId+"' type='password'>"),this.setVisible(KD.getValue(this.config,"visible",!0)),this.component.blur(function(e){t.lostKeyBoardFoucs(e)}),this.component.keydown(function(e){t.keyDown(e)}),this.component.focus(function(e){t.goFoucs(e)}),this.component.addClass("k-textbox"),this.el.append(this.component)},lostKeyBoardFoucs:function(e){this._ischange&&(this.isColumnDescript&&this.columnDescriptor.onchange.call(this.columnDescriptor,e,this.component.val(),this.rowDataModel),this.CommitField())},onkeydown:function(e){return this._ischange=!0,KDPasswordFiledProxy.superclass.onkeydown.call(this,e)},keyDown:function(e){this._ischange=!0;var t=e.keyCode?e.keyCode:e.which;"13"==t&&(this.isColumnDescript&&this.columnDescriptor.onchange.call(this.columnDescriptor,e,this.component.val(),this.rowDataModel),this.CommitField())},setItemContaonerStyle:function(e){KDPasswordFiledProxy.superclass.setItemContaonerStyle.call(this,e),this.component&&this.component.css({height:this.innerHeight,"line-height":this.innerHeight})},getGirdEditorOptions:function(){var e={};return e},goFoucs:function(e){this.component.select()},commintValue:function(){var e=new Object;e.previous=this.value,e.current=this.component.val(),this.commitValueToForm(e),this.value=e.current},asyncValueToUIText:function(e){this.value=e,this.component.val(e)},setDisabled:function(e){KDPasswordFiledProxy.superclass.setDisabled.call(this,e),this.disable!=e&&(this.disable=e,this.component.attr("disabled",e),this.UpdateTextEditableState())},setEditable:function(e){this.editable!=e&&(this.editable=e,UpdateTextEditableState())},UpdateTextEditableState:function(){var e=this.disabled||!this.editable;this.component.attr("readonly",e),this.component.css("style","#e4e4e4")},CommitField:function(){this.component.focusin()&&(this.disabled||this.visible&&this.commintValue())}}),KDControlFactoryProxy.registerType("passwordbox",KDPasswordFiledProxy),define("KDPasswordFieldProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDTextEditorProxy}}(this)),KDLargeTextFieldProxy=KD.extend(KDEditorProxy,{createControl:function(e){KDLargeTextFieldProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDLargeTextFieldProxy.superclass.loadConfig.call(this,e)},initComponent:function(){var e=this;KDLargeTextFieldProxy.superclass.initComponent.call(this);var t=this.getTextAlign();this.component=$(kendo.format("<textarea style='text-align:"+t+"' id='{0}_KDLargeTextFieldProxyInput' class='k-textbox '></textarea>",e.baseId)),this.component.change(function(t){e.onchange(t,e.component.val()),e.onfilterchange&&null!=e.onfilterchange&&e.onfilterchange(t,e.component.val())}),this.component.off("keydown").on("keydown",function(t){var i=t.keyCode||t.which||t.charCode;e.onfilterchange&&null!=e.onfilterchange&&13==i&&e.onfilterchange(t,e.component.val())}),this.el.append(this.component)},initCellComponent:function(e){var t=this,i=(this.isKendo(),this.getConfig()),a=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(i);this.InlineStyle=$.extend(this.InlineStyle||{},a),e&&(this.el=e,this.component=e,this.component.change(function(e){if(t.columnDescriptor){var i=t.component.val();t.columnDescriptor.onchange.call(t.columnDescriptor,e,i,t.rowDataModel)}}),this.component.off("keyup").on("keyup",function(e){t.onkeyup.call(t,e)}),this.component.off("keydown").on("keydown",function(e){t.onkeydown.call(t,e)})),this.setInlineStyle(),this.el.addClass(this.getStyleKey()),this.setVisible(KD.getValue(this.config,"visible",!0)),this.component&&this.setDisabled(KD.getValue(this.config,"disabled",!1)),this.setEditable&&this.setEditable(KD.getValue(this.config,"editable",!0)),this.rendered=!0,this.setStylekey(KD.getValue(this.config,"Stylekey","")),this.setToolTip(this.config.tooltip||this.config.description||""),this.columnDescriptor&&this.initColumnDescriptorEditButton(this.config),this.component&&this.component.keyup&&this.component.keydown&&(this.component.off("keyup").on("keyup",function(e){t.onkeyup.call(t,e)}),this.component.off("keydown").on("keydown",function(e){t.onkeydown.call(t,e)}))},asyncValueToUIText:function(e){this.component.val(e)},onkeydown:function(e){var t=this,i=e.keyCode||e.which||e.charCode;if(KDLargeTextFieldProxy.superclass.onkeydown.call(this,e),t.columnDescriptor&&this.component){var a=t.getValue(),n=this.component.val();a==n||37!=i&&39!=i&&38!=i&&40!=i&&13!=i&&9!=i||t.columnDescriptor.onchange.call(t.columnDescriptor,e,n,t.rowDataModel)}},commitUITextToValue:function(e){return KDLargeTextFieldProxy.superclass.commitUITextToValue.call(this,e)},setItemContaonerStyle:function(e){this.component&&this.component.css({width:"100%",border:"0px",height:e,"line-height":"1.8em","overflow-y":"auto"})},editor_DefaultButtonClick:function(){var e=this.getFormProxy();e.lockControl.call(e,this),e.fireEvent.call(e,"ButtonClick",this.postKey,"")},setDisabled:function(e){KDEditorProxy.superclass.setDisabled.call(this,e),this.disabled?this.component&&this.component.addClass("k-state-disabled").attr("disabled","disabled"):(this.editerBtn&&this.editerBtn.removeAttr("disabled"),this.component&&this.component.removeClass("k-state-disabled").removeAttr("disabled"))}}),KDControlFactoryProxy.registerType("kdlargetexttips",KDLargeTextFieldProxy),define("KDLargeTextFieldProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDLargeTextFieldProxy}}(this)),KDRichTextEditorProxy=KD.extend(KDTextAreaProxy,{maxLength:2e3,loadConfig:function(e){KDRichTextEditorProxy.superclass.loadConfig.call(this,e),this.maxLength=KD.getValue(e,"maxLength",2e3)},editor_DefaultButtonClick:function(e){var t=this.getCommitData(),i=this.getFormProxy();i.lockControl.call(i,this),i.fireEvent.call(i,"ButtonClick",t.key,"")}}),KDControlFactoryProxy.registerType("kdrichtexteditor",KDRichTextEditorProxy),KDRichEditProxy=KD.extend(KDEditorProxy,{maxLength:2e3,IsRestXmlBytes:!1,kendoStyle:"html,body{padding:0;margin:0;height:100%;min-height:100%;}body{box-sizing:border-box;font-size:12px;font-family:Verdana,Geneva,sans-serif;margin-top:-1px;padding:5px .4em 0;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;}h1{font-size:2em;margin:.67em 0}h2{font-size:1.5em}h3{font-size:1.16em}h4{font-size:1em}h5{font-size:.83em}h6{font-size:.7em}p{margin:0 0 1em;}.k-marker{display:none;}.k-paste-container,.Apple-style-span{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}ul,ol{padding-left:2.5em}span{-ms-high-contrast-adjust:none;}a{color:#00a}code{font-size:1.23em}telerikAscript{display: none;}.k-table{width:100%;border-spacing:0;margin: 0 0 1em;}.k-table td{min-width:1px;padding:.2em .3em;}.k-table,.k-table td{outline:0;border: 1px dotted #ccc;}.k-table p{margin:0;padding:0;}.k-column-resize-handle-wrapper {position: absolute; height: 10px; width:10px; cursor: col-resize; z-index: 2;}.k-column-resize-handle {width: 100%; height: 100%;}.k-column-resize-handle > .k-column-resize-marker {width:2px; height:100%; margin:0 auto; background-color:#00b0ff; display:none; opacity:0.8;}.k-row-resize-handle-wrapper {position: absolute; cursor: row-resize; z-index:2; width: 10px; height: 10px;}.k-row-resize-handle {display: table; width: 100%; height: 100%;}.k-row-resize-marker-wrapper{display: table-cell; height:100%; width:100%; margin:0; padding:0; vertical-align: middle;}.k-row-resize-marker{margin: 0; padding:0; width:100%; height:2px; background-color: #00b0ff; opacity:0.8; display:none;}.k-table-resize-handle-wrapper {position: absolute; background-color: #fff; border: 1px solid #000; z-index: 100; width: 5px; height: 5px;}.k-table-resize-handle {width: 100%; height: 100%;}.k-table-resize-handle.k-resize-east{cursor:e-resize;}.k-table-resize-handle.k-resize-north{cursor:n-resize;}.k-table-resize-handle.k-resize-northeast{cursor:ne-resize;}.k-table-resize-handle.k-resize-northwest{cursor:nw-resize;}.k-table-resize-handle.k-resize-south{cursor:s-resize;}.k-table-resize-handle.k-resize-southeast{cursor:se-resize;}.k-table-resize-handle.k-resize-southwest{cursor:sw-resize;}.k-table-resize-handle.k-resize-west{cursor:w-resize;}.k-table.k-table-resizing{opacity:0.6;}k:script{display:none;}",
getKendoCType:function(){return"kendoEditor"},createInnerDom:function(){return $("<textarea></textarea>")},getKendoOptions:function(){var e=KDRichEditProxy.superclass.getKendoOptions.call(this);return $.extend(e,{tools:["fontSize","bold","italic","underline","strikethrough","foreColor","backColor","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink","insertImage","subscript","superscript","createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn"],resizable:{content:!0,toolbar:!0}}),e},getKendoData:function(){var e=this.component.data("kendoEditor");return e},loadConfig:function(e){KDRichEditProxy.superclass.loadConfig.call(this,e),this.IsRestXmlBytes=KD.getValue(e,"isrestxmlbytes",!1)},initComponent:function(){KDRichEditProxy.superclass.initComponent.call(this),this.el.css("width","100%"),this.el.css("overflow","auto"),$(".k-editor",this.el).css({height:"100%","box-sizing":"border-box"})},setMaxLength:function(e){},loadDocument:function(e){var t=this;e&&(e.serverurl=KD.getUrlRoot()),this.loadDocumentConfig=e;var i=KD.getUrlRoot()+KD.getValue(e,"url",""),a=KD.getValue(e,"format","");KD.getValue(e,"iserrordeal",!1),KD.getValue(e,"attchs",null),KD.getValue(e,"attchsdic",null);if("WordML"!=a){var n=KD.isUrl(i)?i:KD.getUrlRoot()+i,o="<a href='"+n+"' ",r=i.split("/"),s=r[r.length-1];return o+="download='"+s+"'",o+=" >"+ResManager.LoadKDString("请点此下载查看文档","0025710000004958")+"</a>",this.el.empty(),this.el.css({marginTop:"20px",fontSize:"16px"}),void this.el.html(o)}i&&this.converToNewFomat(e,function(e){t.getKendoData().value(e),this.setBarVisible(this.barVisible)},function(e){t.getKendoData().value(e),this.setBarVisible(this.barVisible)})},receiveDocument:function(e,t){if("WordML"==t)for(var i=(e.documentElement.childNodes,0);i<e.documentElement.childNodes.length;i++){var a=e.documentElement.childNodes[i];if("w:body"===a.nodeName){var n="";try{n=this.GetTextFromXmlDocument(a,n),this.el.html(n)}catch(o){KD.writeLog("GetTextFromXmlDocument  "+this.loadDocumentUrl,o,!1)}}}},receiveErr:function(e){KD.writeLog("loadDocument receiveErr "+this.loadDocumentUrl,e,!1)},GetTextFromXmlDocument:function(e,t){var i="";return i=KD.isEmpty(e.innerHTML)?(new window.XMLSerializer).serializeToString(e).split("<w:t>"):e.innerHTML.split("<w:t>"),$(i).each(function(e){var a=i[e];a.indexOf("</w:t>")>=0&&(a=i[e].split("</w:t>")[0],t+=1==a.length?a:a+"<br/>")}),t},commitUITextToValue:function(e){return e=this.preDealHtml(e),e&&e.startsWith("<!--RichEdit.")?e=e.replace("<!--RichEdit.WPF","<!--RichEdit.HTML5").replace("<!--RichEdit.Silverligth","<!--RichEdit.HTML5"):((KD.isEmpty(e)||!e.startsWith("<"))&&(e="<div>"+e+"</div>"),e='<!--RichEdit.HTML5--><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><title></title><style type="text/css">'+this.kendoStyle+"</style><div>"+e+"</div>"),e=JXG.Util.Base64.encode(e),void 0==e?null:null!=e.current?e.current:e},isEmpty:function(){var e=this.component.data(this.getKendoCType()).value(),t=this.isEmptyValue(e);return t&&this.isDataMasking&&this.mustInput&&(t=this.isEmptyMkValue()),t},setFocus:function(){var e=this.component.data(this.getKendoCType());e&&e.body&&$(e.body).focus()},preDealHtml:function(e){var t=e||"",i=new RegExp("<table>","g");return t=t.replace(i,'<table class="k-table">')},dealKendoStyle:function(e){var t="";return KD.isEmpty(e)?e:(e.indexOf('<style type="text/css">')>0&&e.indexOf(".k-table{")<0&&(t=e.substr(0,e.indexOf('<style type="text/css">')+'<style type="text/css">'.length)+this.kendoStyle+e.substring(e.indexOf('<style type="text/css">')+'<style type="text/css">'.length)),t)},asyncValueToUIText:function(e){var t=JXG.Util.Base64.decode(e);t=JXG.Util.UTF8.decode(t),KD.isEmpty(t)||t.startsWith("<!--RichEdit.")?(this.oldFomatData=!1,this.EmptyFomatData=KD.isEmpty(t),this.getKendoData().value(t)):(this.oldFomatData=!0,this.oldFomatValue=e),this.asynFormatOlddata()},asynFormatOlddata:function(){var e=this,t="";if(0==e.oldFomatData&&1==e.EmptyFomatData&&e.IsRestXmlBytes)t=t=kendo.format("<h1  class='k-link kd-newOpenXML-Tips'>{0}</h1>",ResManager.LoadKDString("开启了xml格式，将无法编辑内容","0141072000005670"));else{if(1!=e.oldFomatData)return;t=kendo.format(ResManager.LoadKDString("{0}该文档格式为旧文档格式,{1}点击转换新文档格式{2}!转换之后兼容所有客户端{3}","0141072000005671"),"<h1 class='k-link kd-newOpenXML-Tips'>","<a href='javascript:void(0);' class='k-link kd-newOpenXML'>","</a>","</h1>"),e.IsRestXmlBytes&&(t=kendo.format(ResManager.LoadKDString("{0}开启了xml格式,将无法编辑内容,该文档格式为旧文档格式,{1}点击转换新文档格式{2}!转换之后可立即查看内容{3}","0141072000005777"),"<h1 class='k-link kd-newOpenXML-Tips'>","<a href='javascript:void(0);' class='k-link kd-newOpenXML'>","</a>","</h1>"))}var i=$("iframe",e.el).contents().find(".kd-newOpenXML-Tips");i&&i.remove(),e.getKendoData().value(t);var a=$("iframe",e.el).contents().find(".kd-newOpenXML");a.click(function(){e.getKendoData().value(ResManager.LoadKDString("处理中.....","0025372030032808")),e.converToNewFomat(e.oldFomatValue,function(t){e.oldFomatData=!1,e.getKendoData().value(t),e.setDisabled.call(e,e.disabled)},function(t){e.getKendoData().value(ResManager.LoadKDString("发生错误：","0025372030032809")+t)})})},converToNewFomat:function(e,t,i){var a=this,n={type:"text",obase:e};if(KD.isObject(e))var n={type:"obj",arg:e};var o=JSON.stringify(n);$.ajax({url:KD.getUrlRoot()+"/datatool/richeditdata/convert.kdsv",async:!0,data:KD.isFirefox()?n:o,type:"Post",contentType:"text/json",success:function(e,n,o){if(0==e.code){var r=JXG.Util.Base64.decode(e.htmlbase);r=JXG.Util.UTF8.decode(r),t.call(a,r)}else i.call(a,e.message)},error:function(e,t,n){i.call(a,e)}})},setDisabled:function(e){this.IsRestXmlBytes&&(e=!0),KDRichEditProxy.superclass.setDisabled.call(this,e);var t=this.getKendoData(),i=$("iframe",this.el).contents().find("body");e||this.oldFomatData?(t&&t.toolbar&&t.toolbar.element&&t.toolbar.element.hide(),i&&i.attr&&i.attr("contenteditable",!1)):(t&&t.toolbar&&t.toolbar.element&&t.toolbar.element.show(),i&&i.attr&&i.attr("contenteditable",!0))},setBackColor:function(e){var t=this.getKendoData();t&&t.body&&$(t.body).css("background-color",e)},setForeColor:function(e){var t=this.getKendoData();t&&t.body&&$(t.body).css("color",e)},setBarVisible:function(e){this.barVisible=e;var t=this.getKendoData();e?t&&t.toolbar&&t.toolbar.element&&t.toolbar.element.show():t&&t.toolbar&&t.toolbar.element&&t.toolbar.element.hide()},setEditable:function(e){KDRichEditProxy.superclass.setEditable.call(this,e)},setIsRestXmlBytes:function(e){this.IsRestXmlBytes=e,this.asynFormatOlddata(),this.IsRestXmlBytes&&this.setDisabled(!0)},release:function(){clearInterval(this.timer),KDRichEditProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdrichedit",KDRichEditProxy),define("KDRichTextEditorProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDRichTextEditorProxy}}(this)),KDDatePickerProxy=KD.extend(KDEditorProxy,{isuseregion:!1,mask:null,displayFormatString:null,format:"yyyy-MM-dd",returnFormat:"yyyy-MM-dd",minValue:null,maxValue:null,getKendoCType:function(){return"kendoDatePicker"},adapterFormat:function(e){return e},getKendoOptions:function(){var e=this,t=KDDatePickerProxy.superclass.getKendoOptions.call(this);return $.extend(t,{format:e.getFormat(),max:e.maxValue||"2999-1-1",min:e.minValue||"1900-1-1",open:function(t){e._isAllowPopup()||t.preventDefault()},animation:{close:{effects:"fadeOut zoom:out",duration:300},open:{effects:"fadeIn zoom:in",duration:300}}}),t.max.length<8&&(t.max=new Date(t.max)),t.min.length<8&&(t.min=new Date(t.min)),t},getFormat:function(){return this.format},getGirdEditorOptions:function(e){var t=this.getKendoOptions();return delete t.format,t},setMask:function(e){if(null!=e){this.format;this.format=this.adapterFormat(e),this._setOptions("format",this.format)}},isPopup:function(e){return!1},setItemContaonerStyle:function(e){KDDatePickerProxy.superclass.setItemContaonerStyle.call(this,e)},updateStyle:function(e){$(".k-datepicker",this.el).height(e.height)},asyncValueToUIText:function(e){this.getFormat();if(KD.isChrome()&&!KD.isEmpty(e)&&e.replace)var t=e.replace("T"," ").replace(/-/g,"/");else var t=e;t=kendo.parseDate(e),null==t&&(t=new Date(e)),t&&"Invalid Date"!=t&&(e=t),KDDatePickerProxy.superclass.asyncValueToUIText.call(this,e);var i=this._getKendoDateDom();i.value(e),this._validateValue=i.value()},commitUITextToValue:function(e){return KDDatePickerProxy.superclass.commitUITextToValue.call(this,e)},loadConfig:function(e){KDDatePickerProxy.superclass.loadConfig.call(this,e),this.isuseregion=KD.getValue(e,"isuseregion",!0),this.minValue=KD.getValue(e,"minValue",null),this.maxValue=KD.getValue(e,"maxValue",null),null!=this.minValue&&$.browser.safari&&(this.minValue=this.minValue.replace("T"," ")),null!=this.maxValue&&$.browser.safari&&(this.maxValue=this.maxValue.replace("T"," "))},initComponent:function(){KDDatePickerProxy.superclass.initComponent.call(this);var e=this;e.getBaseId();this.initDateComponent(),$("span",this.el).css({border:"none"}),this.el.addClass("kd_datePicker_extend").css({width:"100%"}),this.itemContainer&&this.updateStyle({height:$(".kdItemContainer_editorct",this.itemContainer.el).height()}),this._inputValidating()},initCellComponent:function(e){KDDatePickerProxy.superclass.initCellComponent.call(this,e),this.columnDescriptor&&this._inputValidating(),this.setFormat(),this.setShowEditButton(this.config.showEditButton)},setShowEditButton:function(e){KDDatePickerProxy.superclass.setShowEditButton.call(this,e);var t=this.config.xtype;if("datefield"==t||"datetimefield"==t){var i=this._getKendoDateDom(),a=i&&i.wrapper;a&&(0==e?a.addClass("kd-control-editorBtn-state-hide"):a.removeClass("kd-control-editorBtn-state-hide"))}},initColumnDescriptorEditButton:function(e){KDDatePickerProxy.superclass.initColumnDescriptorEditButton.call(this,e),this.setShowEditButton(KD.getValue(e,"showEditButton",!0))},setDisabled:function(e){KDDatePickerProxy.superclass.setDisabled.call(this,e),e||this.editable||this.setEditable(this.editable)},setBackColor:function(e){KDDatePickerProxy.superclass.setBackColor.call(this,e);var t=this._getKendoDateDom();t._inputWrapper&&t._inputWrapper.css("background-color",e)},_inputValidating:function(){var e=this,t=$("input",this.el);0==t.length&&(t=$("input",this.el.parent())),t.css("ime-mode","inactive"),t.off("keydown").on("keydown",function(t){var i=8==t.keyCode?-1:1,a=e.getFormat(),n=e._getKendoDateDom(),o=n.value();if((t.keyCode>=65&&t.keyCode<=90||t.keyCode>=106&&t.keyCode<=229)&&220!=t.keyCode&&189!=t.keyCode&&109!=t.keyCode&&173!=t.keyCode&&186!=t.keyCode&&59!=t.keyCode){if(!t.ctrlKey)return t.preventDefault(),t.preventDefault(),!1}else if(32==t.keyCode&&!o&&e._isAllowPopup()){var r=new Date;n.value(r),n.trigger("change")}else 39==t.keyCode||37==t.keyCode||($(this).val().length<=a.length&&this.selectionStart+i>=10?e._openDatetime("time","date"):e._openDatetime("date","time"))})},_isAllowPopup:function(){var e=!0;if(0==this.showEditButton&&0==this.editable){var t=this.config.xtype;("datefield"==t||"datetimefield"==t)&&(e=!1)}return e},_getKendoDateDom:function(){return this.component.data(this.getKendoCType())},_openDatetime:function(e,t){this._getKendoDateDom().open(e)},initDateComponent:function(){this.component=this.component.kendoDatePicker(this.getKendoOptions())},setFormat:function(e){var t;if(e&&e.length>0)t=e;else{this.displayFormatString=KD.getValue(this.config,"displayFormatString",void 0),this.mask=KD.getValue(this.config,"mask",void 0);var i=KD.getValue(this.config,"format",this.format);t=this.mask||this.displayFormatString||i}i&&i.length>19&&(i.indexOf("f")>=0||i.indexOf("F")>=0)&&(i=i.replace(new RegExp("f","g"),"").replace(new RegExp("F","g"),""),i+="ms",this.returnFormat="yyyy-MM-dd HH:mm:ss:ms"),this.format=this.adapterFormat(t),this._setOptions("format",this.format)},_setOptions:function(e,t){var i={};i[e]=t,this.component&&$.isFunction(this.component.data)&&this.component.data(this.getKendoCType()).setOptions(i)},getOptions:function(){var e=KDDatePickerProxy.superclass.getOptions.call(this);return null!=this.format&&(e.dateFormat=this.format),null!=this.minValue&&(e.minDate=this.minValue),null!=this.maxValue&&(e.maxDate=this.maxValue),e},onchange:function(e,t){if(t=t||"",this._validateValue=t,this.validating(!0)){var i=this._getControlInput().val();if(KD.isEmpty(t)&&!KD.isEmpty(i))return this._getKendoDateDom()._old=new Date,void this.setValidateMessage(ResManager.LoadKDString("输入错误","0025710030032322"));var a=t;t&&t.format&&(a=t.format(this.returnFormat)),this.commitValueToForm(a),this._value=a}},validating:function(e){if(this._validateValue&&this._validateValue.format)this.resetValidateMessage();else if(void 0!==this._validateValue&&this.mustInput)return this.setValidateMessage(ResManager.LoadKDString("输入错误","0025710030032322")),!1;return KDDatePickerProxy.superclass.validating.call(this,e),!0}}),$.extend(KDDatePickerProxy,{_format:"yyyy-MM-dd",bindClick:function(e,t){var i=this;i.initFormatItem(t),e.on("keydown",function(t){var a=this,n=t.keyCode,o=i.getCursor(a);if(!(n>=48&&57>=n||n>=96&&105>=n)){if(8==n){var r=i.getCurrentItem(e);i.getItemPosition(e,o,r);return!1}return!1}}),e.off("keyup").on("keyup",function(e){var t=$(this);if(1==t.val().length){var a=(new Date).format(i._format),n=t.val();a=n+a.substring(n.length),t.val(a);for(var o=0,r=0;r<a.length;r++)if(!$.isNumeric(a.substring(r,r+1))){o=r;break}i.setSelection(t,1,o)}else{var s=i.getCurrentItem(t),l=i.getCursor(t);position=i.getItemPosition(t,l,s),position.endP-position.startP>=s.maxLength&&(i.setCurrentItemByIndex(position.endP+1,t),l=position.endP+1,s=i.getCurrentItem(t),position=i.getItemPosition(t,l,s),position&&i.setSelection(t,position.startP,position.endP))}}),e.on("click",function(){var e,t=$(this),a=i.getCursor(t),n=t.val().substring(0,a);a=0;for(var o=n.length;o>0;o--)if(e=n.substring(o-1,o),!$.isNumeric(e)){a=o;break}i.setCurrentItemByIndex(a,t);var r=i.getCurrentItem(),s=i.getItemPosition(t,a,r);s&&i.setSelection(t,s.startP,s.endP)})},setCurrentItemByIndex:function(e,t){var i=!1;if(e>=this._format.length){for(var a=this.ModelList.length-2;a>=0;a--)if(this.ModelList[a].position.length>0){this.currentItem=this.ModelList[a];break}}else for(var a=0;a<this.ModelList.length;a++){for(var n=0;n<this.ModelList[a].position.length;n++)if(e==this.ModelList[a].position[n]){this.currentItem=this.ModelList[a],i=!0;break}if(i)break}if("Separator"==this.currentItem.type&&this.setCurrentItemByIndex(--e,t),this.lastItem){var o=this.getItemPosition(t,this.lastItem.focusIndex,this.lastItem);if(o){var r=t.val(),s=r.substring(0,o.startP),l=r.substring(o.endP,r.length),d=r.substring(o.startP,o.endP);if(d.length<this.lastItem.position.length)switch(this.lastItem.type){case"Year":d="1900";break;case"Month":case"Day":d="01";break;case"Hour":d="00";break;case"Minute":case"Second":case"MilliSecond":d="01"}r=s+d+l,t.val(r)}}this.lastItem=this.currentItem,this.lastItem&&(this.lastItem.focusIndex=e)},getCurrentItem:function(){return this.currentItem},setFormat:function(e){for(var t=/^[A-Za-z]+$/,i=this.getStartFormatItemIndex(e),a=0;a<e.length;a++){var n=e.substring(a,a+1),o=this.ModelList[i];o.type;t.test(n)&&o.position.length<o.maxLength?(o.value=o.value+n,o.position.push(a)):(o.separatorType=n,this.ModelList[7].value=this.ModelList[7].value+n,this.ModelList[7].position.push(a),this.ModelList[7].separatorType.push(o.type),i++)}},getStartFormatItemIndex:function(e){for(var t=e.substring(0,1),i=0,a=!1,n=0;n<this.ModelList.length;n++){for(var o=this.ModelList[n],r=0;r<o.defaultChar.length;r++)if(t==o.defaultChar[r]){i=n,a=!0;break}if(a)break}return i},initFormatItem:function(e){this._format=e,this.ModelList=[],this.ModelList=[{type:"Year",index:0,value:"",position:[],maxLength:4,defaultChar:["y","Y"],separatorType:""},{type:"Month",index:1,value:"",position:[],maxLength:2,defaultChar:["M"],separatorType:""},{type:"Day",index:2,value:"",position:[],maxLength:2,defaultChar:["d","D"],separatorType:""},{type:"Hour",index:3,value:"",position:[],maxLength:2,defaultChar:["h","H"],separatorType:""},{type:"Minute",index:4,value:"",position:[],maxLength:2,defaultChar:["m"],separatorType:""},{type:"Second",index:5,value:"",position:[],maxLength:2,defaultChar:["s","S"],separatorType:""},{type:"MilliSecond",index:6,value:"",position:[],maxLength:2,defaultChar:["si","S"]},{type:"Separator",index:7,value:[],position:[],separatorType:[]}],this.setFormat(e)},getItemPosition:function(e,t,i){if(i&&i.index<7){var a=e.val().substring(t),n=i.separatorType.length>0&&a.search(i.separatorType)>-1?a.search(i.separatorType)+t:e.val().length,o=e.val().substring(0,t),r=i.index>0?o.lastIndexOf(this.ModelList[i.index-1].separatorType)+1:0,s={startP:r,endP:n};return s}return null},getCursor:function(e){e=$(e)[0];var t=KDGetCursorPositon._getFocus(e);return $.isNumeric(e.value.charAt(t))||(t=t>=1?t-1:t),t},setCursor:function(e,t){e=$(e)[0],KDGetCursorPositon.setSelectionIndex(e,t)},setSelection:function(e,t,i){e=$(e)[0],KDGetCursorPositon.setSelection(e,t,i)},getSelection:function(e){if(e=$(e)[0],void 0!==e.selectionStart)return e.value.substring(e.selectionStart,e.selectionEnd);var t=document.selection.createRange();return t.text}}),KDControlFactoryProxy.registerType("datefield",KDDatePickerProxy),KDDatePickerProxy_Galaxy=KD.extend(KDDatePickerProxy,{initComponent:function(){KDDatePickerProxy_Galaxy.superclass.initComponent.call(this),this.el.css({width:this.el.parent().width()})},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.el&&this.el.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight}),$(".k-picker-wrap",this.el).css({height:this.el.height()-2})},getKendoOptions:function(){var e=this,t=KDDatePickerProxy_Galaxy.superclass.getKendoOptions.call(e);return $.extend(t,{open:function(t){var i=t.sender.timeView||t.sender.dateView;if(i&&i.popup&&i.popup.element){var a=i.popup.element;if(a&&a.css){a.css({width:"auto"});var n=e.getFormTheme()+"-popup";a.addClass(n)}}}}),t}}),KDControlFactoryProxy.registerType("datefield_Galaxy",KDDatePickerProxy_Galaxy),define("KDDatePickerProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDDatePickerProxy}}(this)),KDDateTimePickerProxy=KD.extend(KDDatePickerProxy,{format:"yyyy-MM-dd HH:mm:ss",returnFormat:"yyyy-MM-dd HH:mm:ss",getKendoCType:function(){return"kendoDateTimePicker"},updateStyle:function(e){$(".k-datetimepicker",this.el).height(e.height)},_openDatetime:function(e,t){var i=this.component.data(this.getKendoCType());i.close(t),i.open(e)},getKendoOptions:function(){var e=KDDateTimePickerProxy.superclass.getKendoOptions.call(this);return e.timeFormat="HH:mm",e},_setOptions:function(e,t){if(KDDateTimePickerProxy.superclass._setOptions.call(this,e,t),KD.equalsIgnoreCase(e,"format")&&this.el){var i="kd-datetime-to-data";t&&t.length<=10?this.el.addClass(i):this.el.removeClass(i)}},initDateComponent:function(){this.component=this.component.kendoDateTimePicker(this.getKendoOptions())}}),KDControlFactoryProxy.registerType("datetimefield",KDDateTimePickerProxy),KDDateTimePickerProxy_Galaxy=KD.extend(KDDateTimePickerProxy,{initComponent:function(){KDDateTimePickerProxy_Galaxy.superclass.initComponent.call(this),this.el.css({width:this.el.parent().width()})},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.el&&this.el.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight}),$(".k-picker-wrap",this.el).css({height:this.el.height()-2})}}),KDControlFactoryProxy.registerType("datetimefield_Galaxy",KDDateTimePickerProxy_Galaxy),define("KDDateTimePickerProxy",["KDDatePickerProxy","KD"],function(e){return function(){var t;return t||e.KDDateTimePickerProxy}}(this)),KDTimePickerProxy=KD.extend(KDDatePickerProxy,{format:"HH:mm:ss",returnFormat:"yyyy-MM-dd HH:mm:ss",getKendoCType:function(){return"kendoTimePicker"},loadConfig:function(e){this.config.showEditButton=!1,KDTimePickerProxy.superclass.loadConfig.call(this,e),this.displayFormatString=KD.getValue(e,"displayFormatString",null),this.isuseregion=KD.getValue(e,"isuseregion",!1),this.mask=KD.getValue(e,"mask",null),null!=this.displayFormatString?this.format=this.displayFormatString:null!=this.mask?this.format=this.mask:this.format="HH:mm:ss",this.format=this.adapterFormat(this.format)},updateStyle:function(e){$(".k-timepicker",this.el).height(e.height)},initDateComponent:function(){this.component=this.component.kendoTimePicker(this.getKendoOptions())},commitUITextToValue:function(e){return KDTimePickerProxy.superclass.commitUITextToValue.call(this,e)}}),KDControlFactoryProxy.registerType("timefield",KDTimePickerProxy),KDTimePickerProxy_Galaxy=KD.extend(KDTimePickerProxy,{initComponent:function(){KDTimePickerProxy_Galaxy.superclass.initComponent.call(this),this.el.css({width:this.el.parent().width()})},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.el&&this.el.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight}),$(".k-picker-wrap",this.el).css({height:this.el.height()-2})}}),KDControlFactoryProxy.registerType("timefield_Galaxy",KDTimePickerProxy_Galaxy),define("KDTimePickerProxy",["KDDatePickerProxy","KD"],function(e){return function(){var t;return t||e.KDTimePickerProxy}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.KDPopListEdit,o=KD.numInfo.redCellCls,s="-",l=n.extend({init:function(e,t){var i=this;n.fn.init.call(i,e,t)},onInitContent:function(){var e=this;e.options;e.setIsRedBlue()},onLoadOptions:function(e){var t=this;e.numFmtInfo&&(t.numberFormatInfo=null),t.isRefreshing||(t.isRefreshing=!0,KD.delayInvoke(function(){t.displayValue.call(t),t.isRefreshing=!1}))},onFocus:function(e){var t=this,i=t.options;i.isFilterEditor&&(t.isChanged=!0),1==t.options.focusedIsNeedSeclect&&t.input.select()},onLostFocus:function(e){var t=this,i=t.getInputValue(),a=KD.numInfo.validation(i,t.options);t._adjustmentInputValue(a),n.fn.onLostFocus.call(t,e),t.fireValidate({validate:!0,value:i,message:""})},getInputValue:function(){var e=this,t=e.input.val();return t&&t.replace?t.replace(/,/g,""):t},initNumberFormatInfo:function(e,t){var i=this;return t&&(i.numberFormatInfo=null),null!=i.numberFormatInfo?i.numberFormatInfo:(i.numberFormatInfo=KD.numInfo.getNumberFormatInfo(e),i.numberFormatInfo)},options:{name:"KDNumberField",autoBind:!0,template:"",buttonCls:"k-i-calc",culture:"zh-CN",mask:"",displayFormat:"",maskUseAsDisplayFormat:!1,intLength:10,precision:10,isZeroShow:!1,isRedBlue:!1,textAlign:"right",showButton:!0,showCalcButton:!1,displayByReallyPrecision:!1,isUseRegion:!1,isControlPrecision:!1,max:Number.POSITIVE_INFINITY,min:Number.NEGATIVE_INFINITY,focusedIsNeedSeclect:!0,numFmtInfo:{NumType:"N",NDSeparator:".",NGSeparator:",",NNPattern:1,NSign:"-",CNPattern:2,CPPattern:0,NSign:"-",CSymbol:"¥"}},getRealMin:function(){var e=this,t=e.options;return KD.numInfo.getRealMin(t)},getRealMax:function(){var e=this,t=e.options;return KD.numInfo.getRealMax(t)},getRedBlueValue:function(e){var t=this,i=t.options;if(!this.options.isZeroShow&&(isNaN(e)||0==e)){if(!(0==e&&i.min>e))return KD.isEmpty(e)&&0==t.options.isNeedDeaultZero?"":0;e=0==isFinite(i.min)?e:i.min}return r=KD.numInfo.getRedBlueValue(e,i),r},setIsRedBlue:function(i,a){var n=this,r=n.options;a!==t&&e.extend(r,a),r.isRedBlue=i===t?r.isRedBlue:i,r.isRedBlue?!n.element.hasClass(o)&&n.element.addClass(o):n.element.hasClass(o)&&n.element.removeClass(o),n.val(n.coreValue()),n._initNumberEditor(i,a)},_initNumberEditor:function(e,t){var i=this,a=i.options;i.getInput().KDNumerInput({max:i.getRealMax(),min:i.getRealMin(),precision:a.precision,intLength:a.intLength,isControlPrecision:a.isControlPrecision}),i.getDisplayer().css({"text-align":a.textAlign||"right"})},destroy:function(){var e=this,t=e.getInput();t&&t.KDNumerInput("release"),n.fn.destroy.call(e)},val:function(e){var i=this;if(e===t)return i.coreValue();var a,o=e,r=(o||"").toString();return a=r.indexOf(".")>=0||r.indexOf("e")>=0?parseFloat(o):parseInt(o),a=KD.numInfo.checkValueIsOverFloatMinValue(a),a=i.getRedBlueValue(a),a=n.fn.val.call(i,a)||""},displayValue:function(){var e=this,t=e.options,i=e.getInputValue(),a="",n=0;if(t.isRedBlue||(i.substr(0,1)===s?e.getDisplayer().css("color",KD.getLocalConfiguration().MinusNumColor):e.getDisplayer().css("color","")),!(i.length>1||i.length>0&&"-"!==i.substr(0,1)))return e._getReallyPrecisionDisplayValue(i);if(0==e.options.precision?n=parseInt(i):(n=parseFloat(i),n=KD.numInfo.checkValueIsOverFloatMinValue(n)),t.isUseRegion){var o=e.initNumberFormatInfo(t.numFmtInfo);return a=o.IsDefault?displayText:o.getFormatedString(n,t.precision,n+""),e._getReallyPrecisionDisplayValue(a)}if(KD.isNaN(n)||0==n)return t.isZeroShow?"0":"";var r=(t.maskUseAsDisplayFormat?t.mask:t.displayFormat)||this.getMask();return a=KD.numInfo.formatNumber(n,t.precision,r),e._getReallyPrecisionDisplayValue(a)},isInt:function(){return 0==(this.options.precision||0)},getMask:function(){var e=this,t=e.options;return KD.numInfo.getMask(t.intLength,t.precision)},_getReallyPrecisionDisplayValue:function(e){if(!e||!KD.isString(e))return e;var t=this,i=t.options,a=t.getInputValue(),n=parseFloat(a);if((KD.isNaN(n)||0==n)&&!i.isZeroShow)return"";var t=this,i=t.options,o=(i.precision,e);return i.displayByReallyPrecision&&(o||"").indexOf(".")>=0&&(o=KD.toReallyPrecision(o,13)),o},_keyup:function(e){var t=this,i=t.getInputValue();i!==t._oldText&&(t._change(e,i),e.cancel||(t._oldText=i)),t.onKeyUp(e),t.options.keyup&&t.options.keyup(e),e.keyCode==t.options.btnKeyCode&&t._buttonClick(e)},_keydown:function(e){var t=this;if(13==e.keyCode){var i=t.getInputValue(),a=KD.numInfo.validation(i,t.options);t._adjustmentInputValue(a)}n.fn._keydown.call(t,e)},onChange:function(e,t){var i=this,a=KD.numInfo.validation(t,i.options);if(a.result)i.fireValidate({validate:!0,value:t,message:"",key:e.key}),t=a.value,n.fn.onChange.call(i,e,t);else{var o=ResManager.LoadKDString("数值[{0}]超出[{1}~{2}]的范围!","0025710030032321"),r=i.getRealMin(),s=i.getRealMax();o=a.strPat?a.strPat:o,i.fireValidate({validate:!1,value:t,message:KD.format(o,t,r,s),key:e.key}),e.cancel=!0}},fireChange:function(e,i){var a=this,o=i;a.options.precision!==t&&(o=KD.numInfo.toPrecision(i,a.options.precision),a.val(o)),KD.isEmpty(i)&&0==a.options.isNeedDeaultZero&&(o=""),o=a.getRedBlueValue(o),n.fn.fireChange.call(a,e,o)},_adjustmentInputValue:function(e){var t=this;e&&!e.result?(t.updateInput(t._oldText),t.updateDisplayer()):0==t.options.precision&&t.updateInput(e.value)}});a.plugin(l)}(window.kendo.jQuery),define("KDNumberField",["KDPopListEdit","KD","KDNumberFormatInfo","KDNumInfoUtils"],function(e){return function(){var t;return t||e.KDNumberField}}(this)),KDNumberFieldProxy=KD.extend(KDEditorProxy,{getKendoCType:function(){return this.getStyleKey()==KDNumberFieldProxy.CPUpDownNumberField?"kendoKDLRSpinnerNumber":"kendoKDNumberField"},loadConfig:function(e){var t=this;KDNumberFieldProxy.superclass.loadConfig.call(t,e)},getKendoOptions:function(e){var t=this,i=void 0===e?t.config:e,a=KD.getValue(i,"textAlign",2),n=KDNumberFieldProxy.superclass.getKendoOptions.call(this,e);return $.extend(n,{height:KD.getValue(i,"height",t.elHeight),mask:KD.getValue(i,"mask",void 0),displayFormat:KD.getValue(i,"displayFormat",void 0)||KD.getValue(i,"displayFormatString",void 0),intLength:KD.getValue(i,"decimalIntLength",-1),precision:KD.getValue(i,"decimalPrecision",-1),isZeroShow:KD.getValue(i,"isZeroShow",!0),isRedBlue:KD.getValue(i,"isRedBlue",!1),showButton:KD.getValue(i,"showEditButton",!1),showCalcButton:KD.getValue(i,"showCalculatorButton",!1),displayByReallyPrecision:KD.getValue(i,"dsplayByReallyPrecision",!1),isUseRegion:KD.getValue(i,"isuseregion",!1),isControlPrecision:KD.getValue(i,"IsControlPrecision",!0),textAlign:1==a?"left":3==a?"center":"right",max:KD.getValue(i,"maxValue",Number.POSITIVE_INFINITY),min:KD.getValue(i,"minValue",Number.NEGATIVE_INFINITY),numFmtInfo:KD.parseObject(KD.getValue(i,"NumFmtInfo","{}"))||{},value:t.getValue(),focusedIsNeedSeclect:KD.getValue(i,"focusedIsNeedSeclect",!0),validateString:KD.getValue(i,"validateString",""),buttonClick:function(e){t.onButtonClick.call(t,e)},validate:function(e){t.validating.call(t,!0,e)},keyup:function(e){t.onkeyUp&&t.onkeyUp.call(t,e)}}),n.maskUseAsDisplayFormat=!n.isUseRegion&&!n.displayFormat&&!n.displayByReallyPrecision,$.extend(n.numFmtInfo,t.getDefNumberFmtInfo(),{NumType:KD.getValue(i,"numtype","N")}),this.config&&void 0!=this.config.isNeedDeaultZero&&(n.isNeedDeaultZero=this.config.isNeedDeaultZero),n},getDefNumberFmtInfo:function(){return{NumType:"N",NDSeparator:".",NGSeparator:",",NNPattern:1,NSign:"-",CNPattern:2,CPPattern:0,NSign:"-",CSymbol:"¥"}},initComponent:function(){var e=this;e.component=e.el[e.getKendoCType()](e.getKendoOptions()),this.setIsZeroShow(KD.getValue(this.config,"isZeroShow",!0)),this.setEditable(this.editable)},initColumnDescriptorEditButton:function(e){},onButtonClick:function(e){if(1!=this.disabled){var t=this.getCommitData(this._value),i=this.getFormProxy(),a="object"==typeof t.value?t.value.number:t.value;return i&&i.fireEvent.call(i,"F7ButtonClick",t.key,a,t.row),!0}},asyncValueToUIText:function(e){e=null==e||void 0==e||KD.IsNullOrWhiteSpace(e)?null:parseFloat(e);var t=this,i=t.getKendoCType(),a=i&&t.component.data(i);a&&a.val(e)},commitUITextToValue:function(e){if(void 0==e||KD.isString(e)&&0==e.length)return 0;var t=null!=e.current?e.current:e;return t=KD.numInfo.checkValueIsOverFloatMinValue(t)},updateActualDisplay:function(e,t){var i=this,a=i.getKendoCType(),n=a&&i.component.data(a);n.setOptions(t)},setNumFmtInfo:function(e){this.NumFmtInfo!=e&&(this.NumFmtInfo=e,this.updateActualDisplay(!0,{numFmtInfo:e}))},setIsUseRegion:function(e){this.IsUseRegion=e,e&&this.setDisplayFormatString(this.DisplayFormatString)},setDisplayFormatString:function(e){this.DisplayFormatString=e,this.updateActualDisplay(!0,{displayFormat:e})},setDecimalPrecision:function(e){this.config.decimalPrecision=e,this.DecimalPrecision=e,this.updateActualDisplay(!0,{precision:e})},setDecimalIntLength:function(e){this.config.decimalIntLength=e,this.DecimalIntLength=e,this.updateActualDisplay(!0,{intLength:e})},setIsZeroShow:function(e){this.IsZeroShow=e,this.updateActualDisplay(!0,{isZeroShow:e}),e||this.setValue(this.getValue())},setMask:function(e){this.Mask=e,this.updateActualDisplay(!0,{mask:e})},setIsRedBlue:function(e){var t=this,i=t.getKendoCType();t.config.isRedBlue=e;var a=t.getKendoOptions(),n=i&&t.component.data(i);n&&n.setIsRedBlue&&n.setIsRedBlue(e,a)},setMaxValue:function(e){this.MinValue=e,this.updateActualDisplay(!0,{max:e})},setMinValue:function(e){this.MinValue=e,this.updateActualDisplay(!0,{min:e})},setEditable:function(e){KDNumberFieldProxy.superclass.setEditable.call(this,e),this.component&&(this.editable?this.component.find(".ui-poplistedit-displayname").removeClass("k-state-uneditorable"):this.component.find(".ui-poplistedit-displayname").addClass("k-state-uneditorable"))},validating:function(e,t){var i=!0;if(t&&t.validate)this.resetValidateMessage();else if(t&&!t.validate)return this.config.validateString&&this.config.validateString.indexOf(t.key)>-1?this.resetValidateMessage():this.setValidateMessage(t.message||ResManager.LoadKDString("输入错误","0025710030032322")),!1;return i=KDNumberFieldProxy.superclass.validating.call(this,e)},setBackColor:function(e){KDNumberFieldProxy.superclass.setBackColor.call(this,e),this.component&&this.component.find(".k-dropdown-wrap").css("background-color",e)},setForeColor:function(e){KDNumberFieldProxy.superclass.setForeColor.call(this,e),
this.component&&this.component.find(".k-dropdown-wrap").css("color",e)}}),$.extend(KDNumberFieldProxy,{CPUpDownNumberField:"CPUpDownNumberField"}),KDControlFactoryProxy.registerType("numberfield",KDNumberFieldProxy),KDNumberFieldProxy_Galaxy=KD.extend(KDNumberFieldProxy,{getKendoOptions:function(){var e=KDNumberFieldProxy_Galaxy.superclass.getKendoOptions.call(this);return e.FontSize=14,e},setDisabled:function(e){KDNumberFieldProxy_Galaxy.superclass.setDisabled.call(this,e),this.editable?$(".Galaxy-state-uneditorable",this.el).removeClass("Galaxy-state-uneditorable"):$(".k-state-uneditorable",this.el).addClass("Galaxy-state-uneditorable").removeClass("k-state-uneditorable")},setEditable:function(e){KDNumberFieldProxy_Galaxy.superclass.setEditable.call(this,e),e?$(".Galaxy-state-uneditorable",this.el).removeClass("Galaxy-state-uneditorable"):$(".k-state-uneditorable",this.el).addClass("Galaxy-state-uneditorable").removeClass("k-state-uneditorable")},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.component&&this.component.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight})}}),KDControlFactoryProxy.registerType("numberfield_Galaxy",KDNumberFieldProxy_Galaxy),KDVouchernumberfield=KD.extend(KDNumberFieldProxy,{getKendoOptions:function(){var e=KDVouchernumberfield.superclass.getKendoOptions.call(this);return e.FontSize=14,e},setDisabled:function(e){KDVouchernumberfield.superclass.setDisabled.call(this,e),this.editable?$(".Galaxy-state-uneditorable",this.el).removeClass("Galaxy-state-uneditorable"):$(".k-state-uneditorable",this.el).addClass("Galaxy-state-uneditorable").removeClass("k-state-uneditorable")},setEditable:function(e){KDVouchernumberfield.superclass.setEditable.call(this,e),e?$(".Galaxy-state-uneditorable",this.el).removeClass("Galaxy-state-uneditorable"):$(".k-state-uneditorable",this.el).addClass("Galaxy-state-uneditorable").removeClass("k-state-uneditorable")},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.component&&this.component.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight})},onkeyUp:function(e){var t=this.getRow(),i=this.getFormProxy(),a=$(e.target).val().trim(),n={row:t,value:a};32==e.keyCode?i&&i.fireCustomEvents.call(i,this.postKey,"VoucherNumberField.SpaceKey",KD.stringify(n)):"="==e.currentTarget.value?i&&i.fireCustomEvents.call(i,this.postKey,"VoucherNumberField.EqualKey",KD.stringify(n)):27==e.keyCode&&i&&i.fireCustomEvents.call(i,this.postKey,"VoucherNumberField.EscKey",KD.stringify(n))}}),KDControlFactoryProxy.registerType("vouchernumberfield",KDVouchernumberfield),define("KDNumberFieldProxy",["KDEditorProxy","KDNumberField","KD"],function(e){return function(){var t;return t||e.KDNumberFieldProxy}}(this)),KDMultiLangBoxProxy=KD.extend(KDEditorProxy,{getKendoCType:function(){return"kendoKDMultiLang"},createInnerDom:function(){return $('<div class="kd-mutilan-container">')},isContainKey:function(e,t){if(!e||0==e.length)return-1;for(var i=0;i<e.length;i++)if(!e[i].key==t)return i;return-1},getKendoOptions:function(){var e=this,t=KDMultiLangBoxProxy.superclass.getKendoOptions.call(this);return t.langs=ClientAppProxy.Current.getLocals(),t.defaultLang=ClientAppProxy.Current.defaultLocalId.toString(),t.maxLength=this.config.maxLength||void 0,t.FormTheme=this.getFormTheme(),t.height=KD.getValue(this.config,"height",e.elHeight),t.controlProxy=this,this.el[0]&&(t.width=parseInt(this.el[0].style.width)),t},onchange:function(e,t){this.commitValueToForm(t)},getCurrentLangId:function(){return this.component.data(this.getKendoCType()).currentLangID()},commitUITextToValue:function(e){for(var t=this.component.data(this.getKendoCType()).val(),i=this.getCurrentLangId(),a=0;a<t.length;a++)if(i==t[a].Key){t[a].Value=e;break}return t},asyncValueToUIText:function(e){try{this.component.data(this.getKendoCType())&&this.component.data(this.getKendoCType()).val&&this.component.data(this.getKendoCType()).val(e)}catch(t){}},validating:function(){return KDMultiLangBoxProxy.superclass.validating.call(this)},isEmpty:function(){var e=this.getValue(),t=ClientAppProxy.Current.defaultLocalId.toString();if(e&&e.length>0)for(var i=0;i<e.length;i++)if(e[i]&&e[i].Key+""==t+""&&!KD.isEmpty(e[i].Value))return!1;return!0},_getKendoControl:function(){var e=null;return e=this.component&&this.component.data(this.getKendoCType())},release:function(){var e=this.component&&this.component.data?this.component.data(this.getKendoCType()):void 0;e&&e.destroy(),KDMultiLangBoxProxy.superclass.release.call(this)},setBackColor:function(e){KDMultiLangBoxProxy.superclass.setBackColor.call(this,e),this.component&&this.component.find(".k-dropdown-wrap").css("background-color",e)},setForeColor:function(e){KDMultiLangBoxProxy.superclass.setForeColor.call(this,e),this.component&&this.component.find(".k-dropdown-wrap").css("color",e)}}),function(){$.extend(KDMultiLangBoxProxy.prototype,{isTakeEditCombox:void 0,showF8ClickButton:void 0,isFireImmediateChangedCustomEvent:void 0,setIsTakeEditCombox:function(e){var t=this;if(t.isTakeEditCombox=e,e&&this.component){var i=t._getKendoControl();i&&i._initEditComboxPopup.call(i,e)}},setShowF8ClickButton:function(e){if(this.showF8ClickButton=e,e){var t=this._getKendoControl();t&&t._initEditButton.call(t,2,e)}},setFireImmediateChangedCustomEvent:function(e){this.isFireImmediateChangedCustomEvent=e},fireImmediateChangedCustomEvent:function(e){if(this.isFireImmediateChangedCustomEvent){var t=this.getFormProxy();t&&t.fireCustomEvents.call(t,this.postKey,"Kingdee.BOS.EditValueChanged",KD.stringify(e))}},setStore:function(e){if(null!=e){var t=this._getEnumSource(e),i=this._getKendoControl();i&&i._setEditComboxDataSource(t)}},_getEnumSource:function(e){var t=[];if(e)for(var i=0;i<e.length;i++){var a=this._GetEnumItem(e[i]);t.push(a)}return t},_GetEnumItem:function(e){var t={};if(KD.isArray(e)){var i=e[0]||{};t={Key:i.Key,Value:i.Value}}else KD.isObject(e)?name=e:t={Key:"",Value:e};return t},_editor_DefaultButtonClick:function(e){if(this.showF8ClickButton){var t=this.getFormProxy();t&&t.fireEvent.call(t,"F7ButtonClick",this.postKey,KD.stringify(e),this.getRow())}}})}(),KDControlFactoryProxy.registerType("kdlangtextfield",KDMultiLangBoxProxy),KDControlFactoryProxy.registerType("kdlangtkpopupfield",KDMultiLangBoxProxy),KDMultiLangBoxProxy_Galaxy=KD.extend(KDMultiLangBoxProxy,{getKendoOptions:function(){var e=KDMultiLangBoxProxy_Galaxy.superclass.getKendoOptions.call(this);return e.FontSize=14,e},setItemContaonerStyle:function(e){this.elHeight||(this.elHeight=e>0?e/KD.getCurrentFontsize()+"em":"1.75em"),this.innerHeight||(this.innerHeight=e>0?(e-2)/KD.getCurrentFontsize()+"em":"1.58em"),this.component&&this.component.css({border:"0px",height:this.elHeight,"line-height":this.innerHeight})}}),KDControlFactoryProxy.registerType("kdlangtextfield_Galaxy",KDMultiLangBoxProxy_Galaxy),define("KDMultiLangBoxProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDMultiLangBoxProxy}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.KDPopListEdit,o=".kendoKDMultiLang",r="mousedown"+o,s=n.extend({options:{name:"KDMultiLang",autoBind:!0,buttonCls:"",pop:{origin:"bottom right",position:"top right",width:180},template:""},init:function(t,i){var a=this;n.fn.init.call(a,t,i);var o=a._getDefaultLang();a.currentLang=o.lang,a.options.value=a._getDefaultValue(),e(".k-icon",a.button).css({"background-image":"none","font-size":"12px","line-height":"16px",width:"20px"}).text(o.alias),a.input.change(function(e){var t=a.getInputValue();n.fn._change.call(a,e,t),a._oldText=t})},enable:function(e){var t=this;t.options.disabled=!e,e?(t.input.removeAttr("disabled"),t.options.showButton&&t.button.show().parent().css({"padding-right":""}),t.container&&t.container.removeClass("k-state-disabled")):(t.input.attr("disabled","disabled"),t.options.showButton&&t.button.parent().css({"padding-right":0}),t.container&&t.container.addClass("k-state-disabled"))},onInitDataListPanel:function(){for(var t=this,i=0;i<t.options.langs.length;i++){var a=t.options.langs[i],n="";$this.currentLang==a.lang&&(n="k-state-selected k-state-focused"),a.selectClass=n}t.dataView=e('<div unselectable="on">').appendTo(t.dataList),t.dataView.kendoListView({template:t._getItemTemplate(),dataSource:t.options.langs,selectable:!0,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._selectItem.call(t,e)}})},onButtonClick:function(e){var t=this;t.openPopup()},onKeyDown:function(e){var t=this;if(13==e.keyCode){if(!t.isPopup())return;e.sender=t.dataView.data("kendoListView"),t._selectItem(e)}},onKeyUp:function(e){var i=this;i.options.ispreventKeyUp||(40==e.keyCode&&i.openPopup(),i.rowIndex=!(i.rowIndex===t)&&i.rowIndex>=0&&i.rowIndex||0,(38==e.keyCode||40==e.keyCode)&&i._locationItem(e.keyCode))},onChange:function(e,t){var i=this;for(var a in i.options.value)if(a==i.currentLang){i.options.value[a]=t;break}},destroy:function(){var e=this,t=e.dataView&&e.dataView.data("kendoListView");t&&t.destroy(),n.fn.destroy.call(e)},currentLangID:function(){return this.currentLang},val:function(e){var i=this;if(!e){var a=[];for(var o in i.options.value)i.options.value[o]!=t&&a.push({Key:o,Value:i.options.value[o]});return a}if(e&&KD.isArray(e)&&0==e.length){for(var r in i.options.value)i.options.value[r]=null;e[0]={Key:i.currentLang,Value:""}}for(var s=0;s<e.length;s++){var l=e[s];i.options.value[l.Key]=l.Value}i._value={number:i.options.value[i.currentLang],name:i.options.value[i.currentLang]},n.fn.val.call(i,i._value.number)},coreValue:function(e){return this.input.val()},_selectItem:function(t){var i=this;if(!i.keyboardLocal){var a=t.sender.current();a&&a.length>0&&i.isPopup()&&i.focus().closePopup();var n=a&&a[0];e(".k-icon",i.button).text(e("em",n).text()),i._loadText(n.lang),i.options.selectItem&&i.options.selectItem(n)}},_locationItem:function(t){var i=this,a=i.dataView&&i.dataView.data("kendoListView");if(!KD.isEmpty(a)){i.rowIndex=a.dataItems("div").indexOf(a.dataItem(a.current())),38==t?i.rowIndex--:40==t&&i.rowIndex++;var n=e(i.dataView.find("li:eq("+i.rowIndex+")"));i.keyboardLocal=!0,a.current(n),i.keyboardLocal=!1}},_loadText:function(e){var t=this._getValidLangObj(e||this.currentLang);if(t){e=t.lang,this.currentLang=e;var i=this._getText(e)||"";this.getDisplayer().text(i).attr("title",i),this.input.val(i),this._oldText=i}},_getValidText:function(t){var i=this.options.maxlength;if(i&&t)if(e.isPlainObject(t))for(var a=this.options.langs,n=a.length,o=0;n>o;o++){var r=a[o].lang;t&&(t[r]=this._getValidText(t[r]))}else t=t.substr(0,i);return t},_getText:function(e){return this.options.value[e||this.currentLang]},_getDefaultLang:function(){var e=this.options.langs,t=ResManager.Language||this.options.defaultLang;return this._getValidLangObj(t)||e[0]},_getValidLangObj:function(e){for(var t=this.options.langs,i=0,a=t.length;a>i;i++)if(KD.equalsIgnoreCase(e,t[i].lang))return t[i];return null},_getDefaultValue:function(){for(var e=this.options.value,t=this.options.langs,i=t.length,a={},n=0;i>n;n++){var o=t[n].lang;e?a[o]=e[o]:a[o]=null}return a},_getItemTemplate:function(){var e=this,t="<li id='li_"+e.options.id+"_#: lang#' lang='#: lang#' class='k-item #: selectClass#'> <em class='ui-ExtMultiLangBox-trigger' style='text-align:left'>#: alias#</em><span style='padding-left:25px;'>#: text#</span></li>";return t},createDefButton:function(){var t=this;t.button=e('<span unselectable="on" class="k-select kd-editor-btn" style="border: none;cursor:pointer;" role="button"><span unselectable="on" class="k-icon '+t.options.buttonCls+'" style="right: 2px; border: none;">select</span></span>').appendTo(t.container),t.options.showButton||t.button.hide().parent().css({"padding-right":0}),t.button.on(r,function(e){return t.focus.call(t,e),t.onButtonClick(e),t.options.buttonClick&&t.options.buttonClick(e),!1})},_setEditComboxDataSource:function(t){var a=this,n=new i.data.DataSource({data:t});if(a.editComboxPopupobj)a.editComboxPopupobj&&(a.editComboxPopupobj.setDataSource(n),a.comboxpopupobj&&a.comboxpopupobj._position.call(a.comboxpopupobj));else{a.editComboxPopupcontainer=e('<div unselectable="on" class="k-list-scroller"></div>').appendTo(a.comboxpopup),a.editComboxPopupcontainerelement=e('<ul class="k-list k-reset"></ul>'),a.editComboxPopupcontainerelement.css({"max-height":a.editComboxPopupMaxheight,"overflow-y":"auto"}).appendTo(a.editComboxPopupcontainer);var o=a._getItemEditComboxTemplate();a.editComboxPopupcontainerelement.kendoListView({dataSource:n,template:o,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){var t=e.sender.dataItem(e.sender.current())||{};a._editComboxItemClick.call(a,t)}}),a.editComboxPopupobj=a.editComboxPopupcontainerelement.data("kendoListView")}},_getItemEditComboxTemplate:function(e){var t=i.format('<li tabindex="-1" role="option" unselectable="on" class="k-item"  id="{0}"><span title="{1}" tabindex="-1" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;">{1}</span></li>',"#:Key #","#:Value #");return t},_editComboxItemClick:function(e){var t=e||{};this.comboxpopupobj.close(),this.updateInput(t.Value),this.input.trigger("keyup"),this.input.trigger("focusout").focus()},_keydown:function(e){var t=this;t.getInputValue();t.onKeyDown(e),t.options.keydown&&t.options.keydown(e),27!=e.keyCode&&13!=e.keyCode||!t.isPopup()||t.closePopup()},_keyup:function(e){var t=this,i=t.getInputValue();if(13==e.keyCode&&t.fireChange(e,i),n.fn._keyup.call(this,e),this.comboxpopupobj){this.comboxpopupobj.open();var a=this.options.controlProxy;if(a&&a.isFireImmediateChangedCustomEvent){var o=this;KD.delayInvokeCore(function(){var e=o.getInputValue();if(o.lastSearchText!=e){o.lastSearchText=e;var t={text:e,value:o.val()};a.fireImmediateChangedCustomEvent.call(a,t)}},500)}}},_initEditButton:function(t,i){var a,n="",o=this;1==t?(n='<span unselectable="on" class="k-select kd-editor-btn" aria-label="select" style=""><span class="k-icon k-i-arrow-s" style=""></span></span>',a=e(n),a.click(function(e){o.comboxpopupobj&&o.comboxpopupobj.open()})):2==t&&(n='<span unselectable="on" class="k-select kd-editor-btn" style="" role="button"><span unselectable="on" class="k-icon k-i-search" style="">select</span></span>',a=e(n),a.click(function(e){var t=o.options.controlProxy,i=o.val();t&&t._editor_DefaultButtonClick.call(t,i)})),a&&(this.container.append(a),0==i&&a.hide(),this._setEditBtnPosition())},_setEditBtnPosition:function(){for(var t=this.container?this.container.find(".kd-editor-btn"):[],i=0,a=0;a<t.length;a++)if(a>0){var n=e(t[a]),o=e(t[a-1]),r=o.outerWidth();if(!n.is(":visible"))continue;i+=r,n.css({right:i+"px"}),a==t.length-1&&(i+=n.outerWidth())}i>0&&(this.input&&this.input.width(this.input.width()-r),this.displayer&this.displayer.width(this.displayer.width()-r))},_initEditComboxPopup:function(){var t=this;if(t.comboxpopupobj)return t.comboxpopupobj;var i=KD.layout.getActualWidth(this.element)>0?KD.layout.getActualWidth(this.element):null;t.editComboxPopupMaxheight=300,t.comboxpopup=e('<div unselectable="on" class="kd-dropdown-list-container" style="padding:1px;">').css({"min-width":i,"max-height":t.editComboxPopupMaxheight,"overflow-y":"auto"}),t.comboxpopup.appendTo(e("document.body")).hide();var a={anchor:t.container,close:function(e){},open:function(e){},activate:function(e){},deactivate:function(e){}};return t.options.pop&&t.options.pop.animation&&(a.animation=t.options.pop.animation),t.comboxpopupobj=t.comboxpopup.kendoPopup(a).data("kendoPopup"),this._initEditButton(1),t.comboxpopupobj}});a.plugin(s)}(window.kendo.jQuery),define("KDMultiLang",["KDPopListEdit","KD"],function(e){return function(){var t;return t||e.KDMultiLang}}(this)),KDMultiLangAreaProxy=KD.extend(KDMultiLangBoxProxy,{getKendoOptions:function(){var e=KDMultiLangAreaProxy.superclass.getKendoOptions.call(this);if(e.isTextArea=!0,e.isTrimDisplay=!1,this.el[0]){var t,i=parseFloat(this.el[0].style.height);KD.isNaN(i)?this.elHeight&&(i=this.elHeight+"",t=i.indexOf("em")>0?parseFloat(i)*KD.getCurrentFontsize():parseFloat(i),e.height=t):e.height=i+2}return e},focus:function(e){this.input&&(this.input.focus(),-1==this.focusSelectMode?this.setSelectionStart(this.SelectionStart):0==this.focusSelectMode||(1==this.focusSelectMode?this.setSelectionStart(0,!0):2==this.focusSelectMode||(3==this.focusSelectMode?(this.setSelectionStart(0,!0),this.input.select()):this.input.select())))},setFocusSelectMode:function(e){this.focusSelectMode=e},initComponent:function(){KDMultiLangBoxProxy.superclass.initComponent.call(this);var e=this,t=this._getKendoControl();t&&(this.input=t.getInput(),this.input&&this.input.blur(function(t){var i=KDGetCursorPositon.getSelectionIndex($(this)[0]);e.setSelectionStart(i,!0)}))},createInnerDom:function(){return $("<div>")},setDisabled:function(e){if(KDMultiLangAreaProxy.superclass.setDisabled.call(this,e),KD.isIeBrowser()){var t=this.el.find("textarea");e?t.removeAttr("disabled").attr("readonly",e):0!=this.editable&&t.removeAttr("readonly")}},updateStyle:function(e){if(e&&(e.height+=2,this.itemContainer&&this.itemContainer.el.find(".kdItemContainer_editorct").css("height",e.height)),this.el.css(e),this.component&&this.component.length){var t=this.component[0];t&&$(t).css(e)}}}),KDControlFactoryProxy.registerType("kdlangtextarea",KDMultiLangAreaProxy),KDMultiLangAreaProxy_Galaxy=KD.extend(KDMultiLangAreaProxy,{getKendoOptions:function(){var e=KDMultiLangAreaProxy.superclass.getKendoOptions.call(this);return e.isTextArea=!0,this.el[0]&&(e.height=parseFloat(this.el[0].style.height)),e},createInnerDom:function(){return $("<div>")}}),KDControlFactoryProxy.registerType("kdlangtextarea_Galaxy",KDMultiLangAreaProxy_Galaxy),define("KDMultiLangAreaProxy",["KDMultiLangBoxProxy","KDMultiLang","KD"],function(e){return function(){var t;return t||e.KDMultiLangAreaProxy}}(this)),KDDynamicTextProxy=KD.extend(KDTextEditorProxy,{_popupDiv:null,_data:null,tipDefault:kendo.format(ResManager.LoadKDString("输入{0}可以弹出变量选择框","014002030026212"),"{"),createControl:function(e){KDDynamicTextProxy.superclass.createControl.call(this,e)},loadConfig:function(e){this._popupDiv=null,this._data=null,KDDynamicTextProxy.superclass.loadConfig.call(this,e)},initComponent:function(){var e=this;KDDynamicTextProxy.superclass.initComponent.call(this),this.component=$(kendo.format("<textarea id='{0}_KDDynamicTextProxyInput' class='k-textbox' style='height: inherit;width: inherit; padding: 0px;border: none; text-indent: .33em; overflow-y:auto;'></textarea>",e.baseId)),this.config.maxLength&&this.component.attr("maxlength",parseInt(this.config.maxLength)),this.el.append(this.component),this.component.change(function(t){e.onchange(t,e.component.val())}),this._CreatePopup(),$("body").bind("click",function(t){e._ClosePopup(!1)}),this.component.blur(function(t){var i=t.relatedTarget||document.activeElement;(!i||"BODY"!=i.tagName&&i.id!=e.baseId+"_listView")&&e._ClosePopup(!1)}),this.component.keydown(function(t){if(!t.shiftKey||219!=t.keyCode&&229!=t.keyCode&&0!=t.keyCode)38==t.keyCode||40==t.keyCode?e._locationItem(t.keyCode):13==t.keyCode?e._getIsOpen()&&(e._onChange(t),t.preventDefault()):e._ClosePopup(!0);else{var i=$(this);KD.delayInvoke(function(){var t=KDGetCursorPositon.getSelectionIndex(i[0]),a=i.val().substring(t-1,t);"{"==a?e._ShowPopup():e._ClosePopup(!0)},20)}}),this.setTip()},asyncValueToUIText:function(e){e||(e=""),KD.isArray(e)?e.length>0&&this.component.val(e[0].Value):this.component.val(e)},commitUITextToValue:function(e){return KDDynamicTextProxy.superclass.commitUITextToValue.call(this,e)},_getDataFromJson:function(e){this.jsonObectArr=[];for(var t=0;t<e.length;t++){var i={};i.EntityName=e[t][0],i.FiledName=e[t][1],i.Name=e[t][2],i.EntityKey=e[t][3],i.ParticipantType=e[t][4],i.Key=e[t][5],this.jsonObectArr.push(i)}return this.jsonObectArr},setData:function(e){var t=this;this._data=this._getDataFromJson(e),this.listView&&$.isFunction(this.listView.remove)&&this.listView.remove(),this.listView=$(kendo.format('<div id="{0}_listView" style="max-height: 300px;overflow-y: auto;height: inherit;overflow-x: hidden;border:none;"></div>',this.baseId)),this.pager=$(kendo.format('<div id="{0}_pager" class="k-pager-wrap"></div>',this.baseId)),this.pager.kendoPager({dataSource:t._data}),this.listView.kendoListView({dataSource:t._data,selectable:!0,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._onChange(e)},template:'<div class="KDDynamicTextProxyproduct"><div class="EntityName">#:EntityName#</div><div class="spiltDiv"></div><div class="EntityKey"  title="#:Name#">#:Name#</div><div class="spiltDiv"></div><div class="Name">#:EntityKey#</div><div class="spiltDiv"></div> </div>'}),this._popupDiv.append(this.listView)},setDisabled:function(e){if(KDDynamicTextProxy.superclass.setDisabled.call(this,e),this.disabled?this.component.attr("disabled","disabled").addClass("k-state-disabled"):this.component.removeAttr("disabled").removeClass("k-state-disabled"),KD.isIeBrowser()){var t=this.el.find("textarea");e?t.removeAttr("disabled").attr("readonly",e):0!=this.editable&&t.removeAttr("readonly")}},setTip:function(e){var t=this.tipDefault;e&&e!=this.tipDefault&&(t+=e),this.component.attr("title",t)},_locationItem:function(e){var t=0,i=this;if(null!=i.listView&&void 0!=i.listView){var a=i.listView&&i.listView.data&&i.listView.data("kendoListView");if(null!=a&&void 0!=a&&a.element&&a.element.children&&a.element.children().length>0){t=a.dataItems("div").indexOf(a.dataItem(a.current()));var n=a.element.children()[t];$(n).css("background",""),38==e?0==t?t=a.dataItems("div").length-1:t--:40==e&&(t==a.dataItems("div").length-1?t=0:t++),n=a.element.children()[t],$(n).css("background","silver"),a.current($(n)),i.keyboardLocal=!1}}},_selectItem:function(){for(var e=this,t=this.listView.data("kendoListView").element.children(),i=0;i<t.length;i++)$(t[i]).css("background","");if(e.keyboardLocal){e.keyboardLocal=!1;var a=this.listView.data("kendoListView").current();this.listView.data("kendoListView").select(a)}},_onChange:function(e){var t=null;this.keyboardLocal=!1;var i=this.listView&&this.listView.data&&this.listView.data("kendoListView").current();if(i&&i.length>0)if(e.keyCode&&13==e.keyCode)this.keyboardLocal=!0,$this.pressEnter=!0,this._selectItem();else{t=i.find(".EntityKey");var a=this.component.val();a=a+$(t).text()+"}",this.component.val(a),this.onchange(null,a),this._ClosePopup(!0)}},_CreatePopup:function(){var e=this;this._popupDiv=$(kendo.format('<div id="{0}" class="KDDynamicTextProxyDiv kendo-background-color  kendo-border-color" style="z-index: 10300;"  hidden="hidden"></div>',this.baseId)),this._popupDiv.mousedown(function(t){e._getIsOpen()||e._ShowPopup()}),$("body").append(this._popupDiv)},_getIsOpen:function(){return this._popupDiv?"block"==this._popupDiv.css("display"):!1},_ShowPopup:function(){if(this._popupDiv){var e=KDGetCursorPositon.getInputPositon($(this.component));e.bottom<=this.component.offset().top+this.component.height()?this._popupDiv.css("top",e.bottom+"px"):this._popupDiv.css("top",this.component.offset().top+this.component.height()+"px"),this._popupDiv.css("left",e.left+"px"),this._popupDiv.removeAttr("hidden","hidden")}},_ClosePopup:function(e){this._popupDiv.attr("hidden","hidden"),this.component&&e&&this.component.focus()},release:function(){$("#KDGetCursorPositon"+this.baseId+"_KDDynamicTextProxyInput").remove(),$(this._popupDiv).remove(),KDDynamicTextProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kddynamictextfield",KDDynamicTextProxy),define("KDDynamicTextProxy",["KDTextEditorProxy","KD"],function(e){return function(){var t;return t||e.KDDynamicTextProxy}}(this)),KDMultilingualDynamicTextProxy=KD.extend(KDTextEditorProxy,{select:null,component:null,isMultiLang:!0,tipDefault:kendo.format(ResManager.LoadKDString("输入{0}可以弹出变量选择框","014002030026212"),"{"),createControl:function(e){KDMultilingualDynamicTextProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDMultilingualDynamicTextProxy.superclass.loadConfig.call(this,e),this.baseId=this.getBaseId(),this.sid=this.baseId+"gridPanel"},initComponent:function(){KDMultilingualDynamicTextProxy.superclass.initComponent.call(this);var e=this;this.component=$(kendo.format("<span id='{0}_KDMultilingualDynamicTextProxy' class='k-textbox kendo-font-family' style=\"width: 100%;\" ></span>",e.baseId)),this.el.append(this.component),this.component[this._getKendoCType()](this._getKendoOptions()),this.input=e._getKendoDom().getInput(),this.input.change(function(t){e._getKendoDom().isChanged=!1,e.onchange(t,e._getKendoDom().val())}),this.initSelect(),$("body").bind("click",function(t){e.setIsOpen(!1)}),this.input.blur(function(t){var i=t.relatedTarget||document.activeElement;(!i||"BODY"!=i.tagName&&i.id!=e.baseId+"_listView")&&e.onBlur(t)}),this.input.keydown(function(t){if(!t.shiftKey||219!=t.keyCode&&229!=t.keyCode&&0!=t.keyCode)!e.getIsOpen()||38!=t.keyCode&&40!=t.keyCode?e.getIsOpen()&&13==t.keyCode?(t.preventDefault(),e._onChange(t)):e.setIsOpen(!1):(t.preventDefault(),e._locationItem(t.keyCode));else{var i=$(this);KD.delayInvoke(function(){var t=KDGetCursorPositon.getSelectionIndex(i[0]),a=i.val().substring(t-1,t);"{"==a?e.setIsOpen(!0):e.setIsOpen(!1)},20)}}),this.setTip()},_getKendoCType:function(){return"kendoKDMultiLang"},_getKendoOptions:function(){var e=KDMultilingualDynamicTextProxy.superclass.getKendoOptions.call(this);return e.langs=ClientAppProxy.Current.getLocals(),e.defaultLang=ResManager.Language,e.maxLength=this.config.maxLength||void 0,e.isTextArea=!0,e.ispreventKeyUp=!0,e.isNeedAutoTip=!1,e=$.extend(e,this.getConfig()),this.el[0]&&(e.width=parseInt(this.el[0].style.width)),e},_getKendoDom:function(){return this.component.data(this._getKendoCType())},_getCurrentLangId:function(){return this._getKendoDom().currentLangID()},asyncValueToUIText:function(e){if(e||(e=""),KD.isArray(e))this.isMultiLang=!0,e.length>0&&this._getKendoDom().val(e);else if(KD.isString(e)){this.isMultiLang=!1;var t=[],i={Key:this._getCurrentLangId(),Value:e};t.push(i),this._getKendoDom().val(t)}},commitUITextToValue:function(e){return KDMultilingualDynamicTextProxy.superclass.commitUITextToValue.call(this,this._getKendoDom().val())},setDisabled:function(e){if(KDMultilingualDynamicTextProxy.superclass.setDisabled.call(this,e),this._getKendoDom().enable(!e),this.disabled?(this.input&&this.input.attr("disabled","disabled"),this.component.find(".k-dropdown-wrap").addClass("k-state-disabled")):(this.input&&this.input.removeAttr("disabled"),this.component.find(".k-dropdown-wrap").removeClass("k-state-disabled")),KD.isIeBrowser()){var t=this.el.find("textarea");e?(t.removeAttr("disabled").attr("readonly",e),!KD.isEmpty(this.EmptyTip)&&KD.isEmpty(this._val)?t.css("color","#8f8f8f"):t.css("color","inherit")):0!=this.editable&&t.removeAttr("readonly")}},initSelect:function(){var e=this,t=this.sid;$("#"+t).remove();var i="position:absolute;display:none;",a="<div class='KDDynamicTextProxyDiv kendo-background-color kdItemContainer_editorct kendo-border-color' style='z-index: 10300;"+i+"'";a+="id='"+t+"'>",a+="</div>",this.select=$(a),this.select.mousedown(function(t){e.getIsOpen()||e.setIsOpen(!0)}),$("body").append(this.select)},setItemContaonerStyle:function(e){this.component&&this.component.css({width:"100%",border:"0px",height:e,"line-height":"1.8em"})},setTip:function(e){var t=this.tipDefault;e&&e!=this.tipDefault&&(t+=e);var i=this._getKendoDom();i.displayer.attr("title",t),i.input.attr("title",t)},setData:function(e){var t=this;this._data=this._getDataFromJson(e),this.listView&&$.isFunction(this.listView.remove)&&this.listView.remove(),this.listView=$(kendo.format('<div id="{0}_listView" style="max-height: 300px;overflow-y: auto;height: inherit;overflow-x: hidden;border:none;"></div>',this.baseId)),this.pager=$(kendo.format('<div id="{0}_pager" class="k-pager-wrap"></div>',this.baseId)),this.pager.kendoPager({dataSource:t._data}),this.listView.kendoListView({dataSource:t._data,selectable:!0,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._onChange(e)},template:'<div class="KDDynamicTextProxyproduct"><div class="EntityName">#:FiledName#</div><div class="spiltDiv"></div><div class="EntityKey"  title="#:Name#">#:Name#</div><div class="spiltDiv"></div><div class="Name">#:EntityName#</div><div class="spiltDiv"></div> </div>'}),this.select.append(this.listView)},_getDataFromJson:function(e){this.jsonObectArr=[];for(var t=0;t<e.length;t++){var i={};i.EntityName=e[t][0],i.FiledName=e[t][1],i.Name=e[t][2],i.EntityKey=e[t][3],i.ParticipantType=e[t][4],i.Key=e[t][5],this.jsonObectArr.push(i)}return this.jsonObectArr},getIsOpen:function(){return this.select?"block"==this.select.css("display"):!1},setIsOpen:function(e){if(this.select){if(e){var t=KDGetCursorPositon.getInputPositon($(this.input));t.bottom<=this.component.offset().top+this.component.height()?this.select.css("top",t.bottom+"px"):this.select.css("top",this.component.offset().top+this.component.height()+"px"),this.select.css("left",t.left+"px")}this.select.css("display",e?"block":"none")}},onFocus:function(e){this.editable||this.setIsOpen(!1),this.getIsOpen()||"219"!=e.keyCode||this.setIsOpen(!0)},onBlur:function(e){this.getIsOpen()&&this.setIsOpen(!1)},_locationItem:function(e){var t=0,i=this;if(null!=i.listView&&void 0!=i.listView){var a=i.listView&&i.listView.data&&i.listView.data("kendoListView");if(null!=a&&void 0!=a&&a.element&&a.element.children&&a.element.children().length>0){t=a.dataItems("div").indexOf(a.dataItem(a.current()));var n=a.element.children()[t];$(n).css("background",""),38==e?0==t?t=a.dataItems("div").length-1:t--:40==e&&(t==a.dataItems("div").length-1?t=0:t++),n=a.element.children()[t],$(n).css("background","silver"),a.current($(n)),i.keyboardLocal=!1}}},_selectItem:function(){for(var e=this,t=this.listView.data("kendoListView").element.children(),i=0;i<t.length;i++)$(t[i]).css("background","");if(e.keyboardLocal){e.keyboardLocal=!1;var a=this.listView.data("kendoListView").current();this.listView.data("kendoListView").select(a)}},_onChange:function(e){var t=null;this.keyboardLocal=!1;var i=this.listView&&this.listView.data&&this.listView.data("kendoListView").current();if(i&&i.length>0)if(e.keyCode&&13==e.keyCode)this.keyboardLocal=!0,this._selectItem();else{t=i.find(".EntityKey");for(var a=this._getKendoDom().val(),n=0;n<a.length;n++)a[n].Key==this._getCurrentLangId()&&(a[n].Value=a[n].Value+$(t).text()+"}");this._getKendoDom().val(a),this.onchange(null,a),this.setIsOpen(!1),this.input.focus()}},release:function(){$("#KDGetCursorPositon"+this.baseId+"_KDMultilingualDynamicTextProxy").remove(),$(this.select).remove(),KDMultilingualDynamicTextProxy.superclass.release.call(this)},setBackColor:function(e){this.component&&this.component.find(".k-dropdown-wrap").css("background-color",e)},setForeColor:function(e){this.component&&this.component.find(".k-dropdown-wrap").css("color",e)}}),KDControlFactoryProxy.registerType("kdmultilingualdynamictext",KDMultilingualDynamicTextProxy),define("KDMultilingualDynamicTextProxy",["KDTextEditorProxy","KDGetCursorPositon","KD"],function(e){return function(){var t;return t||e.KDMultilingualDynamicTextProxy}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.Widget,o=n.extend({_uid:null,inputEl:null,labelEl:null,init:function(t,a){var o=this;o._uid=i.guid()+"_checkbox",n.fn.init.call(this,t,a),o.inputEl=e("<input>"),o.inputEl.attr("type","checkbox"),o.inputEl.addClass("k-checkbox"),o.inputEl.id&&""!=o.inputEl.id||(o.inputEl.id=o._uid,o.inputEl.attr("id",o._uid)),o.inputEl.change(function(e){if(a.change){var t=o.inputEl.prop("checked");a.change.call(this,e,t)}}),o.labelEl=e(i.format("<label id='l_{0}' class='k-checkbox-label' for='{0}'>{1}</label>",o.inputEl.id,a.label)),
e(t).append(o.inputEl).append(o.labelEl)},options:{name:"CheckBox",label:""},value:function(e){var i=this;e!=t&&(KD.isString(e)&&(e=KD.equalsIgnoreCase(e,"true")),i.inputEl.prop("checked",e));var a=i.inputEl.prop("checked");return a},enable:function(e){return e!=t&&this.inputEl.attr("disabled",!e),!this.inputEl.attr("disabled")}});a.plugin(o)}(window.kendo.jQuery),define("KDCheckBox",["KD"],function(e){return function(){var t;return t||e.KDCheckBox}}(this)),KDCheckBoxProxy=KD.extend(KDEditorProxy,{getKendoOptions:function(e){var t=this,i=KDCheckBoxProxy.superclass.getKendoOptions.call(this,e);return i.change=function(e,i){if(1==t.isInit){var a=e&&e.currentTarget,n=$(a);return void(n&&n.length>0&&n[getPropName()]("checked",!i))}var o=void 0===i?$.isFunction(this.value)&&this.value()||"":i;return $.isFunction(t.getChangingValue)&&(o=t.getChangingValue.call(t,e,i)),t.onfilterchange&&null!=t.onfilterchange?(t.onfilterchange(e,o),void(t._value=o)):void(t.columnDescriptor?t.columnDescriptor.onchange.call(t.columnDescriptor,e,o,t.rowDataModel):t.onchange.call(t,e,o))},$.extend(i,{label:t.config.labelText}),i},updateStyle:function(e){e&&e.width&&(delete e.width,KDCheckBoxProxy.superclass.updateStyle.call(this,e))},setInlineStyle:function(e){e&&e.width&&delete e.width,this.InlineStyle&&this.InlineStyle.width&&delete this.InlineStyle.width,KDCheckBoxProxy.superclass.setInlineStyle.call(this,e)},initComponent:function(){KDCheckBoxProxy.superclass.initComponent.call(this),this.el.addClass("kd-div-checkbox-setpadding").css("width","inherit")},asyncValueToUIText:function(e){this.component.data(this.getKendoCType()).value(e),this._changeItemContainerSize(this._getEditorctItemContainer())},commitUITextToValue:function(e){return KDCheckBoxProxy.superclass.commitUITextToValue.call(this,this.component.data(this.getKendoCType()).value(e))},createInnerDom:function(){return $("<div></div>")},setToolTip:function(e){if(this.tooltip=e,this.component){var t=(KD.htmlUtil.encode(e)||"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");$(".k-checkbox-label",this.el).attr("title",t)}},_changeItemContainerSize:function(e){if(e&&e.length>0&&this.component){var t=this.component.find(".k-checkbox-label"),i=this.component.find(".k-checkbox"),a=t.css("font-family").replace('"',"").split(","),n=$(kendo.format('<span id="{0}" class="kd-cloneDom-position" style="font-size:{1};font-family:{2};{3}">{4}</span>',t.attr("id")+"_clone",t.css("font-size"),a&&a[0]||"",t.attr("style"),t.text()));$("body").append(n);var o=parseInt(t.css("padding-left"));isNaN(o)&&(o=0);var r=parseInt(t.css("padding-right"));isNaN(r)&&(r=0);var s=i.width()>o?i.width()-o:0,l=n[0].offsetWidth+o+r+s+5;if(e.css({width:l}),t.height()>20)for(var d=0;5>d&&(l+=5,e.css({width:l}),t.height()>20);d++);this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.css({width:"auto"}),n.remove()}},_getEditorctItemContainer:function(){var e;return e=this.itemContainer?this.itemContainer.el.find(".kdItemContainer_editorct"):$("#"+this.getConfig().id+"_P").length>0?$("#"+this.getConfig().id+"_P"):this.el.closest("td .kdItemContainer_editorct")},setItemContaonerStyle:function(e){var t=this._getEditorctItemContainer();t&&t.length>0&&(t.css({"min-height":"1.58em",width:t.width()-8}),this._changeItemContainerSize(t))},getKendoCType:function(){return"kendoCheckBox"}}),KDControlFactoryProxy.registerType("kdcheckbox",KDCheckBoxProxy),define("KDCheckBoxProxy",["KDEditorProxy","KDCheckBox","KD"],function(e){return function(){var t;return t||e.KDCheckBoxProxy}}(this)),KDRadioButtonProxy=KD.extend(KDEditorProxy,{createControlDom:function(){var e=kendo.format('<div><input type="radio" id="radio_{0}" name="{3}" value="{2}" class="k-radio"><label class="k-radio-label" id="label_{0}" for="radio_{0}">{1}</label></div>',this.baseId,this.config.labelText,this.inputValue,this.getPageId()+this.groupName);return $(e)},createControl:function(e){this.rendered=!1,this.config=e,this.groupName=this.config.name,this.inputValue=this.config.inputValue,this.isDynamicCreated=e&&e.isDynamicCreated,this.el=this.createControlDom(),this.el.dock=this.config.dock,KD.setAttachmentData(this.el,e),this.el.proxy=this;var t=this;return this.el.change(function(){t.commitValueToForm.call(t)}),this.el},initComponent:function(){KDRadioButtonProxy.superclass.initComponent.call(this),this.el.css("width","inherit"),this.el.addClass("kd_rbtn_default")},_changeItemContainerSize:function(e){if(e&&e.length>0&&this.el){var t=this.el.find(".k-radio-label"),i=this.el.find(".k-radio"),a=t.css("font-family").replace('"',"").split(","),n=$(kendo.format('<span id="{0}" class="kd-cloneDom-position" style="font-size:{1};font-family:{2};{3}">{4}</span>',t.attr("id")+"_clone",t.css("font-size"),a&&a[0]||"",t.attr("style"),t.text()));$("body").append(n);var o=parseInt(t.css("padding-left"));isNaN(o)&&(o=0);var r=parseInt(t.css("padding-right"));isNaN(r)&&(r=0);var s,l=i.width()>o?i.width()-o:0;if(s=KD.isIeBrowser()?t.prevObject[0].offsetWidth+7:e.prevObject[0].offsetWidth,7>=s&&(s=n[0].offsetWidth+o+r+l+5),e.css({width:s}),t.height()>20)for(var d=0;5>d&&(s+=5,e.css({width:s}),t.height()>20);d++);this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.css({width:"auto"}),n.remove()}},_getEditorctItemContainer:function(){var e;return e=this.itemContainer?this.itemContainer.el.find(".kdItemContainer_editorct"):$("#"+this.getConfig().id+"_P").length>0?$("#"+this.getConfig().id+"_P"):this.el.closest("td .kdItemContainer_editorct")},validating:function(){return!0},getValue:function(){return this.inputValue},setDisabled:function(e){KDRadioButtonProxy.superclass.setDisabled.call(this,e),this.disabled?this.el.find("input").attr("disabled","disabled"):this.el.find("input").removeAttr("disabled")},commitValueToForm:function(e){if(!this.isInit){var t={key:this.groupName,row:this.getRow(),value:this.inputValue};this.fireUpdate?this.getFormProxy().fireEvent("UpdateValue",t.key,t.value,t.row):this.getFormProxy().storeData(t.key,t.value,t.row)}},asyncValueToUIText:function(e){var t=this.el.find("input");if(e)t.attr("checked","checked"),t.prop("checked",!0);else{var i=t.clone();t.removeAttr("checked"),i.hide(),i.appendTo(this.el),i.remove()}this._changeItemContainerSize(this._getEditorctItemContainer())},setItemContaonerStyle:function(e){var t=this._getEditorctItemContainer();t&&t.length>0&&this._changeItemContainerSize(t)}}),KDControlFactoryProxy.registerType("kdradio",KDRadioButtonProxy),define("KDRadioButtonProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDRadioButtonProxy}}(this)),KDFileUploadProxy=KD.extend(KDEditorProxy,{MultiUpload:!1,CtrlType:!1,SeverPath:null,MaxFileLength:0,UploadFilter:null,ServerCustomUploading:!0,uploadFileListTargetId:null,uploadUlFileListTargetId:null,ExtandUrl:"",ExDownLoadUrl:"",isFileServer:!1,fileuploadIngStatus:"kd-fileupload-ing-status",rowDataModel:null,currentUploadPercent:0,getType:function(){return"KDFileUploadProxy"},loadConfig:function(e){KDFileUploadProxy.superclass.loadConfig.call(this,e),this.CtrlType=1==KD.getValue(e,"ctrltype",0),this.MultiUpload=1==KD.getValue(e,"canmulselect",0),this.SeverPath=KD.getValue(e,"serverpath",null),this.SeverPath=KD.getValue(e,"serverPath",this.SeverPath),this.isFileServer=KD.getValue(e,"isfileserver",!1),this.MaxFileLength=KD.getValue(e,"maxsize",this.MaxFileLength),this.MaxFileLength=KD.getValue(e,"maxSize",this.MaxFileLength);var t=KD.getValue(e,"filter",this.UploadFilter);this.ServerCustomUploading=KD.getValue(e,"customuploading",!0),this.uploadFileListTargetId="uploadFileListTargetId-"+this.baseId+KD.getValue(e,"uploadFileListTargetId",""),this.uploadUlFileListTargetId="uploadUlFileListTargetId-"+this.baseId+KD.getValue(e,"uploadUlFileListTargetId",""),this.ExtandUrl=KD.getValue(e,"extandurl",""),this.ExtandUrl=KD.getValue(e,"exExtandUrl",this.ExtandUrl),this.UpUrl=KD.getValue(e,"upurl",""),this.setExtandUrl(this.ExtandUrl),this.ExDownLoadUrl=KD.getValue(e,"exdownloadurl",""),this.ExDownLoadUrl=KD.getValue(e,"exDownloadUrl",this.ExDownLoadUrl),this.IsCanDownland=KD.getValue(e,"iscandownland",!0),this.IsCanOnlineView=KD.getValue(e,"iscanonlineview",!0),this.setExDownLoadUrl(this.ExDownLoadUrl),this.defaultUploadServer=KD.getUrlRoot()+"/FileUpLoadServices/FileUpload.ashx",this.setExtandUrl(this.ExtandUrl),this.setUpUrl(this.UpUrl),this.setUploadFilter(t,!0)},initComponent:function(){var e=this;KDFileUploadProxy.superclass.initComponent.call(this),this.component=$(kendo.format('<div id="component_{0}" type="text" class="k-textbox" aria-haspopup="true" tabindex="-1"  style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;border: 0px; height: {1};line-height: {1};width: {2}px;" aria-disabled="false"></div>',this.baseId,this.innerHeight||"1.58em",this.el.width()-16)),this.component.click(function(t){e.setIsOpen(0==e.getIsOpen())}),this.el.append(this.component),this.el.parent().hasClass("kdItemContainer_editorct")?this.el.css("height","inherit"):(this.el.addClass("kdItemContainer_editorct"),this.el.css("height",this.component.css("height")),this.el.css("width",this.component.width()+19)),this.CtrlType&&this.setItemContaonerStyle(this.config.height?this.config.height:21)},_initFileListContainer:function(e){if(this.component&&!($("#"+this.uploadFileListTargetId).length>0)){var t=this;t.preventDocumentDragAction=function(e){e.preventDefault()},this.el.off("dragleave drop dragenter dragover").on({dragleave:t.preventDocumentDragAction,drop:t.preventDocumentDragAction,dragenter:t.preventDocumentDragAction,dragover:t.preventDocumentDragAction}),this.el[0].addEventListener("drop",function(e){if(!t.getDisabled()&&!KD.isEmpty(e)){var i=e.dataTransfer.files;if(!t.MultiUpload&&i&&i.length>1){var a=t.getFormProxy(),n=ResManager.LoadKDString("文件服务器只支持单个文件上传，请选择拖入单个文件进行上传！","00215181000017382");return void(a&&a.showErrMsgStr.call(a,n))}t._uploadloader.UpLoadAiles(e)}},!1);var i="position:absolute;display:none;overflow-y:auto;";this.fileNameDiv=$(kendo.format('<div id="{0}"  class="KDDynamicTextProxyDiv kendo-background-color kdItemContainer_editorct kendo-border-color k-animation-container" style="{1}">',this.uploadFileListTargetId,i)),this.fileNameUl=$(kendo.format('<table id="{0}" class="ui-multiselect-checkboxes ui-helper-reset ui_fileupload_filelist"  tabindex="-1"  style="width:100%;max-height: 300px;table-layout:fixed;border:0;margin:0;border-collapse:collapse;">',this.uploadUlFileListTargetId)),this.fileNameDiv.append(this.fileNameUl),this.autoClosePopup=function(e){if(0==$("body").find(t.component).length)return void t.release.call(t);var i=t.getIsOpen();if(i){var a=e.target,n=!1;a&&(a.id==t.uploadFileListTargetId||a.id==t.uploadUlFileListTargetId||t.fileNameDiv.find(a).length>0||t.component[0].id==a.id||$(a).hasClass("kdfileupload_file_del"))&&(n=!0);var o=$("body").find(t.component).length>0;o?n||t.setIsOpen(n):t.release()}},$("body").bind("click",this.autoClosePopup),$("body").append(this.fileNameDiv);var a=$("#ui-multiselect-btn-"+this.baseId+"_c");this.CtrlType?a.css({width:this.config.width-26,height:e-1}):a.css({width:this.config.width-26,border:"0px",height:e-1}),a.find(".ui-multiselect-label").css({width:"auto","float":"left"}),a.find(".ui-icon-triangle-2-n-s").remove();var n='<div class="ui_kdfilebt" title='+ResManager.LoadKDString("点击添加上传文件","0025710030032333")+'><input tabindex="0" kdrole="kduploadfile" type="file" accept="'+this._formatFileType().join(",")+'" name="fileselect[]" size="28" ';this.MultiUpload&&(n+="multiple"),n+="/>";var o=$(n);this.el.append(o)}},setItemContaonerStyle:function(e){if(this.component&&!($("#"+this.uploadFileListTargetId).length>0)){var t=this;t._initFileListContainer(e);var i={fileInputButton:t.el.find("[kdrole='kduploadfile']"),uploadFileListTargetId:t.uploadFileListTargetId,uploadUlFileListTargetId:t.uploadUlFileListTargetId,rowDataModel:t.rowDataModel,url:KD.isEmpty(t.ExtandUrl)?t.defaultUploadServer:t.ExtandUrl,UpUrl:KD.isEmpty(t.UpUrl)?"":t.UpUrl,maxFileLength:t.MaxFileLength<0?0:t.MaxFileLength,auto:!0,fileTypeExts:t.UploadFilter,multi:t.MultiUpload,disable:t.disable,isCanDownland:t.IsCanDownland,isCanOnlineView:t.IsCanOnlineView,isfileserver:t.isFileServer,onUploadError:function(e,i,a,n,o){var r=t.getFormProxy();if(null!=r)if(1==n){var s=(KD.isEmpty(this.ExtanUrl)?KD.getUrlRoot():this.ExtandUrl,ResManager.LoadKDString("上传附件失败，请检查文件服务相关配置！","0025710000005137"));r.showErrMsgStr.call(r,s,a)}else o&&o.hasFileExceed?KDMessageBox.show({type:KDMessageBox.KDMesBoxType.Error,button:KDMessageBox.KDMessageBoxButtons.Yes,msg:a,extraEl:o.limitTipsEl}):r.showErrMsgStr.call(r,a);else KD.Error.raise({msg:a})},onFileItemsChanged:function(e){if(e.newfiles&&0==e.newfiles.length)KD.setHtml(t.getDisplayLabel(),ResManager.LoadKDString("请选择文件","099002000000026"));else{var i=e.option.isfileserver;if(e.newfiles){var a=!i&&(!t.MultiUpload||t.MultiUpload&&1==e.newfiles.length);if(a&&t.MultiUpload){for(var n=0;n<e.newfiles.length;n++)if(e.newfiles[n].length>1){a=!1;break}}else a=t.MultiUpload||i;if(a){var o="";e.newfiles.length>0&&(o=e.target.getFrestFile(e.newfiles[0]).name,KD.isEmpty(o)&&(o='<div class="kd-fileupload-notfilename-mark"></div>')),KD.setHtml(t.getDisplayLabel(),o)}else{for(var r=0,n=0;n<e.newfiles.length;n++)r+=e.newfiles[n].length;var s="";if(1===r){var l=e.newfiles[0][0].name;s=KD.isEmpty(l)?'<div class="kd-fileupload-notfilename-mark"></div>':l+"（"+t._formatFileSize(e.newfiles[0][0].size)+")"}else s=kendo.format(ResManager.LoadKDString("共添加附件{0}个","099002000000027"),r);KD.setHtml(t.getDisplayLabel(),s)}}}e.isdeletefile&&t.onchange.call(t,e,e.newfiles),t._setUploadProgressVisible.call(t,!1)},onFileItemDoubleClick:function(e){if(0!=t.IsCanDownland){var i=t.getFormProxy();if(i){var a={row:t.getRow(),ServerFileName:e.file.ServerFileName};i.fireCustomEvents.call(i,t.postKey,"FileDownland",KD.stringify(a))}t.setIsOpen(!1)}},onFileItemClick:function(e){if("Downland"==e.action){var i={target:e.target,option:e.option,file:e.actionfile};this.onFileItemDoubleClick(i)}else if("OnlineView"==e.action){var a={row:t.getRow(),ServerFileName:e.actionfile.ServerFileName},n=t.getFormProxy();n&&n.fireCustomEvents.call(n,t.postKey,"FilePreview",KD.stringify(a)),t.setIsOpen(!1)}},onProgress:function(e,i,a){t._setUploadProgressVisible.call(t,!0,e,i,a,this.rowDataModel)},onFileStateChanged:function(e){var i=e.target.fileState,a=t.getFormProxy();if(a){var n={State:e.state};if(KD.isEmpty(t.columnDescriptor)||(n.row=t.getRow()),t.ServerCustomUploading||e.state!=i.Uploading)if(e.state==i.Uploaded)var o=setTimeout(function(){a.fireCustomEvents.call(a,t.postKey,"StateChanged",KD.stringify(n)),clearTimeout(o)},500);else a.fireCustomEvents.call(a,t.postKey,"StateChanged",KD.stringify(n))}e.state==i.Uploaded&&t.onchange.call(t,e,e.uploadedfiles,this.rowDataModel)}};KD.isEmpty(t.ExDownLoadUrl)||(i.downlandurl=t.ExDownLoadUrl);var a=this.getUploadloaderOptions(i);this._uploadloader=new KDFileUpLoader(a)}},getUploadloaderOptions:function(e){return e},asyncValueToUIText:function(e){if(e&&"object"!=typeof e&&e.trim&&(e=e.trim()),KD.isEmpty(e)||KD.isObject(e)&&!e.NewValue||!this._uploadloader||this._uploadloader&&!this._uploadloader.Fileupinfo)KD.setHtml(this.getDisplayLabel(),ResManager.LoadKDString("请选择文件","099002000000026")),this._uploadloader&&this._uploadloader.Fileupinfo&&this._uploadloader.Fileupinfo.DisplayFile([]),this.el.find('.ui_kdfilebt input[type="file"]').val("");else if(this._uploadloader.Fileupinfo){var t=e.NewValue?e.NewValue:e;if(KD.isString(e)){var i=e.split(",");t=[],$.each(i,function(e){t.push({FileName:"",ServerFileName:i[e],FileBytesLength:0})})}KD.isArray(t)&&$.each(t,function(){this.isInitView=!0}),this._uploadloader.Fileupinfo.DisplayFile(t)}},onchange:function(e,t,i){var a=this.getFile(t),n=this.getFormProxy(),o=e.target.fileState;if((this.CtrlType||!this.fireUpdate)&&n){var r={};if(r.OldValue=this.oldValue,r.NewValue=a,e.state&&e.state==o.Fail&&e.option.isfileserver&&(r.isfileservererror=!0),!KD.isEmpty(r.NewValue)||0==r.NewValue.length&&r.OldValue&&r.OldValue.length>0){var s=this.getKey();KD.delayInvoke(function(){n.fireCustomEvents.call(n,s,"FileChanged",KD.stringify(r))},200)}}this.oldValue=a;var l=this._getFileLength(t);l>=2?KD.setHtml(this.getDisplayLabel("",i||this.rowDataModel),kendo.format(ResManager.LoadKDString("共添加附件{0}个","099002000000027"),l)):KD.setHtml(this.getDisplayLabel("",i||this.rowDataModel),t&&l>0&&t[0]&&t[0].name?t[0].name:kendo.format(ResManager.LoadKDString("共添加附件{0}个","099002000000027"),l)),this.columnDescriptor?(this.columnDescriptor.onchange.call(this.columnDescriptor,e,a,i||this.rowDataModel),this.setValue(a)):this.commitValueToForm(a)},getIsOpen:function(){return this.fileNameDiv?"block"==this.fileNameDiv.css("display"):!1},setIsOpen:function(e){if(this.fileNameDiv){if(e){var t=304;this.fileNameUl&&0==this.fileNameUl.children().length&&(t=this.el.width()),this.fileNameDiv.css("width",this.el.width()),this.fileNameDiv.css("minWidth",t+"px");var i=this.component.offset();this.fileNameDiv.css("top",i.top+this.component.height()+"px"),i.left+t>=KD.getWindowWidth()?this.fileNameDiv.css({left:"none",right:"0px"}):this.fileNameDiv.css("left",i.left+"px")}if(this.fileNameDiv.css("display",e?"block":"none"),e){var a=this.fileNameDiv.find(".kd-ui-file-command-container").outerWidth(),n=this.fileNameDiv.find(".kd-ui-file-logo-container").outerWidth(),o=this.fileNameDiv.width(),r=o-a-n-5;r=r>0?r+"px":"auto",this.fileNameDiv.find(".ui_kdfilename").css("width",r)}}},_getFileLength:function(e){var t=0;if(!KD.isEmpty(e))for(var i=0;i<e.length;i++)t+=KD.isArray(e[i])?e[i].length:1;return t},_setUploadProgressVisible:function(e,t,i,a,n){var o=this.getDisplayUploadProgressLabel(n);if(0==e&&o)o.removeClass(this.fileuploadIngStatus),this.currentUploadPercent=0,o.css({"background-size":"auto"});else if(o&&i&&a)if(i>=a)o.removeClass(this.fileuploadIngStatus),this.currentUploadPercent=0,o.css({"background-size":"auto"});else{o.addClass(this.fileuploadIngStatus);var r=i/a*100;r<this.currentUploadPercent?r=this.currentUploadPercent:this.currentUploadPercent=r,o.css({"background-size":kendo.format("{0} 100%",r.toFixed(2)+"%")})}},getFile:function(e){var t=(this._uploadloader.GetOption.call(this._uploadloader).isfileserver||!1,[]);return e&&0!=e.length?($(e).each(function(e){if(this.length)for(var i=0;i<this.length;i++){var a=this[i],n={FileName:a.name,ServerFileName:a.ServerFileName,FileLength:Math.round((a.size+1023)/1024),FileBytesLength:a.size};t.push(n)}else{var n={FileName:this.name,ServerFileName:this.ServerFileName,FileLength:Math.round((this.size+1023)/1024),FileBytesLength:this.size};t.push(n)}}),t):t},getDisplayLabel:function(e,t){var i=this.component;if(this.columnDescriptor&&t){var a="";a=t.model&&t.model.rowId;var n=this.columnDescriptor.getOwner();n&&n.el&&n.el.find&&(i=n.el.find(kendo.format('[data-rowid="{0}"] #{1}',a,"component_"+this.baseId)))}return i},getDisplayUploadProgressLabel:function(e){var t=this.el||this.getDisplayLabel();return this.columnDescriptor&&e&&(t=this.getDisplayLabel("",e)),t},setDisabled:function(e){KDFileUploadProxy.superclass.setDisabled.call(this,e),e&&!this.component.hasClass("k-state-disabled")?(this.component.addClass("k-state-disabled"),this.el.addClass("k-state-disabled")):(this.component.removeClass("k-state-disabled"),this.el.removeClass("k-state-disabled")),this.el.find("[kdrole='kduploadfile']").attr("disabled",e),this.fileNameDiv&&(e?this.fileNameDiv.find("tr td .kdfileupload_file_del").hide():this.fileNameDiv.find("tr td .kdfileupload_file_del").show()),this._uploadloader&&this._uploadloader.Fileupinfo&&(this._uploadloader.Fileupinfo.option.disable=e)},setBackColor:function(e){KDFileUploadProxy.superclass.setBackColor.call(this,e),this.itemContainer&&this.itemContainer.el&&this.itemContainer.el.find(".kdItemContainer_editorct").css("background-color",e)},setExtandUrl:function(e){this.setExtandurl(e)},setExtandurl:function(e){KD.isUrl(e)||""==e||(e=KD.getUrlRoot()+"/"+e),this.ExtandUrl=e;var t=!0;""==e&&(e=this.defaultUploadServer,t=!1),this.isFileServer=t,this._uploadloader&&this._uploadloader.ApplyConfig({url:e,isfileserver:t})},setUpurl:function(e){this.setUpUrl(e)},setUpUrl:function(e){KD.isEmpty(e)||(KD.isEmpty(e)||KD.isUrl(e)||(e=KD.getUrlRoot()+"/"+e),this.UpUrl=e,this._uploadloader&&this._uploadloader.ApplyConfig({UpUrl:e}))},setExDownLoadUrl:function(e){this.setExdownloadurl(e)},setExdownloadurl:function(e){KD.isEmpty(e)||KD.isUrl(e)||(e=KD.getUrlRoot()+"/"+e),this.ExDownLoadUrl=e,this._uploadloader&&this._uploadloader.ApplyConfig({downlandurl:e})},setIsCanDownland:function(e){this.IsCanDownland=e,this.fileNameDiv&&(e?this.fileNameDiv.find("tr td .kdfileupload_file_downland").hide():this.fileNameDiv.find("tr td .kdfileupload_file_downland").show()),this._uploadloader&&this._uploadloader.ApplyConfig({isCanDownland:e})},setIsCanOnlineView:function(e){this.IsCanOnlineView=e,this.fileNameDiv&&(e?this.fileNameDiv.find("tr td .kdfileupload_file_onlineview").hide():this.fileNameDiv.find("tr td .kdfileupload_file_onlineview").show()),this._uploadloader&&this._uploadloader.ApplyConfig({isCanOnlineView:e})},release:function(){KD.isEmpty(this.autoClosePopup)||($("body").unbind("click",this.autoClosePopup),this.autoClosePopup=void 0),KD.isEmpty(this.preventDocumentDragAction)||(this.el&&this.el.off("dragleave drop dragenter dragover"),this.preventDocumentDragAction=void 0),$("#"+this.uploadFileListTargetId).remove(),KDFileUploadProxy.superclass.release.call(this)},_formatFileType:function(){var e=[];if(this.UploadFilter)for(var t=this.UploadFilter.split("|"),i=0;i<t.length;i++)for(var a=t[i].split(";"),n=0;n<a.length;n++){var o=a[n].indexOf("*.");if(o>-1){var r=a[n].substring(o+1).replace(/[()]/g,"");-1==e.indexOf(r)&&e.push(r)}}return e},setUploadFilter:function(e,t){if(!KD.isEmpty(e)&&(this.UploadFilter=e,!t)){var i=this._formatFileType().join(","),a=this._uploadloader&&this._uploadloader.GetOption.call(this._uploadloader);if(a){var n=a.fileInputButton,o=this._uploadloader.Fileupinfo;o&&o.setfileTypeExts.call(o,this.UploadFilter),n.attr("accept",i)}}},_formatFileSize:function(e){return KD.isEmpty(e)?e="":(e=e>1048576?(Math.round(100*e/1048576)/100).toString()+"MB":(Math.round(100*e/1024)/100).toString()+"KB",("0KB"===e||"NaNKB"==e)&&(e="1KB")),e},getMultiUpload:function(){return this.MultiUpload},setMultiUpload:function(e){this.MultiUpload=e},getCtrlType:function(){return this.CtrlType},setCtrlType:function(e){this.CtrlType=e},getServerCustomUploading:function(){return this.ServerCustomUploading},setServerCustomUploading:function(e){this.ServerCustomUploading=e},UpLoadAiles:function(e){this._uploadloader&&this._uploadloader.UpLoadAiles(e)}}),KDControlFactoryProxy.registerType("kdfileupload",KDFileUploadProxy),KDControlFactoryProxy.registerType("attachmentfield",KDFileUploadProxy),KDFileUploadProxy_Galaxy=KD.extend(KDFileUploadProxy,{fileItemFlatWidth:360,isClickDeleteDirectly:!1,isFileUploadList:!0,enableAutoFillMode:void 0,loadConfig:function(e){this.setIsFileUploadList(),this.isFileUploadList=KD.getValue(e,"isFileUploadList",this.isFileUploadList),this.enableAutoFillMode=KD.getValue(e,"enableAutoFillMode",this.enableAutoFillMode),this.enableAutoFillMode&&(e.orientation=KDFlowlayoutProxy.vertical,this.itemContainer&&(this.itemContainer.config.orientation=KDFlowlayoutProxy.vertical)),KDFileUploadProxy_Galaxy.superclass.loadConfig.call(this,e)},initComponent:function(){var e=this;KDFileUploadProxy.superclass.initComponent.call(this),this.component=$(kendo.format('<div id="component_{0}" type="text" class="k-textbox" aria-haspopup="true" tabindex="-1"  style="display:none;overflow: hidden;text-overflow: ellipsis;border: 0px; height: {1};line-height: {1};width: {2};" aria-disabled="false"></div>',this.baseId,this.innerHeight||"1.58em","100%")),this.componentGalaxy=$(kendo.format('<div id="componentGalaxy_{0}" type="text" class="" aria-haspopup="true" tabindex="-1"  style="overflow: hidden;text-overflow: ellipsis;border: 0px; height: {1};line-height: {1};padding: 20px 0px 10px 12px;background: inherit;overflow-x:auto;" aria-disabled="false"></div>',this.baseId,"36px")),this.el.addClass("kd-uploadfilegalaxy-el"),this.el.append(this.component).append(this.componentGalaxy);var t=e.el.outerHeight(!0),i=t-66;i=60>i?60:i;var a=$(kendo.format('<div class="kd-fileupload-tips" style="height:{0}px;line-height:{0}px;">{1}</div>',i,ResManager.LoadKDString("将文件拖拽到这里上传","0991733000018893")));this.dragUploadTips=a,this.el.append(a),this.itemContainer&&this.itemContainer.el&&(this.itemContainer.el.css({"padding-left":"0px"}),this.itemContainer.el.find(".kdItemContainer_editorct,.kgItemContainer_editorct").css({border:"none"}),this.itemContainer.el.find(".kdItemContainer_label,.kgItemContainer_label").css({display:"none"})),this.CtrlType&&this.setItemContaonerStyle(this.config.height?this.config.height:21)},_adjustAutoFillModeStyle:function(){if(this.enableAutoFillMode)this.el.addClass("kd-uploadfilegalaxy-el-autofill").css({height:"auto",position:"relative"}),this.itemContainer&&(this.itemContainer.el.css({height:"auto"}),this.itemContainer.el.children(".kdItemContainer_editorct").css({height:"auto"})),this.dragUploadTips&&this.fileNameDiv&&this.fileNameDiv.css({"margin-top":0-this.dragUploadTips.outerHeight(!0)+"px"});else if(this.dragUploadTips){var e=this.el.outerHeight(!0),t=e-66;t=60>t?60:t,this.dragUploadTips.css({height:t+"px","line-height":t+"px"})}},_initFileListContainer:function(e){if(this.componentGalaxy&&!($("#"+this.uploadFileListTargetId).length>0)){var t=this;t.preventDocumentDragAction=function(e){e.preventDefault()},$(document).on({dragleave:t.preventDocumentDragAction,drop:t.preventDocumentDragAction,dragenter:t.preventDocumentDragAction,dragover:t.preventDocumentDragAction}),t.fileNameDiv=$(kendo.format('<div id="{0}"  class="KDDynamicTextProxyDiv kendo-background-color kendo-border-color k-animation-container">',t.uploadFileListTargetId)),t.fileNameUl=$(kendo.format('<table id="{0}" class="ui-multiselect-checkboxes ui-helper-reset ui_fileupload_filelist"  tabindex="-1" >',t.uploadUlFileListTargetId)),t.fileNameDiv.append(t.fileNameUl),t.el.append(t.fileNameDiv);var i=$("#ui-multiselect-btn-"+t.baseId+"_c");t.CtrlType?i.css({width:t.config.width-26,height:e-1}):i.css({width:t.config.width-26,border:"0px",height:e-1}),i.find(".ui-multiselect-label").css({width:"auto","float":"left"}),i.find(".ui-icon-triangle-2-n-s").remove();var a='<table style="table-layout: fixed" ><tr>';a+='<td style=""><div class="ui_kdfilebt kd-uploadfile-container" style="">'+(this.config.labelText||ResManager.LoadKDString("上传文件","0991733000005269"))+'<input tabindex="0" kdrole="kduploadfile" type="file" title=" " accept="'+t._formatFileType().join(",")+'" name="fileselect[]" size="28" ',this.MultiUpload&&(a+="multiple"),a+="/></div></td>";var n=this.isFileUploadList?'<td style="" class="kd-file-download-container"><div class="ui_kdfilebt" style="" role="plxz">'+ResManager.LoadKDString("批量选择","0991733000017143")+'</div><div class="ui_kdfilebt" style="" role="ksxz">'+ResManager.LoadKDString("下载","00215225030044646")+'</div><div class="ui_kdfilebt" style="" role="pldel">'+ResManager.LoadKDString("删除","00215225030044647")+'</div><div class="ui_kdfilebt" style="" role="selall">'+ResManager.LoadKDString("全选","00215225030044645")+'</div><div class="ui_kdfilebt" style="" role="qxxz">'+ResManager.LoadKDString("取消选择","0991733000016762")+"</div></td>":"";a+=n;ResManager.LoadKDString("支持拖拽附件上传","0991733000016767");a+='<td><div class="kd-ui-uploadfile-extends" ></div></td>',a+="</tr></table>";var o=$(a);this.componentGalaxy.append(o),this.fileNameUl[0].addEventListener("drop",function(e){KD.CONST.CurrentDragUploadfileEventInfomationCache=e,$(this).parent().click(),KD.CONST.CurrentDragUploadfileEventInfomationCache=void 0},!1),this.fileNameDiv.click(function(e){if(KD.isEmpty(t.isCanUpload)){if(t.getDisabled())return}else if(0==t.isCanUpload)return;KD.isEmpty(KD.CONST.CurrentDragUploadfileEventInfomationCache)||t._uploadloader.UpLoadAiles(KD.CONST.CurrentDragUploadfileEventInfomationCache)}),o.find(".kd-file-download-container .ui_kdfilebt").on("click",function(e){var i=$(this),a=i.attr("role");if("plxz"==a)t.el.addClass("kd-fileupload-state-selected");else if("qxxz"==a)t.el.removeClass("kd-fileupload-state-selected"),t.setSelectFileList.call(t,"ALL",!1);else if("ksxz"==a){var n=t._getSelectFileList(),o={};o.file=n,t._uploadloader&&t._uploadloader.Fileupinfo&&t._uploadloader.Fileupinfo.option&&t._uploadloader.Fileupinfo.option.onFileItemDoubleClick&&t._uploadloader.Fileupinfo.option.onFileItemDoubleClick(o)}else if("pldel"==a){var n=t._getSelectFileList(),o={};o.file=n,t._uploadloader&&t._uploadloader.Fileupinfo&&t._uploadloader.Fileupinfo.option&&t._uploadloader.Fileupinfo.option.onFileItemDelete&&t._uploadloader.Fileupinfo.option.onFileItemDelete(o)}else"selall"==a&&t.setSelectFileList.call(t,"ALL",!0)})}},asyncValueToUIText:function(e){e&&"object"!=typeof e&&e.trim&&(e=e.trim());var t=[],i=this.el.find(".kd-fileupload-tips");if(KD.isEmpty(e)||KD.isObject(e)&&KD.isEmpty(e.NewValue)||!this._uploadloader||this._uploadloader&&!this._uploadloader.Fileupinfo)KD.setHtml(this.getDisplayLabel(),ResManager.LoadKDString("请选择文件","099002000000026")),this._uploadloader&&this._uploadloader.Fileupinfo&&(t=[],this._uploadloader.Fileupinfo.DisplayFile(t)),this.el.find('.ui_kdfilebt input[type="file"]').val(""),i.css({visibility:"visible"});else{if(this._uploadloader.Fileupinfo){t=e.NewValue?e.NewValue:e;var a=0;if(KD.isString(e)){var n=e.split(",");t=[],$.each(n,function(e){a+=1,t.push({FileName:"",ServerFileName:n[e],index:(new Date).format("hmssms")+a,FileBytesLength:0})})}KD.isArray(t)&&$.each(t,function(){a+=1,this.isInitView=!0,KD.isEmpty(this.index)&&(this.index=(new Date).format("hmssms")+a)}),this._uploadloader.Fileupinfo.DisplayFile(t)}i.css({visibility:"hidden"})}this._value=t,this.oldValue=t},setSelectFileList:function(e,t){var i=this;if(void 0!=t&&i.fileNameUl&&i.fileNameUl.find)for(var a=i.fileNameUl.find(".kd-ui-file-container"),n=0;n<a.length;n++){var o=$(a[n]),r=o.find('.ui_kdfileselect input[type="checkbox"]');r.prop({checked:t})}},_getSelectFileList:function(){var e=this,t=[];if(e.fileNameUl&&e.fileNameUl.find)for(var i=e.fileNameUl.find(".kd-ui-file-container"),a=0;a<i.length;a++){var n=$(i[a]),o=n.find('.ui_kdfileselect input[type="checkbox"]'),r=o.prop("checked");if(r){var s=e._getFileItemByFileId(o.attr("itemid"));s&&t.push(s)}}return t},_getFileItemByFileId:function(e){for(var t,i=this.getValue()||[],a=null,n=0;n<i.length;n++){var o=i[n];if(o&&(t=o.fileItemIndex||o.index,KD.equalsIgnoreCase(t,e))){a=o;break}}return a},setItemContaonerStyle:function(e){if(this.componentGalaxy){if(this.enableAutoFillMode)this._adjustAutoFillModeStyle();else if($("#"+this.uploadFileListTargetId).length>0)return void(e&&this.el&&((this.config.dock==KD.dock.Fill||this.config.dock==KD.dock.Left||this.config.dock==KD.layout.Right)&&(e=KD.layout.getActualHeight(this.el)),this.el.height(e),this._adjustAutoFillModeStyle()));KDFileUploadProxy_Galaxy.superclass.setItemContaonerStyle.call(this,e)}},_getSubmitFileItemForFileList:function(e,t){var i,a={},n=[];if(KD.isArray(e))for(var o=0;o<e.length;o++)a={},i=e[o],a.FileName=i.name,a.ServerFileName=i.ServerFileName,a.Key=i.Key,"FileUpload"==t&&(a.FileLength=i.FileLength,a.FileBytesLength=i.size),n.push(a);else n=e;return n},getUploadloaderOptions:function(e){var t=this;return e=e||{},e.isgalaxy=!0,this.isFileUploadList&&(e.isClickDeleteDirectly=this.isClickDeleteDirectly,e.onFileItemClick=function(e){if("Downland"==e.action){var i={target:e.target,option:e.option,file:e.actionfile};this.onFileItemDoubleClick(i)}else if("OnlineView"==e.action){var a={};a.FileInfos=[],a.FileInfos.push(e.actionfile),a.FileInfos=t._getSubmitFileItemForFileList(a.FileInfos);var n=t.getFormProxy();n&&n.fireCustomEvents.call(n,t.postKey,"FilePreview",KD.stringify(a)),
t.setIsOpen(!1)}},e.onFileItemDoubleClick=function(e){if(0!=t.IsCanDownland){var i=t.getFormProxy();if(i){var a={};a.FileInfos=[],KD.isArray(e.file)?a.FileInfos=a.FileInfos.concat(e.file):a.FileInfos.push(e.file),a.FileInfos=t._getSubmitFileItemForFileList(a.FileInfos),i.fireCustomEvents.call(i,t.postKey,"FileDownland",KD.stringify(a))}t.setIsOpen(!1)}},e.onFileItemDelete=function(e){if(KD.isEmpty(t.isCanDelete)){if(1==t.disable)return}else if(0==t.isCanDelete)return;var i=t.getFormProxy();if(i){var a={};a.FileInfos=[],KD.isArray(e.file)?a.FileInfos=a.FileInfos.concat(e.file):a.FileInfos.push(e.file),a.FileInfos=t._getSubmitFileItemForFileList(a.FileInfos),i.fireCustomEvents.call(i,t.postKey,"FileDelete",KD.stringify(a))}},e.onUploadComplete=function(e,i){var a=t.getFormProxy();if(a){var n=i||{},o={};o.FileInfos=[],KD.isArray(n)?o.FileInfos=o.FileInfos.concat(n):o.FileInfos.push(n),o.FileInfos=t._getSubmitFileItemForFileList(o.FileInfos,"FileUpload"),a.fireCustomEvents.call(a,t.postKey,"FileUpload",KD.stringify(o))}}),e},onchange:function(e,t,i){var a=this.getFile(t),n=this.getFormProxy(),o=e.target.fileState;if((this.CtrlType||!this.fireUpdate)&&n){var r={};if(r.OldValue=this.oldValue,r.NewValue=a,e.state&&e.state==o.Fail&&e.option.isfileserver&&(r.isfileservererror=!0),!KD.isEmpty(r.NewValue)||0==r.NewValue.length&&r.OldValue&&r.OldValue.length>0){var s=this.postKey,l="FileChanged";e.isdeletefile?(r={},r.FileInfos=[],r.FileInfos.push(e.actionfile),l="FileDelete"):e.actionfile&&(r={},r.FileInfos=[],r.FileInfos.push(e.actionfile)),KD.delayInvoke(function(){n.fireCustomEvents.call(n,s,l,KD.stringify(r))},200)}}this.oldValue=a;var d=this._getFileLength(t);d>=2?KD.setHtml(this.getDisplayLabel("",i||this.rowDataModel),kendo.format(ResManager.LoadKDString("共添加附件{0}个","099002000000027"),d)):KD.setHtml(this.getDisplayLabel("",i||this.rowDataModel),t&&d>0&&t[0]&&t[0].name?t[0].name:kendo.format(ResManager.LoadKDString("共添加附件{0}个","099002000000027"),d));var c=this.el.find(".kd-fileupload-tips");d>=1?c.css({visibility:"hidden"}):c.css({visibility:"visible"}),this.columnDescriptor?(this.columnDescriptor.onchange.call(this.columnDescriptor,e,a,i||this.rowDataModel),this.setValue(a)):e.isdeletefile||this.commitValueToForm(a)},setDisabled:function(e){KDFileUploadProxy_Galaxy.superclass.setDisabled.call(this,e);var t=this.el.find(".ui_kdfilebt.kd-uploadfile-container"),i=this.componentGalaxy.find('.ui_kdfilebt[role="pldel"]');e?(t.addClass("k-state-disabled"),i.addClass("k-state-disabled")):(this.componentGalaxy.removeClass("k-state-disabled"),t.removeClass("k-state-disabled"),i.removeClass("k-state-disabled")),KD.isEmpty(this.isCanUpload)||this.setIsCanUpload(this.isCanUpload),KD.isEmpty(this.isCanDelete)||this.setIsCanDelete(this.isCanDelete)},getDisplayUploadProgressLabel:function(){return this.getDisplayLabel()},getFile:function(e){var t=(this._uploadloader.GetOption.call(this._uploadloader).isfileserver||!1,[]);return e&&0!=e.length?($(e).each(function(e){if(this.length)for(var i=0;i<this.length;i++){var a=this[i],n={FileName:a.name,ServerFileName:a.ServerFileName,FileLength:Math.round((a.size+1023)/1024),fileItemIndex:a.index,FileBytesLength:a.size};t.push(n)}else{var n={FileName:this.name,ServerFileName:this.ServerFileName,FileLength:Math.round((this.size+1023)/1024),fileItemIndex:this.index,FileBytesLength:this.size};t.push(n)}}),t):t},setIsOpen:function(e){e=!0,this.fileNameDiv&&this.fileNameDiv.show()},setMaxFileLength:function(e){this.MaxFileLength=e,this._uploadloader&&this._uploadloader.ApplyConfig({maxFileLength:this.MaxFileLength})},setIsCanDownland:function(e){if(KDFileUploadProxy_Galaxy.superclass.setIsCanDownland.call(this,e),this.componentGalaxy){var t=this.componentGalaxy.find('.kd-file-download-container .ui_kdfilebt[role="ksxz"]');e?t.removeClass("k-state-disabled"):t.addClass("k-state-disabled")}},setIsCanDelete:function(e){if(this.isCanDelete=e,this.componentGalaxy){var t=this.componentGalaxy.find('.kd-file-download-container .ui_kdfilebt[role="pldel"]');e?t.removeClass("k-state-disabled"):t.addClass("k-state-disabled")}this.fileNameDiv&&(e?(this.fileNameDiv.removeClass("k-state-undelete"),this.fileNameDiv.find("tr td .ui_kddelfilebtn_del").show(),this.fileNameDiv.find("tr td .kdfileupload_file_del").show()):(this.fileNameDiv.addClass("k-state-undelete"),this.fileNameDiv.find("tr td .ui_kddelfilebtn_del").hide(),this.fileNameDiv.find("tr td .kdfileupload_file_del").hide())),this._uploadloader&&this._uploadloader.ApplyConfig({isCanDelete:e})},setIsCanUpload:function(e){if(!KD.isEmpty(e)){this.isCanUpload=e;var t=e?!1:!0,i=this.el.find(".ui_kdfilebt.kd-uploadfile-container"),a=this.el.find("[kdrole='kduploadfile']");t?(i.addClass("k-state-disabled"),a.attr("disabled",t)):(i.removeClass("k-state-disabled"),a.removeAttr("disabled"))}},doLayout:function(){KDFileUploadProxy_Galaxy.superclass.doLayout.call(this),this._adjustAutoFillModeStyle()},setFileItemFlatWidth:function(e){var t=parseInt(e);t>0&&(this.FileItemFlatWidth=t,this.fileNameDiv&&this.fileNameDiv.find(".ui_fileupload_filelist .kd-ui-file-container").width(this.FileItemFlatWidth),this._uploadloader&&this._uploadloader.ApplyConfig({fileItemFlatWidth:this.fileItemFlatWidth}))},release:function(){KD.isEmpty(this.preventDocumentDragAction)||($("body").unbind("click",this.preventDocumentDragAction),this.preventDocumentDragAction=void 0),KDFileUploadProxy_Galaxy.superclass.release.call(this)},setHeight:function(e){e=parseFloat(e),KD.isNaN(e)||(e-=2,this.itemContainer&&this.itemContainer.el&&(this.itemContainer.el.find('[role="kdeditorct"]').height(e),this.itemContainer.config&&(this.itemContainer.config.height=e)),this.config.height=e,this.el.height(e))},setIsFileUploadList:function(e){if(KD.isEmpty(e)){var t=this.config.originXtype;("attachmentfield"==t||"kdfileupload"==t)&&(this.isFileUploadList=!1)}else this.isFileUploadList=e},getIsFileUploadList:function(){return this.isFileUploadList}}),KDControlFactoryProxy.registerType("kdfileupload_Galaxy",KDFileUploadProxy_Galaxy),KDControlFactoryProxy.registerType("attachmentfield_Galaxy",KDFileUploadProxy_Galaxy),KDFileUpLoader=function(e){var t={fileTypeExts:"",url:"",auto:!1,disable:!1,multi:!0,removeTimeout:1e3,itemTemplate:'<tr  kdfilerole="${fileID}file" class="kd-ui-file-container"><td align="center" style=";" class="kd-ui-file-logo-container"><img src="content/themes/images/${logoName}" class="kd-ui-file-logo"/></td><td style="word-break:break-all" class="ui_kdfilename">${fileName}<span class="ui_kdprogressnum">${fileSize}</span></td><td style=";" role="command" class="kd-ui-file-command-container"><a class="ui_kduploadbtn">'+ResManager.LoadKDString("上传","0025710030033493")+'</a><a class="ui_kddelfilebtn_onlineview"><div class="kdfileupload_file_onlineview" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></div></a><a class="ui_kddelfilebtn_downland"><div class="kdfileupload_file_downland" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></div></a><a class="ui_kddelfilebtn_del"><div class="kdfileupload_file_del" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></div></a><div kdfilerole="${fileID}file-progress" class="kd-ui-kdfileuploadprogress-container"><div class="ui_kdfileuploadprogress"></div></div></td><td class="ui_kdfileselect"><div data-role="checkbox" id="${fileItemID}_d" tabindex="50"><input type="checkbox" class="k-checkbox" id="${fileItemID}" itemid="${fileID}"><label id="l_${fileItemID}" class="k-checkbox-label" for="${fileItemID}" title=""></label></div></td></tr>',onUploadStart:function(){},onUploadSuccess:function(){},onUploadComplete:function(){},onUploadError:function(){},onInit:function(){},onFileItemsChanged:function(){},onFileStateChanged:function(){},fileInputButton:null,uploadFileListTargetId:null,requestActByteLength:2097152,maxFileLength:0,isfileserver:!1,AllowUpLoadFileType:ClientAppProxy.Current.AllowUpLoadFileType,onCreateUrl:function(){},onSuccessfullResponse:function(){return!0},fileCommandContainerWidth:0,onFileItemDoubleClick:function(){}},i=[{fileExtName:"default",logoname:"icon_unkown.png"},{fileExtName:"ppt",logoname:"icon_ppt.png"},{fileExtName:"txt",logoname:"icon_txt.png"},{fileExtName:"pdf",logoname:"icon_pdf.png"},{fileExtName:"rar",logoname:"icon_zip.png"},{fileExtName:"zip",logoname:"icon_zip.png"},{fileExtName:"doc",logoname:"icon_doc.png"},{fileExtName:"xls",logoname:"icon_xls.png"},{fileExtName:"rft",logoname:"icon_unknow.png"},{fileExtName:"jpg",logoname:"icon_image.png"},{fileExtName:"png",logoname:"icon_image.png"},{fileExtName:"bmp",logoname:"icon_image.png"},{fileExtName:"gif",logoname:"icon_image.png"},{fileExtName:"jpeg",logoname:"icon_image.png"},{fileExtName:"dat",logoname:"icon_txt.png"},{fileExtName:"key",logoname:"icon_txt.png"},{fileExtName:"msg",logoname:"icon_txt.png"}],a=function(e){return e=e>1048576?(Math.round(100*e/1048576)/100).toString()+"MB":(Math.round(100*e/1024)/100).toString()+"KB","0KB"===e&&(e="1KB"),e},n=function(e,t){for(var i=0;i<t.length;i++)if(t[i].index==e)return t[i];return!1},o=function(e){return KD.isArray(e)?e[0]:e?e:!1},r=function(e){if(e){for(var t=[],i=e.split("|"),a=0;a<i.length;a++)for(var n=i[a].split(";"),o=0;o<n.length;o++){var r=n[o].indexOf("*.");if(r>-1){var s=n[o].substring(r+1).replace(/[()]/g,"");-1==t.indexOf(s)&&t.push(s)}}return t}return!1},s=function(e){var t,s=e.fileInputButton;if(e.uploadUlFileListTargetId)if(t=$("#"+e.uploadUlFileListTargetId),0==t.length)t=$('<table id="'+e.uploadUlFileListTargetId+'"></table>');else{var l=t.attr("class");l.indexOf("ui_fileupload_filelist")<0&&t.addClass("ui_fileupload_filelist")}this.option=e;var d=this,c={fileInput:s.get(0),oldfileFilter:[],fileFilter:[],fileState:{Waiting:0,Uploading:1,Uploaded:2,Fail:3},WaitingState:-1,ErrorState:-1,VerifySelectFileBasicValid:function(e){var t=!0,i="";if(e&&e.constructor==File){switch(!0){case 0==e.size:t=!1,i=kendo.format(ResManager.LoadKDString("您选择的{0}是空文件！","014006000001239"),e.name)}return t||(d.option.onUploadError.call(d.option,d,e,i),s.val("")),t}return!t},filter:function(t){var i=[],a=r(e.fileTypeExts);if(a){for(var n in t)if(t[n].constructor==File){for(var o=!1,l="",c=0;c<a.length;c++)if(l=a[c],t[n].name.toUpperCase().indexOf(l.toUpperCase())>0){o=!0;break}var h=this.VerifySelectFileBasicValid(t[n]);if(!h)return!1;if(!o)return d.option.onUploadError(this,t[n],kendo.format(ResManager.LoadKDString("只允许上传类型[{0}]的文件！","099002000000028"),a.join())),s.val(""),!1;this.initFile(t[n]),i.push(t[n])}}else for(var n in t)if(t[n].constructor==File){var h=this.VerifySelectFileBasicValid(t[n]);if(!h)return!1;this.initFile(t[n]),i.push(t[n])}return i},getlogoName:function(e){if(!e)return i[0];for(var t=e.substring(e.lastIndexOf(".")+1).toLocaleLowerCase(),a=0,n=0;n<i.length;n++)(i[n].fileExtName==t||i[n].fileExtName+"x"==t)&&(a=n);var o=i[a];return o.fileExtActName=t,d.option.isgalaxy&&o.logoname&&(o.logoname=o.logoname.replace(".","_")),o},initFile:function(e){d.option.isfileserver||this.setServerFileName(e),e.state||(e.state=c.fileState.Waiting)},setServerFileName:function(e){var t=e.ServerFileName||KD.Guid.NewGuid().ToString()+" "+e.name;return e.ServerFileName||(e.ServerFileName=t),e},onCreateUrl:function(e,t,i,a){d.option.isfileserver||this.setServerFileName(e),t+=t.indexOf("?")>0?"&":"?",t+=kendo.format("filename={0}&startposition={1}&complete={2}&token={3}",KD.urlEncodeComponent(e.ServerFileName),i,a>=e.size,KD.getUserToken());var n={target:this,file:e,url:this.onCreateFileServerUrl(e,t,i,a),startpostion:i,requestLength:a,isfileserver:d.option.isfileserver};return d.option.onCreateUrl.call(this,n),n.url},onCreateFileServerUrl:function(e,t,i,a){var n=d.option;if(!n.isfileserver)return t;var o=KD.isEmpty(n.UpUrl)?n.url:n.UpUrl;if(o+=o.indexOf("?")>0?"&":"?",!KD.isEmpty(n.UpUrl)){var r={filename:KD.urlEncodeComponent(e.name),fileid:e.ServerFileName,last:a>=e.size,dbid:ClientAppProxy.Current.CTX.DBid,filelen:e.size,tk:KD.getUserToken()};return o+=kendo.format("tk={0}",KD.newFileUpSecByCryptoJS(r))}return e.ServerFileName=e.ServerFileName||"",o+=kendo.format("filename={0}&fileid={1}&last={2}&dbid={3}&filelen={4}&token={5}",KD.urlEncodeComponent(e.name),e.ServerFileName,a>=e.size,ClientAppProxy.Current.CTX.DBid,e.size,KD.getUserToken())},onInitFileElement:function(e){if(t&&e.state==c.fileState.Uploaded){if(t.find("[kdfilerole='"+e.index+"file'] > .ui_kduploadbtn").fadeOut(),e.size>0){var i=a(e.size);t.find("[kdfilerole='"+e.index+"file'] .ui_kdprogressnum").html(i+"/"+i)}else t.find("[kdfilerole='"+e.index+"file'] .ui_kdprogressnum").html("");t.find("[kdfilerole='"+e.index+"file']")[getOffHandler()]()[getOnHandler()]("dblclick",function(){var i={target:t,option:d.option,file:e};d.option.onFileItemDoubleClick&&d.option.onFileItemDoubleClick(i)})}},onSelect:function(i){var o="txt,pdf,doc,docx,xls,xlsx,ppt,pptx,rft,jpg,png,bmp,gif,jpeg,rar,zip,dat,key,msg";e.AllowUpLoadFileType&&(o=e.AllowUpLoadFileType);for(var r=!0,s=0;s<i.length;s++){var l=this.getlogoName(i[s].name);if(i[s].name&&"default"==l.fileExtName&&o.indexOf(l.fileExtActName)<0){r=!1;break}}if(r){this.ErrorState=-1,this.WaitingState=-1;for(var s=0;s<i.length;s++){var h=i[s];if(d.option.itemTemplate&&t){var u=d.option.itemTemplate,p=this.getlogoName(h.name);u=u.replace(/\${fileID}/g,h.index).replace(/\${fileName}/g,h.name).replace(/\${fileSize}/g,a(h.size)).replace(/\${logoName}/g,p.logoname),d.option.isgalaxy&&(u=u.replace(/\${fileItemID}/g,d.option.uploadUlFileListTargetId+h.index),u=$(u),u.find(".kd-ui-file-logo-container").addClass("kd-filelog-"+p.logoname),u.find(".kd-ui-file-logo-container .kd-ui-file-logo").removeAttr("src"),u.find(".kdfileupload_file_onlineview").css({"background-image":"none"}).text(ResManager.LoadKDString("在线预览","0991733000005270")),u.find(".kdfileupload_file_downland").css({"background-image":"none"}).text(ResManager.LoadKDString("下载","0025710030033499")),u.find(".kdfileupload_file_del").css({"background-image":"none"}).text(ResManager.LoadKDString("删除","0991733000003902")),d.option.fileItemFlatWidth>0&&u.width(d.option.fileItemFlatWidth)),t.append(u)}if(d.option.auto&&h.state==c.fileState.Waiting){var g=ClientAppProxy.Current.ImgFileEnableCompress,f=!1,m=KD.isIeBrowser(),v=h.type&&h.type.replace("image/","");if(d.option.fileTypeExts&&d.option.fileTypeExts.indexOf(v)>-1&&(f=!0),h.size<=1e6&&(g=!1),g&&f&&!m){var y=this;KD.imgCompress({file:h,successful:function(e){y.fileFilter[0]=e,c.funUploadFile(e)}})}else c.funUploadFile(h)}else h.state==c.fileState.Uploaded&&this.onInitFileElement(h)}t&&(d.option.auto?t.find(".ui_kduploadbtn")[getOffHandler()]().css({display:"none"}):t.find(".ui_kduploadbtn")[getOffHandler()]()[getOnHandler()]("click",function(){var e=parseInt($(this).parents("li").attr("kdfilerole"));c.funUploadFile(n(e,i))}),t.find(".ui_kddelfilebtn_del")[getOffHandler()]()[getOnHandler()]("click",function(){var e=parseInt($(this).parents("tr").attr("kdfilerole"));c.funDeleteFile(e)}),t.find(".kdfileupload_file_onlineview")[getOffHandler()]()[getOnHandler()]("click",function(){var e=parseInt($(this).parents("tr").attr("kdfilerole"));d.option.isgalaxy&&KD.isNaN(e)&&(e=parseInt($(this).parents(".kd-fileupload-item-container").attr("kdfilerole"))),c.funOpetionAction(e,"OnlineView")}),t.find(".kdfileupload_file_downland")[getOffHandler()]()[getOnHandler()]("click",function(){var e=parseInt($(this).parents("tr").attr("kdfilerole"));d.option.isgalaxy&&KD.isNaN(e)&&(e=parseInt($(this).parents(".kd-fileupload-item-container").attr("kdfilerole"))),c.funOpetionAction(e,"Downland")}),d.option.disable?t.find(".ui_kddelfilebtn_del").hide():t.find(".ui_kddelfilebtn_del").show(),d.option.isCanDownland?t.find(".kdfileupload_file_downland").show():t.find(".kdfileupload_file_downland").hide(),d.option.isCanOnlineView?t.find(".kdfileupload_file_onlineview").show():t.find(".kdfileupload_file_onlineview").hide());var b={files:i,option:d.option,target:this,oldfiles:this.oldfileFilter,newfiles:this.fileFilter};if(this.onFileItemsChanged(b),d.option.isgalaxy){var D=t.find(".kd-ui-file-container").first();if(D&&D.find){var k=D.find(".kd-ui-file-command-container").width();k!=d.option.fileCommandContainerWidth&&(d.option.fileCommandContainerWidth=k,t.find(".kd-ui-file-command-container .ui_kdfilename").css({right:k+"px"}))}}}else this.fileFilter.pop(),c.onUploadError(this,ResManager.LoadKDString("只允许上传的文件类型是","0025710030034262")+o)},onDelete:function(e){d.option&&0==d.option.isClickDeleteDirectly||t&&(t.find("[kdfilerole="+e.index+"file]").fadeOut().remove(),t.find("[kdfilerole="+e.index+"file-progress]").fadeOut().remove());var i={target:this,oldfiles:this.oldfileFilter,newfiles:this.fileFilter,option:d.option,isdeletefile:!0,actionfile:e,fileindex:e.index};this.onFileItemsChanged(i)},onOptionAction:function(e,t){var i={target:this,files:this.fileFilter,option:d.option,action:t,actionfile:e,fileindex:e.index};d.option.onFileItemClick&&d.option.onFileItemClick(i)},onProgress:function(e,i,n,o){var r=i;if(t){var s=t.find("[kdfilerole="+e.index+"file-progress]");r=Number(s.attr("uploadedlen")||"0")+r;var l=(r/n*100).toFixed(2)+"%";(!o||o&&i>=o.total)&&s.attr("uploadedlen",r),s.find(".ui_kdfileuploadprogress").show().css("width",l),5e5>n-r&&(r=n);var h=t.find("[kdfilerole="+e.index+"file]");h.find(".ui_kdprogressnum").html(a(r)+"/"+a(n))}d.option.onProgress&&d.option.onProgress(e,r,n),n>r&&this.onFileStateChanged(e,c.fileState.Uploading)},onUploadSuccess:function(e,i){if(t){var n=t.find("[kdfilerole="+e.index+"file-progress]"),o="0%";n.find(".ui_kdfileuploadprogress").hide().css("width",o),n.attr("uploadedlen",e.size);var r=t.find("[kdfilerole="+e.index+"file]");r.find(".ui_kdprogressnum").html(a(e.size)+"/"+a(e.size))}this.onFileStateChanged(e,c.fileState.Uploaded),d.option.onUploadSuccess(this,e,i)},onUploadError:function(e,t,i){this.funDeleteFile(e.index),this.onFileStateChanged(e,c.fileState.Fail),d.option.onUploadError(this,e,t,i)},onUploadComplete:function(t){d.option.onUploadComplete(this,t);var i=this;if(!e.multi&&this.fileInput)if(KD.isIeBrowser()){var a=$(this.fileInput).parent();this.fileInput.outerHTML=this.fileInput.outerHTML+"",this.fileInput=a.find("input")[0],this.fileInput&&this.fileInput.addEventListener("change",function(e){if(KD.isEmpty($(this).attr("fromfiledelete"))){var t=!0;d.option.onBeforeSelectFile&&(t=d.option.onBeforeSelectFile.call(d,e)),t&&i.funGetFiles(e)}},!1)}else $(this.fileInput).val("")},onSuccessfullResponse:function(e,t){if(!d.option.isfileserver){if("1"==t)return!0;if("0"==t)return this.setServerFileName(e),!1}var i=JSON.parse(t);if(!i)return this.onUploadError(e,"config error:"+t,!0),!1;var a="UploadResult";if(i.Upload2AttachmentResult&&(a="Upload2AttachmentResult"),i.UploadImageResult&&(a="UploadImageResult"),i[a]){var n=i[a];if(!n)return!1;var o=KD.getValue(n,"Success",!0),r=KD.getValue(n,"Message",""),s=KD.getValue(n,"FileId",""),l=KD.getValue(n,"Url","");return""!=r?(this.onUploadError(e,r,!0),!1):(e.DownloadUrl=l,o?(e.ServerFileName=s,!0):(this.setServerFileName(e),this.onUploadError(e,"config error:"+t,!0),!1))}return d.option.onSuccessfullResponse.call(this,e,t,!0)},onFileItemsChanged:d.option.onFileItemsChanged,onFileStateChanged:function(e,t){var i=!1;if((e.state!=t||0==t)&&(e.state=t,i=!0),e.state==c.fileState.Uploaded&&this.onInitFileElement(e),i){var a=this,n=[],o=[],r=[],s=[],l=0;$(this.fileFilter).each(function(e){for(var t=this.length?this.length:a.fileFilter.length,i=0;t>i;i++){var d=this[i]||a.fileFilter[i];d.state==a.fileState.Uploading?n.push(d):d.state==a.fileState.Fail?o.push(d):d.state==a.fileState.Uploaded?r.push(d):s.push(d),l++}});var h={target:a,option:d.option,state:t,uploadingfiles:n,failfiles:o,actionfile:e,uploadedfiles:r};r.length==l&&l>0?(h.state=a.fileState.Uploaded,d.option.onFileStateChanged(h)):s.length>0?(h.state=a.fileState.Waiting,h.state!=this.WaitingState&&(this.WaitingState=h.state,d.option.onFileStateChanged(h))):n.length>0?(h.state=a.fileState.Uploading,d.option.onFileStateChanged(h)):o.length>0?(h.state=a.fileState.Fail,h.state!=this.ErrorState&&(this.ErrorState=h.state,d.option.onFileStateChanged(h))):(h.state=a.fileState.Uploaded,d.option.onFileStateChanged(h))}},funGetFiles:function(i){this.oldfileFilter.splice(0,this.oldfileFilter.length),this.oldfileFilter=this.fileFilter.concat();var a=i.target.files||i.dataTransfer.files;return e.multi||(t&&t.find("tr").fadeOut().remove(),this.fileFilter.splice(0,this.fileFilter.length)),a=this.filter(a),a&&0!=a.length?(this.fileFilter.push(a),this.funDealFiles(a),this):this},getSameFileNameIndex:function(e,t){for(var i=0;i<this.fileFilter.length-1;i++)for(var a=0;a<this.fileFilter[i].length;a++){var n=this.fileFilter[i][a];if(n.name==e.name)return t}return""},funValidFile:function(e,t){var i={file:e,option:d.option,target:this};if(d.option.onOverMaxFileLength)return d.option.onOverMaxFileLength(i);if(d.option.onValidFile)return d.option.onValidFile(i);var a="",n=!0;switch(!0){case 0!=d.option.maxFileLength&&1024*d.option.maxFileLength<e.size:var o=d.option.maxFileLength+"KB";d.option.maxFileLength>=1024&&(o=Math.round(100*d.option.maxFileLength/1024)/100+"M"),a=kendo.format("{0}{1}{2}",ResManager.LoadKDString("附件最大支持:","099002000000029"),o,ResManager.LoadKDString(",文件大小超过上限","0025710000003895")),n=!1;break;case e.name&&e.name.length>120:a=kendo.format(ResManager.LoadKDString("{0}的文件名过长.","0025710000005291"),e.name),n=!1;break;case e.name&&/[\/:*?"<>|;]/.test(e.name):a=kendo.format(ResManager.LoadKDString("上传附件失败，文件名不允许包含“{0}”符号","0025710000005292"),'/:*?"<>|;'),n=!1}return n||($(this.fileInput).val(""),d.option.onUploadError.call(d.option,d,e,a,!1,t)),n},funDealFiles:function(i){for(var a=this.getFilesMsgOverLimit(i),n=0;n<i.length;n++){if(!this.funValidFile(i[n],a))return this.fileFilter.pop(),this;if(e.multi){var o=this.getSameFileNameIndex(i[n],n);KD.isEmpty(o)||(i[o]=void 0)}}if(e.multi){for(var r=i.length-1;r>=0;r--)void 0==i[r]&&i.splice(r,1);if(0==i.length)return this.fileFilter.pop(),c.onUploadError(this,ResManager.LoadKDString("请勿重复上传附件,如需更新上传文件,请删除原有附件再重新提交!","00215181000017627")),this;this.fileFilter.pop(),this.fileFilter.push(i)}if(t)for(var s=t.find(".ui_fileupload_filelist li").length,n=0;n<this.fileFilter.length;n++)for(var l=0;l<this.fileFilter[n].length;l++){var d=this.fileFilter[n][l];if(KD.isEmpty(d.index)){s++;var h=(new Date).format("hmssms")+s;d.index=h}}return this.onSelect(i),this},funDeleteFile:function(e){var t=this;return $(this.fileInput).attr("fromfiledelete",!0),this.fileInput.value="",$(this.fileInput).removeAttr("fromfiledelete"),$(this.fileFilter).each(function(i){for(var a=0;a<this.length;a++){var n=this[a];n.index==e&&(d.option&&0==d.option.isClickDeleteDirectly||(this.splice(a,1),0==this.length&&t.fileFilter.splice(i,1)),t.onDelete(n))}}),this},getFilesMsgOverLimit:function(e){for(var t=d.option.maxFileLength,i={},a=[],n=!1,o="",r="",s=0;s<e.length;s++)e[s].size>1024*t&&(o+='<span title="'+e[s].name+'">'+e[s].name+"</span>",a.push(e[s]),n=!0);if(n){o=$(kendo.format('<div class="kd-exeedlimit-filescontainer">{0}</div>',o)),r=$(kendo.format('<div class="kd-fileupload-limitmsg"><span>{0}</span></div>',ResManager.LoadKDString("请点击更多，查看超限文档详情。","002014000006795")));var l=$(kendo.format('<span class="kd-fileupload-limitmsg-morebtn">{0}</span>',ResManager.LoadKDString("更多","002014030028203")));r.append(l),r.append(o),l.off("click").on("click",function(){o.is(":visible")||o.show()})}return i.hasFileExceed=n,i.files=a,i.limitTipsEl=r,i},funOpetionAction:function(e,t){var i=this,a=void 0;return $(this.fileFilter).each(function(t){for(var i=0;i<this.length;i++){var n=this[i];if(n.index==e)return a=n,!1}}),a&&i.onOptionAction(a,t),this},funUploadFile:function(e,i){var a=this;return d.option.url?KD.isUrl(d.option.url)?void function(e){i||(i=0),0==i&&a.onFileStateChanged(e,0);var n=new XMLHttpRequest;if(n.upload){n.upload.addEventListener("progress",function(t){a.onProgress(e,t.loaded,e.size,t)},!1),n.onreadystatechange=function(o){if(4==n.readyState)if(200==n.status){if(!a.onSuccessfullResponse(e,n.responseText))return;if("-1"!=n.responseText||d.option.isfileserver){var r=i+d.option.requestActByteLength;r<e.size&&c.funUploadFile(e,r),r>=e.size&&(a.onProgress(e,e.size,e.size),a.onUploadSuccess(e,n.responseText),t&&t.find("[kdfilerole='"+e.index+"file'] > .ui_kduploadbtn").css({display:"none"}),a.onUploadComplete(e))}else a.onUploadError(e,"error")}else a.onUploadError(e,n.responseText,!0)},0==i&&d.option.onUploadStart(a,e);var o=i+d.option.requestActByteLength;o>=e.size&&(o=e.size),n.open("POST",a.onCreateUrl(e,d.option.url,i,o),!0),n.send(e.slice(i,o))}}(e):void a.onUploadError(e,"Upload URL is illegal! URL:"+d.option.url):void a.onUploadError(e,"Upload URL is Empty!")},init:function(){var i=this;return i.fileInput&&0!=i.fileInput.length?(this.fileInput&&this.fileInput.addEventListener("change",function(e){if(KD.isEmpty($(this).attr("fromfiledelete"))){var t=!0;d.option.onBeforeSelectFile&&(t=d.option.onBeforeSelectFile.call(d,e)),t&&i.funGetFiles(e)}},!1),this.hasOwnProperty("uploadFileList")||(this.uploadFileList=t),this.hasOwnProperty("getFile")||(this.getFile=n),this.hasOwnProperty("getFrestFile")||(this.getFrestFile=o),void e.onInit()):i},displayFile:function(e){var i=this;this.fileFilter.length>0&&(this.oldfileFilter.splice(0,this.oldfileFilter.length),this.oldfileFilter=this.fileFilter.concat(),t&&t.find("tr").fadeOut().remove(),this.fileFilter.splice(0,this.fileFilter.length));var a=[];return $(e).each(function(e){var t={name:KD.urlDecodeComponent(this.FileName),ServerFileName:this.ServerFileName,size:this.FileBytesLength?this.FileBytesLength:this.FileLength,state:c.fileState.Uploaded};KD.isEmpty(this.index)||(t.index=this.index),d.option.isgalaxy&&(KD.isEmpty(this.Key)||(t.Key=this.Key)),t.ServerFileName||this.isInitView||c.setServerFileName.call(i,t),a.push(t)}),a.length>0&&(i.fileFilter.push(a),i.funDealFiles(a)),this}};return this.DisplayFile=function(e){c.displayFile.call(c,e)},this.ApplyConfig=function(e){this.option=$.extend(this.option,e)},this.UpLoadAiles=function(e){c.funGetFiles(e)},this.setfileTypeExts=function(e){this.option.fileTypeExts=e||null},c.init(),this};return this.ApplyConfig=function(e){this.Fileupinfo&&this.Fileupinfo.ApplyConfig(e)},this.Fileupinfo=new s($.extend({},t,e)),this.GetFileServerDownUrl=function(e,t,i){var a=t;return this.Fileupinfo&&this.Fileupinfo.option.isfileserver&&(a=t.indexOf("?")>=0?t+"&":t+"?",a+=kendo.format("fileid={0}&dbid={1}&t={2}&token={3}&filename={4}",e,ClientAppProxy.Current.CTX.DBid,(new Date).valueOf(),KD.getUserToken(),i||"")),a},this.GetOption=function(){return this.Fileupinfo.option||t},this.UpLoadAiles=function(e){this.Fileupinfo&&this.Fileupinfo.UpLoadAiles(e)},this},define("KDFileUploadProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDFileUploadProxy}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.KDPopListEdit,o=n.extend({isChineseInput:!1,isSearchArticle:!1,hasShowArticle:!1,viewDisplayMaxCount:100,options:{name:"KDFullSearch",autoBind:!0,pop:{origin:"bottom right",position:"top right",width:"1033"==ResManager.Language?440:280},template:""},onInitDataListPanel:function(){var t=this;this.input.off("compositionstart").off("compositionend").on("compositionstart",function(e){t.isChineseInput=!0}).on("compositionend",function(e){t.isChineseInput=!1}),t.initArticlePanel.call(t),t.dataView=e('<div unselectable="on">').appendTo(t.dataList),t.dataView.kendoListView({dataSource:[],template:t._getItemTemplate(),autoBind:!0,selectable:!0,navigatable:!0,change:function(i){if(t.isPopup()){var a=e("span[searchitem='value']",i.sender.current()).text(),n=i.sender&&i.sender.current&&i.sender.current().attr("ismenu"),o=KD.equalsIgnoreCase(n,"true");t.options.change.call(t,i,a,o)}}}),t.dataView.removeClass("k-widget"),t.popup.css({"margin-left":"0px"}).addClass("kdfullsearchpopextend")},onPopOpen:function(e){var t=this;t.isSearchArticle||(t.popup.removeClass("kd-fullsearch-articlepopup"),t.popup.attr("pop-type","fullsearch")),KD.delayInvoke(function(){if(t.popup&&t.popup.css({"font-family":""}),t.dataView.css({"max-height":"295px"}),t.popup.css({"max-height":"336px"}),t.isSearchArticle&&t.popup.addClass("kd-fullsearch-articlepopup"),"1033"==ResManager.Language||t.isSearchArticle&&t.hasShowArticle){var e=t.popup&&t.popup.parent(".k-animation-container");if(e&&e.length>0){var i=e.offset(),a=i&&i.left;a&&a>0&&(a+=158,e.css({left:a}))}}t.isSearchArticle?t.hasShowArticle=!0:t.hasShowArticle=!1},100)},onKeyDown:function(e){var t=this;13==e.keyCode&&(e.preventDefault(!0),e.stopPropagation(),t.isSearchArticle?(t.searchBtnClick(),e.keyCode=39):(e.sender=t.dataView.data("kendoListView"),t._selectItem(e)))},onKeyUp:function(e){var i=this;13!=e.keyCode?i.openPopup():e.preventDefault(!0),i.rowIndex=!(i.rowIndex===t)&&i.rowIndex>=0&&i.rowIndex||0,(38==e.keyCode||40==e.keyCode)&&i._locationItem(e.keyCode)},_GetFastResult:function(t){var i=this,a=e("#fullSearch_SelectSearchType").data("kendoDropDownList").value(),n={};n.text=t,n.type=a,KD.isEmpty(t)?(KD.equalsIgnoreCase(a,"ALL")||KD.equalsIgnoreCase(a,"AppMenu"))&&(i.options.controlProxy.isNlpData=!1,i.options.controlProxy.recentMenuState=!0,this.options.controlProxy.setData(i.options.controlProxy.recentMenuList)):this.fireCustomEvent("FNLPSEARCHRESULTPANEL","FastResult",n),KD.delayInvoke(function(a,n){var n={};n.text=t,n.type=e("#fullSearch_SelectSearchType").data("kendoDropDownList").value(),KD.isEmpty(t)||i.fireCustomEvent&&i.fireCustomEvent.call(i,"FNLPSEARCHRESULTPANEL","AiRec",n)},300,!0,$this)},onChange:function(e,t){var a=this,n=a.input.val(),o=a.options.controlProxy.isAISearch;return a.options.controlProxy.recentMenuState=!1,KD.equalsIgnoreCase(a.options.controlProxy.SearchTypeVal,"help")?void KD.delayInvoke(function(){a.searchBtnClick.call(a)},500):void((a.allData&&!(a.allData.length<=0)||o)&&(KD.isIeBrowser()&&(t=t.replace(/'/g,"")),o&&a._GetFastResult(n),KD.delayInvoke(function(){var e=KD.isEmpty(n)&&!o?a.options.controlProxy.recentMenuList:a._filter(a.allData,t);a._setSearchTipsText(a.options.controlProxy.SearchTypeVal,n),a.displayDataList=e,!a.isSearchArticle&&a._setListCount(),e.length<=7?a.dataView.css("overflow-y","inherit"):a.dataView.css("overflow-y","auto");var r=a.dataView.data("kendoListView");r.setDataSource(new i.data.DataSource({data:e.slice(0,a.viewDisplayMaxCount/2)})),r.current(r.element.children().first()),a._bindAddFunBtn()},50)))},fireCustomEvent:function(e,t,i){var a=this.options.controlProxy.getFormProxy(),n=KD.isString(i)?i:KD.stringify(i);a&&a.fireCustomEvents.call(a,e,t,n)},setData:function(t,a,n){var o=this;o.onLoadOptions(o.options),o._initPopup();var r=o._generalDataSource(t,!1,a),s=o.input.val();KD.isEmpty(s)||n||r.sort(function(e,t){return e.number==t.number?e.text==t.text?e.group<t.group?-1:1:e.text<t.text?-1:1:e.number<t.number?-1:1}),o.allData=r;var l=o.options.controlProxy.isAISearch,d=n?n:!l&&KD.isEmpty(s)?!0:!1,c=o._filter(r,s,d);o.displayDataList=c,o._setSearchTipsText(o.options.controlProxy.SearchTypeVal,s),o._setListCount(),o.dataView.data("kendoListView").setDataSource(new i.data.DataSource({data:c.slice(0,o.viewDisplayMaxCount/2)})),o._bindAddFunBtn(),o._setNlpItemStyle(),o.dataView.css({"max-height":"295px"}),o.popup.find("div.k-selectable").addClass("kd-fullsearch-selectable"),o.dataView.css("overflow-y","auto"),o.popup.css({"max-height":"336px"}),o.dataView.scroll(function(t){var a=e(this);if(o.displayDataList.length>o.viewDisplayMaxCount/2&&o.dataView.children().length<=o.viewDisplayMaxCount/2){var n=a.scrollTop();n>o.dataView.children(":first").height()*(o.viewDisplayMaxCount/2-8)&&(o.dataView.data("kendoListView").setDataSource(new i.data.DataSource({data:o.displayDataList.slice(0,o.viewDisplayMaxCount)})),o._bindAddFunBtn(),a.scrollTop(n))}})},setArticleVisible:function(e){this.articleVisible=e,this.dataViewHeader&&(0==e?(this.dataViewHeader.find('.kd-fullSearchList-header-btn[role="function"]').parent(".kd-fullSearchList-header-btn-parent").css({
"border-right-width":"0px"}),this.dataViewHeader.find('.kd-fullSearchList-header-btn[role="article"]').hide()):this.dataViewHeader.find('.kd-fullSearchList-header-btn[role="article"]').show())},destroy:function(){var e=this,t=e.dataView&&e.dataView.data("kendoListView");t&&t.destroy(),n.fn.destroy.call(e)},_selectItem:function(e){var t=this;if(!t.keyboardLocal){var i=e.sender.current(),a=i&&i[0];e.sender.select(a)}},_locationItem:function(t){var i=this,a=i.dataView.data("kendoListView");i.rowIndex=a.dataItems("div").indexOf(a.dataItem(a.current())),38==t?i.rowIndex--:40==t&&i.rowIndex++;var n=e(i.dataView.find("li:eq("+i.rowIndex+")"));i.keyboardLocal=!0,a.current(n),i.keyboardLocal=!1},_bindAddFunBtn:function(){var t=this,i=t.dataView.find("a[searchitem='add']");i.click(function(i){i.stopPropagation();var a=e("input[type='hidden']",this).val();t.options.addFunClick.call(t,i,a)})},_setNlpItemStyle:function(){var t=this,i=t.dataView.find("li[ismenu='false']"),a=i.find(".kd-fullsearch-item-author"),n=i.find(".kd-fullsearch-item-headertitle"),o=i.find("span[searchitem='group']").find("span[searchItem='key']");a.text(""),a.attr({title:""}),i.find(".kd-fullsearch-nlpitem").css({display:"inline-block"}),i.find(".kd-fullsearch-item-authorcontainer").css({display:"none"}),n.css({"max-width":"100%",width:"100%"}),n.find("span[searchitem='text']").css({"float":"right",color:"#999"}),i.css({height:"102px"});var r=t.dataView.find("li[issemanticsearch='true']");r.find("span[searchitem='group']").css({display:"none"}),r.css({height:"48px"}),e.each(o,function(t){var i=e(o[t]),a=i.length>0&&i.text();KD.isEmpty(a)&&i.next().hide()})},_change:function(e,t){var i=this;i.onChange(e,t.trim())},_generalDataSource:function(e,t,i){var a=this;if(!e)return[];var n=[];if(e)for(var o=0;o<e.length;o++){var r=e[o];i?n.push(r):n.push(a._getItemFw(r,t))}return n},_imagePath:"Images/kdcontrol/kdfullsearch/",_getItemFw:function(e,t){var i;if(e&&!KD.isEmpty(e.typeId)){var a;if(KD.equalsIgnoreCase(e.typeId,"SemanticSearch"))a=KD.getUrlSubRoot()+"/images/nlp/searchConditionImg.png",i={value:e.title,number:e.title,group:e.typeName,text:e.typeName,icon:a,favor:"",subsystem:"",fulltext:"",isrecentmenu:!1,subfuncname:"",domainname:"",ismenu:!1,issemanticsearch:!0,field1key:"",field1value:"",field2key:"",field2value:"",field3key:"",field3value:""};else{a=e.icon.slice(2),a=!KD.isEmpty(a)&&a.length>0?KD.getUrlSubRoot()+a:KD.getUrlSubRoot()+"/images/biz/default/MainConsole/H5CardLayout/CommFuncCard/kd_fullsearch_menu.png";var n=(e.action.args.methodParam&&e.action.args.methodParam[1],e.typeName.split(" - ")[0]),o=(e.typeName,e.title),r=!KD.isEmpty(e.summary.fields[0])&&e.summary.fields[0].value,s=!KD.isEmpty(e.summary.fields[1])&&e.summary.fields[1].value,l=e.domainName,d=KD.equalsIgnoreCase(e.typeId,"AppMenu")?!0:!1;i={value:e.action.args.methodParam[1],number:e.title.split(" ")[0],group:e.typeName,text:d?KD.isEmpty(e.summary.title)?"":e.summary.title:KD.isEmpty(e.subTitle)?"":e.subTitle,icon:a,favor:this._imagePath+"tree_leaf.png",subsystem:d?r:"",fulltext:n+","+o+","+this._imagePath+"tree_folder.png",isrecentmenu:!1,subfuncname:d?s:"",domainname:d?l:"",ismenu:d,issemanticsearch:!1,field1key:d?"":KD.isEmpty(e.summary.fields[0])?"":e.summary.fields[0].key,field1value:d?"":KD.isEmpty(e.summary.fields[0])?"":e.summary.fields[0].value,field2key:d?"":KD.isEmpty(e.summary.fields[1])?"":e.summary.fields[1].key,field2value:d?"":KD.isEmpty(e.summary.fields[1])?"":e.summary.fields[1].value,field3key:d?"":KD.isEmpty(e.summary.fields[2])?"":e.summary.fields[2].key,field3value:d?"":KD.isEmpty(e.summary.fields[2])?"":e.summary.fields[2].value}}}else a=KD.getUrlSubRoot()+"/images/biz/default/MainConsole/H5CardLayout/CommFuncCard/kd_fullsearch_menu.png",i={value:e[0],number:e[1],group:e[4],text:e[2],icon:a,favor:this._imagePath+"tree_leaf.png",subsystem:e[8],fulltext:e[1]+","+e[2]+","+e[4],isrecentmenu:KD.isEmpty(e[7])?!1:e[7],subfuncname:e[6],domainname:e[9],ismenu:!0,issemanticsearch:!1,field1key:"",field1value:"",field2key:"",field2value:"",field3key:"",field3value:""};return t&&(e[5]="",i={value:e[0],title:e[1],author:e[2],typename:e[3],focusbordercolor:this._getArticleFocusType(e[4]).bordercolor,focusname:e[5],focusshowmodel:KD.isEmpty(e[5])?"kd-hidden":"",url:e[6],description:e[8]}),i},_getItemTemplate:function(){var e=i.format("<li style='height: 22px;line-height: 20px;padding-top:2px;'><span searchitem='icon' class='k-icon k-i-group' style='vertical-align:top;margin-top: 3px;'></span><span searchItem='number' style='display: inline-block;padding-left: 5px;padding-right: 10px;width:100px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;'>{1}</span><span searchItem='text' style='display: inline-block;padding-left: 5px;padding-right: 10px;width:145px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;'>{2}</span><span searchitem='favor' class='k-icon k-i-columns' style='vertical-align:top;margin-top: 3px;'></span><span searchItem='group' style='display: inline-block;padding-left: 5px;width:195px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;'>{4}</span><a searchItem='add' style='display: none' href='javascript:void(0);' class='kendo-color' title='{6}'><input type='hidden'  value='{5}' /><img /></a><span searchItem='value' style='display: none;'>{5}</span></li>","#:icon #","#:number #","#:text #","#:favor #","#:group # ","#:value #",ResManager.LoadKDString("点击添加到常用功能","099002000000059"));return e=i.format("<li class='kd-fullsearch-item-container' issemanticsearch='{16}' ismenu='{9}'><span class='kd-fullsearch-item-title' style='max-width:360px;'><div class='kd-fullsearch-item-headertitle'><span searchitem='icon' style='background:url({0})' class='k-icon k-i-group kd-fullsearch-item-icon' ></span><span searchItem='number' title='{1}' style='padding-right:5px'>{1}</span><span searchItem='text' title='{2}'>{2}</span></div><a searchItem='add' href='javascript:void(0);' class='kendo-color kd-fullsearch-item-add' title='{6}'><input type='hidden' value='{5}' /><span class='kd-fullsearch-item-addstar'></span></a><span searchItem='value' style='display: none;'>{5}</span></span><span searchItem='group'  class='kd-fullsearch-item-authorcontainer' style='max-width: 100%;'><span searchitem='author' class='kd-fullsearch-item-author' title='{7}>{3}>{8}' style='width:100%;display:inline-block;overflow:hidden; text-overflow:ellipsis;'>{7}>{8}>{3}</span><span searchItem='date' class='kd-fullsearch-item-date' title='{3}' style='width: 40%;display: none;overflow:hidden;text-overflow:ellipsis;text-align:right;'>{3}</span></span><span searchItem='group'  class='kd-fullsearch-nlpitem' style='max-width: 100%;'><span searchItem='key'>{10} </span><span>: {11}</span></span><span searchItem='group'  class='kd-fullsearch-nlpitem' style='max-width: 100%;'><span searchItem='key'>{12} </span><span>: {13}</span></span><span searchItem='group'  class='kd-fullsearch-nlpitem' style='max-width: 100%;'><span searchItem='key'>{14} </span><span>: {15}</span></span></li>","#:icon #","#:number #","#:text #","#:subsystem #","#:group #","#:value #",ResManager.LoadKDString("点击添加到常用功能","099002000000059"),"#:domainname #","#:subfuncname #","#:ismenu #","#:field1key #","#:field1value #","#:field2key #","#:field2value #","#:field3key #","#:field3value #","#:issemanticsearch #")},closePopup:function(){var e=this;if(e.isPopup()){var t=e.popup.data("kendoPopup");t&&t.close()}return e},onPopClose:function(t){var i=this;n.fn.onPopClose.call(this,t);var a=window.event&&window.event.target;if((!a||!e(a).hasClass("kd-ui-viewTips")&&!e(a).hasClass("kd-guidepromptintro-maskLayer"))&&t&&t.sender&&t.sender.wrapper){var o=t.sender.wrapper,r=KD.getActiveElement();if(r&&r.length&&!r.hasClass("kd-fullsearch-searchtype")){var s=this.element.next();s.length&&s.hasClass("kd-fullsearch-searchicon")&&(s.closest(".kdfullsearchExtend").css("min-width","18px"),s.show()),this.element.hide(),i.controlProxy&&i.controlProxy.doParentLayout.call(i.controlProxy)}o.find(".kd-guidepromptintro-maskLayer").length>0&&(t.preventDefault(),KD.delayInvoke(function(e){e&&e.sender&&e.sender.wrapper.find(".kd-guidepromptintro-maskLayer").length>0&&e.sender.open()},10,!0,t),KD.delayInvoke(function(e){e&&e.sender&&e.sender.wrapper.find(".kd-guidepromptintro-maskLayer").length>0&&e.sender.open()},1e3,!0,t))}},_escapeRegex:function(e){return this.isChineseInput&&(e=this._inputText.trim().replace(/'/g,"")),e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g," ")},_filter:function(e,t,i){var a=this._escapeRegex(t).trim().split(/\s+/),n=this._eachInput(a,e);return i?n:this._sortFunctionListBySearchValue(n,a,t)},_eachInput:function(e,t){var i=[],a=[],n=t.length>0&&!KD.isEmpty(t[0].issemanticsearch)?t[0].issemanticsearch:!1;if(n)return t;for(var o in e)KD.isRunInForIn(o,e)&&a.push(new RegExp(e[o],"i"));var r,s,l=!1;(KD.isEmpty(e)||1==e.length&&KD.isEmpty(e[0]))&&(l=!0);for(var d=this.options.controlProxy.isAISearch,c=0;c<t.length;c++)if(r=t[c],l)d?i.push(r):!KD.isEmpty(r.isrecentmenu)&&r.isrecentmenu&&(i.push(r),this.options.controlProxy.recentMenuList.push(r));else for(var o in a)if(KD.isRunInForIn(o,a)&&(s=a[o],s.test(r.number+","+r.text+","+r.group)&&(KD.isEmpty(r.isrecentmenu)||!r.isrecentmenu))){i.push(r);break}return i},_sortFunctionListBySearchValue:function(e,t,i){var a=[],n=t;if(KD.isArray(t)||(n=[],n[0]=t),KD.isEmpty(n)||KD.isEmpty(n[0])||KD.isEmpty(e))a=e;else{for(var o,r=[],s=[],l=[],d=!1,c="",h="",u=0;u<e.length;u++)if(o=e[u],d=!1,c=(o.number||"").toLocaleLowerCase(),h=(o.text||"").toLocaleLowerCase(),n.length>1&&(i=this.getInput().val().trim().toLocaleLowerCase(),c.indexOf(i)>=0||h.indexOf(i)>=0))a.push(o),d=!0;else{if(!d)for(var p=0;p<n.length;p++)if(i=(n[p]||"").toLocaleLowerCase(),0==c.indexOf(i)||0==h.indexOf(i)){o.sortlevel=p,r.push(o),d=!0;break}if(!d)for(var p=0;p<n.length;p++)if(i=(n[p]||"").toLocaleLowerCase(),c.indexOf(i)>0||h.indexOf(i)>0){o.sortlevel=p,s.push(o),d=!0;break}!d&&l.push(o)}a=this._doSortAction(a),r=this._doSortAction(r),s=this._doSortAction(s),l=this._doSortAction(l),a=a.concat(r),a=a.concat(s),a=a.concat(l)}return a},_doSortAction:function(e){return e.sort(function(e,t){return e.sortlevel!=t.sortlevel?e.sortlevel<t.sortlevel?-1:1:e.number==t.number?e.text==t.text?e.group<t.group?-1:1:e.text<t.text?-1:1:e.number.length==t.number.length?e.number<t.number?-1:1:e.number.length<t.number.length?-1:1}),e},setArticleData:function(e){var t=this;t.onLoadOptions(t.options),t._initPopup();var a=t._generalDataSource(e,!0);t.articleData=a,t.articleDataView.data("kendoListView").setDataSource(new i.data.DataSource({data:a.slice(0,t.viewDisplayMaxCount)})),a.length>0&&t.isSearchArticle?t.articleDataView.show():t.articleDataView.hide(),t._setListCount()},_getArticleItemTemplate:function(){var e=i.format("<div class='kd-fullsearch-item-container'><span searchitem='title' class='kd-fullsearch-item-title {7}' title='{0}'>{0}</span><span searchItem='focustype' class='kd-fullsearch-item-focustype {7}' style='display:none;color:{1};border:1px solid {1};'>{2}</span><span searchItem='typename' class='kd-fullsearch-item-typename' style='display:none'>{3}</span><span class='kd-fullsearch-item-authorcontainer'><span searchitem='author' class='kd-fullsearch-item-author'  style=''>{4}</span></span><span searchItem='value' style='display: none;'>{5}</span></div>","#:title #","#:focusbordercolor #","#:focusname #","#:typename #","#:author # ","#:value #","#:url #","#:focusshowmodel #");return e=i.format("<li class='kd-fullsearch-item-container'><span class='kd-fullsearch-item-title' style='max-width:360px;'><span searchitem='icon' class='k-icon k-i-group kd-fullsearch-community-icon kd-fullsearch-item-icon' ></span><span searchItem='number'>{1}</span><span searchItem='text'>{2}</span><a searchItem='add' style='display: none' href='javascript:void(0);' class='kendo-color kd-fullsearch-item-add' title='{6}'><input type='hidden' value='{5}' /></a><span searchItem='value' style='display: none;'>{5}</span></span><span searchItem='group'  class='kd-fullsearch-item-authorcontainer' style='max-width: 100%;'><span searchitem='author' class='kd-fullsearch-item-author' title='{4}'  style='width:90%;display:inline-block;overflow:hidden; text-overflow:ellipsis;'>{4}</span><span searchItem='date' class='kd-fullsearch-item-date' title='{3}' style='width: 40%;display: inline-block;overflow:hidden;text-overflow:ellipsis;text-align:right;'>{3}</span></span></li>","#:icon #","#:title #","","","#:description # ","",ResManager.LoadKDString("点击添加到常用功能","099002000000059"))},focusTypeList:{1:{bordercolor:"#2386EE"},2:{bordercolor:"#FE7D00"},3:{bordercolor:"#F73D1B"},4:{bordercolor:"#FFBF00"},5:{bordercolor:"#1DBCBE"}},_getArticleFocusType:function(e){var t=this.focusTypeList[e];return KD.isEmpty(t)&&(t={bordercolor:"transparent",name:""}),t},initArticlePanel:function(t){var a=this,n=i.format('<div class="kd-fullSearchList-header"><div class="kd-fullSearchList-header-container"><span class="kd-fullSearchList-header-btn-parent"><span class="kd-fullSearchList-header-btn kd-select" role="function"><span class="kd-icon" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon.png")+');"></span><span class="kd-text">{0}</span></span></span></div><div class="kd-fullSearchList-header-container"><span class="kd-fullSearchList-header-btn-parent" style="border:none;"><span class="kd-fullSearchList-header-btn" role="article"><span class="kd-icon" style="background-image:url('+KD.getImageUrlByNameAndVersion("kd_icon.png")+');"></span><span class="kd-text">{1}</span></span></span></div><div class="kd-fullSearchList-header-listcount-container"><span class="kd-fullSearchList-header-listcount"><span class="kd-text">{2}</span><span class="kd-text kd-count">{3}</span><span class="kd-text">{4}</span></span></div><div class="kd-fullSearchList-header-searchresult-container"><span class="kd-fullSearchList-header-searchresult"><span class="kd-funsearch-result-icon"></span><span class="kd-funsearch-result-text">{5}</span><span class="kd-funsearch-searchvalue">{6}</span><span class="kd-funllsearch-searchresult"><span class="kd-text">{2}</span><span class="kd-text kd-count">{3}</span><span class="kd-text">{4}</span></span></span></div></div>',ResManager.LoadKDString("功能","0991733000003984"),ResManager.LoadKDString("知识","00214298000004799"),ResManager.LoadKDString("共","014003000001213"),"0",ResManager.LoadKDString("项","014003030039916"),ResManager.LoadKDString("搜索","00214298000004608"),"");a.dataViewHeader=e(n).appendTo(a.dataList),a.dataViewHeader.find(".kd-fullSearchList-header-btn").off("click").on("click",function(e){a.listHeaderClick.call(a,e)}),a.dataViewHeader.find(".kd-funllsearch-searchresult").off("click").on("click",function(e){});var o=ResManager.LoadKDString("没有找到关于","014003030040048"),r="",s=ResManager.LoadKDString("的搜索结果","014003030040049");KD.isEmpty(a.input.val())&&(o=ResManager.LoadKDString("您最近还没有搜索过任何内容","014003030040050"),r=s=""),a.dataViewEmptyTips=e(i.format('<div class="kd-fullSearchList-emptyTips" style="display:none;"><div class="kd-fullSearchList-emptyTips-log"></div><div class="kd-fullSearchList-emptyTips-text"><span class="kd-fullSearchList-emptyTips-text1">{0}</span><span class="kd-fullSearchList-searchvalue">{1}</span><span class="kd-fullSearchList-emptyTips-text2">{2}</span></div></div>',o,r,s)),a.dataViewEmptyTips.appendTo(a.dataList),a.articleDataView=e('<div unselectable1="on" style="display:none;max-height:480px;overflow-y:auto;position:static;">').appendTo(a.dataList),a.articleDataView.kendoListView({dataSource:[],template:a._getArticleItemTemplate(),autoBind:!0,selectable:!0,navigatable:!0,change:function(e){if(e&&e.sender&&a.options.controlProxy){var t=e.sender.dataItem(e.sender.current())||{},i=t.url,n="",o=ClientAppProxy.Current.getMainTab();o&&(n=o.getCurrentFormId());var r={};r.apitype="search",r.searchtext=a.getInputValue(),r.currentpageid=n,r.openurl=i;var s=a.options.controlProxy.getFormProxy();s.fireCustomEventsNoData("Kingdee.BOS.Knowledge","Kingdee.BOS.KnowledgeLinkOpen",KD.stringify(r)),s.fireEvent.call(s,"ButtonClick","btknowledgeSearchLinkOpen","knowledgeSearchLink",null)}}}),a.articleDataView.removeClass("k-widget"),a.articleSearchBtn=e(i.format('<div class="kd-fullsearch-btn-searcharticle">{0}</div>',ResManager.LoadKDString("搜索","00214298000004608"))),a.container.append(a.articleSearchBtn),a.articleSearchBtn.click(function(e){a.searchBtnClick.call(a)});var l=this.options.controlProxy;l&&l.component.find(".kd-editor-btn").off("mousedown").click(function(e){a.searchBtnClick.call(a)}),0==this.articleVisible&&this.setArticleVisible(this.articleVisible)},listHeaderClick:function(t,a){var n=this,o=this.options.controlProxy;if(this.isSearchArticle=!1,o){var r=e(t.target||t.currentTarget);if(r.hasClass("kd-fullSearchList-header-btn")||(r=r.parent()),KD.isEmpty(a)){var s=[];this.options.controlProxy.setData(s)}else{var l=KD.equalsIgnoreCase(a,"all")?"function":a,d=this.dataViewHeader&&this.dataViewHeader.find(i.format(".kd-fullSearchList-header-btn[role={0}]",l));!KD.isEmpty(d)&&d.length>0&&(r=d)}if(r.hasClass("kd-fullSearchList-header-btn")){if(this.isSearchArticle="article"==r.attr("role"),this.isSearchArticle)o.component.addClass("kd-fullsearch-mutifunc"),this.articleDataView.show(),this.dataView.hide(),this._setSearchTipsText(),KD.isEmpty(this.articleData)&&this.searchBtnClick(o);else{var c="function"==r.attr("role");o.component.removeClass("kd-fullsearch-mutifunc"),this.articleDataView.hide(),c||0==this.displayDataList.length?(this.dataView.show(),KD.delayInvoke(function(){var e=n.options.controlProxy.SearchTypeVal,t=n.input.val();n._setSearchTipsText(e,t),n._change(null,t)},50)):this.dataView.show()}this._setListCount()}}},_setSearchTipsText:function(t,i){return this.isSearchArticle?(e(".kd-funsearch-result-icon",this.dataViewHeader).hide(),e(".kd-funsearch-searchvalue",this.dataViewHeader).text(""),e(".kd-funsearch-result-text",this.dataViewHeader).css({"margin-left":"14px"}).text(ResManager.LoadKDString("为您推荐当前页面常见问题","014003000005324")),e(".kd-funllsearch-searchresult",this.dataViewHeader).hide(),this.dataViewEmptyTips.find(".kd-fullSearchList-emptyTips-text1").text(ResManager.LoadKDString("没有找到关于","014003030040048")),void this.dataViewEmptyTips.find(".kd-fullSearchList-emptyTips-text2").text(ResManager.LoadKDString("的搜索结果","014003030040049"))):void(KD.isEmpty(i)?(e(".kd-funsearch-result-icon",this.dataViewHeader).hide(),e(".kd-funsearch-result-text",this.dataViewHeader).css({"margin-left":"14px"}).text(ResManager.LoadKDString("最近搜索历史","014003030039900")),e(".kd-funsearch-searchvalue",this.dataViewHeader).hide(),e(".kd-funllsearch-searchresult",this.dataViewHeader).hide()):(e(".kd-funsearch-result-icon",this.dataViewHeader).show(),e(".kd-funsearch-result-text",this.dataViewHeader).css({"margin-left":"4px"}).text(ResManager.LoadKDString("搜索","00214298000004608")),e(".kd-funsearch-searchvalue",this.dataViewHeader).show(),e(".kd-funllsearch-searchresult",this.dataViewHeader).show()))},searchBtnClick:function(t){var i=t||this.options.controlProxy,a=this.input.val(),n=this.options.controlProxy.isAISearch;if(i&&this.isSearchArticle){this.articleDataView.show();var o=this.articleDataView.find(".kd-ui-blockingExtention-item");o.length<1&&(o=e('<div class="kd-ui-blockingExtention-item" style="position:absolute;top: 34px;background-color:#FFF;width:100%;bottom:0px;box-shadow: none;"><img src="content/themes/images/ui_loading.gif"></div>'),o.appendTo(this.articleDataView));var r=i.getFormProxy(),s={};s.value=a,s.type="article",s.guidvisible=i.isShowFunctionGuid?"true":"",s.currentpageid="";var l=ClientAppProxy.Current.getMainTab();l&&(s.currentpageid=l.getCurrentFormId()),$this.oldsearchvalue=a,r.fireEvent.call(r,"CustomEvents",i.key,"Kingdee.BOS.FullSearch.Search",KD.stringify(s)),r.fireEvent.call(r,"ButtonClick","btKnowledgeSearch","KnowledgeSearch",null)}else n&&this._GetFastResult(a)},_setListCount:function(){var e=this.dataViewHeader.find(".kd-funllsearch-searchresult .kd-count"),t=this.dataViewHeader.find(".kd-fullSearchList-header-searchresult .kd-funsearch-searchvalue"),i="0";1!=this.isSearchArticle?this.displayDataList&&(i=this.displayDataList.length>this.viewDisplayMaxCount?">"+this.viewDisplayMaxCount:this.displayDataList.length):this.articleData&&(i=this.articleData.length>this.viewDisplayMaxCount?">"+this.viewDisplayMaxCount:this.articleData.length),e.text(i);var a=this.input.val();t&&t.length>0&&1!=this.isSearchArticle&&!KD.isEmpty(a)&&t.text("“"+this.input.val()+"”"),this.dataViewEmptyTips&&(i+""=="0"?(!KD.isEmpty(a)||KD.isEmpty(a)&&""!==a?(this.dataViewEmptyTips.find(".kd-fullSearchList-emptyTips-text1").text(ResManager.LoadKDString("没有找到关于","014003030040048")),this.dataViewEmptyTips.find(".kd-fullSearchList-emptyTips-text2").text(ResManager.LoadKDString("的搜索结果","014003030040049")),this.dataViewEmptyTips.find(".kd-fullSearchList-searchvalue").text("“"+this.input.val()+"”")):(this.dataViewEmptyTips.find(".kd-fullSearchList-emptyTips-text1").text(ResManager.LoadKDString("您最近还没有搜索过任何内容","014003030040050")),this.dataViewEmptyTips.find(".kd-fullSearchList-emptyTips-text2").text(""),this.dataViewEmptyTips.find(".kd-fullSearchList-searchvalue").text("")),this.dataViewHeader.hide(),this.dataViewEmptyTips.show()):(this.dataViewEmptyTips.hide(),this.dataViewHeader.show())),this.isSearchArticle?(this.dataView.hide(),this.articleDataView.show()):(this.dataView.show(),this.articleDataView.hide())}});a.plugin(o)}(window.kendo.jQuery),define("KDFullSearch",["KDPopListEdit","KD"],function(e){return function(){var t;return t||e.KDFullSearch}}(this)),KDFullSearchProxy=KD.extend(KDControlProxy,{menuData:[],Icon:"../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/kd_fullsearch_menu_Seach.png",SearchTypeList:[],SearchTypeVal:"",NLPData:[],isNlpData:!1,isAISearch:!1,recentMenuList:[],recentMenuState:!1,aiSearchTooltips:ResManager.LoadKDString("张三本周创建的费用报销单","014003030040047"),usualSearchTooltips:ResManager.LoadKDString("请输入内容进行搜索","014003030040102"),menuPopWidth:280,setData:function(e){var t=this;if(KD.isArray(e))0==e.length?t.menuData=e:t.menuData=e;else{var i=KD.parseObject(e);t.isAISearch=i.isaisearchdata,$(".k-input",this.component).attr("placeholder",t.aiSearchTooltips),!KD.isEmpty(i.recentmenuitem)&&i.recentmenuitem.length>0?t.recentMenuList=t.menuData=i.recentmenuitem:t.menuData=null}t.component.data(t.getKendoCType()).setData(t.menuData)},setNLPData:function(e){var t=this;try{if(this.isNlpData=!0,e.length>0){if(!KD.isEmpty(e[0])&&!KD.isEmpty(e[0].typeId)&&KD.equalsIgnoreCase(e[0].typeId,"SemanticSearch"))return t.NLPData.unshift(e[0]),void t.component.data(t.getKendoCType()).setData(t.NLPData,!1,!0);t.component.data(t.getKendoCType()).setData(e,!1,!0),t.NLPData=e,t.menuData=e}}catch(i){KD.writeLog(i.message,i.stack,!0)}},setArticleData:function(e){var t=this;KD.isEmpty(e)&&(e=[]),t.component.data(t.getKendoCType()).setArticleData(e)},setArticleVisible:function(e){this.component.data(this.getKendoCType()).setArticleVisible(e);var t=$("#fullSearch_SelectSearchType").data("kendoDropDownList");if(!KD.isEmpty(t)&&!e){var i,a=t.dataSource.data();if(a&&a.length>0){for(var n=0;n<a.length;n++){var o=a[n]&&a[n].ID;!KD.isEmpty(o)&&KD.equalsIgnoreCase(o,"help")&&(i=n)}i&&t.dataSource&&t.dataSource.remove(a[i])}}},setFunctionGuid:function(e){if(!KD.isEmpty(e)&&KD.isObject(e)){this.isShowFunctionGuid=e;var t=this.component.find(".kd-ui-function-guid");e.visible?0==t.length?this.component.append($(kendo.format('<div class="kd-ui-function-guid" title="{0}"></div>',e.tooltip))):t.show():t.hide()}},showMessage:function(e){this._interShowMessage(e,!1)},showErrMessage:function(e){this._interShowMessage(e,!0)},_interShowMessage:function(e,t){var i=this,a=i.menuPopWidth+"px",n=$("<div id='fullSearchShowMessage' class='k-block'></div>").text(e).css({width:a,height:"50px"});t?n.addClass("kd-fullsearchcummonfun-error k-error-colored"):n.addClass("kd-fullsearchcummonfun-success k-success-colored"),$("body").append(n);var o=n.kendoPopup({anchor:i.el,origin:"bottom right",position:"top right"}).data("kendoPopup");o.open(),setTimeout(function(){o.close(),n.remove()},1e3*KD.getLocalConfiguration().MessageDisTime)},createInnerDom:function(){return $("<div>")},getKendoCType:function(){return"kendoKDFullSearch"},getKendoOptions:function(){var e=this,t=KDFullSearchProxy.superclass.getKendoOptions.call(this);return $.extend(t,this.config,{controlProxy:e,isNeedAutoTip:!1,change:function(t,i,a){e.onchange.call(e,t,i,a)},keydown:function(e){},keyup:function(t){e.onkeyup.call(e,t)},addFunClick:function(t,i){e.onAddFunClick.call(e,t,i)},selectItem:function(e){}}),t},onAddFunClick:function(e,t){var i=this;KD.IsNullOrWhiteSpace(t)||i.getFormProxy().fireCustomEvents(i.config.id,"AddFunClick",t)},onchange:function(e,t,i){var a=this;if(i&&a._reAssignMenuData(a,t,a.menuData),!KD.IsNullOrWhiteSpace(t)){var n=a.getFormProxy();n.lockControl.call(n,a),KD.delayInvoke(function(){var e,i=a.NLPData;if(a.isAISearch&&!KD.isEmpty(i)&&i.length>0&&!a.recentMenuState){var o,r={},s=null,l=[];if(!KD.isEmpty(i[0].typeId)&&KD.equalsIgnoreCase(i[0].typeId,"SemanticSearch")){o="ShowBillForm",o="NLPSearch";for(var d={},c=0;c<i.length;c++){var h=i[c];KD.equalsIgnoreCase(h.title,t)&&(d.type=h.action.args.type,d.text=h.action.args.text,d.nluText=h.action.args.nluText,d.semanticSearch=h.action.args.semanticSearch,d.billFormId=h.action.args.billFormId,d.filters=h.action.args.filters)}var u=KD.isString(d)?d:KD.stringify(d);return void(n&&n.fireCustomEvents.call(n,"FNLPSEARCHRESULTPANEL","NLPSearch",u))}for(var c=0;c<i.length;c++){var p=i[c],g=p.action&&p.action.args&&p.action.args.methodParam;if(!KD.isEmpty(g)&&g.length>0&&t==g[1]){s=g,e=KD.equalsIgnoreCase(p.typeId,"AppMenu")?!0:!1;break}}o=e?"ShowAppMenu":"ShowBillForm",l.push(s[0]),l.push(s[1]),r.methodParam=l;var u=KD.isString(r)?r:KD.stringify(r);n&&n.fireCustomEvents.call(n,"FNLPSEARCHRESULTPANEL",o,u)}else n.fireEventNoData.call(n,"SearchItemSelected",a.key,t);a.component.data(a.getKendoCType()).closePopup()})}},_reAssignMenuData:function(e,t,i){var a=this,n=a.isAISearch;$("input.k-input",a.component).val();if(!KD.isEmpty(t)){var o=[],r=[],s=-1;if(!KD.isEmpty(i)&&0!=i.length){$.each(i,function(e){var a=i[e];if(!KD.isEmpty(a)){var r,l=!0;n&&!KD.isEmpty(a.action)?r=a.action.args.methodParam[1]:(r=a[0],(KD.isEmpty(a[7])||a[7])&&(l=!1)),KD.equalsIgnoreCase(r,t)&&l&&(o.push(a),1==a[7]&&(s=e))}});var l=!1;n?$.each(e.recentMenuList,function(i){var a=e.recentMenuList[i],o=n?a[0]:a.value;KD.equalsIgnoreCase(o,t)&&(l=!0,r.push(a),s=i)}):$.each(i,function(e){var a=i[e],n=a[0],o=a[7];KD.equalsIgnoreCase(n,t)&&o&&(l=!0,r.push(a),s=e)});var d=l?r[0]:o[0];d=d?d:[];var c=a._AISearchtransfer2NormalItem(d);l?n?e._swapArray(e.recentMenuList,s,d):(e._swapArray(i,s,c),c=a._transfer2RecentItem(d),e._swapArray(e.recentMenuList,s,c)):n?e.recentMenuList.unshift(c):(i.unshift(c),c=a._transfer2RecentItem(d),e.recentMenuList.unshift(c)),e.setData(i)}}},_AISearchtransfer2NormalItem:function(e){var t=[];if(e&&!KD.isEmpty(e.typeId)){var i=(e.action.args.methodParam&&e.action.args.methodParam[1],e.typeName.split(" - ")[0],e.typeName),a=(e.title,!KD.isEmpty(e.summary.fields[0])&&e.summary.fields[0].value),n=!KD.isEmpty(e.summary.fields[1])&&e.summary.fields[1].value,o=e.domainName;KD.equalsIgnoreCase(e.typeId,"AppMenu")?!0:!1;t[0]=e.action.args.methodParam[1],t[1]=e.title.split(" ")[0],t[2]=e.summary.title,t[3]=e.icon,t[4]=i,t[5]=!1,t[6]=a,t[7]=!0,t[8]=n,t[9]=o}else KD.isEmpty(e[0])?t=e:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=!0,t[8]=e[8],t[9]=e[9]);return t},_transfer2RecentItem:function(e){var t=KD.getUrlSubRoot()+"/images/biz/default/MainConsole/H5CardLayout/CommFuncCard/kd_fullsearch_menu.png",i={value:e[0],number:e[1],group:e[4],text:e[2],icon:t,favor:this._imagePath+"tree_leaf.png",subsystem:e[8],fulltext:e[1]+","+e[2]+","+e[4],isrecentmenu:!0,subfuncname:e[6],domainname:e[9],ismenu:!0,issemanticsearch:!1,field1key:"",field1value:"",field2key:"",field2value:"",field3key:"",field3value:""};return i},_transfer2Smu:function(e){var t;if(e&&!KD.isEmpty(e.typeId)){var i;KD.equalsIgnoreCase(e.typeId,"SemanticSearch")&&(i=KD.getUrlSubRoot()+"/images/nlp/searchConditionImg.png",t={value:e.title,number:e.title,group:e.typeName,text:e.typeName,icon:i,favor:"",subsystem:"",fulltext:"",isrecentmenu:!1,subfuncname:"",domainname:"",ismenu:!1,issemanticsearch:!0,field1key:"",field1value:"",field2key:"",field2value:"",field3key:"",field3value:""})}},_swapArray:function(e,t,i){return e.splice(t,1),e.unshift(i),e},onkeyup:function(e){var t=this;t.onchange.call(t,e,t.el.val())},loadConfig:function(e){KDFullSearchProxy.superclass.loadConfig.call(this,e),this.Icon=KD.getValue(e,"icon",this.Icon),this.setRequestLock(!1),"1033"==ResManager.Language&&(this.menuPopWidth=440),e.data&&this.setData(e.data),this.el.css("overflow","hidden")},initComponent:function(){var e=this;KDFullSearchProxy.superclass.initComponent.call(this),this.config.isToggle?this._toggleComponent():this._commonComponent(),$(".kd-popListEdit-warp",this.component).length>0&&$(".kd-popListEdit-warp",this.component).click(function(t){if(ClientAppProxy.Current&&ClientAppProxy.Current.delayClickRequest&&ClientAppProxy.Current.delayClickRequest.length>0){var i=e.getFormProxy();i&&i.fireCustomRequest.call(i,ClientAppProxy.Current.delayClickRequest),ClientAppProxy.Current.delayClickRequest=null}if(!e.disabled){var a=e.component.data(e.getKendoCType());a.controlProxy=e;var n=e.component.height()+e.component.offset().top,o=296;$(window).innerHeight()<n+336&&(o=$(window).innerHeight()-n-15-40,o=70>=o?70:o),a&&a.dataView&&a.dataView.css&&a.dataView.css("max-height",o),a&&a.articleDataView&&a.articleDataView.css&&a.articleDataView.css("max-height",o),a.openPopup()}}),this.el.addClass("kdfullsearchExtend"),this.component.hide(),e.iconSrc=e.iconSrc||e.getDefIconSrc();var t=$('<img class="kd-fullsearch-searchicon">');t.attr({src:this.Icon}).appendTo(e.el),t.off("click").on("click",function(t){e.el.css("min-width","286px"),e.component.show(),KD.delayInvoke(function(t){$("input.k-input",e.component).focus(),$(".kd-popListEdit-warp",e.component).length>0&&$(".kd-popListEdit-warp",e.component).click()},100),$(this).hide(),e.doParentLayout.call(e)})},getDefIconSrc:function(){var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAnCAYAAABjYToLAAADK0lEQVRYR92YzW8NYRTGz3OG9g+QSFo0LCUlEa2wtvFRaWNtVR/1FSIiUSsrXRFERUtYsPXRKNKNLfERiRKRCIJUSIStMu8jR95JpnNn5s7cq7037vLOeef93XOe9znnvZAm/aBJueT/BCPZKSJLRaRdRBaIyDcRmRKR9wBe1FON0hkjudY5tw1AL4DFWZuT/ERyTFWvAXhYFrIwGMnlJIcMqOwmBghgEMCromsLgZE8QPIUgMBeTPKniNwHMCYiT3z5rIxWTitrF0n7AesBtPg1vwEcBnC2CFwuGMn5zrnzqrojejnJy6p6HMDnahuQbHPOWWw/gHkW75y7pKp7AfzKW58LFobhxRjUBwB9AJ5VA0o+J7mK5C0AHRFcEAQ7awKz8onIGZ+pxwB6AHwtCxXFk1xIchxAt//uYF5ZUzPmhT5pmiJpmequByoBZz+yg6RpbmXWgUgFc85Z2nv94jW1lC/HRqysj0xz3k760mIrwMynROSB18JoEAQDtZYva10YhiOquss/X5fmcxVgYRgO26kxSwCwrMjpKwtup5XkOwCtzrnhIAj2J99RAeac+2iOTvKeqm4qu2nReOfcXQAbrUOo6pJcMN/7Jn3QbgAjRTcqG0fSJHLBr1uR7K0zMkayR0Ru++AuAE/Lblg0nuRq3zVsyRYA4/G1STATZJSl9tnQV8w62nwrs68GAIzmgQ2KyAkf0ApgumgGysaRtB5qPdc+xwAMNWPG9gCI9PaXr1k0thXAzbyM2UTaiFPZCeBlJpg9aICPTanqoqoGG4bhOVXdNwfOb/eCFufclSAI+quCNaBXpvplo6eLCVXdkGY1efPYcz+azNY8ZkOCzXnRYZvBlzlaz8EEewjA6SxjbsjM72Eq+mOuXcQf/sNb0vbo6hfrldMAzFjvFNZYMtDfK09GV7Aa75WmqaMi8obkdbMKkplwhS68BlrnTXwCwJFI6CQ3k7yRB1cYLFaCov9dTJE0OxhOm+uqwZUGS2gw+W/PDxH5IiKvk70vTUd5cHWBlZ3BysA1HMzrN6657wDamgIsBncVwFsR6W4aMA/XKiJmIWwqsLgG/wDkFEZIo9LRQwAAAABJRU5ErkJggg==";return e},_commonComponent:function(){$(".k-input",this.component).attr("placeholder",$this.usualSearchTooltips),$(".ui-poplistedit-displayname",this.component).attr("title",ResManager.LoadKDString("输入要搜索的关键字，以空格分隔","0141072000004784")),$(".k-input",this.component).css({width:"250px",height:"26px","margin-left":"30px","border-radius":"4px"}),$(".ui-poplistedit-displayname",this.component).css({height:"26px",width:"250px","line-height":"26px"
}),$(".k-input",this.component).addClass("kendo-panel-background-color"),$(".k-select",this.component).addClass("kd-fullsearch-span")},_getComparerTypesEnumSource:function(e){var t=[];if(e)for(var i=0;i<e.length;i++){var a=e[i];t.push($.extend(a,{alias:a.Name,value:a.ID}))}return t},setSearchTypeList:function(e){var t=this;if(KD.isArray(e)&&0!=e.length)this.SearchTypeList=t._getComparerTypesEnumSource(e);else{var i=[];i.push({ID:"AppMenu",value:"AppMenu",Name:ResManager.LoadKDString("应用菜单","014003030040103"),Caption:ResManager.LoadKDString("应用菜单","014003030040103")}),i.push({ID:"Help",value:"Help",Name:ResManager.LoadKDString("社区知识","014003030040104"),Caption:ResManager.LoadKDString("社区知识","014003030040104")}),this.SearchTypeList=t._getComparerTypesEnumSource(i)}this.SearchTypeList.length>0&&!KD.isEmpty(t.SearchTypeList[0].value)&&(t.SearchTypeVal=t.SearchTypeList[0].value);var a=$("#fullSearch_SelectSearchType");a.kendoDropDownList({dataSource:this.SearchTypeList,popup:{position:"top left"},autoWidth:!0,template:'<div class="kd-fullsearch-typeitem"><span class="kd-ui-icon kd-ui-icon-seek-right" style="visibility:hidden;float:left;background-image:url(../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/kd_fullsearch_check.png)"></span><span class="kd_fullsearch-dropdownval" title="#: alias #">#: alias #</span></div>',valueTemplate:'<span title="#: alias #" class="kd-fullsearch-searchdisplayname"> #: alias #</span>',dataTextField:"alias",noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490"),dataValueField:"value",dataBound:function(e){},change:function(e){var i,a=this.value();switch(a.toUpperCase()){case"ALL":$(".k-input",t.component).attr("placeholder",t.aiSearchTooltips),i="all";break;case"APPMENU":i="function",$(".k-input",this.component).attr("placeholder",t.usualSearchTooltips);break;case"HELP":i="article",$(".k-input",this.component).attr("placeholder",t.usualSearchTooltips);break;default:$(".k-input",t.component).attr("placeholder",t.aiSearchTooltips)}var n=t.component&&t.component.data&&t.component.data(t.getKendoCType());KD.isEmpty(n)||n.listHeaderClick(e,i),$(".kd-appplat-searchinput",t.component).focus(),$(".kd-popListEdit-warp",t.component).length>0&&$(".kd-popListEdit-warp",t.component).click()},open:function(e){var i=e.sender&&e.sender.popup&&e.sender.popup.element,a=t.component&&t.component.data&&t.component.data(t.getKendoCType());!KD.isEmpty(i)&&i.length>0&&(i.addClass("kd-fullsearch-searchtypepopup"),a.closePopup()),KD.delayInvoke(function(){var i=e.sender&&e.sender.popup&&e.sender.popup.wrapper,a=i.find(".k-list-container");if(!KD.isEmpty(a)&&a.length>0){var n;if(t.SearchTypeList.length<=2)n=96;else{var o=0;t.SearchTypeList.length>2&&(o=kendo.support.scrollbar(),KD.isIeBrowser()&&(o=40));var n=(a.width()>0?a.width():150,a.width()+o)}a.css({width:n+"px","max-width":"160px"})}},300)},close:function(e){var i=KD.getActiveElement(),a=this.value();i&&i.length&&!i.hasClass("kd-appplat-searchinput")&&KD.equalsIgnoreCase(a,t.SearchTypeVal),t.SearchTypeVal=a}}).data("kendoDropDownList")},_toggleComponent:function(){var e=this;$(".k-input",this.component).attr("placeholder",e.usualSearchTooltips),$(".ui-poplistedit-displayname",this.component).attr("title",ResManager.LoadKDString("输入要搜索的关键字，以空格分隔","0141072000004784")),$(".k-input",this.component).css({width:"190px",height:"28px","margin-left":"0px","border-radius":"2px","margin-right":"0px"}),autocomplete="off",$(".ui-poplistedit-displayname",this.component).css({height:"28px",width:"190px","line-height":"28px","padding-left":"0px"}),$(".k-input",this.component).addClass("kd-appplat-searchinput"),$(".k-state-default",this.component).css({background:"#FFFFFF",overflow:"hidden","border-radius":"2px"}),$(".k-select",this.component).addClass("kd-fullsearch-span").css({display:"none"}),$(".kd-popListEdit-warp",this.component).css({display:"inline-block","border-radius":"0px 4px 4px 0px"});var t="1033"==ResManager.Language?"kd-fullsearch-ensearchtype":"",i=$(kendo.format('<select id="fullSearch_SelectSearchType" class="kd-fullsearch-searchtype {0}"></select>',t));$(".kd-fullsearch-span",this.component).empty(),this.component.append(i)},simulatedSearch:function(e){var t;if(this.component){e=e||{};var i=this.component.data(this.getKendoCType());if(this.setSearchText(e),"article"==e.focustype?this.setArticleData(e.dataList):i.openPopup(),t=this.component,e.focustype){var a=i.popup.find(".kd-fullSearchList-header-btn-parent [role="+e.focustype+"]");a.click(),e.isneedfocustypebtn&&(t=a.closest(".kd-fullSearchList-header-btn-parent"))}var n=i.popup.data("kendoPopup");KD.delayInvoke(function(e){e.addClass("kd-guidepromptintro-outer")},10,!0,n.wrapper),i.popup.append($('<div class="k-block kd-guidepromptintro-maskLayer" style=" position: absolute;background-color: transparent"></div>')),this.component.addClass("kd-guidepromptintro-relative")}return t},setSearchText:function(e){if(this.component){e=e||{};var t=this.component.data(this.getKendoCType());t.val(e.text),t.onChange({},e.text),t.openPopup()}},afterGuideClose:function(e){if(this.component){var t=this.component.data(this.getKendoCType()),i=t.popup.data("kendoPopup");i.wrapper.removeClass("kd-guidepromptintro-outer"),i.wrapper.find(".kd-guidepromptintro-maskLayer").remove(),this.component.removeClass("kd-guidepromptintro-relative"),t.val(""),t.showDisplayer(!1),t.onChange({},""),this.setArticleData([]),0!=e.isNeedClosepop&&t.closePopup()}},closeSearchInput:function(){var e=this;e.component&&(e.el.find(".kd-fullsearch-searchicon").show(),e.component.hide())},showSearchInput:function(){var e=this;e.component&&(e.el.find(".kd-fullsearch-searchicon").hide(),e.component.show())},doLayout:function(){var e=this;if(KDFullSearchProxy.superclass.doLayout.call(this),e.component){var t=e.el.offset(),i=e.component.data&&e.component.data(e.getKendoCType()).popup,a=e.component.find("#fullSearch_SelectSearchType").data("kendoDropDownList");i&&i.closest(".k-animation-container").is(":visible")&&i.closest(".k-animation-container").css("left",t.left),a&&a.popup&&a.popup.wrapper&&a.popup.wrapper.css("left",t.left)}}}),KDControlFactoryProxy.registerType("kdfullsearch",KDFullSearchProxy),define("KDFullSearchProxy",["KDControlProxy","KDFullSearch","KD"],function(e){return function(){var t;return t||e.KDFullSearchProxy}}(this)),function(e){var t=window.kendo,i=t.ui,a=i.Widget,n=a.extend({imageEditEl:null,imgEl:null,loading:null,config:null,init:function(i,n){var o=this;a.fn.init.call(this,i,n),o.config=n;var r="",s="";if(n.baseId){var l=KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),d=n.isCanDownland?"inline-block":"none",c=t.format('<span id="{0}_down"  alt="down" title="{1}" class="KDImageEditIcon" style="background-image:url({2});display:{3}"></span>',n.baseId,ResManager.LoadKDString("下载","014005030037576"),l,d),h=n.isCanDownland?75:50;r=t.format('<div class="KDImageEditTBContainer" style="width: 100%; text-align: center; bottom: -2px; position: absolute; z-index: 4;"><div class="KDImageEditIconContainer" style="background-color: #E4E4E4; margin: 0px auto; width:{0}px; height: 30px;border-radius: 10px; overflow: hidden;"><span id="{1}_clear" alt="clear" title="{2}" class="KDImageEditIcon KDImageEditIcon_delete" style="background-image: url({5});"></span><span id="{1}_open"  alt="open"  title="{3}" class="KDImageEditIcon" style="background-image: url({5});"></span>{4}<input type="file" id="{1}_file" style="visibility:hidden;height:0px;width:0px;" ></div></div>',h,n.baseId,ResManager.LoadKDString("删除","0991733000003902"),ResManager.LoadKDString("打开","0025710000004944"),c,l),o.imageEditEl=e(r);var u=e('<img id="'+n.baseId+'_c" style="line-height: 21px; border: 0px;height: auto;width: auto;vertical-align: middle" class="kd-control-pic-uniform" >'),p=e('<div role="imgViewTip" class="kd-imgview-tip" ><span role="title">'+ResManager.LoadKDString("点击放大","0991733000008104")+"</span></div>");o.loading=e('<span class="k-loading" style="height: inherit;width: inherit;position: absolute;left: 0;"></span>'),s='<span style="display: inline-block;vertical-align: middle;height:100%"></span>',e(i).append(o.imageEditEl,s).css({"text-align":"center"}),n.isinitelemnt&&(o.imageEditEl.after(u),u.attr("src",n.imgsrc),this.imgEl=u,this.setIsuniform()),o.imageEditEl.after(p),o.loadConfig(n),p.find('[role="title"]').height()>20&&(p.find('[role="title"]').addClass("kd-text-ellipsis"),p.attr("title",ResManager.LoadKDString("点击放大","0991733000008104"))),p.hide()}o.setFileFilter(n.fileFilter)},options:{name:"KDImageEdit"},getContent:function(){return this.fw},loadConfig:function(t){var i=this,a=this.element,n=this.config,o=ResManager.LoadKDString("支持ctrl+v粘贴截图","014005030043951"),r={};return 0==a.hscroll&&(r["overflow-x"]="hidden"),0==a.vscroll&&(r["overflow-y"]="hidden"),r.length&&0!=r.length&&a.getContent().css(r),a.ready(function(){a.isReady=!0,a.controlproxy=i,a.hover(function(){if(a.find('[role="imgViewTip"]').show(),1==n.enable&&0!=n.isShowMenu){a.find(".KDImageEditTBContainer").css("display","block");var e=n.isCanDownland?"75px":"50px";a.find(".KDImageEditIconContainer").css("width",e),a.find('span[alt="open"]').removeClass("KDImageEditIcon_hidden"),a.find('span[alt="clear"]').removeClass("KDImageEditIcon_hidden"),n.setPasteObj&&KD.isFunction(n.setPasteObj)&&n.setPasteObj()}else 0==n.enable&&n.isCanDownland&&(a.find(".KDImageEditTBContainer").css("display","block"),a.find(".KDImageEditIconContainer").css("width","28px"),a.find('span[alt="open"]').addClass("KDImageEditIcon_hidden"),a.find('span[alt="clear"]').addClass("KDImageEditIcon_hidden"))},function(){a.find('[role="imgViewTip"]').hide(),a.find(".KDImageEditTBContainer").css("display","none")}),a.attr("title",o),a.find(".KDImageEditIcon").hover(function(){e(this).css("background-color","rgba(209,209,209,0.5)")},function(){e(this).css("background-color","transparent")}),a.find("#"+n.baseId+"_open").click(function(){a.find("#"+n.baseId+"_file").click()}),a.find("#"+n.baseId+"_down").click(function(e){!i._isEmpty()&&n.isCanDownland&&n.downclick.call(a,e)}),a.find("#"+n.baseId+"_clear").click(function(){if(!i._isEmpty()){var e={name:ResManager.LoadKDString("金蝶提示","099002000000002"),msg:ResManager.LoadKDString("确定删除吗?","0991733000005634"),type:KDMessageBox.KDMesBoxType.Question,button:KDMessageBox.KDMessageBoxButtons.OkCancel,callback:i._clearClickCallback,callbackentity:i};KDMessageBox.show(e)}}),a.find(".KDImageEditTBContainer").click(function(t){var i=n.baseId+"_c",o=e(this).next("#"+i);o&&o.length>0&&n.onclick&&n.onclick.call(a,t)}),a.find(".KDImageEditTBContainer").dblclick(function(t){var i=n.baseId+"_c",o=e(this).next("#"+i);o&&o.length>0&&n.ondblclick&&n.ondblclick.call(a,t)});var t=a.find('[role="imgViewTip"]');t.length>0&&t.click(function(e){1==n.enable&&a.controlproxy&&a.controlproxy._isEmpty()?0!=n.isShowMenu&&a.find("#"+n.baseId+"_file").click():n.ondblclick&&n.ondblclick.call(a,e)})}),a.layoutOptions},_clearClickCallback:function(e,t){(e==KDMessageBox.KDDialogResult.Ok||e==KDMessageBox.KDDialogResult.Yes)&&this.config&&this.config.onchange&&this.config.onchange("")},click:function(){document.getElementById(this.baseId+"_file").outerHTML=document.getElementById(this.baseId+"_file").outerHTML,document.getElementById(this.baseId+"_file").click()},setDisabled:function(e){this.config.enable=!e},_url:null,getImgElement:function(e){return'<img id="'+this.config.baseId+'_c" style="height:inherit;width:inherit;line-height: 21px; border: 0px; " src="'+e+'">'},src:function(t){var i=this;if("undefined"==typeof t)return this._url;this._url=t;var a=this.config.baseId+"_c";this.imgEl&&(this.imgEl.remove(),this.loading.remove());var n=new Image;n.onload=function(){n.onload=null,i.loading&&(i.loading.after(i.imgEl),i.loading.remove()),i.imgEl.click(function(e){i.config.onclick&&i.config.onclick.call(i,e)}),i.imgEl.dblclick(function(e){i.config.ondblclick&&i.config.ondblclick.call(i,e)})},n.onerror=function(){n.onerror=null,i.config.onloaderror&&i.config.onloaderror.call(i,i.imgEl)},n.id=a,this.imgEl=e(n),this.imgEl.css({"line-height":"21px",border:"0px",height:"auto",width:"auto","vertical-align":"middle"}),this.setIsuniform(),this.imageEditEl.after(this.loading),this.imgEl.attr("src",t)},setFileFilter:function(e){if(this.imageEditEl){var t=this.imageEditEl.find("#"+this.config.baseId+"_file"),i=this._formatFileType(e);t.attr({accept:i})}},_formatFileType:function(e){var t="image/png,image/pjpeg,.jpeg";if(!KD.isEmpty(e)){t="";var i,a=e.split("|");for(var n in a)i=a[n],i.indexOf("*.")>=0&&(t+=this.fileTypeToAceeptType(i),n<a.length-1&&(t+=","))}return t},fileTypeToAceeptType:function(e){if(!KD.isEmpty(e)){var t="";switch(e){case"*.jpg":t="image/pjpeg";break;case"*.png":t="image/png";break;case"*.jpeg":t=".jpeg";break;default:t="image/"+e.substring(e.indexOf("*.")+2)}return t}},_isEmpty:function(){var e=!1,t=this.src();return(KD.isEmpty(t)||t==this.config.defaultUrl)&&(e=!0),e},setIsuniform:function(e){this.options&&(KD.isEmpty(e)||(this.options.isUniform=e),this.imgEl&&(0==this.options.isUniform||this._isEmpty()?this.imgEl.addClass("kd-control-pic-fill"):this.imgEl.addClass("kd-control-pic-uniform")))}});i.plugin(n)}(window.kendo.jQuery),define("KDImageEdit",["KD"],function(e){return function(){var t;return t||e.KDImageEdit}}(this)),KDPictureProxy=KD.extend(KDEditorProxy,{MaxFileLength:0,fileFilter:null,defaultFileFilter:"*.png|*.jpg|*.jpeg",src:null,disabled:!1,fileServerUrl:"",AllowDoubleClickView:!0,AllowImagePaste:!0,isUniform:!0,getType:function(){return"KDPictureProxy"},createControl:function(e){KDPictureProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDPictureProxy.superclass.loadConfig.call(this,e);var t=KD.getValue(e,"MaxFileLength",-1);-1!=t&&this.setMaxfilelength(t),this.fileFilter=KD.getValue(e,"filefilter",this.defaultFileFilter),this.IsFileServer=KD.getValue(e,"isfileserver",!1),this.setExtandurl(KD.getValue(e,"extandurl","")),this.setExdownloadurl(KD.getValue(e,"exdownloadurl","")),this.setUpUrl(KD.getValue(e,"upurl","")),this.isUniform=KD.getValue(e,"isuniform",!0),this.isShowMenu=KD.getValue(e,"IsShowMenu",!0),this.AllowDoubleClickView=KD.getValue(e,"allowdoubleclickview",!0),this.FireCustomDbClickEvent=KD.getValue(e,"firecustomdbclickevent",!1),this.DbClickViewSourceUrl=KD.getValue(e,"dbclickviewurl",""),this.IsCanDownland=KD.getValue(e,"iscandownland",!0),this.IsAdaptive=KD.getValue(e,"isadaptive",!1),this.AllowDBMaxShow=KD.getValue(e,"allowdbmaxshow",!1)},intiUploadloader:function(){var e=this;e.preventDocumentDragAction=function(e){e.preventDefault()},this.el.off("dragleave drop dragenter dragover").on({dragleave:e.preventDocumentDragAction,drop:e.preventDocumentDragAction,dragenter:e.preventDocumentDragAction,dragover:e.preventDocumentDragAction}),this.el[0].addEventListener("drop",function(t){e.getDisabled()||KD.isEmpty(t)||e._uploadloader.UpLoadAiles(t)}),this._uploadloader=new KDFileUpLoader({fileInputButton:$("#"+e.baseId+"_file"),itemTemplate:"",url:"",maxFileLength:this.MaxFileLength<0?0:this.MaxFileLength,isfileserver:this.IsFileServer,auto:!1,fileTypeExts:e.fileFilter,multi:!1,onBeforeSelectFile:function(e){return"undefined"==typeof FileReader?(alert(ResManager.LoadKDString("抱歉，您的浏览器不支持 FileReader，请使用现代浏览器操作！","099002000000056")),!1):!0},onUploadError:function(t,i,a,n){var o=e.getFormProxy();if(null!=o)if(1==n){var r=KD.isEmpty(this.ExtanUrl)?KD.getUrlRoot():this.ExtandUrl,s=kendo.format(ResManager.LoadKDString("上传文件至{0}文件服务器失败，请检查文件服务器相关配置!","014005000002508"),r);o.showErrMsgStr.call(o,s,a)}else o.showErrMsgStr.call(o,a);else KD.Error.raise({msg:a})},onOverMaxFileLength:function(e){return 0!=e.option.maxFileLength&&e.option.maxFileLength<e.file.size?(e.option.onUploadError(e.target,e.file,ResManager.LoadKDString("图片最大支持:","099002000000029")+Math.round(e.option.maxFileLength/1024)+"KB"),!1):!0},onFileItemsChanged:function(t){var i=t.option.isfileserver;if(t.files&&t.files.length>0&&!i){var a=new FileReader,n=ClientAppProxy.Current.ImgFileEnableCompress;t.files[0].size<=1e6&&(n=!1);var o=KD.isIeBrowser();n&&!o?KD.imgCompress({file:t.files[0],successful:function(e){a.readAsDataURL(e)}}):a.readAsDataURL(t.files[0]),a.onload=function(t){e.commitValueToForm(this.result.substr(this.result.indexOf(",")+1))}}},onFileStateChanged:function(t){var i=t.option.isfileserver;if(i){var a=t.target.fileState;t.state==a.Uploaded&&t.uploadedfiles&&t.uploadedfiles.length>0&&e.commitValueToForm(t.uploadedfiles[0].ServerFileName)}}})},initComponent:function(){KDPictureProxy.superclass.initComponent.call(this),this.el.width("100%"),this.intiUploadloader(),this._loadClipboard()},_formatFileType:function(){var e=[];if(this.fileFilter){var t,i=this.fileFilter.split("|");for(var a in i)t=i[a],t.indexOf("*.")>=0&&e.push(this.fileTypeToAceeptType(t))}return e},fileTypeToAceeptType:function(e){if(!KD.isEmpty(e)){var t="";switch(e){case"*.jpg":t="image/pjpeg";break;case"*.png":t="image/png";break;case"*.jpeg":t=".jpeg";break;default:t="image/"+e.substring(e.indexOf("*.")+2)}return t}},setFileFilter:function(e){if(!KD.isEmpty(e)){this.fileFilter=e;var t=this._uploadloader&&this._uploadloader.GetOption.call(this._uploadloader);if(t){var i=this._formatFileType(e).join(","),a=t.fileInputButton,n=this._uploadloader.Fileupinfo;n&&n.setfileTypeExts.call(n,e),a.attr("accept",i)}}},setFilefilter:function(e){this.setFileFilter(e)},TimeFn:null,timespan:0,onClick:function(e){var t=this;clearTimeout(this.TimeFn),this.TimeFn=setTimeout(function(){0==t.disabled&&t.el.click.call(t.el)},300)},onDbClick:function(){var e=this,t=e.getFormProxy();if(e.AllowDoubleClickView)if(e.FireCustomDbClickEvent&&t){var i={};formProxy.fireCustomEventsNoData.call(formProxy,e.getKey(),"Kingdee.BOS.PictureDbClickCustomEvent",KD.stringify(i))}else e.FireCustomDbClickEvent||this.pictureViewForClick();return},downClick:function(){var e=this,t=e.getFormProxy();if(!KD.isEmpty(t)){var i={};i.row=e.getRow(),i.ServerFileName=e.IsFileServer?e.oldValue:"",t.fireCustomEventsNoData(e.postKey,"Kingdee.BOS.ImageDownload",KD.stringify(i))}},asyncValueToUIText:function(e){if(KD.IsNullOrWhiteSpace(e))this.src=this._defaultUrl,this.setDefaultSource();else if(KD.IsNullOrWhiteSpace(e)||KD.IsNullOrWhiteSpace(this.exDownLoadUrl)||!this._uploadloader)KD.IsNullOrWhiteSpace(e)?(this.src=this._defaultUrl,this.setDefaultSource()):(this.src="data:image/jpeg;base64,"+e,type="byte",this.component&&this.component.data(this.getKendoCType()).src(this.src));else{var t=this._uploadloader.GetFileServerDownUrl(e,this.exDownLoadUrl);this.src=t,e!=this.oldValue&&this.component.data(this.getKendoCType()).src(this.src)}this.oldValue=e},_defaultUrl:"Content/themes/images/icon_picDefault.png",setDefaultSource:function(e){KD.IsNullOrWhiteSpace(e)?(this.component.find('input[type="file"]').val(""),this.component.data(this.getKendoCType()).src(this._defaultUrl)):this.component.data(this.getKendoCType()).src(e)},editor_ImageLoaded:function(e){this.src=e,CommitUITextToValue(),asyncValueToUIText(this.src)},commitValueToForm:function(e){var t=this.component&&this.component.data(this.getKendoCType()).src(),i=t&&t!=this._defaultUrl?t.substr(t.indexOf(",")+1):"";return i!=e?(this.asyncValueToUIText(e),KDPictureProxy.superclass.commitValueToForm.call(this,{previous:i,current:e})):void 0},setDisabled:function(e){this.disabled=e,this.component.data(this.getKendoCType()).setDisabled(e)},release:function(){$("#"+this.baseId+"_picmaxContainner").remove(),this.pictureViewFormModel&&this.pictureViewFormModel.destroy&&this.pictureViewFormModel.destroy(),KD.isEmpty(this.preventDocumentDragAction)||(this.el&&this.el.off("dragleave drop dragenter dragover"),this.preventDocumentDragAction=void 0),KDPictureProxy.superclass.release.call(this)},setMaxfilelength:function(e){this.MaxFileLength=e,null!=this.el&&(this.el.maxFileLength=e),this._uploadloader&&this._uploadloader.ApplyConfig({maxFileLength:0>e?0:e})},setFileserverurl:function(e){this.fileserverurl=e},setExtandurl:function(e){KD.isUrl(e)||""==e||(e=KD.getUrlRoot()+"/"+e),this.ExtandUrl=e,KD.isEmpty(e)||(this.IsFileServer=!0),this._uploadloader&&this._uploadloader.ApplyConfig({url:e,isfileserver:this.IsFileServer,auto:this.IsFileServer})},setExdownloadurl:function(e){KD.isUrl(e)||""==e||(e=KD.getUrlRoot()+"/"+e),this.exDownLoadUrl=e},setUpUrl:function(e){KD.isEmpty(e)||KD.isUrl(e)||(e=KD.getUrlRoot()+"/"+e),this.UpUrl=e,this._uploadloader&&this._uploadloader.ApplyConfig({UpUrl:e})},setUpurl:function(e){this.setUpUrl(e)},setIsShowMenu:function(e){this.component&&(this.component.data(this.getKendoCType()).config.isShowMenu=this.isShowMenu=e)},setIsuniform:function(e){this.isUniform=e,this.component&&this.component.data(this.getKendoCType()).setIsuniform(e)},setAllowDBMaxShow:function(e){this.AllowDBMaxShow=e},setIsAdaptive:function(e){this.IsAdaptive=e},setDbClickViewSourceUrl:function(e){this.DbClickViewSourceUrl=e},setFireCustomDbClickEvent:function(e){this.FireCustomDbClickEvent=e},setAllowDoubleClickView:function(e){this.AllowDoubleClickView=e},setIsCanDownland:function(e){if(e=e?!0:!1,this.IsCanDownland!=e){if(this.IsCanDownland=e,this.component){var t=this.component.data(this.getKendoCType());t&&(t.config.isCanDownland=e,t.options.isCanDownland=e)}var i=this.el.find(".KDImageEditTBContainer [alt='down']");this.IsCanDownland?i.css("display","inline-block"):i.css("display","none")}},createInnerDom:function(){return $("<div></div>")},getKendoOptions:function(){var e=KDPictureProxy.superclass.getKendoOptions.call(this),t=this;return e.operateState=t.getOptions().operateState,e.baseId=t.baseId,e.defaultUrl=t._defaultUrl,e.maxFileLength=t.MaxFileLength,e.ExtandUrl=t.extandUrl,e.UpUrl=t.UpUrl,e.isShowMenu=t.isShowMenu,e.isCanDownland=t.IsCanDownland,e.setPasteObj=function(){var e=t.getFormProxy();e&&(e.currentPastePicItem={ctlbaseid:t.baseId,ctlKey:t.getKey()})},e.onchange=function(e){t.commitValueToForm(e)},e.onclick=function(e){clearTimeout(t.TimeFn),t.TimeFn=setTimeout(function(){0==t.disabled&&t.el.click.call(t.el)},300)},e.ondblclick=function(e){t.onDbClick()},e.downclick=function(e){t.downClick()},e=$.extend(e,this.config),e.enable=!t.disabled,e.isMain=!1,e.fileFilter=t.fileFilter,e.isUniform=this.isUniform,e},getKendoCType:function(){return"kendoKDImageEdit"},pictureViewForm:function(e,t){var i,a,n=this;if(i=e.formProxy,a=e.find("#"+e.getBaseId()+"-"+t.targetkey.toUpperCase()),a.find('div[type="imgDiv"]').length>0){var o=a.find('div[type="imgDiv"]');return o.children().remove(),void o.append(this.componentImg)}var r=$('<div type="pictureView" style="text-align: center;"></div>');a.append(r.append(n.getControl())),n.el.css({position:"absolute","float":"none","margin-top":"2%",height:"81%",width:"70%",left:"15%",overflow:"auto"}),this._initSilder(r)},pictureViewForClick:function(){var e,t,i,a,n,o=this,r=$(window).width()-6-18,s=$(window).height()-160,l=this.getFormProxy().el,d=$("#"+this.getBaseId()+"_c",this.component)[0];if(d){if("undefined"==typeof d.naturalWidth){var c=new Image;c.src=d.src,t=a=c.width,i=n=c.height}else t=d.naturalWidth,i=d.naturalHeight;a=r,n=s;var h=parseInt($("body").css("min-height"));h=KD.isNaN(h)?$("body").height():h,h=h-30-18,n=h>n?h:n,a=KD.isNumber(a)?a:800,n=o.AllowDBMaxShow?n:600,a=o.AllowDBMaxShow?a:800,e=$(' <div class="pictureViewForm" style="padding:0px;"></div>'),l.append(e);var u={height:n,width:a,resize:function(e){e.sender.element.find('[type="pictureView"]').css({height:e.height-50})},close:function(e){}};this.pictureViewFormModel&&this.pictureViewFormModel.destroy&&this.pictureViewFormModel.destroy(),this.pictureViewFormModel=e.kendoWindow(u).data("kendoWindow"),this.pictureViewFormModel.center();var p=$('<div type="pictureView" style="text-align: center;height:'+(n-50)+'px;overflow:auto"></div>'),g=$(this.component).clone().css({height:"inherit",position:"relative"});if(g.find(".KDImageEditTBContainer").remove(),g.find('[role="imgViewTip"]').remove(),i=0>=i?"auto":i+"px",t=0>=t?"auto":t+"px",o.componentImg=$("img",g).css({height:i,width:t}).addClass("kd-pictureView-image"),o.DbClickViewSourceUrl){var f=o.DbClickViewSourceUrl;KD.isUrl(f)||(f=KD.getUrlRoot()+"/"+f),o.componentImg.attr({src:f}),o.componentImg.css({height:"auto",width:"auto"})}o.componentImg.kendoKDDraggable({hint:function(e){var t=e.clone();return t.attr({id:t.attr("id")+"_drag"}).width(e.width()).height(e.height()),t},dragstart:function(e){e.currentTarget.css({opacity:0})},drag:function(e){},dragcancel:function(e){},dragend:function(e){o._checkIsOverContainer(e,!0)}}),e.append(p.append(g)),o._initSilder(p)}},_checkIsOverContainer:function(e,t){var i=this.componentImg;if(i){var a,n,o,r=$("#"+i.attr("id")+"_drag"),s=t||!1,l=50;i.length>0&&r.length>0?(a=i.parent().offset(),n={left:parseFloat(r.css("left")),top:parseFloat(r.css("top"))},o={position:"absolute",left:n.left-a.left,top:n.top-a.top}):1!=t&&(o={left:parseFloat(i.css("left")),top:parseFloat(i.css("top"))});var d=parseFloat(i.attr("transform"));d=KD.isNaN(d)?0:d;var c=d/180!=parseInt(d/180);if(c){var h={width:i.width(),height:i.height()},u=this._getTruePositionByRotatePosition(o,h,!0);u.left+i.height()<l&&(o.left=this._getRotatePositionByTruePosition(l-i.height(),h,!0),s=!0),u.left+l>i.parent().width()&&(o.left=this._getRotatePositionByTruePosition(i.parent().width()-l,h,!0),s=!0),u.top+i.width()<l&&(o.top=this._getRotatePositionByTruePosition(l-i.width(),h,!1),s=!0),u.top+l>i.parent().height()&&(o.top=this._getRotatePositionByTruePosition(i.parent().height()-l,h,!1),s=!0)}else o.left+i.width()<l&&(o.left=l-i.width(),s=!0),o.left+l>i.parent().width()&&(o.left=i.parent().width()-l,s=!0),o.top+i.height()<l&&(o.top=l-i.height(),s=!0),o.top+l>i.parent().height()&&(o.top=i.parent().height()-l,s=!0);r&&r.length>0&&r.hasClass("kd-pictureView-image")&&r.hide(),s&&i.css(o),i.css({opacity:1})}},_getTruePositionByRotatePosition:function(e,t){var i={},a={};return a.left=e.left+t.width/2,a.top=e.top+t.height/2,i.left=a.left-t.height/2,i.top=a.top-t.width/2,i},_getRotatePositionByTruePosition:function(e,t,i){var a,n={};return i?(n.left=e+t.height/2,a=n.left-t.width/2):(n.top=e+t.width/2,a=n.top-t.height/2),a},_initSilder:function(e){var t=this,i=(this.getFormProxy(),$('<input id="slider" style="width: 350px" />')),a=$('<div type="picToolbar" style="position:absolute;left:15%;bottom:0;padding-top:8px;width:70%;height:42px;background-color:silver;overflow:hidden;"></div>');e.append(a.append(i));var n={},o=!0;0!=t.componentImg.height()&&(n={height:t.componentImg.height(),width:t.componentImg.width(),currentzoomin:100},o=!1);var r=i.kendoSlider({precision:0,smallStep:20,largeStep:40,min:20,max:360,value:100,tooltip:{format:"{0:##}%"},silde:function(e){},change:function(e){if(0!=t.componentImg.height()){o&&(n={height:t.componentImg.height(),width:t.componentImg.width()},o=!1);var i=this.value(),a=i*n.height/100,r=i*n.width/100;n.currentzoomin=i,t.componentImg.css({height:a+"px",width:r+"px"}),t._checkIsOverContainer(e,!1)}}}).data("kendoSlider"),s=kendo.format('<span title="{0}" class="k-icon k-i-down kd-icon-toolview" style="background-image:url({1});display:{2}"></span>',ResManager.LoadKDString("下载","014005030037576"),KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),t.IsCanDownland?"inline-block":"none"),l=kendo.format('<span title="{0}" class="k-icon kd-icon-undo kd-icon-toolview" style="background-image:url({5});"></span><span title="{1}" class="k-icon kd-icon-redo kd-icon-toolview" style="background-image:url({5});"></span><span title="{2}" class="k-icon k-i-maximize kd-icon-toolview" style="background-image:url({5});"></span><span title="{3}" class="kd-icon-autofit" style="background-image:url({5});"></span>{4}',ResManager.LoadKDString("逆时针旋转","0025710030033485"),ResManager.LoadKDString("顺时针旋转","0025710030033486"),ResManager.LoadKDString("全屏查看","0025710030033487"),ResManager.LoadKDString("自适应","0025710000007626"),s,KD.getImageUrlByNameAndVersion("kd_icon_extend.png"));a.append(l),t.componentImg.off("contextmenu"),0==t.IsCanDownland&&t.componentImg.on("contextmenu",function(e){return!1});var d=0;a.find(".kd-icon-undo").off("click").on("click",function(e){d-=90,t.componentImg.css({transform:"rotate("+d+"deg)"}).attr({transform:d}),t._checkIsOverContainer(e,!1)}),a.find(".kd-icon-redo").off("click").on("click",function(e){d+=90,t.componentImg.css({transform:"rotate("+d+"deg)"}).attr({transform:d}),t._checkIsOverContainer(e,!1)}),a.find(".k-i-maximize").off("click").on("click",function(e){var i=t.pictureViewFormModel;console.log(i);var a=i.isMaximized();if(a){if($(this).removeClass("k-i-restore").addClass("k-i-maximize").attr("title",ResManager.LoadKDString("全屏查看","0025710030033487")),i.restore(),n.isautofit){var o=i.size(),r=n.height,s=n.width;d/90%2==0?(n.width>o.width&&(s="inherit"),n.height+50>o.height&&(r="inherit")):(s+50>o.height&&(s=o.height-50),r>o.width&&(r=o.width)),t.componentImg.css({height:r,width:s})}}else{i.maximize();var o=i.size(),r="inherit",s="inherit";o.width>n.width&&(s=n.width),o.height-50>n.height&&(r=n.height),t.componentImg.css({height:r,width:s}),$(this).removeClass("k-i-maximize").addClass("k-i-restore").attr("title",ResManager.LoadKDString("退出全屏","0025710030033488"))}t._checkIsOverContainer(e,!1)}),a.find(".kd-icon-autofit").off("click").on("click",function(e){var i,a,o,s,l;t.pictureViewFormModel.size&&(s=t.pictureViewFormModel.size().width,l=t.pictureViewFormModel.size().height),i=n.currentzoomin*n.height/100,a=n.currentzoomin*n.width/100,1==n.isautofit?($(this).removeClass("kd-icon-autofit-click"),i+="px",a+="px",o=!1):($(this).addClass("kd-icon-autofit-click"),d/90%2==0?(i+50>l&&(i="inherit"),a>s&&(a="inherit")):(a+50>l&&(a=l-50),i>s&&(i=s)),o=!0),t.componentImg.css({height:i,width:a}),r.enable(!o),n.isautofit=o,t._checkIsOverContainer(e,!1)}),a.find(".k-i-down").off("click").on("click",function(e){t.downClick.call(t)}),t.IsAdaptive&&a.find(".kd-icon-autofit").click()},_loadClipboard:function(){var e=this.getFormProxy();e&&e.fireLoadPastePic.call(e)},setAllowImagePaste:function(e){this.AllowImagePaste=e}}),KDControlFactoryProxy.registerType("kdpicfield",KDPictureProxy),KDControlFactoryProxy.registerType("kdpic2field",KDPictureProxy),KDPictureProxy_Galaxy=KD.extend(KDPictureProxy,{initComponent:function(){KDPictureProxy_Galaxy.superclass.initComponent.call(this);var e=this.el.closest(".kgItemContainer_editorct");e&&e.length>0&&this.el.css({width:e.width()})}}),KDControlFactoryProxy.registerType("kdpicfield_Galaxy",KDPictureProxy_Galaxy),KDControlFactoryProxy.registerType("kdpic2field_Galaxy",KDPictureProxy_Galaxy),define("KDPictureProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDPictureProxy}}(this)),KDUrlPictureProxy=KD.extend(KDPictureProxy,{severPath:"",createControl:function(e){KDControlProxy.prototype.createControl.call(this,e),KDUrlPictureProxy.superclass._loadClipboard.call(this)},loadConfig:function(e){KDUrlPictureProxy.superclass.loadConfig.call(this,e)},setExtandurl:function(e){KD.isUrl(e)||""==e||(e=KD.getUrlRoot()+"/"+e),this.ExtandUrl=e;var t=!0;this._uploadloader&&this._uploadloader.ApplyConfig({url:e,isfileserver:t,auto:t})},setUpUrl:function(e){KD.isEmpty(e)||KD.isUrl(e)||(e=KD.getUrlRoot()+"/"+e),this.UpUrl=e,this._uploadloader&&this._uploadloader.ApplyConfig({UpUrl:e})},setUpurl:function(e){this.setUpUrl(e)}}),KDControlFactoryProxy.registerType("kdurlpicfield",KDUrlPictureProxy),define("KDUrlPictureProxy",["KDPictureProxy","KD"],function(e){return function(){var t;return t||e.KDUrlPictureProxy}}(this)),KDPopupColorProxy=KD.extend(KDEditorProxy,{getKendoCType:function(){return"kendoColorPicker"},createInnerDom:function(){return $("<div />")},initComponent:function(){var e=this;KDPopupColorProxy.superclass.initComponent.call(e),$(".k-colorpicker",this.el).width(this.config.width).css({top:"-1px",left:"-1px",position:"absolute",display:"inline-block","float":"left",height:this.innerHeight}),this.el.addClass("kd_kendoColorPicker_extend"),$(".k-selected-color",this.el).css({
width:this.config.width-1.9*KD.getCurrentFontsize(),height:this.innerHeight,"text-align":"center","line-height":this.innerHeight}),$(".k-picker-wrap",this.el).css({height:this.innerHeight,border:"none"}),this.displayValueLabel=$(kendo.format('<div class="kendo-background-color" style="width: 70%;height:{0};line-height: {0};position: absolute;z-index: 2;right: 1.45em;border: 0px;padding-left: 1em;top:-1px">',this.innerHeight||"1.58em")),this.displayValueLabel.click(function(t){e.component.data("kendoColorPicker").open()}),this.el.append(this.displayValueLabel)},formatSLColor:function(e){return KD.IsNullOrWhiteSpace(e)?e:(e=e.trim(),e.length>7?e.toUpperCase():"#FF"+e.replace("#","").toUpperCase())},onchange:function(e,t){t=this.formatSLColor(t),KDPopupColorProxy.superclass.onchange.call(this,e,t),this.displayValueLabel.text(t)},asyncValueToUIText:function(e){KDPopupColorProxy.superclass.asyncValueToUIText.call(this,e),this.displayValueLabel&&this.displayValueLabel.text(this.formatSLColor(e));var t=KD.formatHtmlColor(e);KD.IsNullOrWhiteSpace(t)||this.component&&this.component.data(this.getKendoCType()).value(t)},setDisabled:function(e){KDPopupColorProxy.superclass.setDisabled.call(this,e);var t=this.el.find(".k-picker-wrap");e?t.addClass("k-state-disabled"):t.removeClass("k-state-disabled")},getKendoOptions:function(){var e=this,t=KDPopupColorProxy.superclass.getKendoOptions.call(e);return $.extend(t,{preview:!0,messages:{apply:ResManager.LoadKDString("确定","0991733000003896"),cancel:ResManager.LoadKDString("取消","0991733000003922")},select:function(e){var t=e.value;e.sender._popup;this._selector._colorAsText.val("#FF"+t.toUpperCase().substr(1,6))},open:function(e){if(this.element.attr("disabled"))return void e.preventDefault();var t=this.value();t&&t.toUpperCase&&(t=t.toUpperCase());var i=this._selector._colorAsText;this._popup.options.animation.open.complete=function(){t&&t.toUpperCase&&i.val("#FF"+t.toUpperCase().substr(1,6))}}}),e.config.allColor&&(t.palette=null),t}}),KDColorProxy=KD.extend(KDEditorProxy,{getKendoCType:function(){return"kendoColorPalette"},createInnerDom:function(){return $("<div />")},getKendoOptions:function(){var e=this,t=KDColorProxy.superclass.getKendoOptions.call(e);return $.extend(t,{palette:"websafe"}),t}}),KDControlFactoryProxy.registerType("kdpopupcolor",KDPopupColorProxy),KDControlFactoryProxy.registerType("kdcolor",KDColorProxy),KDPopupColorProxy_Galaxy=KD.extend(KDPopupColorProxy,{initComponent:function(){var e=this;KDPopupColorProxy_Galaxy.superclass.initComponent.call(e),$(".k-colorpicker",this.el).width(this.config.width).css({top:"0px",left:"0px"}),this.displayValueLabel.css("background-color","#fff")}}),KDColorProxy_Galaxy=KD.extend(KDColorProxy,{}),KDControlFactoryProxy.registerType("kdpopupcolor_Galaxy",KDPopupColorProxy_Galaxy),KDControlFactoryProxy.registerType("kdcolor_Galaxy",KDColorProxy_Galaxy),define("KDPopupColorProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDPopupColorProxy}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.KDPopListEdit,o=n.extend({childFormIsClosed:!1,options:{name:"KDBosF7",autoBind:!0,showButton:!0,needPopup:!0,changeImm:!0,ischange:!1,template:"",buttonCls:"k-i-search",idFieldName:"",numberFieldName:"FNumber",displayFieldName:"",pop:{collision:"flip fit",width:300},lookup:{editable:!1,pageSize:5,matchType:1,columns:[{dataIndex:"FNumber",header:ResManager.LoadKDString("代码","0991733000004089"),colIndex:0,width:150},{dataIndex:"FName",colIndex:1,header:ResManager.LoadKDString("名称","0991733000004090"),width:200}],data:[["001",ResManager.LoadKDString("人民币","0991733000004091")],["002",ResManager.LoadKDString("港币","0991733000004092")]],width:400,height:500,DisplayColIndex:1,PkColIndex:0,data:[["PRE001",ResManager.LoadKDString("人民币","0991733000004091"),1]]}},onLoadOptions:function(e){var t=this,i=t.options.lookup,a=i.columns,n=150*(a.length||2);if(a&&a.length){n=0;for(var o=0;o<a.length;o++)n+=parseInt(a[o].width||150);n+=30}n>800&&(n=800),t.options.pop.width=n,e.animation&&(t.options.pop.animation=e.animation);for(var o=0;o<a.length;o++){var r=a[o];i.PkColIndex==o?t.options.idFieldName=r.dataIndex:i.DisplayColIndex==o&&(t.options.displayFieldName=r.dataIndex)}t.options.idFieldName||(t.options.idFieldName=i.PkColIndex),t.options.displayFieldName||(t.options.displayFieldName=i.DisplayColIndex)},onInitDataListPanel:function(){var t=this;t.dataView=e('<div unselectable="on" class="kd-f7grid-popup">').appendTo(t.getDataList()),t.footerBar=e('<div unselectable="on" class="ui-f7grid-pager">').appendTo(t.getDataList()),t.__initGridList(),t.__initPager()},onButtonClick:function(e){},onMoreClick:function(e){this.options.moreClick&&this.options.moreClick(e)},onMatchTypeChange:function(e,t){this.options.matchTypeChange&&this.options.matchTypeChange(e,t)},onPageSizeChange:function(e,t){this.options.pageSizeChange&&this.options.pageSizeChange(e,t)},onMatchFieldChange:function(e,t){this.options.onMatchFieldChange&&this.options.onMatchFieldChange(e,t)},_keydown:function(e){var t=this,i=t.getInputValue();return 13==e.keyCode?void t.onKeyDown(e,i):(t.options.keydown&&t.options.keydown(e),void(27!=e.keyCode&&13!=e.keyCode||!t.isPopup()||t.closePopup()))},onKeyDown:function(e,i){var a=this;if(13==e.keyCode){if(!a.dataView)return;if(!a.isPopup())return a.fireChange(e,i),void(a.options.keydown&&a.options.keydown(e));e.sender=a.dataView.data("kendoGrid");var n=e.sender.select(),o=n&&n[0];if(o==t)return a.fireChange(e,i),a.options.keydown&&a.options.keydown(e),void a.closePopup();a._selectItem(e)}},onKeyUp:function(e){var i=this;if(e.keyCode==i.options.btnKeyCode)return!1;if(13!=e.keyCode&&9!=e.keyCode&&this.options.AllowAutoList&&(i.options.ischange||32==e.keyCode||!KD.isEmpty(this._inputText))){if(!(38!=e.keyCode&&40!=e.keyCode||KD.isEmpty(this._inputText)||i.isPopup()))return!1;i.openPopup(),i._setPagerSelectType(),i.options.ischange=!1}if(i.rowIndex=!(i.rowIndex===t)&&i.rowIndex>=0&&i.rowIndex||0,38==e.keyCode||40==e.keyCode){if(!i.dataView)return!1;i._locationItem(e.keyCode)}},_setPagerSelectType:function(){if(this.footerBar)for(var e=this.options.LookupLikeMatchValue||ClientAppProxy.Current.getLookupLikeMatchType(),t=this.footerBar.find(".f7grid-pager-select"),i=t[0].options||[],a=0;a<i.length;a++){var n=i[a].value;n==e?i[a].selected=!0:i[a].selected=!1}},onChange:function(e,t){var i=this;KD.isEmpty(t)||(i.options.ischange=!0)},onLostFocus:function(e){var t=this,i=t._value?t._value.number||"":"",a=KD.getActiveElement(e),n=!1;return!KD.isEmpty(a)&&t.popup&&t.popup.is(":Visible")&&(n=t.popup.find(a).length>0)?(t.showDisplayer(!1),void(a.is(":input:text")||"voucherbosf7field"==this.options.xtype||t.input.focus())):void(KD.isFirefox()?KD.delayInvoke(function(){i=t._value?t._value.number||"":"",t._setValueChangeOption(t,e,i)},100):t._setValueChangeOption(t,e,i))},onFocus:function(e){n.fn.onFocus.call(this,e),"voucherbosf7field"==this.options.xtype&&this.dynamicformContainer&&"none"!=this.dynamicformContainer.css("display")&&this.openPopup()},onPopClose:function(e){if(n.fn.onPopClose.call(this,e),"voucherbosf7field"==this.options.xtype){var t=this,i=t.popup&&t.popup.data("kendoPopup");if(t.dynamicformContainer&&t.dynamicformContainer.is(":Visible")&&0==t.container.find(KD.getActiveElement()).length)return e.preventDefault(),void KD.delayInvoke(function(e){if(!t.element.is(":Visible"))try{var i=t.options.controlProxy,a=i.columnDescriptor.getOwner();1!=t.setChildFormIsClosed()&&a.closeChildForm(),e&&e.destroy.call(e),t.popup.hide(),t.popup.parent(".k-animation-container").remove()}catch(n){}},1e3,!0,i);e.sender.wrapper.addClass("k-kdpoplistedit-popclosed").hide()}else 0==this.container.find(KD.getActiveElement()).length&&this._inputFocusout.call(this,e)},_setValueChangeOption:function(e,t,i){var a=e.input.val();(a||"").trim()!=(i||"").toString().trim()&&(t.isValueChanged=!0,t.curentInputValue=a),e.options.lostfocus&&e.options.lostfocus(t),e.input.val(i)},displayValue:function(){return this._value&&this._value.name||" "},setChildFormIsClosed:function(e){var t=this;return KD.isEmpty(e)||(t.childFormIsClosed=e),t.childFormIsClosed},setAllowAutoList:function(e){this.options.AllowAutoList=e},setLookup:function(e){this.options.lookup=e;var t=this.options.lookup,i=t.columns,a=150*(i.length||2);if(i&&i.length){a=0;for(var n=0;n<i.length;n++)a+=parseInt(i[n].width||150);a+=30}a>800&&(a=800),this.options.pop.width=a;for(var n=0;n<i.length;n++){var o=i[n];t.PkColIndex==n?this.options.idFieldName=o.dataIndex:t.DisplayColIndex==n&&(this.options.displayFieldName=o.dataIndex)}this.options.idFieldName||(this.options.idFieldName=t.PkColIndex),this.options.displayFieldName||(this.options.displayFieldName=t.DisplayColIndex)},setPKColIndex:function(e){if(this.colMaps&&e&&e.PkColIndex)for(var t in this.colMaps)if(this.colMaps[t]==e.PkColIndex){this.options.idFieldName=e.PkColIndex;break}},setData:function(a){var n=this,o=n.options.lookup,r=a.isMore,s=a.limitNumber,l=a.data,d=n.footerBar&&n.footerBar.find(".f7grid-pager-more");if(r)if(l&&l.length<=s&&l.length>0){delete a.data,e.extend(o,a);for(var c=0;c<l.length;c++)o.data.push(l[c]);l&&l.length<s&&d&&d.addClass("f7grid-pager-disabledmore")}else d&&(n.footerBar.find("span").css("display","none"),d.attr("disabled","disabled"),d.addClass("f7grid-pager-disabledmore"));else l&&l.length<s&&l.length>=0&&d?(n.footerBar.find("span").css("display","none"),d.attr("disabled","disabled"),d.addClass("f7grid-pager-disabledmore")):l&&l.length>=0&&d&&(d.removeAttr("disabled"),d.removeClass("f7grid-pager-disabledmore")),e.extend(o,a);n.onLoadOptions(n.options);var h=n._generalDataSource(o.data),u=n.dataView?n.dataView.data("kendoGrid"):t;n.setPKColIndex(a),u&&u.setDataSource(new i.data.DataSource({data:h}));var p=n.popup&&n.popup.find(".k-grid-header").find(".k-filter-row").find(".k-operator-hidden").find(".k-input");n.popup&&p&&p.change(function(e){n._bindPopupSearchData(e)}),p&&p.attr("placeholder",ResManager.LoadKDString("过滤条件","0991733000003935")),KD.setAsynchronousFilter(p),a&&n.setSelectFieldStore(a.selectFieldKey,a.selectFieldStore,a.formid),a&&n.setLikeMatchValue(a.selectlikeMatchKey,a.formid)},setHeight:function(e){n.fn.setHeight.call(this,e)},_bindPopupSearchData:function(e){that=this,that.popup.children().find(".k-list-container").parent().css("display","none");var i=e.currentTarget.value.trim();(""===i||0==i.length||i==t)&&that.popup.find(".k-grid-header").find(".k-filter-row").find(".k-operator-hidden").find("button").click()},val:function(i){var a=this;return i==t?a._value:(e.isArray(i)?a._value={number:i[0],name:i[1]}:e.isPlainObject(i)?a._value=i:a._value={number:i,name:i},void n.fn.val.call(a,a._value.number))},valData:function(i){var a=this;return i==t?a._value:(e.isArray(i)?a._value={number:i[0],name:i[1]}:e.isPlainObject(i)?a._value=i:a._value={number:i,name:i},void(this._oldText=a._value.number))},destroy:function(){var e=this;e.footerBar&&(e.footerBar.find(".f7grid-pager-select").unbind("change"),e.footerBar.find(".f7grid-pager-limit").unbind("change"),e.footerBar.find(".f7grid-pager-more").unbind("click"));var t=e.dataView&&e.dataView.data("kendoGrid");t&&t.destroy(),n.fn.destroy.call(e)},setSelectFieldStore:function(t,a,n){if(this.options.selectFieldKey=t||"",this.options.selectFieldFormid=n||"",this.footerBar&&KD.isArray(a)){var o=this.footerBar.find(".f7grid-matchfield-select");o.empty(),a.length>0?o.show():o.hide();for(var r,s="",l="",d=0;d<a.length;d++){r=a[d],s=r[0],l=r[1];var c=e(i.format('<option value="{0}" {1}>{2}</option>',s,s==t?"selected":"",l));o.append(c)}}},setLikeMatchValue:function(e,t){this.options.selectFieldFormid=this.options.selectFieldFormid||t||"",this.options.LookupLikeMatchValue=e||ClientAppProxy.Current.getLookupLikeMatchType(),this._setPagerSelectType()},_selectItem:function(e){var i=this;if(!i.keyboardLocal){var a=e.sender.select(),n=a&&a[0];if(n!=t){var o=n&&e.sender.dataItem(n),r=o&&o[i.options.idFieldName||i.options.lookup.PkColIndex];r==t&&i.options.numberFieldName!=t&&o[i.options.numberFieldName]!=t?r=o[i.options.numberFieldName]:r==t&&KD.Error.raise({msg:"F7控件_selectItem为空",description:KD.obj2str(o)});var s=o&&o[i.options.numberFieldName],l=i.options.displayFieldName||i.options.lookup.DisplayColIndex,d=o&&o[l];if(KD.IsNullOrWhiteSpace(d)&&i.options.lookup&&i.options.lookup.columns)for(var c=0;c<i.options.lookup.columns.length;c++){var h=i.options.lookup.columns[c];if(h.colIndex==l){d=o&&o[h.dataIndex];break}}a&&a.length>0&&i.isPopup()&&KD.delayInvokeCore(function(e){i.focus().closePopup()},100,!0),d&&KD.IsNullOrWhiteSpace(s)&&(s=d),i._value={id:r,number:s,name:d},i.val(i._value),i.options.selectItem&&i.options.selectItem(r)}}},_locationItem:function(e){var t=this,i=t.dataView.data("kendoGrid");t.rowIndex=i.dataItems("tr").indexOf(i.dataItem(i.current())),38==e?t.rowIndex--:40==e&&t.rowIndex++;var a=i.tbody.find("tr:eq("+t.rowIndex+")");t.keyboardLocal=!0,i.current(a),i.select(a),t.keyboardLocal=!1},_generalDataSource:function(e){var t=this;if(!e)return[];var i=[],a=t.options&&t.options.lookup&&t.options.lookup.columns;this.colMaps={};for(var n=0;n<a.length;n++){var o=a[n];this.colMaps[o.colIndex]=o.dataIndex}if(e&&a)for(var r=0;r<e.length;r++){for(var s=e[r],l={},n=0;n<s.length;n++){this.colMaps[n]||(this.colMaps[n]=n);var d=this.colMaps[n]||n;l[d]=KD.isEmpty(s[n])?"":s[n]}i.push(l)}return i},__initPager:function(t){var i=this,a=i.options.lookup,n=ClientAppProxy.Current.LookupLikeMatchStore||[],o='<select class="f7grid-pager-select">';(0==n.length||n.indexOf("1")>=0)&&(o+='<option value="1"'+(1==a.matchType?"selected":"")+">"+ResManager.LoadKDString("左匹配","0991733000004093")+"</option>"),(0==n.length||n.indexOf("2")>=0)&&(o+='<option value="2"'+(2==a.matchType?"selected":"")+">"+ResManager.LoadKDString("右匹配","0991733000004094")+"</option>"),(0==n.length||n.indexOf("3")>=0)&&(o+='<option value="3"'+(3==a.matchType?"selected":"")+">"+ResManager.LoadKDString("全模糊匹配","0991733000004095")+"</option>"),o+="</select>",e(o).appendTo(i.footerBar);var r='<select class="f7grid-matchfield-select"></select>';e(r).appendTo(i.footerBar),e('<input type="button" class="f7grid-pager-more" value="'+ResManager.LoadKDString("更多","0991733000003986")+'"/></input>').appendTo(i.footerBar);for(var s='<select class="f7grid-pager-limit">',l=a.pageSize||i.options.lookuplimit,d=ClientAppProxy.Current.LookupLikePageSizeStore||["5","10","15","20"],c=0;c<d.length;c++)if(KD.isArray(d[c])){var h=d[c];s+=KD.format('<option value="{0}" {1}>{2}</option>',h[0],l==parseInt(h[0])?"selected":"",h[1])}else s+=KD.format('<option value="{0}" {1}>{0}</option>',d[c],l==parseInt(d[c])?"selected":"");return s+="</select>",e(s).appendTo(i.footerBar),e('<span style = "float : right; padding-top : 3px; padding-right: 6px; display:none">'+ResManager.LoadKDString("无数据","0991733000004096")+"</span>").appendTo(i.footerBar),i.footerBar.find(".f7grid-pager-select").bind("change",function(t){var a=[];a.push(i.options.selectFieldFormid||""),a.push(e(this).val()),i.options.setLookupLikeMatchValue&&i.options.setLookupLikeMatchValue.call(i,a[1]),i.onMatchTypeChange.call(i,t,a)}),i.footerBar.find(".f7grid-matchfield-select").bind("change",function(t){var a=[];a.push(i.options.selectFieldFormid||""),a.push(e(this).val()),i.onMatchFieldChange.call(i,t,KD.stringify(a))}),i.footerBar.find(".f7grid-pager-limit").bind("change",function(t){i.footerBar.find(".f7grid-pager-more").removeAttr("disabled").removeClass("f7grid-pager-disabledmore"),i.onPageSizeChange.call(i,t,e(this).val())}),i.footerBar.find(".f7grid-pager-more").bind("click",function(e){this.attributes.disabled&&"disabled"==this.attributes.disabled.value||i.onMoreClick.call(i,e)}),!1},__initGridList:function(){var e=this,i=e.options.lookup;if(i){e.getDataList().attr({tabindex:"-1"});var a=i.columns,n=[];columnFilterable={multi:!0,ignoreCase:!0,cell:{showOperators:!1,operator:"contains",suggestionOperator:"contains"}};for(var o=0;o<a.length;o++){var r=a[o];n.push({field:r.dataIndex,title:r.header||r.dataIndex,hidden:!(r.visible==t?!0:r.visible),filterable:columnFilterable,width:parseInt(r.width||150)})}var s=e._generalDataSource(i.data);e.dataView.kendoGrid({height:250,editable:!1,navigatable:!0,sortable:!0,selectable:"row",dataSource:s,columns:n,filterable:{mode:"menu, row",messages:{checkAll:ResManager.LoadKDString("全选","0991733000003938"),clear:ResManager.LoadKDString("清除","0991733000003921"),filter:ResManager.LoadKDString("确定","0991733000003896"),selectedItemsFormat:ResManager.LoadKDString("已选{0}项","0991733000003939")}},filterMenuInit:function(e){var t=e.container;t.bind("mouseleave",function(){t.parent().css("display","none"),t.parent("div.k-animation-container").parent().find("div.k-list-container").remove()})},schema:{id:e.options.idFieldName},change:function(t){e._selectItem.call(e,t);try{KD.stopPropagation(event||window.event)}catch(i){}}})}}});a.plugin(o)}(window.kendo.jQuery),define("KDBOSF7",["KDPopListEdit","KD"],function(e){return function(){var t;return t||e.KDBOSF7}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.KDNumberField,o=i.support,r=(i.caret,i.keys,o.placeholder,e.extend,".kendoKDLRSpinnerNumber"),s="focus"+r,l=n.extend({init:function(t,i){var a=this;e.extend(i,{showButton:!1,showCalcButton:!1,zoomIn:!1}),n.fn.init.call(a,t,i)},options:{name:"KDLRSpinnerNumber",autoBind:!0,changeImm:!1,showButton:!1,showCalcButton:!1,template:""},_templates:{leftSpinner:'<span unselectable="on" class="k-select kd-spinner-btn kd-spinner-btnLeft" role="button">+</span>',rightSpinner:'<span unselectable="on" class="k-select kd-spinner-btn kd-spinner-btnRight" role="button">-</span>'},onBeforeCreateChild:function(t,i){var a=this;n.fn.onBeforeCreateChild.call(a,t,i),a.increaseSpinner=e(a._templates.leftSpinner).appendTo(a.container).click(function(e){e.preventDefault(),a.onSpinnerClick.call(a,e,!0)}).focus(e.proxy(function(e){a.trigger(s)},a)),a.decreaseSpinner=e(a._templates.rightSpinner).appendTo(a.container).click(function(e){e.preventDefault(),a.onSpinnerClick.call(a,e,!1)}).focus(e.proxy(function(e){a.trigger(s)},a))},createDefButton:function(){var t=this;t.button=e("<span>")},createInput:function(){n.fn.createInput.call(this),this.getInput().css({width:"100%","padding-left":"1em","padding-right":"1.2em"})},onSpinnerClick:function(t,i){var a=parseFloat(e("input",e(t.target).parent()).val()),n=this;KD.isNaN(a)&&(a=0);var o=n.options.firecellbtnclick,r=i?"Add":"Subtract",s=parseFloat(n.options.incremental)||1,l=i?s:-1*s;o?(t.increaseFlag=r,n._buttonClick(t)):(a=KD.isNaN(a)?l:a+l,n.val(a),n._change(t,a),n.options.changeImm||n.fireChange(t,a))},onAfterCreateChild:function(e,t){var i=this;n.fn.onAfterCreateChild.call(i,e,t);var a=KD.layout.getActualWidth(this.element),o=38;i.displayer.css({"margin-left":"12px",width:a-o+"px"})},onInitContent:function(){var e=this;n.fn.onInitContent.call(e)},resize:function(){var e=this;n.fn.resize.call(e),e.getInput().width(e.element.width()-42),e.displayer.css({"margin-left":"1.2em"})},setOptions:function(e){var t=this;return n.fn.setOptions.call(t,e),t._loadOptions(e),t},destroy:function(){}});a.plugin(l)}(window.kendo.jQuery),define("KDLRSpinnerNumber",["KDNumberField"],function(e){return function(){var t;return t||e.KDLRSpinnerNumber}}(this)),function(e){e.fn.KDMenuButton=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDMenuButton.prototype,e.fn.KDControlBase.defaults,e.fn.KDMenuButton.defaults,t);return i.content=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDMenuButton.prototype={getType:function(){return"KDMenuButton"},loadConfig:function(e){var t=this;KD.setAttachmentData(t,e),t.content.text(e.text),t.content.KDMenuItem(),t.content.bind("click",function(){t.click&&t.click()})},release:function(){this.content.button("destroy"),this.content.remove(),this.content=void 0,this.remove()},setVisible:function(e){var t=this;if(void 0!=e&&"boolean"==typeof e){var i=e?"none":"hidden",a=e?this.getConfig().text:"",n=e?"none":"0px",o=e?"none":"0px";t.css({visibility:i,margin:o,padding:n}),t.content.text(a),t.content.css({margin:o,padding:n})}}},e.fn.KDMenuButton.defaults={metaHtml:"",defaults:{}}}(jQuery),function(e){function t(e){var t="background-color",i={};e._mouseIn?i[t]="lightgray":i[t]="",e.css(i),e.children().css(i)}e.fn.KDMenuItem=function(i){var a=this;return a.bind("mouseenter",function(){a._mouseIn=!0,t(a)}),a.bind("mouseleave",function(){a._mouseIn=!1,t(a)}),a.bind("click",function(){a._checked=!(!i||!i.allowToggle||a._checked),t(a)}),a.addClass("kdmenuitem kdbutton-cursor"),this.each(function(){$this=e(this);e.meta?e.extend(a,opts,$this.data()):a})},e.fn.KDMenuItem.prototype={getType:function(){return"KDMenuItem"},updateStates:function(){t(this)}},e.fn.KDMenuItem.defaults={metaHtml:"",defaults:{}}}(jQuery),define("KDMenuButton",["KD"],function(e){return function(){var t;return t||e.KDMenuButton}}(this)),KDRectProxy=KD.extend(KDControlProxy,{RadiusX:0,RadiusY:0,height:0,width:0,createControl:function(e){var t=parseInt(e.height||0);return e.height=isNaN(t)||5>t?t:t-1,this.height=e.height-1,this.width=e.width,e.height=0,e.width=0,KDRectProxy.superclass.createControl.call(this,e),this.el},loadConfig:function(e){KDRectProxy.superclass.loadConfig.call(this,e);var t="1px solid lightgray",i=this.el.attr("style"),a=parseInt(this.el.css("top")),n=parseInt(this.el.css("left"));$("<div rect='top' style='"+i+"'></div>").appendTo(this.el.parent()).css({width:this.width,"border-top":t}),$("<div rect='left' style='"+i+"'></div>").appendTo(this.el.parent()).css({height:this.height,"border-left":t}),$("<div rect='right' style='"+i+"'></div>").appendTo(this.el.parent()).css({height:this.height,left:n+this.width,"border-right":t}),$("<div rect='bottom' style='"+i+"'></div>").appendTo(this.el.parent()).css({width:this.width,top:a+this.height,"border-bottom":t});this.el.hide()},doLayout:function(){KDRectProxy.superclass.doLayout.call(this)},setRadiusX:function(e){this.RadiusX=e,this.el.css("border-radius",e+"px")},getRadiusX:function(){return this.RadiusX},setRadiusY:function(e){this.RadiusY=e,this.el.css("border-radius",e+"px")},getRadiusY:function(){this.RadiusY}}),KDControlFactoryProxy.registerType("kdrect",KDRectProxy),define("KDRectProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDRectProxy}}(this)),KDLinkButtonProxy=KD.extend(KDControlProxy,{StyleKey:"",InlineStyle:null,url:"",callbackurl:"",ClickOnceDisabled:!1,clickCallBackAction:null,RightMenuItems:null,loadConfig:function(e){this.InlineStyle=new Object,this.url=KD.getValue(e,"url","");var t=!1;"kddownlandlink"!=KD.getValue(e,"xtype","")||e.text||(e.text=ResManager.LoadKDString("下载","0025710030033499"),t=!0),KDLinkButtonProxy.superclass.loadConfig.call(this,e),this.setIsFileUrl(KD.getValue(e,"isfileurl",!1)||t),this.validation=KD.getValue(e,"validation",!1),this.StyleKey=e.stylekey,this.InlineStyle=e.InlineStyle||{};var i=KD.getValue(e,"forecolor",null),a=KD.getValue(e,"styleKey",null);null!=a&&this.setStylekey(KD.getValue(e,"styleKey",null)),this.RightMenuItems=KD.getValue(e,"rightmenuitems",null),null!=this.RightMenuItems&&this._updaterihgtmenu();var n=KD.getValue(e,"backgroundimage",null);null!=n&&this.el.css({"background-image":n}),null!=i&&(this.InlineStyle.color=i),this.text="",this.icon=""},setIsFileUrl:function(e){this.isFileUrl=e,this.isFileUrl&&this.component&&this.component.attr("download",this.getFileName(this.url))},getFileName:function(e){if(e){var t=this.url.lastIndexOf("/")+1;if(e.length>t)return KD.urlDecodeComponent(this.url.substr(t))}return"downloadFile"},_updaterihgtmenu:function(){if(null!=this.el&&(menu=null==this.RightMenuItems?null:this.RightMenuItems,void 0!=this.ctxBarPxy&&this.ctxBarPxy.release(),menu)){var e=this,t=menu;t.xtype="kdmenubar",t.entryKey=this.RightMenuItems.id,t.actionKey="ContextMenuClick",t.id=this.RightMenuItems.id+"_ENTRYCTXBAR",t.dock=KD.dock.None,t.isContextMenu=!0,t.targetEl="#"+this.el.attr("id");var i=e.getControlFactoryProxy(),a=e.ctxBarPxy=i.createControl.call(i,t);e.el.append(a.el),a.loadConfig.call(a,t),a.initComponent.call(a),e.contextMenuPrxy=e.ctxBarPxy;var n=e.ctxBarPxy.component.data(e.ctxBarPxy.getKendoCType());e.el.off("mouseover").on("mouseover",function(t){if(e.ctxBarPxy){var i=e.ctxBarPxy.component.data(e.ctxBarPxy.getKendoCType());i.open();var a=i.popup.wrapper,n=e.el.offset().left+e.el.width()-20,o=e.el.offset().top;a.css({left:n,top:o}),a.removeClass("kd-linkbtn-rightmenuhide"),a.addClass("kd-linkbtn-hoverrightmenu"),a.addClass("kd-linkbtn-rightmenuvisible")}}),e.el.off("mouseleave").on("mouseleave",function(t){if(e.ctxBarPxy){var i=e.ctxBarPxy.component.data(e.ctxBarPxy.getKendoCType());KD.delayInvoke(function(){var t=i.popup.wrapper,a=e.el.offset().left+e.el.width()-20,n=e.el.offset().top;t.css({left:a,top:n}),t.attr("class").indexOf("kd-linkbtn-rightmenuhover")<=-1&&i.close()},150)}}),n.element.off("mouseenter").on("mouseenter",function(t){if(e.ctxBarPxy){var i=e.ctxBarPxy.component.data(e.ctxBarPxy.getKendoCType()),a=i.popup.wrapper;a.addClass("kd-linkbtn-rightmenuhover")}}),n.element.find("li").off("mouseover").on("mouseover",function(e){$(this).removeClass("k-state-focused"),$(this).removeClass("k-state-hover")}),n.element.off("mouseleave").on("mouseleave",function(t){if(e.ctxBarPxy){var i=e.ctxBarPxy.component.data(e.ctxBarPxy.getKendoCType()),a=i.popup.wrapper;a.removeClass("kd-linkbtn-rightmenuhover"),a.addClass("kd-linkbtn-rightmenuhide"),i.close()}})}},createInnerDom:function(){return this.text=KD.getValue(this.config,"text",""),$(kendo.format("<a id='{1}' href='javascript:void(0)' title='{0}' class='kd-link'>{0}</a>",KD.htmlUtil.encode(this.text),this.baseId+"_c"))},initComponent:function(){var e=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(this.getConfig());this.InlineStyle=$.extend(this.InlineStyle||{},e),this.component=this.createInnerDom(),this.el.append(this.component),this.component.css(this.InlineStyle),this.component.css("display","inline-block"),"kdbutton"==this.config.xtype&&KD.isFirefox()&&this.component.css("white-space","nowrap"),this.initComponentOpstion(),this.setUrl(this.url),this.setVisible(KD.getValue(this.config,"visible",!0)),this.rendered=!0,this.setStylekey(KD.getValue(this.config,"style","")),this.setToolTip(this.config.tooltip||this.config.description||this.config.title||""),this.setTextIcon&&this.setTextIcon(this.config.texticon),this.textContainer=null,"kdlinkbutton"==this.xtype&&(this.textContainer=$(kendo.format('<div class="kd-button-link-text" style="display:none;">{0}</div>',KD.htmlUtil.encode(this.text))),this.el.append(this.textContainer)),KD.isEmpty(this.config.icon)||this.setIcon(this.config.icon),this._adjustTextSpacing(),this.isFileUrl&&this.setIsFileUrl(this.isFileUrl)},onButtonClick:function(e){var t=this;if(t.clickCallBackAction&&t.clickCallBackAction(e),t.disabled)return!1;if(t.getSync())t.__onlinkbuttonclick();else{if(t.clickTimeOut)return;var i=function(){t.__onlinkbuttonclick.call(t)};t.clickTimeOut=KD.delayInvoke(i,200)}return t.url&&""!=t.url.trim()?!0:!1},initComponentOpstion:function(){var e=this;this.component.click(function(t){return"true"!==this.getAttribute("isOuterLink")?e.onButtonClick.call(e,t):void 0});var t={};if(this.config.height||(this.config.height="23px"),"horizontal"==this.config.orientation&&(this.config.height="100%"),this.config.width&&"vertical"!=this.config.orientation||(this.config.width="100%"),!this.config.orientation)switch(this.config.dock){case KD.dock.Fill:t={height:"100%",width:"100%"},void 0==this.InlineStyle["line-height"]&&(t=$.extend(t,{"line-height":this.config.height?this.config.height+"px":"21px"}));break;case KD.dock.None:case KD.dock.Top:case KD.dock.Bottom:t={width:"100%"};var i,a=e.text;if(!KD.isEmpty(a)){var n=a.match(/^(\.)*/g)[0];i=a.length==n.length?"15px":void 0}void 0==this.InlineStyle.height&&(t=$.extend(t,{height:this.config.height?this.config.height+"px":0})),"kdlinkbutton"!=this.config.xtype&&void 0==this.InlineStyle["line-height"]&&(t=$.extend(t,{"line-height":this.config.height?i||this.config.height+"px":"21px"}));break;case KD.dock.Left:case KD.dock.Right:t={width:this.config.width?this.config.width+"px":0,height:"100%"},void 0==this.InlineStyle["line-height"]&&(t=$.extend(t,{"line-height":this.config.height?this.config.height+"px":"21px"}))}KD.IsNullOrWhiteSpace(KD.stringify(t))||this.component.css(t)},setInlineStyle:function(e){e&&"string"==typeof e&&(e=KD.parseObject(e)),this.InlineStyle=$.extend(this.InlineStyle||{},e),this.component.css(this.InlineStyle)},setSync:function(e){KDLinkButtonProxy.superclass.setSync.call(this,e);var t=this;1==e?this.el.delegate("a","click",function(){t.getSync()&&t.__onlinkbuttonclick.call(t)}):this.el.undelegate("a","click")},__onlinkbuttonclick:function(){var e=this;try{var t=e.getFormProxy(),i=e.validation?t.validating(!0):!0;if(!i)return;var a=e.getKey();this.config.detailfuncid&&(a=this.config.detailfuncid),t.lockControl.call(t,this),e.getSync()?t.fireSyncEvent.call(t,"ButtonClick",a,"click"):t.fireEvent.call(t,"ButtonClick",a,""==this.callbackurl?"click":this.callbackurl),e.ClickOnceDisabled&&e.setDisabled(!1),"FBTNLOGOFF"==a&&(KD.GolbalOperation=KD.EnumGolbalOperation.DoLogout)}finally{e.clickTimeOut=null}},getStyleKey:function(){var e="DefaultLinkButtonStyle ";if("kdlinkbutton"==this.config.xtype){if(this.StyleKey)switch(this.StyleKey){case 1:this.StyleKey="ImageHyperlinkButtonStyle";break;case 2:this.StyleKey="ObjectHyperlinkButtonStyle";break;case 3:this.StyleKey="TextHyperlinkButtonStyle";break;case 4:this.StyleKey="OnlyImageHyperlinkButtonStyle";break;case 5:this.StyleKey="UnderlineImageHyperlinkButtonStyle";break;case 6:this.StyleKey="ShotMailImageHyperlinkButtonStyle";break;case 7:this.StyleKey="ConsleWeiBoHyperlinkButtonStyle";break;case 8:this.StyleKey="MsgCardLinkButtonStyle"}return e+(this.StyleKey||"")}return null!=this.StyleKey?e+this.StyleKey:e},getInlineStyle:function(){var e="";return e+=JSON.stringify(this.InlineStyle).replace(/{|}|"+/g,"").replace(/,/g,";")},setText:function(e){if("HeadMenuButtonWithBadgeStyle"==this.StyleKey&&this.component){var t=this.component.find(".HeadBadgeCanvas");if(KD.IsNullOrWhiteSpace(e))this.component.css("cssText",this.component.attr("style")+";width : 30px !important;"),t.hide(),this.component.find(".HeadBadgeNumber").length>0&&this.component.find(".HeadBadgeNumber").text("");else{if(this.component.css("cssText",this.component.attr("style")+";width : 40px !important;"),0==this.component.find(".HeadBadgeNumber").length)t.append('<span class="HeadBadgeNumber">'+(parseInt(e)>99?"99+":e)+"<span>").show();else{var i=parseInt(e)>99?"99+":e;this.component.find(".HeadBadgeNumber").text(i).show()}var a=this.component.find(".HeadBadgeNumber");a.css("left",parseInt(e)>9?2:5),t.css("width",parseInt(e)>99?20:16)}}else this.text=e,KD.isEmpty(this.icon)?(this.component.text(e),this._adjustTextSpacing()):"kdlinkbutton"==this.xtype&&"ImageHyperlinkButtonStyle"==this.StyleKey&&this.textContainer&&this.textContainer.text(e)},_adjustTextSpacing:function(){if("1033"!=KD.cookieLanguageId()&&this.component){var e=this.component.clone(),t=this.el.width();t=t>0?t:this.config.width,e.css({width:t+"px",height:"auto","line-height":"20px",opacity:"0"}).addClass("kd-button-letterspacing").appendTo($("body")),e.height()>35?this.component.removeClass("kd-button-letterspacing"):this.component.addClass("kd-button-letterspacing"),e.remove()}},setIcon:function(e){if(this.icon=e,this.textContainer&&this.textContainer.hide(),KD.isEmpty(e))this.component.text(this.text);else{var t=KD.isUrl(e)?e:KD.getUrlRoot()+"/"+e;t.replace("//","/");var i={background:"url("+t+")","background-size":"cover"};"kdlinkbutton"==this.xtype&&"ImageHyperlinkButtonStyle"==this.StyleKey&&(i={"background-image":"url("+t+")","background-size":"auto","background-repeat":"no-repeat","background-position":"center"},this.textContainer&&this.textContainer.show(),
this.component.attr({dataroletype:"image"})),this.component.css(i).text("")}},setClickOnceDisabled:function(e){this.ClickOnceDisabled=e},setDisabled:function(e){this.disabled=e,e?(this.component.attr("href","javascript:void(0)"),this.component.addClass("k-state-disabled kd-button-disabled"),this.component.attr("disabled","disabled"),this.textContainer&&this.textContainer.addClass("kd-button-disabled")):(this.component.removeClass("k-state-disabled kd-button-disabled"),this.component.removeAttr("disabled"),KD.IsNullOrWhiteSpace(this.url)||this.component.attr("href",this.url),this.textContainer&&this.textContainer.removeClass("kd-button-disabled"))},setStylekey:function(e){KD.isNumber(e)?this.component.addClass(this.getStyleKey(e)):(this.StyleKey=e,this.component?(this.component.addClass(this.getStyleKey()),this.component.addClass(e)):(this.el.addClass(this.getStyleKey()),this.el.addClass(e))),"ImageHyperlinkButtonStyle"!=this.StyleKey||KD.isEmpty(this.icon)||this.setIcon(this.icon)},setStyleKey:function(e){this.setStylekey(e)},setAddClass:function(e){this.el.addClass(e)},setOuterLinkUrl:function(e){~e.search("//")||(e="//"+e),this.el.children().attr("href",e),this.el.children().attr("target","_blank"),this.el.children().attr("isOuterLink","true")},setUrl:function(e){return this.url=e,KD.IsNullOrWhiteSpace(this.url)?void this.component.attr("href","javascript:void(0)"):(KD.isUrl(this.url)||(this.url=KD.getUrlRoot()+(0==this.url.indexOf("/")?"":"/")+this.url),void(this.component&&(this.component.attr("href",this.url),this.component.attr("target","_blank"))))},setCallBackUrl:function(e){this.callbackurl=e},setClickSaveUrl:function(e){this.setUrl(e)},setRightMenuItems:function(e){this.RightMenuItems=e||!1,this.config&&(this.config.rightmenuitems=this.RightMenuItems,this._updaterihgtmenu())},setFullKeyboardOperationGuide:function(e){if(KD.isArray(e)){for(var t=$('<div class="voucherpanel" tabIndex="-1"></div>'),i=($(kendo.format('<div class="voucher_shortcutkey">{0}</div>',ResManager.LoadKDString("凭证录入快捷键","00215181000003976"))).appendTo(t),$('<div class="kd-voucher-modulecontainer"></div>')),a='<div class="kd-voucher-line"></div>',n=0;n<e.length;n++){var o=this.setFullKeyboardGuideTemplate(e[n].name,e[n].data);n>0&&i.append($(a)),i.append(o)}t.append(i),this.voucherContainer=t,t.appendTo($("body"));var r=document.documentElement.clientHeight||document.body.offsetHeight;t.css({"max-height":r,overflow:"auto"}),t.focus().blur(function(){$(this).remove()})}},setFullKeyboardGuideTemplate:function(e,t){if(!KD.isEmpty(e)&&KD.isArray(t)){for(var i="",a=0;a<t.length;a++){var n="",o=t[a].key,r=t[a].tips||"";r=KD.isEmpty(r)?"":"("+r+")";var s=t[a].name,l=t[a].notadd,d=t[a].group;switch(o.length){case 1:n=KD.isEmpty(r)?kendo.format('<div class="kd-voucher-keyContainer"><div class="kd-voucher-Firstkey">{0}</div><div class="kd-voucher-keyContent">{1}</div></div>',o[0],s):kendo.format('<div class="kd-voucher-keyContainer"><div class="kd-voucher-Firstkey" style="margin-right:8px">{0}</div><span>{2}</span><div class="kd-voucher-keyContent">{1}</div></div>',o[0],s,r);break;case 2:if(d)for(var c=0;c<o.length;c++){var h=this.setFullKeyTemplate(o[c]),u=kendo.format('<div class="kd-voucher-orkey">{0}</div>',ResManager.LoadKDString("或","0991733000003963"));n=c>0?n+u:n,n+=h}else n=l?kendo.format('<div class="kd-voucher-doublekey kd-voucher-doublekey-keytips">{0}</div><div class="kd-voucher-doublekey kd-voucher-doublekey-keytips">{1}</div><span class="kd-voucher-doublekey-contenttips">{3}</span>',o[0],o[1],s,r):kendo.format('<div class="kd-voucher-doublekey">{0}</div><div class="kd-voucher-addkey">＋</div><div class="kd-voucher-doublekey" style="width: auto;padding: 0 8px;">{1}</div><span class="kd-voucher-doublekey-contenttips">{3}</span>',o[0],o[1],s,r);n=kendo.format('<div class="kd-voucher-keyContainer">{0}<div class="kd-voucher-keyContent">{1}</div></div>',n,s);break;case 3:n=kendo.format('<div class="kd-voucher-keyContainer"><div class="kd-voucher-Firstkey">{0}</div><div class="kd-voucher-orkey">{3}</div><div class="kd-voucher-Firstkey">{1}</div><div class="kd-voucher-orkey">{3}</div><div class="kd-voucher-Firstkey">{2}</div><div class="kd-voucher-keyContent">{4}</div></div>',o[0],o[1],o[2],ResManager.LoadKDString("或","0991733000003963"),s)}i+=n}var p=$(kendo.format('<div><div class="kd-voucher-keyContainer" style="font-size:16px">{0}</div>{1}</div>',e,i));return p}},setFullKeyTemplate:function(e){var t="",i=KD.isArray(e)?e.length:1;switch(i){case 1:t=kendo.format('<div class="kd-voucher-doublekey" style="width:auto;padding: 0 8px;">{0}</div>',e);break;case 2:t=kendo.format('<div class="kd-voucher-doublekey">{0}</div><div class="kd-voucher-addkey">＋</div><div class="kd-voucher-doublekey" style="width: auto;padding: 0 8px;">{1}</div>',e[0],e[1])}return t}}),KDControlFactoryProxy.registerType("kdlinkbutton",KDLinkButtonProxy),KDControlFactoryProxy.registerType("kddownlandlink",KDLinkButtonProxy),KDIconTextButtonProxy=KD.extend(KDLinkButtonProxy,{ClickOnceDisabled:!1,clickCallBackAction:null,loadConfig:function(e){var t=this;KDIconTextButtonProxy.superclass.loadConfig.call(t,e),t.stylekey=KD.getValue(e,"styleKey",null),t.text=KD.htmlUtil.encode(e.text),t.setIcon(e.icon)},initComponent:function(){var e=this;e.el.addClass("kd-btn-icontext kd-btn-icontext-enabled").css({display:"flex"}),e.iconSrc=e.iconSrc||e.getDefIconSrc(),$("<img>").attr({src:e.iconSrc}).appendTo(e.el),e.text&&$('<span class="kd-btn-icontext-text"></span>').html(e.text).appendTo(e.el),e.el.off("click").on("click",function(t){e.onButtonClick.call(e,t)}),e.setDisabled(KD.getValue(e.config,"disabled",!1)),e.setVisible(KD.getValue(e.config,"visible",!0)),e.setStyleKey.call(e,e.stylekey),e.rendered=!0},setDisabled:function(e){var t=this;t.disabled!=e&&(t.disabled=e,e?t.el.addClass("kd-btn-icontext-disabled").removeClass("kd-btn-icontext-enabled"):t.el.addClass("kd-btn-icontext-enabled").removeClass("kd-btn-icontext-disabled"))},setText:function(e){var t=this;t.text=KD.htmlUtil.encode(e),t.el.find(".kd-btn-icontext-text").remove(),t.text&&$('<span class="kd-btn-icontext-text"></span>').html(t.text).appendTo(t.el)},setIcon:function(e){var t=this;KD.isEmpty(e)||(KD.isUrl(e)?e=e:t.IsPicture(e)?-1==e.indexOf("../")&&(e="../"+e):e="data:image/jpeg;base64,"+e,t.iconSrc=e,$("img",t.el).attr({src:t.iconSrc}))},IsPicture:function(e){var t=".jpeg|.gif|.jpg|.png|.bmp|.pic|.ico|";if(e.indexOf(".")>-1){var i=e.lastIndexOf("."),a=e.substring(i,this.length)+"|";if(a=a.toLowerCase(),t.indexOf(a)>-1)return!0}return!1},onButtonClick:function(e){var t=this;if(t.clickCallBackAction&&t.clickCallBackAction(e),t.disabled)return!1;if(t.getSync())t.__onlinkbuttonclick();else{if(t.clickTimeOut)return;var i=function(){t.__onlinkbuttonclick.call(t)};t.clickTimeOut=KD.delayInvoke(i,200)}return t.url&&""!=t.url.trim()?!0:!1},getDefIconSrc:function(){var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAnCAYAAABjYToLAAADK0lEQVRYR92YzW8NYRTGz3OG9g+QSFo0LCUlEa2wtvFRaWNtVR/1FSIiUSsrXRFERUtYsPXRKNKNLfERiRKRCIJUSIStMu8jR95JpnNn5s7cq7037vLOeef93XOe9znnvZAm/aBJueT/BCPZKSJLRaRdRBaIyDcRmRKR9wBe1FON0hkjudY5tw1AL4DFWZuT/ERyTFWvAXhYFrIwGMnlJIcMqOwmBghgEMCromsLgZE8QPIUgMBeTPKniNwHMCYiT3z5rIxWTitrF0n7AesBtPg1vwEcBnC2CFwuGMn5zrnzqrojejnJy6p6HMDnahuQbHPOWWw/gHkW75y7pKp7AfzKW58LFobhxRjUBwB9AJ5VA0o+J7mK5C0AHRFcEAQ7awKz8onIGZ+pxwB6AHwtCxXFk1xIchxAt//uYF5ZUzPmhT5pmiJpmequByoBZz+yg6RpbmXWgUgFc85Z2nv94jW1lC/HRqysj0xz3k760mIrwMynROSB18JoEAQDtZYva10YhiOquss/X5fmcxVgYRgO26kxSwCwrMjpKwtup5XkOwCtzrnhIAj2J99RAeac+2iOTvKeqm4qu2nReOfcXQAbrUOo6pJcMN/7Jn3QbgAjRTcqG0fSJHLBr1uR7K0zMkayR0Ru++AuAE/Lblg0nuRq3zVsyRYA4/G1STATZJSl9tnQV8w62nwrs68GAIzmgQ2KyAkf0ApgumgGysaRtB5qPdc+xwAMNWPG9gCI9PaXr1k0thXAzbyM2UTaiFPZCeBlJpg9aICPTanqoqoGG4bhOVXdNwfOb/eCFufclSAI+quCNaBXpvplo6eLCVXdkGY1efPYcz+azNY8ZkOCzXnRYZvBlzlaz8EEewjA6SxjbsjM72Eq+mOuXcQf/sNb0vbo6hfrldMAzFjvFNZYMtDfK09GV7Aa75WmqaMi8obkdbMKkplwhS68BlrnTXwCwJFI6CQ3k7yRB1cYLFaCov9dTJE0OxhOm+uqwZUGS2gw+W/PDxH5IiKvk70vTUd5cHWBlZ3BysA1HMzrN6657wDamgIsBncVwFsR6W4aMA/XKiJmIWwqsLgG/wDkFEZIo9LRQwAAAABJRU5ErkJggg==";return e}}),KDControlFactoryProxy.registerType("kdicontextbutton",KDIconTextButtonProxy),define("KDLinkButtonProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDLinkButtonProxy}}(this)),KDWorkButtonProxy=KD.extend(KDLinkButtonProxy,{ShowProgressBar:!0,ProgressBarConent:"",iconCls:"",Entity:null,ButtonItemModelData:"",ellipseButton:null,initComponentOpstion:function(){KDWorkButtonProxy.superclass.initComponentOpstion.call(this)},initComponent:function(){KDWorkButtonProxy.superclass.initComponent.call(this),this._adjustBtnStyle(),this.doLazyAction()},loadConfig:function(e){this.Entity=new Object,this._imageUrl="",KDWorkButtonProxy.superclass.loadConfig.call(this,e),this.setRequestLock(!0),this.setIcon(e.icon),this.InlineStyle.color=KD.getValue(e,"forecolor",this.InlineStyle.color),0!=KD.getValue(e,"forecolor",0)&&(this.InlineStyle.foresize=KD.getValue(e,"forecolor",0)),this.ShowProgressBar=!0,this.ProgressBarConent=KD.getValue(e,"processbarmsg",ResManager.LoadKDString("请稍候...","099002000000109")),this.setButtonItemModelData(e.buttonitemmodeldata),this.setTextIcon(e.texticon),this.setViceText(e.showvicetext,e.vicetext),this.setFont(e.font),this.ellipseButton=null},getStyleKey:function(e){var t="KDButton ";if(this.StyleKey||(this.StyleKey=this.config.stylekey),this.StyleKey)return t+this.StyleKey;switch(e||this.config.style){case 2:this.StyleKey="HeadMenuButtonStyle";break;case 3:this.StyleKey="HeadMenuGrayButtonStyle";break;case 4:this.StyleKey="FullImageButtonStyle";break;case 5:this.StyleKey="ConsoleFunctionButtonStyle";break;case 6:this.StyleKey="BlueButtonStyle";break;case 7:this.StyleKey="OrangeButtonStyle";break;case 8:this.StyleKey="WhiteButtonStyle";break;case 9:this.StyleKey="MsgCardButtonStyle";break;case 10:this.StyleKey="HeadMenuButtonWithBadgeStyle";break;case 12:this.StyleKey="EllipseButtonSyle";break;case 13:this.StyleKey="FlowButtonStyle"}return this.StyleKey?t+this.StyleKey:"k-button btn-gray btn KDButton"},setButtonItemModelData:function(e){this.ButtonItemModelData=e,e&&0!=e.length&&this.loadItemModel(e)},loadItemModel:function(e){this.Entity.CanExecuteCommand=KD.getValue(e,"canexecutecommand",this.Entity.CanExecuteCommand?!1:this.Entity.CanExecuteCommand),this.Entity.CanExecuteCommand?this.Entity.Command||(this.Entity.Command=this.ItemCommandCallBack):this.Entity.Command=null;var t=KD.getValue(e,"icon",null);null!=t&&(KD.isUrl(t)||(t=this.IsPicture(t)?KD.getUrlRoot()+"/"+t:"data:image/jpeg;base64,"+t),this.Entity.icon=t,this.Entity.ShowIcon=!0),this.Entity.IsShowKeyValue=1==KD.getValue(e,"isshowkeyvalue",this.Entity.IsShowKeyValue)?!0:!1,this.Entity.InitialKeyValue=KD.getValue(e,"initialkeyvalue",this.Entity.InitialKeyValue),this.Entity.KeyValue=KD.getValue(e,"keyvalue",this.Entity.KeyValue),this.Entity.OtherData=KD.getValue(e,"otherdata",this.Entity.OtherData),this.Entity.NormalColor=KD.getValue(e,"normalcolor",this.Entity.NormalColor),this.Entity.HoveColor=KD.getValue(e,"hovecolor",this.Entity.HoveColor),this.config.stylekey=KD.getValue(e,"stylekey",this.StyleKey||this.config.stylekey),this.setStyleKey(this.config.stylekey)},ItemCommandCallBack:function(e){if(e){var t=e.Header?e.Header:e;if(!KD.IsNullOrWhiteSpace(t)){var i=this.getFormProxy();i.lockControl.call(i,this),i.fireEvent.call(i,"ButtonClick",this.getKey(),e)}}},IsContentIsItemModel:function(){return this.Entity.ShowIcon||!this.buttonItemModelData},setIcon:function(e){"FullImageButtonStyle"==this.StyleKey},setTextIcon:function(e){this.Entity.icon=e,this.loadTextIconButton()},setViceText:function(e,t){t&&"false"==t.toString()?this.Entity.ViceHeader=-1:this.Entity.ViceHeader=e,this.loadTextIconButton()},_imageUrl:"",setImageStyleUrl:function(e){this.setImageUrl(e)},setOnerrorImg:function(e){this.IsPicture(e)&&(~e.indexOf("../")?this.onerrorImg=e:this.onerrorImg="../"+e)},setImageUrl:function(e,t){if(this._imageUrl!=e){this._imageUrl=e,"FullImageButtonStyle"==this.StyleKey||t||(this.StyleKey="FullImageButtonStyle",this.el.addClass(this.getStyleKey()),this.onerrorImg?this.component.html('<img id="'+this.getBaseId()+'image" style="width:100%;height:100%" onerror="this.onerror=null;this.src=\''+this.onerrorImg+"'\"/>"):this.component.html('<img id="'+this.getBaseId()+'image" style="width:100%;height:100%"/>'));var i=this.component.find("#"+this.getBaseId()+"image");if(t&&!KD.IsNullOrWhiteSpace(e)){var e=kendo.format("url({0})",t?KD.getImageUrlByNameAndVersion(e):e);this.component.css({"background-image":e})}if(i)if(i.css({display:"block"}),KD.isUrl(e))i.attr({src:e});else if(this.IsPicture(e))~e.indexOf("../")?i.attr({src:e}):i.attr({src:"../"+e});else if(KD.isEmpty(e)){var a=this.el.find(".kd-imgbtntextspan"),n=a&&a.text();a&&a.length&&!KD.isEmpty(n)?(this.component.text(n),i.css("display","none")):i.attr({src:"data:image/jpeg;base64,"+e})}else i.attr({src:"data:image/jpeg;base64,"+e})}},setImageTextButton:function(e){e=e||{};var t=e.url,i=e.text,a=e.iconurl,n=e.cssclass,o=e.iskdicon,r=e.imageclass;if(this._imageUrl!=t){this._imageUrl=t;var s=this.getBaseId();if("FullImageButtonStyle"!=this.StyleKey){this.StyleKey="FullImageButtonStyle",this.el.addClass(this.getStyleKey());var l=this.onerrorImg?"onerror=\"this.onerror=null;this.src='"+this.onerrorImg+"'\"":"",d=kendo.format('<span class="kd-imgbtn-span-container"><img id="{0}image" style="width:100%;height:100%" {1}/></span>',s,l);this.component.html(d)}KD.isEmpty(r)||this.component.find(".kd-imgbtn-span-container").addClass(r),!a&&this.component.css({width:"auto",height:"auto"});var c=this.component.find("#"+s+"image");if(c){c.css({display:"block"}),KD.isUrl(t)?c.attr({src:t}):this.IsPicture(t)?~t.indexOf("../")?c.attr({src:t}):c.attr({src:"../"+t}):c.attr({src:"data:image/jpeg;base64,"+t});var h,u="kd-imgbtntextspan",p="";if(o&&!KD.IsNullOrWhiteSpace(a)){var g=kendo.format("url({0})",o?KD.getImageUrlByNameAndVersion(a):a);p="background-image:"+g,u="kd-imgbtniconspan"}h=kendo.format("<span class='{2}' title='{0}' style='{1}'>{0}</span>",KD.htmlUtil.encode(i),p,u);var f=$(h);KD.isEmpty(n)||f.addClass(n),this.component&&this.component.append(f)}}},setImgButtonText:function(e){var t="",i="";KD.isObject(e)?(t=e.text||"",i=e.cssclass):KD.isString(e)&&(t=(e||"").trim());var a=this,n=kendo.format("<span class='kd-imgbtntextspan' title='{0}'>{0}</span>",t),o=$(n);o.off("click").on("click",function(e){a.component&&a.component.click()}),KD.isEmpty(i)||o.addClass(i),this.el&&this.el.append(o)},IsPicture:function(e){var t=".jpeg|.gif|.jpg|.png|.bmp|.pic|.ico|";if(e.indexOf(".")>-1){var i=e.lastIndexOf("."),a=e.substring(i,this.length)+"|";if(a=a.toLowerCase(),t.indexOf(a)>-1)return!0}return!1},doLazyAction:function(){KDWorkButtonProxy.superclass.doLazyAction.call(this),this.loadTextIconButton(),this.loadConsoleFunctionButton(),this.loadConsoleDemoChartButton()},loadTextIconButton:function(){if("TextIconWithMsgButtonStyle"==this.StyleKey&&this.component&&(0==this.component.find(".TextIconImage").length&&this.component.append("<div class='TextIconImage'>"+(-1==this.Entity.ViceHeader?"":"<div class='TextIconImageText'>0</div>")+"</div>"),this.Entity.icon&&"/"==this.Entity.icon.substring(0,1)&&(this.Entity.icon=this.Entity.icon.substring(1)),this.Entity.icon&&this.component.find(".TextIconImage").css("background-image","url(../../"+this.Entity.icon+")"),this.Entity.ViceHeader&&this.component.find(".TextIconImageText").html(this.Entity.ViceHeader)),"HeadMenuButtonWithBadgeStyle"==this.StyleKey&&this.component){0==this.component.find(".HeadBadgeImage").length&&this.component.append("<div class='HeadBadgeImage'><div class='HeadBadgeCanvas'></div></div>");var e=this.component.find(".HeadBadgeImage");e.css({background:"url(../"+this.Entity.icon+") 0 0 no-repeat","background-size":"100%"})}},loadConsoleFunctionButton:function(){if("ConsoleFunctionButtonStyle"==this.StyleKey&&this.component){if("number"==typeof this.config.height){var e=this.config.height;this.component.css("line-height",e+"px")}if(this.config.width&&"100%"==this.config.width&&this.component.css("width",this.component.width()-10+"px"),this.Entity.CanExecuteCommand&&1==this.Entity.CanExecuteCommand){0==this.component.find("#"+this.getBaseId()+"ConsoleButton").length&&this.component.append('<a id="'+this.getBaseId()+'ConsoleButton" style="'+(e?"height:"+e+"px":"")+'" class="ConsoleFunctionCloseBtn" title="'+ResManager.LoadKDString("点击删除此项","099002000000110")+'"></a>');var t=this;$("#"+this.getBaseId()+"ConsoleButton").click(function(e){t.Entity.Command.call(t,"delete"),KD.stopBubble(e)})}}},onButtonClick:function(e){var t=this,i=e;if(t.IsOpenFileDialog&&t.el){var a=t.el.find("[kdrole='kduploadfile']");if(a&&a.length>0)return a.off("change"),a.val(""),a.off("click").on("click",function(e){KD.stopPropagation(e)}),a.on("change",function(e){var a=t.getFormProxy();a.currentOpenFileDialogFileList=e,KDWorkButtonProxy.superclass.onButtonClick.call(t,i)}),void KD.delayInvoke(function(){a.trigger("click")},500)}KDWorkButtonProxy.superclass.onButtonClick.call(t,i)},setIsOpenFileDialog:function(e){this.IsOpenFileDialog=e;var t=this.el.find("[kdrole='kduploadfile']");this.IsOpenFileDialog?t&&0==t.length&&this.el.append($('<input tabindex="0" kdrole="kduploadfile" style="width:0;display:none" type="file" name="fileselect[]" size="28" multiple/>')):t.remove()},setToolTip:function(e){""==e&&"ConsoleFunctionButtonStyle"==this.StyleKey&&this.component&&(e=this.text),KDWorkButtonProxy.superclass.setToolTip.call(this,e)},loadConsoleDemoChartButton:function(){"ConsoleDemoChartButtonStyle"==this.StyleKey&&this.component&&this.component.text("")},setForeColor:function(e){this.InlineStyle.color=this._convertArabToRgb(e),this.component&&this.component.css({color:this.InlineStyle.color})},setFontSize:function(e){this.InlineStyle.foresize=e,this.component&&this.component.css(this.getInlineStyle())},setVisible:function(e){this.el.css("display",e?"inline-block":"none")},setExVisible:function(e){},setStyle:function(e){KDWorkButtonProxy.superclass.setStyle.call(this,e),this.StyleKey=null,this.el.addClass(this.getStyleKey(parseInt(e)))},setStyleKey:function(e){KDWorkButtonProxy.superclass.setStyleKey.call(this,e),this.StyleKey=e,"EllipseButtonSyle"==e?this.setEllipseButtonSyleTemplate():"FlowButtonStyle"==e&&this.setFlowButtonStyleTemplate()},setExHoveColor:function(e){this.component.attr("foreColor",this.InlineStyle.color).attr("exHoveColor",this._convertArabToRgb(e)),this.component.hover(function(e){$(this).css("color",$(this).attr("exHoveColor"))},function(e){$(this).css("color",$(this).attr("foreColor"))})},setEllipseButtonSyleTemplate:function(e){if(e&&(this.Entity.InitialKeyValue=e),this.ellipseButton&&this.ellipseButton.text(this.Entity.InitialKeyValue),!this.ellipseButton||this.component.has(this.ellipseButton).length<=0){var t=kendo.format('<div class="kd-button-ellipseButton">{0}</div>',this.Entity.InitialKeyValue);this.ellipseButton=this.ellipseButton||$(t),this.component.css({"line-height":this.component.height()/2+"px"}).append(this.ellipseButton)}},setFlowButtonStyleTemplate:function(e){if(this.el&&this.Entity){var t=this.Entity.OtherData+"";t=KD.htmlUtil.encode(t),t=t.replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>"),this.component&&this.component.hide();var i=kendo.format('<div class="kd-flowbtn-container"><div class="kd-btn-icon" style="background-image: url({0});"></div><div class="kd-btn-content-container"><div class="kd-btn-title-container"><span class="kd-btn-initialkeyvalue">{1}</span><span class="kd-btn-keyvalue">{2}</span></div><div class="kd-btn-otherdata">{3}</div></div></div>',this.Entity.icon,this.Entity.InitialKeyValue,this.Entity.KeyValue,t);this.el.find(".kd-flowbtn-container").remove(),this.el.css({position:"static",height:"auto",left:"initial",top:"initial",width:"100%"}).append($(i))}},setBackColor:function(e){if(KDWorkButtonProxy.superclass.setBackColor.call(this,e),!(KD.IsNullOrWhiteSpace(e)||this.editor&&this.editor.disabled)){var t=-1!=e.indexOf("#")||-1!=e.toUpperCase().indexOf("RGB")?KD.interceptColorStr(e):"rgb("+e+")";this.component.css("background-color",t)}},_convertArabToRgb:function(e){if(e&&e.length>7&&(e="#"+e.substring(e.length-6)),!KD.IsNullOrWhiteSpace(e)){var t=-1!=e.indexOf("#")||-1!=e.toUpperCase().indexOf("RGB")?e:"rgb("+e+")";return t}},setRemoveStyle:function(e){KD.isString(e)&&this.component.hasClass(e)&&this.component.removeClass(e)},_adjustBtnStyle:function(){var e=this;e.component.addClass("kd-workbutton-notlink")}}),KDControlFactoryProxy.registerType("kdbutton",KDWorkButtonProxy),define("KDWorkButtonProxy",["KDLinkButtonProxy","KD"],function(e){return function(){var t;return t||e.KDWorkButtonProxy}}(this)),function(e,t){var i=document,a=e.extend,n=e.proxy,o=window.kendo,r={show:{effects:"fadeIn",duration:300},hide:{effects:"fadeOut",duration:300}},s=/kdcss\.[\w\-]+(\.min)?\.(less|css)/i,l=o.ui.Widget.extend({init:function(e,t){o.ui.Widget.fn.init.call(this,e,t),this._summary=this.element.find(".tc-activator").on("click",n(this.toggle,this)),this._container=o.wrap(this._summary.next(),!0),this._container.css("display","none")},options:{name:"Details"},toggle:function(){var e=this._container.is(":visible"),t=o.fx(this._container).expand("vertical");t.stop()[e?"reverse":"play"](),this._summary.toggleClass("tc-active",!e)}}),d=o.ui.ListView.extend({init:function(e,t){o.ui.ListView.fn.init.call(this,e,t),this.bind("change",this._updateTheme)},options:{name:"ThemeChooser",template:"",selectable:!0,value:""},dataItem:function(t){var i=e(t).closest("[data-uid]").attr("data-uid");return this.dataSource.getByUid(i)},_updateTheme:function(e){e.item=this.dataItem(this.select());var t=e.item.value;d.changeThemePair(t,!0).then(n(this.trigger,this,"transition"))},value:function(e){if(!arguments.length){var t=this.dataItem(this.select());return t.name}for(var i=this.dataSource.data(),a=0;a<i.length;a++)if(i[a].value==e){this.select(this.element.find("[data-uid='"+i[a].uid+"']"));break}}}),c=[],h=KD.getEntryRoleConfig();if(h&&h.themePlugins&&h.themePlugins.ThemeItems&&h.themePlugins.ThemeItems.length>0)for(var u=0;u<h.themePlugins.ThemeItems.length;u++){var p=h.themePlugins.ThemeItems[u];p.value=p.Key,p.name=p.Name,p.colors=[p.Color,p.Color,p.Color],c.push(p)}else{var p={};p.value="standard",p.name=ResManager.LoadKDString("默认皮肤","0991733000004080"),p.colors=["#eaeaec","#eaeaec","#eaeaec"],c.push(p)}var g=o.observable({themes:c,sizes:[{name:"standard",value:"common"}],selectedTheme:window.kendoTheme,selectedSize:window.kendoCommonFile});window.ThemeChooserViewModel=g,a(d,{preloadStylesheet:function(t,i){var a=e.Deferred(),n=e("<link rel='stylesheet' media='print' href='"+t+"' />");return n.appendTo("head"),a.then(i),setTimeout(function(){a.resolve(),n.remove()},100),a.promise()},getCurrentThemeLink:function(){return e("head link").filter(function(){return/kdcss\./gi.test(this.href)&&!/kdcss\.css/gi.test(this.href)&&!/kdcss\.min\.css/gi.test(this.href)})},getThemeUrl:function(e){var t=d.getCurrentThemeLink().attr("href");return t.replace(s,"kdcss."+e+"$1.$2")},updateLink:function(t,i){var a=e("#MainPanel"),n=window.less,o=/\.less$/.test(t.attr("href"));t.eq(0).attr("href",i),o&&(e("head style[id^='less']").remove(),n.sheets=e("head link[href$='.less']").map(function(){return this}),n.refresh(!0)),a.length&&(a[0].style.cssText=a[0].style.cssText)},replaceTheme:function(t){var a=d.getThemeUrl(t),n=e(i).data("kendoSkin"),o=d.getCurrentThemeLink();KD.cookie.write("Theme",t),d.updateLink(o,a),e(i.documentElement).removeClass("k-"+n).addClass("k-"+t),d.publishTheme(t)},publishTheme:function(t){var a=["Chart","TreeMap","Diagram","StockChart","Sparkline","RadialGauge","LinearGauge"];if(o.dataviz&&t)for(var n=0;n<a.length;n++){var r=o.dataviz.ui[a[n]];r&&(r.fn.options.theme=t)}t&&e(i).data("kendoSkin",t),e("#MainPanel").trigger("kendo:skinChange")},currentlyUsing:function(e){return/common/.test(e)?d.getCurrentCommonLink().attr("href")==e:d.getCurrentThemeLink().attr("href")==e},animateCssChange:function(t){t=e.extend({complete:e.noop,replace:e.noop},t);var i=t.prefetch;e.isArray(i)||(i=[i]),i=e.grep(i,function(e){return!d.currentlyUsing(e)}),i.length&&e.when.apply(e,e.map(i,d.preloadStylesheet)).then(function(){var n=e("#MainPanel");n.kendoStop().kendoAnimate(a({},r.hide,{complete:function(e){e[0]==n[0]&&(n.css("visibility","hidden"),t.replace(),setTimeout(function(){n.css("visibility","visible").kendoStop().kendoAnimate(r.show),i.join(":").indexOf("common")>-1&&o.resize(n,!0),t.complete()},100))}}))})},changeTheme:function(e,t,i){a(o.dataviz.ui.themes[e].chart,{chartArea:{background:"transparent"}}),t?d.animateCssChange({prefetch:d.getThemeUrl(e),replace:function(){d.replaceTheme(e)},complete:i}):d.replaceTheme(e)},changeThemePair:function(t){var i=e.Deferred();return d.animateCssChange({prefetch:[d.getThemeUrl(t)],replace:function(){window.kendoTheme=t,d.replaceTheme(t)},complete:function(){i.resolve()}}),i.promise()}}),d.publishTheme(window.kendoTheme),o.bind(e("[data-rel=themechooser]"),g),window.kendoThemeChooser=d,o.ui.plugin(l),o.ui.plugin(d)}(window.kendo.jQuery);var KDChangeTheme=KDChangeTheme||{};KDChangeTheme.showTheme=function(e){var t=e,i=$("<div id='themeChooserWindow'><div class='themechooser'></div></div>");i.appendTo($(document.body));var a='<li class="tc-item"># for (var i = 0; i < colors.length; i++) { #<span class="tc-color" style="background-color: #= colors[i] #"></span>  # } # <span class="tc-name">#: name #</span></li>';$(".themechooser").kendoThemeChooser({dataSource:{data:ThemeChooserViewModel.themes},change:function(e){var i=this.dataItem(this.select()),a=i.value;if(this.firstChangeTheme)for(var n=t.controlFactoryProxy.forms,o=0;o<n.length;o++){var r=n[o];r&&r.fireEvent&&(KD.cookie.write("Theme",a),r.fireEvent("ChangeHTmlTheme","changeTHml_button",a))}else this.firstChangeTheme=!0},template:kendo.template(a)});var n=KD.cookie.read("Theme");n||(n="standard");for(var o=0,r=$(".themechooser").data("kendoThemeChooser"),s=0;s<r.dataItems().length;s++){var l=r.dataItems()[s];if(l.Key==n){o=s;break}}r&&r.select&&r.select(r.element.children().eq(o)),i.kendoWindow({modal:!1,title:ResManager.LoadKDString("切换皮肤","0991733030033491"),minHeight:80,minWidth:425,resizable:!1,pinned:!0,close:function(e){var t=i.parent();t.remove()}}),i.data("kendoWindow").center()},define("ThemeChooser",["KD"],function(e){return function(){var t;return t||e.ThemeChooser}}(this)),KDToggleButtonProxy=KD.extend(KDWorkButtonProxy,{iconArrowTypeName:"k-i-arrow-s",searchControlVisible:!1,contextMenuDataSource:[],enableServerFilter:!1,isChineseInput:!1,rootUrl:void 0,popUpOrigin:"",popUpPosition:"",defaultBtnIconUrl:"images/silverlight/default/toolbar",triggerClick:void 0,selectKeepOpen:void 0,keepExpendState:void 0,isPostActiveFormData:void 0,clickOpenPopup:!0,contextPopId:"KDtoggleButtonContextPopContainer",getStyleKey:function(){return 1==this.config.style?"HeadMenuSplitButtonStyle":KDToggleButtonProxy.superclass.getStyleKey.call(this)},getKendoMenuType:function(){return"kendoContextMenu"},menuItemClick:function(e){var t=this.getFormProxy(),i=e.validation?t.validating(!0):!0;if(i){if(t.lockControl.call(t,this),this.isPostActiveFormData){var a=KD.isObject(e)?e.menuKey:$(e).attr("itemKey"),n=ClientAppProxy.Current.getMainTab(),o=n?n.getCurrentFormId():"",r={currentpageid:o};return void t.fireCustomEventsNoData.call(t,this.getKey(),a,KD.stringify(r),null)}e&&e.getSync&&e.getSync()?t.fireSyncEvent.call(t,"ButtonClick",this.getKey(),e.attr("itemKey")):t.fireEvent.call(t,"ButtonClick",this.getKey(),e.attr("itemKey"))}},getKendoMenuOptions:function(){var e,t=this,i={target:"#"+this.componentId,showOn:"click",closeOnClick:!0,alignToAnchor:!0,dataSource:[],open:function(e){var i=t._getKendoMenuObject(),a=i&&i.options,n=i&&i.popup,o=n&&n.options;KD.isEmpty(o)||(KD.isEmpty(t.popUpOrigin)||(o.origin=t.popUpOrigin),KD.isEmpty(t.popUpPosition)||(o.position=t.popUpPosition),t.el.find(".kd-ui-viewTips").length>0?a.direction="left":a.direction="default"),t.menuBtns&&0==t.menuBtns.length?e.preventDefault():t.searchControlVisible&&e.sender&&e.sender.wrapper&&e.sender.wrapper.css&&e.sender.wrapper.css({"max-height":$(window).height()-100,overflow:"auto"})},close:function(e){if(t.selectKeepOpen){var i=KD.getActiveElement();if(e.sender&&e.sender.popup&&e.sender.popup.wrapper&&(e.sender.popup.wrapper.find(i).length>0||e.sender.popup.wrapper.find(".k-state-hover,.k-state-focused").length>0))return e.preventDefault(),void KD.stopPropagation(!0)}if(t.searchControlVisible){var i=KD.getActiveElement();if(i&&i.hasClass&&i.hasClass("kd-list-search")||e.event&&$(e.event.target).hasClass("kd-menu-stack-vertical"))return void e.preventDefault()}var a=window.event||e.event&&e.event.target;a&&a.target&&($(a.target).hasClass("kd-guidepromptintro-maskLayer")||$(a.target).hasClass("kd-outNextStepBtnNode")||!$(a.target).hasClass("kd-guidepromptclose")&&$(a.target).closest(".kd-popover").length>0)&&e.preventDefault()},select:function(e){if(t.searchControlVisible){var i=KD.getActiveElement();if(i&&i.hasClass&&i.hasClass("kd-list-search"))return void e.preventDefault()}var a=$($(e.item).children()[0]).children()[0];a=$(a),t.menuItemClick.call(t,a)},deactivate:function(e){t.doParentLayout.call(t)}},a=this.getConfig();return a.menu&&(e=a.menu,$.each(e,function(a){var n=e[a],o=t.getMenuItemOpt.call(t,n,0);i.dataSource.push(o)})),i},_getKendoMenuObject:function(){var e=null;return KD.isEmpty(this.menus)||(e=this.menus.data(this.getKendoMenuType())),e},setMenu:function(e,t){var i=[],a=this;$.each(e,function(t){var n=e[t],o=a.getMenuItemOpt.call(a,n,0);i.push(o)});var n=this._getKendoMenuObject();if(KD.isEmpty(t))n.append(i);else{var o=this.getButtonId(t),r=this.menus.find("#"+o),s=r.closest("li.kdmenuitem");s.length>0?(n.insertAfter(i,s),n.remove(s)):n.append(i)}1!=this.keepExpendState&&n.close(),a.menuBtns=this.menus.children(),a.contextMenuDataSource=a.contextMenuDataSource.concat(e),$.each(a.menuBtns,function(e){var t=a.menuBtns[e];$(t)[getPropName()]("data-width",$(t).outerWidth(!0))}),a.resetItemStyle(),a.menuBtns.length>0&&$("."+this.iconArrowTypeName,this.el).length<=0&&a.component.append($('<span class="k-icon '+this.iconArrowTypeName+'"> </span>'))},setMenuOpened:function(e){var t=this;KD.delayInvoke(function(i){var a=t._getKendoMenuObject();if(a&&t.component)if(e){var n=a.element?!0:!1,o=!0;n&&(a.element.hide(),o=a.element.data("animating"),a.element.removeData("animating")),a.open(t.component[0]),n&&(a.popup&&(a.popup._hovered=!0),a.element.data("animating",o))}else a.close()},49)},clearMenuItems:function(){var e=this;e.menuBtns=this.menus.children();var t=this._getKendoMenuObject();if(t&&t.element.children().not(".kd-contextmenu-list-search-container").remove(),e.menuBtns&&e.menuBtns.length>0){for(var i=e.menuBtns.length,a=-1,n=0;i>n;n++)if($(e.menuBtns[n]).hasClass("kd-contextmenu-list-search-container")){a=n;break}-1==a?e.menuBtns.splice(0,i):(e.menuBtns.splice(0,a),e.menuBtns.splice(a+1,i-1-a))}e.contextMenuDataSource=[]},setSearchControlVisible:function(e){var t=this;t.menus&&!KD.isEmpty(t.contextMenuDataSource)?t._setSearchControlVisibleInner(e):KD.delayInvoke(function(e){t._setSearchControlVisibleInner.call(t,e)},void 0,void 0,e)},_setSearchControlVisibleInner:function(e){var t=this,i="";if(KD.isObject(e)?(i=e.tips,t.searchControlVisible=e.visible):t.searchControlVisible=e,this.menus&&0==this.menus.find(".kd-list-search-container").length){this.menus.addClass("kd-menu-stack-vertical");var a=kendo.format('<div class="kd-list-search-container"><span class="k-list-filter"><input class="k-textbox kd-list-search" tabindex="0" aria-disabled="false" style="display: inline-block;" placeholder="{0}" ><span class="k-icon k-i-search"></span></span></div>',i),n=this.menus.data(this.getKendoMenuType());if(0==n.element.find("li:first-child").length){var o='<span class="kdmenuitem-content"></span>';n.append([{
text:o,encoded:!1}])}n.insertBefore([{text:a,encoded:!1}],"li:first-child"),KD.delayInvoke(function(){var e=t.menus.find("li .kd-list-search-container");e.length>0&&(e.on("compositionstart","input.kd-list-search",function(){t.isChineseInput=!0}),e.on("compositionend","input.kd-list-search",function(){t.isChineseInput=!1,!t.isChineseInput&&KD.isChrome()&&t._filter.call(t,$(this).val())}),e.on("input","input.kd-list-search",function(){t.isChineseInput||t._filter.call(t,$(this).val())}),e.closest("li").addClass("kd-contextmenu-list-search-container"),KD.isIeBrowser()&&t.menus.scroll(function(t){e.closest("li").css({top:$(this).scrollTop()})}))})}},_filter:function(e){var t=this;if(t.contextMenuDataSource){var i=t.contextMenuDataSource;if(this.enableServerFilter){t.searchContext=e;var a=this.getFormProxy();a.fireCustomEvents.call(a,this.getKey(),"Kingdee.BOS.ToggleButton.Filter",e)}else for(var n="",o="",r=0;r<i.length;r++){var s=i[r];if(0!=s.visible){var n=s.id||s.key,o=s.text,l=t._getItemByServerId(n);l.find(".kd-list-search-container").length>0||(o.indexOf(e)>=0?l.show():l.hide())}}}},_getItemByServerId:function(e,t){for(var i,a,n=this.menuBtns,o=0;o<n.length;o++)if(a=$(n[o]),a.find('[itemkey="'+e+'"]').length>0){i=a;break}return $(i)},getBarItemById:function(e){var t=null;if(this.contextPopId==e){var i=this._getKendoMenuObject();t=i.wrapper||i.element||i.target}else t=this._getItemByServerId(e);return t},_updateBarItemState:function(e,t,i,a){if(t&&t.length>0)for(var n=0;n<t.length;n++){var o=t[n].id||t[n].key;if(e==o)return a=$.extend(t[n],i);if(t[n].items&&(a=this._updateBarItemState(e,t[n].items,i,a)))return a}},resetItemStyle:function(){$(".kdmenuitem",this.menus).css({"border-width":0}),$(".k-link",this.menus).css({"line-height":"1.3em"}),$(".kdmenuitem-content",this.menus).css({"font-size":"1.11em"})},getMenuItemClass:function(e,t){return"kdmenuitem kdmenuitem-"+e.xtype+(t||"")},getMenuItemOpt:function(e,t){var i={},a=this;e.text=KD.isThreatText(e.text)?KD.convertToHtmlString(KD.htmlUtil.encode(e.text)):e.text;var n=e.id||e.key,o="",r=this.getButtonId(n);switch(e.xtype){case"button":i={text:'<span itemKey="'+n+'" id="'+r+'" class="kdmenuitem-content">'+e.text+"</span>",encoded:!1};break;case"splitbutton":var s='<span itemKey="'+n+'" id="'+r+'" class="kdmenuitem-content">'+e.text+"</span>";e.hasicon&&(a.rootUrl=a.rootUrl||KD.getUrlRoot(),o+=kendo.format("background-image:url({0});",KD.getImageUrlByNameAndVersion(a.rootUrl+"/"+a.defaultBtnIconUrl+"/"+e.icon)),s=KD.isEmpty(o)?kendo.format('<span class="kdmenuitem-split-icon"></span><span itemKey="{0}" id="{1}" class="kdmenuitem-content">{2}</span>',n,r,e.text):kendo.format('<span class="kdmenuitem-split-icon" style="{3}"></span><span itemKey="{0}" id="{1}" class="kdmenuitem-content">{2}</span>',n,r,e.text,o)),i={text:s,encoded:!1,items:[]},e.items&&$.each(e.items,function(o){var r=e.items[o],s=a.getMenuItemOpt.call(a,r,t+1);$.extend(s,{id:a.getButtonId.call(a,n)}),i.items.push(s)}),(!e.items||e.items.length<=0)&&(i.items=null);break;case"checkbox":i={text:'<span  itemKey="'+n+'" id="check_'+r+'" class=""></span><span itemKey="'+n+'" id="'+r+'" class="kdmenuitem-content">'+e.text+"</span>",encoded:!1};break;case"separator":i={text:'<span itemKey="'+n+'" id="'+r+'" class="kdmenuitem-content">'+e.text+"</span>",cssClass:this.getMenuItemClass(e,"-H"),encoded:!1};break;default:var s;s=KD.isEmpty(e.tooltips)?'<span itemKey="'+n+'" id="'+r+'" class="kdmenuitem-content">'+e.text+"</span>":'<span itemKey="'+n+'" id="'+r+'" title="'+e.tooltips+'" class="kdmenuitem-content">'+e.text+"</span>",i={text:s,encoded:!1}}return $.extend(i,{id:r,cssClass:i.cssClass||this.getMenuItemClass(e)}),i},getButtonId:function(e){return this.getBaseId()+"-"+(e?e:"")},getButtonKey:function(e){return e?e.substring(this.getBaseId().length+1):""},loadConfig:function(e){KDToggleButtonProxy.superclass.loadConfig.call(this,e),this.triggerClick=KD.getValue(e,"triggerClick",void 0),this.selectKeepOpen=KD.getValue(e,"selectKeepOpen",void 0),this.isPostActiveFormData=KD.getValue(e,"isPostActiveFormData",void 0),this.keepExpendState=KD.getValue(e,"keepExpendState",void 0),this.searchControlVisible=KD.getValue(e,"searchControlVisible",this.searchControlVisible),this.clickOpenPopup=KD.getValue(e,"clickOpenPopup",this.clickOpenPopup),this.contextMenuDataSource=[],this.popUpOrigin=KD.getValue(e,"popuporigin",""),this.popUpPosition=KD.getValue(e,"popupposition",""),this.config.style&&1==this.config.style&&(this.iconArrowTypeName="kd-headMenu-arrow-s"),this.el.css({border:"0px","line-height":"1.1em",overflow:"visible"})},initComponent:function(){var e=this,t=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(this.getConfig());this.InlineStyle=$.extend(this.InlineStyle||{},t);this.getKendoOptions();this.componentId=this.getButtonId(this.config.id),this.component=$('<a href="javascript:void(0)" onclick="javascript:return false;" itemKey="'+this.config.id+'" id="'+this.componentId+'">'+this.config.text+"</a>").appendTo(this.el),this.component.css(this.InlineStyle).css("display","inline-block"),this.config.width&&this.config.width>0&&this.component.css("width",this.config.width),this.component.click(function(t){if(0==e.clickOpenPopup){var i=e._getKendoMenuObject();i&&i.element&&i.element.data("animating",!0)}if(!(1!=e.triggerClick&&e.menuBtns&&e.menuBtns.length>0)){var a=$("#"+e.componentId);e.menuItemClick(a)}}),this.menus=$("<ul class='kd-context-menu-container'></ul>"),this.menus.appendTo("body"),this.menus[this.getKendoMenuType()](this.getKendoMenuOptions()),this.menus.data(this.getKendoMenuType()).close(),this.menuBtns=this.menus.children(),KD.isEmpty(this.config.menu)||(this.contextMenuDataSource=this.contextMenuDataSource.concat(this.config.menu)),$.each(this.menuBtns,function(t){var i=e.menuBtns[t];$(i)[getPropName()]("data-width",$(i).outerWidth(!0))}),this.resetItemStyle(),this.component.addClass(this.getStyleKey()),this.setVisible(KD.getValue(this.config,"visible",!0)),this.rendered=!0,this.setToolTip(this.config.tooltip||this.config.description||"")},isKendo:function(){return!0},setBarItemStates:function(e){for(var t,i=e.length,a=0,n=this,o=this.menus.data(this.getKendoMenuType()),r=0;i>r;r++){t=e[r];var s=t.id||t.key,l=this.contextMenuDataSource,d=null;d=this._updateBarItemState(s,l,t,d);var c=this.getButtonId(s),h=$("#"+c,this.menus).closest("li.kdmenuitem");if(h&&h.length){if(void 0!=t.visible&&(t.visible?h.show():h.hide(),h[getPropName()]("data-hidden",!t.visible),t.visible||a++),void 0!=t.disabled&&o&&o.enable(h,!t.disabled),void 0!=t.text&&$("#"+c,this.menus).text(t.text),void 0!=t.checked&&(t.checked?($("#check_"+c,this.menus).addClass("k-icon k-i-tick"),$("#check_"+c,this.menus).removeClass("kd-icon-unckecked")):($("#check_"+c,this.menus).removeClass("k-icon k-i-tick"),$("#check_"+c,this.menus).addClass("kd-icon-unckecked"))),t.click&&(h.click=t.click),void 0!=t.ishighlightremind){var u={};u.key=s,u.visible=t.ishighlightremind,n.setMenuItemIsHighlightRemind(u)}if(t.items&&d){var p=[];p.push(d),n.setMenu.call(n,p,t.key),n.setBarItemStates.call(n,t.items)}}}i-a>0&&$("."+this.iconArrowTypeName,this.el).length<=0&&this.component.append($('<span class="k-icon '+this.iconArrowTypeName+'"> </span>'))},getItem:function(e){var t=this.getButtonId(e),i=$("#"+t,this.el);return i},setText:function(e){$("."+this.iconArrowTypeName,this.el).length>0?(this.component.text(e),this.component.append($('<span class="k-icon '+this.iconArrowTypeName+'"> </span>'))):this.component.text(e)},getItem:function(e){var t=e,i=this.menus.data(this.getKendoCType()).element;if(""!==t[0])for(var a=0,n=t.length;n>a;a++)i=i.children("li").eq(t[a]),n-1>a&&(i=i.find("ul:first"));return i},firstChangeTheme:!1,release:function(){this.el&&this.el.remove(),this.component&&this.component.remove(),this.menuBtns&&this.menuBtns.remove(),this.contextMenuDataSource=[]},setEnableServerFilter:function(e){this.enableServerFilter=e},setBtnMessageIsHighlightRemind:function(e){if(e){var t=this.el||this.component;if(!t)return;var i=t.find(".kd-message-highlightremind");this.messageHighlightRemindElem&&0!=i.length||(this.messageHighlightRemindElem=$('<div class="kd-message-highlightremind"></div>'),t.append(this.messageHighlightRemindElem)),this.messageHighlightRemindElem.show()}else this.messageHighlightRemindElem&&this.messageHighlightRemindElem.hide()},setIsHighLightRemind:function(e){this.setBtnMessageIsHighlightRemind(e)},setMenuItemIsHighlightRemind:function(e){if(!(KD.isEmpty(e)||KD.isEmpty(e.key)||KD.isEmpty(this.menus))){var t=this.getButtonId(e.key),i=this.menus.find("#"+t).closest(".k-link"),a=i.find(".kd-menuitem-reddotremind");e.visible?(0==a.length&&i.append($('<span class="kd-menuitem-reddotremind"></span>')),a.show()):a.hide()}},doLayout:function(){if(this.menus&&this.menus.is(":visible")&&!KD.isEmpty(this.popUpOrigin)&&this.popUpOrigin.indexOf("right")>0){var e=this.menus.closest(".k-animation-container"),t=this.el.offset(),i=t.left+this.el.width()-e.width();i>0&&e.css({left:i,"z-index":10002})}KDToggleButtonProxy.superclass.doLayout.call(this)},animateBtnMessageRingId:0,beginAnimateBtnMessageRing:function(e){e=e||{};var t=e.isAnimate,i=this;i.animateBtnMessageRingId=i.animateBtnMessageRingId+1,0==t?i.el.removeClass("kd-messagering-animate"):i.el.addClass("kd-messagering-animate");var a=parseInt(e.autocloseinterval);if(!KD.isNaN(a))if(a>0){var e={};e.actionid=i.animateBtnMessageRingId,KD.delayInvoke(function(e){e=e||{};var t=parseInt(e.actionid);t==i.animateBtnMessageRingId&&i.el.removeClass("kd-messagering-animate")},1e3*a,void 0,e)}else i.el.removeClass("kd-messagering-animate")}}),KDControlFactoryProxy.registerType("kdtogglebutton",KDToggleButtonProxy),KDControlFactoryProxy.registerType("togglebutton",KDToggleButtonProxy),define("KDToggleButtonProxy",["KDWorkButtonProxy","KD","ThemeChooser"],function(e){return function(){var t;return t||e.KDToggleButtonProxy}}(this)),KDLineProxy=KD.extend(KDControlProxy,{createControl:function(e){KDLineProxy.superclass.createControl.call(this,e),this.el=this.el.KDLine()},loadConfig:function(e){this.el.loadConfig(e),KDLineProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDLineProxy.superclass.initComponent.call(this),this.options=this.options||{},this.config.backcolor?this.options.background=this.config.backcolor:(this.el.addClass("kendo-background-color"),this.el.css({"background-color":"#e6e6e6"})),this.config.color&&(this.options.background=this.config.color),this.options.height=this.config.height?this.config.height:"1px",this.options.width=this.config.width?this.config.width:"100%",this.options.X2=this.config.width?this.config.width:"100%",this.el.applyOptions(this.options),this.setStyle(KD.getValue(this.config,"style",0))},setStyle:function(e){switch(e){case 1:break;case 2:}},setVisible:function(e){KDLineProxy.superclass.setVisible.call(this,e),e?this.el.show():this.el.hide()}}),KDControlFactoryProxy.registerType("kdseparator",KDLineProxy),function(e){e.fn.KDLine=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDLine.prototype,e.fn.KDControlBase.defaults,e.fn.KDLine.defaults,t);return this.content=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDLine.prototype={loadConfig:function(e){KD.setAttachmentData(this,e),KD.layout.setAbsolute(this,e)},applyOptions:function(t){e(this).css(t)}},e.fn.KDLine.defaults={metaHtml:"<span></span>",defaults:{}}}(jQuery),define("KDLineProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDLineProxy}}(this)),function(e){KDPagerProxy=function(){var t,i=e.makeArray(arguments);if(i&&i.length>0){var a;i[0]&&(a=KDPagerProxy.ProxyPlugIns[i[0]]),t=a?new a:new KDDefaultPagerProxy}else t=new KDDefaultPagerProxy;return t},KDPagerProxy.ProxyPlugIns={},KDPagerProxy.ResgiterPlugIn=function(e,t){KDPagerProxy.ProxyPlugIns[e]=t,t.pluginName=e},KDPagerProxy.PageOption={SizeChange:0,GoTo:1,First:2,Previous:3,Next:4,Last:5},KDPagerProxy.GetOperationName=function(e){var t="";switch(e){case KDPagerProxy.PageOption.GoTo:t="__tbGotoPage";break;case KDPagerProxy.PageOption.SizeChange:t="__tbPageSizeChange";break;case KDPagerProxy.PageOption.First:t="__tbFirstPage";break;case KDPagerProxy.PageOption.Previous:t="__tbPreviousPage";break;case KDPagerProxy.PageOption.Next:t="__tbNextPage";break;case KDPagerProxy.PageOption.Last:t="__tbLastPage"}return t},KDControlFactoryProxy.registerType("kdpager",KDPagerProxy)}(jQuery),function(e){KDPagerProxyPlugInBase=KD.extend(KDControlProxy,{createControl:function(e){if(KDPagerProxyPlugInBase.superclass.createControl.call(this,e),e.hasPhantom){this.phantomProxy=new KDDefaultPagerProxy,this.phantomProxy.sourceProxy=this,this.phantomProxy.scope=this.scope,this.phantomProxy.gotoPageCallBack=this.gotoPageCallBack,this.phantomProxy.setControlFactoryProxy(this.getControlFactoryProxy()),this.phantomProxy.baseId=this.baseId+"-phantom";var t=KD.cloneObject(e);t.hasPhantom=!1,this.phantomProxy.createControl.call(this.phantomProxy,t)}},loadConfig:function(e){KDPagerProxyPlugInBase.superclass.loadConfig.call(this,e),this.pageCount=null!=e.pageCount?e.pageCount:this.pageCount,this.el.addClass("kd_grid_page_extend"),this.phantomProxy&&this.phantomProxy.loadConfig.call(this.phantomProxy,e)},addClass:function(e){this.el&&this.el.addClass(e),this.phantomProxy&&this.phantomProxy.addClass.call(this.phantomProxy,e)},setVisible:function(e){KDPagerProxyPlugInBase.superclass.setVisible(e),e?this.el.show():this.el.hide(),this.phantomProxy&&this.phantomProxy.setVisible.call(this.phantomProxy,e)},getEnumSource:function(e){var t=[],i={};if(e)for(var a=0;a<e.length;a++){var n=e[a];!i[n]&&n&&(i[n]=!0,t.push({alias:n,name:n,value:n}))}return t},gotoPage:function(e,t,i,a){var n=this;if(!n.isInit){var o=n.scope.store,r=(o?o.getDataRowCount.call(o):-1,o?o.getRowCount.call(o):-1,n.pageIndex);if(0==e?(r=n.pageIndex,r+=t||0):r=-1==e?n.pageCount:e+(t||0),1>r&&(r=1),r>n.pageCount&&-1!=n.config.rowCount&&(r=n.pageCount),n.pageIndex=r,void 0==n.LastPagerIndexOldValue||n.LastPagerIndexOldValue!=n.pageIndex){if(n.LastPagerIndexOldValue=n.pageIndex,n.gotoPageCallBack&&n.scope){var s=(n.isLastClick||!1)&&-1==n.config.rowCount;n.gotoPageCallBack.call(n.scope,n.pageIndex,n.pageSize,s,i)}this.refreshPage()}}},splitPage:function(e,t){var i=this;i.pageSize=parseInt(e.toString()),i.pageIndex=i.pageIndex||1;var a=t&&t.isEventSource,n=t&&t.isFromPhantom;a?i.sourceProxy&&i.sourceProxy.splitPage.call(i.sourceProxy,e,{isFromPhantom:!0}):i.syncPageRowToUI(),n||i.phantomProxy&&i.phantomProxy.splitPage.call(i.phantomProxy,e),a&&i.gotoPage(1,0,KDPagerProxy.PageOption.SizeChange)},syncPageRowToUI:function(){},reloadData:function(e){if(e.isFailureQuery)return void this.gotoPage.call(this,0,-1,KDPagerProxy.PageOption.Previous);var t=this;if(t.isInit=!0,t.config.rowNum=t.pageSize=null!=e.rowNum?e.rowNum:t.pageSize,t.config.rowCount=void 0===e.rowCount?-1:e.rowCount,t.pageCount=null!=e.pageCount?e.pageCount:t.pageCount,t.pageIndex=(null!=e.pageIndex?e.pageIndex:t.pageIndex)||(t.pageCount?1:0),t.LastPagerIndexOldValue=void 0,t.config.currSelectNumber=KD.getValue(e,"currSelectNumber",0),t.config.isShowCurrSelectNumber=KD.getValue(e,"isShowCurrSelectNumber",!0),t.config.currentDataRows=KD.getValue(e,"currentDataRows",0),t.viceTitle=KD.getValue(e,"viceTitle",""),t.IsTextViceTitle=KD.getValue(e,"IsTextViceTitle",void 0),t.clientFilterRowCountTip=void 0,-1!=t.config.rowCount&&t.pageIndex>t.pageCount)return t.isInit=!1,void this.gotoPage(t.pageCount,0,KDPagerProxy.PageOption.GoTo);e.rowList.indexOf(e.maxPageRow)<0&&e.rowList.push(e.maxPageRow);try{t.setPageRowList(e.rowList)}catch(i){KD.writeLog("KDPagerProxy->setPageRowList",i,!0)}t.refreshPage(),this.phantomProxy&&this.phantomProxy.reloadData.call(this.phantomProxy,e),t.isInit=!1},setPageRowList:function(e){this.config.rowList=e},refreshPage:function(){},release:function(){var e=this.pageRow?this.pageRow.data("kendoComboBox"):void 0;e&&e.destroy&&(e.destroy(),delete this.pageRow),this.el&&this.el.remove(),delete this.el;var t=this.phantomProxy,i=this.sourceProxy;delete this.sourceProxy,delete this.phantomProxy,t&&t.release.call(t),i&&i.release.call(i)},initcurPgSize:function(e){return this.phantomProxy&&this.phantomProxy.initcurPgSize.call(this.phantomProxy,e),e}})}(jQuery),function(e){KDDefaultPagerProxy=KD.extend(KDPagerProxyPlugInBase,{config:{rowList:[5,10,20,50,100],rowNum:20,pageIndex:1,pageCount:2,maxPageRow:100,hasPhantom:!1},phantomProxy:null,maxPageRow:100,pageIndex:1,pageCount:2,pageSize:20,currSelectNumber:'[data-kdid="sp_0_pagerlist2"]',pageEditorSelector:'[data-kdid="sp_1_pagerlist2"]',pageTotalSelector:'[data-kdid="sp_2_pagerlist2"]',pageRowSelector:'[data-kdid="sp_3_pagerlist2"]',firstBtnSelector:'[data-kdid="first_pagerlist2"]',prevBtnSelector:'[data-kdid="prev_pagerlist2"]',nextBtnSelector:'[data-kdid="next_pagerlist2"]',lastBtnSelector:'[data-kdid="last_pagerlist2"]',rowCountSelector:'[data-kdid="rowcount_pagerlist2"]',viceTitleSelector:'[data-kdid="viceTitle_pagerlist2"]',clientFilterRowCountTip:void 0,createControl:function(t){t=e.extend(this.config,t),KDDefaultPagerProxy.superclass.createControl.call(this,t),this.el.css({height:t.height/12+"em"});var i=KDDefaultPagerProxy.Template.replace("{0}",this.baseId+"-rowselect");this.el.html(i)},loadConfig:function(t){var i=this;e.extend(i.config,t||{}),i.pageSize=i.config.rowNum,i.viceTitle=i.config.voiceTitle,KDDefaultPagerProxy.superclass.loadConfig.call(i,i.config),i._initPageEditor(),this.el.addClass("kd-grid-page-default");i.pageSize=i.initcurPgSize(i.pageSize);i._initPageRow(),i.totalPage=e(i.pageTotalSelector,i.el),i.firstBtn=e(i.firstBtnSelector,i.el).click(function(){e(this).hasClass(KDDefaultPagerProxy.btnDisableClass)||i.gotoPage.call(i,1,0,KDPagerProxy.PageOption.First)}),i.prevBtn=e(i.prevBtnSelector,i.el).click(function(){e(this).hasClass(KDDefaultPagerProxy.btnDisableClass)||i.gotoPage.call(i,0,-1,KDPagerProxy.PageOption.Previous)}),i.nextBtn=e(i.nextBtnSelector,i.el).click(function(){e(this).hasClass(KDDefaultPagerProxy.btnDisableClass)||i.gotoPage.call(i,0,1,KDPagerProxy.PageOption.Next)}),i.lastBtn=e(i.lastBtnSelector,i.el).click(function(){e(this).hasClass(KDDefaultPagerProxy.btnDisableClass)||(i.isLastClick=!0,i.gotoPage.call(i,-1,0,KDPagerProxy.PageOption.Last),i.isLastClick=!1)}),i.rowCountDesc=e(i.rowCountSelector,i.el),i.viceTitleDesc=e(i.viceTitleSelector,i.el),i.refreshPage()},syncPageRowToUI:function(){var e=this;e.isInit=!0,e.pageRow.data("kendoComboBox").value(e.pageSize),e.isInit=!1},_initPageEditor:function(){var t=this;t.pageEditor=e(t.pageEditorSelector,t.el),t.pageEditor&&t.pageEditor.kendoKDNumberField({precision:0,max:1e3,min:0,maxlength:4,showButton:!1,isZeroShow:!0,isControlPrecision:!0,value:t.pageIndex,change:function(e,i){t.isInit||t.gotoPage.call(t,parseInt(i),0,KDPagerProxy.PageOption.GoTo,{isEventSource:!0})}}).children().css({display:"block",margin:"3px auto 0px"})},_initPageRow:function(){var t=this;return t.pageRow=e(t.pageRowSelector,t.el),void 0!=t.pageRow.data("kendoComboBox")?void t.syncPageRowToUI():(t.userInputValue=void 0,void t.pageRow.kendoComboBox({dataTextField:"name",dataValueField:"value",dataSource:t.getEnumSource(t.config.rowList),value:t.pageSize,suggest:!1,clearButton:!1,height:226,select:function(e){e.item&&!e.item.hasClass("k-state-hover")?t.userInputValue=e.sender.input.val():t.userInputValue=void 0},change:function(e){if(!t.isInit){var i=t.userInputValue||e.sender.value();t.userInputValue=void 0,i=KD.isNaN(parseInt(i))?1:parseInt(i),i>t.config.rowList[t.config.rowList.length-1]?i=t.config.rowList[t.config.rowList.length-1]:1>i&&(i=1),e.sender.value(i),t.LastPagerIndexOldValue=void 0,t.splitPage.call(t,i,{isEventSource:!0})}},open:function(e){var t=e.sender.wrapper;t.addClass("kd-btn-clickstate"),KD.delayInvoke(function(e){t&&t.removeClass("kd-btn-clickstate")},50)},close:function(e){e.sender.wrapper.hasClass&&e.sender.wrapper.hasClass("kd-btn-clickstate")&&e.preventDefault()}}))},_pageEditorValue:function(e){var t=this,i=void 0,a=t.pageEditor,n=a?a.data("kendoKDNumberField"):void 0;return n?i=void 0===e?n.val():n.val(t.pageIndex):i},setPageRowList:function(e){var t=this;KDDefaultPagerProxy.superclass.setPageRowList.call(t,e);var i=KD.arraySort(e),a=new kendo.data.DataSource({data:t.getEnumSource(i)}),n=t.pageRow.data("kendoComboBox");n&&n.setDataSource(a)},setCurrSelectNumber:function(t){var i=this;i.currSelectNumberEdit=e(i.currSelectNumber,i.el),i.currSelectNumberEdit&&i.currSelectNumberEdit.text(t),this.phantomProxy&&this.phantomProxy.setCurrSelectNumber.call(this.phantomProxy,t)},setCurrSelectNumberIsShow:function(t){var i=e(this.currSelectNumber,this.el).parent();i.hasClass("kd-lblText")&&i.css("display",t?"inherit":"none")},setRowCount:function(e){var t=this,i=parseInt(e);KD.isNaN(i)||(t.pageCount=(e%t.pageSize>0?1:0)+parseInt(e/t.pageSize),t.config.rowCount=e,-1==t.config.rowCount?(t.totalPage.text(" *"),t.totalPage.attr("title",ResManager.LoadKDString("导航至最后一页显示总行数","099002000000111"))):(t.totalPage.text(" "+t.pageCount),t.totalPage.attr("title","")),-1==t.config.rowCount?(t.rowCountDesc.text(ResManager.LoadKDString("共*行 ","00214298000005423")),t.rowCountDesc.attr("title",ResManager.LoadKDString("导航至最后一页显示总行数","099002000000111"))):(t.rowCountDesc.text(kendo.format(ResManager.LoadKDString("共{0}行","00214298000005422"),t.config.rowCount||0)),t.rowCountDesc.attr("title","")))},refreshPage:function(){var e=this;e.initContentLang();e.pageSize=e.initcurPgSize(e.pageSize);e.isInit=!0,e._pageEditorValue(e.pageIndex),e._initPageRow(),e.setCurrSelectNumber(KD.getValue(this.getConfig(),"currSelectNumber",0)),e.setCurrSelectNumberIsShow(KD.getValue(this.getConfig(),"isShowCurrSelectNumber",!0)),-1==e.config.rowCount?(e.totalPage.text(" *"),e.totalPage.attr("title",ResManager.LoadKDString("导航至最后一页显示总行数","099002000000111"))):(e.totalPage.text(" "+e.pageCount),e.totalPage.attr("title","")),1==e.pageIndex?(e.firstBtn.addClass(KDDefaultPagerProxy.btnDisableClass),e.prevBtn.addClass(KDDefaultPagerProxy.btnDisableClass),e.pageCount>1?(e.nextBtn.removeClass(KDDefaultPagerProxy.btnDisableClass),e.lastBtn.removeClass(KDDefaultPagerProxy.btnDisableClass)):(e.nextBtn.addClass(KDDefaultPagerProxy.btnDisableClass),e.lastBtn.addClass(KDDefaultPagerProxy.btnDisableClass))):e.pageIndex==e.pageCount?(e.firstBtn.removeClass(KDDefaultPagerProxy.btnDisableClass),e.prevBtn.removeClass(KDDefaultPagerProxy.btnDisableClass),e.nextBtn.addClass(KDDefaultPagerProxy.btnDisableClass),e.lastBtn.addClass(KDDefaultPagerProxy.btnDisableClass)):(e.firstBtn.removeClass(KDDefaultPagerProxy.btnDisableClass),e.prevBtn.removeClass(KDDefaultPagerProxy.btnDisableClass),e.nextBtn.removeClass(KDDefaultPagerProxy.btnDisableClass),e.lastBtn.removeClass(KDDefaultPagerProxy.btnDisableClass)),-1==e.config.rowCount?(e.rowCountDesc.text(ResManager.LoadKDString("共*行 ","00214298000005423")),e.rowCountDesc.attr("title",ResManager.LoadKDString("导航至最后一页显示总行数","099002000000111")),e.nextBtn.removeClass(KDDefaultPagerProxy.btnDisableClass),e.lastBtn.removeClass(KDDefaultPagerProxy.btnDisableClass)):(e.rowCountDesc.text(kendo.format(ResManager.LoadKDString("共{0}行","00214298000005422"),e.config.rowCount||0)),e.rowCountDesc.attr("title","")),e.setViceTitle(),e.isInit=!1},setClinetFilterRowCountTip:function(e){this.clientFilterRowCountTip=e,this.setViceTitle(this.viceTitle)},setViceTitle:function(e){var t=this;if(t.viceTitle=t.viceTitle||e,KD.isEmpty(t.viceTitle))t.viceTitleDesc.hide();else{var i=kendo.format(ResManager.LoadKDString("当前显示{0}行","014005000002637"),t.config.currentDataRows||0);KD.isEmpty(this.clientFilterRowCountTip)||(i=this.clientFilterRowCountTip);var a=(t.viceTitle||"")+","+i;t.viceTitleDesc.show().attr("title",a),t.IsTextViceTitle&&t.viceTitleDesc.removeClass("kd-gridPager-viceTitle").text(a)}this.phantomProxy&&this.phantomProxy.setViceTitle.call(this.phantomProxy,e)},initContentLang:function(){var t=this;e("[data-kdid='first_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("第一页","099002000000087")),e("[data-kdid='prev_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("上一页","099002000000088")),e("[data-kdid='next_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("下一页","099002000000089")),e("[data-kdid='last_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("最后一页","099002000000090")),e("[data-kdid='lb_pagerow']",t.el).text(ResManager.LoadKDString("每页显示","099002000000114")),e("[data-kdid='lb_totalText']",t.el).text(" /"),e("[data-kdid='lb_PageText']",t.el).text(" "),this.phantomProxy&&this.phantomProxy.initContentLang.call(this.phantomProxy)}}),KDDefaultPagerProxy.btnDisableClass="kd-ui-pager-disabled",KDDefaultPagerProxy.pagerBtnClass="kd-ui-pager-btn",KDDefaultPagerProxy.Template='<ul style="float:right;margin-right:0px;height: 100%;">            <li class="kd-grid-pager-col">                <span data-kdid="viceTitle_pagerlist2" class="kd-lblText kd-gridPager-viceTitle" style="margin-right:0.42em;"></span>            </li><li dir="ltr" class="kd-grid-pager-col">                <span class="kd-lblText" style="padding-right:15px;">                    '+ResManager.LoadKDString("已选","0025710030034392")+' <span data-kdid="sp_0_pagerlist2" style="color:#FF8200;">                     0 </span> '+ResManager.LoadKDString("行","0025710030032943")+'                </span></li>            <li dir="ltr" class="kd-grid-pager-col">                <span class="kd-lblText">'+ResManager.LoadKDString("第","0025710000004606")+'</span>                <span class="kd-lblText">                     <span data-kdid="sp_1_pagerlist2" style="width:2.5em; height:1.91em; display:inline-block;border-radius: 2px;border:1px solid lightgray;"/>                </span>                <span class="kd-lblText">'+ResManager.LoadKDString("页","0025710000004605")+'</span>                <span data-kdid="lb_totalText" class="kd-lblText" style="padding-left:0px;"></span>                <span data-kdid="sp_2_pagerlist2" class="kd-lblText" style="">2</span>                <span class="kd-lblText">'+ResManager.LoadKDString("页","0025710000004605")+'</span>                <span data-kdid="lb_PageText" class="kd-lblText"></span>             </li>            <li data-kdid="first_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'" style="display1: none;">               <span class="kd-lblBtn kd-ui-icon-pager-first" style="background-image: url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span></li>            <li data-kdid="prev_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'">               <span class="kd-lblBtn kd-ui-icon-pager-prev" style="background-image: url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span></li>            <li data-kdid="next_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'" style="">               <span class="kd-lblBtn kd-ui-icon-pager-next" style="background-image: url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span></li>            <li data-kdid="last_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'" style="margin-right:10px; display1: none;">               <span class="kd-lblBtn kd-ui-icon-pager-end" style="background-image: url('+KD.getImageUrlByNameAndVersion("kd_icon_extend.png")+');"></span></li>            <li class="kd-grid-pager-col"><span class="kd-lblText" data-kdid="lb_pagerow"></span></li>            <li dir="ltr" class="kd-grid-pager-col"><span class="kd-lblText" style="margin-top:-0.56em;">                <span data-kdid="sp_3_pagerlist2" id={0} style="width:5.83em;height:1.75em;border-radius:0px;"/>                </span><span class="kd-lblText" style="margin-left: 0.3em;">'+ResManager.LoadKDString("行","0025710030032943")+'/</span>           </li>           <li class="kd-grid-pager-col">                <span data-kdid="rowcount_pagerlist2" class="kd-lblText"  style="margin-left:0px;margin-right:0.5em;"></span>           </li>        </ul>'}(jQuery),function(e){KDNumberPagerProxy=KD.extend(KDPagerProxyPlugInBase,{config:{rowList:[5,10,20,50,100],rowNum:20,pageIndex:1,pageCount:1,maxPageRow:100},maxPageRow:100,pageIndex:1,pageCount:1,pageSize:20,currSelectNumber:'[data-kdid="sp_0_pagerlist2"]',pageEditorSelector:'[data-kdid="sp_1_pagerlist2"]',pageTotalSelector:'[data-kdid="sp_2_pagerlist2"]',pageRowSelector:'[data-kdid="sp_3_pagerlist2"]',prevBtnSelector:'[data-kdid="prev_pagerlist2"]',nextBtnSelector:'[data-kdid="next_pagerlist2"]',turnPageBtnSelector:".kd-ui_kdnumberpager_turnbtn",unknowPageMoreSelector:".kd-ui_kdnumberpager_more",totalPageText:ResManager.LoadKDString("第{0}页/共{1}页","099002000000117"),maxDisplayNumber:10,createControl:function(t){t=e.extend(this.config,t),KDNumberPagerProxy.superclass.createControl.call(this,t),this.el.css({height:t.height/12+"em"});var i=KDNumberPagerProxy.Template.replace("{0}",this.baseId+"-rowselect");this.el.html(i)},loadConfig:function(t){var i=this;e.extend(i.config,t||{}),i.pageSize=i.config.rowNum,i.viceTitle=i.config.voiceTitle,i.IsTextViceTitle=i.config.IsTextViceTitle;i.pageSize=i.initcurPgSize(i.pageSize);KDNumberPagerProxy.superclass.loadConfig.call(i,i.config),i._initPageEditor(),i.maxDisplayNumber=KD.getValue(i.config,"maxdisplaypagernum",i.maxDisplayNumber),i.pageEditor=e(i.pageEditorSelector,i.el),i.totalPage=e(i.pageTotalSelector,i.el),i.prevBtn=e(i.prevBtnSelector,i.el).click(function(){if(!e(this).hasClass(KDNumberPagerProxy.btnDisableClass)){var t,a=i.pageNumSpanList.length,n=parseInt(e(i.pageNumSpanList.get(i.pageNumSpanList.length-1)).text());i.pageNumSpanList.each(function(){var o=parseInt(e(this).text());a==i.maxDisplayNumber&&n>1&&e(this).text(o-1),e(this).hasClass("kd-ui_kdnumberpager_currentnumber")&&(t=e(this))}),a<i.maxDisplayNumber&&(t=t.next()),t&&t.trigger("click")}}),i.nextBtn=e(i.nextBtnSelector,i.el).click(function(){if(!e(this).hasClass(KDNumberPagerProxy.btnDisableClass)){var t=i.scope.store;if(!(t.getRowCount.call(t)<i.config.rowNum)){var a,n=i.pageNumSpanList.length,o=parseInt(e(i.pageNumSpanList.get(0)).text());e(i.unknowPageMoreSelector,i.el).length>0&&n<i.maxDisplayNumber&&(i.addPageNumberDom(o+1),n++,o++,i.pageCount++),i.pageNumSpanList.each(function(){var t=parseInt(e(this).text());n==i.maxDisplayNumber&&o<i.pageCount&&e(this).text(t+1),e(this).hasClass("kd-ui_kdnumberpager_currentnumber")&&(a=e(this))}),n<i.maxDisplayNumber&&(a=a.prev()),a&&a.trigger("click")}}}),i.turnPageBtn=e(i.turnPageBtnSelector,i.el).click(function(){if(e(this).hasClass(KDNumberPagerProxy.btnDisableClass))return!1;var t=i._pageEditorValue();if(t&&t>0&&t<=i.pageCount){var a,n=i.pageNumSpanList.length;if(i.pageNumSpanList.each(function(){var i=parseInt(e(this).text());i==t&&(a=e(this))}),!a){var o=parseInt(e(i.pageNumSpanList.get(0)).text()),r=parseInt(e(i.pageNumSpanList.get(i.pageNumSpanList.length-1)).text());t>o&&(n<i.maxDisplayNumber&&i.addPageNumberDom(t),i.pageNumSpanList.each(function(){e(this).text(t),t--}),a=e(i.pageNumSpanList.get(0))),r>t&&(n<i.maxDisplayNumber&&i.addPageNumberDom(-1*t),i.pageNumSpanList.each(function(){e(this).text(t),t++}),a=e(i.pageNumSpanList.get(i.pageNumSpanList.length-1)))}a&&a.trigger("click")}return!1}),i.pageNumSpanList=e(".kd-ui_kdnumberpager_number",i.el),i.initPageNumEvent(),i.refreshPage()},getPageText:function(e,t){var i=this,a=i.totalPageText.replace("{0}",e).replace("{1}",t);return a},_pageEditorValue:function(e){var t=this,i=void 0,a=t.pageEditor,n=a?a.data("kendoKDNumberField"):void 0;return n?(i=void 0===e?n.element.val():n.val(t.pageIndex),i=parseInt(i),isNaN(i)?0:i):i},syncPageRowToUI:function(){var e=this;e.isInit=!0,e.pageRow.data("kendoComboBox").value(e.pageSize),e.isInit=!1},_initPageEditor:function(){var t=this;t.pageEditor=e(t.pageEditorSelector,t.el),t.pageEditor&&t.pageEditor.kendoKDNumberField({precision:0,max:1e3,min:0,
isZeroShow:!0,maxlength:4,showButton:!1,isControlPrecision:!0,value:t.pageIndex,change:function(e,i){t.isInit||t.gotoPage.call(t,parseInt(i),0,KDPagerProxy.PageOption.GoTo,{isEventSource:!0})}}).children().css({display:"block",margin:"2px auto"})},_initPageRow:function(){var t=this;if(t.pageRow=e(t.pageRowSelector,t.el),void 0!=t.pageRow.data("kendoComboBox"))return void t.syncPageRowToUI();t.pageRow=e(t.pageRowSelector,t.el).css({width:60}).kendoComboBox({dataTextField:"name",dataValueField:"value",dataSource:t.getEnumSource(t.config.rowList),width:60,value:t.pageSize,suggest:!0,clearButton:!1,height:226,index:t.pageSize,change:function(e){if(!t.isInit){var i=e.sender.value();i&&i>0&&(i>2e4?t.getFormProxy().showMessage(ResManager.LoadKDString("每页行数设置超出范围，请输入有效值!","0025710030032295"),"",t.getPageId(),0,3):t.splitPage.call(t,i,{isEventSource:!0}))}}});var i=t.pageRow.data("kendoComboBox").input;i.attr("min",t.config.rowList[0]).attr("max",t.config.rowList[t.config.rowList.length-1]).keyup(function(t){var i=e(t.currentTarget||t.target),a=parseInt(i.val());isNaN(a)&&(a=0);var n=parseInt(i.attr("min"));isNaN(n)&&(n=5);var o=parseInt(i.attr("max"));isNaN(o)&&(a=1500),n>a&&(a=n,i.val(a)),a>o&&(a=o,i.val(a))})},setPageRowList:function(e){var t=this;KDDefaultPagerProxy.superclass.setPageRowList.call(t,e);var i=KD.arraySort(e),a=new kendo.data.DataSource({data:t.getEnumSource(i)}),n=t.pageRow.data("kendoComboBox");n&&n.setDataSource(a)},setCurrSelectNumberIsShow:function(t){var i=e(this.currSelectNumber,this.el).parent();i.hasClass("kd-lblText")&&i.css("display",t?"inherit":"none")},setViceTitle:function(e){var t=this;t.viceTitle=t.viceTitle||e,t.viceTitleDesc.text(t.viceTitle||""),this.phantomProxy&&this.phantomProxy.setViceTitle.call(this.phantomProxy,e)},setCurrSelectNumber:function(t){var i=this;i.currSelectNumberEdit=e(i.currSelectNumber,i.el),i.currSelectNumberEdit&&i.currSelectNumberEdit.text(t)},refreshPage:function(){var t=this;t.isInit=!0,t.initContentLang(),t._initPageRow(),-1==t.config.rowCount?(t.totalPage.text(" "+t.getPageText(t.pageIndex,"*")),0==e(t.unknowPageMoreSelector,t.el).length&&t.addMoreNumPage(),t.totalPage.attr("title",ResManager.LoadKDString("进行下一页翻页","099002000000118"))):(t.totalPage.text(" "+t.getPageText(t.pageIndex,t.pageCount)),e(t.unknowPageMoreSelector,t.el).remove(),t.totalPage.attr("title","")),t.refreshPageNumberDom(),1==t.pageCount?(t.prevBtn.addClass(KDNumberPagerProxy.btnDisableClass),t.nextBtn.addClass(KDNumberPagerProxy.btnDisableClass)):1==t.pageIndex?(t.prevBtn.addClass(KDNumberPagerProxy.btnDisableClass),t.nextBtn.removeClass(KDNumberPagerProxy.btnDisableClass)):t.pageIndex==t.pageCount?(t.prevBtn.removeClass(KDNumberPagerProxy.btnDisableClass),t.nextBtn.addClass(KDNumberPagerProxy.btnDisableClass)):(t.prevBtn.removeClass(KDNumberPagerProxy.btnDisableClass),t.nextBtn.removeClass(KDNumberPagerProxy.btnDisableClass)),-1==t.config.rowCount&&t.nextBtn.removeClass(KDNumberPagerProxy.btnDisableClass),t.isInit=!1},refreshPageNumberDom:function(){if(this.pageNumSpanList){var t=this.pageNumSpanList.length;if(t==this.pageCount)return;if(t==this.maxDisplayNumber&&this.pageCount>=this.maxDisplayNumber)return;this.pageNumSpanList.remove()}var i="",a="<span class='kd-ui_kdnumberpager_number kd-ui_kdnumberpager_currentnumber'>1</span>";if(this.prevBtn.addClass(KDNumberPagerProxy.btnDisableClass),this.pageCount>1)for(var n=this.pageCount>this.maxDisplayNumber?this.maxDisplayNumber:this.pageCount,o=n;o>1;o--)i+="<span class='kd-ui_kdnumberpager_number'>"+o+"</span>";i+=a,this.prevBtn.before(i),this.pageNumSpanList=e(".kd-ui_kdnumberpager_number",this.el),this.initPageNumEvent()},addPageNumberDom:function(t){var i="<span class='kd-ui_kdnumberpager_number'>"+Math.abs(t)+"</span>",a=this.el.find(".kd-ui_kdnumberpager_more");t>0&&(a.length>0?a.after(i):this.nextBtn.after(i)),0>t&&this.prevBtn.before(i),this.pageNumSpanList=e(".kd-ui_kdnumberpager_number",this.el),this.initPageNumEvent()},addMoreNumPage:function(){var e="<span class='kd-ui_kdnumberpager_more'>...</span>";this.nextBtn.after(e)},removePageNumberDom:function(t){this.pageNumSpanList.each(function(){var i=parseInt(e(this).text());return i==t?(e(this).remove(),!1):void 0}),this.pageNumSpanList=e(".kd-ui_kdnumberpager_number",$this.el)},initPageNumEvent:function(){if(this.pageNumSpanList){var t=this;t.pageNumSpanList.unbind("click"),this.pageNumSpanList.click(function(){t.pageNumSpanList.removeClass("kd-ui_kdnumberpager_currentnumber");var i=parseInt(e(this).text());e(this).addClass("kd-ui_kdnumberpager_currentnumber"),1==i?t.gotoPage.call(t,i,0,KDPagerProxy.PageOption.First):i==t.pageCount?t.gotoPage.call(t,i,0,KDPagerProxy.PageOption.Last):i==t.pageIndex+1?t.gotoPage.call(t,i,0,KDPagerProxy.PageOption.Next):i==t.pageIndex-1?t.gotoPage.call(t,i,0,KDPagerProxy.PageOption.Previous):t.gotoPage.call(t,i,0,KDPagerProxy.PageOption.GoTo)})}},initContentLang:function(){var t=this;e("[data-kdid='lb_pagerow']",t.el).text(ResManager.LoadKDString("每页显示","099002000000114")),e("[data-kdid='lb_sprow']",t.el).text(ResManager.LoadKDString("行","099002000000119")),e("[data-kdid='bt_turnpage']",t.el).text(ResManager.LoadKDString("跳转","099002000000120")),e("[data-kdid='lb_turnnext']",t.el).text(ResManager.LoadKDString("下一页","099002000000089"))}}),KDNumberPagerProxy.btnDisableClass="ui-state-disabled",KDNumberPagerProxy.Template='<table style="width:100%;height:100%;"><tr> <td class="kd-ui_kdnumberpager_lefttd"><span data-kdid="lb_pagerow"></span><span class="kd-select-pagerow"><select id={0} data-kdid="sp_3_pagerlist2" class="ui-pg-selbox" role="listbox"/></span><span data-kdid="lb_sprow"></span></td><td><div class="kd-ui_kdnumberpager_turnbtn"><button class="ui-pg-button" style="line-height:19px" data-kdid="bt_turnpage"></button></div><div class="kd-ui_kdnumberpager_turnpage"><input data-kdid="sp_1_pagerlist2" class="ui-pg-input" style="width:40px;height:17px;" role="textbox" type="text" size="2" maxlength="7" value=""></div><div data-kdid="next_pagerlist2" class="kd-ui_kdnumberpager_turnnext"><span data-kdid="lb_turnnext"></span><div class="ui_next_icon"></div></div><span class="kd-ui_kdnumberpager_number kd-ui_kdnumberpager_currentnumber">1</span><div data-kdid="prev_pagerlist2" class="kd-ui_kdnumberpager_turnpre"><div class="ui_pre_icon"></div></div><span data-kdid="sp_2_pagerlist2" class="kd-ui_kdnumberpager_pagecount"></span></td></tr></table>',KDPagerProxy.ResgiterPlugIn("numberpager",KDNumberPagerProxy)}(jQuery),function(e){KDGalaxytPagerProxy=KD.extend(KDDefaultPagerProxy,{issimplemode:void 0,Template:'<ul style="float:right;margin-right:0px;height: 100%;padding-right: 10px;">            <li class="kd-grid-pager-col">                <span data-kdid="viceTitle_pagerlist2" class="kd-lblText kd-gridPager-viceTitle" style="margin-right:0.42em;"></span>            </li><li dir="ltr" class="kd-grid-pager-col" style="display:none;">                <span class="kd-lblText" style="padding-right:0px;">                    '+ResManager.LoadKDString("已选","0025710030034392")+' <span data-kdid="sp_0_pagerlist2" style="color:#FF8200;">                     0 </span> '+ResManager.LoadKDString("行","0025710030032943")+'/                 </span></li>             <li class="kd-grid-pager-col" style="display:none;">                <span data-kdid="rowcount_pagerlist2" class="kd-lblText"  style="margin-left:0px;margin-right:0.5em;"></span>            </li>            <li dir="ltr" data-kdid="pagerCount" class="kd-grid-pager-col">                <span data-kdid="lb_totalText" class="kd-lblText" style="padding-left:0px;">'+ResManager.LoadKDString("共","0025710000004604")+'</span>                <span data-kdid="sp_2_pagerlist2" class="kd-lblText" style="">2</span>                <span data-kdid="lb_PageText" class="kd-lblText">'+ResManager.LoadKDString("页","0025710000004605")+'</span>             </li>            <li dir="ltr"  data-kdid="pagerIndex" class="kd-grid-pager-col" style="margin-left:1em;margin-right:1em;">                <span data-kdid="lb_totalText" class="kd-lblText" style="padding-left:0px;">'+ResManager.LoadKDString("第","0025710000004606")+'</span>                <span class="kd-lblText">                     <span data-kdid="sp_1_pagerlist2" style="width:2.5em; height:2em; display:inline-block;background:#FFF;border-radius:2px;"/>                </span>                <span data-kdid="lb_PageText" class="kd-lblText">'+ResManager.LoadKDString("页","0025710000004605")+'</span>             </li>            <li data-kdid="first_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'">               <span class="kd-lblBtn kd-ui-icon-pager-first"></span></li>            <li data-kdid="prev_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'">               <span class="kd-lblBtn kd-ui-icon-pager-prev"></span></li>            <li data-kdid="next_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'" style="">               <span class="kd-lblBtn kd-ui-icon-pager-next"></span></li>            <li data-kdid="last_pagerlist2" class="kd-grid-pager-col '+KDDefaultPagerProxy.pagerBtnClass+'" style="">               <span class="kd-lblBtn kd-ui-icon-pager-end"></span></li>            <li class="kd-grid-pager-col" style="display:none;"><span class="kd-lblText" data-kdid="lb_pagerow"></span></li>            <li data-kdid="pagerow_editor" dir="ltr" class="kd-grid-pager-col" style="position:relative;margin-left:1em;"><span class="kd-lblText" style="">                <span data-kdid="sp_3_pagerlist2" id={0} style="min-height:1.67em;border-radius:0px;"/>                </span><span class="kd-lblText  kd-pagerrow-editor-desc" style="">'+ResManager.LoadKDString("条/页","0025710000004607")+"</span>           </li>        </ul>",createControl:function(t){t=e.extend(this.config,t),KDDefaultPagerProxy.superclass.createControl.call(this,t),this.el.css({height:t.height/12+"em"}).addClass("kd-pager-galaxy");var i=this.Template.replace("{0}",this.baseId+"-rowselect");this.el.html(i),this.issimplemode=KD.getValue(t,"issimplemode",void 0),void 0!=this.issimplemode&&this.setSimpleMode(this.issimplemode)},setSimpleMode:function(e){var t=this.el.find('[data-kdid="pagerCount"]'),i=this.el.find('[data-kdid="pagerIndex"]'),a=this.el.find('[data-kdid="pagerow_editor"]');e?(t.hide(),i.hide(),a.hide()):(t.show(),i.show(),a.show())},initContentLang:function(){var t=this;e("[data-kdid='first_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("第一页","099002000000087")),e("[data-kdid='prev_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("上一页","099002000000088")),e("[data-kdid='next_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("下一页","099002000000089")),e("[data-kdid='last_pagerlist2']",t.el).attr("title",ResManager.LoadKDString("最后一页","099002000000090")),e("[data-kdid='lb_pagerow']",t.el).text(ResManager.LoadKDString("每页显示","099002000000114")),this.phantomProxy&&this.phantomProxy.initContentLang.call(this.phantomProxy)},_initPageRow:function(){KDGalaxytPagerProxy.superclass._initPageRow.call(this);var t=this.pageRow.data("kendoComboBox");t.input.attr({readonly:"true"}).css({width:"40px","text-align":"center"});var i=this.el.find('[data-kdid="pagerow_editor"] .kd-pagerrow-editor-desc');if(i.length>0){var a=0;if(0==this.scope.el.find(i).length){var n=i.clone();e("body").append(n),a=24+n.outerWidth(),n.remove()}else a=24+i.outerWidth();t.wrapper.find(".k-dropdown-wrap").css({"padding-right":a+"px"})}}}),KDPagerProxy.ResgiterPlugIn("kdpager_Galaxy",KDGalaxytPagerProxy)}(jQuery),define("KDPagerProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDPagerProxy}}(this)),KDAnchorProxy=KD.extend(KDControlProxy,{loadConfig:function(e){var t=this;KDAnchorProxy.superclass.loadConfig.call(this,e),this.el.removeAttr("style"),this.el.addClass("anthorDiv");var i=e.SelfPropertyName;for(var a in i)$("<div class='IconDiv'>"+i[a].Key+"</div><div class='LineDiv'></div>").appendTo(this.el).bind("click",{myKey:i[a].Key},function(e){var i=e.data.myKey,a=t.controlFactoryProxy.getCmp(i);location.href="#"+a.baseId})}}),KDControlFactoryProxy.registerType("kdanchor",KDAnchorProxy),define("KDAnchorProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDAnchorProxy}}(this)),KDESignatureProxy=KD.extend(KDControlProxy,{loadConfig:function(e){var t={},i=KD.getValue(e,"stackorientation",0);t["flex-direction"]=0==i?"row":"column",e.width&&(t.width=e.width),e.height&&(t.height=e.height),e.x&&$.extend(t,{position:"absolute",left:e.x,top:e.y,"z-index":99,display:"none"}),this.el.css(t),this.el.addClass("kd-esignature-container")},setESignatureItems:function(e){if(this.el.empty(),e.length>0){for(var t="",i=0;i<e.length;i++){var a=kendo.format('<div><span class="kd-esignature-text">{0}</span><img src="{1}" width="{2}" height="{3}" style="vertical-align:middle;"></div>',e[i].text,e[i].imgurl,e[i].width,e[i].height);t+=a}this.el.append($(t)),this.el.show()}else 0==e.length&&this.el.hide()}}),KDControlFactoryProxy.registerType("kdesignature",KDESignatureProxy),define("KDESignatureProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDESignatureProxy}}(this)),KDLabelProxy=KD.extend(KDControlProxy,{TextAlignment:"",LineHeight:"",htmlEncode:!1,initComponent:function(){var e=this,t=e.config;KDLabelProxy.superclass.initComponent.call(this);var i=this.createInnerDom();this.el.append(i),this.component=i,this.setText(t.text?t.text:""),this.setForeColor(t.forecolor),this.setLinewrap(t.lineWrap),this.setStyle(t.style),this.setStylekey(KD.getValue(t,"stylekey","")),this.LineHeight=KD.getValue(t,"lineheight",this.LineHeight),this.setLineheight(this.LineHeight.toString()),this.setTextalign(this.TextAlignment),this.setPosition(t.x,t.y),this.el.addClass("kendo-color"),this.config.dock==KD.dock.None&&0==this.config.width&&this.component.hide(),"1033"==KD.cookieLanguageId()&&this.el.css({"font-family":"Arial"}),this.resetElHeight()},loadLayoutSetting:function(e){},resetElHeight:function(){if(this.component){var e=KD.layout.getActualHeight(this.component),t=KD.layout.getActualHeight(this.el);t>e&&this.el.css({height:"auto"})}},createInnerDom:function(){return $("<span>")},setPosition:function(e,t){var i=new Object;e&&(i.left=e+"px"),t&&(i.top=t+"px"),this.el.css(i)},setHtmlEncode:function(e){this.htmlEncode=e},setText:function(e){if(this.oldText&&this.oldText==e||(this.oldText=e),$(this.el).attr("style")){var t=$(this.el).attr("style").split(";"),i=t.filter(function(e){return e.indexOf("height")>-1});if(!(i.length>0&&0==parseInt(i[0].split(":")[1]))){var a="";this.htmlEncode?a=KD.htmlUtil.decode(e||""):(e&&e.indexOf&&e.indexOf("~")>=0&&this.component.css({"font-family":"Microsoft YaHei"}),a=(e||"").replace(/\n/g,"<br/>").replace(/\r\n/g,"<br/>")),a.length>300&&this.component.css({overflow:"auto"}),KD.setHtml(this.component,a)}}},setHeight:function(e){this.el&&this.el.css("height",e+"px"),e>0&&this.setText(this.oldText)},setValue:function(e){this.setText(e)},setLinewrap:function(e){this.component.css("textwrap",e?"wrap":"none"),0==e?this.component.css({overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"100%",display:"inline-block"}):this.component.css({overflow:"initial","text-overflow":"inherit","white-space":"inherit","word-wrap":"break-word","overflow-wrap":"break-word","word-break":"break-word"})},doLayout:function(){KDLabelProxy.superclass.doLayout.call(this),this.resetElHeight()},setStyle:function(e){if(e){var t=(e||"").toString().split(";");if(0!=t.length)for(var i=0;i<t.length;i++){var a=t[i].trim();if(""!=a){var n=a.split(":")[0],o=a.split(":")[1];switch(n.trim()){case"text-align":this.TextAlignment=o;break;case"border":case"line-height":break;default:this.el.css(n,o)}}}}},setStylekey:function(e){if(!KD.isEmpty(e))if(e.indexOf&&e.indexOf(":")<=0)this.el.addClass(e);else{var t=(e||"").toString().split(";");if(0==t.length)return;for(var i=0;i<t.length;i++){var a=t[i].trim();if(""!=a){var n=a.split(":")[0];n&&n.trim&&(n=n.trim());var o=a.split(":")[1];o&&o.trim&&(o=o.trim()),this.el.css(n,o)}}}},setTextalign:function(e){KD.IsNullOrWhiteSpace(e)||(this.TextAlignment=e,this.el.css("text-align",this.TextAlignment))},setLineheight:function(e){e&&!KD.IsNullOrWhiteSpace(e)&&(-1==e.indexOf("px")&&(e+="px"),this.LineHeight=e,this.component.css("line-height",this.LineHeight))},setX:function(e){this.el.css("left",e)},setY:function(e){this.el.css("top",e)},setToggleEditTitle:function(e){this.el.attr("data-canEditCardTitle",e)}}),KDControlFactoryProxy.registerType("label",KDLabelProxy),define("KDLabelProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDLabelProxy}}(this)),KDProgressbarProxy=KD.extend(KDControlProxy,{IsIndeterminate:!0,ValueVisible:!1,IsFolding:!1,Value:0,lblCaption:null,ValueTilte:"",ValueColor:null,Style:new Object,ClickAble:!1,ignoreUpdateLastTime:!1,getKendoCType:function(){return"kendoProgressBar"},getKendoOptions:function(){var e=this,t=KDProgressbarProxy.superclass.getOptions.call(this);return $.extend(t,{max:e.config.maximum,min:e.config.minimum,value:e.config.isIndeterminate?!1:e.config.value,showStatus:!0,type:this.config.isProgressBarCircleExtend?"value":"percent",complete:function(e){},change:function(e){}}),t.style=this.getStyle(),t},createInnerDom:function(){return $("<div></div>")},loadConfig:function(e){KDProgressbarProxy.superclass.loadConfig.call(this,e),KD.layout.setAbsolute(this.el,e),this.IsIndeterminate=KD.getValue(e,"isIndeterminate",!0),this.ValueVisible=KD.getValue(e,"valuevisible",!0),this.setIsFolding(KD.getValue(e,"isfolding",!1)),this.setIgnoreUpdateLastTime(KD.getValue(e,"ignoreUpdateLastTime",!1)),this.ValueColor=KD.getValue(e,"ValueColor",""),this.ClickAble=KD.getValue(e,"clickable",!1)},setIgnoreUpdateLastTime:function(e){this.ignoreUpdateLastTime=e},initComponent:function(){if(KDProgressbarProxy.superclass.initComponent.call(this),this.lblCaption=$(kendo.format("<div id='lblCaption_{0}'>{1}</div>",this.baseId,this.ValueTilte)),this.component.after(this.lblCaption),this.component.hasClass("KDProgressBarCircleStyle")){var e=1,t=this.el.height()%2==0?this.el.height():this.el.height()+1;this.el.css({height:t,width:t}),this.el.addClass("kdProgressCircleBar"),this.lblCaptionright=$(kendo.format("<div id='lblCaptionright_{0}' class='kdProgressCircleBar-container'><div style='clip:inherit;' class='kdProgressCircleBar-right'></div></div>",this.baseId)),this.component.after(this.lblCaptionright),this.lblCaptionright.css({clip:"rect(0,auto,auto,"+(t/2+e)+"px)",width:t+2*e+"px",height:t+2*e+"px"}),this.lblCaptionleft=$(kendo.format("<div id='lblCaptionleft_{0}' class='kdProgressCircleBar-container'><div style='clip:inherit;' class='kdProgressCircleBar-left'></div></div>",this.baseId)),this.component.after(this.lblCaptionleft),this.lblCaptionleft.css({clip:"rect(0,"+(t/2+e)+"px,auto,auto)",width:t+2*e+"px",height:t+2*e+"px"}),this.component.find(".k-progress-status-wrap").addClass("kdProgressCircleBarMask  kendo-background-color");var i=.14,a={width:t*(1-i),height:t*(1-i),top:t*i/2,left:t*i/2,"line-height":t*(1-i)+"px"};this.component.find(".k-progress-status-wrap").css(a),this.setCircleProgressBarStyle(KD.getValue(this.config,"customParameters",{})),this._setProgressBarClickable()}else if(this.component.hasClass("KDCommonProgressBarStyle"))this.component.height(this.config.height),this.component.width(this.config.width),this.lblCaption.css("padding-top","8px"),this.component.css({background:"none"}),this.el.css({"box-shadow":"#A1A0A4 2px 2px 10px 3px","border-radius":"5px"});else{if(this.component.width(this.el.width()-5),this.config.height>30&&this.el.parent().height()>=this.el.height()&&this.component.css("margin-top","30px"),this.config.metaHeight>60&&this.el.parent().height()>=this.el.height()){var n=.25*this.config.metaHeight;this.component.css({"margin-top":n})}this.lblCaption.css({"padding-top":"8px","text-overflow":"ellipsis","word-break":"keep-all",overflow:"hidden","white-space":"nowrap"}),this._updateComponentVlign()}this._setIsshowCaption()},setCircleProgressBarStyle:function(e){if(this.component&&!KD.isEmpty(e)&&this.config.isProgressBarCircleExtend){var t=KD.getValue(this.config,"customParameters",{});if(t=$.extend(t,e),!KD.isEmpty(t)){this.component.addClass("kdProgressCircleBar-extend");var i=KD.getValue(t,"borderColor",[]);KD.isArray(i)&&this.el.css({background:"linear-gradient("+i.join(",")+")"}),this.component.find(".k-progress-status-wrap").css({"background-color":t.backgroundColor}),0==this.component.find(".k-progress-status-log").length?this.component.find(".k-progress-status-wrap").append($(kendo.format('<span class="k-progress-status-log">%</span><span class="k-progress-status-title">{0}</span>',t.title))):this.component.find(".k-progress-status-wrap .k-progress-status-title").text(t.title),this.component.find(".k-progress-status-wrap .k-progress-status").css({"font-size":t.valueFontsize});var a=this.component.find(".k-progress-status-wrap .k-progress-status").css("font-size");a=parseFloat(a),this.component.find(".k-progress-status-wrap .k-progress-status-log").css({top:-(a-26)})}}},getStyle:function(){var e="";for(opt in this.Style)"function"!=typeof this.Style[opt]&&(e+=opt+":"+this.Style[opt]+";");return e},setIsIndeterminate:function(e){this.IsIndeterminate=e,this.IsIndeterminate&&this.component.data(this.getKendoCType()).value(!1)},setValueVisible:function(e){this.ValueVisible=e},_setProgressBarClickable:function(){var e=this;e.ClickAble&&(e.component.css({cursor:"pointer"}),e.component.unbind("click").bind("click",function(t){var i=e.getFormProxy(),a="ProgressBarClick",n=e.getKey()||"";i&&i.fireEvent.call(i,"NaviOperAction",a,n,0,"",null,null)}))},timer:null,start:function(e){var t=this;3>e&&(e=3),this.IsIndeterminate&&(this.setIsIndeterminate(!1),this.setValueVisible(!0));var i=t.getFormProxy(),a=t.ignoreUpdateLastTime?"ignoreUpdateLastTime":"";null==this.timer&&(this.timer=KD.setInterval(function(){var e=t.Value;100>=e&&i.fireEventNoData.call(i,"QueryProgressValue",t.key,t.Value,null,a),e>=100&&(clearInterval(t.timer),t.timer=null)},1e3*e,"KDProgressBarProxy.start()")),KD.delayInvoke(function(){i&&i.fireEventNoData.call(i,"QueryProgressValue",t.key,-1,null,a)})},release:function(){this.timeStop(),KDChartContainerProxy.superclass.release.call(this)},timeStop:function(){null!=this.timer&&(clearInterval(this.timer),this.timer=null)},setText:function(e){},setToolTip:function(e){this.tooltip=e,this.component&&e&&e.trim&&""!=e.trim()&&this.component.attr("title",e).kendoTooltip({autoHide:!0})},doLayout:function(){KDProgressbarProxy.superclass.doLayout.call(this),this._setIsshowCaption(),this._updateComponentVlign()},_updateComponentVlign:function(){if(this.component&&!this.component.hasClass("KDProgressBarCircleStyle")&&!this.component.hasClass("KDCommonProgressBarStyle")){var e=this.lblCaption&&this.lblCaption.height()||0;if(e>0){var t=parseFloat(this.lblCaption.css("padding-top"));t=KD.isNaN(t)?0:t,e+=t}if(this.lastLblHeight==e)return;this.lastLblHeight=e;var i=this.el&&this.el.height()||0,a=this.component&&this.component.height()||0,n=(i-(a+e))/2;n=n>=0?n:0,this.component.css({"margin-top":n})}},_setIsshowCaption:function(){this.lblCaption&&(this.el&&this.component&&this.el.height()<=this.component.height()?this.lblCaption.hide():this.lblCaption.show())},setCaption:function(e){this._setIsshowCaption(),this.lblCaption&&this.lblCaption.text(e).attr("title",e),this._updateComponentVlign()},setValueColor:function(e){this.ValueColor=e,this.component.hasClass("KDProgressBarCircleStyle")?this.el.css({background:e}):this.component.hasClass("KDCommonProgressBarStyle")&&this.el.find(".k-state-selected").css({background:e,"border-radius":"4px"})},setValue:function(e){if(e=e>=100?100:e,e=0>=e?0:e,this.Value=e,this.IsIndeterminate&&!this.component.hasClass("KDCommonProgressBarStyle"))return void this.component.data(this.getKendoCType()).value(!1);if(this.component.data(this.getKendoCType()).value(e),this.component.hasClass("KDProgressBarCircleStyle")){this.component.hasClass("kdProgressCircleBar-extend")?this.component.find(".k-progress-status").text(e):this.component.find(".k-progress-status").text(e+"%");var t=3.6*e;180>=t?($(this.lblCaptionleft).find(".kdProgressCircleBar-left").css("transform","rotate(0deg)"),$(this.lblCaptionright).find(".kdProgressCircleBar-right").css("transform","rotate("+t+"deg)")):($(this.lblCaptionright).find(".kdProgressCircleBar-right").css("transform","rotate(180deg)"),$(this.lblCaptionleft).find(".kdProgressCircleBar-left").css("transform","rotate("+(t-180)+"deg)"))}else this.component.hasClass("KDCommonProgressBarStyle")&&(this.el.find(".k-progress-status").css({display:"none"}),this.el.find(".k-state-selected").css({background:this.ValueColor}))},setValueTilte:function(e){this.ValueTilte=e,lblCaptionTitle=$(kendo.format("<span id='lblCaptionTitle_{0}' class='kdProgressCircleBarTitle'>"+this.ValueTilte+"</span>",this.baseId)),this.component.find(".k-progress-status-wrap").append(lblCaptionTitle)},setCurrentValue:function(e){this.setValue(e)},setForeColor:function(e){this.el.css("color",e)},setLineWrap:function(e){this.el.css("textwrap",e?"wrap":"none")},setFont:function(e){this.el.css("fontfamily",e)},setIsFolding:function(e){this.IsFolding=e,this.IsFolding&&this.el.css({background:"white","box-shadow":"0px 0px 10px rgb(200,200,200)","z-index":8003}),this.config.stylekey&&"KDProgressBarCircleStyle"==this.config.stylekey&&this.el.css({background:"green"})},setProgressBarElCss:function(e){if(!KD.isEmpty(e)){var t=e.elclass,i=e.elinlinestyle;if(!KD.isEmpty(t)&&!KD.isEmpty(i)){var a=i.split(";"),n={};for(var o in a)if(!KD.IsNullOrWhiteSpace(a[o])){var r=a[o].split(":");n[r[0]]=r[1]}if(!KD.isEmpty(n)){var s=this.el.find("."+t+":visible");s.length>0&&s.css(n)}}}}}),KDControlFactoryProxy.registerType("kdprogressbar",KDProgressbarProxy),KDProgressbarGroupProxy=KD.extend(KDControlProxy,{loadConfig:function(e){KDProgressbarGroupProxy.superclass.loadConfig.call(this,e),this.containerEl=$("<div class='kd-progressbargroup-container'></div>"),this.el.append(this.containerEl)},setData:function(e){var t=this;if(this.containerEl&&this.containerEl.empty&&this.containerEl.empty(),!KD.isEmpty(e)&&!KD.isEmpty(e.items)){var i="<div class='kd-progressbargroup-detail {4}' data-key='{0}'><div class='kd-typeTitle' title = '{1}'>{1}</div><div class='kd-progress-container'><div class='kd-progress' style='background-color:{2};width:{3}'></div></div><div class='kd-progress-value' >{3}</div></div>",a=kendo.format("<div class='kd-progressbargroup'>");e.items.map(function(t,n){t.bColor=t.bColor||"#2850FF",t.bColor=t.disable?"#C4C4C4":t.bColor;var o="";t.key==e.selectKey&&(o="kd-progressbargroup-typeSelected"),a+=KD.format(i,t.key,t.title,t.bColor,t.gressValue,o)}),a+="</div>",this.containerEl.append($(a)),this.containerEl.find(".kd-progressbargroup-detail").click(function(e){t._handleSelectChange(this)})}},_handleSelectChange:function(e){var t=this;this.el.find(".kd-progressbargroup-detail").removeClass("kd-progressbargroup-typeSelected");var i=$(e);i.addClass("kd-progressbargroup-typeSelected");var a=i.data("key"),n=t.getFormProxy();n.lockControl.call(n,t),n.fireCustomEventsNoData.call(n,"kingdee.bos.Progressbargroup.itemChange",t.key,a)},doLayout:function(){KDProgressbarGroupProxy.superclass.doLayout.call(this)}}),KDControlFactoryProxy.registerType("kdprogressbargroup",KDProgressbarGroupProxy),define("KDProgressBarProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDProgressBarProxy}}(this)),KDTitleProxy=KD.extend(KDControlProxy,{Title:"",loadConfig:function(e){KDTitleProxy.superclass.loadConfig.call(this,e),this.Title=KD.getValue(e,"text",ResManager.LoadKDString("[标题]","099002000000108"))},initComponent:function(){KDTitleProxy.superclass.initComponent.call(this);var e=$('<div class="ui-section"><div class="sheader"><span class="title">'+this.Title+"</span></div>");this.component=e,this.el.css("overflow","hidden"),this.el.append(e),this.setVisible(KD.getValue(this.config,"visible",!0))},setText:function(e){this.Title=e,$(".title",this.component).text(this.Title)}}),KDControlFactoryProxy.registerType("kdtitle",KDTitleProxy),KDFormTitleProxy=KD.extend(KDControlProxy,{title:"",createControl:function(e){return this.el=KDFormTitleProxy.superclass.createControl.call(this,e),this.el},loadConfig:function(e){KDFormTitleProxy.superclass.loadConfig.call(this,e),this.title=KD.getValue(e,"title",ResManager.LoadKDString("[标题]","099002000000108"))},initComponent:function(){KDFormTitleProxy.superclass.initComponent.call(this);var e=$('<div class="kd-form-title"><span class="kd-form-title-txt">'+this.title+"</span></div>");this.component=e,this.el.css("overflow","hidden"),this.el.append(e),this.setVisible(KD.getValue(this.config,"visible",!0))},setText:function(e){this.title=e,$(".kd-form-title-txt",this.component).text(this.title)}}),KDControlFactoryProxy.registerType("formtitlebar",KDFormTitleProxy),define("KDTitleProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDTitleProxy}}(this)),KDSmartRobotProxy=KD.extend(KDImageProxy,{tooltipEl:null,isForceHide:!1,operatorDictionary:["smartrobot-waiting","smartrobot-listening"],statusDictionary:["status-action","status-success","status-warning"],startTime:new Date,requestTimer:null,messageTimer:null,lastRefreshTime:null,createControl:function(e){return this.el=KDSmartRobotProxy.superclass.createControl.call(this,e),this.el},loadConfig:function(e){KDSmartRobotProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDSmartRobotProxy.superclass.initComponent.call(this);var e=this,t=KD.isManagementSite(),i=KD.getConnectConfig()&&KD.getConnectConfig().robotCycle;return e.el.removeAttr("style"),t||i&&parseInt(i)<=0?(this.isForceHide=!0,void e.setVisible.call(e,!1)):(e.el.addClass("kd-smart-robot smartrobot-waiting"),e.el.append('<div class="kd-robot-blueImg"></div>'),e.el.append('<div class="kd-robot-logs"><ul class="kd-logscontainer"></ul></div>'),e.el.append('<div class="kd-robot-hidebtn"></div>'),e.el.hover(function(){e.el.addClass("stop"),$(".kd-robot-hidebtn").show()},function(){e.el.removeClass("stop"),$(".kd-robot-hidebtn").hide()}),$(".kd-robot-hidebtn").click(function(t){e._setVisible.call(e,!1)}),e.autoHideWithoutActions(),void e.autoHideLogContainer())},_setVisible:function(e){this.el&&(0==e?this.el.hide("slow").addClass("kd-element-hidden"):this.el.show("slow").removeClass("kd-element-hidden"))},setVisible:function(e){this.isForceHide&&(e=!1),KDSmartRobotProxy.superclass.setVisible.call(this,e),this._setVisible(e)},startReqTimer:function(e){var t=this,i=t.getKey(),a=t.getFormProxy();null==t.requestTimer&&(t.requestTimer=KD.setInterval(function(){a.fireCustomEvents.call(a,i,"smartRobotCircleReq","")},1e3*e,"KDSmartRobotProxy.startReqTimer()"))},startMsgTimer:function(e){var t=this,i=t.getKey(),a=t.getFormProxy();null==t.messageTimer&&(t.messageTimer=KD.setInterval(function(){a.fireCustomEvents.call(a,i,"smartRobotCircleMsg","")},1e3*e,"KDSmartRobotProxy.messageTimer()"))},stopReqTimer:function(){null!=this.requestTimer&&clearInterval(this.requestTimer)},stopMsgTimer:function(){null!=this.messageTimer&&clearInterval(this.messageTimer)},autoHideWithoutActions:function(){var e=this;KD.setInterval(function(){var t=new Date,i=t.getTime()-e.startTime.getTime();i>3e5&&e._setVisible.call(e,!1)},6e4,"KDSmartRobotProxy.autoHideWithoutActions()")},autoHideLogContainer:function(){var e=this;KD.setInterval(function(){if(null!=e.lastRefreshTime){var t=new Date,i=t.getTime()-e.lastRefreshTime.getTime();i>=3e4&&($(".kd-robot-logs").removeClass("show"),e.el.removeClass().addClass("kd-smart-robot smartrobot-waiting"))}},2e4,"KDSmartRobotProxy.autoHideLogContainer()")},insertLogOperations:function(e){var t=this,i=$(".kd-robot-logs");i.hasClass("show")||i.addClass("show");var a=$('<i class="status-badge '+t.statusDictionary[e.statusKey]+'"></i>'),n=$('<span class="log-msg">'+e.tooltip+"</span>"),o=$("<li></li>");
o.append(a).append(n);var r=$(".kd-robot-logs .kd-logscontainer");r.append(o),r.scrollTop(r.get(0).scrollHeight)},release:function(){clearInterval(this.timer),KDSmartRobotProxy.superclass.release.call(this)},setCurrentEmoji:function(e){var t=this;e&&null!=e&&(t.el.removeClass().addClass("kd-smart-robot "+t.operatorDictionary[e.operatorKey]),0!=parseInt(e.operatorKey)&&(t.el.is(":hidden")&&t._setVisible.call(t,!0),t.startTime=new Date),KD.IsNullOrWhiteSpace(e.tooltip)||(t.insertLogOperations(e),t.lastRefreshTime=new Date))},setCurrentEmojies:function(e){var t=this;e&&null!=e&&KD.isArray(e)&&$.each(e,function(e,i){t.setCurrentEmoji(i)})}}),KDControlFactoryProxy.registerType("kdsmartrobot",KDSmartRobotProxy),define("KDSmartRobotProxy",["KDImageProxy","KD"],function(e){return function(){var t;return t||e.KDSmartRobotProxy}}(this)),KDWebSocketProxy=KD.extend(KDControlProxy,{createControl:function(e){var t=KDWebSocketProxy.superclass.createControl.call(this,e);return t},loadConfig:function(e){KDWebSocketProxy.superclass.loadConfig.call(this,e)},initComponent:function(){this.rendered=!0,this.open()},onOpen:function(e){var t=this,i=t.getFormProxy();i&&e.data&&i.fireCustomEvents.call(i,t.getKey(),"websocket_open","")},onMessage:function(e){var t=this,i=t.getFormProxy();i&&e.data&&i.fireCustomEvents.call(i,t.getKey(),"websocket_message",e.data)},onError:function(e){this.el.text(e.data).attr("title",e.data)},onClose:function(e){this.close()},open:function(e){var t=this,e=e||t.config;try{var i=window.WebSocket||window.MozWebSocket,a=this.socket=new i(KD.getEncodeUrl(e.url||""),KD.getValue(e,"protocal","ws"));a.onopen=function(e){t.onOpen.call(t,e)},a.onClose=function(e){t.onOpen.call(t,e)},a.onmessage=function(e){t.onMessage.call(t,e)},a.onerror=function(e){t.onError.call(t,e)}}catch(n){delete this.socket,this.el.text(n.message).attr("title",n.message)}},send:function(e){var t=this.socket;t&&t.send&&t.send(e)},close:function(){var e=this.socket;e&&e.close&&(e.close(),delete this.socket)},release:function(){this.close(),KDWebSocketProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdwebsocket",KDWebSocketProxy),define("KDWebSocketProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDWebSocketProxy}}(this)),KDRollAdBarProxy=KD.extend(KDControlProxy,{createControl:function(e){return this.el=KDRollAdBarProxy.superclass.createControl.call(this,e),this.el},loadConfig:function(e){KDRollAdBarProxy.superclass.loadConfig.call(this,e),this.el.css("width",KD.getValue(e,"width",0)),this.el.addClass("kd-roll-adbar")},initComponent:function(){KDRollAdBarProxy.superclass.initComponent.call(this)},setForecolor:function(e){this.el.css({color:e})},setText:function(e){this.el.append("<span>"+e+"</span>"),this.scrollRun()},scrollRun:function(){var e=this,t=e.el.children("span"),i=KD.getValue(e.config,"metaWidth",100);t.animate({left:-i},1e4,"linear",function(){$(this).css({left:i}),e.scrollRun()})},release:function(){KDRollAdBarProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdrolladbar",KDRollAdBarProxy),define("KDRollAdBarProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDRollAdBarProxy}}(this)),function(e){KDColPagerProxy=KD.extend(KDControlProxy,{gridKey:"",pageCols:5,unfixedPageCols:0,currentIndex:0,totalPages:0,createControl:function(e){KDColPagerProxy.superclass.createControl.call(this,e),this.el.css({minWidth:150,"white-space":"nowrap"})},createControlDom:function(){var t='<div><div class="kd_ui_colpager_div"><div class="kd_ui_colpager_icon kd_ui_colpager_icon_prv"/><span class="kd_ui_colpager_txt_prv">Previous</span></div><div class="kd_ui_colpager_div kd_ui_colpager_leftdiv"><span class="kd_ui_colpager_txt_next">Next</span><div class="kd_ui_colpager_icon kd_ui_colpager_icon_next"/></div></div>',i=e(t);return e(".kd_ui_colpager_txt_prv",i).text(ResManager.LoadKDString("上一页","0991733030032097")),e(".kd_ui_colpager_txt_next",i).text(ResManager.LoadKDString("下一页","0991733000003895")),i},loadConfig:function(e){KDColPagerProxy.superclass.loadConfig.call(this,e),this.gridKey=KD.getValue(e,"gridkey",""),this.pageCols=KD.getValue(e,"pagecols",0);var t=this.getGridControlProxy();t&&t.setColPager.call(t,this),this.updateDisibleStatus()},setPageCols:function(e){this.pageCols!=e&&(this.pageCols=e||this.pageCols,this.updateDisibleStatus())},setUnfixedPageCols:function(e){var t=parseInt(e);t=KD.isNaN(t)?0:t,this.unfixedPageCols=t},getPageCols:function(){return this.pageCols||0},setTotalPages:function(e){this.totalPages=parseInt(e)||1},getTotalPages:function(){return this.totalPages||1},setGridKey:function(e){this.gridKey=(e||"").toUpperCase()},getGridKey:function(){return this.gridKey},getCurIndex:function(){return this.currentIndex||1},setCurIndex:function(e){this.currentIndex=e||1},getGridControlProxy:function(){var e=this,t=e.getFormProxy(),i=(e.controlFactoryProxy,(e.getGridKey()||"").toUpperCase());return t&&i?t.getControlProxy.call(t,i):!1},doColPagerKeyCmd:function(e){var t=this;"pageup"==e?t.upClick({}):"pagedown"==e&&t.downClick({})},upClick:function(e){var t=this,i=t.getCurIndex();i--,t.gotoPageIndex(i)},downClick:function(e){var t=this,i=t.getCurIndex();i++,t.gotoPageIndex(i)},gotoPageIndex:function(e){var t=this,i=t.getCurIndex(),a=t.getTotalPages();i=e,1>=i&&(t.setCurIndex(1),i=t.getCurIndex()),i>a&&(t.setCurIndex(a),i=t.getCurIndex()),t.setCurIndex(i),t.updateDisibleStatus();var n=t.getGridControlProxy();if(n){var o=n.getColPager.call(n);KD.isEmpty(o)&&n.setColPager.call(n,this),n.colPagerTurning.call(n,i)}},updateDisibleStatus:function(){var e=this,t=e.el.find(".kd_ui_colpager_div:first"),i=e.el.find(".kd_ui_colpager_div:last"),a=e.getTotalPages(),n=e.getCurIndex();t.unbind("click"),i.unbind("click"),1>=n?(t.addClass("kd_ui_colpager_div_disabled"),i.removeClass("kd_ui_colpager_div_disabled"),i.bind("click",function(t){e.downClick.call(e,t)})):n>=a?(i.addClass("kd_ui_colpager_div_disabled"),t.removeClass("kd_ui_colpager_div_disabled"),t.bind("click",function(t){e.upClick.call(e,t)})):(i.removeClass("kd_ui_colpager_div_disabled"),i.bind("click",function(t){e.downClick.call(e,t)}),t.removeClass("kd_ui_colpager_div_disabled"),t.bind("click",function(t){e.upClick.call(e,t)}))},updateTitles:function(e,t){var i=this,a=i.el.find(".kd_ui_colpager_div:first"),n=i.el.find(".kd_ui_colpager_div:last"),o=KD.format(ResManager.LoadKDString("当前第{0}页,总共{1}页;\r\n每页{2}列, 固定{3}列;\r\n总共{4}列;","0991733000003894"),i.getCurIndex(),i.getTotalPages(),i.unfixedPageCols+e,e,t);a[getPropName()]("title",o),n[getPropName()]("title",o)}})}(jQuery),KDControlFactoryProxy.registerType("kdcolpager",KDColPagerProxy),define("KDColPagerProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDColPagerProxy}}(this)),KDPropertyValueBarProxy=KD.extend(KDEditorProxy,{isMulti:!1,createControlDom:function(){return $('<div><div class="ui_kdpropertyvaluebar_item"></div></div>')},loadConfig:function(e){KDPropertyValueBarProxy.superclass.loadConfig.call(this,e),this.isMulti=KD.getValue(e,"ismulti",!1);var t=[];e.store=t,this.setStore(e.store)},setStore:function(e){var t='<div class="ui_kdpropertyvaluebar_item">';if(e)for(var i=0;i<e.length;i++){var a=e[i];a[1]&&""!=a[1].trim()&&(t+="<span kd-data="+a[0]+">"+a[1]+"</span>")}t+="</div>",this.el.find(".ui_kdpropertyvaluebar_item").replaceWith(t);var n=this;this.checkeditem=[],this.el.find(".ui_kdpropertyvaluebar_item > span").click(function(){var e=$(this);if(e.hasClass("disabled"))return!1;var t=!1,i=-1,a=e.attr("kd-data");n.clearCheckedStatus(a);for(var o in n.checkeditem)n.checkeditem[o]==a?(t=!0,i=o):n.isMulti||n.checkeditem.splice(o,1);t?(e.removeClass("checked"),i>-1&&n.checkeditem.splice(i,1)):(e.addClass("checked"),n.checkeditem.push(a)),n.onchange()})},loadStore:function(e){this.setStore(e)},clearCheckedStatus:function(e){this.isMulti||this.el.find(".ui_kdpropertyvaluebar_item > span").each(function(){e?e!=$(this).attr("kd-data")&&$(this).removeClass("checked"):$(this).removeClass("checked")})},asyncValueToUIText:function(e){this.checkeditem=[],e.NewValue?(this.checkeditem=e.NewValue.split(","),this.refreshStatus()):this.el.find(".ui_kdpropertyvaluebar_item > span").remove()},refreshStatus:function(){if(this.checkeditem){this.el.find(".ui_kdpropertyvaluebar_item > span").removeClass("checked");var e=this;this.el.find(".ui_kdpropertyvaluebar_item > span").each(function(){var t=$(this).attr("kd-data");return e.isMulti?void(e.checkeditem.indexOf(t)>=0&&$(this).addClass("checked")):(t==e.checkeditem&&$(this).addClass("checked"),!1)})}},onchange:function(e,t){var i="";this.checkeditem&&(i=this.checkeditem.join(",")),this.oldValue=i,this.commitValueToForm(i)},setDisabled:function(e){this.disabled=e,e?(this.el.find(".ui_kdpropertyvaluebar_item > span").removeClass("checked"),this.el.find(".ui_kdpropertyvaluebar_item > span").addClass("disabled")):this.refreshStatus()},setisMulti:function(e){this.isMulti=value}}),KDControlFactoryProxy.registerType("kdpropertyvaluebar",KDPropertyValueBarProxy),define("KDPropertyValueBarProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDPropertyValueBarProxy}}(this)),function(e){KDColumnDescriptorFactory={columnDescTypes:{},columnDescListTypes:{},create:function(e,t){var i="default",a=e.editor;a&&a.xtype?i=a.xtype:"kdpic2field"==e.xtype&&(i=e.xtype),"kdcombo"==i&&KD.getValue(a,"isMulti",!1)&&(i="kdmulticombo");var n=e.dataIndex;if(!n)return null;n==t.serverIndexFieldName&&(i="idcolumn");var o=null,r=KDColumnDescriptorFactory.columnDescTypes[i];r||(i=e.xtype,r=KDColumnDescriptorFactory.columnDescListTypes[i]),o=r?new r:new KDColumnDescriptorFactory.columnDescListTypes.arraytextfield,o.setGridStore.call(o,t),o.loadConfig.call(o,e);var s=o.xColDspCtrlType;return KDColumnDescriptorFactory.createDisplayDescriptor(i,s,o),o},createDisplayDescriptor:function(e,t,i){if(!t)return void delete i.displayDescriptor;var a=KDColumnDescriptorFactory.columnDescTypes[e+"_"+t];if(a||(a=KDColumnDescriptorFactory.columnDescTypes[t]),a){var n=new a,o=i.gridStore,r=i.config;n.setTargetDescriptor.call(n,i),n.setGridStore.call(n,o),n.loadConfig.call(n,r),i.displayDescriptor=n}}},KDColumnDescriptorFactory.registerType=function(e,t){KDColumnDescriptorFactory.columnDescTypes[e]=t,t.xtype=e},KDColumnDescriptorFactory.registerListType=function(e,t){KDColumnDescriptorFactory.columnDescListTypes[e]=t,t.xtype=e}}(jQuery),function(e){KDColumnDescriptor=function(){this.initExtCellTemplate()},KDColumnDescriptor.prototype={allowSorting:!0,allowColumnFiltering:!0,redBlueCls:KD.numInfo?KD.numInfo.redCellCls:"",states:{},onlineTipsData:{},clearStates:function(){this.states={}},setGridStore:function(e){this.gridStore=e,this.formProxy=this.gridStore.owner.getFormProxy()},needRefreshOwner:function(e){return void 0!==e&&(this.refreshOwnerFlag=e),this.refreshOwnerFlag},isBulkData:function(){var e=this,t=e.getGridStore(),i=t?t.getRowCount.call(t):0;return i>KDStore.C_BulkDataLimit},release:function(){delete this.gridStore,delete this.store,delete this.owner,delete this.formProxy,delete this.displayDescriptor,delete this.targetDescriptor},getFormProxy:function(){return this.formProxy||this.gridStore.owner.getFormProxy()},getPageId:function(){var e=this.getFormProxy();return e.getPageId.call(e)},getGridStore:function(){return this.gridStore},getDisplayDescriptor:function(){return this.displayDescriptor},loadConfig:function(t){this.visible=KD.getValue(t,"visible",!0),this.config=t,this.header=KD.getValue(this.config,"header",""),this.setIsRedBlue(KD.getValue(this.config,"isRedBlue",!1)),e.extend(this,t),this.editor&&(this.xColDspCtrlType=this.xColDspCtrlType||this.editor.xColDspCtrlType,this.xtype=this.xtype||this.editor.xtype,this.fireUpdate=!!this.editor.fireUpdate,this.config.fireUpdate=this.fireUpdate);var i=KD.getValue(t,"flexcolindex",-1);null!=i&&-1!=i&&(this.subColDescriptor=new KDFlexColumnDataController,this.subColDescriptor.loadConfig.call(this.subColDescriptor,t));var a=KD.getValue(this.config,"IsMk","");KD.isEmpty(a)||this.setIsMk(a)},getFieldName:function(){return this.dataIndex},getKendoFieldName:function(){return this.converFieldName(this.getFieldName())},converFieldName:function(e){var t=this.getGridStore();return t?t.converFieldName.call(t,e):e},isIndexKeyCol:function(e){return e||(e=this.owner&&this.owner.store&&this.owner.store.getIndexKey.call(this.owner.store)),e==this.getKendoFieldName()},colPageFixed:function(){var e=this;return e.config?!!e.config.isColPageFixed:!1},getTargetDescriptor:function(){return this.targetDescriptor},setTargetDescriptor:function(e){this.targetDescriptor=e},getCaption:function(){return this.header},setCaption:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.Caption;this.header=e||"",this.headerText=e||"",this.config.header=e||"",this.propertyChange(a,t,i)},setHeader:function(e){this.setCaption(e)},setHeaderAlignment:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.HeaderAlignment;this.config[a]=e||"",this[a]=e||"",this.propertyChange(a,t,i)},setColumnLineTipsData:function(e){this.onlineTipsData=e},getColumnLineTipsData:function(e){return this.onlineTipsData},getWidth:function(){return KD.layout.getZoomInPx(this.width)},setWidth:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.Width;this.width=e,this.config.width=e,this.propertyChange(a,t,i)},setFireUpdate:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.FireUpdate;this.fireUpdate=e,this.config.fireUpdate=e,this.propertyChange(a,t,i)},setMustInput:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.MustInput;this.mustInput=e,this.config.mustInput=e,this.propertyChange(a,t,i)},setSplitPattern:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.SplitPattern;this.splitPattern=e,this.config.splitPattern=e,this.propertyChange(a,t,i)},setHeaderToolTip:function(e){KD.isEmpty(e)||(this.headerTooltips=e)},setXColDspCtrlType:function(e){var t=this.xColDspCtrlType=this.config.xColDspCtrlType=e;KDColumnDescriptorFactory.createDisplayDescriptor(t,this);var i="col",a=-1,n=KD.KDGridActionKeys.xColDspCtrlType;this.propertyChange(n,i,a)},setIsRedBlue:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.IsRedBlue;this.IsRedBlue=e,this.config.isRedBlue=e,this.config.editor&&(this.config.editor.isRedBlue=e),this.propertyChange(a,t,i)},getIsRedBlue:function(e){return this.IsRedBlue},setAllowAutoList:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.AllowAutoList;this.AllowAutoList=e,this.config.AllowAutoList=e,this.propertyChange(a,t,i)},setShowEditButton:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.ShowEditButton;this.editor&&(this.editor.showEditButton=e),this.propertyChange(a,t,i)},locked:function(e,t){var i=!1;return void 0!==e?(i=e,t?this.lockedState=i:this.orginLockedState=i):i=KD.isEmpty(this.lockedState)?KD.isEmpty(this.orginLockedState)?KD.getValue(this.config,"locked",!1):this.orginLockedState:this.lockedState,i},tooltipEnabled:function(e){return void 0!==e&&(this.config.tooltipenabled=e),KD.getValue(this.config,"tooltipenabled",!1)},tooltipIndicatorEnabled:function(e){return void 0!==e&&(this.config.tooltipindicatorenabled=e),KD.getValue(this.config,"tooltipindicatorenabled",!0)},setLookup:function(e){var t="col",i=-1,a=KD.KDGridActionKeys.ShowEditButton;this.editor&&(this.editor.lookup=e),this.propertyChange(a,t,i)},setExAndUrl:function(t){var i="col",a=-1,n=KD.KDGridActionKeys.ExAndUrl,o={exExtandUrl:t};this.config&&this.config.editor?e.extend(this.config.editor,o):this.config&&e.extend(this.config,o),e.extend(this,o),this.propertyChange(n,i,a)},setExDownloadUrl:function(t){var i="col",a=-1,n=KD.KDGridActionKeys.ExDownloadUrl,o={exDownloadUrl:t,isfileserver:!!t};this.config&&this.config.editor?e.extend(this.config.editor,o):this.config&&e.extend(this.config,o),e.extend(this,o),this.propertyChange(n,i,a)},setExCanDownland:function(t){var i="col",a=-1,n=KD.KDGridActionKeys.IsCanDownland,o={iscandownland:t};this.config&&this.config.editor?e.extend(this.config.editor,o):this.config&&e.extend(this.config,o),this.propertyChange(n,i,a)},setReadonly:function(t,i){if(this.editor&&!t){var a={readOnly:i};this.config&&this.config.editor?e.extend(this.config.editor,a):this.config&&e.extend(this.config,a)}this.updateDimensionValue(KD.KDGridActionKeys.ReadOnly,t,i)},setHasError:function(t,i){if(this.editor&&!t){var a={hasError:i};this.config&&this.config.editor?e.extend(this.config.editor,a):this.config&&e.extend(this.config,a)}this.updateDimensionValue(KD.KDGridActionKeys.HasError,t,i),this.UpdateGridCellState(t)},setUpUrl:function(t){var i="col",a=-1,n=KD.KDGridActionKeys.UpUrl,o={upurl:t,isfileserver:!!t};this.config&&this.config.editor?e.extend(this.config.editor,o):this.config&&e.extend(this.config,o),e.extend(this,o),this.propertyChange(n,i,a)},getDimensionValue:function(e,t){if(void 0===t&&this.editor)return this.editor[e];var i=this.states[e]||{},a=i[t];return a},updateDimensionValue:function(t,i,a){if(!KD.isEmpty(a)){var n=this.editor&&!i?"col":"cell",o=-1;if(this.editor&&!i)this.editor[t]=a,this.config.editor[t]=a;else if(e.isPlainObject(a)){this.states[t]=this.states[t]||{};var r=this.states[t],s=this.getGridStore();for(var o in a)r[o]=a[o]}else{this.states[t]=this.states[t]||{};var r=this.states[t],s=this.getGridStore();o=s.getRowId.call(s,i),r[o]=a}this.propertyChange(t,n,o)}},updateDimensionRowIdChange:function(e){var t=e.delIds,i=e.chgIds;for(var a in this.states){var n=this.states[a];if(t)for(var o in t)-1==t[o]&&delete n[o];if(i){var r={};for(var o in n){var s=i[o];void 0!==s&&n[o]?r[s]=n[o]:void 0===s&&(r[o]=n[o])}this.states[a]=r}}},isVisible:function(e){var t=this;return 1==e?void 0!==t.draghidden?!t.draghidden:t.visible:void 0===t.visible?!0:t.visible},setVisible:function(e,t){void 0!==e&&(this.visible=this.config.visible=e),void 0!==t&&(e&&(t=void 0),this.draghidden=this.config.draghidden=t)},setUndisabled:function(e,t){this.setDisable(e,!t)},setDisabled:function(e,t){this.setDisable(e,t)},setDisable:function(e,t){this.setGridCellDisabled(e,t),this.editor&&!e&&(this.editor.disabled=t,this.config.editor.disabled=t),this.updateDimensionValue(KD.KDGridActionKeys.Disabled,e,t)},isColDisabled:function(){var e=this;return void 0===e.config.editor||KD.getValue(e.config.editor,"disabled",!1)},isDisabled:function(e){var t=this,i=!1,a=t.getOwner();if(t.isIndexKeyCol())return!0;if(t.isForBatchFilter)return!1;var n=i=t.isColDisabled();if(n)return!0;if(!a||a.isTreeList&&a.isReadOnlyRow.call(a,e))return!0;var o=t.getGridStore();if(!i){var r=o.getRowId.call(o,e);i=t.getDimensionValue(KD.KDGridActionKeys.Disabled,r)}if(!i){var s=o.getIndexKey.call(o),l=o.getColumnDescriptor.call(o,s);i=l.getDimensionValue.call(l,KD.KDGridActionKeys.Disabled,r)}return KD.isArray(i)&&void 0!=i.disabled?i.disabled:i},setGridCellStyle:function(e,t,i){KD.isEmpty(i)||this.UpdateGridCellState(t)},UpdateGridCellState:function(e){var t,i=this.getFieldName(),a=this.getGridStore(),n=[];if(e){if(t=a.getRowId.call(a,e),0>t)return;var o=a.getIndexKey.call(a);if(KD.equalsIgnoreCase(o,i))for(var r=a.visibleCols||[],s=0;s<r.length;s++)n.push([t,r[s].getFieldName()]);else n.push([t,i])}else{var l=a._serverRowIdMap;if(l)for(var d in l)t=a.getRowId.call(a,l[d]),n.push([t,i])}var c=this.getOwner();if(c)for(var h=0;h<n.length;h++){var u=n[h];KD.isArray(u)&&c.addBatchUpdateItems.call(c,u[0],u[1])}},setGridCellDisabled:function(e,t){var i=this.isDisabled(e);i!=t&&this.UpdateGridCellState(e)},setColor:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.Forecolor,e,t),this.setGridCellStyle(KD.KDGridActionKeys.Forecolor,e,t)},setForecolor:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.Forecolor,e,t),this.setGridCellStyle(KD.KDGridActionKeys.Forecolor,e,t)},setBackcolor:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.Backcolor,e,t),this.setGridCellStyle(KD.KDGridActionKeys.Backcolor,e,t)},setDecimalPrecision:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.DecimalPrecision,e,t)},setDecimalIntLength:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.DecimalIntLength,e,t)},setMaxValue:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.MaxValue,e,t)},setMinValue:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.MinValue,e,t)},setFontbold:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.Fontbold,e,t)},setTooltip:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.Tooltip,e,t)},setCellHidden:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.CellHidden,e,t)},setMask:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.Mask,e,t)},setNumFmtInfo:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.NumFmtInfo,e,t)},propertyChange:function(e,t,i){},getEditorStyleKey:function(){var e="";return e=this.editor?this.editor.stylekey||"":""},getDisable:function(){var e=!!this.editor;return this.editor&&(e=!KD.getValue(this.editor,"disabled",!1)),!e},getIndex:function(){return this.colIndex},setVisibleIndex:function(e){var t=parseInt(e);KD.isNaN(t)||(this.visibleIndex=t)},setUserClientColHidden:function(e){void 0!=e&&(this.userClientColHidden=e)},isUserClientColHidden:function(){return this.userClientColHidden},getIsForBatchFilter:function(){return this.isForBatchFilter},setOwner:function(e){this.owner=e;var t=this.displayDescriptor;t&&KD.isFunction(t.setOwner)&&t.setOwner.call(t,e)},getOwner:function(){return this.owner},getOwnerKey:function(){return this.owner.getKey.call(this.owner)},setStore:function(e){this.config.store=e},isCellEditorMode:function(){return this.editor},getAttributesClass:function(){var e="",t=this.isTreeExpander();if(t){var i=this.isColDisabled();i&&(e=" kdgrid-td-state-disable")}return e},getTextAlign:function(){var e=this.config,t=KD.getValue(e,"defaultColAlignType",-1);if(this.editor&&"numberfield"==this.xtype){if(0==this.editor.disabled)return"right";t=2}var i=KD.getValue(e,"colAlignType",t);return 0==i&&(i=t),this.isTreeExpander&&this.isTreeExpander()&&(i=1),1==i?"left":2==i?"right":3==i?"center":void 0!=this.editor&&"numberfield"==this.xtype?"right":"left"},checkIsListMultiSel:function(e){},isButtonType:function(e){var t=!1;return t="kdbutton"==(e||this.xColDspCtrlType)},isLinkType:function(e){var t=!1;return t="kdlinkbutton"==(e||this.xColDspCtrlType)},isPictureType:function(e){return"kdpicture"==(e||this.xColDspCtrlType)},isUrlPictureType:function(e){return"kdurlpicfield"==(e||this.xColDspCtrlType)||"kdpic2field"==(e||this.xColDspCtrlType)},isCellCustDisplayOnly:function(){return!0},getCellCustFormatString:function(e){var t=this.getSvrValue(e);return t},getCellCustUnformatString:function(e,t){var i=this.getSvrValue(e);return i},createCellCustEditor:function(e,t){return!1},showCellCustEditor:function(e){return!1},clearCellCustEditor:function(e,t){return!1},getDisplayValue:function(e,t,i){return KD.isEmpty(e)?e="":KD.convertToHtmlString(this.allowHtmlCell?e:KD.htmlUtil.encode(e),!1)||""},getSvrValue:function(e){var t=this.getGridStore(),i=t.getRowDataByServerRowId.call(t,e),a=this.getKendoFieldName();return this._getValueByRowData(i,a)},setSvrValue:function(e,t){var i=this.getGridStore(),a=this.getFieldName(),n=this.getSvrValue(e),o=this.subColDescriptor;o&&(t=o.formatEditValue(t).subValue),n==t||n&&n.toString()==t.toString()||i.updateSvrValue.call(i,e,a,t)},getOriginalValue:function(e){return this.getSvrValue(e)},getValue:function(e){var t=this.getGridStore(),i=t.rows[e];return this.getValueByRowData(i)},getValueByRowData:function(e,t){var i=(this.getKendoFieldName()||"").toUpperCase();if((t||i||"").toUpperCase()!=i){var a=this.getGridStore(),n=a.getColumnDescriptor.call(a,t),o=n.getValueByRowData.call(n,e);return void 0===o?"":o}return null!=this.subColDescriptor?this.subColDescriptor.fetchData.call(this.subColDescriptor,e,i):this._getValueByRowData(e,i)},_getValueByRowData:function(e,t){var i=t+"",a=void 0;return e&&(a=e[i]),a},setValue:function(e,t){var i=this.getGridStore(),a=i.rows[e],n=this.getKendoFieldName();null!=this.subColDescriptor&&this.subColDescriptor.commitData.call(this.subColDescriptor,a,n,t),i.updateValue.call(i,e,n,t)},isKeyInputCell:function(e){var t=this.getGridStore();return this.isKeyInput&&e==t.getLastRowId.call(t)},initCellEditor:function(t,i,a){var n=KD.parseObject(KD.stringify(this.editor)),o=this.getOwner(),r=o.getControlFactoryProxy(),s=(this.getGridStore(),i.model.rowId);e.extend(n,{isDynamicCreated:!0,isKeyInputCell:this.isKeyInputCell(s),zoomIn:o.isEditorZoomIn,id:this.owner.baseId+"_"+this.getFieldName()});var l=KD.parseObject(KD.stringify(n));"textfield"==l.xtype&&(l.height=t.height()),l.isFromTreeGrid=a,this.beforeCreateEditorProxy(l,i);var d=this.proxy=r.createControl.call(r,l);d.setControlFactoryProxy(r),d.postKey=this.getFieldName(),d.columnDescriptor=this,d.rowDataModel=i,d.setRow.call(d,s),this.initCellEditorComponent(t,i)},getCellEditorTemplate:function(e,t){return"<input>"},initCellEditorComponent:function(t,i){var a=this;if(a.proxy){var n=a.isDisabled(i.model),o=i.model||{},r=a.getIsShowDataMkModel(o.rowId,o);if(n||r){var s=a.getTemplate(i.field,i.model);e(s).appendTo(t);var l=!t.hasClass("k-detail-cell");return t.addClass("k-detail-cell"),KD.delayInvoke(function(e){e&&(e.closest("table").find("td.k-state-focused").removeClass("k-state-focused"),e.addClass("k-state-focused"))},10,!1,t),void(l&&(t.deductionTimeoutCode=setTimeout(function(e){e&&(e.removeClass("k-detail-cell"),clearTimeout(e.deductionTimeoutCode),delete e.deductionTimeoutCode)},500,t)))}a.beforeInitCellEditorComponent(t,i);var d=a.getCellEditorTemplate(t,i);d=a.attachCellData(d,i.model.rowId,i.field);var c=e(d).appendTo(t);a.proxy.initCellComponent.call(a.proxy,c),a.afterInitCellEditorComponent(t,i),t.addClass("kd-edit-cell")}},beforeCreateEditorProxy:function(e,t){},beforeInitCellEditorComponent:function(e,t){},afterInitCellEditorComponent:function(e,t){var i=this,a=t.model.rowId,n=i.getSvrValue(a);this.proxy&&this.proxy.component&&this.proxy.setValue(n)},onchange:function(t,i,a){var n=this.wrapSetValue(t,i,a),o=this.formatEditValue(n),r=this.getOwner(),s=!!r&&r.store,l=r.getFormProxy.call(r),d=a.model.rowId;if(this.isKeyInputCell(d)&&l.fireCustomEvents.call(l,r.getKey.call(r),"PostDataOnly",""),s.setFormatValue(a.field,a.model,o),e.isPlainObject(o))for(var c in o)"name"==c||"text"==c?a.model.set?a.model.set(a.field,o[c]):a.model[a.field]=o[c]:a.model[a.field+"__"+c]=o[c];else a.model.set(a.field,o);var h=this.getDimensionValue(KD.KDGridActionKeys.HasError,d);h&&this.setHasError(a.model,!1)},formatEditValue:function(e){return e},wrapSetValue:function(e,t,i){return t},getFilter:function(){return this.filter||[]},resetFilter:function(){this.filter=[];var e=this.getOwner();e&&e.setFilterInner&&e.setFilterInner.call(e,this.dataIndex,this.filter)},setFilter:function(e){this.filter||(this.filter=[]);var t=this.getOwner(),i=t&&t.getStore(),a=i?i.converToKendoFieldName(this.dataIndex):this.dataIndex;KD.isObject(e)?this.filter.push({field:a,operator:e.operator||"eq",value:e.value}):this.filter.push({field:a,operator:"eq",value:e}),t&&t.setFilterInner&&t.setFilterInner.call(t,this.dataIndex,this.filter)},resetSort:function(){this.sortType=this.orginSortType||0},setSort:function(e,t){var i=void 0;if(void 0!==e&&0!=e)switch(e){case 1:i="asc";break;case 2:i="desc"}t&&(this.orginSortType=i),this.sortType=i},getSort:function(){return this.sortType},getSchemaModel:function(){var e="string";if(this.gridEditable)switch(this.xtype||this.editor&&this.editor.xtype){case"numberfield":e="number";break;case"kdcheckbox":e="boolean"}return this.isIndexKeyCol()&&(e="number"),{type:e,editable:!0,nullable:!0}},getColOptions:function(t){var i,a=this,n=a.header.split("&");i=this.owner&&"kdtreegrid"==this.owner.xtype?a.headerText=a.header:a.headerText=n.length>0?n[n.length-1]||" ":" ",a.checkIsListMultiSel(i);var o=(a.header?a.header.substr(0,a.header.length-i.length-1):"",a.getKendoFieldName()),r="contains",s=a.getSchemaModel();s&&"number"==s.type&&(r="eq");var l={field:o,width:a.getWidth()+"px",title:a.headerTooltips||i,locked:KD.isFunction(a.locked)?a.locked():a.locked,hidden:a.getWidth()>0?!a.isVisible():!0,mustinput:a.config.mustInput,headerTemplate:a.createHeaderTemplate(),visibleIndex:a.visibleIndex?a.visibleIndex:a.colIndex,template:function(e){return a.getTemplate.call(a,o,e)},refreshEditStateCell:function(e,t){a.refreshEditStateCell.call(a,e,t)},filterable:a.getFilterableOptions(r,o),headerAttributes:a.getHeaderAttributes(),attributes:{"class":a.getAttributesClass(),style:"text-align:"+a.getTextAlign()+";"},sortable:a.getSortableOptions()},d=this.owner,c=a.getColEditorOption();if(e.extend(l,c),d&&"kdtreegrid"==d.xtype&&(l.filterable.extra=!1),d&&d.colHeaderHeight&&d.colHeaderHeight>40){var h=this.owner.colHeaderHeight-1.8*KD.getCurrentFontsize(),u=h/18;u=u>parseInt(u)+.15?parseInt(u)+1:parseInt(u),KD.isEmpty(l.headerAttributes)?l.headerAttributes={"class":"kd-grid-customheader-height",style:"height:"+h+"px;-webkit-line-clamp:"+u}:l.headerAttributes={"class":l.headerAttributes["class"]+" kd-grid-customheader-height",style:l.headerAttributes.style+"; height:"+h+"px;-webkit-line-clamp:"+u}}var p=d.getIsEnableColumnHeaderAutoWrap();return p&&(KD.isEmpty(l.headerAttributes)?l.headerAttributes={"class":"kd-colheader-autowrap"}:l.headerAttributes["class"]=l.headerAttributes["class"]?l.headerAttributes["class"]+" kd-colheader-autowrap":"kd-colheader-autowrap"),l},refreshEditStateCell:function(e,t){var i=t.model.rowId,a=this.getSvrValue(i);this.proxy&&this.proxy.component&&this.proxy.setValue(a)},_getFilterSortSchemaModel:function(){var e="string";switch(this.xtype||this.editor&&this.editor.xtype){case"numberfield":e="number";break;case"idcolumn":e="number";break;case"datefield":e="date";break;case"datetimefield":e="date"}return this.isIndexKeyCol()&&(e="number"),e},_getFilterSortField:function(){var e,t=(this.dataIndex,this._getFilterSortSchemaModel());"number"==t&&(e=1);var i={};if(!KD.isEmpty(e)){var a=this.getKendoFieldName();i.field=a,i.dataIndex=e,i.fieldNameExtend="__value"}return i},getFilterableOptions:function(e,t){var i={},a=this,n=a.owner,o=n&&n.getAllowColumnFiltering.call(n);return i=0==a.allowColumnFiltering||0==o?!1:{schemaModel:a._getFilterSortSchemaModel(),filterSortField:a._getFilterSortField(),filterVisibleData:!0,fromGridHeadFilter:!0,multi:!0,cell:{showOperators:!1,operator:e,template:function(e){e.element.kendoAutoComplete({open:function(e){e.preventDefault()},filtering:function(e){if(e&&e.sender){var t=e.sender.element.closest("th").find(".k-filtercell");if(t.length>0){var i=t.data("kendoFilterCell");i&&i.viewModel&&(i.options&&"number"==i.options.type?i.viewModel.operator="eq":i.viewModel.operator="contains")}}}})},dataTextField:t}}},getSortableOptions:function(){var e={},t=this;return e=0==t.allowSorting?!1:{initialDirection:t.getSort(),compare:function(e,i){var a=t.sortCompare.call(t,e,i);return a}}},getColEditorOption:function(){return{}},getTemplate:function(e,t){var i=this,a=i.getGridStore(),n=a&&a.cellTemplateKey?KDColumnDescriptor.getExtTemplateMethod(a.cellTemplateKey,i):"";return n?n.call(i,e,t):i.getTemplateCore(e,t)},createHeaderTemplate:function(){var e,t=this,i=t.config.mustInput,a="",n=t.header.split("&");this.owner&&"kdtreegrid"==this.owner.xtype?(e=t.headerText=t.header,e=e.replace(/#/g,"\\#")):e=t.headerText=n.length>0?n[n.length-1]||" ":" ";var o=t.getOwner();if(o&&1==o.isEnableSingleHeader&&(e=t.header.replace(/\&/g,"_")),this.isLinkType()){var r,s={entrykey:t.owner?t.owner.key:"",key:t.dataIndex,row:-1,pageid:t.owner?t.owner.getPageId():""};s.itemid=s.pageid+"_"+s.entrykey+"_"+s.key+"_linkheader",s.attrname="currentclickdom",r="KD.entryLinkBtnClick('"+KD.stringify(s).replace(/\"/g,"&quot;")+"');",e='<span class="kd-grid-header-link" id="'+s.itemid+'" onclick="'+r+'">'+e+"</span>"}return t.isTreeExpander()?a='<span class="kd-treelistrow-lvlheader">'+e+"</span>":(a="<span class='kd-colheader-label'>"+e+"</span>",1==i&&(a="<span class='kd-colheader-label'><span>"+e+"</span><span class='kd-grid-mustinput'>*</span></span>")),
0==this.allowSorting&&(a=kendo.format('<span class="k-link"  tabindex="-1" style="">{0}</span>',a)),a},getHeaderAttributes:function(){var t=void 0,i=this.config,a=KD.getValue(i,KD.KDGridActionKeys.HeaderAlignment,void 0);return void 0!==a&&(t=t||{},e.extend(t,{style:"text-align:"+a+";"})),t},getTemplateCore:function(t,i){var a=this,n="",o=a.getGridStore(),r=a.getOwner(),s=i.rowId;if(!r||r.isTreeList&&r.isWaitingRow.call(r,i))return"";var l=o.getIndexKey.call(o),d=o.getColumnDescriptor.call(o,l),c=a.getDimensionValue(KD.KDGridActionKeys.Forecolor,s)||d.getDimensionValue.call(d,KD.KDGridActionKeys.Forecolor,s),h=a.getDimensionValue(KD.KDGridActionKeys.Backcolor,s)||d.getDimensionValue.call(d,KD.KDGridActionKeys.Backcolor,s),u=a.getDimensionValue(KD.KDGridActionKeys.ReadOnly,s)||d.getDimensionValue.call(d,KD.KDGridActionKeys.ReadOnly,s),p=a.getDimensionValue(KD.KDGridActionKeys.HasError,s)||d.getDimensionValue.call(d,KD.KDGridActionKeys.HasError,s),g=a.tooltipIndicatorEnabled(),f=(a.getDimensionValue(KD.KDGridActionKeys.CellHidden,s),a.getDimensionValue(KD.KDGridActionKeys.Tooltip,s)||{}),m=void 0===f.E?a.tooltipEnabled():f.E,v=f.T||"",y=a.getDimensionValue(KD.KDGridActionKeys.CellHidden,s)||{},b=a.isDisabled(i),D=a.editor&&a.editor.EmptyTip?a.editor.EmptyTip:"";if(b&&!h){a.gridEditable&&(h="#");var k=o.defaultDisabeCellBackground;k&&(h=k)}var C={disable:b,backcolor:KD.formatHtmlColor(h),forecolor:KD.formatHtmlColor(c),field:t,tooltipEnabled:m,tooltip:v,tooltipIndicatorEnabled:g,hiddenEnabled:y.H,hiddenMask:y.M,rowData:i,rowId:s,emptyTip:D,readonly:u,hasError:p};if(a.displayDescriptor){var x=e.extend({value:a.displayDescriptor.getDisplayValue.call(a.displayDescriptor,i[t],s,i)},C),w=a.displayDescriptor.getDisplayTemplate.call(a.displayDescriptor,x);return n=a.attachCellData(w,s,t)}var w=a.createTemplate(C);return n=a.attachCellData(w,s,t)},attachCellData:function(t,i,a){var n=t,o=e(n);if(o&&o.length){var r=e(".kd-grid-cellspan",o);r&&!r.length&&(r=o),r.attr("data-field",a).attr("data-rowId",i),n=o[0].outerHTML}else n||(n="");return n},createTemplate:function(e){var t=this,e=e||{},i=t.getGridStore(),a=e.backcolor,n=e.forecolor,o=e.disable,r=e.emptyTip,s="",l=i.rowHeight;if(i.rowHeight<34){var d=t.getFormProxy();(d.dformConfig||d.config).isUseSmallScreenModel||(l=34)}var c="min-height:"+l+"px;",h=e.field,u=t.getOwner(),p=e.rowData,g=p&&p.rowId,f=i.getRowDataByServerRowId.call(i,g);if(void 0===f)return"";t.isTreeExpander()&&(c+="display: inline;opacity:1; background-color:transparent; color:#000000;",a="");var m=u.isViewGrid(),v=o&&!m?"k-gridCellstate-disabled":"",y=o&&!m?" tabindex='9999999' ":" ",b="",D=t.getIsRedBlue()||i.isRedBlue?t.redBlueCls||"":"",k=void 0!=f?t.getValueByRowData(f,h):"";if(e.hiddenEnabled&&e.hiddenMask&&(k=e.hiddenMask),~(this.allowHtmlCell?k:KD.htmlUtil.encode(k)).search(/\r\n|\n/g)){var C=2,x=12,w=KD.convertToHtmlString(KD.htmlUtil.encode(k||"")).split("<br/>").length;w>1&&(C=w);var K=i.rowHeight/C;x>K&&(K=x),c+="line-height:"+K+"px;",K*C>i.rowHeight&&(c+="height:"+i.rowHeight+"px;")}var S=e.tooltipIndicatorEnabled;KD.isEmpty(S)&&(S=!0);var I="",P=e.tooltipEnabled?e.tooltip||k:"",F=P?' title="'+KD.htmlUtil.encode(P).replace(/\"/g,"&quot;")+'"':"",T=P&&S?'<span class="kd-grid-tipflag"></span>':"",_=t.getDisplayValue(k,g,f);_=this.getDisplayValueByMkModel(_,g,f);var A=this.getTemplateByMkModel(g,f);KD.isEmpty(_)&&!KD.isEmpty(r)?s="color:#999;":r="";var L=KD.getFontFamilyByCurrencySymbol(_);KD.isEmpty(L)||(I=kendo.format("font-family:{0};",L));var M=t.getTextAlign(),E=("right"==M?"padding-right:":"padding-left:")+"5px;",B="",R="",N=e.hasError?"border: 1px solid #FD0F15;":"";if(a){var H=H=n?"color:"+n+";":"color:#000000;";(void 0==o||0==o)&&(H="",a=""),B=I+"background-color:"+KD.formatHtmlColor(a)+"; text-align:"+M+";"+E+c+H+N,b=kendo.format('<div {0} class="{1} kd-grid-celldiv {2} {9}" style = "{3}">{4}<span class="kd-grid-cellspan" style="{5}" {6}>{7}{8}{10}</span></div>',y,D,v,B,T,I+c+s,F,_,r,R,A)}else{E=("right"==M?"padding-right:":"padding-left:")+"7px;";var H=n?"color:"+n+";":"";(void 0==o||0==o)&&(H=""),B=E+I+c+H+"text-align:"+M+";"+s+N,b=kendo.format('<span {0} class="{1} kd-grid-cellspan {2}" style="{3}" {4}>{5}{6}{7}{8}</span>',y,D,v,B,F,_,r,T,A)}return b},getDisplayTemplate:function(e){var t=this,i=t.getOwner(),a=t.getGridStore(),n="min-height:"+a.rowHeight+"px;",o=e&&e.disable,r=i.isViewGrid(),s=o&&!r?"k-gridCellstate-disabled":"",l=e?e.value||"":"";e.hiddenEnabled&&e.hiddenMask&&(fieldValue=e.hiddenMask);var d=e.tooltipEnabled?e.tooltip||l:"",c=d?' title="'+d+'"':"",h=d?'<span class="kd-grid-tipflag"></span>':"",u=t.getIsRedBlue()||a.isRedBlue?t.redBlueCls||"":"",p='<span class="'+u+" kd-grid-cellspan "+s+'" style="'+n+';"'+c+">"+l+h+"</span>";return p},isCheckBox:function(){return!1},setHeaderCheckBoxValue:function(e){},setCheckBoxValue:function(e){},filterValueCompare:function(e,t,i){var a=this.getOriginalValue(e),n=null==a?"":KD.stringify(a),o=i?!!n:n.indexOf(t)>=0;return o},sortCompare:function(e,t){var i=this.getKendoFieldName(),a=e[i]||"",n=t[i]||"",o=KD.checkChinese(a)&&KD.checkChinese(n);if(o){var r=a.substring(0,1),s=n.substring(0,1);o=KD.checkChinese(r)&&KD.checkChinese(s)}var l=0;return o?l=a.localeCompare(n,"zh-Hans-CN"):(a&&a.toLowerCase&&(a=a.toLowerCase()),n&&n.toLowerCase&&(n=n.toLowerCase()),l=a>n?1:a==n?0:-1),l},setSimplization:function(e,t){this.allowColumnFiltering=!1,this.allowSorting=e?!0:!1},isTreeExpander:function(){var e=this,t=e.getOwner();return e.config.expandable&&t&&t.isTreeList&&e.isColDisabled()},setExpandable:function(e){this.config.expandable=e},resetTreeExpandable:function(e){var t=this;return e?(t.setExpandable(!1),!1):t.isVisible()&&t.isColDisabled()?(t.setExpandable(!0),!0):!1},getLayoutSetting:function(e,t){try{var i=-1,a="",n=-1,o=this.dataIndex;o=!KD.isEmpty(o)&&KD.isString(o)?o.replace(/\./g,"_"):o,t=t?t:o;for(var r=0;r<e.length;r++)if(a=e[r].fieldname,KD.equalsIgnoreCase(t,a)){i=e[r].width,n=r;break}var s={};return s.oi=this.colIndex,this.isVisible()||!this.isVisible(!0)?(s.i=n,s.w=i):(s.i=9999,s.w=KD.isEmpty(this.width)?5:this.width),this.isUserClientColHidden()?s.ch=1:s.ch=0,s.k=this.dataIndex,s}catch(l){return KD.writeError("KDColumnDescriptor getLayoutSetting Exception:"+l),null}},loadLayoutSetting:function(e){try{if(KD.isEmpty(e))return;var t=!1,i=this.visible;this.width=KD.isEmpty(e.w)?0:e.w;var a=KD.isEmpty(e.i)?0:e.i;return 9999==a&&i&&(a=this.colIndex),9999!=a&&1!=i?(t=!0,this.vsible=!0):9999==a&&0!=i&&(t=!0,this.visible=!1),t}catch(n){return KD.writeError("KDColumnDescriptor loadLayoutSetting Exception:"+n),null}}},e.extend(KDColumnDescriptor,{createHeaderTemplate:function(e,t,i){var a=ClientAppProxy.Current,n=a&&a.getAliveForm.call(a,e),o=n&&n.getControlProxy.call(n,t),r=o&&o.getStore.call(o),s=r.getColumnDescriptor.call(r,i);return s&&s.createHeaderTemplate.call(s)||""}})}(jQuery),function(){$.extend(KDColumnDescriptor.prototype,{isDataMasking:void 0,dataMaskingControlLists:["textfield","kdtextarea","kdlangtextarea","kdlangtextfield","numberfield","datefield","datetimefield"],setIsMk:function(e){var t=this;t.isDataMasking=e;var i=t.getOwner();if(!i)var a=this.getGridStore(),i=a&&a.getOwner&&a.getOwner();i&&i.setEnableColumnMkModel&&i.setEnableColumnMkModel.call(i,t.dataIndex,e)},setMkVal:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.MkVal,e,t)},setMkModel:function(e,t){this.updateDimensionValue(KD.KDGridActionKeys.MkModel,e,t)},getMkModel:function(e,t){var i=void 0;return this.isDataMasking&&(i=this.getDimensionValue(KD.KDGridActionKeys.MkModel,e),KD.isEmpty(i)&&(i=KD.getValue(this.config,"MkModel",void 0),KD.isEmpty(i)&&this.config&&(i=KD.getValue(this.config.editor,"MkModel",KD.CONST.DataMaskModel.Normal)))),i},getDisplayValueByMkModel:function(e,t,i){var a=this.getIsShowDataMkModel(t,i);if(a){var n=this.getOwner(),o=n&&n.isViewGrid();o||(e=this.getDimensionValue(KD.KDGridActionKeys.MkVal,t),KD.isEmpty(e)&&(e=""))}return e},getTemplateByMkModel:function(e,t){var i=this,a=this.getMkModel(e,t),n="";if(a==KD.CONST.DataMaskModel.Normal&&i.dataMaskingControlLists.indexOf(i.xtype)>=0){var o=KD.getImageUrlByNameAndVersion("kd_icon_extend.png");n=kendo.format('<div class="kd-btn-desensitize-container" tabIndex="-1" title="{1}"><input type="button" class="kd-icon-btn-desensitize" style="background-image:url({0});"></div>',o,KD.getDataMaskTextTips())}return n},getIsShowDataMkModel:function(e,t){var i=void 0;if(this.isDataMasking){var a=this.getMkModel(e,t);i=a==KD.CONST.DataMaskModel.Normal||a==KD.CONST.DataMaskModel.Locked?!0:!1}return i},onMkButtonClick:function(e,t){var i=this,a={};a.entrykey=e,a.fieldkey=i.dataIndex,a.row=t;var n=i.getFormProxy();n&&n.fireEvent.call(n,KD.CONST.CustomEventName.ShowCVPFieldData,i.dataIndex,t)}})}(),function(e){e.extend(KDColumnDescriptor,{extMap:{QualityStandard:"getQSTemplate"},getExtTemplateMethod:function(e,t){var i=KDColumnDescriptor.extMap[e];return t?t[i]:void 0}}),e.extend(KDColumnDescriptor.prototype,{initExtCellTemplate:function(){KDColumnDescriptor.QSCellTemplate||e.extend(KDColumnDescriptor,{QSCellTemplate:{top:'<div class="kd-grid-celldiv" style="min-height:34px"><span class="kd-grid-qs-top"></span></div>',singleDownArrow:'<div class="kd-grid-celldiv" style="min-height:34px"><div><span class="kd-grid-qs-ArrowSpace"></span></div><div><span class="kd-grid-qs-ArrowPin"></span></div><span class="kd-grid-qs-downArrow"></span></div>',downArrow:'<div class="kd-grid-celldiv" style="min-height:34px"><div><span class="kd-grid-qs-ArrowPin"></div></span><span class="kd-grid-qs-singleDownArrow"></span></div>',bottom:'<div class="kd-grid-celldiv" style="min-height:34px"><span class="kd-grid-qs-bottom"></span></div>',middle:'<div class="kd-grid-celldiv" style="min-height:34px"><span class="kd-grid-qs-middle"></span></div>',upArrow:'<div class="kd-grid-celldiv" style="min-height:34px"><div><span class="kd-grid-qs-ArrowSpace"></span></div><span class="kd-grid-qs-upArrow"></span><div><span class="kd-grid-qs-ArrowPin"></span></div></div>',singleUpArrow:'<div class="kd-grid-celldiv"><span class="kd-grid-qs-singleUpArrow"></span><div><span class="kd-grid-qs-ArrowPin"></span></div></div>'}})},getQSTemplate:function(e,t){var i=this,a=(i.getGridStore(),t.rowId),n=i.getSvrValue(a),o="";if("↓"!=n&&"↑"!=n)return i.getTemplateCore(e,t);var r=(i.getOwner(),a-1),s=a+1,l=i.getSvrValue(r),d=i.getSvrValue(s),o=i.getQSCellTempKey(n,l,d);return o?KDColumnDescriptor.QSCellTemplate[o]:i.getTemplateCore(e,t)},getQSCellTempKey:function(e,t,i){var a="top",n="downArrow",o="singleDownArrow",r="middle",s="upArrow",l="singleUpArrow",d="bottom",c="↓",h="↑",u="";return t==c?e==c?u=i==c?r:n:e==h&&(u=i==h?s:l):t==h?e==h?u=i==h?r:d:e==c&&(u=i==c?a:o):e==c?u=i==c?a:o:e==h&&(u=i==h?s:l),u}})}(jQuery),function(e){KDColumnIdDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){return null},getColOptions:function(e){var t,i=this,a=i.header.split("&");t=this.owner&&"kdtreegrid"==this.owner.xtype?i.headerText=i.header:i.headerText=a.length>0?a[a.length-1]||" ":" ";var n="eq";i.checkIsListMultiSel(t);var o=(i.header?i.header.substr(0,i.header.length-t.length-1):"",i.getKendoFieldName()),r={field:o,width:i.getWidth()+"px",title:i.headerTooltips||t,filterable:i.getFilterableOptions(n,o),template:function(e){return i.getTemplate.call(i,o,e)},hidden:!i.isVisible(),attributes:{"class":i.getAttributesClass(),style:"text-align:"+i.getTextAlign()+";"},sortable:{initialDirection:i.getSort(),compare:function(e,t){var a=i.sortCompare.call(i,e,t);return a}}};return r},getSchemaModel:function(){var e="string";return{type:e,editable:!1,nullable:!1}},sortCompare:function(e,t){var i=this.getKendoFieldName(),a=e[i]||"",n=t[i]||"",o=parseFloat(a.toString().replace(",","")),r=parseFloat(n.toString().replace(",","")),s=o>r?1:o==r?0:-1;return s}}),KDColumnDescriptorFactory.registerType("idcolumn",KDColumnIdDescriptor)}(jQuery),function(e){KDColumnDataControllerBase=function(){},KDColumnDataControllerBase.prototype={setStore:function(e){this.store=e},getFieldName:function(){return this.dataIndex},getKendoFieldName:function(){return this.converFieldName(this.getFieldName())},loadConfig:function(e){this.Key=KD.getValue(e,"dataIndex",""),this.IsDataFetch=KD.getValue(e,"isDataFetch",!1),this.Index=KD.getValue(e,"colIndex",0),this.Parentkey=KD.getValue(e,"parentkey",""),this.isForBatchFilter=KD.getValue(e,"isForBatchFilter",!1)},fetchData:function(e,t){return null},fetchDataByValue:function(e,t){return null},commitData:function(e,t,i){},getBaseValue:function(e){return e[this.Index]}}}(jQuery),define("KDColumnDescriptor",["KD"],function(e){return function(){var t;return t||e.KDColumnDescriptor}}(this)),function(e){KDColumnNumberStringDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){return null},formatEditValue:function(t){var i={};return i=e.isArray(t)&&t.length>0?{text:t[0],value:t}:t},getOriginalValue:function(t){var i=this.getValue(t);return i?"string"==typeof i?i:e.isArray(i)?i[1]:KD.isNumber(i)?i:KDColumnNumberStringDescriptor.superclass.getOriginalValue.call(this,t.rowId):""},getValue:function(e){if(void 0==e)return KD["debugger"]("getValue rowData is undefined.",void 0==e),"";var t=this.getOwner(),i=t.getStore.call(t),a=e.rowId,n=i.getRowDataByServerRowId.call(i,a),o=this.getKendoFieldName(),r=o+"__value",s=n?n[r]||n[o]:"";return s},getDisplayValue:function(t,i,a){var n="",o=this.getValue(a);return"string"==typeof o?n=o:"number"==typeof o?n=o+"":e.isArray(o)&&(n=o[0]),KD.convertToHtmlString(this.allowHtmlCell?n:KD.htmlUtil.encode(n),!1)||""},filterValueCompare:function(e,t,i){var a=this.getOriginalValue(e),n=null==a?"":KD.stringify(a),o=i?!!n:n.indexOf(t)>=0;return o},sortCompare:function(e,t){var i=this.getOwner(),a=i.getStore.call(i),n=e.rowId,o=t.rowId,r=a.getRowDataByServerRowId.call(a,n),s=a.getRowDataByServerRowId.call(a,o),l=this.getOriginalValue(r)||0,d=this.getOriginalValue(s)||0,c=parseFloat(l.toString().replace(/,/g,"").replace(/\s*/g,"")),h=parseFloat(d.toString().replace(/,/g,"").replace(/\s*/g,"")),u=c>h?1:c==h?0:-1;return u}}),KDColumnDescriptorFactory.registerListType("numberfield",KDColumnNumberStringDescriptor)}(jQuery),define("KDColumnNumberStringDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDColumnNumberStringDescriptor}}(this)),function(e){KDColumnDateStringDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){return null},formatEditValue:function(e){var t={};return t=KD.isArray(e)&&e.length>0?{text:e[0],value:e}:e},getOriginalValue:function(e){var t="",i=this.getValue(e);return t=KD.isArray(i)?i.length>0?i[1]:i[0]:i,t||""},getValue:function(e){if(void 0==e)return KD["debugger"]("getValue rowData is undefined.",void 0==e),"";var t=this.getOwner(),i=t.getStore.call(t),a=e.rowId,n=i.getRowDataByServerRowId.call(i,a),o=this.getKendoFieldName(),r=o+"__value",s=n?n[r]||n[o]:"";return s},getDisplayValue:function(e,t,i){var a="",n=this.getValue(i);return a=KD.isArray(n)?n[0]:n,a||""},sortCompare:function(e,t){var i=this.getOriginalValue(e)||void 0,a=this.getOriginalValue(t)||void 0,n=kendo.parseDate(i),o=kendo.parseDate(a),r=1;return r=null==n||"Invalid Date"==n?-1:null==o||"Invalid Date"==o?1:n>o?1:n==o?0:-1}}),KDColumnDescriptorFactory.registerListType("datefield",KDColumnDateStringDescriptor),KDColumnDescriptorFactory.registerListType("datetimefield",KDColumnDateStringDescriptor)}(jQuery),define("KDColumnDateStringDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDColumnDateStringDescriptor}}(this)),KDFlexColumnDescriptor=KD.extend(KDColumnDescriptor,{loadConfig:function(e){e.editor.showEditButton=!0,KDFlexColumnDescriptor.superclass.loadConfig.call(this,e)},getColEditorOption:function(){var e=this.proxy=new KDFlexFieldProxy,t=e.getGirdEditorOptions(this.editor);return t},formatEditValue:function(e){var t=this.proxy;t&&t.setDisplayNameSpecies(KD.getValue(this.config.editor,"namespecies",2)),t&&t.setSeparator(KD.getValue(this.config.editor,"separator",";"));var i={text:t?t.getDisplayValue.call(t,e):"",value:e};return"string"==typeof i.value&&""==i.text&&i.value.trim&&""!=i.value.trim()&&(i.value=""),i},getSvrValue:function(e){var t=this.getGridStore(),i=t.getRowDataByServerRowId.call(t,e),a=this.getFieldName(),n=a+"__value";return i?i[n]:void 0},setSvrValue:function(e,t){var i=this.getGridStore(),a=this.getFieldName(),n=this.subColDescriptor,o=a+"__value";n&&(t=n.formatEditValue(t).subValue);var r=this.formatEditValue(t),s=r?r.text:"";i.updateSvrValue.call(i,e,o,t),i.updateSvrValue.call(i,e,a,s)},getDisplayValue:function(e,t,i){if("string"==typeof e)return e;var a=e||"";return a},createTemplate:function(e){var t=KDFlexColumnDescriptor.superclass.createTemplate.call(this,e),i=this.getOwner();if(i&&"voucherkdgrid"==i.xtype){var a=$(t),n=a.text();t=kendo.format('<div class="kd-grid-column-flextextfield-container" title="{2}" style="height:{0}px;">{1}</div>',i.rowHeight,a[0].outerHTML,n)}return t}}),KDColumnDescriptorFactory.registerType("kdflextextfield",KDFlexColumnDescriptor),KDFlexColumnDataController=KD.extend(KDColumnDataControllerBase,{getBaseValue:function(e){var t=this.Key;return e[t+"__value"]},fetchData:function(e,t){this.cellValue=this.getBaseValue(e),this.subKey=t;var i=e[t];return i&&KD.isString(i)?i:this.innerFetchData()},getFieldName:function(){var e=(this.Parentkey||"").length+4,t=this.Key.substr(e);return t},formatEditValue:function(e){var t=this.fetchDataByValue(e,this.Key);return{value:e,subValue:t}},fetchDataByValue:function(e,t){return this.cellValue=e,this.subKey=t,this.innerFetchData()},commitData:function(e,t,i){this.getBaseValue(e)},innerFetchData:function(){var e="",t=(this.subKey||"").toLowerCase();for(var i in this.cellValue){var a=this.cellValue[i];if(null!=a){var n=a[1];if((n||"").toLowerCase()==t){var o=a[3];switch(o){case"175":a[0]&&a[0].lenght>0&&(e="true"==a[0].toLowerCase()?!0:!1);break;case"231":case"56":case"106":e=a[0];break;default:e=a[0]}break}}}return e}}),define("KDFlexColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDFlexColumnDescriptor}}(this)),KDBaseDataColumnDescriptor=KD.extend(KDColumnDescriptor,{isF7:!0,isLocatedFirstRow:!1,getColEditorOption:function(){var e=new KDBOSF7Proxy,t=e.getGirdEditorOptions(this.editor);return t},getSvrValue:function(e){var t=this.getGridStore(),i=t.getRowDataByServerRowId.call(t,e),a=this.getFieldName(),n=a+"__value";return i?i[n]:void 0},setSvrValue:function(e,t){var i=this,a=i.getGridStore(),n=(i.getFieldName(),i.getKendoFieldName()),o=i.subColDescriptor,r=n+"__value";o&&(t=o.formatEditValue(t).subValue);var s=i.formatEditValue(t),l=s.value.number,d=s.value.name,c=i.getSvrValue(e);(void 0===c||c&&(c.number!=l||c.name!=d))&&(a.updateSvrValue.call(a,e,r,s.value),a.updateSvrValue.call(a,e,n,s.text))},formatEditValue:function(e){var t={name:""};if(KD.isString(e))t={name:e,number:e};else if(KD.isArray(e)){if(e.length>0?t.name=e[0]:t={name:"",number:""},e.length>1?t={name:e[0],number:e[1]}:1==e.length&&(t={name:e[0],number:e[0]}),e.length>2){t.precision=e[2],t.existPrecision=!0,t.precisions=[];for(var i=2;i<e.length;i++)t.precisions.push(e[i])}}else KD.isObject(e)&&(null!==e.name&&(t.name=e.name),null!==e.number&&(t.number=e.number),null!==e.precision&&(t.precision=e.precision),null!==e.precisions&&(t.precisions=e.precisions));return{text:t.name,value:t}},beforeCreateEditorProxy:function(e,t){void 0!=this.config.AllowAutoList&&(e.AllowAutoList=this.config.AllowAutoList)},afterInitCellEditorComponent:function(e,t){var i=t.model.get(t.field+"__value"),a=i.number;KD.isEmpty(i.number)&&!KD.isEmpty(i.name)&&(a=i.name),this.proxy&&this.proxy.component&&(this.proxy.setValue(a),this.proxy.setIsLocatedFirstRow(this.isLocatedFirstRow))},getCellEditorTemplate:function(e,t){return"<div>"},getNumber:function(e){var t=this.getSvrValue(e);return t&&t.number||""},getPrecision:function(e,t){var i=this.getSvrValue(e);return void 0!=t&&i&&i.existPrecision&&i.precisions&&i.precisions.length>=t&&void 0!=i.precisions[t-1]?i.precisions[t-1]:i?i.precision:void 0},getDisplayValue:function(e){if(KD.isEmpty(e))return"";var t=KD.isArray(e)?this.formatEditValue(e).value:e,i=KD.isObject(t)?t.name||"":t||"";return i=this.allowHtmlCell?i:KD.htmlUtil.encode(i)},setIsLocatedFirstRow:function(e){this.isLocatedFirstRow=e?!0:!1}}),KDColumnDescriptorFactory.registerType("bosf7field",KDBaseDataColumnDescriptor),KDBaseDataColumnDescriptor_Voucher=KD.extend(KDBaseDataColumnDescriptor,{getFormAppendDom:function(e){e=e||{};var t=null,i={},a=this.proxy;if(a&&a.component){var i=a.component.data(a.getKendoCType());if(i){i.openPopup(),i.dynamicformContainer=i.dynamicformContainer||$('<div class="kd-f7grid-dynamicform-popup" tabindex="-1"><div>');var n=a.popupDefaultHeight;e.OriginalHeight&&e.OriginalHeight<a.popupDefaultHeight&&(n=e.OriginalHeight),i.dynamicformContainer.show().empty().height(n).width(a.popupDefaultWidth),0==i.popup.find(".kd-f7grid-dynamicform-popup").length&&i.dataList.before(i.dynamicformContainer),a.popupWidth=a.popupWidth||i.popup.outerWidth(),i.popup.width(a.popupDefaultWidth).css({"border-style":"solid","border-width":"1px","min-width":"initial"}),i.dynamicformContainer.off("pointerdown").on("pointerdown",function(e){var t=$(this).closest(".k-popup");t.length>0&&(t.removeClass("k-popup"),KD.delayInvoke(function(e){e&&e.addClass&&e.addClass("k-popup")},10,!0,t))}),t=i.dynamicformContainer,i.dataList.hide();var o=i.popup.data("kendoPopup");o.wrapper.height(n),o._position.call(o)}}return i},setSvrValue:function(e,t){var i=this,a=i.getGridStore(),n=(i.getFieldName(),i.getKendoFieldName()),o=i.subColDescriptor,r=n+"__value";o&&(t=o.formatEditValue(t).subValue);var s=i.formatEditValue(t),l=s.value.number,d=i.getSvrValue(e);(void 0===d||d&&(d.number!=l||d.name!=name))&&(a.updateSvrValue.call(a,e,r,s.value),a.updateSvrValue.call(a,e,n,s.text))},createTemplate:function(e){var t=KDBaseDataColumnDescriptor_Voucher.superclass.createTemplate.call(this,e),i=this.getOwner();return i&&"voucherkdgrid"==i.xtype&&(t=kendo.format('<div class="kd-grid-column-mutiline-container" style="height:{0}px;">{1}</div>',i.rowHeight,t)),t}}),KDColumnDescriptorFactory.registerType("voucherbosf7field",KDBaseDataColumnDescriptor_Voucher),define("KDBaseDataColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDBaseDataColumnDescriptor}}(this)),KDTextFieldColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDTextFieldProxy,t=e.getGirdEditorOptions(this.editor);return t}}),KDColumnDescriptorFactory.registerType("textfield",KDTextFieldColumnDescriptor),function(e){KDColumnArraryStringDescriptor=KD.extend(KDColumnDescriptor,{formatEditValue:function(t){var i={};return i=e.isArray(t)&&t.length>0?{text:t[0],value:t}:t},getOriginalValue:function(t){var i=this.getValue(t);return i?"string"==typeof i?i:e.isArray(i)?i[1]:KD.isNumber(i)?i:KDColumnArraryStringDescriptor.superclass.getOriginalValue.call(this,t.rowId):""},getValue:function(e){if(void 0==e)return KD["debugger"]("getValue rowData is undefined.",void 0==e),"";var t=this.getOwner(),i=t.getStore.call(t),a=e.rowId,n=i.getRowDataByServerRowId.call(i,a),o=this.getKendoFieldName(),r=o+"__value",s=n?n[r]||n[o]:"";return s},sortCompare:function(e,t){var i=this.getOwner(),a=i.getStore.call(i),n=e.rowId,o=t.rowId,r=a.getRowDataByServerRowId.call(a,n),s=a.getRowDataByServerRowId.call(a,o),l=this.getOriginalValue(r)||"",d=this.getOriginalValue(s)||"",c=KD.checkChinese(l)&&KD.checkChinese(d);if(c){var h=l.substring(0,1),u=d.substring(0,1);c=KD.checkChinese(h)&&KD.checkChinese(u)}var p=0;return c?p=l.localeCompare(d,"zh-Hans-CN"):(l&&l.toLowerCase&&(l=l.toLowerCase()),d&&d.toLowerCase&&(d=d.toLowerCase()),p=l>d?1:l==d?0:-1),p}}),KDColumnDescriptorFactory.registerListType("arraytextfield",KDColumnArraryStringDescriptor)}(jQuery),define("KDTextFieldColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDTextFieldColumnDescriptor}}(this)),KDTextFieldColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDTextAreaProxy,t=e.getGirdEditorOptions(this.editor);return t},getCellEditorTemplate:function(e,t){return'<div class="kd-textarea-container" style="width:100%;height:'+e.height()+'px;">'}}),KDColumnDescriptorFactory.registerType("kdtextarea",KDTextFieldColumnDescriptor),KDLargeTextColumnDescriptor=KD.extend(KDColumnDescriptor,{createTemplate:function(e){var t=this,i=t.getGridStore();e=e||{};var a=e.backcolor,n=e.forecolor,o=e.disable,r=i.rowHeight;i.rowHeight<34&&(r=34);var s="flex-grow: 1;min-height:"+r+"px;";("kdtextarea"==this.xtype||"textfield"==this.xtype)&&(s+="height:"+r+"px;");var l=e.field,d=t.getOwner(),c=e.rowData,h=c&&c.rowId,u=i.getRowDataByServerRowId.call(i,h);if(void 0===u)return"";t.isTreeExpander()&&(s+="display: inline;opacity:0.7; background-color:inherit;",a="");var p=d.isViewGrid(),g=o&&!p?"k-gridCellstate-disabled":"",f=o&&!p?" tabindex='9999999' ":" ",m="",v=t.getIsRedBlue()||i.isRedBlue?t.redBlueCls||"":"",y=void 0!=u?t.getValueByRowData(u,l):"";if(e.hiddenEnabled&&e.hiddenMask&&(y=e.hiddenMask),~(this.allowHtmlCell?y:KD.htmlUtil.encode(y)).search(/\r\n|\n/g)){var b=2,D=12,k=KD.convertToHtmlString(KD.htmlUtil.encode(y||"")).split("<br/>").length;k>1&&(b=k);var C=i.rowHeight/b;D>C&&(C=D),s+="line-height:"+C+"px;",C*b>i.rowHeight&&(s+="height:"+i.rowHeight+"px;")}var x=e.tooltipIndicatorEnabled;KD.isEmpty(x)&&(x=!0);var w="",K=e.tooltipEnabled?e.tooltip||y:"",S=K?' title="'+KD.htmlUtil.encode(K).replace(/\"/g,"&quot;")+'"':"",I=K&&x?'<span class="kd-grid-tipflag"></span>':"",P=t.getDisplayValue(y,h,u);(P||"").toString().indexOf("¥")>=0?w="font-family:Arial;":(P||"").toString().indexOf("￥")>=0&&(w="font-family:SimSun;");var F,T=t.getTextAlign(),_=("right"==T?"padding-right:":"padding-left:")+"5px;",A={key:l,row:h,entrykey:d.key,pageid:d.getPageId()},L=o&&!p?"<div><input type='button' value='...' class='ui-editor-icon kendo-background-color ' onclick='KD.entryLargetextClick("+JSON.stringify(A)+");'  style='height: 20px;line-height: 20px;top:4px;' /></div>":"",M=ClientAppProxy.Current.IsIgnoreGridCellColorTrans?"kd-grid-celldiv-ignorecellopcity":"";if(a){var E=E=n?"color:"+n+";":"color:#000000;";(void 0==o||0==o)&&(E="",a=""),F=w+"background-color:"+a+"; text-align:"+T+";"+_+s+E,m=kendo.format('<div {0} class="{1} kd-grid-celldiv {2} {3}" style="{4}">{5}<div style="display: flex;"><span class="kd-grid-cellspan" style="{6}" {7} >{8}</span>{9}</div></div>',f,v,g,M,F,I,w+s,S,P,L)}else{var E=n?"color:"+n+";":"";F=_+w+s+E+"; text-align:"+T+";",m=kendo.format('<div style="display: flex;"><span {0} class="{1} kd-grid-cellspan {2}" style="{3}" {4}>{5}</span>{6}</div>',f,v,g,F,S,P+I,L)}return m},getColEditorOption:function(){var e=new KDLargeTextFieldProxy,t=e.getGirdEditorOptions(this.editor);return t},getCellEditorTemplate:function(e,t){return'<input class="k-textbox" style="padding-top: 0em; padding-bottom: 0em;height:'+e.height()+'px;" />'}}),KDColumnDescriptorFactory.registerType("kdlargetexttips",KDLargeTextColumnDescriptor),define("KDTextAreaColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDTextAreaColumnDescriptor}}(this)),function(e){KDNumberColumnDescriptor=KD.extend(KDColumnDescriptor,{redBlueCls:KD.numInfo?KD.numInfo.redCellCls:"",isNum:!0,getColEditorOption:function(){var e=this.proxy=new KDNumberFieldProxy,t=e.getGirdEditorOptions(this.editor);return t},getSchemaModel:function(){var e=KDNumberColumnDescriptor.superclass.getSchemaModel.call(this);return this.getEditorStyleKey()==KDNumberFieldProxy.CPUpDownNumberField&&(e.editable=!1),e},formatEditValue:function(e){return{text:e||0,value:e}},formatDisplayValue:function(e){return 0==e&&0==this.editor.isZeroShow&&(e=" "),e},getPrecision:function(e){var t=this,i=t.editor,a=t.getGridStore(),n=0;if(KD.isEmpty(i.precisionField))n=t.getDimensionValue(KD.KDGridActionKeys.DecimalPrecision,e);else if(0!=i.isControlPrecision){var o=a.getColumnDescriptor.call(a,i.precisionField);o&&o.isF7&&(n=o.getPrecision.call(o,e,i.precisionIndex))}else n=i.decimalPrecision||n;return void 0===n&&(n=i.decimalPrecision||0),n},wrapSetValue:function(e,t,i){var a=i.model.rowId,n=parseFloat(t);if(isNaN(n))return t;n=KD.numInfo.checkValueIsOverFloatMinValue(n);var o=parseFloat(this.getDimensionValue(KD.KDGridActionKeys.MaxValue,a)||this.config.editor.maxValue),r=parseFloat(this.getDimensionValue(KD.KDGridActionKeys.MinValue,a)||this.config.editor.minValue);if(this.IsRedBlue){var s=o;o=-1*r,r=-1*s}return KD.isNaN(o)&&KD.isNaN(r)?t:(!KD.isNaN(o)&&n>o&&(n=o),!KD.isNaN(r)&&r>n&&(n=r),n)},getNumFmtState:function(e){var t=this,i=t.editor,a=t.getGridStore(),n=a.getGridFmtInfoMap.call(a,i.numtype);if(n&&!n.isEmpty.call(n)){var o={};if(KD.isEmpty(i.precisionField))o[KDGridFormatInfo.C_NumFmtInfo]=n.getFormatInfoByField.call(n,t.getFieldName());else{var r=a.getColumnDescriptor.call(a,i.precisionField);if(r){var s="";s=r&&r.isF7?r.getNumber(e):r.getSvrValue(e),o[KDGridFormatInfo.C_NumFmtInfo]=n.getFormatInfoByValue.call(n,s)}else o[KDGridFormatInfo.C_NumFmtInfo]=n.getFormatInfoByField.call(n,t.getFieldName())}ret=o[KDGridFormatInfo.C_NumFmtInfo]}else ret=t.getDimensionValue(KD.KDGridActionKeys.NumFmtInfo,e);return ret},getDisplayValue:function(e,t,i){var a=this,n=a.editor,o=KDNumberFieldProxy.prototype.getKendoOptions(n)||{},r=(this.getKendoFieldName(),e),s="";if(0==e&&0==o.isZeroShow)return s;var l=parseFloat(r),d=a.getPrecision(t);if(l=KD.numInfo.getRedBlueValue(l,o),l=KD.numInfo.checkValueIsOverFloatMinValue(l),o.isUseRegion){var c=a.getNumFmtState(t),h=KD.numInfo.getNumberFormatInfo(c);return h.NumType=n.numtype,s=h.getFormatedString.call(h,l,d,l+""),this.__getRealPrecDispValue(s)}if(KD.isNaN(l)||0==l)return o.isZeroShow?"0":"";var u=(o.maskUseAsDisplayFormat?o.mask:o.displayFormat)||KD.numInfo.getMask(o.intLength,d);return s=KD.numInfo.formatNumber(l,d,u),this.__getRealPrecDispValue(s)},__getRealPrecDispValue:function(e){var t=this,i=t.editor,a=i.dsplayByReallyPrecision||!1;return 0==a?e:(e||"").indexOf(".")<0?e:KD.toReallyPrecision(e,13)},getCellEditorTemplate:function(e,t){return"<div>"},getTemplate:function(t,i){var a=this,n="",o="kd-"+KDNumberFieldProxy.CPUpDownNumberField,r=i.rowId,s=a.isDisabled(i),l=!s&&a.getEditorStyleKey()==KDNumberFieldProxy.CPUpDownNumberField;if(l){var d=a.getSpinnerTemplate(t,i,o,s);n=a.attachCellData(d,r,t)}else n=KDNumberColumnDescriptor.superclass.getTemplate.call(a,t,i);if(!this.IsRedBlue){var c=i[this.getFieldName()],h=document.createElement("div"),u=""+c;!KD.isEmpty(u)&&u.length>0&&"-"===u.substr(0,1)?e(h).html(e(n).css("color",KD.getLocalConfiguration().MinusNumColor)):e(h).html(e(n)),n=e(h).html()}return n},beforeCreateEditorProxy:function(t,i){var a=this,n=(i.model.get(i.field),i.model.rowId);e.extend(t,{decimalPrecision:a.getPrecision(n)})},afterInitCellEditorComponent:function(t,i){var a=this,n=i.model.rowId,o=a.getSvrValue(n);a.proxy&&a.proxy.component&&(a.proxy.setValue.call(a.proxy,o),e("INPUT",a.proxy.component)&&e("INPUT",a.proxy.component).select&&e("INPUT",a.proxy.component).select())},getSpinnerTemplate:function(e,t,i,a){var n=this,o=t.rowId,r=n.getOwner().store,t=r.getRowDataByServerRowId.call(r,o),s=n.getPageId()+"-"+n.getOwnerKey()+"_"+e+"_c",l=t[e],d=n.getDisplayValue(l,o,t),c='<div class="kd-spinner-numdisplayer kd-editor-input-bound"><span>'+d+"</span></div>",h='<div class="kd-spinner-inp-div kd-editor-input-bound"><input class="k-input kd-editor-input-bound" role="button" value="'+l+'"></input></div><div class="k-select kd-spinner-btn kd-spinner-btnLeft" role="button">+</div><div class="k-select kd-spinner-btn kd-spinner-btnRight" role="button">-</div>',u='<div class="'+i+'" style="text-align: left; background: white;" data-field="'+e+'" data-rowid="'+o+'" data-role="kdlrspinnernumber" id="'+s+'" title="">    <span class="k-widget k-header" style="display: inline; border: 0px;">        <span class="k-dropdown-wrap k-state-default" style="border: 0px;text-align: left;min-width: 63px;">'+(a?c:h)+"        </span>    </span></div>";
return u}}),KDColumnDescriptorFactory.registerType("numberfield",KDNumberColumnDescriptor),e.extend(KDNumberColumnDescriptor,{onLRSpinnerClick:function(t,i){var a=e(i.target).closest(".kd-CPUpDownNumberField"),n=e(i.target).closest("tr"),o=e(i.target).hasClass("kd-spinner-btnRight"),r=a.data(),s=r.field,l=r.rowid,d=t.store,c=(d.getRowIndexByServerRowId.call(d,l),t.getKendoGrid.call(t).dataItem(n)),h=d.getColumnDescriptor.call(d,s),u=h.getSvrValue.call(h,l),p=h.editor?h.editor.incremental||1:1;u=o?parseFloat(u)-p:parseFloat(u)+p,h.onchange.call(h,i,u,{field:s,model:c}),e(".kd-spinner-numdisplayer span",a).text(u)},onSpinnerTxtChange:function(t,i){var a=e(i.target).closest(".kd-CPUpDownNumberField"),n=e(i.target).closest("tr"),o=e(i.target).closest(".kd-spinner-inp-div .k-input"),r=a.data(),s=r.field,l=r.rowid,d=t.store,c=(d.getRowIndexByServerRowId.call(d,l),t.getKendoGrid.call(t).dataItem(n)),h=d.getColumnDescriptor.call(d,s),u=o.val();h.onchange.call(h,i,u,{field:s,model:c}),e(".kd-spinner-numdisplayer span",a).text(u)}}),KDVoucherNumberColumnDescriptor=KD.extend(KDNumberColumnDescriptor,{getDisplayValue:function(e,t,i,a){for(var n=1==a?e:KDVoucherNumberColumnDescriptor.superclass.getDisplayValue.call(this,e,t,i),o=(n+".").split("."),r=(o[0]+"").split(""),s=(o[1]+"").split(""),l=["&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;","&nbsp;"],d=["&nbsp;","&nbsp;"],c=0;c<r.length;c++){var h=r[c]+"";"-"==h||KD.isNaN(parseInt(h))&&r.splice(c,1)}l=l.concat(r),l=l.splice(l.length-12,12);for(var c=0;c<s.length;c++){var h=s[c]+"";KD.isNaN(parseInt(h))&&s.splice(c,1)}return d=s.concat(d),d=d.splice(0,2),n=KD.format('<span class="kd-grid-voucher-item-container" style="height: {14}px;"><span class="kd-grid-voucher-item">{0}</span><span class="kd-grid-voucher-item">{1}</span><span class="kd-grid-voucher-item" style="border-right-color:#93C4F6">{2}</span><span class="kd-grid-voucher-item">{3}</span><span class="kd-grid-voucher-item">{4}</span><span class="kd-grid-voucher-item" style="border-right-color:#93C4F6">{5}</span><span class="kd-grid-voucher-item">{6}</span><span class="kd-grid-voucher-item">{7}</span><span class="kd-grid-voucher-item" style="border-right-color:#93C4F6">{8}</span><span class="kd-grid-voucher-item">{9}</span><span class="kd-grid-voucher-item">{10}</span><span class="kd-grid-voucher-item" style="border-right-color:#E9AFB8">{11}</span><span class="kd-grid-voucher-item">{12}</span><span class="kd-grid-voucher-item" style="border-right:none;">{13}</span></span>',l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8],l[9],l[10],l[11],d[0],d[1],this.owner.rowHeight)},getSchemaModel:function(){var e=KDVoucherNumberColumnDescriptor.superclass.getSchemaModel.call(this)||{},t="string";return this.gridEditable&&(t="number"),e.type=t,e},getAttributesClass:function(){var e="";return e=KDVoucherNumberColumnDescriptor.superclass.getAttributesClass.call(this),e+="kd-grid-customheade-voucher"},getHeaderAttributes:function(){var e="";return e=KDVoucherNumberColumnDescriptor.superclass.getHeaderAttributes.call(this)||{},e["class"]=KD.isEmpty(e["class"])?"kd-grid-customheade-voucher":e["class"]+"kd-grid-customheade-voucher",e},createHeaderTemplate:function(){var e="";return e=KDVoucherNumberColumnDescriptor.superclass.createHeaderTemplate.call(this),e='<div style="padding: 3px 0px;">'+e+"</div>",e+=KD.format('<span class="kd-grid-voucher-item-container"><span class="kd-grid-voucher-item">{0}</span><span class="kd-grid-voucher-item">{1}</span><span class="kd-grid-voucher-item" style="border-right-color:#93C4F6">{2}</span><span class="kd-grid-voucher-item">{3}</span><span class="kd-grid-voucher-item">{4}</span><span class="kd-grid-voucher-item" style="border-right-color:#93C4F6">{5}</span><span class="kd-grid-voucher-item">{6}</span><span class="kd-grid-voucher-item">{7}</span><span class="kd-grid-voucher-item" style="border-right-color:#93C4F6">{8}</span><span class="kd-grid-voucher-item">{9}</span><span class="kd-grid-voucher-item">{10}</span><span class="kd-grid-voucher-item" style="border-right-color:#E9AFB8">{11}</span><span class="kd-grid-voucher-item">{12}</span><span class="kd-grid-voucher-item" style="border-right:none;">{13}</span></span>',"千","百","十","亿","千","百","十","万","千","百","十","元","角","分")},createTemplate:function(e){var t=this,i=t.getGridStore();e=e||{};var a=e.backcolor,n=e.forecolor,o=e.disable,r=i.rowHeight;if(i.rowHeight<34){var s=t.getFormProxy();(s.dformConfig||s.config).isUseSmallScreenModel||(r=34)}var l="min-height:"+r+"px;";("kdtextarea"==this.xtype||"textfield"==this.xtype)&&(l+="height:"+r+"px;");var d=e.field,c=t.getOwner(),h=e.rowData,u=h&&h.rowId,p=i.getRowDataByServerRowId.call(i,u);if(void 0===p)return"";t.isTreeExpander()&&(l+="display: inline;opacity:1; background-color:transparent; color:#000000;",a="");var g=c.isViewGrid(),f=o&&!g?"k-gridCellstate-disabled":"",m=o&&!g?" tabindex='9999999' ":" ",v="",y=t.getIsRedBlue()||i.isRedBlue?t.redBlueCls||"":"",b=void 0!=p?t.getValueByRowData(p,d):"";if(e.hiddenEnabled&&e.hiddenMask&&(b=e.hiddenMask),~(this.allowHtmlCell?b:KD.htmlUtil.encode(b)).search(/\r\n|\n/g)){var D=2,k=12,C=KD.convertToHtmlString(KD.htmlUtil.encode(b||"")).split("<br/>").length;C>1&&(D=C);var x=i.rowHeight/D;k>x&&(x=k),l+="line-height:"+x+"px;",x*D>i.rowHeight&&(l+="height:"+i.rowHeight+"px;")}var w=e.tooltipIndicatorEnabled;KD.isEmpty(w)&&(w=!0);var K="",S=e.tooltipEnabled?e.tooltip||b:"",I=S?' title="'+KD.htmlUtil.encode(S).replace(/\"/g,"&quot;")+'"':"",P=S&&w?'<span class="kd-grid-tipflag"></span>':"",F=t.getDisplayValue(b,u,p),T=KD.getFontFamilyByCurrencySymbol(F);KD.isEmpty(T)||(K=kendo.format("font-family:{0};",T));var _=t.getTextAlign(),A=" padding:0px;";if(a){var L=L=n?"color:"+n+";":"color:#000000;";(void 0==o||0==o)&&(L="",a=""),v="<div "+m+' class="'+y+" kd-grid-celldiv "+f+'" style="'+K+"background-color:"+a+"; text-align:"+_+";"+A+l+L+'">'+P+'<span class="kd-grid-cellspan" style="'+K+l+'"'+I+">"+F+"</span></div>"}else{var L=n?"color:"+n+";":"";v="<span "+m+' class="'+y+" kd-grid-cellspan "+f+'" style="'+A+K+l+L+"; text-align:"+_+';"'+I+">"+F+P+"</span>"}return v},getFooterData:function(e,t,i,a){var n=this.getDisplayValue(e,0,{},!0);return n=kendo.format('<div class="kd-grid-customheade-voucher">{0}</div>',n)}}),KDColumnDescriptorFactory.registerType("vouchernumberfield",KDVoucherNumberColumnDescriptor)}(jQuery),define("KDNumberColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDNumberColumnDescriptor}}(this)),KDComboBoxColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=KDComboBoxColumnDescriptor.superclass.getColEditorOption.call(this);return e},setStore:function(e){KDComboBoxColumnDescriptor.superclass.setStore.call(this,e),e&&(this.editor.store=e,this.proxy&&this.proxy.loadStore&&this.proxy.loadStore.call(this.proxy,e))},formatEditValue:function(e){return{text:this.getDisplayValue(e),value:e}},getValueByRowData:function(e,t){e=void 0==e?{}:e;var i=(this.getKendoFieldName()||"").toUpperCase(),a=i+"__value",n=e[a];return KD.isEmpty(n)&&(n=e[i]),n},getSvrValue:function(e){var t=this.getGridStore(),i=t?t.getRowDataByServerRowId.call(t,e):"",a=this.getFieldName();return this.getValueByRowData(i,a)},setSvrValue:function(e,t){var i=this,a=i.getGridStore(),n=(i.getFieldName(),i.getKendoFieldName()),o=i.subColDescriptor,r=n+"__value";o&&(t=o.formatEditValue(t).subValue);var s=i.formatEditValue(t),l=i.getSvrValue(e);l==t||l&&t&&l.toString()==t.toString()||(a.updateSvrValue.call(a,e,r,s.value),a.updateSvrValue.call(a,e,n,s.text))},getDisplayValue:function(e){var t="";if(!this.editor.store)return t;for(var i in this.editor.store){var a=this.editor.store[i];if(!KD.isArray(a)){t=e;break}if(a[0]==e){t=a.length>1?a[1]:a[0];break}}return t},getCellEditorTemplate:function(e,t){return'<input style="display:none;" />'},beforeInitCellEditorComponent:function(e,t){this._releaseHistoryPop(),KDComboBoxColumnDescriptor.superclass.beforeInitCellEditorComponent.call(this,e,t)},afterInitCellEditorComponent:function(e,t){var i=this.getOwner(),a=this.proxy;if(a&&a.loadStore.call(a,this.editor.store),KDComboBoxColumnDescriptor.superclass.afterInitCellEditorComponent.call(this,e,t),"kdtreegrid"!=i.config.xtype){var n=a.component.data(a.getKendoCType());if(n&&n.open){n.open();var o=n.wrapper;$(o).addClass("k-icon").attr({tabindex:"-1"}).focus(),KD.delayInvoke(function(e){$(e).removeClass("k-icon")},50,!0,o)}}$(".ui-poplistedit-displayname",e).css({width:"inherit","padding-right":"1.9em",right:"0em"})},_releaseHistoryPop:function(){if(this.proxy){var e=this.proxy.comboxpopup;e&&e.destroy&&e.destroy()}},release:function(){this._releaseHistoryPop(),KDComboBoxColumnDescriptor.superclass.release.call(this)},getDefaultValue:function(){return""}}),KDColumnDescriptorFactory.registerType("kdcombo",KDComboBoxColumnDescriptor),KDMultiComboBoxColumnDescriptor=KD.extend(KDComboBoxColumnDescriptor,{getCellEditorTemplate:function(e,t){return"<div></div>"},formatEditValue:function(e){var t="";return e&&KD.isArray(e)?$.each(e,function(i){t+=i!=e.length-1?e[i]+",":e[i]}):t=e,{text:this.getDisplayValue(t),value:t}},afterInitCellEditorComponent:function(e,t){KDMultiComboBoxColumnDescriptor.superclass.afterInitCellEditorComponent.call(this,e,t);var i=this.proxy;i.component.data(i.getKendoCType())&&i.component.data(i.getKendoCType()).openPopup&&i.component.data(i.getKendoCType()).openPopup(),$("input[data-field='"+t.field+"']",e).css("display","none")},getDisplayValue:function(e){if(!this.editor.store)return e;if(!e)return"";var t=e.split(","),i=[];if(0!=t.length){var a=this.editor.store.concat();for(var n in t)$(a).each(function(e){var o=a[e];return o[0]==t[n]?(i.push(o[1]),a.splice(e,1),!1):void 0});return 0==i.length?"":i.join(",")}for(var n in this.editor.store){var o=this.editor.store[n];if(o[0]==e)return o[1]}return e}}),KDColumnDescriptorFactory.registerType("kdmulticombo",KDMultiComboBoxColumnDescriptor),KDEditComboBoxColumnDescriptor=KD.extend(KDComboBoxColumnDescriptor,{formatEditValue:function(e){return e},setSvrValue:function(e,t){var i=this.getGridStore(),a=this.getFieldName(),n=this.getSvrValue(e),o=this.subColDescriptor;o&&(t=o.formatEditValue(t).subValue),n==t||n&&t&&n.toString()==t.toString()||i.updateSvrValue.call(i,e,a,t)},getDisplayValue:function(e,t,i){return void 0===e?e="":KD.convertToHtmlString(this.allowHtmlCell?e:KD.htmlUtil.encode(e),!1)||""},getCellEditorTemplate:function(e,t){var i=this.gridStore.rowHeight;return'<input style="display:none;height:'+i+'px;" />'},createTemplate:function(e){var t=KDEditComboBoxColumnDescriptor.superclass.createTemplate.call(this,e),i=this.getOwner();if(i&&"voucherkdgrid"==i.xtype){var a=$(t),n=a.text();t=kendo.format('<div class="kd-grid-column-mutiline-container" title="{2}" style="height:{0}px;">{1}</div>',i.rowHeight,a[0].outerHTML,n)}return t},afterInitCellEditorComponent:function(e,t){var i=(this.getOwner(),this.proxy);i&&i.loadStore.call(i,this.editor.store),KDComboBoxColumnDescriptor.superclass.afterInitCellEditorComponent.call(this,e,t),$(".ui-poplistedit-displayname",e).css({width:"inherit","padding-right":"1.9em",right:"0em"})}}),KDColumnDescriptorFactory.registerType("kdeditcombo",KDEditComboBoxColumnDescriptor),define("KDComboBoxColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDComboBoxColumnDescriptor}}(this)),KDCheckboxColumnDescriptor=KD.extend(KDColumnDescriptor,{getColOptions:function(e){var t=this,i=t.getOwner(),a=(KDStore.C_HeadCheckAllRowId,t.getKendoFieldName(),KDCheckboxColumnDescriptor.superclass.getColOptions.call(t,e));({pageId:i&&i.getPageId?i.getPageId.call(i):"",key:i&&i.getKey?i.getKey.call(i):""});return $.extend(a,{filterable:!1,sortable:{initialDirection:t.getSort(),compare:function(e,i){var a=t.sortCompare.call(t,e,i);return a}}}),a},sortCompare:function(e,t){var i=e.rowId,a=t.rowId,n=this.getValue(i),o=this.getValue(a),r=0;return(void 0==n||null==n)&&(n=!1),(void 0==o||null==o)&&(o=!1),o=o.toString().toLowerCase(),n=n.toString().toLowerCase(),r=n>o?1:n==o?0:-1},createHeaderTemplate:function(){var e=this,t=e.getOwner();rowId=KDStore.C_HeadCheckAllRowId,field=e.getKendoFieldName(),mustInput=e.config.mustInput,label=e.headerText,mustInputLabel="";var i={pageId:t&&t.getPageId?t.getPageId.call(t):"",key:t&&t.getKey?t.getKey.call(t):""};if(1==mustInput&&(mustInputLabel="<span class='kd-grid-mustinput'>*</span>"),e.config&&e.config.editor&&!e.config.editor.hidebatchcheck){var a=KD.stringify(i).replace(/\"/g,"'"),n=' data-field="'+field+'" data-rowId='+rowId,o=(e.config.dataIndex==KDStore.C_SelColKey,"");ret='<span class="'+e.getCellClass(!0)+'" style="display: '+o+';"><input type="checkbox" onclick="return false;" class="k-checkbox gridCheck gridCheckHeader"'+n+' data-arg="'+a+'"/><label class="k-checkbox-label" for=":before">'+label+"</label>"+mustInputLabel+"</span>"}else t&&t.isTreeList?(ret=e.headerText,1==mustInput&&(ret="<span>"+e.headerText+"</span>"+mustInputLabel)):ret='<span class="k-link">'+e.headerText+"</span>"+mustInputLabel;return ret},getSchemaModel:function(){var e=this,t=(e.getOwner(),KDCheckboxColumnDescriptor.superclass.getSchemaModel.call(this));return t.editable=!1,t},getColEditorOption:function(){var e=new KDCheckBoxProxy,t=e.getGirdEditorOptions(this.editor);return t},getCellEditorTemplate:function(e,t){return'<div style="text-align: center;">'},initCellEditorComponent:function(e,t){var i=this;if(i.proxy){var a=i.isDisabled(t.model);i.beforeInitCellEditorComponent(e,t);var n=i.getCellEditorTemplate(e,t);n=i.attachCellData(n,t.model.rowId,t.field);var o=$(n).appendTo(e);i.proxy.initCellComponent.call(i.proxy,o),o.addClass("kd-grid-celldiv"),i.proxy.setDisabled(a),i.afterInitCellEditorComponent(e,t)}},onchange:function(e,t,i){var a=this,n=i.model.rowId;a.setCheckBoxValue(n,t)},createTemplate:function(e){var t=this,i="",a=e&&e.backcolor,n=e&&e.forecolor,o=e.rowData.rowId,r=e.field,s=e&&e.disable,l=t.getOwner(),d=t.getGridStore(),c=t.getSvrValue(o),h={pageId:l&&l.getPageId?l.getPageId.call(l):"",key:l&&l.getKey?l.getKey.call(l):""},u=KD.stringify(h).replace(/\"/g,"'"),p=' data-field="'+r+'" data-rowId='+o,g="min-height:"+d.rowHeight+"px;",f=l&&l.isViewGrid(),m=s&&!f?"k-gridCellstate-disabled":"",v=s&&!f?'disabled="disabled"':"",y='<div data-role="checkbox" class="kd-grid-celldiv kd-checkbox-div '+this.getCellClass()+" "+m+'" {style}><input type="checkbox" onclick="return false;" style="height:16px;display: inline-block;" class="k-checkbox gridCheck gridCheckCell" '+p+' data-arg="'+u+'" checked="checked" '+v+'><label class="k-checkbox-label" for=":before"></label></div>';if(a){var b=n?"color:"+n+";":"color:#000000;";i='style="background-color:'+a+";"+b+";text-align:center;"+g+'"'}else i=n?'style="color:'+n+';text-align:center;"':'style="text-align:center;"';return KD.isString(c)&&(c=KD.equalsIgnoreCase(c,"true")),1!=c&&(y=y.replace(' checked="checked"',"")),y=y.replace("{style}",i)},getCellClass:function(e){return e?"kd-grid-checkbox-title kd-colheader-label":""},setHeaderCheckBoxValue:function(e){var t=this,i=t.editor.fireUpdate,a=t.getOwner(),n=a.getStore.call(a),o=n.rows.length;t.editor.fireUpdate=0;for(var r=0;o>r;r++){r==o-1&&(t.editor.fireUpdate=i);var s=n.rows[r],l=t.isDisabled(s);if(!l){var d=n.getRowId.call(n,s),c=n.getRowIndexByServerRowId.call(n,d);t.setValue(c,e)}}a.setRefreshGridDataFlag.call(a,!0)},setValue:function(e,t){var i=this.getGridStore(),a=i.rows[e],n=this.getKendoFieldName(),o=a[n];if(o!=t&&!this.config.fireUpdate){var r=this.getFormProxy();r.storeData.call(r,n,t,e)}KDCheckboxColumnDescriptor.superclass.setValue.call(this,e,t)},setCheckBoxValue:function(e,t){var i=this,a=i.getOwner(),n=a.getStore.call(a),o=n.getRowIndexByServerRowId.call(n,e);this.setValue(o,t),this.syncColHeadValue()},setSvrValue:function(e,t){var i=this,a=this.getSvrValue(e),n=this.subColDescriptor;if(n&&(t=n.formatEditValue(t).subValue),!(a==t||a&&a.toString()==t.toString())){var o=i.getOwner(),r=o.getControl.call(o),s=i.getKendoFieldName();if(null!=e&&(inputs=$("div[data-rowid="+e.toString()+"] .gridCheckCell",r)),inputs&&inputs.length>0)for(var l=0;l<inputs.length;l++){var d=$(inputs[l]);if(d.attr("data-field").toString()==s.toString()){d[getPropName()]("checked",t);break}}}KDCheckboxColumnDescriptor.superclass.setSvrValue.call(i,e,t),i.syncColHeadValue()},syncColHeadValue:function(){var e=this;if(1!=e.batchUpdating){var t=e.getOwner();if(t&&t.syncCheckHeadersIMM.call(t,this)){var i=t.getControl.call(t),a=e.getKendoFieldName(),n=$(i[0].querySelectorAll("th[data-field='"+a+"'] .gridCheckHeader")),o=$(i[0].querySelectorAll("tr input[data-field='"+a+"'].gridCheckCell")).parent(),r=o.find(".gridCheckCell:checked").length;if(n.length>0){var s=!0,l=t.getStore.call(t);if(!l||void 0==l.rows||0==l.rows.length)return void n[getPropName()]("checked",!1);var d=t.getGridViewRows.call(t);d.length!=l.rows.length&&KD.writeLog("KDCheckboxColumnDescriptor.syncColHeadValue()","syncColHeadValue页面行数与实际数据行数不等",!0);for(var c=d.length,h=0,u=0;c>u;u++){var p=d[u],g=p[a],f=l.getColumnDescriptor.call(l,a),m=p.rowId,v=l.getRowDataByServerRowId(m),y=f.isDisabled.call(f,v);if(!(y||y&&"true"==y.toString().toLowerCase()||(h++,g&&"false"!=g.toString().toLowerCase()))){s=!1;break}}(0==c||0==h)&&(s=!1),n[getPropName()]("checked",s),n.next("label").removeClass("kd-checkbox-label-tristate"),0!=r&&r<d.length&&!s&&n.next("label").addClass("kd-checkbox-label-tristate")}}}},isCheckBox:function(){return!0},beginBatchUpdate:function(e){this.batchUpdating=!0},endBatchUpdate:function(e,t){this.batchUpdating=!1,this.syncColHeadValue()},setSelected:function(e,t){},resetHeaderCheckValue:function(){var e=this.getOwner(),t=e&&e.getControl.call(e),i=this.getKendoFieldName();if(KDStore.isColSelector(i)&&t){var a=$(t[0].querySelectorAll("th[data-field='"+i+"'] .gridCheckHeader"));a[getPropName()]("checked",!1),a.next("label").removeClass("kd-checkbox-label-tristate")}}}),$.extend(KDCheckboxColumnDescriptor,{cellValueShiftChanged:function(e,t,i){var a=$(e).parent(),n=$(".gridCheck",a);if(n.length){var o=!n.is(":checked"),r=n.data(),s=KD.parseObject(r.arg.replace(/\'/g,'"')),l=r.rowId||r.rowid,d=r.field,c=ClientAppProxy.Current,h=c&&c.getAliveForm.call(c,s.pageId),u=h&&h.getControlProxy.call(h,s.key),p=u&&u.getStore.call(u),g=p.getColumnDescriptor.call(p,d);if(n.hasClass("gridCheckCell")){var f=p.getRowDataByServerRowId(l),m=g.isDisabled.call(g,f);if(o=!g.getValueByRowData.call(g,f),m)return}n[getPropName()]("checked",o),g.setCheckBoxValue.call(g,l,o),g.setSelected.call(g,l,o);var v=KDStore.isColSelector(d);if(o&&v)for(var y=u.getKendoGrid(),b=y?y.select():[],D=0;D<b.length;D++){var k=y.dataItem(b[D]),C=k&&void 0!==k.rowId?k.rowId:"";if(l!=C){var x=$(".kd-grid-selector",b[D]);$(".gridCheckCell",x)[getPropName()]("checked",o),g.setCheckBoxValue.call(g,C,o),g.setSelected.call(g,C,o)}}v&&g.onRowCheckChange.call(g,e,i,o)}},cellValueChanged:function(e,t,i){var a=$(e).parent(),n=$(".gridCheck",a);if(n.length){var o=!n.is(":checked"),r=n.data(),s=KD.parseObject(r.arg.replace(/\'/g,'"')),l=r.rowId||r.rowid,d=r.field,c=ClientAppProxy.Current,h=c&&c.getAliveForm.call(c,s.pageId),u=h&&h.getControlProxy.call(h,s.key),p=u&&u.getStore.call(u),g=p.getColumnDescriptor.call(p,d);if(n.hasClass("gridCheckCell")){var f=p.getRowDataByServerRowId(l),m=g.isDisabled.call(g,f);if(o=!g.getValueByRowData.call(g,f),m)return}n[getPropName()]("checked",o),n.hasClass("gridCheckHeader")?(g.setHeaderCheckBoxValue.call(g,o),g.setSelected.call(g,"all",o)):(g.setCheckBoxValue.call(g,l,o),g.setSelected.call(g,l,o)),KDStore.isColSelector(d)&&g.onRowCheckChange.call(g,e,i,o)}},headerValueChanged:function(e,t,i){var a=$(t.target).parent(),n=$(".gridCheck",a),o=!n.is(":checked"),r=n.data(),s=KD.parseObject(r.arg),l=r.field,d=ClientAppProxy.Current,c=d&&d.getAliveForm.call(d,s.pageId),h=c&&c.getControlProxy.call(c,s.key),u=h&&h.getStore.call(h),p=u.getColumnDescriptor.call(u,l),g=[];if(u&&u.rows){if(KDStore.isColSelector(l))if(p.isBulkData.call(p))p.headerValueChanged.call(p,t,i);else{p.beginBatchUpdate.call(p,t);var f,m=h.getKendoGrid(),v=m.dataSource.filter&&m.dataSource.filter()&&m.dataSource.filter().filters.length>0||!1,y=!0;v&&(f=KD.cloneObject(h.getGridViewRows(!0)));for(var b=0;b<u.rows.length;b++){var D=u.rows[b],k=p.isDisabled.call(p,D);if(!k){if(v){y=!1;for(var C=0;C<f.length;C++)if(D.rowId==f[C].rowId){y=!0,f.splice(C,1);break}}p.setSvrValue.call(p,D.rowId,o&&y)}}p.setSelected.call(p,"all",o),p.endBatchUpdate.call(p,t)}else{p.beginBatchUpdate.call(p,t);var x=h.getGridViewRows();x.length!=u.rows.length&&KD["debugger"]("KDCheckboxColumnDescriptor->headerValueChanged页面行数与实际数据行数不等",!0);for(var b=0;b<x.length;b++){var D=x[b],k=p.isDisabled.call(p,D);k||(p.setSvrValue.call(p,D.rowId,o),g.push({Key:l,Row:D.rowId,Value:o,ParentRow:0}))}p.setSelected.call(p,"all",o),p.endBatchUpdate.call(p,t),c.batchStoreData(g),p.config.editor.fireUpdate&&(c.lockControl.call(c,h),c.fireEvent.call(c,"BatchUpdateValue"))}KDStore.isColSelector(l)&&p.onHeaderCheckChange.call(p,e,h,i,o)}}}),KDColumnDescriptorFactory.registerType("kdcheckbox",KDCheckboxColumnDescriptor),define("KDCheckboxColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDCheckboxColumnDescriptor}}(this)),function(){KDSelectedColumnDescriptor=KD.extend(KDCheckboxColumnDescriptor,{selectedMaps:{isInit:!1,all:!1},reset:function(){this.selectedMaps={isInit:!1,all:!1},this.isInit(!0)},isInit:function(e){return void 0!==e&&(this.selectedMaps.isInit=e),this.selectedMaps.isInit},setSvrValue:function(e,t){var i=parseInt(e);"all"==e||isNaN(i)||0>i||KDSelectedColumnDescriptor.superclass.setSvrValue.call(this,e,t),this.setSelected(e,t)},selRows:function(e){if(e&&e.length>0)for(var t=e,i=this.getGridStore(),a=i.getBaseRowId.call(i),n=0;n<t.length;n++)isNaN(parseInt(t[n]))||(this.setSvrValue(t[n],!0),this.setValue(t[n]-a,!0));this.isInit(!1)},headerValueChanged:function(e,t){if(this.isBulkData()){var i=this,a=i.getOwner(),n=$(e.target).parent(),o=$(".gridCheck",n),r=!o.is(":checked");a.invokeSelOp.call(a,"syncUI2SelBulk",{field:i.getFieldName(),rowId:KDStore.C_HeadCheckAllRowId,checked:r})}else KDSelectedColumnDescriptor.superclass.headerValueChanged.call(this,scope,e,t)},__setSelectedData:function(e,t){if(void 0===t?delete this.selectedMaps[e]:this.selectedMaps[e]=t,"all"!=e)delete this.selectedMaps.all;else if("all"==e){this.isInit(!1),void 0==t&&(t=!1);var i=this.getOwner().getStore().rows;if(i&&i.length>0)for(var a=0;a<i.length;a++)t?this.selectedMaps[i[a].rowId]=t:delete this.selectedMaps[i[a].rowId]}},setSelected:function(e,t){var i=this;this.getOwner();if(("all"==e||!this.selectedMaps||!this.selectedMaps[e]||this.selectedMaps[e]!=t)&&("all"==e||!this.selectedMaps||t||this.selectedMaps[e])){var a=this.owner.getLocalConfiguration().SelectRowBackground||"",n=$("#"+this.owner.baseId).find('.k-grid-content table tbody[role="rowgroup"] tr'),o=$("#"+this.owner.baseId).find(".k-grid-content-locked  table tbody tr"),r=o.length>0;i.getLocalConfiguration()||{};if(void 0===t?delete this.selectedMaps[e]:this.selectedMaps[e]=t,"all"!=e){delete this.selectedMaps.all;var s=$(".kd-grid-cellspan:first",n[0]).data();if(s&&void 0!==s.rowid){var l=(s&&void 0!==s.rowid?s.rowid:1,n.find('[data-rowid="'+e+'"]').closest("tr")),d=n.index(l),l=n.eq(d);if(d>=0)if(1==t)l.css("background-color",a),r&&o.eq(d).css("background-color",a);else{l.css("background-color",""),r&&o.eq(d).css("background-color","");var c=l.children("td").eq(0),h=c.find("input[type=checkbox]");h&&l.removeClass("k-state-selected")}}}else if("all"==e){this.isInit(!1),void 0==t&&(t=!1);var u=this.getOwner().getStore().rows;if(u&&u.length>0&&!t)for(var p=0;p<u.length;p++)delete this.selectedMaps[u[p].rowId];n.css("background-color",t?a:""),r&&o.css("background-color",t?a:"")}}},getSelectedIds:function(){var e=this,t=[];if(void 0===e.selectedMaps.all){for(var i in e.selectedMaps)if("all"!=i&&e.selectedMaps[i]){var a=parseInt(i);isNaN(a)||t.push(a)}}else if(e.selectedMaps.all){var n=e.getOwner();t=n.getGridViewRowIds()}return t},getColOptions:function(e){var t=KDSelectedColumnDescriptor.superclass.getColOptions.call(this,e);return $.extend(t,{filterable:!1}),t},getCellClass:function(){return"kd-grid-selector"},isDisabled:function(e){return!1},setValue:function(e,t){var i=this.getGridStore(),a=i.rows[e],n=this.getKendoFieldName();a&&(a[n]=t)},getValueByRowData:function(e){var t=this.getKendoFieldName();return"true"==(e[t]||"").toString()},sortCompare:function(e,t){var i=e.rowId,a=t.rowId,n=this.getSvrValue(i),o=this.getSvrValue(a),r=0;return(void 0==n||null==n)&&(n=!1),(void 0==o||null==o)&&(o=!1),o=o.toString().toLowerCase(),n=n.toString().toLowerCase(),r=n>o?1:n==o?0:-1},endBatchUpdate:function(e,t){KDSelectedColumnDescriptor.superclass.endBatchUpdate.call(this,t),t||this.fireChange(e)},onRowCheckChange:function(e,t,i){var a,n=$(e).parent(),o=n?n.closest("tr"):void 0,r=n?n.attr("data-rowid"):void 0,s=this.getOwner(),l="kd-state-selected",d=kendo.format('.k-grid-content-locked  table tbody tr td [data-rowid="{0}"]',r);this.locked()&&(l="kd-state-selected k-state-selected",d=kendo.format('.k-grid-content  table tbody tr td [data-rowid="{0}"]',r)),a=s&&s.component.find(d).first().closest("tr"),a&&a.length>0&&a[i?"addClass":"removeClass"]("kd-state-selected k-state-selected"),o&&o[i?"addClass":"removeClass"](l),this.fireChange({sender:e})},onHeaderCheckChange:function(e,t,i,a){var n=($(e).parent(),t.getControl.call(t)),o=$("tr",n);o&&(a?o.addClass("kd-state-selected"):o.removeClass("kd-state-selected k-state-selected"))},__setSelectState:function(e,t){var i=e.sender.current?e.sender.current():e.sender.select().first(),a=i&&$("[data-field]",i).data();if(!a||a.field!=KDStore.C_SelColKey||this.isInit()){this.isInit(!1);var n,o=this.getOwner(),r=o.store,s=r.getBaseRowId.call(r),l=$this.getLocalConfiguration()||{},d=this.owner.isIgnoreLocalColReset;if(!l.DisabledColReset&&d?n=!1:l.DisabledColReset&&d?n=!1:l.DisabledColReset||d&&void 0!=d?!l.DisabledColReset||d&&void 0!=d||(n=!1):n=!0,1==t.length){n?this.setSelected("all",!1):this.setSelected(t[0],!0);for(var c=0;c<r.rows.length;c++){var h=r.rows[c].rowId-s,u=this.getSvrValue(h);"false"!=u.toString()&&this.setValue(h,!1)}this.setSelected("all",void 0)}for(var c in t){var p=t[c],h=p-s;p>=0&&(this.setValue(h,!0),this.setSelected(p,!0))}}},isIgnoreLocalColReset:function(e,t){return e==t?!0:void 0},setSelectState:function(e,t){var i=this,a=this.getOwner();this.needRefreshOwner();var n=e.sender.current?e.sender.current():e.sender.select().first(),o=n&&$("[data-field]",n).data(),r=e.isForceClear;if(!o||o.field!=KDStore.C_SelColKey||this.isInit()||r){this.isInit(!1);var s,l=($(e.sender.element).closest("tr"),$("tr",e.sender.element)),d=a.store,c=i.getLocalConfiguration()||{},h=this.owner&&this.owner.isIgnoreLocalColReset;if(!c.DisabledColReset&&h?s=!1:c.DisabledColReset&&h?s=!1:c.DisabledColReset||h&&void 0!=h?!c.DisabledColReset||h&&void 0!=h||(s=!1):s=!0,1==t.length){s?this.setSelected("all",!1):this.setSelected(t[0],!0);for(var u=0;u<d.rows.length;u++){var p=d.rows[u].rowId,g=this.getSvrValue(p);!s&&this.owner.isInColSelection&&(g=!1),"false"!=g.toString()&&this.setSvrValue(p,!1)}l.removeClass("kd-state-selected"),this.setSelected("all",void 0)}var f=e.sender.select();0==f.length&&i.resetHeaderCheckValue.call(i);var m=a&&a.isInColSelection;s?f.hasClass("kd-state-selected")||m||f&&f.addClass("kd-state-selected"):(f.hasClass("kd-state-selected")||f.hasClass("k-state-selected"))&&o&&f.length>0?(f.removeClass("k-state-selected"),f.removeClass("kd-state-selected"),this.setSvrValue(o.rowid,!1)):!f.hasClass("k-state-selected")&&o&&f.length>0&&(f&&f.addClass("k-state-selected"),f&&f.addClass("kd-state-selected"),this.setSvrValue(o.rowid,!0));for(var u in t){var v=t[u];v>=0&&this.setSvrValue(v,!0)}this.needRefreshOwner()&&a.hideBlock.call(a)}},unselected:function(e){this.setSelectState(e,[-1])},fireChange:function(e){var t=this.getOwner();KD.delayInvoke(function(){t.onBatchChange&&t.onBatchChange.call(t,e)})},createTemplate:function(e){var t=this,i="",a=e.rowData.rowId,n=e.field,o=t.getOwner(),r=t.getGridStore(),s=t.getSvrValue(a),s=KD.isString(s)?"true"==(s||"").toLowerCase():s,l={pageId:o.getPageId.call(o),key:o.getKey.call(o)},d=KD.stringify(l).replace(/\"/g,"'"),c=' data-field="'+n+'" data-rowId='+a,h=("min-height:"+r.rowHeight+"px;",o.isViewGrid(),'<div data-role="checkbox" class="kd-grid-celldiv '+this.getCellClass()+' {originValueClass}" style="text-align:center;"><input type="checkbox" onclick="return false;" style="height:16px;display: inline-block;" class="k-checkbox gridCheck gridCheckCell" '+c+' data-arg="'+d+'" checked="checked"><label class="k-checkbox-label" for=":before"></label></div>');return originValueClass=1!=s?"":"kd-grid-selector-origin-true",1!=s&&(h=h.replace(' checked="checked"',"")),h=h.replace("{style}",i).replace("{originValueClass}",originValueClass)},getLocalConfiguration:function(){return KD.isEmpty(this.localConfiguration)&&(this.localConfiguration=KD.getLocalConfiguration()),this.localConfiguration}}),$.extend(KDSelectedColumnDescriptor,{getColConfig:function(e){return{colIndex:e,header:" ",width:28,dataIndex:KDStore.C_SelColKey,xtype:KDStore.C_SelXType,editor:{xtype:KDStore.C_SelXType}}}}),KDColumnDescriptorFactory.registerType("colSelector",KDSelectedColumnDescriptor)}(),define("KDSelectedColumnDescriptor",["KDCheckboxColumnDescriptor"],function(e){return function(){var t;return t||e.KDCheckboxColumnDescriptor}}(this)),function(){KDSelectedModelColumnDescriptor=KD.extend(KDColumnDescriptor,{selectedMaps:{isInit:!0,all:!1},reset:function(){this.selectedMaps.all=!1,this.isInit(!0)},isInit:function(e){return void 0!==e&&(this.selectedMaps.isInit=e),this.selectedMaps.isInit},setSvrValue:function(e,t){this.setSelected(e,t)},selRows:function(e){if(e&&e.length>0)for(var t=e,i=this.getGridStore(),a=i.getBaseRowId.call(i),n=0;n<t.length;n++)isNaN(parseInt(t[n]))||(this.setSvrValue(t[n],!0),this.setValue(t[n]-a,!0));this.isInit(!1)},setSelected:function(e,t){if(void 0===t?delete this.selectedMaps[e]:this.selectedMaps[e]=t,"all"!=e)delete this.selectedMaps.all;else if("all"==e){this.isInit(!1),void 0==t&&(t=!1);var i=this.getOwner().getStore().rows;if(i&&i.length>0)for(var a=0;a<i.length;a++)t?this.selectedMaps[i[a].rowId]=t:delete this.selectedMaps[i[a].rowId]}},getSelectedIds:function(){var e=this,t=[];if(void 0===e.selectedMaps.all){for(var i in e.selectedMaps)if("all"!=i&&e.selectedMaps[i]){var a=parseInt(i);isNaN(a)||t.push(a)}}else if(e.selectedMaps.all){var n=e.getOwner(),o=n.getStore.call(n),r=n.getGridViewRows();for(var i in r){var a=parseInt(o.rows[i].rowId);isNaN(a)||t.push(a)}}return t},getColOptions:function(e){var t=KDSelectedColumnDescriptor.superclass.getColOptions.call(this,e);return $.extend(t,{filterable:!1,sortable:!1}),t},getCellClass:function(){return""},isDisabled:function(e){return!0},setValue:function(e,t){var i=this.getGridStore(),a=i.rows[e],n=this.getKendoFieldName();a&&(a[n]=t)},getValueByRowData:function(e){var t=this.getKendoFieldName();return"true"==(e[t]||"").toString()},beginBatchUpdate:function(e){},endBatchUpdate:function(e){},onRowCheckChange:function(e,t,i){},onHeaderCheckChange:function(e,t,i,a){},setSelectState:function(e,t){var i=e.sender.current?e.sender.current():e.sender.select().first(),a=$("[data-field]",i).data();if(!a||a.field!=KDStore.C_SelColKey||this.isInit()){this.isInit(!1);var n=this.owner.getLocalConfiguration(),o=n.SelectRowBackground==n.DefaultRowBackground?void 0:n.SelectRowBackground||void 0,r=($(e.sender.element).closest("tr"),$("tr",e.sender.element)),s=this.getOwner(),l=s.store;if(1==t.length){this.setSelected("all",!1);for(var d=0;l.rows&&d<l.rows.length;d++)this.setSvrValue(l.rows[d].rowId,!1);r.removeClass("kd-state-selected").css("background-color",""),this.setSelected("all",void 0);
}var c=e.sender.select();c&&!c.hasClass("kd-state-selected")&&o&&c&&c.addClass("kd-state-selected").css("background-color",o);for(var d in t){var h=t[d];if(!KD.isEmpty(h)){var u=$("tr [data-rowId="+h+"]",e.sender.element);if(u&&u.length){var p=u&&u.closest?$(u.closest("tr")):void 0;p&&p.length&&(p.addClass("kd-state-selected"),o&&p.css("background-color",o)),h>=0&&this.setSvrValue(h,!0)}}}}},unselected:function(e){this.setSelectState(e,[-1])},fireChange:function(e){var t=this.getOwner();KD.delayInvoke(function(){t.onBatchChange&&t.onBatchChange.call(t,e)})}}),$.extend(KDSelectedModelColumnDescriptor,{getColConfig:function(e){return{colIndex:e,header:" ",visible:!1,width:0,dataIndex:KDStore.C_SelColKey,xtype:KDStore.C_SelModelXType,editor:{xtype:KDStore.C_SelModelXType}}}}),KDColumnDescriptorFactory.registerType("colSelectorModel",KDSelectedModelColumnDescriptor)}(),define("KDSelectedModelColumnDescriptor",["KDColumnDescriptor"],function(e){return function(){var t;return t||e.KDSelectedModelColumnDescriptor}}(this)),KDHtmlTextColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDTextFieldProxy,t=e.getGirdEditorOptions(this.editor);return delete t.formatter,t},getDisplayTemplate:function(e){e=e||{};var t={fcolor:e.forecolor,bcolor:e.backcolor},i=KD.isEmpty(t.bcolor)?"":"background-color:"+KD.formatHtmlColor(t.bcolor)+";",a=KD.isEmpty(t.bcolor)?"":"kd-grid-cellspan-opacity",n="color:"+(KD.isEmpty(t.fcolor)?"":KD.formatHtmlColor(t.fcolor))+";",o=e.hasError?"border: 1px solid #FD0F15;":"",r=kendo.format("{0}{1}{2}",i,n,o);return kendo.format('<span class="kd-grid-cellspan {2}" style="{1}">{0}</span>',e.value,r,a)},getDisplayValue:function(e,t,i){return e||""}}),KDColumnDescriptorFactory.registerType("kdhtmltext",KDHtmlTextColumnDescriptor),define("KDHtmlTextColumnDescriptor",["KDColumnDescriptor","KDTextFieldProxy","KD"],function(e){return function(){var t;return t||e.KDHtmlTextColumnDescriptor}}(this)),KDLinkButtonColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDTextFieldProxy,t=e.getGirdEditorOptions(this.editor);return delete t.formatter,t},getSplitPatternStyleClass:function(e){e=e||0;var t="";switch(e){case 0:t="kd-linkbutton-splitStyle-horizontal"}return t},getDisplayTemplate:function(e){var t=this;e=e||{};var i=e.rowData,a=t.getGridStore(),n=t.getGridStore()?a.revertKendoFieldName(e.field):e.field,o={fcolor:e.forecolor,bcolor:e.backcolor},r={entrykey:i.gridKey,key:n,row:e.rowId,pageid:t.getPageId()},s=e.disable,l=t.getOwner(),d=l.isViewGrid(),c=s&&!d?"k-gridCellstate-disabled":"",h=KD.isEmpty(o.bcolor)?"":"background-color:"+KD.formatHtmlColor(o.bcolor)+";",u=KD.isEmpty(o.bcolor)?"":"kd-grid-cellspan-opacity",p=ClientAppProxy.Current.IsIgnoreGridCellColorTrans&&u?"kd-grid-celldiv-ignorecellopcity":"",g=e.hasError?"border: 1px solid #FD0F15;":"",f="color:"+(KD.isEmpty(o.fcolor)?"":KD.formatHtmlColor(o.fcolor))+";";h=kendo.format("{0}{1}{2}",h,f,g);var m="",v=this.config.splitPattern;if(KD.isEmpty(v))m=kendo.format("<a target='_blank' style='max-width:100%;display:inline-block;' onclick='KD.entryButtonClick({0});' class='type-link kd-text-ellipsis'>{1}</a>",JSON.stringify(r),e.value);else for(var y=e.value.split(v.splitChar),b=this.getSplitPatternStyleClass(v.splitStyle),D=0;D<y.length;D++){var k=KD.cloneObject(r),C=JSON.stringify({clickChildIndex:D});m+=kendo.format("<a target='_blank' style='max-width:100%;display:inline-block;' onclick='KD.entryButtonClick({0},{1});' class='type-link kd-text-ellipsis {3}'>{2}</a>",JSON.stringify(k),C,y[D],b)}var x=kendo.format('<span class="kd-grid-cellspan kd-grid-linktd {0} {1} {2}" style="{3}">{4}</span>',c,u,p,h,m);return l.isEditable()&&!s&&(x=kendo.format('<span class="kd-grid-cellspan kd-grid-linktd {0} {3} {4}" style="{1}">{2}</span>',c,h,e.value,u,p)),e.readonly&&(x=kendo.format('<span class="kd-grid-cellspan kd-grid-linktd" style="color:#212121">{0}</span>',e.value)),x}}),KDColumnDescriptorFactory.registerType("kdlinkbutton",KDLinkButtonColumnDescriptor),define("KDLinkButtonColumnDescriptor",["KDColumnDescriptor","KD","KDTextFieldProxy"],function(e){return function(){var t;return t||e.KDLinkButtonColumnDescriptor}}(this)),KDButtonColumnDescriptor=KD.extend(KDLinkButtonColumnDescriptor,{getDisplayTemplate:function(e){var t=this,i=e.rowData,a=t.getGridStore(),n=t.getGridStore()?a.revertKendoFieldName(e.field):e.field,o=JSON.stringify({entrykey:i.gridKey,key:n,row:e.rowId,pageid:t.getPageId()});return'<span class="kd-grid-cellspan" ><button onclick=\'KD.entryButtonClick('+o+");' type='button' class=\"k-button\">"+e.value+"</button></span>"}}),KDColumnDescriptorFactory.registerType("kdbutton",KDButtonColumnDescriptor),define("KDButtonColumnDescriptor",["KDLinkButtonColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDButtonColumnDescriptor}}(this)),KDDatePickerColumnDescriptor=KD.extend(KDColumnDescriptor,{format:"yyyy-MM-dd",formatConversionList:["ddd","dddd","MMM","MMMM"],getColEditorOption:function(){var e=new KDDatePickerProxy,t=e.getGirdEditorOptions(this.editor);return t},formatEditValue:function(e){return{text:this.getDisplayValue(e),value:e}},formatChangeEditValue:function(e){return{text:this.getEditDisplayValue(e),value:e}},getEditDisplayValue:function(e){var t=new Date(e);return"Invalid Date"!=t&&t.format?t.format(this.format):e},onchange:function(e,t,i){t=t||"";var a=this.wrapSetValue(e,t,i),n=this.formatChangeEditValue(a),o=!!this.owner&&this.owner.store;if(o.setFormatValue(i.field,i.model,n),$.isPlainObject(n))for(var r in n)"name"==r||"text"==r?i.model.set(i.field,n[r]):i.model.set(i.field+"__"+r,n[r]);else i.model.set(i.field,n)},_exchangeDayAndMonth:function(e){if(e&&e.setMonth){var t=this.getDisplayFormat(this.editor),i=t.indexOf("M"),a=t.indexOf("d")>=0?t.indexOf("d"):t.indexOf("D");if(i>a){var n=e.getMonth()+1,o=e.getDate()-1;e.setMonth(o),e.setDate(n)}}},wrapSetValue:function(e,t,i){return t&&t.format&&$.isFunction(t.format)?t.format(this.format):t},_getValueByRowData:function(e,t){var i=t+"",a=i+"__value",n=void 0;return e&&(n=e[a],KD.isEmpty(n)&&(n=e[i])),n},getDisplayFormat:function(e){var t,i=KD.getValue(e,"displayFormatString",null),a=KD.getValue(e,"mask",null),n=KD.getValue(e,"format",null);return t=a||i||n,t||this.format},getDisplayValue:function(e,t,i,a){if(e){var n,o;if("string"!=typeof e){var r=new Date(e);return r.format(this.getDisplayFormat(this.editor))}if(e.length>0){KD.getCurrentBrowsType().type==KD.CONST.BrowsType.Chrome&&(e=e.replace("T"," "));var s=kendo.parseDate(e);null==s&&e.length>2&&(s=new Date(e));var r=s;if(r&&"Invalid Date"!=r.toString()){if(n=this.getDisplayFormat(this.editor),o=r.format(n),this.formatConversionList.indexOf(n)>=0){var l=KD.getDateShortCodeComparsionList()||{},d=l[o];d&&(o=d)}return o}return 0==a?"":e}}return""},getDefaultValue:function(){return""}}),KDColumnDescriptorFactory.registerType("datefield",KDDatePickerColumnDescriptor),define("KDDatePickerColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDDatePickerColumnDescriptor}}(this)),KDDateTimePickerColumnDescriptor=KD.extend(KDColumnDescriptor,{format:"yyyy-MM-dd HH:mm:ss",formatConversionList:["ddd","dddd","MMM","MMMM"],getColEditorOption:function(){var e=new KDDateTimePickerProxy,t=e.getGirdEditorOptions(this.editor);return t},formatEditValue:function(e){return{text:e,value:e}},getCellEditorTemplate:function(e,t){return"<input/>"},wrapSetValue:function(e,t,i){return t&&t.format?t.format(this.format):t},_getValueByRowData:function(e,t){var i=t+"",a=i+"__value",n=void 0;return e&&(n=e[a],KD.isEmpty(n)&&(n=e[i])),n},getDisplayFormat:function(e){var t,i=KD.getValue(e,"displayFormatString",null),a=KD.getValue(e,"mask",null),n=KD.getValue(e,"format",null);return t=a||i||n||this.format,t&&t.length>19&&(t.indexOf("f")>=0||t.indexOf("F")>=0)&&(t=t.replace(new RegExp("f","g"),"").replace(new RegExp("F","g"),""),t+="ms"),t},getDisplayValue:function(e,t,i,a){if(!KD.isEmpty(e)){var n,o,r=e;if(KD.isChrome()&&e.replace&&(r=e.replace("T"," ").replace(/-/g,"/")),r=kendo.parseDate(e),null==r&&(r=new Date(e)),r&&"Invalid Date"!=r){if(n=this.getDisplayFormat(this.editor),o=r.format(n),this.formatConversionList.indexOf(n)>=0){var s=KD.getDateShortCodeComparsionList()||{},l=s[o];l&&(o=l)}return o}return 0==a?"":e}return""},getDefaultValue:function(){return""}}),KDColumnDescriptorFactory.registerType("datetimefield",KDDateTimePickerColumnDescriptor),define("KDDateTimePickerColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDDateTimePickerColumnDescriptor}}(this)),KDFileUploadColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDFileUploadProxy,t=e.getGirdEditorOptions(this.editor||{});return this.editor&&(this.editor.isIgnoreFormTheme=!0),this.donotReloadControl=!0,t},getSchemaModel:function(){var e=KDUrlPictureColumnDescriptor.superclass.getSchemaModel.call(this);return e.editable=!0,e},initCellEditorComponent:function(e,t){var i=this,a=i.proxy;if(a){var n=i.isDisabled(t.model);KD.isEmpty(a.autoClosePopup)||($("body").unbind("click",a.autoClosePopup),a.autoClosePopup=void 0),i.beforeInitCellEditorComponent(e,t);var o=$(kendo.format('<div class="kdItemContainer_editorct kd-edit-cell" style="width: 100%;height: 100%;background-color: #f3f3f4;border: none;overflow:visible;color: #333333" data-role="attachmentfield">'));e.append(o),o.attr({id:t.itemid,role:"container","data-field":t.field,"data-rowid":t.model.rowId}),a.el.appendTo(o),$("#"+a.uploadFileListTargetId).remove(),i.editor.uploadFileListTargetId=t.itemid,i.editor.uploadUlFileListTargetId=t.itemid,i.editor.id=t.field,i.editor.ctrltype=KD.getValue(i.editor,"ctrltype",1),a.loadConfig.call(a,i.editor),a.el.removeAttr("id").empty(),a.initComponent.call(a,o),a.setItemContaonerStyle.call(a,i.editor.height?i.editor.height:21),a.el.removeAttr("style").attr({style:"width: 100%;height: 100%;position: absolute;",role:"el"}),a.component.removeAttr("style").attr({style:"position:absolute;padding: 0px 15px 0px 5px; border: 0px; height:"+this.owner.rowHeight+"px; width: 100%; line-height:"+this.owner.rowHeight+"px;top: 50%; margin-top: -"+this.owner.rowHeight/2+"px;",role:"component"}),a.el.find(".ui_kdfilebt").removeAttr("style").attr({style:"position: absolute;top: 50%; margin-top: -10px;",role:"upload"}),i.afterInitCellEditorComponent(e,t),n&&a.setDisabled.call(a,n);var r=e.attr("clicknode");KD.isEmpty(r)||("upload"==r?n||a.el.find(".ui_kdfilebt input").click():"ondrop"==r?n||KD.isEmpty(this.CurrentDragUploadfileEventInfomationCache)||(a._uploadloader&&a._uploadloader.UpLoadAiles&&a._uploadloader.UpLoadAiles(this.CurrentDragUploadfileEventInfomationCache),this.CurrentDragUploadfileEventInfomationCache=void 0):a.component.click())}},attachCellData:function(e,t,i){var a=this,n=(a.getDisable(),{rowId:t});n=a._initOptions(n);var o=$("<div>");a.initCellEditor(o,n);var r=this.proxy;r.el.find(".ui_kdfilebt input").hide(),r.component.addClass("kd-textbox-readonly");var s=o[0].innerHTML;r.el.find(".ui_kdfilebt input").show(),KD.isEmpty(this.preventDocumentDragAction)&&(this.preventDocumentDragAction=function(e){e&&e.preventDefault()},this.owner.el.on({dragleave:this.preventDocumentDragAction,drop:this.preventDocumentDragAction,dragenter:this.preventDocumentDragAction,dragover:this.preventDocumentDragAction}));var l,d={entrykey:this.owner.key,key:i,row:t,id:n.itemid,pageid:this.owner.getPageId()};return d.btnkey="component",l="KD.entryPictureFileClick('"+KD.stringify(d).replace(/\"/g,"&quot;")+"');",s=s.replace('role="component"','onclick="'+l+'"'),d.btnkey="upload",l="KD.entryPictureFileClick('"+KD.stringify(d).replace(/\"/g,"&quot;")+"');",s=s.replace('role="upload"','onclick="'+l+'"'),s=$(s),d.btnkey="ondrop",s.attr("ondrop","KD.entryPictureFileClick('"+JSON.stringify(d)+"');"),s[0].outerHTML},PictureFileClick:function(e,t){if(KD.isObject(e)){var i=this,a=i.owner.gridEl.find("#"+e.id);"ondrop"==e.btnkey&&(this.CurrentDragUploadfileEventInfomationCache=t);var n=a.parent("td");n.attr({clicknode:e.btnkey});var o=this.getOwner(),r=o.getKendoGrid();r&&r.editCell&&!o.isInColSelection&&r.editCell(n)}},getBlockPasteText:function(e){var t=void 0;if(KD.isEmpty(e))return t;var i=this.getFieldName(),a=i+"__value",n=e[a];return n&&KD.isArray(n)&&(t=n),JSON.stringify(t)},_initOptions:function(e){var t=this,i=t.getGridStore();e=e||{},e.field=this.dataIndex;var a=i.getRowDataByServerRowId.call(i,e.rowId)||{rowId:e.rowId},n=(void 0!=a?t.getValueByRowData(a,e.field):"",t._getcellItemKey());return e.editor=i.kdkendoGridCreateEditor,e.field=t.dataIndex,e.model=a,e.itemid=n,e},_getcellItemKey:function(e){var t="";return t=KD.isEmpty(e)?this.getPageId()+"_"+this.getOwnerKey()+"_"+kendo.guid():this.getPageId()+"_"+this.getOwnerKey()+"_"+e},formatEditValue:function(e){if(KD.isString(e))return e;var t="";return KD.isArray(e)&&(t=e.length>1?kendo.format(ResManager.LoadKDString("共添加附件{0}个","099002000000027"),e.length):0==e.length?"":e[0].FileName||""),{text:t,value:e}},getSvrValue:function(e){var t=this.getGridStore(),i=t.getRowDataByServerRowId.call(t,e),a=this.getFieldName(),n=a+"__value";return i?i[n]:void 0},setSvrValue:function(e,t){if(!KD.isString(t)){var i=this.getGridStore(),a=this.getFieldName(),n=a+"__value",o=this.subColDescriptor;o&&(t=o.formatEditValue(t).subValue);this.formatEditValue(t),this.getSvrValue(e);i.updateSvrValue.call(i,e,n,t),i.updateSvrValue.call(i,e,a,t)}}}),KDColumnDescriptorFactory.registerType("attachmentfield",KDFileUploadColumnDescriptor),define("KDFileUploadColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDFileUploadColumnDescriptor}}(this)),KDTimePickerColumnDescriptor=KD.extend(KDDateTimePickerColumnDescriptor,{getColEditorOption:function(){var e=new KDTimePickerProxy,t=e.getGirdEditorOptions(this.editor);return t},formatChangeEditValue:function(e){return{text:this.getEditDisplayValue(e),value:e}},getEditDisplayValue:function(e){var t=new Date(e);return this.proxy.format?t.format(this.proxy.format):t.format("HH:mm:ss")}}),KDColumnDescriptorFactory.registerType("timefield",KDTimePickerColumnDescriptor),define("KDTimePickerColumnDescriptor",["KDDateTimePickerColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDTimePickerColumnDescriptor}}(this)),KDColumnImageDescriptor=KD.extend(KDColumnDescriptor,{getDisplayTemplate:function(e){var t=this,i=e.rowData,a=t.getGridStore(),n=t.getGridStore()?a.revertKendoFieldName(e.field):e.field,o={entrykey:i.gridKey,key:n,row:e.rowId,pageid:t.getPageId()},r=e.value,s="";s=this.IsPicture(r)?r&&r.indexOf("../")>=0?KD.IsNullOrWhiteSpace(r)?"Content/themes/images/icon_picDefault.png":r:KD.IsNullOrWhiteSpace(r)?"Content/themes/images/icon_picDefault.png":"../"+r:KD.isBase64Str(r)?KD.IsNullOrWhiteSpace(r)?"Content/themes/images/icon_picDefault.png":"data:image/jpeg;base64,"+r:KD.IsNullOrWhiteSpace(r)?"Content/themes/images/icon_picDefault.png":KD.getUrlRoot()+"/"+r,(!KD.IsNullOrWhiteSpace(r)&&0==r.indexOf("/")||0==r.indexOf("http"))&&(s=r);var l='<span style="text-align:center;height:26px;" class="kd-grid-cellspan" ><img onclick=\'KD.entryButtonClick('+JSON.stringify(o)+");'  style='height:inherit;' src='"+s+"'/></span>";return l},IsPicture:function(e){var t=".jpeg|.gif|.jpg|.png|.bmp|.pic|.ico|";if(e.indexOf(".")>-1){var i=e.lastIndexOf("."),a=e.substring(i,this.length)+"|";if(a=a.toLowerCase(),t.indexOf(a)>-1)return!0}return!1}}),KDColumnDescriptorFactory.registerType("kdpicture",KDColumnImageDescriptor),define("KDColumnImageDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDColumnImageDescriptor}}(this)),KDUrlPictureColumnDescriptor=KD.extend(KDColumnDescriptor,{defaultnoneimg:"Content/themes/images/icon_picDefault.png",defaultFileFilter:"*.png|*.jpg|*.jpeg",getColEditorOption:function(){var e=new KDPictureProxy,t=e.getGirdEditorOptions(this.editor||{});return this.donotReloadControl=!0,t},getDisplayValue:function(e,t,i){var a=this,n=a.getGridStore(),o=KD.urlDecodeComponent(e||""),r=this.exDownloadUrl?!0:!1,s=n.rowHeight;if(34>s){var l=a.getFormProxy();(l.dformConfig||l.config).isUseSmallScreenModel||(s=34)}KD.IsNullOrWhiteSpace(o)?imgSrc=this.defaultnoneimg:r?imgSrc=this.getFileServerDownUrl(o,this.exDownloadUrl,!0):KD.isBase64Str(o)?imgSrc="data:image/jpeg;base64,"+o:imgSrc=KD.isUrl(o)?o:KD.getUrlRoot()+"/"+o;var d={entrykey:this.owner.key,key:this.getFieldName(),row:t,pageid:this.owner.getPageId()},c=KD.format('<span style="height:{0}px;line-height:{0}px;" class="kd-grid-cellspan kd-grid-cellspan-image-container" ><img class=\'kd-grid-cellspan-image\' onclick=\'KD.entryButtonClick('+JSON.stringify(d)+");' src='{1}'/></span>",s,imgSrc);return c},getDisplayTemplate:function(e){e=e||{};var t=this,i=t.getOwner(),a=t.getGridStore(),n="min-height:"+a.rowHeight+"px;",o=e.disable,r=i.isViewGrid(),s=o&&!r?"k-gridCellstate-disabled":"",l=e?e.value||"":"",d={fcolor:e.forecolor,bcolor:e.backcolor};e.hiddenEnabled&&e.hiddenMask&&(fieldValue=e.hiddenMask);var c=e.tooltipIndicatorEnabled;KD.isEmpty(c)&&(c=!0);var h=e.tooltipEnabled?e.tooltip||l:"",u=h?' title="'+h+'"':"",p=h&&c?'<span class="kd-grid-tipflag"></span>':"",g=t.getIsRedBlue()||a.isRedBlue?t.redBlueCls||"":"",f=KD.isEmpty(d.bcolor)?"":"background-color:"+KD.formatHtmlColor(d.bcolor)+";",m=KD.isEmpty(d.fcolor)?"":"color:"+KD.formatHtmlColor(d.fcolor)+";",v=e.hasError?"border: 1px solid #FD0F15;":"";n=kendo.format("{0}{1}{2}{3}",n,f,m,v);var y=KD.isEmpty(d.bcolor)?"":"kd-grid-cellspan-opacity",b=kendo.format('<span class="{0} kd-grid-cellspan {1} {6}" style="{2};" {3}>{4}{5}</span>',g,s,n,u,l,p,y);return b},getSchemaModel:function(){var e=KDUrlPictureColumnDescriptor.superclass.getSchemaModel.call(this);return e.editable=!1,e},getCellEditorTemplate:function(e,t){return'<div style="text-align: center;"></div>'},initCellEditor:function(e,t){},createTemplate:function(e){var t=this,i=t.getGridStore(),a=e&&e.backcolor,n=e&&e.forecolor,o=e&&e.disable,r="min-height:"+i.rowHeight+"px;";if(o)return KDUrlPictureColumnDescriptor.superclass.createTemplate.call(this,e);var s=e.field,l=t.getOwner(),d=e.rowData,c=d.rowId,h=i.getRowDataByServerRowId.call(i,c);if(void 0===h)return"";t.isTreeExpander()&&(r+="display: inline;",a="");var u=l.isViewGrid(),p=o&&!u?"k-gridCellstate-disabled":"",g="",f=t.getIsRedBlue()?t.redBlueCls||"":"",m=void 0!=h?t.getValueByRowData(h,s):"";~(this.allowHtmlCell?m:KD.htmlUtil.encode(m)).search(/\r\n|\n/g)&&(r+="line-height:"+i.rowHeight/2+"px;");var v,y=ClientAppProxy.Current.IsIgnoreGridCellColorTrans?"kd-grid-celldiv-ignorecellopcity":"";if(a){var b=b=n?"color:"+n+";":"color:#000000;";(void 0==o||0==o)&&(b="",a=""),v="background-color:"+KD.formatHtmlColor(a)+";text-align:"+t.getTextAlign()+";"+r+b,g=kendo.format('<div class="{0} kd-grid-celldiv {1} {2}" style="{3}"><span class="kd-grid-cellspan" style="{4}"></span></div>',f,p,y,v,r)}else{var b=n?"color:"+KD.formatHtmlColor(n)+";":"";v=r+b+"; text-align:"+t.getTextAlign()+";",g=kendo.format('<span class="{0} kd-grid-cellspan {1}" style="{2}"></span>',f,p,v)}return g},getAttributesClass:function(){var e=KDUrlPictureColumnDescriptor.superclass.getAttributesClass.call(this);return e+=" kd-grid-image-container"},showDownPictureClick:function(e,t){if(KD.isEmpty(e))return e;var i=$(e);t.isdown=!0;var a="onclick='KD.entryPictureFileClick("+JSON.stringify(t)+");'",n=$(kendo.format('<div class="KDImageEditIconContainer-down"><span id="{0}_down"  alt="down" title="{1}" class="kd-grid-KDImageEditIcon-down" style="background-image:url({3});" {2}></span></div>',t.id,ResManager.LoadKDString("下载","014005030037576"),a,KD.getImageUrlByNameAndVersion("kd_icon_extend.png")));return i.find(".kd-grid-cellspan-image").after(n),i[0].outerHTML},attachCellData:function(e,t,i){var a=KDUrlPictureColumnDescriptor.superclass.attachCellData.call(this,e,t,i),n=this,o=n.getGridStore();if(n.getDisable()&&n.owner.isViewGrid())return a;var r=o.getRowDataByServerRowId.call(o,t),s=void 0!=r?n.getValueByRowData(r,i):"",l=KD.urlDecodeComponent(s||""),d=this.exDownloadUrl?!0:!1;KD.IsNullOrWhiteSpace(l)?imgSrc=this.defaultnoneimg:d?imgSrc=this.getFileServerDownUrl(s,this.exDownloadUrl,!0):KD.isBase64Str(l)?imgSrc="data:image/jpeg;base64,"+l:imgSrc=KD.isUrl(l)?l:KD.getUrlRoot()+"/"+l;var c=KD.parseObject(KD.stringify(this.editor)),h=this.getOwner(),u=h.getControlFactoryProxy(),o=this.getGridStore();$.extend(c,{isDynamicCreated:!0,isKeyInputCell:this.isKeyInputCell(t),zoomIn:h.isEditorZoomIn,id:this.owner.baseId+"_"+this.getFieldName()+"_"+t});var p=KD.parseObject(KD.stringify(c)),g=this.proxy=u.createControl.call(u,p);g.setControlFactoryProxy(u),g.postKey=this.getFieldName(),g.columnDescriptor=this,g.setRow.call(g,t);var f=g.getKendoOptions();f.imgsrc=imgSrc,f.isinitelemnt=!0,f.height=f.width=o.rowHeight,f.isCanDownland=KD.getValue(p,"iscandownland",!0),n.fileFilter=KD.getValue(p,"filefilter",n.defaultFileFilter),f.fileFilter=n.fileFilter;var m=f.baseId,v={entrykey:this.owner.key,key:i,row:t,id:m,pageid:this.owner.getPageId()};if(n.getDisable())return f.isCanDownland?n.showDownPictureClick(a,v):a;var y=$(a).kendoKDImageEdit(f),b=$(y);b.addClass("kd-grid-cellpiceditor"),this.celleditorMap=this.celleditorMap||{},this.celleditorMap[m]=!1,KD.isEmpty(this.preventDocumentDragAction)&&(this.preventDocumentDragAction=function(e){e&&e.preventDefault()},this.owner.el.on({dragleave:this.preventDocumentDragAction,drop:this.preventDocumentDragAction,dragenter:this.preventDocumentDragAction,dragover:this.preventDocumentDragAction}));var D=KD.cloneObject(v);D.open=!0,b.find("#"+m+"_open").attr("onclick","KD.entryPictureFileClick('"+JSON.stringify(D)+"');").addClass("kd-grid-KDImageEditIcon");var k=KD.cloneObject(v);k.drop=!0,b.attr("ondrop","KD.entryPictureFileClick('"+JSON.stringify(k)+"');");var C=KD.cloneObject(v);C.ctlkey=n.proxy&&n.proxy.key,b.attr("onmouseover","KD.entryPictureFieldHover('"+JSON.stringify(C)+"');");var x=KD.cloneObject(v);x.isdown=!0,b.find("#"+m+"_down").attr("onclick","KD.entryPictureFileClick('"+JSON.stringify(x)+"');").addClass("kd-grid-KDImageEditIcon");var w=$.extend(v,{isclear:!0});b.find("#"+m+"_clear").attr("onclick","KD.entryPictureFileClick('"+JSON.stringify(w)+"');").addClass("kd-grid-KDImageEditIcon");var K=$.extend(v,{ispicview:!0,isclear:!1}),S=2,I=o.rowHeight-2*S;b.find("#"+m+"_c").addClass("kd-grid-cellspan-image").css({"max-height":I+"px",margin:S+"px auto"}).attr("onclick","KD.entryPictureFileClick('"+JSON.stringify(K)+"');");var P=b.find(".kd-grid-KDImageEditIcon").length,F=16*P+3*(P+1)+"px";b.find(".KDImageEditIconContainer").css({margin:"0 auto",bottom:"-5px",width:F,height:"20px"}),b.find(".KDImageEditTBContainer").css({bottom:"auto",top:"2px",width:"auto"});var T=ResManager.LoadKDString("支持ctrl+v粘贴截图","014005030043951");return b.attr("title",T),b.length>0?b[0].outerHTML:""},_PictureFileClickCallback:function(e,t){e!=KDMessageBox.KDDialogResult.Ok&&e!=KDMessageBox.KDDialogResult.Yes||!this.PictureFileClick||(t.isdeletefile=!0,this.PictureFileClick(t))},PictureFileClick:function(e,t){if(e.isclear){if(e.isdeletefile)this.setValue(e.row,""),$("#"+e.id+"_c").attr("src",this.defaultnoneimg),this.owner.el.find("#"+e.id+"_file").val("");else if(!KD.isEmpty(this.getValue(e.row))){var i={name:ResManager.LoadKDString("金蝶提示","099002000000002"),msg:ResManager.LoadKDString("确定删除吗?","0991733000005634"),type:KDMessageBox.KDMesBoxType.Question,button:KDMessageBox.KDMessageBoxButtons.OkCancel,callback:this._PictureFileClickCallback,callbackentity:this,args:e};KDMessageBox.show(i)}}else if(e.isdown){var a=this.getFormProxy();if(!KD.isEmpty(a)&&!KD.isEmpty(e.row)&&e.key){var n=this.getValue(e.row),o={};o.row=e.row,o.ServerFileName=KD.isEmpty(n)?"":n,a.fireCustomEventsNoData(e.key,"Kingdee.BOS.ImageDownload",KD.stringify(o))}}else{var r=this.editor.exExtandUrl,s=this.editor.upurl;""==r||KD.isUrl(r)||(r=KD.getUrlRoot()+"/"+r),""==s||KD.isUrl(s)||(s=KD.getUrlRoot()+"/"+s);var l=!0;if(""==r&&(l=!1),l=""!=s?!0:!1,e.ispicview){var d=this.getValue(e.row);return void(d&&""!=d&&l&&KD.entryLinkBtnClick({entrykey:e.entrykey,key:e.key,row:e.row,pageid:e.pageid}))}var c=e.id+"_file",h=this.celleditorMap[e.id];h||(this.celleditorMap[e.id]=!0,e.url=r,e.isfileserver=l,e.auto=l,e.exDownloadUrl=this.editor.exDownloadUrl,e.UpUrl=s,this._uploadloader=this.intiUploadloader(e)),e.open&&$("#"+c).click(),e.drop&&!KD.isEmpty(t)&&this._uploadloader&&this._uploadloader.UpLoadAiles&&this._uploadloader.UpLoadAiles(t)}},getFileServerDownUrl:function(e,t,i){var a=t;return""==a?a:(KD.isUrl(a)||""==a||(a=KD.getUrlRoot()+"/"+a),i&&(a+=t.indexOf("?")>=0?"&":"?",a+=kendo.format("fileId={0}&dbId={1}&nail=1&t={2}&token={3}",e,ClientAppProxy.Current.CTX.DBid,(new Date).valueOf(),KD.getUserToken())),a)},intiUploadloader:function(e){var t=this;return new KDFileUpLoader({baseid:e.id,fileInputButton:$("#"+e.id+"_file"),fileTypeExts:t.fileFilter,datarow:e.row,itemTemplate:"",url:e.url,UpUrl:e.UpUrl,exDownloadUrl:e.exDownloadUrl,maxFileLength:0,auto:e.auto,isfileserver:e.isfileserver,multi:!1,onBeforeSelectFile:function(e){return"undefined"==typeof FileReader?(alert(ResManager.LoadKDString("抱歉，您的浏览器不支持 FileReader，请使用现代浏览器操作！","099002000000056")),!1):!0},onUploadError:function(e,i,a){var n=t.getFormProxy();null!=n?n.showErrMsgStr(a):KD.Error.raise({msg:a})},onFileItemsChanged:function(e){var i=e.option.isfileserver;if(e.files&&e.files.length>0&&!i){var a=new FileReader;a.readAsDataURL(e.files[0]),a.onload=function(e){t.setValue(e.option.datarow,this.result.substr(this.result.indexOf(",")+1))}}},onFileStateChanged:function(e){var i=e.option.isfileserver;if(i){var a=e.target.fileState;if(e.state==a.Uploaded&&e.uploadedfiles&&e.uploadedfiles.length>0){t.setValue(e.option.datarow,e.uploadedfiles[0].ServerFileName);var n=t.getFileServerDownUrl(e.uploadedfiles[0].ServerFileName,e.option.exDownloadUrl,i);$("#"+e.option.baseid+"_c").attr("src",n)}}}})},getBlockPasteText:function(e){if(KD.isEmpty(e))return"";var t=this.getFieldName();return e[t]?e[t]:""}}),KDColumnDescriptorFactory.registerType("kdurlpicfield",KDUrlPictureColumnDescriptor),KDColumnDescriptorFactory.registerListType("kdurlpicfield",KDUrlPictureColumnDescriptor),KDColumnDescriptorFactory.registerType("kdpicture",KDUrlPictureColumnDescriptor),KDPicFileSvrColumnDescriptor=KD.extend(KDColumnDescriptor,{formatEditValue:function(e){var t;return t=KD.isArray(e)?{text:e[0],value:e[1]}:KDPicFileSvrColumnDescriptor.superclass.formatEditValue.call(this,e)},getColEditorOption:function(){var e=new KDPictureProxy,t=e.getGirdEditorOptions(this.editor||{});return this.donotReloadControl=!0,t},getDisplayValue:function(e,t,i){var a=this,n=a.getGridStore(),o={entrykey:i.gridKey,key:this.dataIndex,row:t,pageid:a.getPageId()},r=n.rowHeight;if(34>r){var s=a.getFormProxy();(s.dformConfig||s.config).isUseSmallScreenModel||(r=34)}var l=KD.urlDecodeComponent(e||""),d=KD.isUrl(l)?l:KD.IsNullOrWhiteSpace(l)?"Content/themes/images/icon_picDefault.png":KD.getUrlRoot()+"/"+l,c=KD.format('<span style="height:{0}px;line-height:{0}px;" class="kd-grid-cellspan kd-grid-cellspan-image-container" ><img class=\'kd-grid-cellspan-image\' onclick=\'KD.entryButtonClick('+JSON.stringify(o)+");' src='{1}'/></span>",r,d);return c}}),KDColumnDescriptorFactory.registerType("kdpic2field",KDPicFileSvrColumnDescriptor),KDColumnDescriptorFactory.registerListType("kdpic2field",KDPicFileSvrColumnDescriptor),KDPicBase64ColumnDescriptor=KD.extend(KDColumnDescriptor,{formatEditValue:function(e){var t;return t=KD.isArray(e)?{text:e[0],value:e[1]}:KDPicBase64ColumnDescriptor.superclass.formatEditValue.call(this,e)},getColEditorOption:function(){var e=new KDPictureProxy,t=e.getGirdEditorOptions(this.editor||{});return this.donotReloadControl=!0,t},getDisplayValue:function(e,t,i){var a=this,n=a.getGridStore(),o={entrykey:i.gridKey,key:this.dataIndex,row:t,pageid:a.getPageId()},r=n.rowHeight;if(34>r){var s=a.getFormProxy();(s.dformConfig||s.config).isUseSmallScreenModel||(r=34)}var l="";l=KD.isUrl(e)?e:KD.isBase64Str(e)?KD.IsNullOrWhiteSpace(e)?"Content/themes/images/icon_picDefault.png":"data:image/jpeg;base64,"+e:KD.IsNullOrWhiteSpace(e)?"Content/themes/images/icon_picDefault.png":KD.getUrlRoot()+"/"+e;var d=KD.format('<span style="height:{0}px;line-height:{0}px;" class="kd-grid-cellspan kd-grid-cellspan-image-container" ><img class=\'kd-grid-cellspan-image\' onclick=\'KD.entryButtonClick('+JSON.stringify(o)+");' src='{1}'/></span>",r,l);return d}}),KDColumnDescriptorFactory.registerType("kdpicfield",KDPicBase64ColumnDescriptor),KDColumnDescriptorFactory.registerListType("kdpicfield",KDPicBase64ColumnDescriptor),KDColumnDescriptorFactory.registerType("kdpicfield_kdpicture",KDPicBase64ColumnDescriptor),define("KDUrlPictureColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDUrlPictureColumnDescriptor}}(this)),KDPopupColorColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDPopupColorProxy,t=e.getGirdEditorOptions(this.editor);return this.donotReloadControl=!0,t},formatEditValue:function(e){return{text:this.getDisplayValue(e),value:this.formatSLColor(e)}},afterInitCellEditorComponent:function(e,t){KDPopupColorColumnDescriptor.superclass.afterInitCellEditorComponent.call(this,e,t);var i=$(".k-selected-color",$(e));i.width($(e).width()-26)},getDisplayValue:function(e){var t=e||"";return this.displayValue=this.formatSLColor(t),this.displayValue},createTemplate:function(e){var t=KDPopupColorColumnDescriptor.superclass.createTemplate.call(this,e);t=$(t).css({"background-color":KD.IsNullOrWhiteSpace(this.displayValue)?"":"#f3f3f4",width:"70%"});var i=$(kendo.format("<div style='background-color:{0}'></div>",this.formatHtmlColor(this.displayValue)));return i.append(t),i},getCellEditorTemplate:function(e,t){return"<span></span>"},formatHtmlColor:function(e){return KD.IsNullOrWhiteSpace(e)?e:(e=e.trim(),e=e.length>7?e.replace("#FF","#").toUpperCase():e.toUpperCase())},formatSLColor:function(e){if(KD.IsNullOrWhiteSpace(e))return e;e=e.trim();var t="";return t=e.length>7?e.toUpperCase():"#FF"+e.replace("#","").toUpperCase()}}),KDColumnDescriptorFactory.registerType("kdpopupcolor",KDPopupColorColumnDescriptor),define("KDPopupColorColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDPopupColorColumnDescriptor}}(this)),KDLangFieldColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDMultiLangBoxProxy,t=e.getGirdEditorOptions(this.editor);return t},formatEditValue:function(e){return{text:this.getDisplayValue(e),value:this.getRealValue(e)}},storeValue:{},getStoreValue:function(){if(this.storeValue.length<=0)for(var e=ClientAppProxy.Current.getLocals(),t=0;t<e.length;t++){var i=e[t];this.storeValue[i.lang]=""}return this.storeValue},getDefaultLangId:function(){return ClientAppProxy.Current.defaultLocalId},getCurrentLangId:function(){return this.proxy&&this.proxy.getCurrentLangId&&""!=this.proxy.getCurrentLangId()?this.proxy.getCurrentLangId():this.getDefaultLangId()},wrapSetValue:function(e,t,i){var a=i.model[i.field+"__value"],n=[];n.push({Key:this.getCurrentLangId(),Value:t});for(var o=0;o<a.length;o++){var r={Key:a[o].Key,Value:a[o].Value};a[o].Key!=this.getCurrentLangId()&&n.push(r)}return n},getDisplayValue:function(e){var t="";if($.isArray(e))for(var i=0;i<e.length;i++){var a=e[i];if(a.Key==ClientAppProxy.Current.defaultLocalId){t=a.Value;break}}else"object"==typeof e?e[ClientAppProxy.Current.defaultLocalId]&&(t=e[ClientAppProxy.Current.defaultLocalId]):t=e;return KD.isThreatText(t)?KD.htmlUtil.encode(t):t},getRealValue:function(e){var t=[],i={};if($.isArray(e))for(var a=0;a<e.length;a++){var n=e[a];i[n.Key]=n.Value}else if("object"==typeof e)for(var n in e)i[n]=e[n];else i[this.getDefaultLangId()]=e;for(var o in i)t.push({Key:o,Value:i[o]});return t},getSvrValue:function(e){
var t=this.getGridStore(),i=t.getRowDataByServerRowId.call(t,e),a=this.getFieldName(),n=a+"__value";return i?i[n]:void 0},setSvrValue:function(e,t){var i=this.getGridStore(),a=this.getFieldName(),n=a+"__value",o=this.subColDescriptor;o&&(t=o.formatEditValue(t).subValue);var r=this.formatEditValue(t),s=(r.value,this.getSvrValue(e));s&&(i.updateSvrValue.call(i,e,n,r.value),i.updateSvrValue.call(i,e,a,r.text))},afterInitCellEditorComponent:function(e,t){var i=t.model.get(t.field+"__value");this.owner&&"kdtreegrid"==this.owner.xtype&&(i=this.getSvrValue(t.model.rowId)),this.proxy.setValue(i)},getCellEditorTemplate:function(e,t){return"<div>"}}),KDColumnDescriptorFactory.registerType("kdlangtextfield",KDLangFieldColumnDescriptor),define("KDLangFieldColumnDescriptor",["KDColumnDescriptor","KD","KDMultiLangBoxProxy"],function(e){return function(){var t;return t||e.KDLangFieldColumnDescriptor}}(this)),KDLangAreaColumnDescriptor=KD.extend(KDLangFieldColumnDescriptor,{getColEditorOption:function(){var e=new KDMultiLangAreaProxy,t=e.getGirdEditorOptions(this.editor);return t},getCellEditorTemplate:function(e,t){return"<div>"}}),KDColumnDescriptorFactory.registerType("kdlangtextarea",KDLangAreaColumnDescriptor),define("KDLangAreaColumnDescriptor",["KDLangFieldColumnDescriptor","KD","KDMultiLangAreaProxy"],function(e){return function(){var t;return t||e.KDLangAreaColumnDescriptor}}(this)),KDPropertyColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){},formatEditValue:function(e){return{text:this.getDisplayValue(e),value:e}},createCellCustEditor:function(e,t){var i=this.getOwner.call(this),a=i.getControlFactoryProxy.call(i),n=this.getSvrValue.call(this,e),o=this.getGridStore(),r=o.visualRows[e],s=o.CellEditorProperty[r.PropertyKey];s.id=r.PropertyKey;var l=a.createControl.call(a,s);return l.isInit=!0,l.parentProxy=i,l.setRow.call(l,e),l.setIsGridEditor.call(l,!0),this.editorProxy=l,t.elem=l.getControl.call(l),t.elem.appendTo($(t.cell)),l.loadConfig.call(l,s),l.initComponent.call(l),l.setValue.call(l,n),"bosf7field"==s.xtype&&(l.beforeOpenPrompt=function(){var e=l;if(1!=e.disabled){var t=e.getCommitData(this.component.val()),i=e.getFormProxy(),a="object"==typeof t.value&&null!=t.value?t.value.number:t.value;return i&&i.fireEvent.call(i,"F7ButtonClick",t.key,a,0),!0}},l.onkeyup=function(e){return!0}),l.editor_DefaultButtonClick&&(l.editor_DefaultButtonClick=function(){var e=this.getFormProxy();e&&e.fireEvent.call(e,"F7ButtonClick",this.postKey,this.component.val(),0)}),t.editorProxy=l,t.colDesc=this,i.activeEditor=l,KD.delayInvoke(function(){l.isRelease||l&&l.component&&l.component.focus()},0),!0},getDisplayHTML:function(e){var t=this._getCellDescrip(e);return t.getDisplayHTML.call(this,e)},getDisplayValue:function(e,t){var i=this._getCellDescrip(t);return i.getDisplayValue(e)},_getCellDescrip:function(e){this.CellDescripArray=this.CellDescripArray||new Array;var t=e,i=this.getGridStore(),a=i.visualRows[t],n=null;if(this.CellDescripArray[a.PropertyKey])n=this.CellDescripArray[a.PropertyKey];else{var o=i.CellEditorProperty[a.PropertyKey];n=KDColumnDescriptorFactory.create({id:"temp",dataIndex:"tempIndex",editor:o},this),this.CellDescripArray[a.PropertyKey]=n}return n},clearCellCustEditor:function(e,t){var i=this.getSvrValue.call(this,e),a=this.getDisplayValue.call(this,i,e),n={html:a,cellOptions:{}};this.getDisplayHTML&&(n=this.getDisplayHTML.call(this,e));var o="";if(!KD.IsNullOrWhiteSpace(n.html))try{o=$(n.html)}catch(r){o=""}return o.length?o.appendTo($(t.cell)):$(t.cell).text(n.html),!0}}),KDColumnDescriptorFactory.registerType("propertyfield",KDPropertyColumnDescriptor),define("KDPropertyColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDPropertyColumnDescriptor}}(this)),KDPasswordFiledColumnDescriptor=KD.extend(KDColumnDescriptor,{getColEditorOption:function(){var e=new KDPasswordFiledProxy,t=e.getGirdEditorOptions(this.editor);return t},initCellEditorComponent:function(e,t){if(this.proxy){var i=this.isDisabled(t.model);if(i){var a=this.getTemplate(t.field,t.model);return void $(a).appendTo(e)}this.beforeInitCellEditorComponent(e,t),this.proxy.initCellComponent.call(this.proxy,this.proxy.component),this.proxy.component.appendTo(e),this.afterInitCellEditorComponent(e,t),e&&e.addClass("kd-edit-cell")}},_getSvrValue:function(e){var t=this.getGridStore(),i=t.getRowDataByServerRowId.call(t,e),a=this.getFieldName()+"__value";return i?i[a]:void 0},afterInitCellEditorComponent:function(e,t){var i=this,a=t.model.rowId,n=i._getSvrValue(a),o=t.field,r=this.proxy&&this.proxy.component;r&&r.length>0&&(r.attr("data-field",o).attr("data-rowId",a),this.proxy.setValue(n))},formatEditValue:function(e){return{text:this.getDisplayValue(e),value:e}},getDisplayValue:function(e){for(var t="",i=0;i<e.length;i++)t+="*";return t}}),KDColumnDescriptorFactory.registerType("passwordbox",KDPasswordFiledColumnDescriptor),define("KDPasswordFieldColumnDescriptor",["KDColumnDescriptor","KD"],function(e){return function(){var t;return t||e.KDPasswordFieldColumnDescriptor}}(this)),function(e){KDGridFormatInfo=function(e){this.config=e},e.extend(KDGridFormatInfo,{C_NumFmtInfo:"NumFmtInfo",C_NumType:"numtype",C_NumType_C:"C",C_NumType_N:"N",C_FmtInfoNumber:"numfmtinfo",C_FmtInfoCurrency:"currencyfmtinfo",C_FmtInfoFieldMap:"FieldMap",C_FmtInfoValueMap:"ValueMap"}),KDGridFormatInfo.prototype={config:null,baseFormatInfo:null,baseFormatInfoStr:"",realFormatInfoMap:{},init:function(){this.realFormatInfoMap={}},getCacheKey:function(e,t){return KD.IsNullOrWhiteSpace(e)?"Value||"+t:"Field||"+e},isEmpty:function(){return!this.config},getBaseFormatInfo:function(){if(null==this.baseFormatInfo&&!this.isEmpty()){this.baseFormatInfo={};var e=this;for(var t in this.config)KD.equalsIgnoreCase(t,KDGridFormatInfo.C_FmtInfoValueMap)||KD.equalsIgnoreCase(t,KDGridFormatInfo.C_FmtInfoFieldMap)||(e.baseFormatInfo[t]=e.config[t]);var i=this.config[KDGridFormatInfo.C_FmtInfoFieldMap];if(i){var a={};for(var t in i)a[t]=i[t];this.config[KDGridFormatInfo.C_FmtInfoFieldMap]=a}this.baseFormatInfoStr=KD.stringify(this.baseFormatInfo)}return this.baseFormatInfo},getBaseFormatInfoClone:function(){var e={};return this.getBaseFormatInfo(),e=KD.IsNullOrWhiteSpace(this.baseFormatInfoStr)?{}:KD.parseObject(this.baseFormatInfoStr)},getFormatInfoByValue:function(e){return this.getFormatInfo("",e)},getFormatInfoByField:function(e){return this.getFormatInfo(e,"")},getFormatInfo:function(t,i){var a=this,n=a.getCacheKey(t,i),o=a.realFormatInfoMap[n];if(!a.isEmpty()&&!o){o=a.getBaseFormatInfoClone();var r=a.config[KDGridFormatInfo.C_FmtInfoFieldMap]||{},s=a.config[KDGridFormatInfo.C_FmtInfoValueMap]||{},l=null;if(KD.IsNullOrWhiteSpace(t))l=s[i]||{};else{var d=r[t]||"";l=s[d]||{}}o=e.extend(o,l),a.realFormatInfoMap[n]=o}return o},mergeFormatInfo:function(t){var i=!1;if(null==t||0==t.Count)return i;if(null==this.config)this.config=t,i=!0;else{var a=this.config[KDGridFormatInfo.C_FmtInfoFieldMap]||{},n=this.config[KDGridFormatInfo.C_FmtInfoValueMap]||{},o=t[KDGridFormatInfo.C_FmtInfoFieldMap],r=t[KDGridFormatInfo.C_FmtInfoValueMap];i=void 0!=o;var s=void 0!=r;i&&e.extend(a,o),s&&e.extend(n,r),(i||s)&&(this.realFormatInfoMap={})}return i}}}(jQuery),function(e){KDStore=function(){},$.extend(KDStore,{C_SelColKey:"SELECTED",C_SelXType:"colSelector",C_SelModelXType:"colSelectorModel",C_BulkDataLimit:200,C_HeadCheckAllRowId:-99,isColSelector:function(e){var t=(e||"").toUpperCase();return t==KDStore.C_SelColKey}}),KDStore.prototype={isRedBlue:!1,selColDescriptor:null,defaultDisabeCellForeground:null,setOwner:function(e){this.owner=e},getOwner:function(){return this.owner},getIndexKey:function(){return this.serverIndexFieldName},getSeqKey:function(){return this.seqFieldName},getKeyInputFieldName:function(){return this.keyInputFieldName},converFieldName:function(e,t){return e},isEditable:function(){var e=this.getOwner();return e&&e.isEditable.call(e)},isViewGrid:function(){return this.config&&"VIEWGRID"==this.config.gridtype},isBulkData:function(){var e=this,t=e.selColDescriptor,i=t?t.isBulkData.call(t):!1;return i},isSelColEnable:function(){var e=this.getOwner();return e&&e.isSelColEnable.call(e)},setIsRedBlue:function(e){this.isRedBlue=e},loadConfig:function(e){this.config=e,this.serverIndexFieldName=e.indexKey||"",this.seqFieldName=e.seqKey,this.keyInputFieldName=e.keyInputField,this.isRowVisibleCallBack=e.isRowVisibleCallBack},initColSelectorModelConfig:function(e){var t=!1,i=null;if(e&&e.length){var a=e[e.length-1];KDStore.isColSelector(a.dataIndex)&&(e.splice(e.length-1,1),t=!0)}if(i=this.isSelColEnable()?KDSelectedColumnDescriptor.getColConfig(this.selColIndex):KDSelectedModelColumnDescriptor.getColConfig(this.selColIndex),e.push(i),t&&this.selColDescriptor){var n=this.selColDescriptor;n.release.call(n),n=this.selColDescriptor=KDColumnDescriptorFactory.create(i,this),n.setOwner(this.owner);var o=this.converFieldName(n.dataIndex).toUpperCase();this.colDescripersNameMap[o]=n,this.visibleCols&&this.visibleCols.length&&(KDStore.isColSelector(this.visibleCols[0].dataIndex)?n.isVisible.call(n)?this.visibleCols[0]=n:this.visibleCols.splice(0,1):n.isVisible.call(n)&&this.visibleCols.unshift(n))}},createColumnModel:function(t){this.colDescripersNameMap={},this.visibleCols=[],this.baseFields={},this.selColIndex=t.length,this.initColSelectorModelConfig(t);var i=this.getSeqKey(),a=this.getIndexKey(),n=this.getOwner(),o=n.config;for(var r in t){var s=t[r];KDStore.isColSelector(s.dataIndex)?s.visibleIndex=0:s.visibleIndex=s.colIndex+1;var l=KDColumnDescriptorFactory.create(s,this);l.setOwner(this.owner),l.isKeyInput=s.dataIndex==this.getKeyInputFieldName(),l.allowHtmlCell=this.config?this.config.allowHtmlCell:void 0,KDStore.isColSelector(s.dataIndex)&&(this.selColDescriptor=l);var d=this.converFieldName(l.dataIndex).toUpperCase();this.colDescripersNameMap[d]=l,(s.visible||void 0==s.visible)&&this.visibleCols.push(l),l.isF7&&(this.baseFields[l.getFieldName.call(l)]=!0,this.baseFields[l.getKendoFieldName.call(l)]=!0),e.isEmpty(i)||i!=l.getKendoFieldName()?!e.isEmpty(i)||e.isEmpty(a)||a!=l.getKendoFieldName()||e.isEmpty(o.groupColumnsInfo)||l.setSort(1,!0):l.setSort(1,!0)}if(this.visibleCols.length>0){if(this.visibleCols=e.quickSort(this.visibleCols,"visibleIndex"),e.isEmpty(this.frozenObj))return;for(var c,h,u=this.frozenObj.left||"",p=this.frozenObj.right||"",r=0;r<this.visibleCols.length;r++){var g=this.visibleCols[r];if(g){var f=g.getFieldName(g);f.toUpperCase().trim()==u.toUpperCase().trim()&&(c=r),f.toUpperCase().trim()==p.toUpperCase().trim()&&(h=r)}}for(var r=0;c>=r;r++){var g=this.visibleCols[r];g&&g.locked.call(g,!0)}}},setFrozenObj:function(e){this.frozenObj=e},setData:function(e,t){var i=this;i.clearStates(),i.rows=[],i.visualRows=[],e=e?e:{rows:[]},i.appendRows(e.rows,t),i.currentData=e,i.setSummaryColumns(e.sumColums),i.setSummaryData(e.summary),i.setFmtInfo(e)},setUpdateView:function(e){this.updateView=e},setSummaryColumns:function(e){if(this.setUpdateView(!0),$.isArray(e)){for(var t=[],i=0;i<e.length;i++){var a=e[i],n={fieldKey:a.fieldKey,sumType:a.summaryType};t.push(n)}for(var o=this.config.groupColumnsInfo=this.config.groupColumnsInfo||[],r=-1,i=0;i<o.length;i++){var a=o[i];for(var s in a)if("groupSumColums"==s){r=i;break}}0>r?o.push({groupSumColums:t}):o[r]={groupSumColums:t}}},setSummaryData:function(e){if($.isPlainObject(e)){this.sumData=this.sumData||{};for(var t in e)this.sumData[t]=e[t]}},clearSummaryData:function(){this.sumData&&(this.sumData={})},setFmtInfo:function(t){var i=t[KDGridFormatInfo.C_FmtInfoCurrency],a=e.parseObject(i);a=e.parseObject(i),i=t[KDGridFormatInfo.C_FmtInfoNumber],$.extend(a,i),this.currencyFormatInfo=new KDGridFormatInfo(a),this.currencyFormatInfo.init.call(this.currencyFormatInfo),this.numberFormatInfo=new KDGridFormatInfo(a),this.numberFormatInfo.init.call(this.numberFormatInfo)},updateCFmtInfo:function(e){var t=$.isArray(e)?e:[e];this.currencyFormatInfo=this.currencyFormatInfo||new KDGridFormatInfo,this.numberFormatInfo=this.numberFormatInfo||new KDGridFormatInfo;for(var i=0;i<t.length;i++){var a=t[i];this.currencyFormatInfo.mergeFormatInfo.call(this.currencyFormatInfo,a)}},getGridFmtInfoMap:function(e){return KDGridFormatInfo.C_NumType_C==e?this.currencyFormatInfo:this.numberFormatInfo},getDataRowCount:function(){return this.currentData&&void 0!=this.currentData.rowcount?this.currentData.rowcount:-1},getRowCount:function(){return this.rows&&void 0!=this.rows.length?this.rows.length:-1},getSelectedIds:function(){var e=this;return e.selColDescriptor?e.selColDescriptor.getSelectedIds.call(e.selColDescriptor):[]},setVisualData:function(e,t){this.visualRows=e.rows,t&&t(this.visualRows)},updateRowDataValue:function(e,t,i){if(e){var a=this.getColumnDescriptor(t);a.editor&&(a.formatDisplayValue?i=null!=a.subColDescriptor?a.formatDisplayValue(a.subColDescriptor.fetchDataByValue(i,a.dataIndex)):a.formatDisplayValue(i):null!=a.subColDescriptor&&(i=a.subColDescriptor.fetchDataByValue(i,a.dataIndex))),e[t]=i}},updateSvrValue:function(e,t,i){var a=this,n=a.getRowIndexByServerRowId(e);this.updateValue(n,t,i,e),this.onCellValueChange&&this.onCellValueChange(n,t,i,e)},updateValue:function(e,t,i,a){var n=this,o=e,r=n.rows[o];if(r){r[t]=i;var s=n.getOwner();void 0===a&&(a=n.getServerRowId(o)),n.owner.storeData.call(s,a,t,i)}},getSortFieldName:function(){return this.getIndexKey()+"_defSort"},getSeqColumn:function(){return this.getColumnDescriptor(this.getSeqKey())},initRows:function(){var e=this;return e.rows=e.rows||[],e.rows.scope=this,e.rows},appendRows:function(e,t){var i=this;i.initRows();for(var a in e){var n=e[a],o=i.formateNewRow(n);i.rows.push(o)}var r=i.rows[i.rows.length-1];return delete this._serverRowIdMap,delete this.visualRows,t&&t(i.rows),r},insertRows:function(t,i,a,n){var o=this,r={},s={},l=o.getIndexKey();o.initRows(),t=a?t:t+1;var d=o.getRowIndexByServerRowId(t);if(0==this.rows.length)return void this.appendRows(i,n);var c=this.rows[d],h=parseInt(c[l]),u=parseInt(c[this.getSeqKey()]),p=0;for(var g in i){var f=i[g],m=o.formateNewRow(f);o.rows.splice(d+p,0,m),p++}for(var v=d;v<o.rows.length;v++){var y=this.rows[v],b=h++;y.rowId!=b&&(r[y.rowId]=b),y[l]=b,y.rowId=b,e.isNaN(u)||(y[this.getSeqKey()]=u++),this.setRowSortNum(y)}var D=o.rows[d];return o.updateDimensionRowIdChange({delIds:s,chgIds:r}),delete this._serverRowIdMap,delete this.visualRows,n&&n(o.rows),D},setRowSortNum:function(e){var t=parseInt(e[this.getIndexKey()]),i="0000000000000000"+t.toString();i=i.substr(i.length-16,16),e[this.getSortFieldName()]=i},getPageId:function(){var e=this,t=e.getOwner(),i=t&&t.getFormProxy.call(t);return i&&i.getPageId.call(i)},getGridKey:function(){var e=this,t=e.getOwner();t&&t.getFormProxy.call(t);return t&&t.getKey.call(t)},formateNewRow:function(e){var t=this,i={gridKey:t.getKey(),pageId:t.getPageId()};!this.isEditable()&&e&&e.length==this.selColIndex&&e.push(!1);for(var a in t.colDescripersNameMap){var n=t.colDescripersNameMap[a];if(n.editor&&(n.formatDisplayValue?null!=n.subColDescriptor?i[n.dataIndex]=n.formatDisplayValue(n.subColDescriptor.fetchData(e,n.dataIndex)):e[n.colIndex]=n.formatDisplayValue(e[n.colIndex]):null!=n.subColDescriptor&&(i[n.dataIndex]=n.subColDescriptor.fetchData(e,n.dataIndex))),n.getFieldName()==this.getIndexKey()){var o=parseInt(e[n.colIndex]);i[n.dataIndex]=o,rowData.rowId=o;var r="0000000000000000"+e[n.colIndex].toString();r=r.substr(r.length-16,16),i[t.getSortFieldName()]=r}else null==n.subColDescriptor&&(i[n.dataIndex]=e[n.colIndex])}return i},deleteRows:function(t,i){var a=this,n={},o={};null==a.rows&&(a.rows=[]);var r=0;a.rows.length>0&&(r=a.getServerRowId(0),0>r&&(r=0));var s=[],l=void 0;for(var d in t){var c=t[d];o[c]=-1;var h=a.getRowIndexByServerRowId(c);l=l||h,s.push(h)}for(var u in s){var d=s[u];delete a.rows[d]}var p=[];for(var g in a.rows){var f=a.rows[g];e.isNaN(parseInt(g))?p[g]=f:p.push(f)}delete a.rows,a.rows=p;for(var g=0;g<a.rows.length;g++){var m=a.rows[g];if(m){length++;var v=g+r;m.rowId!=v&&(n[m.rowId]=v),m.rowId=v,m[a.getIndexKey()]=m.rowId,a.getSeqKey()&&(m[a.getSeqKey()]=m.rowId+1)}}return a.updateDimensionRowIdChange({delIds:o,chgIds:n}),delete this._serverRowIdMap,delete this.visualRows,i&&i(a.rows),l},exChangeRows:function(e,t,i,a,n){var o=this,r=!0,s={},l={},d=o.getRowIndexByServerRowId(e),c=o.getRowIndexByServerRowId(t);if(r=d!=c,r=r&&null!=o.rows&&o.rows.length>0,r=r&&d>-1&&d<o.rows.length,r=r&&c>-1&&c<o.rows.length){var h=this.rows[d],u=this.rows[c],p=0;o.rows.length>0&&(p=o.getServerRowId(0),0>p&&(p=0)),delete this.rows[d],this.rows[d]=u,delete this.rows[c],this.rows[c]=h;for(var g=0;g<o.rows.length;g++){var f=o.rows[g];if(f){var m=g+p;f.rowId!=m&&(s[f.rowId]=m),f.rowId=m,f[o.getIndexKey()]=f.rowId,o.getSeqKey()&&(f[o.getSeqKey()]=f.rowId+1)}}o.updateDimensionRowIdChange({delIds:l,chgIds:s}),delete this._serverRowIdMap,delete this.visualRows,n&&n(o.rows)}return r},getColumnDescriptor:function(e){var t=e?e:"";return this.colDescripersNameMap[t.toUpperCase()]||this.colDescripersNameMap[t]},getColumnDescriptors:function(){return this.colDescripersNameMap},getColumnDescriptorParent:function(e){var t;for(var i in this.colDescripersNameMap){var a=this.colDescripersNameMap[i];if(a.parentkey==e){t=a;break}}return t},getColumnDescriptorsParent:function(e){var t=[];for(var i in this.colDescripersNameMap){var a=this.colDescripersNameMap[i];a.parentkey==e&&t.push(a)}return t},existVisibleCols:function(){return e.isArray(this.visibleCols)&&this.visibleCols.length>0},getVisibleCols:function(){return this.visibleCols},resetVisibleCols:function(){if(!e.isEmpty(this.frozenObj)&&this.visibleCols.length>1){for(var t=0,i=0,a=this.frozenObj&&this.frozenObj.left||"",n=this.frozenObj&&this.frozenObj.right||"",o=0;o<this.visibleCols.length;o++){var r=this.visibleCols[o];if(r&&r.locked){var s=r.getFieldName.call(r);s.toUpperCase().trim()==a.toUpperCase().trim()&&(t=o),s.toUpperCase().trim()==n.toUpperCase().trim()&&(i=o),r.locked.call(r,!1),KDStore.isColSelector(r.dataIndex)&&this.visibleCols.length>1&&r.locked.call(r,e.getLocalConfiguration().FixedTableSelectColumns||!1)}}for(var o=0;t>=o;o++){var r=this.visibleCols[o];r&&r.locked&&r.locked.call(r,!0)}}},setVisibleCol:function(t,i){var a=this.getColumnDescriptor(t);if(a)if(i){var n=!1;for(var o in this.visibleCols)if(this.visibleCols[o].dataIndex==t){n=!0;break}n||(this.visibleCols.push(a),this.visibleCols=e.quickSort(this.visibleCols,"visibleIndex")),a.setVisible.call(a,!0)}else for(var o in this.visibleCols)if(this.visibleCols[o].dataIndex==t){this.visibleCols.splice(o,1),a.setVisible.call(a,!1);break}},selRows:function(e){this.selColDescriptor&&this.selColDescriptor.selRows(e)},IsRowVisible:function(e){return this.IsRowVisibleCallBack?this.IsRowVisibleCallBack(e):!0},isBaseField:function(e){var t=this.baseFields||{};return t[e]},updateDimensionRowIdChange:function(e){var t=this.getColumnDescriptors();for(var i in t){var a=t[i];a&&a.updateDimensionRowIdChange.call(a,e)}}},$.extend(KDStore.prototype,{getStates:function(){return this.states||[]},statesKeys:",forecolor,backcolor,disabled,",colStateKeys:",fontbold,NumFmtInfo,xColDspCtrlType,mask,CellHidden,Tooltip,decimalPrecision,",setStates:function(e,t,i){this.states=this.states||[],this.statesKeys.indexOf(i.key)>-1&&this.states.push({colDesc:e,rowData:t,value:i})},clearStates:function(){delete this.states,this.isViewGrid()&&this.clearSummaryData();for(var e in this.colDescripersNameMap){var t=this.colDescripersNameMap[e];t.clearStates.call(t)}var i=this.selColDescriptor;i&&i.reset&&i.reset.call(i)}}),$.extend(KDStore.prototype,{getRowIndexByRowData:function(e){var t=this.getRowId(e);return ret=this.getRowIndexByServerRowId(t),ret},getRowIndexByServerRowId:function(e){var t=-1;if($.isArray(this.rows))for(var i=0;i<this.rows.length;i++)if(this.getRowId(this.rows[i])==e){t=i;break}return t},getRowId:function(e){if(null==e||void 0==e)return-1;var t=e[this.getIndexKey()];return t},getBaseRowId:function(){var e=this.getFirstRowId(),t=parseInt(e),i=isNaN(t)||0>t?0:t;return i},getFirstRowId:function(){var e=-1;if(this.rows&&this.rows.length){var t=this.rows[0];e=this.getRowId(t)}return e},getLastRowId:function(){var e=-1;if(this.rows&&this.rows.length){var t=this.rows[this.rows.length-1];e=this.getRowId(t)}return e},getNewRowId:function(){var t=0;if(this.rows&&this.rows.length){var i=this.rows[this.rows.length-1];t=this.getRowId(i)}return t=parseInt(t),e.isNaN(t)?t=0:t++,t},isClientNewRow:function(e,t){var i=this,a=!1,n=parseInt(i.getLastRowId()),o=(e||"").toUpperCase()==i.getKeyInputFieldName();return o&&n==t&&(a=!0),a},existRowIds:function(t){var i=[];if(!e.isArray(t))return i;for(var a in t){var n=t[a];void 0!==n&&!isNaN(n)&&this.existRowId(n)&&i.push(n)}return i},existRowId:function(e){var t=this.getRowDataByServerRowId(e);return!!t},getRowDataByServerRowId:function(t){if(!this._serverRowIdMap){var i=this.getColumnDescriptor(this.getIndexKey());if(null==i)return null;this._serverRowIdMap={};for(var a in this.rows)if(!e.isNaN(parseInt(a))){var n=this.rows[a],o=n[this.getIndexKey()],r=parseInt(o);try{this._serverRowIdMap[r]=n}catch(s){throw new Exception(ResManager.LoadKDString("服务端行号字段FIndex出现重复的数据!","099002000000098"))}}}return this._serverRowIdMap[t]},getServerRowId:function(e){if(!this.getIndexKey())return e;this.visualRows&&this.visualRows.length||(this.visualRows=this.rows);var t=this.visualRows[e];if(!t)return e;if(void 0==t[this.getIndexKey()])throw new Exception(ResManager.LoadKDString("索引数据列下标越界，数据与列元数据不匹配。","099002000000099"));var i=t[this.getIndexKey()];return parseInt(i)}})}(KD),function(e){KDDataRow=function(){},KDDataRow.prototype={}}(KD),define("KDStore",["KD"],function(e){return function(){var t;return t||e.KDStore}}(this)),function(e){KDkendoStore=e.extend(KDStore,{rowHeight:26,flowRowHeightMaxCount:20,flowRowHeightMinCount:7,virtualScroll:!0,isFlowViewList:!1,isFlowEditGrid:!1,isMultiSort:!1,gridPageSize:void 0,getIndexKey:function(){return this.converFieldName(this.serverIndexFieldName)},getSeqKey:function(){return this.converFieldName(this.seqFieldName||"")},getKeyInputFieldName:function(){return this.converFieldName(this.keyInputFieldName||"")},isColRender:function(e){return e.isVisible.call(e)},setData:function(e,t){var i=this;KDkendoStore.superclass.setData.call(i,e,t),i.isBulkData()&&i.getVirtualScroll()&&(i.setVirtualScroll(!1),i.setUpdateView(!0))},setVirtualScroll:function(t){var i=void 0,a=e.entryrolePlugins.getPlugin(e.getEntryRole());a&&$.isFunction(a.isVirtualGrid)&&(i=a.isVirtualGrid.call(a,this.config)),e.isMobileOS()&&e.isMacOS()?this.virtualScroll=!1:void 0!==i?this.virtualScroll=i:this.isViewGrid()?this.isBulkData()?this.virtualScroll=!1:void 0===this.config.isRealModel&&(this.virtualScroll=t):this.virtualScroll=!1},getVirtualScroll:function(){return this.virtualScroll},fieldNameMaps:{__revert:{}},revertKendoFieldName:function(e){var t=this.fieldNameMaps.__revert[e];return t||e},chineseName:10,converToKendoFieldName:function(t){var i,a=this.fieldNameMaps[t],n=t.replace(/\./g,"_").replace(/\&/g,"_A").replace(/\%/g,"_1").replace(/\[/g,"_2").replace(/\]/g,"_2");return i=e.checkChinese(t)?a||n:a||n.toUpperCase(),!a&&e.checkChinese(i)&&t==i&&(i="AAchineseName".toUpperCase()+this.chineseName,this.chineseName=this.chineseName+10),a||i==t||(this.fieldNameMaps[t]=i,this.fieldNameMaps.__revert[i]=t),i},converFieldName:function(e){return this.converToKendoFieldName(e)},createColumnModel:function(e){this.fieldNameMaps={__revert:{}},KDkendoStore.superclass.createColumnModel.call(this,e)},getScrollable:function(e,t){return void 0===e?this.getVirtualScroll()?{virtual:!0}:{virtual:this.cellTemplateKey?!0:!1}:e?!0:t},getkendoGridBaseOptions:function(){var t=this,i={kdPageId:this.getPageId(),kdGridKey:this.getGridKey(),height:300,columnResizeHandleWidth:5,editable:!1,scrollable:this.getScrollable(),pageable:!1,selectable:"multiple row",navigatable:!0,sortable:!0,allowSorting:e.getValue(this.config,"allowSorting",!0),columnReorder:function(e){var i=t.getOwner();i.isChangeColumnRecord=!0},columnMenu:{messages:{sortAscending:ResManager.LoadKDString("排序（升序）","00214298000005656"),sortDescending:ResManager.LoadKDString("排序（降序）","00214298000005657"),filter:ResManager.LoadKDString("过滤","00214298000005658"),columns:ResManager.LoadKDString("列显示隐藏","002130030048238"),done:ResManager.LoadKDString("确定","0991733000003896"),settings:ResManager.LoadKDString("设置","0991733000003906"),lock:ResManager.LoadKDString("冻结列","00214298000005660"),unlock:ResManager.LoadKDString("取消冻结列","00214298000005655")}},sort:function(i){var a=t.getOwner(),n=a.getKendoGrid(),o=[],r=n.current(),r=$(r),s=r.find(".kd-grid-header-link");if(s.length>0){var l=!e.isEmpty(s.attr("currentclickdom"));if(s.removeAttr("currentclickdom"),l)return void i.preventDefault()}if(this.options&&0==this.options.allowSorting)return void i.preventDefault();var d={},c={};t.isMultiSort&&(o=e.cloneObject(n.dataSource.sort())),o.push(i.sort);for(var h=0;h<o.length;h++){var u=o[h],p=u.dir,g=u.field;e.isEmpty(p)?e.isEmpty(g)||(c[g]=0):"asc"==p.toLowerCase()?c[g]=1:"desc"==p.toLowerCase()?c[g]=2:c[g]=0}d.SortColumns=c,a.sortColumnsInner.call(a,d,!1)},resizable:!0,columnResize:function(i){var a=i.autoFitColumnClick;if(!a){var n=t.getOwner(),o=i.column,r={field:i.column.field,width:0},s=i.sender.table.find("colgroup>col"),l=i.sender.thead.find("tr[role='row']").find("th[scope='col']"),d=n.getIsEnableColumnHeaderAutoWrap();if(d){var c=i.sender&&i.sender.thead&&i.sender.thead.find('th[data-field="'+o.field+'"]');c&&c.addClass("kd-colheader-autowrap")}if(s&&s.length>0&&l&&l.length>0&&s.length==l.length)for(var h,u,p=0;p<l.length;p++){h=$(l[p]).attr("data-field"),u=$(l[p]).width();if(e.equalsIgnoreCase(r.field,h)){r.width=u;var g=t.getColumnDescriptor(r.field);g&&g.setWidth(u)}}}if(e.isArray(i.column)&&(o=i.column[0]),o&&o.mustinput){var f=i.sender.thead.find('[data-field="'+o.field+'"]'),m=f.find(".kd-colheader-label").children(":first");m=m.is("span")?m:f.find(".kd-colheader-label>label");var v=f.find(".kd-grid-mustinput"),y=e.isIeBrowser()?38:18;m.outerWidth()+y>=f.width()?v.addClass("kd-grid-thead-mustinput"):v.removeClass("kd-grid-thead-mustinput")}},columnLock:function(e){var i=e.column,a=t.getColumnDescriptor(i.field);if(a&&a.locked&&a.locked.call(a,i.locked,!0),e.isNeedForceRefreshGridDataFlag){a&&a.locked&&a.locked.call(a,!i.locked,!0);var n=t.getOwner();n&&n.setRefreshGridDataFlag(!0)}},columnUnlock:function(e){var i=e.column,a=t.getColumnDescriptor(i.field);if(a&&a.locked&&a.locked.call(a,i.locked,!0),e.isNeedForceRefreshGridDataFlag){a&&a.locked&&a.locked.call(a,!i.locked,!0);var n=t.getOwner();n&&n.setRefreshGridDataFlag(!0)}},columnHide:function(e){var i=e.column,a=t.getColumnDescriptor(i.field),n=a&&a.visible;i&&n&&(a&&a.setVisible.call(a,!1,!0),ClientAppProxy.serverConfig&&ClientAppProxy.serverConfig.AllowTableColumnAutoHidden&&"TRUE"===ClientAppProxy.serverConfig.AllowTableColumnAutoHidden.toUpperCase()&&a&&a.setUserClientColHidden&&a.setUserClientColHidden.call(a,!0))},columnShow:function(e){var i=e.column,a=t.getColumnDescriptor(i.field);i&&(a&&a.setVisible.call(a,!0),a&&a.setUserClientColHidden.call(a,!1))},columnMenuInit:function(e){var t,i=e.container.find(".k-columns-item ul");i.length>0&&(t=i.find("input[data-field=SELECTED]")),t.length>0&&t.parents("li")[0].remove()},allowCopy:!0,groupable:{enabled:!1},messages:{noRecords:ResManager.LoadKDString("没有符合条件的数据","0991733030033375")}};this.isEditable()&&(i.editable={mode:"incell"}),i.filterable={search:!0,mode:"menu",messages:{checkAll:ResManager.LoadKDString("全选","0991733000003938"),clear:ResManager.LoadKDString("清除","0991733000003921"),filter:ResManager.LoadKDString("确定","0991733000003896"),selectedItemsFormat:ResManager.LoadKDString("已选{0}项","0991733000003939"),and:ResManager.LoadKDString("且","0991733000003940"),cancel:ResManager.LoadKDString("取消","0991733000003922"),info:ResManager.LoadKDString("输入关键字筛选列表项:","0991733000003915"),or:ResManager.LoadKDString("或者","0991733000003941"),search:ResManager.LoadKDString("搜索","00214298000004608"),isFalse:"is false",isTrue:"is true",operator:"Operator",selectValue:"-Select value-",value:"Value"},operators:{date:{eq:ResManager.LoadKDString("等于","0991733000003925"),neq:ResManager.LoadKDString("不等于","0991733000003926"),gt:ResManager.LoadKDString("今天之后","0991733000003942"),gte:ResManager.LoadKDString("大于等于今天","0991733000003943"),isnotnull:ResManager.LoadKDString("不为空","0991733000003928"),isnull:ResManager.LoadKDString("为空","0991733000003927"),lt:ResManager.LoadKDString("小于","0991733000003944"),lte:ResManager.LoadKDString("小于或等于","0991733000003945")},enums:{eq:ResManager.LoadKDString("等于","0991733000003925"),isnotnull:ResManager.LoadKDString("有值","0991733000003946"),isnull:ResManager.LoadKDString("没值","0991733000003947"),neq:ResManager.LoadKDString("不等于","0991733000003926")},number:{eq:ResManager.LoadKDString("等于","0991733000003925"),gt:ResManager.LoadKDString("大于","0991733000003948"),gte:ResManager.LoadKDString("大于或等于","0991733000003949"),isnotnull:ResManager.LoadKDString("不为空","0991733000003928"),isnull:ResManager.LoadKDString("为空","0991733000003927"),lt:ResManager.LoadKDString("小于","0991733000003944"),lte:ResManager.LoadKDString("小于或等于","0991733000003945"),neq:ResManager.LoadKDString("不等于","0991733000003926")},string:{contains:ResManager.LoadKDString("包含","0991733000003923"),doesnotcontain:ResManager.LoadKDString("不包含","0991733000003924"),eq:ResManager.LoadKDString("等于","0991733000003925"),neq:ResManager.LoadKDString("不等于","0991733000003926"),isempty:ResManager.LoadKDString("为空","0991733000003927"),isnotempty:ResManager.LoadKDString("不为空","0991733000003928"),endswith:ResManager.LoadKDString("结束于","0991733000003929"),startswith:ResManager.LoadKDString("开始于","0991733000003930")}}},i.filterMenuInit=function(e){e.container.wrap($("<div/>").addClass("k-animation-container kd-grid-filterMenu"))},this.config&&this.config.showFilterRow&&$.extend(i.filterable,{mode:"menu,row"});var a=this.getOwner();return a&&!a.getAllowColumnFiltering.call(a)&&(i.filterable=!1),i},getKendoAggregateType:function(e){var t="count";switch(e){case-1:t="count";break;case 6:t="custom";case 1:t="sum";break;case 2:t="count";break;case 3:t="max";break;case 4:t="min";break;case 5:t="average";break;default:t="count"}return t},_isColumnVisible:function(e){for(var t=!1,i=0;i<this.visibleCols.length;i++){var a=this.visibleCols[i];if(a.visible&&a.dataIndex.toUpperCase()==e.toUpperCase()){t=!0;break}}return t},loadGroupAggregate:function(){for(var t={},i=this.config.groupColumnsInfo||[],a={},n=0;n<i.length;n++)for(var o in i[n])a[o]=i[n][o];var r=a.groupColums,s=a.groupSubColums,l=a.groupSumColums,d=[];if(r){for(var n=0;n<r.length;n++){var c=this.converFieldName(r[n].fieldKey);if(this._isColumnVisible(c)){var h={field:c,aggregates:[]};if(s)for(var u=0;u<s.length;u++){var p=this.converFieldName(s[u].fieldKey),g=this.getKendoAggregateType(s[u].subType),f={field:p,aggregate:g};h.aggregates.push(f),t[p]={aggregates:["custom"==g?"sum":g],groupFooterTemplate:'<span class="kd-grid-sumfooterdiv">#=KD.ToGroupAggregateStr('+g+", 8)#</span>",footerAttributes:{"class":"kd-grid-groupsumfootertd"}}}d.push(h)}}if(d.length>0){var m=this.getOwner();e.isEmpty(m)||(m.isHasGroupColumn=!0)}}var v=[];if(l)for(var n=0;n<l.length;n++){var y=this.converFieldName(l[n].fieldKey),b=this.getKendoAggregateType(l[n].sumType),D={field:y,aggregate:b};v.push(D);for(var k=t[y]&&t[y].aggregates||[],C=!1,u=0;u<k.length;u++)if(k[u]==b){C=!0;break}for(var x=[],u=0;u<k.length;u++)x.push(k[u]);C||x.push("custom"==b?"sum":b),t[y]=$.extend(t[y],{aggregates:x,footerTemplate:'#=KDkendoStore.getGridViewFooterData("'+this.getPageId()+'","'+this.getGridKey()+'", "'+y+'","'+b+'")#'})}var w={group:d,aggregate:v,colGroupProps:t};return w},loadMergeModel:function(t){var i=this,a=!1;i.mergeHeaderModel={};var n=i.getOwner();if(n&&1==n.isEnableSingleHeader)return a;var o=0,r=0;for(var s in t)if(e.isRunInForIn(s,t)){
var l=t[s],d=l.header||"";if(d.indexOf("&")>0){a=!0;var c=d.split("&"),h="",u="",p="";$.each(c,function(t,a){if(i.mergeHeaderModel[a]){var n=i.mergeHeaderModel[a],o=c[t-1];if(o&&!e.equalsIgnoreCase(o,n.mergeParent)&&c.length>2){var s=kendo.format("{0}&{1}",o,a);u=s,c.length==t+2&&(p=u),i.mergeHeaderModel[s]={headerTemplate:"<span class='k-link'>"+a+"</span>",title:a,sameName:s,mergeParent:c[t-1],columns:[]},e.isEmpty(h)||h==s||(i.mergeHeaderModel[s].mergeParent=h,h=""),h=u}else if(h){var s=kendo.format("{0}&{1}","AAKingdeeA"+r,a);r++,u=s,i.mergeHeaderModel[s]={headerTemplate:"<span class='k-link'>"+a+"</span>",title:a,sameName:s,mergeParent:h,columns:[]},h=u}}else i.mergeHeaderModel[a]={headerTemplate:"<span class='k-link'>"+a+"</span>",title:a,mergeParent:c[t-1],columns:[]},e.isEmpty(h)||(i.mergeHeaderModel[a].mergeParent=h,h="");c.length==t+1&&(l.mergeParent=p||c[t-1])})}o++}return a},wrapMergeCol:function(e,t,i){if(e&&e.mergeParent){var a=e.mergeParent,n=this.mergeHeaderModel[a];e.isMergeAdded||(n.columns&&n.columns.push(e),e.isMergeAdded=!0),this.wrapMergeCol(n,t,!0)}else e.isMergeAdded||(t.push(e),e.isMergeAdded=!0)},getkendoGridOptions:function(t){var i=this,a=i.getIndexKey(),n=this.getkendoGridBaseOptions();if(t){var o=!1;for(var r in t){var s=t[r];if(s&&s.isIndexKeyCol.call(s,a)){o=!0;break}}if(!o){var l=i.getColumnDescriptor(a);l&&t.push(l)}}var d=t&&$.isArray(t)?t:i.colDescripersNameMap;if(this.owner&&"kdtreegrid"==this.owner.xtype)var c=!1;else var c=this.loadMergeModel(d);var h={id:a,model:{fields:{}}},u=[],p={logic:"and",filters:[]},g=[],f={},m=this.loadGroupAggregate(),v=!1,y=0,b=d.length;for(var r in d){var D=d[r],k=D.getKendoFieldName.call(D);D.gridEditable=i.isEditable();var C=D.getColOptions();C=$.extend(C,{actualColIndex:y,mergeParent:D.mergeParent,originalHeader:D.header}),KDStore.isColSelector(D.dataIndex)&&b>1&&(C=$.extend(C,{locked:e.getLocalConfiguration().FixedTableSelectColumns||!1})),D.gridEditable&&(C.editor=i.kdkendoGridCreateEditor),v=D.isIndexKeyCol.call(D,a),v&&($.extend(C,{key:!0}),n.keyCol=C),y++;var x=i.getColumnDescriptor(D.dataIndex),w=x&&x.draghidden;(i.isColRender(D)||w)&&(D.mergeParent?i.wrapMergeCol(C,u):u.push(C)),h.model.fields[C.field]=D.getSchemaModel.call(D);var K=D.getFilter();if(!e.isEmpty(K)){var S={logic:"or",filters:K};p.filters.push(S)}var I=D.getSort();I&&(f={field:k,dir:I},C&&C.sortable&&C.sortable.compare&&(f.compare=C.sortable.compare),g.push(f)),m.colGroupProps[k]&&$.extend(C,m.colGroupProps[k])}1==u.length&&(u[0].locked=!1);var P=m.group&&e.isArray(m.group)&&m.group.length>0;i.setVirtualScroll(!(P||c));var F=i.getPageSize();return $.extend(n,{scrollable:i.getScrollable(P,n.scrollable),dataSource:{data:i.rows||[],autoBind:!1,schema:h,filter:p,sort:i.isMultiSort?g:g.length>0?g[0]:void 0,group:m.group,aggregate:m.aggregate,serverPaging:!1,pageSize:F},columns:u,messages:{noRecords:ResManager.LoadKDString("没有符合条件的数据","0991733030033375")},dataBinding:function(e){},dataBound:function(e){}}),i.__filterDataModel={dataSource:{data:i.rows||[],autoBind:!1,schema:h,filter:p,sort:i.isMultiSort?g:g.length>0?g[0]:void 0,group:m.group,aggregate:m.aggregate,pageSize:i.rows&&i.rows.length>0?i.rows.length+1:F}},n},getFilterDataModel:function(){var e={dataSource:{data:[]}};return this.__filterDataModel&&(this.__filterDataModel.dataSource.data=this.rows||[],e=this.__filterDataModel),e},getColumnDescriptor:function(e){var t=e?this.converFieldName(e):"";return this.colDescripersNameMap[t.toUpperCase()]||this.colDescripersNameMap[t]},getColumnDescriptorParent:function(t){var i;for(var a in this.colDescripersNameMap){var n=this.colDescripersNameMap[a];if(e.equalsIgnoreCase(n.parentkey,t)){i=n;break}}return i},getColumnDescriptorsParent:function(t){var i=[];for(var a in this.colDescripersNameMap){var n=this.colDescripersNameMap[a];e.equalsIgnoreCase(n.parentkey,t)&&i.push(n)}return i},setGridPageSize:function(t){var i=parseInt(t);e.isNaN(i)||(i=i>KDStore.C_BulkDataLimit?KDStore.C_BulkDataLimit:i,this.gridPageSize=i)},getPageSize:function(){var t=25;return this.isFlowViewList?3*this.flowRowHeightMaxCount:this.isFlowEditGrid?this.flowRowHeightMaxCount:this.isViewGrid()?e.isIeBrowser()?50:KDStore.C_BulkDataLimit:(e.isEmpty(this.gridPageSize)?e.clientDetaHeight<250&&e.clientDetaHeight>0?t=35:e.clientDetaHeight>250&&e.clientDetaHeight<350?t=45:e.clientDetaHeight>350&&(t=55):t=this.gridPageSize,t)},getKendoData:function(){var t=[];if(this.rows&&this.rows.length>0)for(var i in this.rows)if(!e.isNaN(parseInt(i))){var a={},n=this.rows[i];for(var o in this.colDescripersNameMap){var r=this.colDescripersNameMap[o],s=r.getValueByRowData(n),l=this.converFieldName(o);a[l]=s}t.push(a)}return t},setCellTemplateKey:function(e){this.cellTemplateKey=e,"QualityStandard"==this.cellTemplateKey&&this.setVirtualScroll(!1)},getFooterData:function(t,i,a){var n=this,o="",r="",s="";if(n.sumData){if(o=n.sumData[t]||"",s=kendo.format("title='{0}'",o),n.isRedBlue){var l=n.getColumnDescriptor(t),d=l.editor,c=KDNumberFieldProxy.prototype.getKendoOptions(d)||{};c.isRedBlue&&(r=e.numInfo.redCellCls+" ",o=(o||"").replace(/\-/g,""))}if("voucherkdgrid"==n.config.xtype){var h=n.getColumnDescriptor(t);h&&h.getFooterData&&(o=h.getFooterData.call(h,o,t,i,a),s="","vouchernumberfield"==h.xtype&&(r+=" kd-grid-sumfooterdiv-vouchernumber"))}}return o=kendo.format('<div data-field="{0}" class="{1} kd-grid-sumfooterdiv" style="text-align:right;" {3}>{2}</div>',t,r,o,s)},setSummaryColumns:function(e){if(this.setUpdateView(!0),$.isArray(e)){for(var t=[],i=0;i<e.length;i++){var a=e[i],n={fieldKey:this.converFieldName(a.fieldKey),sumType:a.summaryType};t.push(n)}for(var o=this.config.groupColumnsInfo=this.config.groupColumnsInfo||[],r=-1,i=0;i<o.length;i++){var a=o[i];for(var s in a)if("groupSumColums"==s){r=i;break}}0>r?o.push({groupSumColums:t}):o[r]={groupSumColums:t}}},setSummaryData:function(t){if(e.isObject(t)){this.sumData=this.sumData||{};for(var i in t)this.sumData[this.converFieldName(i)]=t[i]}},setFormatValue:function(e,t,i){var a=this.getRowId(t),n=this.getRowDataByServerRowId(a);if(n){KDkendoStore.setFormatValue(e,n,i);var o=this.getOwner(),r=this.getColumnDescriptor(e),s=0;r&&r.getDefaultValue&&(s=r.getDefaultValue()),o&&o.storeData.call(o,a,e,$.isPlainObject(i)?i.value||s:i)}},formateNewRow:function(e){var t=this,i={gridKey:t.getGridKey(),pageId:t.getPageId()};!this.isEditable()&&e&&e.length==this.selColIndex&&e.push(!1);for(var a in t.colDescripersNameMap){var n=t.colDescripersNameMap[a],o=n&&n.subColDescriptor,r=e[n.colIndex];o&&(r=o.formatEditValue.call(o,r).subValue);var s=n.formatEditValue.call(n,r);if(n.isIndexKeyCol.call(n,t.getIndexKey())){var r=e[n.colIndex],l=parseInt(r);i.rowId=l}KDkendoStore.setFormatValue(n.getKendoFieldName.call(n),i,s)}return i},getKendoRowDataByRowId:function(t){var i=void 0;if(e.isEmpty(t))return i;var a=this.getOwner();if(a&&a.getKendoGrid)try{var n=a.getKendoGrid();if(n){var o=n.dataSource;if(o&&o._flatData){var r,s,l=o._flatData(o._data);for(r=0,s=l.length;s>r;r++){var d=l[r]||{};if(d.rowId==t){i=d;break}}}}}catch(c){e.writeError("KDkendoStore updateSvrValue Exception:"+c)}return i},updateSvrValue:function(t,i,a){var n=this,o=n.getOwner(),r=n.getRowIndexByServerRowId(t),s=n.rows[r],l={rowIndex:r,field:i,colKey:this.revertKendoFieldName(i),value:a,rowId:t};if(void 0==s)return void e["debugger"]("updateSvrValue:unfound rowId = "+r,!s);var d=!0,c=/__value$/;if(i&&c.test(i)&&(d=!1),d&&(i=e.isValidProp(s,i)?i:this.converFieldName(i)),s[i]!=a){var h;if(1!=this.updateView&&o&&o.getKendoGrid&&(h=this.getKendoRowDataByRowId(s.rowId)),s){s[i]=a,h&&(h[i]=a);var u=this.getColumnDescriptor(i),p=u&&u.xtype,g=i+"__value",f=e.isValidProp(s,g);f&&p&&("datetimefield"==p||"datefield"==p||"numberfield"==p)&&(s[g]=a,h&&(h[g]=a))}o&&o.onCellValueChange&&o.onCellValueChange.call(o,l)}},updateValue:function(e,t,i,a){var n=this,o=e,r=n.rows[o];if(r){r[t]=i;var s=n.getOwner();void 0===a&&(a=n.getServerRowId(o)),n.owner.storeData.call(s,a,t,i)}},kdkendoGridCreateEditor:function(e,t){var i=ClientAppProxy.Current.getAliveForm(t.model.pageId),a=i&&i.controlFactoryProxy.getCmp(t.model.gridKey),n=a&&a.getStore.call(a),o=n&&n.getColumnDescriptor(t.field);if(o&&o.editor)o.initCellEditor.call(o,e,t);else{var r=o.getTemplate.call(o,t.field,t.model);$(r).appendTo(e)}},syncColHeadValue:function(){for(var e in this.colDescripersNameMap){var t=this.colDescripersNameMap[e];t.isCheckBox.call(t)&&t.syncColHeadValue.call(t)}},getColPageOptions:function(e){var t=this,i=1,a=t.getIndexKey(),n=t.getSeqKey(),o=t.getColumnDescriptors(),r=[],s=[],l=[];e=e||1;for(var d in o){var c=o[d];c.getKendoFieldName.call(c)==a||c.getKendoFieldName.call(c)==n?c.colPageFixed.call(c)&&c.isVisible.call(c)?s.push(c):r.push(c):c.colPageFixed.call(c)?c.isVisible.call(c)&&s.push(c):c.isVisible.call(c)&&l.push(c)}var h=e-s.length,u=0>=h?0:l.length/h,p=parseInt(u),g=0>=h;return g||(i=p+(u>p?1:0)),{pageCols:e,unfixedPageCols:0>=h?0:h,fixedPageCols:s.length,totalCols:s.length+l.length,totalPages:i,sysCols:r,fixedCols:s,unfixedCols:l}},getRowIndexByServerRowId:function(e){var t=-1;if($.isArray(this.rows))for(var i=0;i<this.rows.length;i++){var a=this.rows[i];if(a.rowId==e){t=i;break}}return t},getRowId:function(e){if(null==e||void 0===e)return-1;var t=e.rowId;return void 0===t?-1:t},getServerRowId:function(e){if(!this.rows)return-1;this.visualRows&&this.visualRows.length||(this.visualRows=this.rows);var t=this.visualRows[e];if(!t)return-1;if(!t||void 0==t.rowId)throw new Exception(ResManager.LoadKDString("索引数据列下标越界，数据与列元数据不匹配。","099002000000099"));return t.rowId}})}(KD),function(e){$.extend(KDkendoStore,{getSvrFieldName:function(e){var t=e,i=t.indexOf("__");return i>0&&(t=t.substr(0,i)),t},getGridViewFooterData:function(e,t,i,a,n){var o=ClientAppProxy.Current,r=o&&o.getAliveForm.call(o,e),s=r&&r.getControlProxy.call(r,t),l=s&&s.getStore.call(s),d=l&&l.getFooterData.call(l,i,a,n)||"";return d},setFormatValue:function(e,t,i){if($.isPlainObject(i))for(var a in i)"name"==a||"text"==a?t[e]=i[a]:t[e+"__"+a]=i[a];else t[e]=i},getFlowViewListHeight:function(t){var i=t.store,a=t.rowHeight,n=3,o=0;if(!i)return a;var r=i.flowRowHeightMinCount,s=i?i.getPageSize():3*i.flowRowHeightMaxCount;if(i&&i.rows){var l=i.rows.length||r;l=r>l?r:l>s?s:l,o=e.layout.getZoomInPx((l+n)*a)}return o||(r+n)*a},getFlowEditGridHeight:function(t){var i=t.store,a=t.rowHeight,n=3,o=0;if(!i)return a;var r=i.flowRowHeightMinCount,s=i?i.getPageSize():1*i.flowRowHeightMaxCount;if(i&&i.rows){var l=i.rows.length||r;l=r>l?r:l>s?s:l,o=e.layout.getZoomInPx((l+n)*a)}return o||(r+n)*a}})}(KD),define("KDKendoStore",["KD"],function(e){return function(){var t;return t||e.KDKendoStore}}(this)),function(e){var t=34,i={MoveFirstRowIndex:!0,MoveNextRowIndex:!0,MovePreviousRowIndex:!0,MoveLastRowIndex:!0};KDKendoGridProxy=KD.extend(KDControlProxy,{isGrid:!0,selOp:null,isEditorZoomIn:!1,toolbarHeight:t,rowHeight:t,colHeaderHeight:void 0,pagerHeight:38,toolbarOffsetHeight:0,pagerOffsetHeight:0,groupSumColumHeight:20,gridOffsetWidth:0,gridOffsetHeight:4,mergeHeaderHeight:30,bulkCellChangeLimitGate:2e3,bulkUpdateRowLimitGate:150,IsEnforcepageVisible:!1,isCellValueChanging:!1,isInit:!1,refreshingDataFlag:!1,isGridDataRefreshReading:!1,refreshDataActions:!1,newRowEvent:{PostDataOnly:!0},oldSearchTxt:"",oldSearchResult:[],oldCellResult:[],oldSearchIndex:null,lastNavigateTD:null,lastFocusTD:{},lastScrollPS:{top:0,left:0},allowedForceCommitForm:!0,isShowNoRecords:!0,noRecordsTemplate:kendo.format('<div class="kd-grid-nodata"><img src="../images/biz/default/MainConsole/H5CardLayout/icon_task_NoData.png"><p>{0}</p></div>',ResManager.LoadKDString("很抱歉，暂时没有相关数据~","0141072000005298")),isShowRecords:!1,isEnableSingleHeader:void 0,isEnableColumnHeaderAutoWrap:!1,localConfiguration:{},AllowBlockPaste:!1,isStayFocusHandlerWhenDelRow:!1,isGetLayoutSettingData:!1,isChangeColumnRecord:!1,columnOrderForExit:[],columnTipsArray:[],headerSplitChar:"&",isHasGroupColumn:!1,isInColSelection:!1,CopyGridOrginalValue:!1,CopyGridSpecialXtype:["attachmentfield","kdurlpicfield"],notEditCellWhiteXtype:["kdcombo","kdcombo_Galaxy"],serverFilterString:[],ingoreCleanFilterstring:void 0,columnsFilterList:{},enableMkModelColumnList:{},AllowColumnFiltering:!0,invokeFilterChangedAfterReflash:void 0,createControl:function(e){this.store=null,this.lastClickTime={},this.localConfiguration={},this.setActivate(!0),KDKendoGridProxy.superclass.createControl.call(this,e),this.el.addClass("kd-kdgrid-base"),this.el=this.el.KDPanel(),this.setIsShowNoRecords(KD.getValue(e,"isShowNoRecords",!0)),this.setNoRecordsTemplate(KD.getValue(e,"noRecordsTemplate","")),this.changedColumns={columns:[]}},isDontLazy:function(){return this.rendered&&this.activated},setActivate:function(e){var t=this;t.activated=e,t.isDontLazy()&&t.doLazyAction(),t.isDontLazy()&&t.isUpdateViewAfterActivated&&(delete t.isUpdateViewAfterActivated,t.onRefreshGridData())},updateStateIgnoreActive:function(e){var t=this,a={};if(e=e||{},t.rendered&&!this.activated){var n=!1;for(var o in i)void 0!==e[o]?(n=!0,a[o]=e[o],delete e[o]):e.data&&t.setFocusRowIndex(0,!0);n&&KDKendoGridProxy.superclass.updateStateCore.call(t,a)}},invokeSelOp:function(){var e=this,t=arguments,i=t[0],a=e.selOp,n=void 0;if(a&&t)switch(t.length){case 1:n=a[i].call(a);break;case 2:n=a[i].call(a,arguments[1]);break;case 3:n=a[i].call(a,arguments[1],arguments[2]);break;case 4:n=a[i].call(a,arguments[1],arguments[2],arguments[3]);break;case 5:n=a[i].call(a,arguments[1],arguments[2],arguments[3],arguments[4])}return n},getInnerMaxRow:function(e){var t=KDKendoGridProxy.C_ListMaxPageCount;return KD["debugger"](KD.format("maxRow is {0}, but H5 cann't support! change to {1} max row",e,t),e>t),e&&t>e?e:t},setAllowSorting:function(e){this.config.allowSorting=e},setAllowColumnFiltering:function(e){this.AllowColumnFiltering=e?!0:!1},getAllowColumnFiltering:function(){return this.AllowColumnFiltering},setAllowedForceCommitForm:function(e){this.allowedForceCommitForm=e},getColumnDataIndex:function(e){var t=this.getStore(),i=t.revertKendoFieldName.call(t,e);return i},loadConfig:function(e){if(this.config=KD.cloneObject(e),this.setEditorZoomIn(KD.getValue(this.config,"isEditorZoomIn",!1)),this.isInVertical=KDFlowlayoutProxy.isInVertical(this.config),this.serverFilterString=[],this.enableMkModelColumnList={},this.columnsFilterList={},!this.isInVertical){var i=this.getGridContentSize(),a=this.getGridMetaWidth();this.config.width=a>i.width?a:i.width}var n=this.getFormProxy();(n.dformConfig||n.config).isUseSmallScreenModel&&(this.isViewGrid()?(this.el.addClass("kd-grid-view-smallmodel"),this.rowHeight=this.rowHeight==t?20:this.rowHeight):this.el.addClass("kd-grid-editor-smallmodel")),KDKendoGridProxy.superclass.loadConfig.call(this,e),this.AllowBlockPaste=KD.getValue(e,"AllowBlockPaste",this.AllowBlockPaste),this.CopyGridOrginalValue=this.getLocalConfiguration().CopyGridOrginalValue||!1,this.setRequestLock(!0),this.selOp=KDGridSelOpStrategy.getOpStratege(this),this.invokeSelOp("initConfigSelected",e),this.setPageCols(KD.getValue(e,"pagecols",this.getPageCols())),this.config.pager={},this.initToolbar(),this.initContextMenu(),this.initGridPanel(),this.initPagerData(),this.initColPager(),this.initToTopBtn()},getKDGridCType:function(){return"kendoKDGrid"},initComponent:function(){var e=this;e.tbarPxy&&e.tbarPxy.initComponent(),e.ctxBarPxy&&e.ctxBarPxy.initComponent(),e.createColumnsAndStore(e.config),e.rendered=!0,e.doLayout.call(e)},initToolbar:function(){var e=this,t=e.config;if(t.tbar){t.tbar.entryKey=e.getKey(),t.tbar.actionKey="EntryBarItemClick",t.tbar.id=e.key+"_ENTRYBAR",t.tbar.dock=KD.dock.Top,t.tbar.height=e.toolbarHeight,t.tbar.parent=e.config.id;var i=e.getControlFactoryProxy(),a=e.tbarPxy=i.createControl.call(i,t.tbar);a.loadConfig.call(a,t.tbar),e.isFlowEditGrid()&&KDFlowlayoutProxy.isInVertical(e.config)&&a.el.addClass("kd-grid-toolbar-bizflow"),e.el.addControl(a.el)}},initContextMenu:function(){var e=this,t=e.config,i=e.getDefaultCtxBar();if(t.ctxtbar){if(i.items.length>0){t.ctxtbar.items||(t.ctxtbar.items=[]);for(var a=0;a<i.items.length;a++)t.ctxtbar.items.push(i.items[a])}}else{if(!i)return;t.ctxtbar=i}if(t.ctxtbar){t.ctxtbar.xtype="kdmenubar",t.ctxtbar.entryKey=e.getKey(),t.ctxtbar.actionKey="EntryBarItemClick",t.ctxtbar.id=e.key+"_ENTRYCTXBAR",t.ctxtbar.dock=KD.dock.None,t.ctxtbar.isContextMenu=!0,t.ctxtbar.parentcontrolproxy=e,t.ctxtbar.targetEl="#"+this.el.attr("id");var n=e.getControlFactoryProxy(),o=e.ctxBarPxy=n.createControl.call(n,t.ctxtbar);e.el.addControl(o.el),o.loadConfig.call(o,t.ctxtbar)}},initGridPanel:function(){var t=this,i=t.getBaseId();t.gridPanel=e('<div id="'+i+'-gridPanel" class="kd-grid-panel">'),t.gridPanel.dock=KD.dock.Fill,t.el.addControl(t.gridPanel);var a=t.getLocalConfiguration()||{};ClientAppProxy.Current.IsTableVerticalNoLines||a.DisabledGridCellBorder||t.gridPanel.addClass("kd-grid-panel-enableborder"),t.isFlowEditGrid()&&KDFlowlayoutProxy.isInVertical(t.config)&&(t.gridPanel.addClass("kd-grid-panel-bizflow"),t.el.append(e('<div style="height:26px">')))},onScroll:function(e,t){var i=this;t.top>20?i.btn2top&&i.btn2top.show():i.btn2top&&i.btn2top.hide(),i.isViewGrid()&&i._adjustGridHeadAndPageFloat(e,t)},_adjustGridHeadAndPageFloat:function(t,i){var a=this.el;if(a.length>0){var n=a.find(".k-grid-header"),o=a.find(".kd_grid_page_extend"),r=a.find(".k-grid-footer"),s={},l=i.top,d=i.left,c=a.find('tbody[role="rowgroup"]').find("tr:first td");if(n.length>0&&"none"!=n.css("display")){var h=o.length>0?o.height():0;n.attr("id")||n.attr("id",this.baseId+"_grid-header");var u=0;if(KDFloatingManager.instance.duckList[this.getPageId()]&&(u=KDFloatingManager.instance.duckList[this.getPageId()].top.totalPx),a.offset().top-u<l&&a.offset().top+a.height()-h-n.height()>l){if(s={dock:"top",WidthOrHeightName:"width",ParentWidthOrHeightValue:a.width()-18,otherSideDockName:"left",otherSideDockValue:a.offset().left-d},s.ParentWidthOrHeightValue>0){if("THEAD"==n[0].tagName){var p=n.find("[role='columnheader']");s.ParentWidthOrHeightValue=a.width()-2;for(var g=0;g<p.length;g++){var f=e(p[g]),m={width:""};c&&c[g]&&(m={width:e(c[g]).width()}),f.css(m)}}KDFloatingManager.instance.setFloat(this.getPageId(),n,s)}}else if(n.hasClass("kd-el-floating")&&(KDFloatingManager.instance.setSink(this.getPageId(),n),"THEAD"==n[0].tagName)){p=n.find("[role='columnheader']");for(var g=0;g<p.length;g++){var f=e(p[g]),m={width:""};f.css(m)}}}var v;if(r.length>0&&"none"!=r.css("display")){var y=r.find(".k-footer-template").find("td"),v=n.length>0?n.height():0,b=o.length>0?o.height():0;if(r.attr("id")||r.attr("id",this.baseId+"_grid-foot"),a.offset().top+a.height()>e(window).height()+l&&a.offset().top+v+b+r.height()<e(window).height()+l){if(s={dock:"bottom",WidthOrHeightName:"width",ParentWidthOrHeightValue:a.width()-18,otherSideDockName:"left",otherSideDockValue:a.offset().left-d},s.ParentWidthOrHeightValue>0){if("TFOOT"==r[0].tagName&&r.find(".k-footer-template").length>0&&y.length>0){for(var g=0;g<y.length;g++){var D=e(y[g]),m={width:""};c&&c[g]&&(m={width:e(c[g]).width()}),D.css(m)}s.ParentWidthOrHeightValue=a.width()-2}KDFloatingManager.instance.setFloat(this.getPageId(),r,s)}}else if(r.hasClass("kd-el-floating")&&(KDFloatingManager.instance.setSink(this.getPageId(),r),"TFOOT"==r[0].tagName))for(var g=0;g<y.length;g++){D=e(y[g]);var m={width:""};D.css(m)}}}},initPager:function(){var t=this.config;t.pager&&(t.pager=e.extend(t.pager||{},{id:this.key,dock:KD.dock.Bottom,hasPhantom:this.isFlowViewList(),height:this.pagerHeight}),this._customPagerModel=t.pager.custompagermodel||this._customPagerModel||t.custompagermodel||!1,this.pagerPxy?this.pagerPxy.reloadData.call(this.pagerPxy,t.pager):(this.pagerPxy=new KDPagerProxy(t.pagerstyle||t.pager.pagerstyle),this.pagerPxy.scope=this,this.pagerPxy.gotoPageCallBack=this.isEditable()?this.switchPage:this.gotoPage,this.pagerPxy.setControlFactoryProxy.call(this.pagerPxy,this.getControlFactoryProxy()),this.pagerPxy.baseId=this.baseId+"-pager",this.pagerPxy.createControl.call(this.pagerPxy,t.pager),this.pagerPxy.loadConfig.call(this.pagerPxy,t.pager),t.pager.hasPhantom&&this.gridPanel.before(this.pagerPxy.phantomProxy.el),this.el.addControl(this.pagerPxy.el)),this.doLayout.call(this))},initToTopBtn:function(){var t=this;t.isFlowViewList()&&(t.btn2topPlaceholder=e('<div class="kd-grid-btn2top-placeholder">').appendTo(t.el),t.btn2top=e('<div class="kd-grid-btn2top kd-el-floating">').appendTo(t.el).click(function(e){t.onTopClick.call(t,e)}).hide())},isWillMerge:function(){return KD.getValue(this.config,"willMerge",!1)},isSelColEnable:function(){return this.config&&!!this.config.enableSelCol||this.isViewGrid()&&this.config.IsListMultiSel},isMultiSelectMode:function(){var e=!1,t=this,i=t.config,a=void 0===i.IsListMultiSel?!t.isEditable():i.IsListMultiSel;return e=t.isViewGrid()?t.isSelColEnable()&&a:a},isSingleSelectMode:function(){return!this.isMultiSelectMode()},isViewGrid:function(){return this.isInColSelection?!0:this.config&&"VIEWGRID"==this.config.gridtype},isRealModePaged:function(){var e=this,t=e.getStore(),i=t.getVirtualScroll.call(t);return!i&&t&&t.isBulkData.call(t)},isVirualScrollMode:function(){var e=this.getStore();return e&&e.getVirtualScroll.call(e)},isFlowViewList:function(){return this.isViewGrid()&&(KDFlowlayoutProxy.isInVertical(this.config)||KDFlowlayoutProxy.isInColumn(this.config))},isFlowEditGrid:function(){return this.isEditable()&&KDFlowlayoutProxy.isFlowlayoutChild(this.config)},getFlowViewListHeight:function(){return KDkendoStore.getFlowViewListHeight(this)},getFlowEditGridHeight:function(){return KDkendoStore.getFlowEditGridHeight(this)},isEditable:function(){var e=this.isViewGrid();return e?!e:KD.getValue(this.config,"editable",!0)},isLockEditable:function(){var t=!0;return this.isViewGrid()?!1:(e.each(this.config.columns,function(e,i){return(KD.isEmpty(i.visible)||!KD.isEmpty(i.visible)&&i.visible)&&i.visible&&i.editor&&!i.editor.disabled?void(t=!1):void 0}),t)},setRowCount:function(e){var t=parseInt(e);KD.isNaN(t)||(this.config.pager&&(this.config.pager.rowCount=t,this.config.pager.pageCount=(t%this.config.pager.rowNum>0?1:0)+parseInt(t/this.config.pager.rowNum)),this.pagerPxy&&this.pagerPxy.setRowCount&&this.pagerPxy.setRowCount.call(this.pagerPxy,t))},initPagerData:function(e){var t=e||this.config,i=t.isSplitPage||this.showPager;void 0===t.isSplitPage&&(i=(this.isEditable()?!1:!0)||t.isSplitPage||this.showPager);var a=t.pagerows||t.pageSize||this.pageSize||50,n=KD.getValue(t,"rowcount",0),o=void 0;if(this.maxPageRow=maxPageRow=KD.getValue(t,"maxpagerow",this.maxPageRow||KDKendoGridProxy.C_ListMaxPageCount),maxPageRow<a&&(maxPageRow=this.getInnerMaxRow(a),a=maxPageRow),KD.getValue(t,"isSplitPage",!1))o=KD.getValue(t,"pageindex",n>0?1:0);else if(void 0==t.pageindex&&(-1==t.rowcount||t.rowcount>0)&&void 0!=t.startrow){a=a||this.pageSize;var r=parseInt(t.startrow);KD.isNaN(r)||parseInt(t.startrow/a)*a!=t.startrow||(o=parseInt(t.startrow/a)+1)}var s=void 0!=t.forcevisiblepage?t.forcevisiblepage:this.config.forcevisiblepage;if(void 0!=s?this.showPager=s:this.showPager=i,this.showPager){for(var l=[5,20,50,100,200,500,1e3,1500],d=l.length-1;d>=0;d--){if(l[d]<maxPageRow){l.push(maxPageRow);break}if(l[d]==maxPageRow)break;l[d]>maxPageRow&&l.splice(d,1)}var c=e&&e.rows&&e.rows.length||0,h=this.config.pager?KD.getValue(this.config.pager,"IsTextViceTitle",!0):void 0;this.config.pager={rowList:l,rowNum:a||this.pageSize,pageIndex:o||this.pageIndex||0,pageCount:(n%a>0?1:0)+parseInt(n/a),rowCount:n,maxPageRow:maxPageRow,isFailureQuery:t.isFailureQuery,currSelectNumber:this._getSelRows().length,isShowCurrSelectNumber:this.isMultiSelectMode(),viceTitle:KD.getValue(t,"viceTitle",""),IsTextViceTitle:h,currentDataRows:c,custompagermodel:t.custompagermodel},this.config.pager.pageIndex>this.config.pager.pageCount&&-1!=n&&(this.config.pager.pageIndex=this.config.pager.pageCount),-1==n&&(this.config.pager.pageIndex=this.config.pager.pageIndex>0?this.config.pager.pageIndex:1),this.initPager()}this.pagerPxy&&this.pagerPxy.el&&(this.showPager?this.pagerPxy.el.show():this.pagerPxy.el.hide())},gotoPage:function(e,t,i){this.pageSize=t,this.pageIndex=e;var a=i?-1:(e-1)*this.pageSize;this.isInit||this.refreshData(a,this.pageSize,i)},switchPage:function(e,t,i,a){this.pageSize=t,this.pageIndex=e;var n=(i?-1:(e-1)*this.pageSize,this.getFormProxy());if(n)switch(a){case KDPagerProxy.PageOption.First:case KDPagerProxy.PageOption.Previous:case KDPagerProxy.PageOption.Next:case KDPagerProxy.PageOption.Last:case KDPagerProxy.PageOption.GoTo:n.lockControl.call(n,this),this._customPagerModel?n.fireCustomEvents.call(n,this.getKey(),"CustomPagerModelGoto",this.pageIndex):n.fireEvent.call(n,"EntryGotoPage",this.getKey(),this.pageIndex);break;case KDPagerProxy.PageOption.SizeChange:n.lockControl.call(n,this),this._customPagerModel?n.fireCustomEvents.call(n,this.getKey(),"CustomPagerModelSizeChange",this.pageSize):n.fireEvent.call(n,"EntrySetPageSize",this.getKey(),this.pageSize);break;default:n.lockControl.call(n,this),this._customPagerModel?n.fireCustomEvents.call(n,this.getKey(),"CustomPagerModelSwitchPage",KDPagerProxy.GetOperationName(a)):n.fireEvent.call(n,"EntrySwitchPage",this.getKey(),KDPagerProxy.GetOperationName(a))}},getVisibleCols:function(){var e=this,t=e.store,i=e.isEnableColPager(),a=[];if(t){var n=t.getVisibleCols.call(t);if(n&&n.length>0)if(i)a=e.getCurColPageCols();else for(var o=0;o<n.length;o++)n[o]&&a.push(n[o])}return a},_getFilterByFieldName:function(e){var t=this.getKendoGrid(),i=[];if(t&&t.dataSource&&t.dataSource.filter){var a=t.dataSource.filter();if(a&&KD.isArray(a.filters))for(var n=0;n<a.filters.length;n++){var o=a.filters[n]||{};if(KD.isArray(o.filters))for(var r=0;r<o.filters.length;r++){var s=o.filters[r]||{};if(KD.equalsIgnoreCase(e,s.field))return i=i.concat(o.filters)}else if(KD.equalsIgnoreCase(e,o.field)){i.push(o);break}}}return i},handlerSetFilterString:function(){if(!KD.isEmpty(this.invokeFilterChangedAfterReflash)){var e=this.getKendoGrid(),t=this.getStore();try{if(e&&t){for(var i in this.invokeFilterChangedAfterReflash){var a=t.converToKendoFieldName(i),n={field:a,filter:{logic:"or",filters:this._getFilterByFieldName(a)},sender:e};this.handlerFilterClick(n)}this.invokeFilterChangedAfterReflash=null}}catch(o){KD.writeError("KDKendoGridProxy handlerSetFilterString Exception:"+o)}}},handlerFilterClick:function(e){var t="",i=this.getStore();if(null!=e.filter){for(var a=0;a<e.filter.filters.length;a++){var n=e.filter.filters[a],o=KD.format("[{0}]='{1}' or ",i.revertKendoFieldName(n.field),n.value);"contains"==n.operator&&(o=KD.format("Contains([{0}],'{1}') and",i.revertKendoFieldName(n.field),n.value)),t+=o}t=t.substr(0,t.length-4)}var r=e.sender.dataSource.group();isHasGroup=!KD.isEmpty(r);var s=isHasGroup?e.sender.dataSource.flatView():e.sender.dataSource.view(),l=e.sender.dataSource.totalPages(),d="";if(1>=l){if(s&&s.length>0){d="";for(var a=0;a<s.length;a++)d+=s[a].rowId+",";d=d.substr(0,d.length-1)}}else{for(var c=e.sender.dataSource,h=1;l>=h;h++){c.page(h);var s=isHasGroup?c.flatView():c.view();if(s&&s.length>0)for(var a=0;a<s.length;a++)d+=s[a].rowId+","}c.page(1),d=d.substr(0,d.length-1)}var u=this.getFormProxy();u.lockControl.call(u,this);var p={FilterString:t};KD.isEmpty(d)||(p.rows=d),u.fireCustomEvents.call(u,this.getKey(),"FilterChanged",KD.stringify(p)),this.setClinetFilterRowCountTip(KD.isEmpty(d)||KD.isEmpty(s)?i.getRowCount():s.length);for(var g=this.getKendoGrid(),f=g&&g.columns||[],m=0;m<f.length;m++){var v=f[m].field;if(KDStore.isColSelector(v)){var y=i.getColumnDescriptor(v);y.syncColHeadValue&&y.syncColHeadValue.call(y);break}}},setClinetFilterRowCountTip:function(e){if(this.pagerPxy&&(e=parseInt(e),!KD.isNaN(e))){var t=kendo.format(ResManager.LoadKDString("当前显示{0}行","0991733000006839"),e);this.pagerPxy.setClinetFilterRowCountTip.call(this.pagerPxy,t)}},getKendoGridOptions:function(t){var i=this,a=i.getStore(),n=t?t:i.getVisibleCols(),o=a.getkendoGridOptions.call(a,n);i.keyCol=o.keyCol;var r=this.getControl(),s=KD.layout.getActualSize(r),l=i.isMultiSelectMode(),d=i.isMergeGrid();if(e.extend(o,{controlProxy:i,selectable:l&&!KD.isMobileOS()?"multiple row":"row",height:s.height,reorderable:d?!1:!0,noRecords:{template:i.noRecordsTemplate},filter:function(e){i.setFilterStringInner.call(i,e,!1),KD.delayInvoke(function(){i.handlerFilterClick.call(i,e),i.repairNoDataGridHeadCover()})},sortable:{showIndexes:!0,mode:a.isMultiSort?"multiple":"single"}}),i.isShowNoRecords||(o.noRecords=i.isShowNoRecords),i.isRealModePaged()?(e.extend(o,{pageable:{info:!0,numeric:!0,previousNext:!1,input:!1,messages:{empty:ResManager.LoadKDString("没有数据！","0991733000003937"),display:ResManager.LoadKDString("当前{0}-{1}行, 总共{2}行","0991733030034190")}}}),e.extend(o.dataSource,{pageSize:a.getPageSize.call(a),serverPaging:!1})):i.isVirualScrollMode()||e.extend(o.dataSource,{pageSize:a.getRowCount.call(a),serverPaging:!1}),e.extend(o,this.getBindKendoGridEventOptions()),i.rendered&&!this.activated||!i.isViewGrid()){if(i.isChangeColumnRecord){var c=i.store.getColumnDescriptors(),h=(o&&o.columns,i.getLayoutSetting()),t=h&&h.cols;i._setChangeColumnVisibleIndex(t,o,c)}i.isGetLayoutSettingData&&!i.isChangeColumnRecord&&i._sortColumnsByIndex(o)}return o},_setChangeColumnVisibleIndex:function(e,t,i){try{var a=t&&t.columns;if(e&&e.length>0&&a&&a.length>0){for(var n=0;n<e.length;n++){var o=e[n],r=o&&o.i,s=o&&o.k,l=i&&i[s];if(l&&l.setVisibleIndex&&l.setVisibleIndex(n+1),r&&s)for(var d=0;d<a.length;d++){var c=a[d],h=(c&&c.visibleIndex,c&&c.field);KD.equalsIgnoreCase(s,h)&&(c.visibleIndex=n+1)}}this._sortColumnsByIndex(t)}}catch(u){return KD.writeError("KDKendoGridProxy setChangeColumnVisibleIndex Exception:"+u),null}},_sortColumnsByIndex:function(e){try{var t=e.columns;t.length>0&&t.sort(function(e,t){var i=e.visibleIndex,a=t.visibleIndex;return a>i?-1:i>a?1:0})}catch(i){return KD.writeError("KDKendoGridProxy _sortColumnsByIndex Exception:"+i),null}},getStore:function(){return this.store},createNewStore:function(){return e.extend(new KDkendoStore,{rows:[],rowHeight:this.rowHeight,virtualScroll:!this.config.isRealModel,isFlowViewList:this.isFlowViewList(),isFlowEditGrid:this.isFlowEditGrid()})},createColumnsAndStore:function(t){var i=this;i.clearGridStates(),t.columns=t.columns||[];var a=i.checkGridColumnKeys(t.columns);a.length<t.columns.length&&(t.columns=a),null==i.store&&(i.store=i.createNewStore()),i.store.setOwner(i),i.store.loadConfig(t),i.store.createColumnModel(t.columns),i.revertGridStatesInner();var n=i.getKendoGridOptions();e.extend(n,i.getBindKendoGridEventOptions(t)),i.initColPagerData(),i.buildFloatMenu(t,n),i.buildTreeGridOpts(t,n),i.initGrid(n)},checkGridColumnKeys:function(e){for(var t=this,i=[],a=[],n="",o=0;o<e.length;o++){var r=e[o],s=!0,l=r.dataIndex,d=r.header;try{KD.isEmpty(l)?s=!1:new Function("obj."+l)}catch(c){var h=a.length>0&&a.length%6==0;a.push(KD.format("{0}[ {1} : {2} ] ",h?"\r\n":"",d,l)),KD.writeLog("Invalid characters exist in the field name!","",!0),s=!1}s&&i.push(r)}if(n=a.join(","),!KD.isEmpty(n)){var u=t.getFormProxy(),p=ResManager.LoadKDString("字段键值建议使用常用字符，不要使用纯数字或特殊字符，当前存在不符合要求的字段键值，建议按要求调整正确，再使用该功能。\r\n异常字段键值如下：{0}","0141072000004555"),g=KD.format(p,n);u&&u.showErrMsgStr.call(u,g)}return i},buildTreeGridOpts:function(e,t){},buildFloatMenu:function(e,t){if(e.showfloatmenu&&"1"==e.showfloatmenu&&e.floatmenu&&e.floatmenu.items&&e.floatmenu.items.length>0){t.editModel="floatEdit",t.editModelOptions={cellEdit:!0,actions:[{add:!1},{edit:!1},{remove:!1}]};for(var i=0;i<e.floatmenu.items.length;i++){var a=e.floatmenu.items[i],n='<span id="'+$this.baseId+"_floatMenu_"+a.id+'" class="action '+a.id+'">'+a.text+"</span>",o="{"+a.id+":true,elem:'"+n+"',}",r=KD.parseObject(o);r.onclick=function(e){$this.floatAction(e)},t.editModelOptions.actions.push(r)}}},setSummaryData:function(t){var i=this,a=i.getStore();if(a.setSummaryData.call(a,t),KD.isObject(t))for(var n in t){
var o=a.converFieldName.call(a,n),r=a.isRedBlue,s=t[n],l=e('.k-footer-template [data-field="'+o+'"]',i.gridEl);r?l.addClass(KD.numInfo.redCellCls).text(s).attr("title",s):l.text(s).attr("title",s)}},selectRows:function(e){if(KD.isArray(e)&&e.length>0){for(var t=[],i=0;i<e.length;i++){var a=this.store.getRowIndexByServerRowId(e[i]);a>-1&&t.push(e[i])}if(this.invokeSelOp.call(this,"clearUISelection",!0),this.pagerPxy&&this.pagerPxy.setCurrSelectNumber(0),t.length>0){var n=t.join(",");this.pagerPxy&&this.pagerPxy.setCurrSelectNumber(t.length),this.invokeSelOp.call(this,"svrCmdSelectedChanged",n)}}},setSelectRowsTips:function(e){if(!KD.isArray(e))return void(t.selTips="");var t=this,i=e,a="";for(var n in i){var o=i[n];o&&o.Caption&&o.Value&&(a+='<div class="kd-grid-seltipitem"><span class="kd-grid-seltips-caption">'+o.Caption+'</span><span class="kd-grid-seltips-value">'+o.Value+";</span></div>")}t.selTips=a},setColIgnoreDisableReset:function(e){this.isIgnoreLocalColReset=e},isBulkDataSelChange:function(e){var t=this,i=t.getStore(),a=!0;if(i.isBulkData.call(i)){for(var n=t.getSelection(),o=e.sender.select(),r="",s=0;s<o.length;s++){var l=o[s],d=e.sender.dataItem(l);d&&d.rowId&&(r+=d.rowId+",")}n.selRows+","==r&&(a=!1)}return a},getBindKendoGridEventOptions:function(t){var i=this;t=t||this.config;var a=(i.getBaseId(),i.isMultiSelectMode()),n={selectable:a&&!KD.isMobileOS()?"multiple row":"row",change:function(t){if(!i.isInit){var a=(t.sender||{}).element,n=a&&KD.isFunction(a.find)?a.find(".k-grid-content"):void 0;i.currentScrollOffset=n&&KD.isFunction(n.scrollTop)?{top:n.scrollTop(),left:n.scrollLeft()}:{top:0,left:0};var o=i.getUIFocusedCellData.call(i,t);if((i.isViewGrid()||i.isLockEditable())&&t.sender.kdCopySelection&&t.sender.kdCopySelection(),!KDStore.isColSelector(o.field)){if(i.isViewGrid.call(i)&&(e("tbody tr [data-rowId="+o.rowId+'][data-field="'+o.field+'"]',i.gridEl).closest("td").attr("tabindex","0").addClass("k-state-focused").focus(),!i.isBulkDataSelChange.call(i,t)))return;i.onChange&&i.onChange.call(i,o)}}},save:function(e){if(e.values&&!i.isCellValueChanging){var t=e.model.rowId;for(var a in e.values){var n=a,o=e.values[n];i.afterSaveCell&&i.afterSaveCell.call(i,t,n,o)}}},saveChanges:function(e){},edit:function(e){i.onGridCellFocus.call(i,e,!0),i.editTdStatus=!0},cellClose:function(e){KD.isEmpty(i.lastFocusTD)||(i.lastFocusTD.isEnterJump=void 0),i.editTdStatus=!1},navigate:function(e){if(!i.isInit&&1!=i.gridNavigateCallBackNotRun){var t=i.getUIFocusedCellData.call(i,e);KDStore.isColSelector(t.field)||i.onCellSelect&&i.onCellSelect.call(i,t)}},dataBinding:function(e){var t=e.sender?e.sender.options:{},i=t.kdPageId,a=t.kdGridKey,n=KDKendoGridProxy.getProxyBySender(e);n&&KD.isFunction(n.onDataBinding)?n.onDataBinding.call(n,e):n||KD.writeLog("KDKendoGridProxy.dataBinding()",KD.format("Error: [{0}.{1}] no found!",i,a),!0)},dataBound:function(e){var t=e.sender?e.sender.options:{},i=t.kdPageId,a=t.kdGridKey,n=KDKendoGridProxy.getProxyBySender(e);n&&KD.isFunction(n.onDataBound)?n.onDataBound.call(n,e):n||KD.writeLog("KDKendoGridProxy.dataBound()",KD.format("Error: [{0}.{1}] no found!",i,a),!0)}};return null!=t.colforcefit&&1==t.colforcefit&&(n.shrinkToFit=!0,n.forceFit=!0),n},batchUpdateCell:function(t){if(KD.isArray(t)){var i=this,a=i.getKendoGrid();if(!a||!a.refreshCell)return t;for(var n={},o=0;o<t.length;o++){var r=t[o]||{},s=r.field,l=r.rowId;s&&l>=0&&(n[s]=n[s]||{},n[s][l]=!0,t.splice(o,1),o--)}if(!KD.isEmpty(i.gridPanel)){var d=i.gridPanel.find(".k-grid-content").addClass("kd-state-refreshcell");KD.delayInvoke(function(t){var i=e(d);if(i.hasClass("kd-state-refreshcell")&&!KD.isEmpty(t)&&a)for(var n in t){var o=t[n];for(var r in o)a.refreshCell&&a.refreshCell(n,r)}},20,void 0,n)}}return t},batchUpdateGrid:function(){var e=this;if(e.batchUpdateItems=e.batchUpdateCell(e.batchUpdateItems),e.batchUpdateItems&&e.batchUpdateItems.length>0){var t=e.getKendoGrid(),i=t.dataSource,a=KD.isIeBrowser(),n=e.store.getColumnDescriptor(e.batchUpdateItems[0].field);if(1==e.batchUpdateItems.length&&a&&n&&"datetimefield"==n.xtype)delete e.batchUpdateItems[0].field,i.pushUpdate(e.batchUpdateItems);else try{KD.delayInvoke(function(){e.refreshBatchUpdateDataActions&&(delete e.refreshBatchUpdateDataActions,e.isIgnoreClickStatus=!0,e.refreshBatchUpdateDataFlag=e.refreshDataActions?!1:!0,"kdtreegrid"==e.xtype&&(e.refreshingDataFlag=!0,i._data&&i._data.slice&&(i._pristineData=i._data.slice(0),i.transport&&i.transport.data&&(i.transport.data=i._pristineData))),i.read(),e.isIgnoreClickStatus=void 0,e.refreshBatchUpdateDataFlag=!1)})}catch(o){console&&console.error&&console.error(o)}if(e.batchUpdateItems=[],e.syncCheckHeaders){for(var r in e.syncCheckHeaders){var s=e.syncCheckHeaders[r];s.syncColHeadValue.call(s)}e.syncCheckHeaders=void 0}}this.isViewGrid()||e.el.find(".k-grid-footer .k-grid-footer-wrap table").css("width","100%"),e.gridNavigateHandler.call(e,e,!1)},editLastFocusCell:function(){var e=this,t=e.getKendoGrid();if(!KD.isEmpty(this.lastFocusTD)&&!KD.isEmpty(t)&&1==this.lastFocusTD.isEnterJump){var i=t.content.find("tbody tr [data-rowId="+this.lastFocusTD.rowId+'][data-field="'+this.lastFocusTD.field+'"]').parents("td");i.length>0&&(this.editCell(i),this.lastScrollPS=this.getScrollPosition())}},onCellValueChange:function(e){if(!(e.rowIndex<0||this.isBulkUpdating)){this.isCellValueChanging=!0;var t=this,i={rowId:e.rowId};i[e.field]=e.value,i.field=e.field,t.addBatchUpdateItems(i.rowId,i.field,e.value),this.isCellValueChanging=!1}},addBatchUpdateItems:function(e,t,i){if(!KD.isEmpty(e)&&!KD.isEmpty(t)){var a=this;a.batchUpdateItems||(a.batchUpdateItems=[]);var n={rowId:e,field:t};n[t]=i,a.batchUpdateItems.push(n)}},floatAction:function(t){$this=this;var i=(e(t.target).closest(".rowoverlay").attr("rowid"),t.target.id),a=$this.baseId+"_floatMenu_";i=i.replace(a,"");for(var n=0;n<$this.config.floatmenu.items.length;n++){var o=$this.config.floatmenu.items[n];if(o.id==i){var r=$this.getFormProxy(),s=this.validation?r.validating(!0):!0;if(!s)return;r.lockControl.call(r,this),r.fireEvent("EntryBarItemClick",$this.config.id,i);break}}},initGrid:function(t){var i=this,a="kd-grid-element";i.gridEl&&(i.gridEl.remove(),i.gridEl.off(),delete i.gridEl),i.gridPanel&&i.gridPanel.empty(),i.gridEl=e('<div id="'+i.baseId+'-c" class="'+a+'">'),i.gridEl.appendTo(i.gridPanel);var n=i.getGridContentSize();if(this.isFlowViewList()){var o={height:this.getFlowViewListHeight(),width:"100%"};e.extend(t,o)}else if(this.isFlowEditGrid()){var o={height:this.getFlowEditGridHeight(),width:"100%"};e.extend(t,o)}else this.component&&n.height>0&&(o={height:n.height},e.extend(t,{style:"height:"+n.height+"px;"},n));var r=["kdgrid","voucherkdgrid","kdgrid_Galaxy"];if(1==ClientAppProxy.Current.GridFieldNotDefaultFull&&(i.isViewGrid()||r.indexOf(i.xtype)>-1)){var s=0;if(KD.isArray(t.columns)){for(var l=0;l<t.columns.length;l++){var d=parseInt(t.columns[l].width);s+=d}if(s<t.width){var c={field:"",width:"auto",headerTemplate:"",hidden:!1,locked:!1,title:""};t.columns.push(c)}}}i.component=i.renderGrid(t),i.el.attr("tabindex",1),i.attachGridEvents()},compositioningFlag:!1,attachGridEvents:function(){var t=this;t.el.undelegate(".kd-grid-element","keydown").delegate(".kd-grid-element","keydown",function(e){t.onGridKeyDown.call(t,e)}),t.el.undelegate(".kd-grid-element","keyup").delegate(".kd-grid-element","keyup",function(e){t.onGridKeyUp.call(t,e)}),t.el.undelegate(".kd-grid-element","compositionstart").delegate(".kd-grid-element","compositionstart",function(e){t.compositioningFlag=!0}),t.el.undelegate(".kd-grid-element","compositionend").delegate(".kd-grid-element","compositionend",function(e){var i=t;KD.delayInvoke(function(){i.compositioningFlag=!1},1e3)}),t.el.undelegate(".kd-grid-element td","focus").delegate(".kd-grid-element td","focus",function(e){}),t.el.undelegate(".kd-grid-element td .kd-btn-desensitize-container","click").delegate(".kd-grid-element td .kd-btn-desensitize-container","click",function(e){t.onMkButtonClick.call(t,e)}),t.el.undelegate('.kd-grid-element [tabindex="0"]',"focus").delegate('.kd-grid-element [tabindex="0"]',"focus",function(e){FormFocusedManager.setFocused(t)}),t.el.undelegate(".kd-grid-element","mouseup").delegate(".kd-grid-element","mouseup",function(e){t.onMouseup.call(t,e)}),t.el.undelegate(".kd-grid-element","mouseover").delegate(".kd-grid-element","mouseover",function(e){t.onMouseOver.call(t,e)}),t.el.off("dblclick").on("dblclick",function(i){var a=e(i.target).closest("tr").find("[data-rowid]").data();a&&void 0!=a.rowid&&(t.dblClick.call(t,i,a.rowid),FormFocusedManager.setFocused(t))}),t.el.undelegate(".k-checkbox-label","click").delegate(".k-checkbox-label","click",function(i){var a=e(i.target).closest("th.k-header");if(FormFocusedManager.setFocused(t),"columnheader"==a.attr("role")){var a=e(i.target).parent(),n=e(".gridCheck",a),o=!n.is(":checked"),r=t.getFormProxy.call(t);r&&r.setBusy.call(r,!0),KDCheckboxColumnDescriptor.headerValueChanged(this,i,"click"),n[getPropName()]("checked",o),KD.delayInvoke(function(){r&&r.setBusy.call(r,!1)})}else t.onGridCellFocus.call(t,i,!0),i.shiftKey?KDCheckboxColumnDescriptor.cellValueShiftChanged(this,i,"click"):KDCheckboxColumnDescriptor.cellValueChanged(this,i,"click")}),t.el.undelegate(".kd-checkbox-div","click").delegate(".kd-checkbox-div","click",function(e){t.onGridCellFocus.call(t,e,!0)}),t.el.undelegate("td .kd-grid-celldiv","keydown").delegate("td .kd-grid-celldiv","keydown",function(e){32==e.which&&(FormFocusedManager.setFocused(t),KDCheckboxColumnDescriptor.cellValueChanged(this,e,"keydown"))}),t.el.undelegate("td .kd-CPUpDownNumberField .kd-spinner-btn","click").delegate("td .kd-CPUpDownNumberField .kd-spinner-btn","click",function(e){FormFocusedManager.setFocused(t);var i=t.getUIFocusedCellData.call(t);KDNumberColumnDescriptor.onLRSpinnerClick(t,e),t.setLastNavigateTD.call(t,i),KD.writeLog("  lastFocusTD click ","obj.rowId = "+i.rowId+"  obj.field= "+i.field+" isEnterJump=true",!0),t.setLastFocusTD(i)}),t.el.undelegate("td .kd-CPUpDownNumberField .kd-spinner-inp-div .k-input","change").delegate("td .kd-CPUpDownNumberField .kd-spinner-inp-div .k-input","change",function(e){FormFocusedManager.setFocused(t);var i=t.getUIFocusedCellData.call(t);KDNumberColumnDescriptor.onSpinnerTxtChange(t,e),t.setLastNavigateTD.call(t,i),KD.writeLog("  lastFocusTD change ","obj.rowId = "+i.rowId+" obj.field= "+i.field+" isEnterJump=true",!0),t.setLastFocusTD(i)}),t.el.undelegate(".k-grid-pager .k-pager-info","mouseenter").delegate(".k-grid-pager .k-pager-info","mouseenter",function(t){var i=e(t.target),a=i.text(),n=i[getPropName()]("title");"..."!=a&&a!=n&&(i.text("..."),i.attr("title",a))});var i=".k-grid-header tr th",a="click";e(i).contextmenu&&(a="contextmenu"),t.el.undelegate(i,a).delegate(i,a,function(t){if("click"!=a||3==t.which){e(this).find(".k-header-column-menu").click();var i=function(t){var t=e(t),i=t.attr("data-field"),a=t.data("kendoColumnMenu");if(!KD.isEmpty(a)){for(var n=a.owner.columns,o=void 0,r=0;r<n.length;r++)if(n[r].field==i||n[r].title==i){o=n[r];break}if(!KD.isEmpty(o)){a.wrapper.addClass("kd-grid-column-menu");var s=o.locked===!0,l=a.wrapper.find(".k-unlock").removeClass("k-state-disabled");s||l.addClass("k-state-disabled")}}};KD.delayInvoke(function(e){i(e)},15,void 0,e(this))}}),t.bindScrollEvent.call(t)},renderGrid:function(e){return kendo.ui.FilterCell.fn.options.suggestionOperator="contains",this.gridEl[this.getKDGridCType()](e)},setVisible:function(e){var t=this,i=t.isVisible();if(i!=e){KDKendoGridProxy.superclass.setVisible.call(this,e),i=t.isVisible(),1==i?(t.config.height=t.el.height()||t.config.height||t.config.metaHeight||0,t.config.width=t.el.width()||t.config.width||t.config.metaWidth||0):(t.config.metaHeight=t.config.height||0,t.config.metaWidth=t.config.width||0,t.config.height=0,t.config.width=0);var a=t.getControlFactoryProxy(),n=a.getCmp.call(a,t.config.parent);n&&n.doLayout&&n.doLayout()}},setIsEnforcepageVisible:function(e){this.IsEnforcepageVisible=e||!1,this.config&&(this.config.forcevisiblepage=this.IsEnforcepageVisible)},setIsShowNoRecords:function(e){this.isShowNoRecords=e||!1,this.config&&(this.config.isShowNoRecords=this.isShowNoRecords)},setNoRecordsTemplate:function(e){!KD.isEmpty(e)&&KD.isString(e)&&(this.noRecordsTemplate=e)},setIsTextViceTitle:function(e){e&&this.config.pager&&(this.config.pager.IsTextViceTitle=e)},getGridMetaWidth:function(){var t=0;return this.config.columns&&this.config.columns.length>0&&e.each(this.config.columns,function(e,i){(KD.isEmpty(i.visible)||!KD.isEmpty(i.visible)&&i.visible)&&(t+=i.width)}),t},getGridContentSize:function(){var e=KDFlowlayoutProxy.isFlowlayoutChild(this.config);if(e)return KD.layout.getStyleSize(this.el.parent());var t=KD.layout.getActualHeight(this.el.parent())||this.config.height,i=KD.layout.getActualWidth(this.el.parent());this.config.dock==KD.dock.None&&(t=this.config.height,i=this.config.width),(this.config.dock==KD.dock.Left||this.config.dock==KD.dock.Right)&&(i=this.config.width),(this.config.dock==KD.dock.Bottom||this.config.dock==KD.dock.Top)&&(t=this.config.height);var a=this.toolbarHeight+this.toolbarOffsetHeight,n=this.pagerHeight+this.pagerOffsetHeight;this.config.tbar&&(t-=a),this.config.pager&&this.config.pager.id&&(t-=n);var o=t-this.gridOffsetHeight,r=i-this.gridOffsetWidth;return{height:o,width:r}},doLayout:function(e){var t=this;t.getStore();if(t.gridPanel&&t.gridEl){var i={height:t.el.height(),width:t.el.width()},a=t.__lastGridPanelSize;if(!a||e||a.height!=i.height||a.width!=i.width||this.isInColSelection){t.__lastGridPanelSize=i,t.tbarPxy&&t.tbarPxy.doLayout(t.tbarPxy),t.isInVertical=KDFlowlayoutProxy.isInVertical(t.config);var n=t.getKendoGridSize();if(n.resetPanel&&t.gridPanel&&t.gridPanel.css(n),this.el&&this.el.length>0&&this.isViewGrid()){var o=this.el.find(".k-grid-header"),r=this.el.find(".kd_grid_page_extend"),s=this.el.find(".k-grid-footer");o&&o.length>0&&o.hasClass("kd-el-floating")&&o.css({width:this.el.width()}),r&&r.length>0&&r.hasClass("kd-el-floating")&&r.css({width:this.el.width()}),s&&s.length>0&&s.hasClass("kd-el-floating")&&s.css({width:this.el.width()})}var l=t.getKendoGrid();if(l&&l.getOptions){var d=l.getOptions().height,c=t.getGridContentSize(),h=t.isInVertical?n.height:c.height;this.__fixKendoGridHeight(h,d,e),t.repairNoDataGridHeadCover(),this.isShowRecords&&t.setNoDataBgCenterShow(),t.invokeSelOp("syncColHeadValue")}}}},getKendoGrid:function(){var e=this.gridEl?this.gridEl.data(this.getKDGridCType()):void 0;return e},getKendoGridSize:function(){var e=this,t=e.getGridContentSize(),i={};return e.isFlowViewList()?i={height:e.getFlowViewListHeight(),width:"100%"}:e.isFlowEditGrid()?i={height:e.getFlowEditGridHeight(),width:"100%"}:KD.layout.isFieldSet(e.config)?i={height:e.getFlowEditGridHeight(),width:"100%",resetPanel:!0}:e.component&&t.height>0&&(i={height:t.height,width:t.width,resetPanel:!0}),i.height=e.isInVertical?i.height:t.height,i},__fixKendoGridHeight:function(e,t,i){var a=this;a.recalcVScroll(e,t,i)},onDataBound:function(i){var a=this;if(KD.delayInvoke(function(){a.attachGridEvents.call(a)}),this.rowHeight!=t,a.isViewGrid()){e('.k-grid-content [role="grid"]',a.gridEl).removeAttr("tabindex");var n=a.getLocalConfiguration().SelectRowBackground||"",o=e("div.kd-grid-selector-origin-true",a.gridEl).parent().closest("tr"),r=e(".k-grid-content-locked table tbody tr",a.gridEl);if(r.length>0)for(var s=e(".k-grid-content table tbody tr",a.gridEl),l=0;l<o.length;l++)n?s.eq(r.index(o[l])).addClass("k-state-selected").css("background-color",n):s.eq(r.index(row)).addClass("k-state-selected");n?o.addClass("k-state-selected").css("background-color",n):o.addClass("k-state-selected")}else a.isEditable()&&a.selOp&&a.selOp.syncSel2UI();a.refreshingDataFlag&&KD.delayInvoke(function(){a.loadComplete.call(a,i)}),a.refreshBatchUpdateDataFlag&&a.gridNavigateHandler(a,!0,a.editTdStatus)},showBlock:function(e){var t=this,i=function(){t.showBlocking.call(t,{id:t.getBaseId(),text:ResManager.LoadKDString("数据装载中...","0991733000003933")})};e?i():KD.delayInvoke(i)},hideBlock:function(){var e=this;KD.delayInvoke(function(){e.getBaseId(),e.hideBlocking.call(e)})},createDyanmicList:function(e,t){var i=this;this.setFrozen({isInit:!0}),i.isViewGrid()?(i.isInit=!0,KD.delayInvoke(function(){i.isInit=!1,i.createDyanmicListCore.call(i,e,t)})):i.createDyanmicListCore(e,t)},createDyanmicListCore:function(t,i){if(this.isInit=!0,void 0!=this.config.groupColumnsInfo&&this.config.groupColumnsInfo.length>0&&void 0==t.groupColumnsInfo&&(this.config.groupColumnsInfo=[]),this.config.primaryKey&&t.primaryKey&&this.config.primaryKey!==t.primaryKey&&(t.primaryKey=this.config.primaryKey),e.extend(this.config,t),this.createColumnsAndStore(this.config),this.isVisible()&&this.el.show(),this.showBlock(),void 0===this.firstLoad||this.firstLoad){this.startRow=t.startRow?t.startRow:0;var a=t.pageSize;this.pageSize=this.getInnerMaxRow(a)||20}else this.pageSize&&(this.config.pageSize=this.pageSize);this.initPagerData(this.config),this.firstLoad=!1,this.isInit=!1,this.setDataUrl(i),this.doLayout()},setGridSelectedType:function(e){var t=e.SetGridSelectedType||KD.GridSelectedType.SingleRow;switch(t){case KD.GridSelectedType.SingleRow:this.IsListMultiSel=!1;break;case KD.GridSelectedType.MultiRow:this.IsListMultiSel=!0;break;case KD.GridSelectedType.Cell:}this.setIsListMultiSel(this.IsListMultiSel)},setGridOptions:function(e,t){try{var i=this,a=i.getKendoGrid();if(!i.isDontLazy())return void(i.isUpdateViewAfterActivated=!0);a&&(i.curDataPage=a.dataSource.page());var n=void 0;if(t){var o=e.dataSource;n=i.getDataSource(o),a.setDataSource(n)}else a&&a.destroy(),i.initGrid(e),a=i.getKendoGrid(),n=a?a.dataSource:void 0;var r=i.isRealModePaged();n&&r&&(i.curDataPage||0)>1&&(n.page(i.curDataPage),delete i.curDataPage);var s=i.selOp.getFocusedRowId();i.isNeedSynFocusState&&i.selOp&&i.setFocusRowIndex(s),r&&s>-1&&this.setGridCurrFocusRowInPage(s),i.isHasGroupColumn&&i.lastFocusTD&&i._setExpandOldGroupColumn()}catch(l){KD.writeError(l)}},_setExpandOldGroupColumn:function(){try{var t=this,i=t.getKendoGrid(),a=i&&i.content,n=a&&a.find("tbody tr [data-rowId="+t.lastFocusTD.rowId+'][data-field="'+t.lastFocusTD.field+'"]').closest("td");if(!KD.isEmpty(n)&&n.length>0&&!KD.isEmpty(t.lastFocusTD)&&t.lastFocusTD.field){var o=n&&n.parent("tr").prevAll(".k-grouping-row"),r=o&&o.length>0&&o[0],s=n&&n.parent("tr").siblings(".k-grouping-row");if(!KD.isEmpty(r)&&s&&s.length>0)for(var l=0;l<s.length;l++){var d=s[l];d==r?i.expandGroup&&i.expandGroup(e(d)):i.collapseGroup&&i.collapseGroup(e(d))}}}catch(c){KD.writeError(c)}},setDataUrl:function(e){this.dataUrl=e,this.refreshData(this.startRow,this.pageSize)},setGridPageSize:function(e){var t=this.getStore.call(this);t&&(t.setGridPageSize.call(t,e),this.setRefreshGridDataFlag(!0))},setRowHeight:function(e){var t=this,i=parseInt(e);t.rowHeight=isNaN(i)||26>i?26:i,t.store&&(t.store.rowHeight=t.rowHeight),t.setRefreshGridDataFlag(!0)},setColHeaderHeight:function(e){var t=this,i=parseInt(e);KD.isNaN(i)||(t.colHeaderHeight=40>i?40:i,t.setRefreshGridDataFlag(!0))},setColHeader:function(e){if(null!=e){var t=KD.getValue(e,"key",null);if(!KD.isEmpty(t)){var i=KD.getValue(e,"header",null);if(!KD.isEmpty(i)){var a=this.getStore(),n=a.getColumnDescriptor(t);null!=n&&n.setCaption&&n.setCaption(i)}}}},setColumnTipsContent:function(e){if(!KD.isArray(e))return!1;var t=this.getStore();this.columnTipsArray=e;for(var i=0;i<this.columnTipsArray.length;i++){var a=this.columnTipsArray[i],n=a.key,o=t.getColumnDescriptor(n);o&&o.setColumnLineTipsData(a)}},setSummaryGroupInfo:function(e){if(!KD.isEmpty(e)){var t=KD.isArray(e)?e:[e];this.config.groupColumnsInfo&&this.config.groupColumnsInfo.length>0?KD.isObject(this.config.groupColumnsInfo[0])&&(this.config.groupColumnsInfo[0].groupColums=t[0].groupColums):(this.config.groupColumnsInfo=[],this.config.groupColumnsInfo[0]=t[0]),this.updateFieldStates([])}},refreshData:function(e,t,i){if(void 0!=e&&(0>e&&(e=i?-1:0),this.dataUrl&&this.dataUrl.length>0)){var a='&paramdata=["'+this.getKey()+'",'+e+","+t+",null]",n=this.dataUrl+a,o=new KDRequest;o.scope=this,o.url=n,o.callback=this.onResponse,o.errCallBack=this.onResponseError,this.getFormProxy().setBusy(!0),o.callByUrl()}},refreshFirstPageData:function(){this.refreshData(0,this.pageSize)},onResponseError:function(){this.getFormProxy().setBusy(!1)},onResponse:function(e){this.isVisible()&&this.el.show();var t=e,i=(this.LoadStoreData,KD.parseObject(t));if(i){if(i.isFailureQuery){var a=this.getFormProxy();a.showMessage.call(a,i.msg?i.msg:"Grid onResponse error!","",this.config.id,0,3)}else KD.isArray(i)?this.doActions(i):this.loadStoreData(i);this.getFormProxy().setBusy(!1)}},setIsListMultiSel:function(e){if(void 0!==e&&e!=this.config.IsListMultiSel){this.config.IsListMultiSel=e;var t=this.getStore();t.initColSelectorModelConfig(this.config.columns);var i=this.getUIFocusedCellData();this.selOp=KDGridSelOpStrategy.getOpStratege(this),this.invokeSelOp("initConfigSelected",this.config),i&&this.invokeSelOp("initDataSelected",{focusrowindex:i.rowId,selRows:i.rowId+""})}},loadStoreData:function(e){this.setData(e),this.initDisp(e),this.dataChangedGroupSum(e),this.initPagerData(e)},dataChangedGroupSum:function(e){this.ToTalSummary=e.summary||null,this.ToTalSummary&&!KD.isObjectEmpty(this.ToTalSummary)?(this.showGroupSumColum=!0,this.doLayout.call(this)):this.showGroupSumColum=!1},initDisp:function(t){var i=t.format,a=this.getStore();if(e.isArray(i))for(var n in i){var o=i[n],r={};KD.KDGridActionKeys.Forecolor in o&&(e.extend(r,{key:KD.KDGridActionKeys.Forecolor}),r[KD.KDGridActionKeys.Forecolor]=o[KD.KDGridActionKeys.Forecolor]),KD.KDGridActionKeys.Backcolor in o&&(e.extend(r,{key:KD.KDGridActionKeys.Backcolor}),r[KD.KDGridActionKeys.Backcolor]=o[KD.KDGridActionKeys.Backcolor]);var s=parseInt(o.row),l=a.getRowDataByServerRowId.call(a,s),d=void 0!==o.col?a.getColumnDescriptor.call(a,o.col):a.getColumnDescriptor.call(a,a.serverIndexFieldName);void 0===d&&o.col?KD.writeLog("initDisp:: column ["+o.col+"] not found!"," formt item:"+KD.stringify(o),!0):KD.KDGridCellStateHandler.doHandler(this,d,l,r,this.afterUpdateFieldState)}t.viceTitle||""},doActions:function(e){var t=this.getFormProxy();t&&t.doActions(e)},setAllowDefaultSelected:function(e){this.invokeSelOp("isDefSelected",e)},setFireCellSelectChangeEvent:function(e){this.invokeSelOp("isCellSelectChangeEvent",e)},clearGridStates:function(e){var t=this;if(t.setLastFocusTD({}),t._setInColSelectionState(!1),t.isChangeColumnRecord=!1,t.lastNavigateTD=null,t.changedColumns={columns:[]},KD.isEmpty(t.currentCellData)||(t.currentCellData.rowId=-1),1!=t.ingoreCleanFilterstring&&(t.columnsFilterList={}),this.isViewGrid()&&t.reSetScrollPosition.call(t),e){var i=t.store.getColumnDescriptors();for(var a in i)i[a]&&i[a].resetSort&&i[a].resetSort.call(i[a]),1!=t.ingoreCleanFilterstring&&i[a]&&i[a].resetFilter&&i[a].resetFilter.call(i[a])}if(t.resetKendoGridDataSourcePage(),t.store)if(t.store.clearStates.call(t.store),e)t.invokeSelOp("initDataSelected",e);else{var n=t.store.frozenObj;t.store=t.createNewStore(),t.store.setFrozenObj&&t.store.setFrozenObj.call(t.store,n)}e&&t.revertGridServerStates()},revertGridServerStates:function(){if(!KD.isEmpty(this.serverFilterString))for(var e=0;e<this.serverFilterString.length;e++)this.setFilterStringInner(this.serverFilterString[e],!0,!1)},setData:function(e){var t=this;t.disableActions&&(t.updateFieldStates(this.disableActions),delete this.disableActions),t.clearGridStates(e),t.store.setData.call(t.store,e,function(e){t.setRefreshGridDataFlag(!0)}),this.initPagerData(e),this.hideBlock()},resetKendoGridDataSourcePage:function(){var e=this;try{var t=e.getKendoGrid(),i=t?t.dataSource:void 0;i&&i.total()>0&&i.page()>1&&i.page(1)}catch(a){KD.writeLog("KDKendoGridProxy->clearKendoGridData",a.message,!0)}},_getSelRows:function(){return this.invokeSelOp("getSelectedRows")||[]},setRefreshGridDataFlag:function(e){this.refreshDataActions=void 0===this.refreshDataActions?e:this.refreshDataActions||e,this.refreshGridData()},getScrollLeftDiv:function(){var t=e(".k-virtual-scrollable-wrap",this.el);return 0==t.length&&(t=e(".k-grid-content",this.el)),t},getScrollTopDiv:function(){var t=e(".k-scrollbar-vertical",this.el);return 0==t.length&&(t=e(".k-grid-content",this.el)),t},getScrollDiv:function(){return{top:this.getScrollTopDiv().scrollTop(),left:this.getScrollLeftDiv().scrollLeft()}},bindScrollEvent:function(){},setScrollPosition:function(e){if(!KD.isEmpty(e)){var t=this.getScrollPosition();KD.isEmpty(e.left)||t.left==e.left||this.getScrollLeftDiv().scrollLeft(e.left),KD.isEmpty(e.top)||t.top==e.top||this.getScrollTopDiv().scrollTop(e.top)}},reSetScrollPosition:function(){var e={top:0,left:0,isReset:!0};this.lastScrollPS=e,this.setScrollPosition(e)},getScrollPosition:function(){var e=this.getScrollDiv();return{top:e.top,left:e.left}},refreshGridData:function(){var e=this;if(e.store){e.store&&e.store.rows&&e.store.rows.length>200&&e.showBlock();var t=e.getScrollPosition();(e.updateView||e.updateGridView)&&0==t.left&&0==t.top||(e.lastScrollPS=t),KD.delayInvoke(function(){e.refreshDataActions&&!e.isInit?(delete e.refreshDataActions,e.onRefreshGridData.call(e),e.setScrollPosition(e.lastScrollPS),e.batchUpdateItems=[],e.hideBlock()):this.refreshDataActions||e.hideBlock()})}},onRefreshGridData:function(){var e=this,t=e.getStore.call(e);try{if(console&&console.time("--KDtime-- onRefreshGridData() "+e.getBaseId()),!t.existVisibleCols.call(t))return;var i=e.getKendoGrid();if(!i)return;var a=e.getKendoGridOptions.call(e),n=e.getKendoGridSize();e.refreshingDataFlag=!0,e.isInColSelection&&(a.selectable="multiple, cell",a.editable=!1),a.dataSource&&void 0===a.dataSource.data&&(a.dataSource.data=[]);var o=!1,r=this.getUIFocusedCellData();this.isEditStateGrid()&&(o=!0),t&&t.updateView?(a.height=n.height,a.width=n.width,e.setGridOptions(a),t&&t.setUpdateView.call(t,!1)):(KD.writeLog(e.getKey()+".onRefreshGridData() Refresh Only  :","",!0),e.isFlowViewList()?(a.height=e.getFlowViewListHeight(),e.setGridOptions(a)):e.isFlowEditGrid()?(a.height=e.getFlowEditGridHeight(),e.setGridOptions(a)):e.setGridOptions(a,!1)),o&&this.setLastFocusTD(Object.assign({},r,{isEnterJump:!0})),e.el.find(".k-grid-footer .k-grid-footer-wrap table").css("width","100%"),e.isShowRecords=!0}catch(s){KD.writeError(s)}finally{e.clearUpdateGridViewStatus.call(e),console&&console.timeEnd("--KDtime-- onRefreshGridData() "+e.getBaseId())}},setDefaultDisabeCellBackground:function(e){var t=this,i=t.getStore();i.defaultDisabeCellBackground=e},setNoDataBgCenterShow:function(){var e=this,t=e.el.find(".kd-grid-nodata"),i=e.el.find(".k-grid-norecords"),a=0;t.length>0&&(a=(i.height()-t.height())/2,a=a>0?a:0,t.css({display:"block","padding-top":a}))},isEditStateGrid:function(){var e=!1,t=this.getKendoGrid();if(t){var i=t.tbody.find(".k-edit-cell.kd-edit-cell");e=i.length>0?!0:!1}return e},repairNoDataGridHeadCover:function(){var e=this;if(!KD.isEmpty(e.gridEl)){var t=e.gridEl.find(".k-grid-content"),i=e.gridEl.find(".k-grid-header table").width(),a=t.find("table"),n=t.find("tbody tr");0==n.length?(t.addClass("kd-grid-content-nullrow"),KD.isIeBrowser()&&i&&a.width(i)):(t.removeClass("kd-grid-content-nullrow"),KD.isIeBrowser()&&a.css("width","100%"))}},clearUpdateGridViewStatus:function(){var e=this,t=e.getStore();delete e.colValueChanged,delete e.cellChanges,e.updateGridView=!1,t&&t.setUpdateView.call(t,!1)},getActualSize:function(){var e=this,t=void 0,i=e.getKendoGrid(),a=i&&i.getOptions();return t=a?e._lastSize={height:a.height,width:a.width}:e._lastSize||{height:e.gridPanel.height(),width:e.gridPanel.width()}},getDataSource:function(e){return new kendo.data.DataSource(e)},setBarItemStates:function(e){this.tbarPxy&&this.tbarPxy.setBarItemStates&&this.tbarPxy.setBarItemStates.call(this.tbarPxy,e)},setFieldstates:function(e){try{this.isVisible()&&this.el.show(),this.updateFieldStates(e)}catch(t){KD.writeError(t)||KD.Error.raise({sourceClass:"KDKendoGridProxy",sourceMethod:"setFieldstates",name:ResManager.LoadKDString("字段属性设置错误","0991733000003934"),msg:t.message+"<p>"+t.stack+"<p>"+KD.obj2str(e)})}},getFieldKeys:function(){var t=this,i=[],a=t.getStore();if(a){var n=a.visibleCols;e.each(n,function(e,t){var a="";t&&t.getKendoFieldName&&(a=t.getKendoFieldName.call(t),KD.isEmpty(a)||i.push(a))})}return i},updateFieldStates:function(t,i){var a=this,n=a.getStore(),o=!1;if(a.isInit&&!i){var r={para:t,isSkipInit:!0};return void KD.delayInvoke(function(e){e=e||{};var t=e.para,i=e.isSkipInit;a.updateFieldStates.call(a,t,i)},void 0,void 0,r)}a.needDoLayout=!1;var s=a.getScrollPosition();a.lastScrollPS=s;try{if(a.isInit=!0,e.isArray(t)){var l=a.isBulkUpdating=function(e,t){var i=0;for(var a in e)if((void 0!==e[a].value||void 0!==e[a].disabled)&&(i++,i>t))return!0;return 0==i?void 0:!1}(t,a.bulkCellChangeLimitGate);for(var d in t){var c=t[d],h=c.key;if(h){var u=null,p=c.row;if(-1!=p&&void 0!=p&&(u=n.getRowDataByServerRowId.call(n,p),p>0&&KD.isEmpty(u))){KD.writeLog(KD.format("updateFieldStates:{0},rowId:{1} is not found",this.key,p),"",!0);continue}var g=n.getColumnDescriptor.call(n,h);if(g)n.setStates.call(n,g,u,c),KD.KDGridCellStateHandler.doHandler(a,g,u,c,a.afterUpdateFieldState);else{if(!c.disabled&&(colDescs=n.getColumnDescriptorsParent.call(n,h),colDescs&&colDescs.length>0))for(var d in colDescs)g=colDescs[d],n.setStates.call(n,g,u,c),KD.KDGridCellStateHandler.doHandler(a,g,u,c,a.afterUpdateFieldState)}}else n.setStates.call(n,null,null,c),KD.KDGridCellStateHandler.doHandler(a,null,null,c,a.afterUpdateFieldState)}o=!(a.isBulkUpdating||n.updateView),delete this.isBulkUpdating}else{var c=t,h=c.key;if(h){var u=null,p=c.row;if(-1!=p&&void 0!=p&&(u=n.getRowDataByServerRowId.call(n,p),p>0&&KD.isEmpty(u)))return void KD.writeLog(KD.format("updateFieldStates:{0},rowId:{1} is not found",this.key,p),"",!0);var g=n.getColumnDescriptor.call(n,h);if(g)n.setStates.call(n,g,u,c),KD.KDGridCellStateHandler.doHandler(a,g,u,c,a.afterUpdateFieldState);else{if(c.disabled)return;if(colDescs=n.getColumnDescriptorsParent.call(n,h),!colDescs||colDescs.length<=0)return;for(var d in colDescs)g=colDescs[d],n.setStates.call(n,g,u,c),KD.KDGridCellStateHandler.doHandler(a,g,u,c,a.afterUpdateFieldState)}}}}catch(f){}finally{a.isInit=!1,a.updateGridView=!0}var m=!1,v=!0;l||!a.isEditable()||this.isViewGrid()||n.updateView?(m=!0,v=!1):KD.isEmpty(a.batchUpdateItems)||(v=!1);var y=a.getKendoGrid();if(y){var b=y.content.find("tbody tr [data-rowId="+a.lastFocusTD.rowId+'][data-field="'+a.lastFocusTD.field+'"]').closest("td");b.hasClass("k-edit-cell")&&b.hasClass("kd-edit-cell")&&(a.editTdStatus=!0,a.setLastNavigateTD(a.lastFocusTD))}a.needDoLayout&&(a.isShowRecords=!1,this.doLayout.call(this,v),a.needDoLayout=!1),m?(a.refreshCellChange(),a.onGridDataRefreshReady({isBulkUpdating:!1})):(a.refreshBatchUpdateDataActions=!0,a.batchUpdateGrid.call(a))},syncCheckHeadersIMM:function(e){var t=!0,i=this;if(i.isInit){i.syncCheckHeaders||(i.syncCheckHeaders={});var a=e.getKendoFieldName.call(e);i.syncCheckHeaders[a]=e,t=!1}return t},setFieldCellstates:function(e){try{this.isInit=!0;var t=e;for(var i in t){var a=t[i],n=KD.getValue(a,"key",""),o=KD.getValue(a,"property","");if(n&&o){var r=this.store.getColumnDescriptor.call(this.store,n),s=null,l=KD.KDGridCellStateHandler.getCellStateHandler(o);if(null!=r&&null!=l){var d=KD.getValue(a,"values",[]);for(var c in d){var h=d[c],u=parseInt(h[0]);-1!=u&&(s=this.store.getRowDataByServerRowId.call(this.store,u));var p={};p[o]=h[1],p.row=-1==u?void 0:u,p.key=n,l(o,this,r,s,p,this.afterUpdateFieldState)}}}}}catch(g){}finally{this.isInit=!1,$this.updateGridView=!0}this.refreshCellChange()},addCellChange:function(e,t){this.cellChanges=this.cellChanges||{count:0};var i=null==e?"[All]":e.getKendoFieldName(),a=t?this.store.getRowId.call(this.store,t):"[All]",n=i+"_"+a;this.cellChanges[n]={col:i,row:a},this.cellChanges.count++;
},refreshCellChange:function(){var e=this,t=e.getStore(),i=!t.updateView;if(t.updateView||e.updateGridView)this.setRefreshGridDataFlag(this.updateGridView);else{for(var a in this.cellChanges){if("[All]_[All]"==a){this.setRefreshGridDataFlag(this.updateGridView),i=!1;break}if((this.cellChanges.count||0)>this.bulkCellChangeLimitGate){this.setRefreshGridDataFlag(this.updateGridView),i=!1;break}var n=this.cellChanges[a],o=(n.col,n.row);if("[All]"==o){this.setRefreshGridDataFlag(this.updateGridView),i=!1;break}i=i?!0:!1}if(i){var r=e.getKendoGrid.call(e);KD.delayInvoke(function(){e.loadComplete({sender:r})}),this.clearUpdateGridViewStatus()}}if(e.syncCheckHeaders){for(var a in e.syncCheckHeaders){var s=e.syncCheckHeaders[a];s.syncColHeadValue.call(s)}e.syncCheckHeaders=void 0}delete this.cellChanges},getCurrentElement:function(){var t=this,i=t.getKendoGrid(),a=i?i.current():void 0;if(void 0!=a&&a.parent().parent().length>0)return a;var n=i&&i.selectable?i.select():void 0;return a=n&&e(n.find("td")[0]),a?a:void 0},setSelection:function(t,i,a){var n=this,o=n.getKendoGrid(),r=n.getStore();if(r){var s=r.getRowIndexByServerRowId.call(r,t);if(!(0>s)){var l=e("tr [data-rowId="+t+"]",this.component),d=l&&l.closest?e(l.closest("tr")):void 0;if(d&&d.length>0){var c=n.getLocalConfiguration(),h=c.SelectRowBackground==c.DefaultRowBackground?void 0:c.SelectRowBackground||void 0;a===!0&&o&&o.current(d),o&&o.selectable&&o.select(d),h&&d.css("background-color",h)}}}},getGridViewRows:function(e){var t=this,i=t.viewRows;if(t.isInit||(i=void 0),!i){i=[];var a=this.getKendoGrid(),n=this.getStore(),o=n.getFilterDataModel.call(n),r=a.dataSource,s=this.getDataSource(o.dataSource),l=void 0==r.filter()?{}:r.filter();if(s.filter(l),e)i=s.view();else for(var d=s.view(),c=0;c<d.length;c++){var h=d[c],u=h?h.rowId:"";if(void 0!==u){var p=n.getRowDataByServerRowId.call(n,u);p&&i.push(p)}else for(var g=h.items,f=0;f<h.items.length;f++){var m=g[f],v=m.rowId;if(void 0!==v){var p=n.getRowDataByServerRowId.call(n,v);p&&i.push(p)}}}t.viewRows=i}return t.viewRows},getGridViewRowIds:function(){var e=this;if(e.isInit||(e.viewRowIds=void 0),!e.viewRowIds){var t=this.getKendoGrid(),i=this.getStore(),a=(t.dataSource,t.getOptions().dataSource.filter),n=a?(a.filters||[]).length>0:!1,o=[];if(n){KD.writeLogTime("getGridViewRowIds   Begin::"," filter="+n+";",!0);for(var r=this.getGridViewRows(!0),s=0;s<r.length;s++){var l=r[s].rowId;o.push(l)}}else if(KD.writeLogTime("getGridViewRowIds Begin::"," filter="+n,!0),i&&i.rows)for(var s=0;s<i.rows.length;s++){var d=i.rows[s],l=d?d.rowId:void 0;void 0!=l&&o.push(l)}KD.writeLogTime("getGridViewRowIds   End::"," filter="+n,!0),e.viewRowIds=o}return e.viewRowIds},getFirstVisColName:function(){var e=this,t="",i=e.getVisibleCols();return!KD.isEmpty(i)&&i[0]&&KD.isFunction(i[0].getFieldName)&&(t=i[0].getFieldName.call(i[0])),t},getSelection:function(t,i){var a=this,n=a.getStore(),o=[],r={entryKey:a.getKey(),colName:"",rowIndex:a.isViewGrid()?0:-1,selRows:"",isClientNewRow:!1,clientNewRows:""};if(!a.component)return r;if(!t){var s=a.getUIFocusedCellData();t=s.field||a.lastFocusTD&&a.lastFocusTD.field||a.getFirstVisColName()||""}if(e.extend(r,{colName:t?a.getColumnDataIndex(t):""}),!n)return r;if(o=a.invokeSelOp("getSelectedRowIdArray"),!KD.IsNullOrWhiteSpace(t)&&a.newRowEvent[i]&&a.isClientNewRow(r.colName)){var l=a.store.getRowCount.call(a.store);l=0==l?"":l,e.extend(r,{isClientNewRow:!1,clientNewRows:(l||"")+""})}var d=n.getRowCount.call(n);return o.length>0&&e.extend(r,{rowIndex:0==d?-1:o[0],selRows:0==d?"":o.join(",")}),r},setIsEnableSingleHeader:function(e){this.isEnableSingleHeader!=e&&(this.isEnableSingleHeader=e,this.setRefreshGridDataFlag(!0))},setIsEnableColumnHeaderAutoWrap:function(e){this.isEnableColumnHeaderAutoWrap=e},getIsEnableColumnHeaderAutoWrap:function(){return this.isEnableColumnHeaderAutoWrap},isMergeGrid:function(){try{var t=this,i=!1;if(1==this.isEnableSingleHeader)return i;var a=t.isWillMerge();if(a)return!0;var n=t.config.columns;return n.length>0&&e.each(n,function(e,a){if(KD.isEmpty(a.visible)||!KD.isEmpty(a.visible)&&a.visible){var n=a&&a.header;if(!KD.isEmpty(n)&&n.indexOf(t.headerSplitChar)>-1)return void(i=!0)}}),i}catch(o){return KD.writeLog(kendo.format("KDKendoGridProxy isMergeGrid Error:{0}",o),"",!0),!1}},loadLayoutSetting:function(e){try{this.isGetLayoutSettingData=!1;var t=this.isMergeGrid();if(t)return;if(!KD.isEmpty(e)&&!KD.isEmpty(e.cols)&&e.cols.length)for(var i,a,n=e.cols,o=this,r=KD.getValue(o.config,"AllowLayoutSetting",!0),s=(this.isEditable(),this.getKendoGrid()),l=0;l<n.length;l++){a=n[l];var d=a&&a.k?a.k:"",c=a&&a.i?a.i:0,h=a&&a.w?a.w:0,u=a&&a.ch?a.ch:0;if(!KD.IsNullOrWhiteSpace(d)&&h>0&&(o.isGetLayoutSettingData=!0,i=o.store.getColumnDescriptor(d),!KD.isEmpty(i))){var p=i.width,g=i.isUserClientColHidden()?1:0;9999==c&&i.visible&&(c=i.getIndex()),9999!=c&&0==i.visible&&i.setVisible(!1),(r||o.isViewGrid())&&(i.setVisibleIndex(c),s&&s.setColIndex&&s.setColIndex.call(s,d,c),h!=p&&(i.setWidth(h),s&&s.setColWidth&&s.setColWidth.call(s,d,h))),u!=g&&(u?(i.setUserClientColHidden&&i.setUserClientColHidden.call(i,!0),s&&s.hideColumn&&s.hideColumn.call(s,d)):i.setUserClientColHidden&&i.setUserClientColHidden.call(i,!1))}}}catch(f){KD.writeLog(kendo.format("KDKendoGridProxy loadLayoutSetting Error:{0}",f),"",!0),this.isGetLayoutSettingData=!1}},getLayoutSettingIsbecommon:function(){return"0"},getLayoutSetting:function(){try{var t={};if(t.p=this.pageSize,KD.isEmpty(this.store))return t;for(var i,a,n=this.gridEl.find(".k-grid-header"),o=n.find("[role='columnheader']"),r=[],s=[],l=0;l<o.length;l++){i={};var d=e(o[l]),c=d&&d.attr("data-field"),h=d&&d.attr("data-index"),u=d.width();if(!KD.IsNullOrWhiteSpace(c)){var p=this.store.getColumnDescriptor.call(this.store,c);p&&(p.isVisible(!0)?u>0&&(i.fieldname=c,i.width=p.width||p.config.width,r.push(i)):(p.setVisibleIndex.call(p,h),i.fieldname=c,i.width=p.width||5,r.push(i)))}}0==r.length&&this.columnOrderForExit.length>0?r=this.columnOrderForExit:this.columnOrderForExit=r;var g=this.store.getColumnDescriptors();if(g)for(var f in g){var m=g[f];a=m&&m.getLayoutSetting&&m.getLayoutSetting.call(m,r,f),!KD.isEmpty(a)&&!KD.isEmpty(a.w)&&a.w>-1&&s.push(a)}return s=this.getSortLayoutSetting(s),t.cols=s,t}catch(v){return KD.writeLog(kendo.format("KDKendoGridProxy GetLayoutSetting Error:{0}",v),"",!0),null}},getSortLayoutSetting:function(e){var t=this.sortLayoutSetting(e);return t},sortLayoutSetting:function(e){try{for(var t,i=this.store,a=[],n=0;n<e.length;n++){t={};var o=e[n],r=o&&o.i?o.i:0,s=o&&o.k?o.k:"",l=i.getColumnDescriptor(s);(KD.isEmpty(l.dataIndex)||!KD.equalsIgnoreCase(l.dataIndex,"SELECTED")||KD.isEmpty(l.xtype)||!KD.equalsIgnoreCase(l.xtype,"colSelector"))&&(KD.isEmpty(l)||(9999==r&&l.visible&&(r=l.colIndex,o.i=r),a.push(o)))}a.sort(function(e,t){var a=KD.isEmpty(e.i)||KD.isEmpty(t.i)||e.i==t.i?0:e.i>t.i?1:-1;if(0==a){var n=e.k,o=t.k,r=n&&i.getColumnDescriptor(n),s=o&&i.getColumnDescriptor(o);null==r||null==s?a=0:r.colIndex<s.colIndex?a=1:r.colIndex>s.colIndex?a=-1:r.colIndex==s.colIndex&&(a=0)}return a});for(var n=0;n<a.length;n++){var d=a[n];9999!=d.i&&(d.i=n+1),a[n]=d}return a}catch(c){return KD.writeLog(kendo.format("KDKendoGridProxy SortLayoutSetting Error:{0}",c),"",!0),null}},afterUpdateFieldState:function(t){var i=this;i.colValueChanged=i.colValueChanged||[];var a=t.key;switch(a){case KD.KDGridActionKeys.BarItemStates:i.BarItemStates=t.data;break;case KD.KDGridActionKeys.SetFocusRowIndex:var n=parseInt(t.Data),o=e.extend(i.getUIFocusedCellData(),{rowId:n});i.invokeSelOp("afterRowDataChange",o);break;case KD.KDGridActionKeys.ColVisible:i.updateColHide=t.UpdateColHide||i.updateColHide;break;case KD.KDGridActionKeys.ColValue:i.colValueChanged[t.colKey]=!0,i.afterCellValueUpdate(t);break;case KD.KDGridActionKeys.NumFmtInfo:case KD.KDGridActionKeys.Disabled:var r=i.getStore();r.setUpdateView.call(r,!0);break;case KD.KDGridActionKeys.MkModel:i.needDoLayout=!0}t.updateView&&(i.updateGridView=t.updateView||i.updateGridView)},afterCellValueUpdate:function(e){var t=this;e.key;if(void 0!=e.rowData&&!this.isBulkUpdating){t.colValueChanged=t.colValueChanged||[];var i=t.getKendoGrid(),a=t.getStore(),n=e.rowData?e.rowData.rowId:-1,o=a.getRowIndexByServerRowId.call(a,n),r=i.items()[o],s=i.dataItem(r),l=a.getColumnDescriptor.call(a,e.colKey),d=l.getKendoFieldName.call(l),c=e.rowData[d];s&&(t.gridNavigateCallBackNotRun=!0,s.set.call(s,d,c),t.gridNavigateCallBackNotRun=void 0)}},isNeedUpdateView:function(){return this.updateGridView||this.colValueChanged&&this.colValueChanged.length},setColVisible:function(e,t){var i=this.getKendoGrid();if(i){var a=this.getStore(),n=e.getFieldName.call(e),o=e.getKendoFieldName.call(e),r=a.getColumnDescriptor(o),s=r&&r.isUserClientColHidden();t?s||(a.setVisibleCol.call(a,n,!0),i.showColumn.call(i,o)):(a.setVisibleCol.call(a,n,!1),i.hideColumn.call(i,o)),this.needDoLayout=!0}},onGridDataRefreshReady:function(e,t){var i=this;FormFocusedManager.isFocused(i)&&(i.isGridDataRefreshReading||(i.isGridDataRefreshReading=!0,i.gridNavigateHandler(i,!0,t)))},gridNavigateHandler:function(t,i,a){var n=null!=t.lastNavigateTD&&t.lastNavigateTD.field?t.lastNavigateTD:t.getLastFocusTD();if(!KD.isEmpty(n)){var o="tbody tr [data-rowId="+n.rowId+'][data-field="'+n.field+'"]',r=e(o,t.gridEl).closest("td");if(r.length){var s=t.tbarPxy&&t.tbarPxy.isKeyBoardAction,l=KD.getActiveElement();if(n.isEnterJump&&!KD.isEmpty(l)&&l.closest(".kd-kdgrid-base").length>0||s||a){t.editCell.call(t,r),$this.editTdStatus=!1,e(r).find("input.k-input").first().focus();var d=t.getScrollPosition();d.left>t.lastScrollPS.left&&(t.lastScrollPS.left=d.left),d.top>t.lastScrollPS.top&&(t.lastScrollPS.top=d.top),t.tbarPxy&&(t.tbarPxy.isKeyBoardAction=!1)}else{var c=t.getKendoGrid.call(t);c&&KD.isFunction(c.current)&&c.current(r)}}t.setScrollPosition.call(t,t.lastScrollPS)}delete t.isGridDataRefreshReading},onGridKeyUp:function(t){var i=this,a=t.keyCode||t.which||t.charCode,n=i.getUIFocusedCellData();null!=i.lastFocusTD&&i.lastFocusTD.field&&(n=i.lastFocusTD);var o="TEXTAREA"==t.target.tagName;if(!this.isEditable()||"kdgrid"!=this.config.xtype&&"kdtreegrid"!=this.config.xtype||i.doDirectionAction.call(i,t,n),13==a&&!t.altKey||13==a&&t.altKey&&!o){if(i.compositioningFlag&&i.compositioningFlag)return;if(i.isViewGrid())return;t.target=i.gridEl.find("tbody tr:eq("+n.rowId+') td [data-field="'+n.field+'"]').parents("td");var r=i.getFormProxy();if("BOS_HtmlConsoleMain"==i.getFormId())return;var s=e(t.target).parents("td").length>0?e(t.target).parents("td").first():e(t.target);r.navigateTD(s,void 0,void 0,!0),this.setLastFocusTD(Object.assign(this.lastFocusTD,{isEnterJump:!0}))}else if(o&&(1==t.ctrlKey&&96==a||1==t.altKey&&13==a)){var l=e(t.target),d=l.val(),c=KDGetCursorPositon.getSelectionIndex(t.target),h=d.substr(0,c),u=d.substr(c,d.length);d=h+"\r\n"+u,l.val(d),KDGetCursorPositon.setSelectionIndex(t.target,c+1)}},onGridKeyDown:function(t){var i=this,a=t,n=t.keyCode||t.which||t.charCode,o=t.ctrlKey||t.metaKey;t.shiftKey;if(o&&"70"==n&&i.doSearch(t),o&&"67"==n){var r=i.getKendoGrid();(i.isViewGrid()||i.isLockEditable())&&r.kdDoCopySelected&&r.kdDoCopySelected()}if(!this.isEditable()&&13==n){var s=i.getFormProxy();if(s.isNavigated=!1,i.allowedForceCommitForm){var l=e(t.target);l.hasClass("kd-grid-filter-cell-input")||s.fireCustomEvents.call(s,this.getKey(),"CommitForm",null)}}13==n&&"TEXTAREA"==t.target.tagName&&t.preventDefault(),i.tbarPxy&&KD.isCombinationOrFunctionKey(a)&&i.tbarPxy.setFullKeyBoardAction.call(i.tbarPxy,a)},_filterSortColumnsByFields:function(e){var t=void 0;if(!KD.isEmpty(e)){var i=this.getStore();if(i&&i.getColumnDescriptor)for(var a in e)if(KD.isRunInForIn(a,e)){var n=e[a],o=i.getColumnDescriptor.call(i,n);o&&"numberfield"==o.xtype&&(t=t||{},t[n]=o)}}return t},doSearch:function(t){t.preventDefault();var i=this;i.popupDiv=e("<div></div>").kendoWindow({title:ResManager.LoadKDString("查找","0991733030033251"),actions:["Close"],animation:{open:{effects:"fade:in"},close:{effects:"fade:out"}},pinned:!0,draggable:!0,modal:!1,width:KD.convertToPX(20),minHeight:KD.convertToPX(5),scrollable:!1,resizable:!1,close:function(e){i.popupDiv.destroy()}}).data("kendoWindow"),i.searchEl=e('<span class="k-textbox k-space-right" style="width: 100%; margin-top: 0.8em;"><input type="text" id="icon-right"><a href="#" class="k-icon k-i-search">&nbsp;</a></span>');var a=function(e){var t=i.store.rows,a=i.getFieldKeys();if(e!==i.oldSearchTxt){var n=i._filterSortColumnsByFields(a),o=[],r=(e+"").toUpperCase(),s=t.filter(function(e){var t=!1,i=!1;if(KD.isEmpty(e))t=!1;else if(KD.isEmpty(a))t=!1;else for(var s=0;s<a.length;s++){i=!1;var l=a[s],d=e[l];if(d=(d+"").toUpperCase(),d.indexOf(r)>=0)t=!0,i=!0;else if(n){var c=n[l];if(c&&"numberfield"==c.xtype&&c.getOriginalValue&&(d=c.getOriginalValue.call(c,e,l),void 0==d&&(d=c.getOriginalValue.call(c,e.rowId,l)),!KD.isEmpty(d)))if(d=(d+"").toUpperCase(),d.indexOf(r)>=0)t=!0,i=!0;else{var h=new RegExp("[^0-9.]+","g"),u=r.replace(h,"");d.indexOf(u)>=0&&(t=!0,i=!0)}}if(i){var p=l,g=e.rowId,f=s,m={fieldname:p,rowIdx:g,colIdx:f};o.push(m)}}return t});if(i.oldSearchTxt=e,i.oldSearchResult=s,i.oldCellResult=o,s.length>0){var l=o[0].fieldname;i.setFocusRowIndex(s[0].rowId),i.justFocusCell(o[0].rowIdx,l),i.oldSearchIndex=0}}else if(null!=i.oldSearchIndex&&i.oldCellResult){var d=0;i.oldCellResult.length-(i.oldSearchIndex+2)>=0&&(d=i.oldSearchIndex+1);var c=i.oldCellResult[i.oldSearchIndex+1];if(c){var l=(c.colIdx,c.fieldname);i.setFocusRowIndex(c.rowIdx),i.justFocusCell(c.rowIdx,l),i.oldSearchIndex=i.oldCellResult.length==d+1?-1:d}}};i.searchEl.children("input").on("keydown",function(t){"13"==t.keyCode&&(a(e(this).val()),e(this).focus())}),i.searchEl.children("a").on("click",function(t){a(e(this).siblings("input").val()),e(this).focus()}),i.popupDiv.content(i.searchEl),i.popupDiv.center(),i.popupDiv.open(),KD.delayInvoke(function(){e("#icon-right",i.searchEl).focus()},1e3),e("#icon-right",i.searchEl).focus()},doDirectionAction:function(e,t){var i=e.keyCode||e.which||e.charCode;if(37==i||39==i){this._checkLeftRightNext(e,i,t)&&this.doLeftRightAction(i,t);var a=-10;try{e.target&&void 0!=e.target.selectionStart&&(a=e.target.selectionStart)}catch(n){}var o={key:t,index:a,count:0};this._compareCell(t,this.lastDireLeftRightObj)&&this.lastDireLeftRightObj&&this.lastDireLeftRightObj.index==o.index&&(o.count=this.lastDireLeftRightObj.count+1),this.lastDireLeftRightObj=o}else(38==i||40==i)&&this.doUpDownAction(i,t)},_checkLeftRightNext:function(t,i,a){var n=t.target,o=e(n),r=-100,s=0;try{if(!n||void 0==n.selectionStart)return!0;r=n.selectionStart,s=o.val().length}catch(l){return!0}if(!o||0==s)return!0;if(37==i){if(0==r)return this._compareCell(a,this.lastDireLeftRightObj)&&1==this.lastDireLeftRightObj.index?!1:!0;if(r>0)return!1}if(39==i){if(r==s)return this._compareCell(a,this.lastDireLeftRightObj)&&this.lastDireLeftRightObj.index==s-1?!1:!0;if(r!=s)return!1}return!0},_compareCell:function(e,t){if(e&&e.field&&t&&t.key){var i=t.key;if(e.rowId>-1&&i.field==e.field&&i.rowId==e.rowId)return!0}return!1},doLeftRightAction:function(t,i){var a=this.gridEl.find("tbody tr[role='row']"),n=this.gridEl.find("tbody tr [data-rowId="+i.rowId+'][data-field="'+i.field+'"]').parents("td"),o=a.index(n.parent("tr"));0==n.length&&(n=this.getTdByCell(i,o));var r=this.getFormProxy(),s=e(n).parents("td").length>0?e(n).parents("td").first():e(n),l=this.getStore(),d=l.getColumnDescriptor.call(l,i.field);return d&&d.proxy&&d.proxy.isPopup&&d.proxy.isPopup(t)?!1:void(39==t?r.navigateTD(s,void 0,void 0,!0,!1):r.navigateTD(s,void 0,void 0,!0,!0))},getTdByCell:function(e,t){if(KD.isNumber(t)){var i=this.gridEl.find("tbody tr:eq("+t+') div[data-field="'+e.field+'"]').closest("tr");return 0==i.length&&(i=this.gridEl.find("tbody tr:eq("+t+') span[data-field="'+e.field+'"]').closest("td")),i}},getTdByFieldAndRowId:function(e,t){if(!KD.isEmpty(e)&&!KD.isEmpty(t)){var i=kendo.format('tbody tr [data-rowId="{0}"][data-field="{1}"]',t,e);return this.gridEl.find(i).closest("td")}},doUpDownAction:function(t,i){var a=this.gridEl.find("tbody tr[role='row']"),n=i.rowId,o=this.gridEl.find("tbody tr [data-rowId="+n+'][data-field="'+i.field+'"]').parents("td"),r=a.index(o.parent("tr"));if(-1!=r){if(38==t){if(0==r)return;r-=1}else if(40==t){if(r==a.length-1)return;r+=1}var s=this.getStore(),l=s.getColumnDescriptor.call(s,i.field);if(l.proxy&&l.proxy.isPopup&&l.proxy.isPopup(t))return!1;var d=this.gridEl.find("tbody tr:eq("+r+') td [data-field="'+i.field+'"]').parents("td");if(0==d.length&&(d=this.getTdByCell(i,r)),d.find(".k-state-disabled").length>0||d.find(".k-gridCellstate-disabled").length>0)return this.editCell(d),!1;this.editCell(d),KD.isEmpty(this.lastFocusTD)||(this.lastFocusTD.isEnterJump=!0),d.closest("tr").click(),d.find("input.k-input").first().select();var c=e("[data-field]",d).data();c&&c.role&&"checkbox"==c.role&&(d.find("input").first().focus().select(),this.onGridCellFocus())}},onGridCellFocus:function(e,t){var i=this.getUIFocusedCellData();KD.writeLog(" lastFocusTD onGridCellFocus","obj.rowId = "+i.rowId+"   obj.field= "+i.field+"  isEnterJump="+t,!0),this.setLastFocusTD({rowId:i.rowId,field:i.field,isEnterJump:!0}),this.lastNavigateTD=null},onMkButtonClick:function(e,t){if(this.isEnableMkModel()){var i=this.getUIFocusedCellData();i=i||{};var a=this.store;if(a){var n=a.getColumnDescriptor.call(a,i.field);n&&n.onMkButtonClick&&n.onMkButtonClick.call(n,this.key,i.rowId)}}},isEnableMkModel:function(){var e=!1;return KD.isEmpty(this.enableMkModelColumnList)||(e=!0),e},setEnableColumnMkModel:function(e,t){if(!KD.isEmpty(e)){var i=this.getFormProxy();i&&i.setIncludeMKStatusControl&&i.setIncludeMKStatusControl.call(i,!0),this.enableMkModelColumnList=this.enableMkModelColumnList||{},t?this.enableMkModelColumnList[e]=t:delete this.enableMkModelColumnList[e]}},RefreshCellsData:function(e){this.updateFieldStates(e)},release:function(){var e=this;if(e.el&&(KDFloatingManager.instance.release(e.getPageId(),e.el.find(".k-grid-header"),{dock:"top"}),KDFloatingManager.instance.release(e.getPageId(),e.el.find(".kd_grid_page_extend"),{dock:"bottom"}),KDFloatingManager.instance.release(e.getPageId(),e.el.find(".k-grid-footer"),{dock:"bottom"})),e.pagerPxy&&(e.pagerPxy&&e.pagerPxy.release&&e.pagerPxy.release.call(e.pagerPxy),delete e.pagerPxy),this.tbarPxy&&(e.tbarPxy&&e.tbarPxy.release&&e.tbarPxy.release.call(e.tbarPxy),delete e.tbarPxy),e.store){var t=e.store.getColumnDescriptors.call(e.store);if(t)for(var i in t){var a=t[i];a&&a.release&&a.release()}}e.btn2topPlaceholder&&e.btn2topPlaceholder.remove(),delete e.btn2topPlaceholder,this.lastClickTime={},e.btn2top&&e.btn2top.remove(),delete e.btn2top,e.component&&e.component.gridDestroy&&e.component.gridDestroy(),e.el&&e.el.empty&&e.el.empty()}})}(jQuery),function(e){e.extend(KDKendoGridProxy.prototype,{beforeReloadGrid:function(e){},checkRowId:function(e){return void 0===e?-1:e},afterCreateGrid:function(e){var t=this.store.getColumnDescriptors.call(this.store);if(t)for(var i in t){var a=t[i];a&&a.initDom&&a.initDom(e)}},onMouseup:function(e){},onMouseOut:function(e){var t=this;t.selTipsEl&&t.selTipsEl.remove(),t.selTipsEl=void 0},onMouseOver:function(t){var i=this;if(i.selTips)if(t.altKey||t.metaKey&&KD.isMacOS()){var a=i.getFormProxy(),n=0;a&&a.hostWindowProxy&&a.hostWindowProxy.getOriginalZindex&&(n=a.hostWindowProxy.getOriginalZindex()),n=n>0?n+10:1e3;var o=i.getKendoGrid().dataItem(e(t.target).closest("tr")),r=o?o.rowId:-1;r>=0&&i.isSelectedRow(r)?(i.selTipsEl=i.selTipsEl||e('<div class="kd-grid-seltip">'),i.selTipsEl.html(i.selTips).appendTo(e(document.body)).css({top:t.pageY,left:t.pageX,position:"absolute","z-index":n})):i.onMouseOut(t)}else i.onMouseOut(t)},dblClick:function(t,i){var a=this,n=a.getSelection(),o=a.getFormProxy(),r=0>i?n.rowIndex:i;e(t.target);o&&(o.lockControl.call(o,a),o.fireEvent.call(o,"EntryRowDoubleClick",this.getKey(),this.checkRowId(r)))},beforeSelectRow:function(e,t){var i=this;i.isSelectorClick||(i.firstReloadSelected=!1,i.component.removeSelect())},fireEntityRowClick:function(e){var t=this;if(t.invokeSelOp("fireRowChanged",e),t.pagerPxy&&t.pagerPxy.setCurrSelectNumber){var i=t.invokeSelOp.call(t,"getSelectedRows"),a=i.length;t.pagerPxy.setCurrSelectNumber(a,e.field)}},getUIFocusedRowId:function(e){return this.getUIFocusedCellData(e).rowId},getUIFocusedCellData:function(t){var i=this,a={rowId:-1,field:""},n=a;try{var o=(t&&t.sender?t.sender:i.getKendoGrid(),i.getCurrentElement());if(o&&o.length>0){var r=e("[data-field]",o).data();r&&void 0==r.rowid&&(r.rowid=e("[data-field]",o).attr("data-rowId")),r&&void 0!==r.rowid?n={rowId:void 0===r.rowid?-1:r.rowid,field:r.field}:o.closest(".k-grid-content").length>0&&(r=o.prev().find("[data-field]").data(),r&&void 0!==r.rowid&&(n.rowId=r.rowid))}}catch(s){n=a}return n},onBatchChange:function(e){var t=this.getUIFocusedCellData(e);this.onChange(t)},onChange:function(e){var t=this;t.isInColSelection||t.fireEntityRowClick(e)},onCellSelect:function(e){var t=this;t.invokeSelOp("fireCellChanged",e)},afterSaveCell:function(e,t,i){var a=KDkendoStore.getSvrFieldName(t),n=this.store.getColumnDescriptor.call(this.store,a);if(!(n&&n.isF7||n&&n.xtype&&"kdflextextfield"==n.xtype||n&&("kdmulticombo"==n.xtype||"kdcombo"==n.xtype))){var o=(this.getFormProxy(),e);n?n.setSvrValue.call(n,o,i):this.store.updateSvrValue.call(this.store,o,a,i),n&&n.sumType}},onTopClick:function(e){var t=this.getFormProxy();t&&t.scrollToTop&&t.scrollToTop.call(t)},resizeStop:function(e,t){},recalcVScroll:function(t,i,a){var n=this,o=n.getKendoGrid();if(o){if(a&&KD.isNumber(t))KD.isFunction(o.setOptions)&&o.setOptions({height:t});else if(t!=i&&void 0!==t&&KD.isNumber(t)&&(o.options&&(o.options.height=t),e(o.element).height(t),KD.isFunction(o.resize)&&o.resize(!0),!n.isVirualScrollMode()))return;o&&o.virtualScrollable&&(o._rowHeight=void 0,KD.isFunction(o.virtualScrollable.refresh)&&o.virtualScrollable.refresh())}},loadComplete:function(t,i){var a=this;a.refreshingDataFlag=!1;var n=e(".k-filter-row",a.el).find("input");n.attr("placeholder",ResManager.LoadKDString("过滤条件","0991733000003935")).addClass("kd-grid-filter-cell-input");var o=a.el.find(".k-grid .k-grid-header .k-grid-header-wrap thead tr th");e.each(o,function(t){var i=e(o[t]);i.attr({title:i.attr("data-title")})}),KD.setAsynchronousFilter(n);var r=a.getStore(),s=r?r.getRowCount.call(r):-1;if(s>0&&a.invokeSelOp.call(a,"svrCmdSelectedChanged","current"),e(".k-grid-content-locked",this.el).length>0){var l=e(".k-grid-content",this.el).find(".k-selectable").css("width"),d=e(".k-grid-footer-wrap",this.el).find("table").css("width");l!=d&&e(".k-grid-footer-wrap",this.el).find("table").css({width:l})}a.isDontLazy()||(a.isUpdateViewAfterActivated=!0),a.setNoDataBgCenterShow(),a.repairNoDataGridHeadCover(),a.onGridDataRefreshReady({isBulkUpdating:!0},a.editTdStatus),this.handlerSetFilterString()},justUpdateValRowId:-100,storeData:function(e,t,i){if(!(this.isInit||void 0!=this.config.isForBatchFilter&&this.config.isForBatchFilter)){var a=this.getFormProxy();if(a){var n=this.store.getColumnDescriptor.call(this.store,t);if(!n)return;var o=n.getFieldName.call(n);if(e||0==e||(e=-1),this.justUpdateValRowId=this.checkRowId(e),n&&n.editor&&n.editor.fireUpdate)if("propertyfield"==n.xtype){var r=this.store.rows[e];a.fireEvent.call(a,"UpdateValue",r.PropertyKey,i,0)}else a.fireEvent.call(a,"UpdateValue",o,i,this.justUpdateValRowId);else a.storeData.call(a,o,i,this.justUpdateValRowId);this.justUpdateValRowId=-100}}},batchValueChanged:function(e,t,i){var a=this.getFormProxy();a&&e&&t&&(void 0==i&&(i=!1),a.batchStoreData.call(a,t),i?(a.lockControl.call(a,this),a.fireEvent.call(a,"BatchUpdateValue")):this.setRefreshGridDataFlag(!0))}})}(jQuery),function(e){e.extend(KDKendoGridProxy.prototype,{setFocusRowIndex:function(t,i){var a=this;if(t=parseInt(t),!(isNaN(t)||0>t)){var n=void 0===i?!1:i;if(!n){var o=a.invokeSelOp("getFocusedRowId");if(o==t&&1!=a.isNeedSynFocusState)return}var r=a.getUIFocusedCellData(),s=e.extend(r,{rowId:t});try{a.invokeSelOp("clearUISelection"),a.isNeedSynFocusState=void 0}catch(l){if(KD.writeLog(kendo.format("setFocusRowIndex->clearUISelection  error(rowid = {0})! for the grid's datasource is null",t),"",!0),a.selOp)return a.invokeSelOp("svrCmdSelectedChanged",KD.stringify(t)),void(a.isNeedSynFocusState=!0)}if(a.invokeSelOp("svrCmdSelectedChanged",KD.stringify(t)),s.noSync=!0,s.isSyncSvrEvent=n,a.invokeSelOp("fireRowChanged",s),!a.focusRowIndexNotScroll&&KD.isEmpty(s.field)){var d=e("tbody tr [data-rowId="+s.rowId+"]",a.gridEl).closest("td");e(d.find(":kendoFocusable")[0]).focus(),a.setLastFocusTD(s),this.lastScrollPS=a.getScrollPosition()}a.setGridCurrFocusRowInPage(s.rowId,s.field)}},setFocusRowIndexNotScroll:function(e){this.focusRowIndexNotScroll=e?!0:!1},setGridCurrFocusRowInPage:function(t,i){var a=0;if(!(0>t||KD.isEmpty(t))){var n=this.getStore.call(this);if(n&&e.isArray(n.rows)){var o=this.getKendoGrid(),r=o&&o.dataSource;if(r&&n.rows.length>r._pageSize){var s=r.sort()||[],l=n.rows,d={};s.length>0&&(d.sort=s[0]);var c=o.dataSource.filter();c&&c.filters&&c.filters.length>0&&(d.filter=c),KD.isEmpty(d)||(l=kendo.data.Query.process(l,d),l=l.data||[]);for(var h=0;h<l.length;h++){var u=l[h];if(u.rowId==t){a=h;break}}var p=Math.ceil((a+1)/r._pageSize);if(r.page(p),!this.focusRowIndexNotScroll){var g;KD.isEmpty(i)?(g=e("tbody tr [data-rowId="+t+"]",$this.gridEl).closest("td"),e(g.find(":kendoFocusable")[0]).focus()):(g=this.getTdByFieldAndRowId(i,t),this.editCell(g))}}}}},setFocusCell:function(e,t){var i=this;if(!(0>e)){var a=i.gridEl.find("tbody tr:eq("+e+') td [data-field="'+t+'"]').parents("td");a&&a.length>0&&i.editCell(a)}},setMoveFirstRowIndex:function(e){this.setFocusRowIndex(e)},setMoveLastRowIndex:function(e){this.setFocusRowIndex(e)},setMoveNextRowIndex:function(e){this.setFocusRowIndex(e)},setMovePreviousRowIndex:function(e){this.setFocusRowIndex(e)},getColumnView:function(e){var t=this,i=t.getKendoGrid(),a=i.columns,n={width:0};for(var o in a){var r=a[o];if(KD.equalsIgnoreCase(r.field,e)){n=r;break}}return n},getServicePara:function(t){var i={},a=[],n=[],o=this.getKendoGrid().columns,r=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.columns?r(i.columns):n.push({colKey:i.field,width:parseInt((i.width||"0").toString().replace("px","")),title:i.title})}};r(o);for(var s=0;s<n.length;s++){var l=n[s],d=this.store.getColumnDescriptor(l.colKey)||{};if(!KD.isEmpty(d.config)&&l.width>0&&!KD.IsNullOrWhiteSpace(d.config.header)){var c=KD.cloneObject(d.config);e.extend(c,{header:c.header||"",width:parseInt(l.width),visible:!0}),a.push(c)}}if(i.columns=a,i.Key=this.getKey(),i.TotalRowCount=this.store.length,i[KD.KDPrintConst.DataUrl]=this.dataUrl,i[KD.KDPrintConst.PrintConfig]=t,void 0!=t.PrintPageSetting&&""!=t.PrintPageSetting){var h=KD.parseObject(t.PrintPageSetting),u=["ListHeaderColor","ListSingleColor","ListDoubleColor","ReportTeamColor"];for(var s in u)h[u[s]]=KD.rgbToHex(h[u[s]]);t.PrintPageSetting=KD.stringify(h)}var p={};return p[KD.KDPrintConst.ServicePara]=i,p[KD.KDPrintConst.PageBuilder]=KD.PrintMode.ListPrint,p[KD.KDPrintConst.GridKey]=this.getKey(),p},printPreview:function(e){var t,i=this.getFormProxy();i&&i.printPreview&&(t=this.getServicePara(e),t[KD.KDPrintConst.OperationKey]="Preview",t[KD.KDPrintConst.PageId]=i.getPageId(),i.printPreview.call(i,t))},print:function(e){var t,i=this.getFormProxy();i&&i.print&&(t=this.getServicePara(e),t[KD.KDPrintConst.OperationKey]="PrintAnsy",t[KD.KDPrintConst.PageId]=i.getPageId(),i.print.call(i,t))},appendRows:function(e){this.appendRowsCore(e)},appendRowsNoFocus:function(e){this.appendRowsCore(e,!1)},appendRowsCore:function(t,i){i=0!=i;var a=this,n=a.store.appendRows.call(a.store,t,function(e){a.setRefreshGridDataFlag(!0)});if(i){var o=a.store.getRowId.call(a.store,n);0>o&&(o=0)}else o=a.getUIFocusedRowId();var r=e.extend(a.getUIFocusedCellData(),{rowId:o});a.invokeSelOp("afterRowDataChange",r),a.hideBlock()},isClientNewRow:function(e){var t=this,i=!1,a=t.getUIFocusedRowId();return i=t.store.isClientNewRow.call(t.store,e,a)},isSelectedRow:function(e){return this.invokeSelOp("isSelectedRow",e)},insertRow:function(t,i,a){var n=this;null==a&&(a=!0),focusNewRow=!0;var o=new Array(i);n.store.insertRows.call(n.store,t,o,a,function(e){n.setRefreshGridDataFlag(!0)});if(focusNewRow){var r=t;0>r&&(r=0);var s=e.extend(n.getUIFocusedCellData(),{rowId:r});n.invokeSelOp("afterRowDataChange",s)}n.hideBlock()},setIsSatyFocusHandlerWhenDelRow:function(e){this.isStayFocusHandlerWhenDelRow=e},deleteRow:function(e){try{var t=[];t.push(e);var i=!1,a=this.getUIFocusedRowId();e==a&&(i=!0),this.deleteRows(t,i)}catch(n){KD.writeError(n)}},deleteRows:function(t,i){var a=this,n=a.store.deleteRows.call(a.store,t,function(e){a.setRefreshGridDataFlag(!0)}),o=a.store.getRowCount.call(a.store);if(i&&o>0){var r=n-1;a.isStayFocusHandlerWhenDelRow&&(r=n,r>=o&&(r=o-1)),r=r>0?r:0;var s=a.store.getServerRowId.call(a.store,r),l=e.extend(a.getUIFocusedCellData(),{rowId:s});KD.writeLog(" lastFocusTD deleteRows","setLastFocusTD and obj.rowId = "+l.rowId+"    obj.field= "+l.field,!0),a.setLastFocusTD(l),a.invokeSelOp("afterRowDataChange",l)}a.hideBlock()},exchangeRowIndexs:function(e,t,i,a,n){if(!KD.isEmpty(e)&&!KD.isEmpty(t)){var o=parseInt(String(e)),r=parseInt(String(t));i=i||"",a=a||"",n=KD.isEmpty(n)?!0:n,this.exChangeRows(o,r,i,a,n)}},exChangeRows:function(t,i,a,n,o){var r=this,s=r.store.exChangeRows.call(r.store,t,i,a,o,function(e){r.setRefreshGridDataFlag(!0)});if(o&&s){var l=this.store.getRowIndexByServerRowId(i);0>l&&(l=0);var d=e.extend(r.getUIFocusedCellData(),{rowId:l});r.invokeSelOp("afterRowDataChange",d)}r.hideBlock()}})}(jQuery),function(e){e.extend(KDKendoGridProxy.prototype,{pageCols:0,currentColPageIndex:1,isEnableColPager:function(){var e=!1,t=this.getColPager(),i=this.config||{},a=i.enableColPager||!1;return(a||!KD.isEmpty(t))&&this.getPageCols()>0&&(e=!0),e},setColPagerKey:function(e){this.config.colpagerkey=e,this.initColPager()},setPageCols:function(e){var t=this,i=t.getColPager(),a=t.config||{},n=a.enableColPager||!1;n||!KD.isEmpty(i)?t.pageCols=e:t.pageCols=0},getPageCols:function(){return this.pageCols||0},initColPagerData:function(){var e=this,t=e.getColPager(),i=e.getPageCols(),a=e.getStore();if(a&&t){var n=a?a.getColPageOptions.call(a,i):void 0,o=e.totalColPages=n?n.totalPages:1;n&&t&&(t.setUnfixedPageCols.call(t,n.unfixedPageCols),t.setTotalPages.call(t,o)),e.setColPagerTooltip(n)}},initColPager:function(){var e=this,t=e.config,i=t.enableColPager||!1;if(i){var a=t.pagecols||e.pageCols,n=e.getColPager(),o=n&&n.getKey.call(n),r=e.getFormProxy(),s=e.controlFactoryProxy;if(e.setPageCols(a),o&&t.colpagerkey&&o!=t.colpagerkey.toUpperCase()&&(n.release&&n.release.call(n),delete e.getColPager()),t&&t.colpagerkey&&r)n=s.controls[t.colpagerkey.toUpperCase()],e.colPagerProxy=n;else for(var l in s.controls){var d=s.controls[l];if(d.config&&"kdcolpager"==d.config.xtype&&d.gridKey.toUpperCase()==e.getKey()){n=d;break}}n&&(e.colPagerProxy=n,e.initColPagerData(),a=n.getPageCols.call(n),e.setPageCols(a))}},getColPager:function(){return this.colPagerProxy},setColPager:function(e){var t=this,i=e.getKey.call(e),a=e.getPageCols.call(e)||t.pageCols;t.colPagerProxy=e,t.setPageCols(a),t.config&&(t.config.colpagerkey=i,t.initColPagerData())},doColPagerKeyCmd:function(e){var t=this,i=t.getColPager();if(("PageDown"==e||"Next"==e)&&(e="pagedown"),"PageUp"==e&&(e="pageup"),i)i.doColPagerKeyCmd&&i.doColPagerKeyCmd.call(i,e);else{var a=t.currentColPageIndex||1;"pageup"==e?a-=1:a+=1,t.colPagerTurning(a)}},getCurColPageCols:function(){var e=this,t=e.currentColPageIndex,i=e.getPageCols(),a=e.getStore(),n=e.getColPager(),o=a?a.getColPageOptions.call(a,i):void 0,r=[];if(a){1>=t?t=e.currentColPageIndex=1:t>o.totalPages&&(t=e.currentColPageIndex=o.totalPages);var s=o.unfixedCols,l=o.fixedCols,d=o.sysCols,c=o.unfixedPageCols,h=c*(t-1),u=c*t;for(var p in d)r.push(d[p]);
for(var p in l)r.push(l[p]);h=0>h?0:h,u=u>=s.length?s.length:u;for(var p=h;u>p;p++)r.push(s[p]);return n&&(n.setUnfixedPageCols.call(n,o.unfixedPageCols),n.setTotalPages.call(n,o.totalPages)),e.setColPagerTooltip(o),r}},setColPagerTooltip:function(e){if(!KD.isEmpty(e)){var t=this,i=t.getColPager(),a=t.isEnableColPager(),n=KD.format(ResManager.LoadKDString("当前第{0}页,总共{1}页;\r\n每页{2}列, 固定{3}列;\r\n总共{4}列;","0991733000003894"),t.currentColPageIndex,e.totalPages,t.getPageCols(),e.fixedPageCols,e.totalCols);i?i.updateTitles.call(i,e.fixedPageCols,e.totalCols):a&&t.gridPanel&&t.gridPanel.attr({title:n})}},colPagerTurning:function(e){var t=this;t.currentColPageIndex=e,t.setRefreshGridDataFlag(!0)}})}(jQuery),function(e){e.extend(KDKendoGridProxy.prototype,{setEditorZoomIn:function(e){this.isEditorZoomIn=e},setIsRedBlue:function(e){this.store&&this.store.setIsRedBlue.call(this.store,e),this.resetRedBlue()},resetRedBlue:function(){},setCellTemplateKey:function(e){this.store&&this.store.setCellTemplateKey.call(this.store,e)},setColumnExtandEditorConfig:function(e){for(var t in e){var i=e[t],a=this.store.getColumnDescriptor.call(this.store,i.key);if(a&&delete i.key,a&&a.editor)for(var n in i)i.hasOwnProperty(n)&&!a.editor.hasOwnProperty(n)&&(a.editor[n]=i[n]);if(a&&a.config)for(var n in i)i.hasOwnProperty(n)&&!a.config.hasOwnProperty(n)&&(a.config[n]=i[n])}},setFrozen:function(e){var t=this.getStore(),i=e||{};t&&t.setFrozenObj&&(t.setFrozenObj.call(t,e),t.resetVisibleCols(),i.isInit||(t.setUpdateView.call(t,!0),this.setRefreshGridDataFlag(!0)))},updateCFmtInfo:function(e){var t=this;t.store.updateCFmtInfo.call(t.store,e),t.store.setUpdateView.call(t.store,!0),t.setRefreshGridDataFlag(!0)},SimplizationColumns:function(e){this.simplizationColumns(e)},simplizationColumns:function(e){var t=e;if(!KD.isEmpty(t)){var i=this.getStore();for(var a in t){var n=t[a]+"",o=i.getColumnDescriptor.call(i,n);o&&(this.config&&this.config.showFilterRow?o.setSimplization.call(o,!1,this.config.showFilterRow):o.setSimplization.call(o))}}},simplizationAllColumns:function(){var e=this.getStore(),t=e.getColumnDescriptors.call(e);for(var i in t){var a=t[i];a&&a.setSimplization.call(a)}this.setAllowSorting(!1)},sortColumns:function(e){this.sortColumnsInner(e,!0)},sortColumnsInner:function(e,t){var i=this,a=e,n=i.getStore(),o=KD.getValue(a,"SortColumns",{});if(!KD.isEmpty(o)){if(!n.isMultiSort){var r=n.getColumnDescriptors.call(n);if(r)for(var s in r){var l=r[s];l&&l.setSort.call(l,0,t)}}var d=[];for(var c in o){var h=n.getColumnDescriptor.call(n,(c||"").toUpperCase());if(h){var u=o[c];if(u>0&&d.push({fieldName:c,sortOrder:u-1}),h.setSort.call(h,u,t),!n.isMultiSort)break}}if(t)n.setUpdateView.call(n,!0),i.setRefreshGridDataFlag(!0);else{var p=this.getFormProxy();p&&p.fireCustomEventsNoData.call(p,this.getKey(),"SortChanged",JSON.stringify({SortInfo:d}))}}},setIngoreCleanFilterstring:function(e){this.ingoreCleanFilterstring=e},setFilterString:function(e){this.serverFilterString=this.serverFilterString||[],this.serverFilterString.push(e),this.setFilterStringInner(e,!0)},setFilterStringInner:function(e,t,i){var a=this,n=a.getStore();if(1!=a.ingoreCleanFilterstring||!KD.isEmpty(e))if(KD.isEmpty(e)){if(KD.isEmpty(e)&&t&&n){var o=n.getColumnDescriptors.call(n);for(var r in o)if(KD.isRunInForIn(r,o)){var s=o[r];s&&s.resetFilter&&s.resetFilter.call(s)}t&&0!=i&&(n.setUpdateView.call(n,!0),a.setRefreshGridDataFlag(!0))}}else{var l={};if(t){var d="=",c="eq",h=" in ",u=[],p="",g="";if(e.indexOf(h)>=0){var f=e.split(h);if(f.length>1){p=(f[0]+"").trim(),g=(f[1]+"").trim();var m=new RegExp("\\(","g");g=g.replace(m,""),m=new RegExp("\\)","g"),g=g.replace(m,""),f=g.split(",");for(var v=0;v<f.length;v++)u.push(p+" "+d+" "+f[v])}}else e.indexOf(d)<=0&&(d="<>",e.indexOf(d)<=0&&(d="<",e.indexOf(d)<=0&&(d=">"))),u.push(e);l.filters=[];for(var y=0;y<u.length;y++){var b=u[y],D=b.split(d);if(D.length>1){var k=new RegExp("'","g");D[1]=(D[1]+"").trim().replace(k,""),l.field=D[0]=(D[0]+"").trim(),l.filters.push({field:D[0],operator:c,value:D[1]})}}}else l.field=e.field,l.filters=e.filter?e.filter.filters:[];if(!KD.isEmpty(l)&&KD.isArray(l.filters)&&!KD.isEmpty(l.field)){var C=n.getColumnDescriptor.call(n,(l.field||"").trim().toUpperCase());if(C){C.resetFilter();for(var y=0;y<l.filters.length;y++)C.setFilter.call(C,l.filters[y],t);a.invokeFilterChangedAfterReflash=a.invokeFilterChangedAfterReflash||{},a.invokeFilterChangedAfterReflash[C.dataIndex]=!0}t&&0!=i&&(n.setUpdateView.call(n,!0),a.setRefreshGridDataFlag(!0))}}},setFilterInner:function(e,t){this.columnsFilterList=this.columnsFilterList||{},e&&(KD.isEmpty(t)?delete this.columnsFilterList[e]:this.columnsFilterList[e]={field:e,filter:{filters:t,logic:"or"}})},revertGridStatesInner:function(){var e=this;if(1==e.ingoreCleanFilterstring&&!KD.isEmpty(e.columnsFilterList)){var t=KD.cloneObject(e.columnsFilterList);for(var i in t)KD.isRunInForIn(i,t)&&e.setFilterStringInner(t[i])}},editCell:function(e){var t=this;if(e&&!e.hasClass("k-edit-cell")){var i=t.getKendoGrid();if(i){var a=e.parent("tr");a.length>0&&i.select&&i.select(a),i.current&&i.current(e);var n=t.getUIFocusedCellData.call(t),o=this.store.getColumnDescriptor.call(this.store,n.field),r=o&&o.xtype;this.notEditCellWhiteXtype.indexOf(r)>-1||!this.isEditable()||i.editCell&&i.editCell(e),KDStore.isColSelector(n.field)||(t.onChange&&t.onChange.call(t,n),t.onCellSelect&&t.onCellSelect.call(t,n))}}},justFocusCell:function(e,t){var i=this;if(!(0>e)){var a=i.gridEl.find("tbody tr [data-rowId="+e+'][data-field="'+t+'"]').parents("td");if(a&&a.length>0&&a&&!a.hasClass("k-edit-cell")){var n=i.getKendoGrid();if(n){a.parent("tr");n.current&&n.current(a);var o=i.getUIFocusedCellData.call(i);this.store.getColumnDescriptor.call(this.store,o.field);KDStore.isColSelector(o.field)||(i.onChange&&i.onChange.call(i,o),i.onCellSelect&&i.onCellSelect.call(i,o))}}}},closeEditCell:function(e){var t=this;if(e&&!e.hasClass("k-edit-cell")){var i=t.getKendoGrid();i&&i._removeCurrent&&i._removeCurrent(e),i&&i.closeCell&&i.closeCell(e)}},setLastNavigateTD:function(e){e&&(this.lastNavigateTD=e,KD.writeLog("LastNavigateTD ","setLastNavigateTD and obj.rowId = "+e.rowId+"    obj.field= "+e.field,!0))},setLastFocusTD:function(e){if(e){this.lastFocusTD=e;var t=this.getFormProxy();t.setLastFocusGridTD.call(t,this.getKey(),this.lastFocusTD)}},getLastFocusTD:function(){var e=this.getFormProxy(),t=e.getLastFocusGridTD.call(e,this.getKey());return t},getLocalConfiguration:function(){return KD.isEmpty(this.localConfiguration)&&(this.localConfiguration=KD.getLocalConfiguration()),this.localConfiguration}})}(jQuery),function(e){e.extend(KDKendoGridProxy.prototype,{C_tbBlockPasting:"__tbBlockPasting",C_tbBlockPastingAutoAssgin:"__tbBlockPastingAutoAssgin",C_tbDisplayOnlyValueCopy:"__dpColValueCopy",C_tbColSelection:"__dpColSelection",C_tbUnColSelection:"__dpUnColSelection",allowBlockPasteAutoAssignBtn:null,getDefaultCtxBar:function(){var e={showicon:!1,id:"ToolBar",xtype:"toolbar",visible:!0,items:[]};if(this.AllowBlockPaste){var t={showicon:!1,xtype:"button",id:this.C_tbBlockPasting,isSpecCtxBtn:!0,showTitle:!0,validation:!1,text:ResManager.LoadKDString("块粘贴","002549030024567"),tooltipType:"title",tooltip:ResManager.LoadKDString("块粘贴","002549030024567"),visible:!0,showprocessbar:!0};e.items.push(t)}var i=this.isTreeList?!1:!0,a={showicon:!1,xtype:"button",id:this.C_tbDisplayOnlyValueCopy,isSpecCtxBtn:!0,showTitle:!0,validation:!1,text:ResManager.LoadKDString("复制","014005030024903"),tooltipType:"title",tooltip:ResManager.LoadKDString("复制","014005030024903"),visible:i,showprocessbar:!1};e.items.push(a);var n=KD.getConnectConfig()&&KD.getConnectConfig().allowCellSection;if(this.allowCellSection=this.isTreeList||!n?!1:!0,this.allowCellSection){var o={showicon:!1,xtype:"button",id:this.C_tbColSelection,isSpecCtxBtn:!0,showTitle:!0,validation:!1,text:ResManager.LoadKDString("块选择","0021235030028736"),tooltipType:"title",tooltip:ResManager.LoadKDString("块选择","0021235030028736"),visible:!0,showprocessbar:!1};e.items.push(o);var r={showicon:!1,xtype:"button",id:this.C_tbUnColSelection,isSpecCtxBtn:!0,showTitle:!0,validation:!1,text:ResManager.LoadKDString("取消块选择","0021235030028737"),tooltipType:"title",tooltip:ResManager.LoadKDString("取消块选择","0021235030028737"),visible:!0,showprocessbar:!1};e.items.push(r)}return e},_isShowContextMenu:function(){var t=!1,i=e(this.getCurrentElement());if(i.hasClass("k-state-focused")||i.hasClass("k-edit-cell")){var a=this.getUIFocusedCellData();a&&a.field&&(t=!0,this._checkContextMenuItemsState(a))}return t},_checkContextMenuItemsState:function(t){if(!KD.isEmpty(this.allowBlockPasteAutoAssign)){t=t||{};var i=t.field,a=!1;if(!KD.isEmpty(i))for(var n=0;n<this.allowBlockPasteAutoAssign.length;n++){var o=this.allowBlockPasteAutoAssign[n];if(KD.equalsIgnoreCase(o,i)){a=!0;break}}var r=e(this.allowBlockPasteAutoAssignBtn);a?r.show():r.hide()}},doSpecCtxCmd:function(t,i){var a=this;if(t.id==this.C_tbBlockPasting?this.fireBlockPasting():t.id==this.C_tbBlockPastingAutoAssgin&&this.fireBlockPasting(KD.CONST.CustomEventName.KDEntityBlockPastingAutoAssign),this.isContextMenuBlockCopy(t)){var n=a.getKendoGrid();if(n.kdDoCopySelected){var o=e(a.getCurrentElement()),r=i;KD.isEmpty(i)&&(o.length>0&&o.hasClass("k-state-focused")||o.hasClass("k-edit-cell"))&&(r=o.find(".kd-grid-cellspan").text()),n.kdDoCopySelected(r)}}this.isContextMenuBlockSelection(t)&&!this.isInColSelection&&(a._setInColSelectionState(!0),a.onRefreshGridData(),a.tbarPxy&&a.tbarPxy.setAllItemsDisabled&&a.tbarPxy.setAllItemsDisabled(!0),KD.delayInvoke(function(){a.doLayout.call(a),e(".k-marquee").remove()},100)),this.isContextMenuCancelBlockSelection(t)&&this.isInColSelection&&(a._setInColSelectionState(!1),a.onRefreshGridData(),e(".k-marquee").remove(),a.tbarPxy&&a.tbarPxy.setAllItemsDisabled&&a.tbarPxy.setAllItemsDisabled(!1))},isContextMenuBlockCopy:function(e){return e=e||{},e.id===this.C_tbDisplayOnlyValueCopy},isContextMenuBlockSelection:function(e){return e=e||{},e.id===this.C_tbColSelection},isContextMenuCancelBlockSelection:function(e){return e=e||{},e.id===this.C_tbUnColSelection},_setInColSelectionState:function(e){var t=this;if(t.isInColSelection=e,t.isViewGrid()){var i=t.store&&t.store.getColumnDescriptor&&t.store.getColumnDescriptor.call(t.store,"SELECTED");i&&i.setVisible(!e)}},showClipboard:function(t){var i=this,a=e(KD.format("<div id='clipboard'><div id='clipboardText'><textarea id='clipboardTextarea'></textarea></div><div id='clipbordRemark'><span> {0}</span></div><div id='clipboardBtnList'><button id='clipboardOK' class='k-button k-primary'>{1}</button><button id='clipboardCancel' class='k-button'>{2}</button></div></div>",ResManager.LoadKDString("*请ctrl+v复制内容到上面文本框中，然后点击确定。","0025372030032936"),ResManager.LoadKDString("确定","0025372030032937"),ResManager.LoadKDString("取消","0025372030032938")));a.appendTo(e(document.body));var n=a.kendoWindow({modal:!0,autoFocus:!0,title:ResManager.LoadKDString("请把内容复制到文本框内","0025372030032935"),pinned:!0,height:470,width:450,actions:[],close:function(e){a.parent().remove()}}).data("kendoWindow");n.center().open(),a.find("#clipboardTextarea").focus(),a.find("#clipboardOK").off("click").on("click",function(a){var o=e("#clipboardTextarea").val();t.call(i,o),n.close()}),a.find("#clipboardCancel").off("click").on("click",function(e){n.close()})},setAllowBlockPaste:function(e){this.AllowBlockPaste=e},setAllowBlockPasteAutoAssign:function(e){var t=e&&e.FieldKeys||e,i=(t+"").split(",");if(this.ctxBarPxy&&void 0==this.allowBlockPasteAutoAssign){this.allowBlockPasteAutoAssign=i;var a={showicon:!1,xtype:"button",id:this.C_tbBlockPastingAutoAssgin,isSpecCtxBtn:!0,customCssClass:"kd-grid-blockPasteAutoAssign",showTitle:!0,validation:!1,text:ResManager.LoadKDString("块粘贴并自动申请分配","0991733000005842"),tooltipType:"title",tooltip:ResManager.LoadKDString("块粘贴并自动申请分配","0991733000005842"),visible:!0,showprocessbar:!0},n=this.C_tbBlockPasting,o=this.ctxBarPxy.getBarItemById&&this.ctxBarPxy.getBarItemById(n,!0);if(!o&&this.ctxBarPxy.config)if(KD.isArray(this.ctxBarPxy.config.items)){var r=this.ctxBarPxy.config.items||[],s=r[r.length-1];n=s.id}else this.allowBlockPasteAutoAssign=void 0;this.ctxBarPxy.addItem(a,n),this.allowBlockPasteAutoAssignBtn=this.ctxBarPxy.getBarItemById&&this.ctxBarPxy.getBarItemById(this.C_tbBlockPastingAutoAssgin,!0)}else this.allowBlockPasteAutoAssign=i},doBlockPasting:function(e,t){var i=this,a="",n=i.getStore(),o=i.getUIFocusedCellData();if(e){for(var r=n.getVisibleCols.call(n),s=0;s<r.length;s++){var l=r[s],d=l.getFieldName.call(l);a+=","+d}a.length>0&&(a=a.substr(1),a+="\r\n"),a+=e;var c=i.getFormProxy(),h=n.revertKendoFieldName.call(n,o.field);t=t||KD.CONST.CustomEventName.KDEntityBlockPasting,c.fireEventNoData.call(c,t,(h||"").toUpperCase(),a,o.rowId,null)}},fireBlockPasting:function(t){var i=this,a=(i.getStore(),"");i.getUIFocusedCellData();return KD.isIeBrowser()?(e(document.body).unbind("paste").bind({paste:function(n){var o=n.originalEvent,r=o?o.clipboardData:void 0,s=window.clipboardData;s||(s=r),s?(a=s.getData("Text"),i.doBlockPasting(a,t)):alert(ResManager.LoadKDString("当前浏览器不支持粘贴板操作！请使用IE浏览器！","0991733030034191")),e(document.body).unbind("paste")}}),void e(document.body).trigger("paste")):void i.showClipboard(function(e){a=e,i.doBlockPasting(a,t)})}})}(jQuery),function(e){e.extend(KDKendoGridProxy,{C_ListMaxPageCount:1500,getProxyBySender:function(e){var t=e&&e.sender?e.sender.options||{}:{},i=t.kdPageId,a=t.kdGridKey,n=i?ClientAppProxy.Current.getAliveForm(i):void 0,o=n&&a?n.getControlProxy.call(n,a):void 0;return o}})}(jQuery),KDControlFactoryProxy.registerType("kdgrid",KDKendoGridProxy),KDKendoGridProxy_Galaxy=KD.extend(KDKendoGridProxy,{rowHeight:39,isIgnoreLocalColReset:void 0,createControl:function(e){KDKendoGridProxy_Galaxy.superclass.createControl.call(this,e),this.el.addClass("kd-gird-base-galaxy")},initPager:function(){this.config.pagerstyle="kdpager_Galaxy",KDKendoGridProxy_Galaxy.superclass.initPager.call(this),this.pagerPxy.gotoPageCallBack=this.isEditable()||this.config.isforceswitchPage?this.switchPage:this.gotoPage},getLocalConfiguration:function(){var e=KDKendoGridProxy_Galaxy.superclass.getLocalConfiguration.call(this),t=KD.cloneObject(e);return(t.DefaultRowBackground||"").toLocaleLowerCase()==(t.SelectRowBackground||"").toLocaleLowerCase()&&(t.DefaultRowBackground="#EFF5FF",t.SelectRowBackground="#EFF5FF"),t}}),KDControlFactoryProxy.registerType("kdgrid_Galaxy",KDKendoGridProxy_Galaxy),KDKendoGridProxy_Voucher=KD.extend(KDKendoGridProxy_Galaxy,{KDGridDynamicF7PopupContainerName:"KDGridDynamicF7PopupContainerObject",addDynamicForm:function(e,t){this.closeChildForm(!0),this.childForm=e;var i=e.getControl();$this=this,$this.isFormSlip&&($this.marqueeItemList=$this.marqueeItemList||[],$.each($this.marqueeItemList,function(e){var t=$this.marqueeItemList[e];t.el&&t.el.hide()}),$this.marqueeItemList.push(e),$this.currentShowFormIndex=$this.marqueeItemList.length-1);var a=$this.getFormAppendDom(t);this.childForm.formAppendDomObj=a,a&&a.dynamicformContainer&&(i.appendTo(a.dynamicformContainer),e[$this.KDGridDynamicF7PopupContainerName]=a)},getFormAppendDom:function(e){var t=null,i=this.getUIFocusedCellData(),a=this.store.getColumnDescriptor.call(this.store,i.field);return a&&a.getFormAppendDom&&(t=a.getFormAppendDom.call(a,e)),t},closeWindow:function(e,t){if("kdPopupMainMenuProxy"==this.config.xtype)this.closePopUpDirect();else{var i=this.getContentFormProxy(this),a=this.getControlFactoryProxy();if(a.removeForm.call(a,i),t){var n;if(this.childForm&&this.childForm.getPageId()==t?n=this.childForm:this.childForms&&(n=this.childForms[t]),n&&$(document).find(n.el).length>0){n.el.remove();var o=n[this.KDGridDynamicF7PopupContainerName];if(o&&o.dynamicformContainer&&o.dynamicformContainer.is(":Visible")){var r=this.getKendoGrid();r.closeCell.call(r)}}}}},closeChildForm:function(e){if(this.childForm)try{!e&&this.childForm.formAppendDomObj&&this.childForm.formAppendDomObj.closePopup&&this.childForm.formAppendDomObj.closePopup.call(this.childForm.formAppendDomObj),this.childForm.invokeCloseAction.call(this.childForm),this.childForm.formAppendDomObj&&this.childForm.formAppendDomObj.setChildFormIsClosed(!0),delete this.childForm}catch(t){KD.writeError(t.message)}},getContentFormProxy:function(e){var t=this.getControlFactoryProxy(),i=t.getContentFormProxy.call(t,e||this);return i},attachGridEvents:function(){var e=this;KDKendoGridProxy_Voucher.superclass.attachGridEvents.call(e),e.el.undelegate(".kd-grid-element td  .kd-grid-voucher-item-container","mousedown").delegate(".kd-grid-element td  .kd-grid-voucher-item-container","mousedown",function(t){e.onGridCellFocus.call(e,t,!0,!1)})},onGridCellFocus:function(e,t,i){var a=null;if(e&&e.container){var n=e.container.find("[data-rowid]").data();a={field:n.field,rowId:n.rowid}}else a=this.getUIFocusedCellData();this.setLastFocusTD({rowId:a.rowId,field:a.field,isEnterJump:!0}),this.lastNavigateTD=null,a.forceFire=0==i?!1:!0,a.isEnterJump=!0,this.onCellSelect(a)},onCellSelect:function(e){var t=this;e.forceFire&&t.invokeSelOp("fireCellChanged",e)},onGridKeyUp:function(e){var t=this,i=e.keyCode||e.which||e.charCode,a=t.getUIFocusedCellData();null!=t.lastFocusTD&&t.lastFocusTD.field&&(a=t.lastFocusTD);var n=e.target&&"TEXTAREA"==e.target.tagName;if(!this.isEditable()||"voucherkdgrid"!=this.config.xtype&&"kdgrid"!=this.config.xtype&&"kdtreegrid"!=this.config.xtype||t.doDirectionAction.call(t,e,a),13==i&&!e.altKey||13==i&&e.altKey&&!n){if(t.compositioningFlag&&t.compositioningFlag)return;if(t.isViewGrid())return;e.target=t.gridEl.find("tbody tr:eq("+a.rowId+') td [data-field="'+a.field+'"]').parents("td");var o=t.getFormProxy(),r=$(e.target).parents("td").length>0?$(e.target).parents("td").first():$(e.target),s=this.store.getColumnDescriptor.call(this.store,a.field);if(s&&"voucherbosf7field"==s.xtype&&!e.forceFireNextCell)return void this.editCell.call(this,r);var l=this.getKendoGrid();l.clearSelection(),o.navigateTD(r,void 0,void 0,!0)}else if(n&&(1==e.ctrlKey&&96==i||1==e.altKey&&13==i)){var d=$(e.target),c=d.val(),h=KDGetCursorPositon.getSelectionIndex(e.target),u=c.substr(0,h),p=c.substr(h,c.length);c=u+"\r\n"+p,d.val(c),KDGetCursorPositon.setSelectionIndex(e.target,h+1)}},setSummaryData:function(e){var t=this,i=t.getStore();if(i.setSummaryData.call(i,e),KD.isObject(e))for(var a in e){var n=i.converFieldName.call(i,a),o=i.isRedBlue,r=e[a],s=i.getColumnDescriptor.call(i,n);s&&s.getFooterData&&(r=s.getFooterData.call(s,r));var l=$('.k-footer-template [data-field="'+n+'"]',t.gridEl);o?l.addClass(KD.numInfo.redCellCls).text(r):l.html(r)}}}),KDControlFactoryProxy.registerType("voucherkdgrid",KDKendoGridProxy_Voucher),define("KDKendoGridProxy",["KDKendoStore","KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDKendoGridProxy}}(this)),KDPropertyGridProxy=KD.extend(KDControlProxy,{defaultValueRowsName:"value",defaultValueRowsText:"text",store:[],kendoData:[],format:"yyyy-MM-dd HH:mm:ss",createControl:function(e){this.store=[],this.kendoData=[],KDPropertyGridProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDPropertyGridProxy.superclass.loadConfig.call(this,e),this.kendoData=this._formatSource(this.config.propertydescs),this.lazyStateArray=new Array},initComponent:function(){KDPropertyGridProxy.superclass.initComponent.call(this),this.el.addClass("gropertygrid-extend")},getKendoCType:function(){return"kendoGrid"},getKendoOptions:function(){var e=this,t=KDPropertyGridProxy.superclass.getKendoOptions.call(this);return t=$.extend(t,{columns:[{field:"DisplayName",headerTemplate:'<span class="k-link"  tabindex="-1">'+this.config.pncaption||ResManager.LoadKDString("属性","0991733000003980")+"</span>",editor:!1,attributes:{"class":"table-cell",style:" border-bottom-style: solid; border-bottom-width: 1px; text-align: left; padding:3px 15px; font-size: 14px"},editor:function(e,t){var i=$("<div/>");i.text(t.model.DisplayName),i.appendTo(e)}},{field:e.defaultValueRowsText,headerTemplate:'<span class="k-link" style="border: none;" tabindex="-1">'+this.config.pvcaption||ResManager.LoadKDString("值","0991733000003981")+"</span>",encoded:!1,attributes:{style:" border-bottom-style: solid; border-bottom-width: 1px; "},editor:function(t,i){e._entityRowClick(i),e._setCurrentValueEditor(t,i)}}],editable:!0,dataSource:this.kendoData})},createColumnsAndStore:function(){},_entityRowClick:function(e){var t=[],i=0,a=this.component.data("kendoGrid").getOptions().dataSource.data||[];for(i=0;i<a.length&&e.model.uid!=a[i].uid;i++);var t=[];t[0]={FSINGLEROWENTITY:{fieldKey:e.model.Name,row:i,selRows:null,isClientNewRow:!1,clientNewRows:""}},this.getFormProxy().fireEventNoData("EntityRowClick","FSINGLEROWENTITY",i,t)},_setCurrentValueEditor:function(e,t){var i=this,a={};$.each(t.model.Editor,function(e,t){"parent"!=e&&(a[e]=t)}),a.height=e.height(),a.width=e.width(),a.id=t.model.Name;var n=this.getControlFactoryProxy(),o=a.uid?a.uid.toUpperCase():"";n.controls&&n.controls[o]&&(n.controls[o]=null,n.controls[o]=void 0),this.proxy=n.createControl(a),this.proxy.getControl().appendTo(e),this.proxy.loadConfig(a);a.xtype;if(this.proxy.initComponent){var r=a.showEditButton;a.showEditButton=!1,this.proxy.initComponent(),a.showEditButton=r,this.proxy.initColumnDescriptorEditButton(a),this.proxy.getControl().css("position"," relative").addClass("kd-propertygrid-width"),this.proxy.component&&this.proxy.component.css({height:a.height})}if(this.proxy.setDisabled&&this.proxy.setDisabled(a.disabled),this.proxy.setItemContaonerStyle&&this.proxy.setItemContaonerStyle(a.height),a.valueproxy=this.proxy,this.proxy.onchange=function(e,t){var a=i.proxy.component.attr("id");a=a.substring(i.baseId.length+1);var n={text:i.proxy.getText&&i.proxy.getText()||t,value:t};i._setGridStoreFieldstates(a,n,"value"),i._commitValue(a)},this.proxy.setValue&&this.proxy.setValue(t.model[this.defaultValueRowsName]),this.proxy.component?this.proxy.component.attr("id",a.userid):this.proxy.el.attr("id",a.userid),"numberfield"==a.xtype&&this.proxy.component){var s=$("INPUT",this.proxy.component);s&&s.length>0&&s.select&&s.select()}},_setGridStoreFieldstates:function(e,t,i){for(var a=this.getKendoGrid().dataItems(),n=0;n<a.length;n++)if(e&&a[n].Name&&e.toLowerCase()==a[n].Name.toLowerCase()){switch(i){case"value":if(!t.value||"timefield"!=a[n].Editor.xtype&&"datefield"!=a[n].Editor.xtype&&"datetimefield"!=a[n].Editor.xtype)"kdcheckbox"==a[n].Editor.xtype||"kdswitch"==a[n].Editor.xtype?this._updateCheckboxFieldStates(a[n]):a[n][this.defaultValueRowsText]=t.text;else{if(!$.isFunction(t.value.format)){if(KD.isChrome()&&!KD.isEmpty(t.value)&&t.value.replace)var o=t.value.replace("T"," ").replace(/-/g,"/");else var o=t.value;o=kendo.parseDate(o),null==o&&(o=new Date(t.value)),o&&"Invalid Date"!=o&&(t.value=o,t.text=t.value)}t.value=t.value.format?t.value.format(this.format):t.value,a[n][this.defaultValueRowsText]=t.text&&t.text.format?t.text.format(a[n].Editor.displayFormatString||this.format):""}a[n][this.defaultValueRowsName]=t.value,this._updateStoreValue(e,t.value);break;case"disable":case"visible":a[n][i]=t.value}this._updateKendoData(e,i,t.value);break}},_updateKendoData:function(e,t,i){for(var a=0;a<this.kendoData.length;a++)if(this.kendoData[a].Name==e){this.kendoData[a][t]=i;break}},_updateStoreValue:function(e,t){var i=!1,a=0;for(a=0;a<this.store.length;a++)if(this.store[a].key==e){i=!0;break}i?this.store[a].value=t:this.store.push({key:e,value:t})},_commitValue:function(e){var t=this._getCurrentCellValue(e);if(t){var i=this.getFormProxy();return i.fireEvent.call(i,"UpdateValue",t.key,t.value,0,null),!0}return!1},_getCurrentCellValue:function(e){var t=void 0;if(this.store&&e)for(var i=0;i<this.store.length;i++)if(this.store[i].key==e){t=this.store[i];break}return t},setFieldstates:function(e){for(var t=0;t<e.length;t++){var i=e[t],a=i.key;if(!KD.IsNullOrWhiteSpace(a))if(null!=i.value&&void 0!=i.value){var n=i.value,o=n;KD.isArray(i.value)&&(n=i.value[0],i.value.length>1&&(o=i.value[t]));var o=this._isNeedChangeValueToText(i)?this._getComboBoxText(i):o;this._setGridStoreFieldstates(a,{value:n,text:o},"value")}else null!=i.visible&&void 0!=i.visible?this._setGridStoreFieldstates(a,{value:i.visible},"visible"):null!=i.disabled&&void 0!=i.disabled&&this._setGridStoreFieldstates(a,{value:i.disabled},"disabled")}this.getKendoGrid().refresh(),this._refreshCheckboxEcode()},_refreshCheckboxEcode:function(){for(var e=this.getKendoGrid().dataItems(),t=0;t<e.length;t++)("kdcheckbox"==e[t].Editor.xtype||"kdswitch"==e[t].Editor.xtype)&&(dataItem=this.getKendoGrid().table.find("#D_"+e[t].Editor.userid),dataItem.parent("td").addClass("k-edit-cell"))},_updateCheckboxFieldStates:function(e){var t=this;dataItem=this.getKendoGrid().table.find("#D_"+e.Editor.userid),dataItem.find(".k-checkbox").prop("checked",e[this.defaultValueRowsName]===!0||"true"===e[this.defaultValueRowsName]),this._setGridStoreFieldstates(dataItem[0].id.substring(2),dataItem.find(".k-checkbox").prop("checked"),"value"),dataItem.find(".k-checkbox-label").blur(function(e){var i=e.target||e.currentTarget,a={key:i.id.substring(2),value:!dataItem.find(".k-checkbox").prop("checked")};t._setGridStoreFieldstates(a.key,a.value,"value"),t._commitValue(a.key)}),dataItem.parent("td").attr("id",e.uid).attr("fieldName",e.Name).click(function(e){var i={};i.model={};var a=$(e.currentTarget||e.target);i.model.uid=a.attr("id"),i.model.Name=a.attr("fieldName"),t._entityRowClick(i)}),dataItem.parent("td").addClass("k-edit-cell")},getKendoGrid:function(){return this.component.data(this.getKendoCType())},_isNeedChangeValueToText:function(e){var t=!1;if(e.xtype)t="kdcombo"==e.xtype;else for(var i=0;i<this.kendoData.length;i++)if(e.key.toUpperCase()==this.kendoData[i].Name.toUpperCase()&&"kdcombo"==this.kendoData[i].Editor.xtype){t=!0;break}return t},_getComboBoxText:function(e){var t=e[this.defaultValueRowsName]||e.value||"",i=t;t=t.split(",");var a,n=e.Name||e.key||e.Key;if(e&&e.Editor&&e.Editor.store)a=e.Editor.store;else for(var o=0;o<this.kendoData.length;o++)if(n.toLowerCase()==this.kendoData[o].Name.toLowerCase()){a=this.kendoData[o].Editor.store;break}i="";for(var r=0;r<t.length;r++)for(var s=0;s<a.length;s++)if(t[r]==a[s][0]){i+=a[s][1];break}return i},_formatSource:function(e){var t=this;return KD.isArray(e)&&$.each(e,function(e,i){i[t.defaultValueRowsName]=i[this.defaultValueRowsName]||"",i[t.defaultValueRowsText]=t._isNeedChangeValueToText(i.Editor)?t._getComboBoxText(i):i[t.defaultValueRowsName],i.Editor.userid=t.baseId+"_"+i.Name,"kdcheckbox"==i.Editor.xtype||"kdswitch"==i.Editor.xtype?i[t.defaultValueRowsText]=t._getTemplateByXtype(i):i[t.defaultValueRowsName]&&null!=i[t.defaultValueRowsName]&&void 0!=i[t.defaultValueRowsName]||(i[t.defaultValueRowsName]="",i[t.defaultValueRowsText]="")}),e},_getTemplateByXtype:function(e){var t="";return!KD.isEmpty(e)&&e.Editor&&("kdcheckbox"==e.Editor.xtype||"kdswitch"==e.Editor.xtype)&&(t=kendo.format('<div id="D_{0}" data-attdata="{&quot;id&quot;:&quot;F_KD_CHECKBOX-editor&quot;,&quot;xtype&quot;:&quot;{2}&quot;}" data-sync="false" class="kd-div-checkbox-setpadding"  style="display: inline-block; float: left; width: inherit;"><div data-role="checkbox"  title=""><input type="checkbox" class="k-checkbox kd_Enter2tab" id="I_{0}"><label id="L_{0}" tabindex="-1" class="k-checkbox-label" for="I_{0}"></label></div></div>',e.Editor.userid,e.Name.toString(),e.Editor.xtype)),t},setPropertys:function(e){this.kendoData=this._formatSource(e);var t=new kendo.data.DataSource({data:this.kendoData}),i=this.getKendoGrid();i.setDataSource(t)},setExtendPropertys:function(e){console.log(e)},setPropertyValue:function(e,t){var i=[];i[0]={key:e,value:null==t?"":t},this.setFieldstates(i)}}),KDControlFactoryProxy.registerType("kdpropertygrid",KDPropertyGridProxy),KDPropertyGridProxy_Galaxy=KD.extend(KDPropertyGridProxy,{initComponent:function(){KDPropertyGridProxy_Galaxy.superclass.initComponent.call(this),this.el.addClass("gropertygrid-extend-galaxy")},_getTemplateByXtype:function(e){var t="";return!KD.isEmpty(e)&&e.Editor&&(t="kdcheckbox"==e.Editor.xtype||"kdswitch"==e.Editor.xtype?kendo.format('<div id="D_{0}" data-attdata="{&quot;id&quot;:&quot;F_KD_CHECKBOX-editor&quot;,&quot;xtype&quot;:&quot;{2}&quot;}" data-sync="false" class="kd-div-checkbox-setpadding"  style="display: inline-block; width: inherit;"><div data-role="checkbox"  title=""><input type="checkbox" class="k-checkbox kd_Enter2tab" id="I_{0}"><label id="L_{0}" tabindex="-1" class="k-checkbox-label" for="I_{0}"></label></div></div>',e.Editor.userid,e.Name.toString(),e.Editor.xtype):KDPropertyGridProxy_Galaxy.superclass._getTemplateByXtype(e)),t}}),KDControlFactoryProxy.registerType("kdpropertygrid_Galaxy",KDPropertyGridProxy_Galaxy),define("KDPropertyGridProxy",["KDKendoGridProxy","KD"],function(e){return function(){var t;return t||e.KDPropertyGridProxy}}(this)),function(e){KDkendoTreeListStore=e.extend(KDkendoStore,{idsMaps:{max:1},loadConfig:function(e){var t=this;KDkendoTreeListStore.superclass.loadConfig.call(t,e),t.pkField=t.config[KDkendoTreeListStore.TreeGridKeyFieldName],t.parentField=t.config[KDkendoTreeListStore.TreeGridParentFieldName],t.rowTypeField=t.config[KDkendoTreeListStore.TreeGridRowTypeFieldName],t.imageField=t.config[KDkendoTreeListStore.TreeGridImageFieldName]},getkendoGridOptions:function(t){var i=this,a=KDkendoTreeListStore.superclass.getkendoGridOptions.call(i,t);$.extend(a,{groupable:!1,sortable:!1,editable:{mode:"incell"},columnResize:function(t){var a=t.autoFitColumnClick,n=t.column;if(e.isArray(t.column)&&(n=t.column[0]),!a){var o=i.getOwner(),r={field:n.field,width:0},s=t.sender.table.find("colgroup>col"),l=t.sender.thead.find("tr[role='row']").find("th"),d=o.getIsEnableColumnHeaderAutoWrap();if(d){var c=t.sender&&t.sender.thead&&t.sender.thead.find('th[data-field="'+n.field+'"]');c&&c.addClass("kd-colheader-autowrap")}if(s&&s.length>0&&l&&l.length>0&&s.length==l.length)for(var h,u,p=0;p<l.length;p++){h=$(l[p]).attr("data-field"),u=$(l[p]).width();if(e.equalsIgnoreCase(r.field,h)){r.width=u;var g=i.getColumnDescriptor(r.field);g&&g.setWidth(u)}}}if(n&&n.mustinput){var f=t.sender.thead.find('[data-field="'+n.field+'"]'),m=f.find(".kd-colheader-label").children(":first");m=m.is("span")?m:f.find(".kd-colheader-label>label");var v=f.find(".kd-grid-mustinput"),y=e.isIeBrowser()?38:18;m.outerWidth()+y>=f.width()?v.addClass("kd-grid-thead-mustinput"):v.removeClass("kd-grid-thead-mustinput")}}});var n=function(e){var t=i,a=e.dataSource,n=a.schema,o=n.model,r=e.columns||[],s=a.data;delete a.autoBind,delete a.pageSize,delete a.group,$(a,{serverPaging:!1}),$.extend(n,{id:"treeId"}),$.extend(o,{id:"treeId",expanded:!1});for(var l=!1,d=!1,c=0;c<r.length;c++){var h=r[c];h.command&&(l=!0);var u=t.getColumnDescriptor.call(t,h.field);u&&(u.resetTreeExpandable.call(u,d)?($.extend(h,{expandable:!0}),d=!0):$.extend(h,{expandable:!1}),h.attributes&&(h.attributes["class"]=u.getAttributesClass()))}d||r.splice(0,0,{title:" ",width:50,template:function(e){return'<span style="text-overflow: clip;display: inline-block;">-</span>'},filterable:!1,sortable:!1,headerTemplate:'<div class="k-link"><span class="kd-treelistrow-lvlheader">&nbsp</span></div>',attributes:{"class":"kd-treegridCell-disabled"}});var p=[],g=[];i.parentRowMaps={},i.parentHasChildren={};for(var c=0;c<s.length;c++){var f=s[c],m=f[t.rowTypeField];if(!KDkendoTreeListStore.isExpandWaiting(m)){var v=f[i.parentField.toUpperCase()]||"";v&&(i.parentHasChildren[v]=!0)}KDkendoTreeListStore.isExpand(m)?(p.push(f),i.parentRowMaps[f[i.pkField.toUpperCase()]]=f):KDkendoTreeListStore.isExpandWaiting(m)&&g.push(c)}for(var c=0;c<g.length;c++){var y=g[c];s.splice(y-c,1)}for(var c=0;c<p.length;c++){var f=p[c],b=f[i.pkField.toUpperCase()]||"";if(void 0===i.parentHasChildren[b]){var D=i.createExpandWaittingRow(f);s.push(D)}}};return n(a),n(i.__filterDataModel),a},createColumnModel:function(t){
this.fieldNameMaps={__revert:{}},this.colDescripersNameMap={},this.visibleCols=[],this.baseFields={},this.selColIndex=t.length,this.initColSelectorModelConfig(t);for(var i in t){var a=t[i];KDStore.isColSelector(a.dataIndex)?a.visibleIndex=0:a.visibleIndex=a.colIndex+1;var n=KDColumnDescriptorFactory.create(a,this);n.setOwner(this.owner),n.isKeyInput=a.dataIndex==this.getKeyInputFieldName(),KDStore.isColSelector(a.dataIndex)&&(this.selColDescriptor=n);var o=this.converFieldName(n.dataIndex).toUpperCase();this.colDescripersNameMap[o]=n,this.visibleCols.push(n),n.isF7&&(this.baseFields[n.getFieldName.call(n)]=!0,this.baseFields[n.getKendoFieldName.call(n)]=!0)}this.visibleCols.length>0&&(this.visibleCols=e.quickSort(this.visibleCols,"visibleIndex"),this.visibleCols=this._sortFlexColumns(this.visibleCols))},_sortFlexColumns:function(t){if(!e.isEmpty(t)){for(var i={},a=0;a<t.length;a++){var n=t[a]||{};e.isEmpty(n.parentkey)||e.isEmpty(n.flexcolindex)||(i[n.parentkey]=i[n.parentkey]||[],i[n.parentkey].push(n))}if(!e.isEmpty(i))for(var o in i){var r=i[o]||[];r=e.quickSort(r,"flexcolindex");for(var s=0,l=0;l<r.length;l++){var d=r[l]||{};for(s;s<t.length;s++){var c=t[s]||{};if(e.equalsIgnoreCase(c.parentkey,d.parentkey)&&!e.isEmpty(c.flexcolindex)){var h=this.getColumnIndexById(d.dataIndex);if(h>=0&&h<t.length){var u=t[s];t[s]=d,t[h]=u,s++;break}}}}}}return t},getColumnIndexById:function(t){var i=-1;if(this.visibleCols)for(var a=0;a<this.visibleCols.length;a++){var n=this.visibleCols[a];if(e.equalsIgnoreCase(t,n.dataIndex)){i=a;break}}return i},loadGroupAggregate:function(){var e=KDkendoTreeListStore.superclass.loadGroupAggregate.call(this);return e},setSummaryColumns:function(e){},formateNewRow:function(t){var i=this,a=i.parentRowMaps||{},n={gridKey:i.getGridKey(),pageId:i.getPageId(),id:0,parentId:null};for(var o in i.colDescripersNameMap){var r=i.colDescripersNameMap[o],s=r&&r.subColDescriptor,l=null==s?r.formatEditValue.call(r,t[r.colIndex]):s.formatEditValue.call(s,t[r.colIndex]);if(r.isIndexKeyCol.call(r,i.getIndexKey())){var d=t[r.colIndex],c=parseInt(d);n.rowId=c}KDkendoStore.setFormatValue(r.getKendoFieldName.call(r),n,l)}n.rowType=n[i.rowTypeField];var h=n[i.pkField.toUpperCase()],u=n[i.parentField];e.isEmpty(u)||h!=u||(u="",e.writeError('KDkendoTreeListStore->formateNewRow has error:treeId equals treeParentId, force treeParentId = "",treeId value is:'+h));var p=e.isNumber(h),g=i.idsMaps;a[u]&&(a[u][i.rowTypeField]=KDkendoTreeListStore.ROWTYPE.Normal);var f=g[h];p?f=h:f||0==f||(f=h?g[h]=g.max++:0),n.treeId=n.id=f;var m=g[u];return p?(m=parseInt(u),-1==m&&(m=null)):void 0===m&&(m=void 0===u||""==u||0==parseInt(u)?g[u]=null:-1===parseInt(u)?g[u]=null:g[u]=g.max++),n.parentId=m,n},getRowType:function(t){var i=t;if(t&&this.rowTypeField){var a=t[this.rowTypeField];e.isEmpty(a)||(i=a)}return i},kdkendoGridCreateEditor:function(t,i){if(!e.isEmpty(t)&&"TR"!=$(t)[0].tagName){var a=ClientAppProxy.Current.getAliveForm(i.model.pageId),n=a&&a.controlFactoryProxy.getCmp(i.model.gridKey),o=n&&n.getStore.call(n),r=o&&o.getColumnDescriptor(i.field);r&&$(t).addClass(r.getAttributesClass()),r&&r.editor&&r.initCellEditor&&r.initCellEditor.call(r,t,i,!0)}},clearStates:function(){var e=this;KDkendoTreeListStore.superclass.clearStates.call(e),e.idsMaps={max:1}},isReadOnlyRow:function(t){var i=this,a=i.getColumnDescriptor(i.rowTypeField),n=e.isEmpty(t)?KDkendoTreeListStore.ROWTYPE.ExpandWaiting:a.getSvrValue.call(a,t.rowId);return KDkendoTreeListStore.isReadOnly(n)},isWaitingRow:function(e){var t=this,i=t.getColumnDescriptor(t.rowTypeField),a=i.getSvrValue.call(i,e.rowId);return KDkendoTreeListStore.isExpandWaiting(a)},createExpandWaittingRow:function(t){var i=this,a=KDkendoTreeListStore.ROWTYPE.ExpandWaiting,n=e.parseObject(e.stringify(t)),o=i.getIndexKey(),r=i.idsMaps.max++;return n[o]=r,n[i.rowTypeField]=n[i.rowTypeField+"__value"]=a,$.extend(n,{rowType:a,parentId:t.treeId,rowId:r,treeId:r}),n},isSysKeyCol:function(e){var t=this;return e==t.pkField||e==t.parentField||e==t.rowTypeField||e==t.imageField||e==KDStore.C_SelColKey},isColRender:function(e){var t=!1;return e&&e.isVisible&&(t=e.isVisible.call(e)),t},filterEmptyParentNode:function(t){$.each(t,function(i,a){var n=a.parentId,o=t.filter(function(e){return e.id==n});e.isArray(o)&&0==o.length&&(a.parentId=null)})},getRowIndexByServerTreeId:function(t){var i=-1;if(e.isArray(this.rows))for(var a=0;a<this.rows.length;a++){var n=this.rows[a];if(n.treeId==t){i=a;break}}return i},insertRows:function(t,i,a,n){var o=KDkendoTreeListStore.superclass.insertRows.call(this,t,i,a,n);if(o&&!e.isEmpty(o.parentId)&&this.owner){var r=this.getRowIndexByServerTreeId(o.parentId);this.owner.setExpandStatus.call(this.owner,r,!0)}},appendRows:function(t,i){var a=this;a.initRows();var n=null;for(var o in t){var r=t[o];n=a.formateNewRow(r),a.rows.push(n)}if(!e.isEmpty(n)&&!e.isEmpty(n.parentId)&&this.owner){var s=this.getRowIndexByServerTreeId(n.parentId);this.owner.setExpandStatus.call(this.owner,s,!0)}a.rows&&a.rows.length>0&&a.filterEmptyParentNode(a.rows);var l=a.rows[a.rows.length-1];return delete this._serverRowIdMap,delete this.visualRows,i&&i(a.rows),l}})}(KD),function(e){$.extend(KDkendoTreeListStore,{TreeGridImageFieldName:"imageFieldName",TreeGridKeyFieldName:"primaryKey",TreeGridParentFieldName:"parentFieldName",TreeGridRowTypeFieldName:"rowTypeFieldName",TreeGridRowExpandStateName:"expanded",ROWTYPE:{Default:0,Header:1,Normal:16,Expand:32,ExpandWaiting:64,Summary:128},isHeader:function(e){return(e&KDkendoTreeListStore.ROWTYPE.Header)==KDkendoTreeListStore.ROWTYPE.Header},isExpand:function(e){return(e&KDkendoTreeListStore.ROWTYPE.Expand)==KDkendoTreeListStore.ROWTYPE.Expand},isExpandWaiting:function(e){return(e&KDkendoTreeListStore.ROWTYPE.ExpandWaiting)==KDkendoTreeListStore.ROWTYPE.ExpandWaiting},isSummary:function(e){return(e&KDkendoTreeListStore.ROWTYPE.Summary)==KDkendoTreeListStore.ROWTYPE.Summary},isReadOnly:function(e){return KDkendoTreeListStore.isHeader(e)||KDkendoTreeListStore.isExpandWaiting(e)||KDkendoTreeListStore.isSummary(e)}})}(KD),define("KDKendoTreeListStore",["KDKendoStore"],function(e){return function(){var t;return t||e.KDKendoTreeListStore}}(this)),function(e){KDTreeGridControlProxy=e.extend(KDKendoGridProxy,{isTreeList:!0,initComponent:function(){var t=this;KDTreeGridControlProxy.superclass.initComponent.call(this),e.isMobileOS()&&t.gridEl&&t.gridEl.find(".k-grid-content table").css("touchAction","auto")},createNewStore:function(){return $.extend(new KDkendoTreeListStore,{rowHeight:this.rowHeight,virtualScroll:!0,isFlowViewList:this.isFlowViewList(),isFlowEditGrid:this.isFlowEditGrid()})},setData:function(e){$this.expandStatus=void 0,KDTreeGridControlProxy.superclass.setData.call(this,e)},setExpandStatus:function(e,t){var i=this;i.expandStatus=i.expandStatus||{},i.expandStatus[e]=t},getGridViewRows:function(e){return this.getStore().rows},isRealModePaged:function(){return!1},getKendoGridOptions:function(e){var t=this,i=(t.getStore(),t.config,KDTreeGridControlProxy.superclass.getKendoGridOptions.call(this,e));return $.extend(i,{expand:function(e){var i=e.model,a=e.sender;t.onExpand.call(t,a,i)},collapse:function(e){var i=e.model,a=e.sender;t.onCollapse.call(t,a,i)},messages:{noRows:"",loading:ResManager.LoadKDString("载入中...","0991733000003950"),requestFailed:ResManager.LoadKDString("请求错误.","0991733000003951"),retry:ResManager.LoadKDString("重试","0991733000003952"),commands:{edit:ResManager.LoadKDString("修改","0991733000003953"),canceledit:ResManager.LoadKDString("取消","0991733000003922"),update:ResManager.LoadKDString("更新","0991733000003954"),create:ResManager.LoadKDString("新增行","0991733000003955"),createchild:ResManager.LoadKDString("新增子行","0991733000003956"),destroy:ResManager.LoadKDString("删除","0991733000003902"),excel:ResManager.LoadKDString("导出Excel","0991733000003957"),pdf:ResManager.LoadKDString("导出PDF","0991733000003958")}},scrollable:!0}),delete i.columnMenu,i},clickTime:0,getBindKendoGridEventOptions:function(e){var t=this,i=KDTreeGridControlProxy.superclass.getBindKendoGridEventOptions.call(t,e);return $.extend(i,{edit:function(e){t.onTreeListCellClick.call(t,e)},change:function(e){t.isInit||t.onTreeListChange&&t.onTreeListChange.call(t,e)}}),i},buildTreeGridOpts:function(e,t){},buildGroup:function(e,t){},getKDGridCType:function(){return"kendoKDTreeList"},renderGrid:function(t){var i=this;t.columns||[];i.el.undelegate('[role="treegrid"] tr td',"click").delegate('[role="treegrid"] tr td',"click",function(e){i.onTreeListCellClick.call(i,e)});var a=i.gridEl[i.getKDGridCType()](t);return e.isMobileOS()&&i.gridEl&&i.gridEl.find(".k-grid-content table").css("touchAction","auto"),a},isReadOnlyRow:function(e){var t=this,i=t.getStore();return i.isReadOnlyRow.call(i,e)},isWaitingRow:function(e){var t=this,i=t.getStore();return i.isWaitingRow.call(i,e)},isMultiSelectMode:function(){var e=!!this.config.IsListMultiSel;return e},getKendoGrid:function(){var e=this.gridEl?this.gridEl.data(this.getKDGridCType()):void 0;return e},getDataSource:function(e){return new kendo.data.TreeListDataSource(e)},getCurrentElement:function(){var e=this,t=e.getKendoGrid();return t.current()},expandedNode:function(t){var i,a=this;i=void 0!=t&&void 0!=t.row?t.row:t,a.setExpandStatus(i,!0),a.syncExpandStatusStart||(a.syncExpandStatusStart=!0,e.delayInvoke(function(){a.syncExpandStatus2UI.call(a),a.syncExpandStatusStart=!1},100))},collapsedNode:function(t){var i,a=this;i=void 0!=t&&void 0!=t.row?t.row:t,a.setExpandStatus(i,!1),a.syncExpandStatusStart||(a.syncExpandStatusStart=!0,e.delayInvoke(function(){a.syncExpandStatus2UI.call(a),a.syncExpandStatusStart=!1},100))},syncExpandStatus2UI:function(){var t=this;if(void 0!==t.expandStatus&&!t.syncingExpandStatus)try{t.syncingExpandStatus=!0;var i=t.getStore(),a=t.getKendoGrid(),n=a.dataSource,o={},r=n.data();for(var s in t.expandStatus){for(var l=void 0,d=[],c=0;c<r.length;c++)if(r[c].rowId==s){l=r[c];break}var h=i&&i.getRowDataByServerRowId.call(i,s);h&&(h[KDkendoTreeListStore.TreeGridRowExpandStateName]=t.expandStatus[s]),l?(l[KDkendoTreeListStore.TreeGridRowExpandStateName]=t.expandStatus[s],e.isEmpty(o)&&(d=a.itemFor(l),e.isEmpty(d)||(o[l.rowId]=d))):t.expandStatus[s]=void 0}for(var s in o){var d=o[s];d.length>0&&(t.expandStatus[s]?a.expand(d):0==t.expandStatus[s]&&a.collapse(d))}}catch(u){e.writeLog("KDTreeGridControlProxy.syncExpandStatus2UI()",u.message,!0)}finally{t.syncingExpandStatus=!1}},getActualSize:function(){var e=this,t=(e.getKendoGrid(),e.el);return{height:t.height()-e.rowHeight-e.gridOffsetHeight||"auto",width:t.width()}},getUIFocusedCellData:function(e){var t=this,i={rowId:-1,field:""},a=t.currentCellData||i;if(a.field)return a;try{var n=(e&&e.sender?e.sender:t.getKendoGrid(),t.getCurrentElement());if(n&&n.length>0){var o=$("[data-field]",n).data();o&&void 0!==o.rowid&&(a={rowId:void 0===o.rowid?-1:o.rowid,field:o.field})}}catch(r){a=i}finally{t.currentCellData=a}return a},updateFieldStates:function(e){KDTreeGridControlProxy.superclass.updateFieldStates.call(this,e)},setFrozen:function(t){var i=this;if(e.isObject(t)){for(var a,n,o=t.left||"",r=o,s=t.right||"",l=s,d=i.getVisibleCols(),c=1;c<d.length;c++){var h=d[c].getKendoFieldName.call(d[c]);d[c].locked.call(d[c],!1),h==o&&(r=h,a=c),h==s&&(l=h,n=c)}if(!(a>=n)){var u=!0;if(void 0!=a)for(var c=1;c<d.length;c++){var p=d[c];p.locked.call(p,u),r==p.getKendoFieldName.call(p)&&(u=!1)}var g=i.getKendoGrid();g.destroy();var f=i.getKendoGridOptions.call(i,d);$.extend(f,i.getBindKendoGridEventOptions(i.config)),i.initGrid(f),i.doLayout(),i.setRefreshGridDataFlag(!0)}}},setIsEnableColumnHeaderAutoWrap:function(e){this.isEnableColumnHeaderAutoWrap=e,e&&this._setColHeaderAutoWrap()},_setColHeaderAutoWrap:function(){var e=this.gridEl&&this.gridEl.find(".k-grid-header .k-grid-header-wrap");e&&e.find("table th").addClass("kd-colheader-autowrap")},editCell:function(e){var t=$(e);if(t.hasClass("kdgrid-td-state-disable"))return void t.addClass("k-state-focused");if(!t.hasClass("k-edit-cell")&&!t.hasClass("kd-edit-cell")&&t.is(":visible")){if(t.length>0){var i=this.getKendoGrid(),a=i.content;a.scrollTop(t.offset().top-a.offset().top+a.scrollTop()-a.height()/2),a.scrollLeft(t.offset().left-a.offset().left+a.scrollLeft()-a.width()/2),this.onTreeListCellClick({currentTarget:t})}KDTreeGridControlProxy.superclass.editCell.call(this,t)}},onTreeListCellClick:function(e){var t=this,i=e.currentTarget||e.container;if(i){var a=$("[data-field]",i).data();a?t.currentCellData={rowId:a.rowid,field:a.field}:t.currentCellData=t.getUIFocusedCellData(),t.onCellSelect&&t.onCellSelect.call(t,t.currentCellData),t.setLastNavigateTD.call(t,t.currentCellData)}},onTreeListEditButtonClick:function(e){var t=this,i=t.getStore(),a={value:""},n=this.getFormProxy(),o=$("[data-field]",e.currentTarget).data();a=o?{rowId:o.rowid,field:o.field}:t.getUIFocusedCellData();var r=i.revertKendoFieldName.call(i,a.field);a.value=$(e.currentTarget).closest("td").find(".k-textbox").val(),n&&n.fireEventNoData.call(n,"F7ButtonClick",r,a.value,a.rowId,null)},dblClick:function(e,t){var i=this,a=i.getUIFocusedCellData(),n=i.getFormProxy(),o=t;0>t&&(o=a?a.rowId:void 0),n&&void 0!==o&&(n.lockControl.call(n,i),n.fireEvent.call(n,"EntryRowDoubleClick",this.getKey(),this.checkRowId(o)))},onExpand:function(e,t){var i=this,a=i.getFormProxy(),n=i.getKey(),o=i.checkRowId(t.rowId),r=this.getStore(),s=r&&r.getRowType(t);KDkendoTreeListStore.isExpand(s)&&a&&a.fireEvent.call(a,"RowExpanding",n,o);var l=r&&r.getRowDataByServerRowId.call(r,o);l&&(l[KDkendoTreeListStore.TreeGridRowExpandStateName]=!0),i.setExpandStatus(o,!0),a&&a.fireCustomEvents.call(a,n,"RowExpanded",o)},onCollapse:function(e,t){var i=this,a=i.getFormProxy(),n=i.getKey(),o=i.checkRowId(t.rowId),r=this.getStore(),s=r&&r.getRowDataByServerRowId.call(r,o);s&&(s[KDkendoTreeListStore.TreeGridRowExpandStateName]=!1),i.setExpandStatus(o,!1),a&&a.fireCustomEvents.call(a,n,"RowCollapsed",o)},onRefreshGridData:function(){var t=this;try{var i=t.getKendoGridOptions.call(t),a=t.getKendoGrid(),n=t.getActualSize.call(t),o=t.getStore.call(t),r=t.getDataSource(i.dataSource);t.refreshingDataFlag=!0,t.setLastNavigateTD(t.getUIFocusedCellData()),o&&o.updateView&&(i.height=n.height,i.width=n.width,t.closeEditPopMenu(),a&&a.destroy(),t.initGrid(i),a=t.getKendoGrid(),o.updateView=!1),a.setDataSource.call(a,r);var s=r.get(0);if(s&&s.uid&&a.expand){var l=a.content.find("tr[data-uid="+s.uid+"]");l&&a.expand(l)}t.invokeSelOp("syncColHeadValue")}catch(d){e.writeError(d)}},onTreeListChange:function(t){var i=this;e.delayInvoke(function(){var e=i.getUIFocusedCellData(t);KDTreeGridControlProxy.superclass.onChange.call(i,e)})},onDataBinding:function(e){},onDataBound:function(t){var i=this;e.delayInvoke(function(){i.attachGridEvents.call(i)});var a=i.getKendoGrid();a&&a.virtualScrollable&&(a._rowHeight=void 0,e.isFunction(a.virtualScrollable.refresh)&&a.virtualScrollable.refresh()),i.refreshingDataFlag&&e.delayInvoke(function(){i.loadComplete.call(i,t)})},onGridDataRefreshReady:function(t){var i=this;if(!i.isGridDataRefreshReading){i.isGridDataRefreshReading=!0;var a=function(t){var a=i.getUIFocusedCellData(),n=i._getLastFocusTd();if(n&&n.length>0){var o=(i.getKendoGrid(),n.parent("tr"));o.hasClass("k-grid-edit-row")||i.setSelection(a.rowId);try{i.editCell(n)}catch(r){delete i.isGridDataRefreshReading,e.writeLog(r.message,r.stack,!0)}}delete i.isGridDataRefreshReading};e.delayInvoke(function(){i.syncExpandStatus2UI.call(i),e.delayInvoke(function(){a(i)},30)})}},_getLastFocusTd:function(){var e=this,t=null;if(e.gridEl)var i=e.getUIFocusedCellData(),a="tbody tr [data-rowId="+i.rowId+'][data-field="'+i.field+'"]',n=e.gridEl.find(a),t=n.parents("td");return t},isLockEditable:function(){var t=!0;return $.each(this.config.columns,function(i,a){return(e.isEmpty(a.visible)||!e.isEmpty(a.visible)&&a.visible)&&a.visible&&a.editor&&!a.editor.disabled?void(t=!1):void 0}),t},repairNoDataGridHeadCover:function(){var t=this;if(!e.isEmpty(t.gridEl)){var i=t.gridEl.find(".k-grid-content"),a=t.gridEl.find(".k-grid-header table").width(),n=i.find("table"),o=i.find("tbody tr");0==o.length?(i.addClass("kd-treegrid-content-nullrow"),e.isIeBrowser()&&a&&n.width(a)):(i.removeClass("kd-treegrid-content-nullrow"),e.isIeBrowser()&&n.css("width","100%"))}}}),$.extend(KDTreeGridControlProxy.prototype,{setSelection:function(e,t){var i=this,a=i.getKendoGrid(),n=i.getStore();if(n){var o=n.getRowIndexByServerRowId.call(n,e);if(!(0>o)){var r="tr [data-rowId="+e+"]",s=i.gridPanel.find("tbody "+r).parents("tr");if(a&&a.select(s),i.isSingleSelectMode()){var l=$('tbody[role="rowgroup"]',this.el).find(r).parents("tr");$(l.siblings()).removeClass("kendo-single-select"),l.addClass("kendo-single-select")}}}},getSelection:function(e,t){var i=KDTreeGridControlProxy.superclass.getSelection.call(this,e,t);return i}}),$.extend(KDTreeGridControlProxy.prototype,{getKendoGridOptionsDebug:function(){var e=window.getKendoTreeListProxyDebugData;return e&&e()},getKendoGridOptionsDebugKD:function(){var e=window.getKendoTreeListProxyDebugDataKD;return e&&e()}})}(KD),function(e){$.extend(KDTreeGridControlProxy.prototype,{buildFloatMenu:function(e,t){var i=this;i.menuPop=$("<div>"),i.menuPopContent=$('<span class="kd-treelistrow-menupanel-min">').appendTo(i.menuPop),i.editButton=$('<span class="kd-treelistrow-btn"><a target="_blank" click="return false">'+ResManager.LoadKDString("修改","0991733000003953")+"</a></span>").appendTo(i.menuPopContent),i.saveButton=$('<span class="kd-treelistrow-btn"><a target="_blank" click="return false">'+ResManager.LoadKDString("保存","0991733000003959")+"</a></span>").appendTo(i.menuPopContent).hide(),i.cancelButton=$('<span class="kd-treelistrow-btn"><a target="_blank" click="return false">'+ResManager.LoadKDString("取消","0991733000003922")+"</a></span>").appendTo(i.menuPopContent).hide()},clearEmptyPopContainer:function(){for(var e=$("body>.k-animation-container"),t=0;t<e.length;t++)0==e[t].children.length&&$(e[t]).remove()},closeEditPopMenu:function(){var e=this;if(void 0!==e.menuPop){var t=e.menuPop.data("kendoPopup");t&&t.visible()&&t.close(),t&&t.destroy(),e.editButton.unbind("click"),e.saveButton.unbind("click"),e.cancelButton.unbind("click")}},hideRowMenuButtonStatus:function(){var e=this;e.editButton.hide(),e.saveButton.hide(),e.cancelButton.hide()},switchRowMenuButtonStatus:function(e){var t=this;e?(t.editButton.css({display:"inline-block"}),t.saveButton.hide(),t.cancelButton.hide()):(t.editButton.hide(),t.saveButton.css({display:"inline-block"}),t.cancelButton.hide())},openEidtPopMenu:function(t,i){var a=this;if(void 0!==a.menuPop){var n=a.getStore(),o=n.isReadOnlyRow.call(n,i);if(!o){var r=a.menuPop.data("kendoPopup"),s=r&&r.visible();return void 0===i||i.rowId<0?void a.closeEditPopMenu():void(s&&a.menuPop.rowId==i.rowId||(a.menuPop.rowId=i.rowId,e.delayInvoke(function(){a.editButton.unbind("click").bind("click",function(e){a.onRowEditClick.call(a,e)}),a.saveButton.unbind("click").bind("click",function(e){a.onRowSaveClick.call(a,e)}),a.cancelButton.unbind("click").bind("click",function(e){a.onRowCancelClick.call(a,e)}),a.menuPop.kendoPopup({anchor:t,origin:"bottom left",position:"top left",collision:"fit",close:function(e){a.onRowSaveClick.call(a,e),a.clearEmptyPopContainer.call(a)},open:function(e){a.clearEmptyPopContainer.call(a)},activate:function(e){},deactivate:function(e){}}).data("kendoPopup").open()},200)))}}},onRowEditClick:function(t){var i=this,a=i.getUIFocusedCellData(t),n=a?a.field:void 0,o=i.getKendoGrid(),r=i.getStore(),s=o.select(),l=o.dataItem(s);if(!e.isEmpty(s)){if(s.length>1&&t&&t.dataUid)for(var d=0;d<s.length;d++){var c=$(s[d]);if(c.attr("data-uid")==t.dataUid){s=c;break}}var h=new Date;if((e.isEmpty(i.lastEditorRow)||i.lastEditorRow.row.attr("data-uid")!=s.attr("data-uid")||!(h-i.lastEditorRow.lastClickTime<1e3))&&(i.lastEditorRow=i.lastEditorRow||{},i.lastEditorRow.row=s,i.lastEditorRow.lastClickTime=h,l&&n)){var u=r.getColumnDescriptor.call(r,n);if(!u.isDisabled.call(u,l)){s.hasClass("k-grid-edit-row")||o.editRow(s);var p='[data-field="'+a.field+'"]',g=" .k-input",f=function(){var e=$(p+g,s);0==e.length&&(e=$(p+" .k-textbox",s)),0==e.length&&(e=$(p,s)),0!=e.length&&e.focus()};f(),e.delayInvoke(function(){f(),i.openEidtPopMenu.call(i,s,l),i.hideRowMenuButtonStatus()})}}}},onRowSaveClick:function(e){var t=this,i=t.getKendoGrid(),a=t.getStore();if(a&&a.config&&a.config.columns&&a.config.columns.length)for(var n=a.config.columns,o=0;o<n.length;o++){var r=n[o].dataIndex,s=a.getColumnDescriptor.call(a,r);if(s&&s.config&&s.config.visible&&s.config.editor&&s.config.editor.editable&&!s.config.editor.editable.disabled&&s.proxy&&s.proxy.config&&s.proxy.config.isFromTreeGrid){var l=s.proxy;l&&l.beforeTreeEditorClose&&l.beforeTreeEditorClose.call(l,e)}}$('[role="treegrid"] td',t.gridEl).removeClass("k-state-focused");i.saveRow(),t.hideRowMenuButtonStatus()},onRowCancelClick:function(e){var t=this,i=t.getKendoGrid();i.cancelRow(),t.hideRowMenuButtonStatus()}})}(KD),KDControlFactoryProxy.registerType("kdtreegrid",KDTreeGridControlProxy),define("KDTreeGridControlProxy",["KDKendoGridProxy","KDKendoTreeListStore","KDControlProxy"],function(e){return function(){var t;return t||e.KDTreeGridControlProxy}}(this)),NotifyPropertyChanged=function(){},NotifyPropertyChanged.prototype={setpropertyChanged:function(e){void 0==this.propertyChangeds&&(this.propertyChangeds=new Array);for(var t in this.propertyChangeds)if(this.propertyChangeds[t]==e)return;this.propertyChangeds.push(e)},raisePropertyChanged:function(e,t){if(void 0!=this.propertyChangeds)for(var i in this.propertyChangeds)this.propertyChangeds[i](e,t)}},define("NotifyPropertyChanged",function(){}),FilterQuickerRowData=KD.extend(NotifyPropertyChanged,{}),define("FilterQuickerRowData",["NotifyPropertyChanged","KD"],function(e){return function(){var t;return t||e.FilterQuickerRowData}}(this)),FilterQuickerEntity=KD.extend(NotifyPropertyChanged,{init:function(){this.TotalColumns=3,this._items=new Array,this._allowAutoList=!0,this.isFilterGrid=!1},setItems:function(e,t){t!=this._items&&(0==this.isFilterGrid?(this._items=t.filter(function(e){return null!=e.FilterField}),0==this._items.length&&this._items.push(t[0])):(this._items=t,t[0]&&t[0].Fields&&(this._items[0].Fields=t[0].Fields)),this.raisePropertyChanged(e,"Items"))},clearItems:function(){this._items=new Array},getItems:function(){return this._items},setAllowAutoList:function(e){this._allowAutoList=e;var t=this.getItems();for(var i in t){var a=t[i];a.AllowAutoList=this._allowAutoList}},getAllowAutoList:function(){return this._allowAutoList},setDefaultItem:function(e,t){this.DefaultItem!=t&&(this.DefaultItem=t,this.raisePropertyChanged(e,"DefaultItem"))},getDefaultItem:function(){return this.DefaultItem},setSchemeItem:function(e,t){this._SchemeItem!=t&&(this._SchemeItem=t,this.raisePropertyChanged(e,"SchemeItem"))},getSchemeItem:function(){return this._SchemeItem},SetSchemeItems:function(e,t){this._SchemeItems=t,this.raisePropertyChanged(e,"SchemeItems");var i=null;for(var a in this._SchemeItems)if(null==i)i=this._SchemeItems[a];else if(1==this._SchemeItems[a].Selected){i=this._SchemeItems[a];break}this.setSchemeItem(e,i)},getSchemeItems:function(){return this._SchemeItems},LoadData:function(e,t){var i=this.ConvertToEntityRowItems(t);if(0==this.isFilterGrid){0==i.length&&this.AddNewRow(i);var a=i.length%this.TotalColumns;0!=a&&this.AddNewRow(i,this.TotalColumns-a)}this.setItems(e,i),this._items.length>0&&this.setDefaultItem(e,this._items[0])},ConvertToEntityRowItems:function(e){var t=e;for(var i in t){var a=t[i];a.Fields=this._fields,0==this.isFilterGrid&&(a.FilterField=this.getField(a.Fields,a.FieldName),a.CompareTypes=this._comparers,a.CompareType=this.getCompareType(a.CompareTypes,a.Compare)),a.AllowAutoList=this._allowAutoList,a.ServiceConfig=this.ServiceConfig,this.loadRowValue(a)}return t},loadRowValue:function(e){if(e.ValueObject=e.Value,e.FilterField&&e.FilterField.FieldName&&""!=e.FilterField.FieldName)if("kdcombo"==KD.getValue(e.FilterField.Editor,"xtype","")){var t=KD.getValue(e.FilterField.Editor,"store",new Array),i=e.Value,a=null;for(var n in t){var o=t[n];if(o.length>1&&o[0].toString()==i){a=o;break}}var r=this.LoadComboBoxItem(a);e.ValueObject=r}else if("kdcheckbox"==KD.getValue(e.FilterField.Editor,"xtype","")){var s=!1;1==e.Value?s=e.Value:e.Value&&"true"==e.Value.toString().toLowerCase()&&(s=!0),e.ValueObject=s}},LoadComboBoxItem:function(e){if(e){var t={};return null!=e?(t.ID=e[0].toString(),e.length>1&&(t.Header=e[1].toString()),t.GroupID=e.length>2?e[2].toString():null):t.ID=e.toString(),t}},getCompareType:function(e,t){for(var i in e)if(e[i].ID==t)return e[i];return null},getField:function(e,t){for(var i in e)if(e[i].FieldName==t)return e[i];return null},SetItemValue:function(e,t){this._items[e].IsServerSetValue=!0,this._items[e].Value=t,this.loadRowValue(this._items[e]),this._items[e].IsServerSetValue=!1},SetFieldsStore:function(e){this._fields=e},SetComparersStore:function(e){this._comparers=e},Remove:function(e){for(var t=0;t<this.TotalColumns;t++){var i=e.Seq-t-1;this.splice(i,1)}for(var a=this.Items.length,t=0;a>t;t++)this._items[t].Seq=t+1;0==a&&this.AddNewRow(this._items,this.TotalColumns,-1)},RemoveRow:function(e){if(void 0==e||0>e||e>=this._items.length)return!1;this._items.splice(e,1);for(var t=this._items.length,i=0;t>i;i++)this._items[i].Seq=i+1;return!0},clearItemByIndex:function(e){var t=parseInt(e),i=!1;if(KD.isNaN(t)||0>t||t>=this._items.length)i=!1;else if(this._items){var a=this._items[t];a?(a.fieldName="",a.FilterField=void 0,i=!0):i=!1}return i},insertNewRow:function(e){if(void 0==e||0>e||e>=this._items.length)return null;var t={};t.ServiceConfig=this.ServiceConfig,t.AllowAutoList=this._allowAutoList,t.CompareTypes=this._comparers,t.Fields=this._fields,t.Seq=e+1,t.ButtonVisible=!0,t.FilterField=this._fields[0],t.Logic=0,t.Left="",t.Right="",this._items.splice(e,0,t);for(var i=e+1;i<this._items.length;i++)this._items[i].Seq=i+1;return t},copyNewRow:function(e){if(void 0==e||0>e||e>=this._items.length)return null;var t=this._items[e],i={};i=KD.extendObject(i,t),i.Seq=e+2,i.ButtonVisible=!0,this._items.splice(e+1,0,i);for(var a=e+1;a<this._items.length;a++)this._items[a].Seq=a+1;return i},AddNewRow:function(e,t,i){void 0==e&&(e=this._items),void 0==t&&(t=this.isFilterGrid?(e||[]).length:this.TotalColumns),void 0==i&&(i=-1);for(var a=e.length,n=0;t>n;n++){a++;var o={};o.ServiceConfig=this.ServiceConfig,o.AllowAutoList=this._allowAutoList,o.CompareTypes=this._comparers,o.Fields=this._fields,o.Seq=a,o.ButtonVisible=this.isFilterGrid?a:a%this.TotalColumns==0,i>-1&&i<this._fields.length&&(o.FilterField=this._fields[i]),o.Logic=0,o.Left="",o.Right="",e.push(o)}},GetSetting:function(){ret=[];for(var e in this._items){var t=this._items[e];if(t.FilterField&&t.FilterField.FieldName){var i={};i.FieldName=t.FilterField.FieldName,i.Compare=t.CompareType?t.CompareType.ID:"",t.ValueObject?t.FilterField.Editor&&"numberfield"==t.FilterField.Editor.xtype&&0==t.FilterField.Editor.decimalPrecision?i.Value=t.ValueObject:t.FilterField.Editor&&("datetimefield"==t.FilterField.Editor.xtype||"datefield"==t.FilterField.Editor.xtype||"timefield"==t.FilterField.Editor.xtype)&&t.ValueObject&&KD.isDate(t.ValueObject)?i.Value=t.ValueObject.format("yyyy-MM-dd HH:mm:ss"):t.ValueObject.ID?i.Value=t.ValueObject.ID:t.FilterField.Editor&&"bosf7field"==t.FilterField.Editor.xtype?i.Value=void 0==t.ValueObject.name||null==t.ValueObject.name?t.ValueObject:t.ValueObject.name:t.ValueObject&&t.ValueObject.name?i.Value=t.ValueObject.name:i.Value=t.ValueObject:0==t.ValueObject?i.Value=t.ValueObject:i.Value="",i.Left=t.Left?t.Left:"",i.Right=t.Right?t.Right:"",i.Logic=t.Logic?t.Logic:"0",null!=t.LogicObject&&(i.Logic=t.LogicObject.Value),ret.push(i)}}return ret}}),define("FilterQuickerEntity",["NotifyPropertyChanged","KD"],function(e){return function(){var t;return t||e.FilterQuickerEntity}}(this)),function(e){e.fn.KDFilterQuickerRow=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDFilterQuickerRow.prototype,e.fn.KDControlBase.defaults,e.fn.KDFilterQuickerRow.defaults,t);return this.fr=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.fr.ondelete=null,this.fr.options=t,this.each(function(){var t=e(this);e.meta?e.extend(i,opts,t.data()):i})},e.fn.KDFilterQuickerRow.prototype={leftOps:{dataSource:{data:[{name:"",alias:"",value:""},{name:"(",alias:"(",value:"("},{name:"((",alias:"((",value:"(("},{name:"(((",alias:"(((",value:"((("}]},dataTextField:"name",dataValueField:"value"},rightOps:{dataSource:{data:[{name:"",alias:"",value:""},{name:")",alias:")",value:")"},{name:"))",alias:"))",value:"))"},{name:")))",alias:")))",value:")))"}]},dataTextField:"name",dataValueField:"value"},LogicOps:{dataSource:{data:[{name:ResManager.LoadKDString("并且","099002000000038"),alias:ResManager.LoadKDString("并且","099002000000038"),value:"0"},{name:ResManager.LoadKDString("或者","099002000000039"),alias:ResManager.LoadKDString("或者","099002000000039"),value:"1"}]},dataTextField:"name",dataValueField:"value"},getContent:function(){return this.fr},quickFilterValueWidth:256,loadConfig:function(t){var i=this;KD.setAttachmentData(this,t),KD.layout.setAbsolute(this,t);var a=i.getContent();a.isFilterGrid=t.isFilterGrid,a.PART_Fileds_id=this.baseId+"_PART_Fileds",a.table=e("<table cellspace='0' border='0px' style='table-layout: fixed;min-width:"+t.width+"px;margin-right:14px;'></table>");var n=e("<div class='kd-filterquicker-tableContainer'></div>");if(n.append(a.table),a.append(n),a.tr=e("<tr height='2.1em'></tr>"),a.table.append(a.tr),a.isFilterGrid){this.css({"min-width":t.width+"px",width:"100%"}),a.PART_Left_id=this.baseId+"_PART_left",a.PART_Left_td=e("<td width='48px' id='"+a.PART_Left_id+"_P'></td>"),a.tr.append(a.PART_Left_td);var o=e('<input class="defaultQuikerRowEmptyShow kd-defaultQuikerRow-partLeft"  style="height:2.1em;width:48px;" id="'+a.PART_Left_id+'" />');a.PART_Left_td.append(o),a.PART_Left=e("#"+a.PART_Left_id)}a.PART_Fileds_td=e("<td style='min-width:125px;width:125px;' class='part_fileds_extend' id='"+a.PART_Fileds_id+"_P'></td>"),a.tr.append(a.PART_Fileds_td);var o=e('<input class="defaultQuikerRowEmptyShow kd-defaultQuikerRow-partFileds" style="min-width:96px;width:120px;" id="'+a.PART_Fileds_id+'" />');a.PART_Fileds_td.append(o),a.PART_Fileds=e("#"+a.PART_Fileds_id),a.PART_CompareType_id=this.baseId+"_PPART_CompareType",a.isFilterGrid?a.PART_CompareType_td=e(kendo.format("<td style='width:80px;' id='{0}_P'></td>",a.PART_CompareType_id)):a.PART_CompareType_td=e(kendo.format("<td style='width:98px;min-width:98px;' id='{0}_P'></td>",a.PART_CompareType_id)),a.tr.append(a.PART_CompareType_td);var o=e('<input class="defaultQuikerRowEmptyShow kd-defaultQuikerRow-partCompareType" id="'+a.PART_CompareType_id+'" />');o.css({height:"26px",width:a.isFilterGrid?"80px":"93px"}),a.PART_CompareType_td.append(o),a.PART_CompareType=e("#"+a.PART_CompareType_id),a.PART_Value_id=this.baseId+"_PPART_Value";var r=e(a.isFilterGrid?"<td valign='top' width='170px'></td>":"<td valign='top' width='258px'></td>");a.tr.append(r),a.PART_Value_td=e("<div class='kdQuickFilterContainer_editorct kdItemContainer_editorct k-state-disabled' style='width:"+(a.isFilterGrid?"170px;height:23px;padding-top:1px;":this.quickFilterValueWidth+"px;height:24px")+";border-radius: 2px;' id='"+a.PART_Value_id+"_P'></div>"),r.append(a.PART_Value_td),a.PART_Value_td_width=a.PART_Value_td.width();var o=e('<input id="'+a.PART_Value_id+'" class="defaultQuikerRowEmptyShow kd-defaultQuikerRow-partValue"  disabled="disabled" type="text">');if(o.css({height:"1.7em",width:a.isFilterGrid?"170px":this.quickFilterValueWidth+"px",border:"0px"}),o.attr("placeholder",ResManager.LoadKDString("请输入关键字后回车查询","00215181000006187")),a.PART_Value_td.append(o),a.PART_Value=e("#"+a.PART_Value_id),a.PART_Value.css({width:"100%",border:"0px",height:"24px"}),a.PART_Value_td.off("keydown").on("keydown",function(t){
var i=t.keyCode||t.which||t.charCode;13==i&&(KD.isIeBrowser()&&a._store&&a._store._items&&a._store._items[0]&&(a._store._items[0].ValueObject=e(t.target).val()),a&a.proxy&&a.proxy.el&&a.proxy.el.filterQuikerRows.find(".kd-filterquicker-condition-closebtn").click(),KD.delayInvoke(function(){a.proxy.barItemClick.call(a.proxy,"btnSearch")}))}),a.isFilterGrid){a.PART_Right_id=this.baseId+"_PART_Right",a.PART_Right_td=e("<td width='48px' id='"+a.PART_Right_id+"_P'></td>"),a.tr.append(a.PART_Right_td);var o=e('<input class="defaultQuikerRowEmptyShow kd-defaultQuikerRow-partRight" style = "height:2.1em;width:48px;" id="'+a.PART_Right_id+'" />');a.PART_Right_td.append(o),a.PART_Right=e("#"+a.PART_Right_id),a.PART_Logic_id=this.baseId+"_PART_Logic",a.PART_Logic_td=e("<td width='54px' id='"+a.PART_Logic_id+"_P'></td>"),a.tr.append(a.PART_Logic_td);var o=e('<input class="defaultQuikerRowEmptyShow kd-defaultQuikerRow-partLogic"  style="height:2.1em;width:54px;" id="'+a.PART_Logic_id+'" />');a.PART_Logic_td.append(o),a.PART_Logic=e("#"+a.PART_Logic_id)}a.optd=e("<td></td>"),a.tr.append(a.optd)},doLayout:function(){var t=this.getContent();if(t.isFilterGrid){var i=this.width(),a=i-525;if(a>0){a>460&&(a=460),t.PART_Fileds_td.css({width:120+120*a/528+"px"});var n={width:120+120*a/528+"px"};e("#"+t.PART_Fileds_id).css(n);var o=e("#"+t.PART_Fileds_id).data("kendoComboBox");o&&o.refresh&&e(".k-header",t.PART_Fileds_td).css(n)}else{t.PART_Fileds_td.css({width:"120px"});var n={width:"120px"};e("#"+t.PART_Fileds_id).css(n);var o=e("#"+t.PART_Fileds_id).data("kendoComboBox");o&&o.refresh&&e(".k-header",t.PART_Fileds_td).css(n)}}},setDisabled:function(t){this.disabled=t;for(var i=this.getContent(),a=[i.PART_Logic_id,i.PART_CompareType_id,i.PART_Left_id,i.PART_Right_id,i.PART_Fileds_id,i.PART_Value_id],n=a.length-1;n>=0;n--)if(a[n]!=i.PART_Fileds_id){if(a[n]!=i.PART_Value_id){var o=e("#"+a[n]).data("kendoDropDownList");o&&o.enable&&o.enable(!t)}else if(i.fr&&i.fr.valueproxy&&i.fr.valueproxy.setDisabled){var r=t;if(i.fr.DataContext&&i.fr.DataContext.CompareType){var s=i.fr.DataContext.CompareType;void 0==s.NeedInput||i.fr.DataContext.CompareType.NeedInput||(r=!0)}i.fr.valueproxy.setDisabled.call(i.fr.valueproxy,r)}}else{var o=e("#"+a[n]).data("kendoComboBox");o&&o.enable&&o.enable(!t)}},getFieldsEnumSource:function(e){var t=[];if(e)for(var i=0;i<e.length;i++){var a=e[i];t.push({alias:a.Caption,value:a.FieldName})}return t},getComparerTypesEnumSource:function(t){var i=[];if(t)for(var a=0;a<t.length;a++){var n=t[a];i.push(e.extend(n,{alias:n.Name,value:n.ID}))}return i},updateCurrentDataContext:function(e){void 0!=e._store&&void 0!=e._dataIndex&&void 0!=e._store._items&&e._store._items.length>e._dataIndex&&(e.DataContext=e._store._items[e._dataIndex])},setCurrentValueEditor:function(t,i,a,n){for(var o in i.DataContext.Fields)if(i.DataContext.Fields[o].FieldName==a){i.DataContext.FilterField=i.DataContext.Fields[o];break}if(i.DataContext.FilterField&&(i.PART_Value_td.empty().removeClass("k-state-disabled"),a)){i.DataContext.FilterField.Editor.id=i.PART_Value_id,i.DataContext.FilterField.Editor.height=KD.convertToPX(23/12);var r=t.proxy.controlFactoryProxy,s=i.PART_Value_id.toUpperCase();r.controls&&r.controls[s]&&r.removeProxyInstance(s);var l=this;i.DataContext.FilterField.Editor.width=i._store.isFilterGrid?170:l.quickFilterValueWidth,i.DataContext.FilterField.Editor.id=i.PART_Value_id,i.DataContext.FilterField.Editor.isFilterEditor=!0;var d={};if(!i.DataContext.CompareType||200!=i.DataContext.CompareType.GroupID&&201!=i.DataContext.CompareType.GroupID)if(i.DataContext.CompareType&&i.DataContext.CompareType.Editor&&i.DataContext.CompareType.Editor.xtype){for(var c in i.DataContext.CompareType.Editor){var h=i.DataContext.CompareType.Editor[c];KD.isObject(h)||e.isFunction(h)||(d[c]=h)}d.height=i.DataContext.FilterField.Editor.height,d.id=i.DataContext.FilterField.Editor.id,d.width=i.DataContext.FilterField.Editor.width,d.isFilterEditor=i.DataContext.FilterField.Editor.isFilterEditor,"numberfield"==d.xtype&&(d.isNeedDeaultZero=!1,d.isZeroShow=!1)}else d=i.DataContext.FilterField.Editor;else d=KD.cloneObject(i.DataContext.FilterField.Editor),d.xtype="kdcombo";d.AllowAutoList=i.DataContext.FilterField.AllowAutoList;var u=ResManager.LoadKDString("包含","014002030041796"),p=i.DataContext&&i.DataContext.CompareType;p&&("338"==p.ID||"214"==p.ID||410==p.GroupID||p.Name.indexOf(u)>-1)?(d.maxLength&&!d.oldMaxLength&&(d.oldMaxLength=d.maxLength),d.maxLength&&delete d.maxLength):d.oldMaxLength&&(d.maxLength=d.oldMaxLength);var g=t.proxy.getControlFactoryProxy().createControl(d);t.valueproxy=g,i.PART_Value_td.append(g.getControl()),g.loadConfig(d);var f=d.xtype;if(n&&n(i,f),i.EditXtype=f,g.onfilterchange=function(t,a){if(i.updateCurrentDataContext(i),"kdcheckbox"==f)void 0!=a.checked?i.DataContext.ValueObject=a.checked:i.DataContext.ValueObject=a;else if("textfield"==f&&a&&"string"==typeof a)i.DataContext.ValueObject=a,i.DataContext.Value=a;else if("bosf7field"==f)void 0!=a.current?(i.DataContext.ValueObject=a.current,i.DataContext.Value=a.current.number):a.name?(i.DataContext.ValueObject=a,i.DataContext.Value=a.name):a.number?(i.DataContext.ValueObject=a,i.DataContext.Value=a.number):void 0!=a&&(i.DataContext.ValueObject=a,i.DataContext.Value=a);else if("datetimefield"==f||"datefield"==f||"timefield"==f){var n=this._getControlInput();if(KD.isEmpty(a)&&!KD.isEmpty(n.val())){var o=this.component.data(this.getKendoCType());o._old=new Date}else i.DataContext.ValueObject=a,a&&a.format&&e.isFunction(a.format)&&this.format?i.DataContext.Value=a.format(this.format):i.DataContext.Value=a}else null!=a&&"object"!=typeof a?(i.DataContext.ValueObject=a,i.DataContext.Value=a):i.DataContext.ValueObject=void 0},g.postKey=i.PART_Value_id,"bosf7field"==f&&(g.postKey=i.DataContext.FilterField.FieldName,g.ProxyKey="FQKFILTERPANEL",g.onButtonClick=function(e,t){if(1!=this.disabled){var a=this.getCommitData(this._value),n=this.getFormProxy();if(i._store.isFilterGrid){n=g.getFormProxy();var o=g.config.lookup&&g.config.lookup.proxykey;KD.isEmpty(o)&&i.getProxy()&&i.getProxy().config&&(o=i.getProxy().config.id);var r=null,s="",d=l.proxy&&l.proxy.el,c=i&&i._dataIndex;d&&d.GetSetting&&(s=JSON.stringify(d.GetSetting())),KD.IsNullOrWhiteSpace(s)||(r=new Object,r.Key=o,r.Row=c,r.Value=s);var h=n&&n.getChangeData("","FilterGridF7ButtonClick");r&&h.push(r),n.fireEvent.call(n,"FilterGridF7ButtonClick",o,a.key,"",i._dataIndex)}else{var c=i&&i._dataIndex,r=null,s="",d=l.proxy&&l.proxy.el;d&&d.GetSetting&&(s=JSON.stringify(d.GetSetting())),KD.IsNullOrWhiteSpace(s)||(r=new Object,r.Key=g.ProxyKey,r.Row=c,r.Value=s);var h=n&&n.getChangeData("","FilterGridF7ButtonClick");r&&h.push(r);var u=this._getControlInput&&this._getControlInput(),p=u&&u.length&&u.length>0?u.val():"";n.fireEventNoData.call(n,"FilterGridF7ButtonClick","FQKFILTERPANEL",a.key,p,c,h)}return!0}}),g.initComponent&&g.initComponent(),g.setDisabled){var m=!1;void 0==i.DataContext.CompareType.NeedInput||i.DataContext.CompareType.NeedInput?void 0!=i.disabled&&i.disabled&&(m=!0):m=!0,g.setDisabled(m)}var v=i.DataContext.FilterField.CompareTypes,y=e("#"+i.PART_CompareType_id).data("kendoDropDownList").value();for(var o in v)if(i.updateCurrentDataContext(i),v[o].ID==y){g&&g.setFormat&&i.DataContext.CompareType.Editor&&e.isFunction(g.setFormat)&&g.setFormat(l._getDateFormat(i.DataContext.CompareType.Editor));break}if(g.setItemContaonerStyle&&g.setItemContaonerStyle(d.height),i.valueproxy=g,"kdcheckbox"==f&&void 0==i.DataContext.ValueObject&&(i.DataContext.ValueObject=!0,i.DataContext.Value=!0),"bosf7field"==f&&i.DataContext.ValueObject)if(void 0!=i.DataContext.CompareType.NeedInput&&i.DataContext.CompareType.NeedInput){var b=[];KD.isObject(i.DataContext.ValueObject)?(b.push(i.DataContext.ValueObject.name),b.push(i.DataContext.ValueObject.name)):(b.push(i.DataContext.ValueObject),b.push(i.DataContext.ValueObject)),g.setValue(b)}else g.setValue(["",""]);else{if("kdcombo"==f&&i.DataContext.FilterField.Editor.store&&i.DataContext.FilterField.Editor.store.length>0){var D,k=i.DataContext.FilterField.Editor.store[0],C=!1;for(var o in i.DataContext.FilterField.Editor.store)if(i.DataContext.Value&&i.DataContext.FilterField.Editor.store[o][0]&&i.DataContext.FilterField.Editor.store[o][0].toString()==i.DataContext.Value.toString()){C=!0,D=i.DataContext.FilterField.Editor.store[o][0];break}0==C?(i.DataContext.ValueObject=k[0],i.DataContext.Value=k[0]):(i.DataContext.ValueObject=D,i.DataContext.Value=D)}g.setValue(i.DataContext.ValueObject)}if(i.DataContext.CompareType&&(200==i.DataContext.CompareType.GroupID||201==i.DataContext.CompareType.GroupID)){var x=KD.getValue(i.DataContext.FilterField.Editor,"xtype",""),w=i.DataContext.Fields.filter(function(e){if(null==e||KD.isEmpty(e.FieldName)||KD.isEmpty(e.Caption))return!1;if(e.FieldName==i.DataContext.FilterField.FieldName)return!1;var t=KD.getValue(e.Editor,"xtype","");return t!=x&&("timefield"!=t&&"datefield"!=t&&"datetimefield"!=t||"timefield"!=x&&"datefield"!=x&&"datetimefield"!=x)&&("numberfield"!=t&&"digitfield"!=t||"numberfield"!=x&&"digitfield"!=x)?!1:!0}),K=[];for(var c in w)K.push([w[c].FieldName+"",w[c].Caption]);g.setStore(K),i.compareDataSource=KD.cloneObject(K)}"textfield"==f?e("input",i.PART_Value_td).attr("placeholder",ResManager.LoadKDString("请输入关键字后回车查询","00215181000006187")):"bosf7field"==f&&e("input",i.PART_Value_td).attr("placeholder",ResManager.LoadKDString("请选择内容后回车查询","00215181000006188")),i.PART_Value_td.width(i.PART_Value_td_width),i.PART_Value_td.find(".kd-div-checkbox-setpadding").hasClass("kd-div-checkbox-setpadding")&&i.PART_Value_td.find(".kd-div-checkbox-setpadding").css("margin-top","4px")}},_getDateFormat:function(e){var t=KD.getValue(e,"displayFormatString",void 0),i=KD.getValue(e,"mask",void 0),a=KD.getValue(e,"format","yyyy-MM-dd"),n=i||t||a;return n},setCurrentCompareWhenFilterGrid:function(e,t){var i=this;for(var a in e.DataContext.Fields)if(e.DataContext.Fields[a].FieldName==t.FieldName){e.DataContext.FilterField=e.DataContext.Fields[a];break}if(e.DataContext.FilterField){var n=e.DataContext.FilterField.CompareTypes,o=e.getComparerTypesEnumSource(n);e.DataContext.CompareType&&e.valueproxy&&e.valueproxy.setDisabled&&e.valueproxy.setDisabled(!e.DataContext.CompareType.NeedInput);var r={dataSource:o,enable:!this.disabled};t&&t.DefaultCompareID?r.value=t.DefaultCompareID:e.DataContext.CompareType&&(r.value=e.DataContext.CompareType.ID);var s=i._initCompareType(e,r,n),l=s.dataItem();l&&(e.DataContext.CompareType=l,e.DataContext.Compare=l.value,e.valueproxy&&e.valueproxy.setDisabled&&e.valueproxy.setDisabled(!e.DataContext.CompareType.NeedInput))}},getMaxListWidth:function(e){for(var t="auto",i=0,a=e.length-1;a>=0;a--){var n=e[a].alias||e[a].Caption;if(KD.getUTF8StrLeng(n)>15){var o=105+4*(KD.getUTF8StrLeng(n)-15);o>i&&(i=o)}else;}return i>=105?i:t},setLeftWhenFilterGrid:function(t){if(t.PART_Left_id){var i=KD.extendObject(t.leftOps,{change:function(e){t.updateCurrentDataContext(t),t.DataContext.Left=this.value()}});t.DataContext.Left?i.value=t.DataContext.Left:i.value="",e("#"+t.PART_Left_id).kendoDropDownList(i).data("kendoDropDownList").span.css({height:"1.58em"});var a=e("#"+t.PART_Left_id).data("kendoDropDownList");a.enable(!this.disabled)}},setRightWhenFilterGrid:function(t){if(t.PART_Right_id){var i=KD.extendObject(t.rightOps,{change:function(e){t.updateCurrentDataContext(t),t.DataContext.Right=this.value()}});t.DataContext.Right?i.value=t.DataContext.Right:i.value="",e("#"+t.PART_Right_id).kendoDropDownList(i).data("kendoDropDownList").span.css({height:"1.58em"});var a=e("#"+t.PART_Right_id).data("kendoDropDownList");a.enable(!this.disabled)}},setLogicWhenFilterGrid:function(t){if(t.PART_Logic_id){var i=KD.extendObject(t.LogicOps,{change:function(e){t.updateCurrentDataContext(t),t.DataContext.Logic=this.value();var i=this.dataItem();t.DataContext.LogicObject={Name:i.name,Alias:i.alias,Value:this.value()}}});t.DataContext.LogicObject?i.value=t.DataContext.LogicObject.Value:i.value="0",e("#"+t.PART_Logic_id).kendoDropDownList(i).data("kendoDropDownList").span.css({height:"1.58em"});var a=e("#"+t.PART_Logic_id).data("kendoDropDownList");a.enable(!this.disabled)}},setFilterField:function(t){var i=this,a=e("#"+t.PART_Fileds_id);if(0!=a.length){var n;n=t.DataContext.Fields&&t.DataContext.Fields[0]&&KD.IsNullOrWhiteSpace(t.DataContext.Fields[0].FieldName)?t.DataContext.Fields.slice(1):t.DataContext.Fields||[];var o=new kendo.data.DataSource({data:n}),r={dataTextField:"Caption",dataValueField:"FieldName",id:t.PART_Fileds_id,dataSource:[],height:380,filter:"contains",suggest:!0,template:'<span title="#: Caption #">#: Caption #</span>',change:function(a){if(-1!=i.oldFieldIndex||KD.isEmpty(i.oldFieldValue)||i.oldFieldValue!=this.value()){t.updateCurrentDataContext(t);var n=this.dataItem();e(".k-input",t.PART_Fileds_td).attr("title",n&&n.Caption||"");var o=e("#"+t.PART_CompareType_id).data("kendoDropDownList");if(void 0==n)return i.clearFilterFieldSelect(t),void(o&&o.enable(!1));o&&o.enable(!0),t.setCurrentCompareWhenFilterGrid(t,n),t.setCurrentValueEditor(t.fr,t,n.FieldName,function(e,t){e.EditXtype==t&&e.DataContext.SameXTypeRowTakeValue||(e.DataContext.ValueObject=void 0,e.DataContext.Value=void 0)}),i.options&&i.options.onchange&&i.options.onchange.call(i.options)}},cascade:function(e){i.oldFieldIndex=this._oldIndex,i.oldFieldValue=this._old}};if(t.DataContext.FilterField){r.value=t.DataContext.FilterField.FieldName;for(var s=!1,l=n.length-1;l>=0;l--){var d=n[l];if(d.FieldName==r.value){s=!0;break}}if(!s)return void(t.opadelete&&t.opadelete.click())}var c=a.data("kendoComboBox");c&&(c._clear&&c._clear.remove(),c.destroy());var h=a.kendoComboBox(r).data("kendoComboBox");h.setDataSource(o),void 0==r.value&&h.value(""),h.input.css({height:"24px"}),KD.setAsynchronousFilter(h.input),h.list.css({width:"auto","min-width":"110px"}),h.enable(!this.disabled),t.DataContext.FilterField&&e(".k-input",t.PART_Fileds_td).attr("title",t.DataContext.FilterField.Caption)}},clearFilterFieldSelect:function(e){e&&e._store&&e._store.clearItemByIndex&&e._store.clearItemByIndex.call(e._store,e._dataIndex),delete e.valueproxy,delete e.DataContext,e.PART_Value_td.empty().addClass("k-state-disabled")},release:function(){var t=this.getContent(),i=e("#"+t.PART_CompareType_id);i.data("kendoDropDownList")&&i.data("kendoDropDownList").destroy();var a=e("#"+t.PART_Left_id);a.data("kendoDropDownList")&&a.data("kendoDropDownList").destroy();var n=e("#"+t.PART_Right_id);n.data("kendoDropDownList")&&n.data("kendoDropDownList").destroy();var o=e("#"+t.PART_Logic_id);o.data("kendoDropDownList")&&o.data("kendoDropDownList").destroy();var r=e("#"+t.PART_Fileds_id);r.data("kendoComboBox")&&r.data("kendoComboBox").destroy()},SetDataContext:function(t,i,a,n,o){var r=this;if(a){var s=r.getContent();if(0==e("#"+s.PART_CompareType_id).length)return void KD["debugger"]("PART_CompareType is null",0==e("#"+s.PART_CompareType_id).length);s._store=t,s._dataIndex=i,s.DataContext=a,s.setLeftWhenFilterGrid(s),s.setRightWhenFilterGrid(s),s.setLogicWhenFilterGrid(s),s.setFilterField(s);var l=null;if(a.FilterField&&a.FilterField.CompareTypes)l=a.FilterField.CompareTypes;else{var d=(a.FieldName||(a.FilterField?a.FilterField.FieldName:""),t._fields?t._fields.filter(function(e){return e.FieldName==(a.FieldName||"")}):[]);l=d.length>0?d[0].CompareTypes:null}var c=this.getComparerTypesEnumSource(l,a.FieldName||""),h={dataSource:c,enable:!this.disabled},u=r._initCompareType(s,h,l),p=u.dataItem();p&&(s.DataContext.CompareType=p,s.DataContext.Compare=p.value),r.updateCurrentDataContext(s),s.DataContext.FilterField?(void 0!=n&&(s.disabled=n),s.setCurrentValueEditor(s.fr,s,s.DataContext.FilterField.FieldName),s.valueproxy&&s.valueproxy.setDisabled&&s.valueproxy.setDisabled(!s.DataContext.CompareType.NeedInput)):s.valueproxy&&s.valueproxy.setValue&&s.valueproxy.setValue("");s.DataContext.FilterField?s.DataContext.FilterField.Editor.xtype:"";if(void 0==s.opadelete){s.parent();if(!s.isFilterGrid&&0==i||0==o)return;s.opadelete=e(kendo.format("<div style='margin-left:5px;background-image:url({0})' class='DeleteButtonIconStyle' ></div>",KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png"))),s.opadelete.click(function(){s.disabled||null!=s.ondelete&&s.ondelete(s)}),s.optd.append(s.opadelete)}}},_initCompareType:function(t,i,a){var n=this,o=e.extend({dataSource:[],dataTextField:"alias",dataValueField:"value",height:330,autoWidth:!0,change:function(i){var o=this.value();for(var r in a)if(t.updateCurrentDataContext(t),a[r].ID==o){var s=!1;if(t.DataContext.CompareType=a[r],t.DataContext.Compare=o,t.setCurrentValueEditor(t.fr,t,t.DataContext.FilterField.FieldName,function(e,i){s=e.EditXtype==i&&e.DataContext.SameXTypeRowTakeValue,s&&!t.DataContext.CompareType.NeedInput&&(s=!1),s||(e.DataContext.ValueObject=void 0,e.DataContext.Value=void 0)}),t.valueproxy&&t.valueproxy.setDisabled&&t.valueproxy.setDisabled(!t.DataContext.CompareType.NeedInput),t.valueproxy&&t.valueproxy.setValue&&(200===t.DataContext.CompareType.GroupID||201===t.DataContext.CompareType.GroupID||s||t.valueproxy.setValue("")),!t.compareDataSource||200!=t.DataContext.CompareType.GroupID&&201!=t.DataContext.CompareType.GroupID||(t.DataContext.Value=t.compareDataSource[0][0]||underfined,t.DataContext.ValueObject=t.compareDataSource[0][0]||void 0),t.valueproxy&&t.valueproxy.setFormat&&t.DataContext.CompareType.Editor&&e.isFunction(t.valueproxy.setFormat)){var l=n._getDateFormat(t.DataContext.CompareType.Editor);t.valueproxy.setFormat(l)}break}e(".k-input",t.PART_CompareType_td).attr("title",this.text()),n.options&&n.options.onchange&&n.options.onchange.call(n.options)}},i);KD.isEmpty(o.value)&&t.DataContext.CompareType&&(o.value=t.DataContext.CompareType.ID);var r=e("#"+t.PART_CompareType_id);null!=r.data("kendoDropDownList")&&r.data("kendoDropDownList").destroy();var s=e("#"+t.PART_CompareType_id).kendoDropDownList(o).data("kendoDropDownList");return s.list.css({width:"auto","min-width":"85px"}),t.DataContext.CompareType&&e(".k-input",t.PART_CompareType_td).attr("title",t.DataContext.CompareType.Name),s}},e.fn.KDFilterQuickerRow.defaults={metaHtml:"",defaults:{}}}(jQuery),define("KDFilterQuickerRow",["KD"],function(e){return function(){var t;return t||e.KDFilterQuickerRow}}(this)),function(e){e.fn.KDFilterQuickerRows=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDFilterQuickerRows.prototype,e.fn.KDControlBase.defaults,e.fn.KDFilterQuickerRows.defaults,t);return this.frs=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.frs.options=t,i},e.fn.KDFilterQuickerRows.prototype={rowHeight:35,expRowLimit:125,maxAddCount:25,getContent:function(){return this.frs},loadConfig:function(t){var i=this;KD.setAttachmentData(this,t),KD.layout.setAbsolute(this,t);var a=i.getContent();if(a.isFilterGrid=KD.getValue(t,"isFilterGrid",!1),a.filtercontentid=this.baseId+"_fC",a.filtercontent=e("<div id='"+a.filtercontentid+"' class='kd-Filterquicker-filtercontent-filterrowcontainer'></div>"),a.filtercontent.appendTo(a),a.css("box-sizing","border-box"),a.addbtn_id=this.baseId+"_add",a.addbtn_div=e("<div id='"+a.addbtn_id+"_P' class='kd-filterQuikerRows-Container-addP'></div>"),a.isFilterGrid)this.initFilterGridBar(a);else{a.addbtn_div.appendTo(a);var n=e('<input id="'+a.addbtn_id+'" style="border: none;"  class="kd-Filterquicker-content-addCondition-input"/>');a.isFilterGrid?n.width(180):n.width(120),a.addbtn_div.append(n);var o=e(kendo.format('<div class="kd-Filterquicker-content-emptycondition">{0}</div>',ResManager.LoadKDString("重置条件","00215181000006887")));o.click(function(e){if(a.proxy&&a.proxy.el){var t=a.proxy.el;t.proxy.barItemClick.call(a.proxy,"ClearScheme")}}),a.addbtn_div.append(o);var r=e(kendo.format("<div class='kd-Filterquicker-footContainer'><div class='kd-filterquicker-foot-confirm'>{0}</div><div class='kd-filterquicker-foot-cancel'>{1}</div></div>",ResManager.LoadKDString("确定","002014030021131"),ResManager.LoadKDString("取消","002014030021133")));r.find(".kd-filterquicker-foot-cancel").click(function(){a.find(".kd-filterquicker-condition-closebtn").click()}),r.find(".kd-filterquicker-foot-confirm").click(function(){var e=a.proxy,t=e&&e.el;t&&(t.LoadDefaultQuikerRow&&t.LoadDefaultQuikerRow.call(t),t.showFilterQuikerItemScheme&&t.showFilterQuikerItemScheme.call(t,!0)),a.find(".kd-filterquicker-condition-closebtn").click(),e&&e.barItemClick.call(a.proxy,"btnSearch")}),a.append(r)}},initFilterGridBar:function(t){var i=this;t.addbtn_div=e("<ul class='k-link kdGridFilterBar'><li class='k-link kdFilterAdd'>"+ResManager.LoadKDString("新增行","0991733000003955")+"</li><li class='k-link kdFilterDelete'>"+ResManager.LoadKDString("删除行","0991733000003960")+"</li><li class='k-link kdFilterDeleteAll'>"+ResManager.LoadKDString("全部删除","0991733000003961")+"</li><li class='k-link kdFilterInsert'>"+ResManager.LoadKDString("插入行","0991733030033489")+"</li><li class='k-link kdFilterCopy'>"+ResManager.LoadKDString("复制行","0025710000008993")+"</li>NaN"),e(t.addbtn_div).css({position:"relative",top:"4.3px"}),t.addbtn_div.appendTo(t.addbtnParent),e(".kdFilterAdd",t.addbtn_div).click(function(e){i.handleAddClick.call(i,t)}),e(".kdFilterDelete",t.addbtn_div).click(function(e){i.handeDeleteClick.call(i,t)}),e(".kdFilterDeleteAll",t.addbtn_div).click(function(e){i.handleDeleteAllClick.call(i,t,e)}),e(".kdFilterInsert",t.addbtn_div).click(function(e){i.handleInsertClick.call(i,t)}),e(".kdFilterCopy",t.addbtn_div).click(function(e){i.handleCopyClick.call(i,t)})},initFilterGridSelectClick:function(t){var i=this;e(".kdFilterRowItem",t.filtercontent).off("click").on("click",function(a){var n=e(a.target).closest(".kdFilterRowItem");e(".kdFilterSelectRowItem",t.filtercontent).removeClass("kdFilterSelectRowItem"),n.addClass("kdFilterSelectRowItem"),i.syncUI2Sel(n)})},initFirstSelectRow:function(){var t=this.getContent();if(t.isFilterGrid){var i=e(".kdFilterRowItem",t.filtercontent);e(".kdFilterRowItem",t.filtercontent).removeClass("kdFilterSelectRowItem"),i.length>0?(e(i[0]).addClass("kdFilterSelectRowItem"),this.syncUI2Sel(e(i[0])),this.showEmptyTips(!1)):this.showEmptyTips(!0)}},syncUI2Sel:function(e){if(e&&this.isFilterGrid){var t=KD.getLocalConfiguration(),i=t.SelectRowBackground==t.DefaultRowBackground?void 0:t.SelectRowBackground||void 0;i&&(rows=e.siblings(),rows.css({"background-color":""}),e.css({"background-color":i}))}},handleAddClick:function(e){if(!this.disable&&!this.isExpRowLimit("add")){var t=0;e._store.AddNewRow(void 0,1,t),e._store._items[e._store._items.length-1].IsAddByUser=!0,e.addBtnTop=e.addRowItem(e._store._items,e._store._items.length-1,e.addBtnTop),1==e._store._items.length&&this.initFirstSelectRow(),this.initFilterGridSelectClick(e),this.fireChange()}},handleInsertClick:function(t){if(!this.disable&&!this.isExpRowLimit("insert")){var i=e(".kdFilterSelectRowItem",t.filtercontent),a=0;a=e(".kdFilterRowItem",t.filtercontent).index(i),i&&i.length>0?(t._store.insertNewRow(a),t._store._items[a].IsAddByUser=!0,t.addBtnTop=t.insertRowItem(t._store._items,a,t.addBtnTop),this.fireChange()):this.handleAddClick(t)}},handleCopyClick:function(t){if(!this.disable&&!this.isExpRowLimit("copy")){var i=e(".kdFilterSelectRowItem",t.filtercontent),a=0;a=e(".kdFilterRowItem",t.filtercontent).index(i),i&&i.length>0&&(t._store.copyNewRow(a),t._store._items[a+1].IsAddByUser=!0,t.addBtnTop=t.copyNewRow(t._store._items,a,t.addBtnTop)),this.fireChange()}},handeDeleteClick:function(t){if(!this.disable){var i=e(".kdFilterSelectRowItem",t.filtercontent);i&&i.length>0&&e(".DeleteButtonIconStyle",i).click(),this.fireChange()}},handleDeleteAllClick:function(e,t){this.deleteAllItems.call(this,e,t),this.fireChange()},fireChange:function(){var e=this.getContent();if(e&&e.options&&e.options.onchange){var t=e._store.GetSetting();e.options.onchange.call(e.options.onchange,this,JSON.stringify(t))}},deleteAllItems:function(e,t){if(!this.disable){for(var i=e._store._items.length,a=i-1;a>=0;a--)e._store.RemoveRow(a);e.SetItemsSource(e._store,!0),t.stopPropagation()}},deleteItemByIndex:function(e,t){e._store.RemoveRow(t),e.addBtnTop=e.removeRowItem(e._store._items,t,e.addBtnTop),0==e._store.isFilterGrid&&e.addbtn_div.css("margin-top",KD.convertToPX(e.addBtnTop/12)-10+"px")},doLayout:function(){var e=this.getContent();if(e&&void 0!=e.rowproxys&&e.rowproxys.length>0)for(var t=0;t<e.rowproxys.length;t++){var i=e.rowproxys[t];i&&i.row&&i.row.doLayout.call(i.row)}},setExpRowLimit:function(e){this.expRowLimit=e},isExpRowLimit:function(e){var t=this.getContent();if(!t._store)return!1;if(!t._store._items)return!1;var i=t._store._items.length;if(i<this.expRowLimit)return!1;var a=ResManager.LoadKDString("新增行","0991733000003955");switch(e){case"add":a=ResManager.LoadKDString("新增行","0991733000003955");break;case"copy":a=ResManager.LoadKDString("复制行","0025710000008993");break;case"insert":a=ResManager.LoadKDString("插入行","0991733030033489")}return KDMessageBox.show({type:KDMessageBox.KDMesBoxType.Warning,msg:KD.format(ResManager.LoadKDString("过滤条件行数超出{0}行的上限，不能{1}。","0025710000003824"),this.expRowLimit,a)}),!0},setDisabled:function(t){this.disable=t;var i=this.getContent(),a=e("#"+i.addbtn_id).data("kendoComboBox");if(i.isFilterGrid&&(t?i.addbtn_div.addClass("k-state-disabled"):i.addbtn_div.removeClass("k-state-disabled")),a&&a.enable&&a.enable(!t),i.rowproxys)for(var n in i.rowproxys){var o=i.rowproxys[n];o=o&&o.row,o&&o.setDisabled&&o.setDisabled.call(o,t)}},copyNewRow:function(t,i,a){var n=this,o=n.getContent(),r=t[i],s=t.length-1;if(r.FilterField||1==o._store.isFilterGrid){var l=kendo.guid()+"_row_copy",d={id:l,name:l,onchange:function(e,t){n.fireChange.call(n)}},c=e(".kdFilterRowItem",o.filtercontent),h=e(c[i]),u=h.css("top").replace("px","");u=parseFloat(u)+this.rowHeight;var p={id:l,height:"2.5em",width:510,y:u,isFilterGrid:o._store.isFilterGrid},g=null;if(a+=this.rowHeight,o.rowproxys.length<=s){g=e("<div class='kdFilterRowItem'></div>").KDFilterQuickerRow(d),g.attr("id",l),g.baseId=l,g.proxy=n.frs.proxy,g.loadConfig(p),h.after(g.getContent()),g.getContent().css("margin-top","0px"),g.doLayout.call(g);var f={};f.row=g,o.rowproxys.splice(i+1,0,f)}else g=o.rowproxys[i].row;g.SetDataContext(o._store,i+1,r,this.disable);for(var m=a-this.rowHeight,v=s;v>i+1;v--)o.rowproxys[v].row.css("top",m),o.rowproxys[v].row._dataIndex=v,m-=this.rowHeight;1==r.IsAddByUser&&(g.getContent().ondelete=function(e){n.deleteItemByIndex.call(n,o,e._dataIndex)}),this.initFilterGridSelectClick(o)}return a},removeRowItem:function(t,i,a){var n=this,o=n.getContent(),r=o.rowproxys.length-1;if(0>i||i>r)return a;var s=o.rowproxys[i].row;s.getContent().remove(),o.rowproxys.splice(i,1),n.showEmptyTips(0==r);for(var l=i;l<o.rowproxys.length&&o.rowproxys.length>0;l++){var d=o.rowproxys[l].row,c=parseFloat(d.css("top").replace("px",""))-this.rowHeight;d.css("top",c),d._dataIndex=l}0==i&&o.rowproxys.length>0&&(o.firstrow=o.rowproxys[0].row);var h=0;o.rowproxys[i]&&o.rowproxys[i]?h=i:0!=i&&o.rowproxys[i-1]&&(h=i-1);var u=e(".kdFilterRowItem",o.filtercontent);return e(".kdFilterRowItem",o.filtercontent).removeClass("kdFilterSelectRowItem"),e(u[h])&&e(u[h]).addClass("kdFilterSelectRowItem"),n.syncUI2Sel(e(u[h])),a-this.rowHeight},insertRowItem:function(t,i,a){var n=this,o=n.getContent(),r=t[i],s=t.length-1;if(r.FilterField||1==o._store.isFilterGrid){var l=kendo.guid()+"_row_ins",d={id:l,name:l,onchange:function(e,t){n.fireChange.call(n)}},c=e(".kdFilterRowItem",o.filtercontent),h=e(c[i]),u=h.css("top").replace("px",""),p={id:l,height:"2.5em",width:510,y:u,isFilterGrid:o._store.isFilterGrid},g=null;if(a+=this.rowHeight,o.rowproxys.length<=s){g=e("<div class='kdFilterRowItem'></div>").KDFilterQuickerRow(d),g.attr("id",l),g.baseId=l,g.proxy=n.frs.proxy,g.loadConfig(p),h.before(g.getContent()),g.getContent().css("margin-top","0px"),g.doLayout.call(g);var f={};f.row=g,o.rowproxys.splice(i,0,f)}else g=o.rowproxys[i].row;0==i&&(o.firstrow=g),g.SetDataContext(o._store,i,r,this.disable);for(var m=a-this.rowHeight,v=s;v>i;v--)o.rowproxys[v].row.css("top",m),o.rowproxys[v].row._dataIndex=v,m-=this.rowHeight;1==r.IsAddByUser&&(g.getContent().ondelete=function(e){n.deleteItemByIndex.call(n,o,e._dataIndex)})}return this.initFilterGridSelectClick(o),a},addRowItem:function(t,i,a,n){var o=this,r=o.getContent(),s=t[i],l=kendo.guid()+"_row_Add",d={id:l,name:l,onchange:function(e,t){o.fireChange.call(o)}},c={id:l,itemData:s,height:"2.5em",width:510,y:a,isFilterGrid:r._store.isFilterGrid},h=null;if(a+=this.rowHeight,r.rowproxys.length<=i){h=e("<div class='kdFilterRowItem'></div>").KDFilterQuickerRow(d),h.attr("id",l),h.baseId=l,h.proxy=o.frs.proxy,h.loadConfig(c),h.getContent().appendTo(r.filtercontent),h.getContent().css("margin-top","0px"),h.doLayout.call(h);var u={};u.row=h,r.rowproxys.push(u)}else h=r.rowproxys[i].row;return 0==i&&(r.firstrow=h),n?n.push({proxy:h,data:s,index:i}):h.SetDataContext(r._store,i,s,o.disable),h.getContent().ondelete=function(e){o.deleteItemByIndex.call(o,r,e._dataIndex)},a},SetItemsSource:function(e,t){$this=this;var i=e._items||[],a=$this.getContent();if(a._store!=e||1==t){a._store=e,a.rowproxys=a.rowproxys||[],a.firstrow=void 0,a.addBtnTop=0;var n=[];for(var o in i)a.addBtnTop=this.addRowItem(i,o,a.addBtnTop,n);for(var r=KD.isIeBrowser(),s=0;s<n.length&&s<a.maxAddCount;s++){var l=n[s];r||l.proxy.SetDataContext(a._store,l.index,l.data,$this.disable)}KD.delayInvoke(function(){for(var e=r?0:a.maxAddCount,t=e;t<n.length&&t<2*a.maxAddCount;t++){var i=n[t];i.proxy.SetDataContext(a._store,i.index,i.data,$this.disable)}}),KD.delayInvoke(function(){for(var e=2*a.maxAddCount;e<n.length;e++){var t=n[e];t.proxy.SetDataContext(a._store,t.index,t.data,$this.disable)}});for(var o=a.rowproxys.length-1;o>=i.length;o--){var d=a.rowproxys[o].row;d.getContent().remove(),a.rowproxys.splice(o,1)}0==a._store.isFilterGrid&&(a.addbtn_div.css({"margin-top":KD.convertToPX(a.addBtnTop/12)-10+"px","margin-bottom":"5px"}),this.setFilterField(a)),this.initFirstSelectRow(),this.initFilterGridSelectClick(a)}},setFilterField:function(t){var i=this;t.allAddFields=[],t.emptyField={Caption:ResManager.LoadKDString("请输入条件","00215181000006111"),FieldName:"-1"};for(var a in t._store._fields)""!=t._store._fields[a].Caption&&void 0!=t._store._fields[a].Caption&&t.allAddFields.push(t._store._fields[a]);var n=new kendo.data.DataSource({data:t.allAddFields}),o={dataTextField:"Caption",dataValueField:"FieldName",id:t.PART_Fileds_id,dataSource:t.allAddFields,height:380,filter:"contains",suggest:!0,change:function(e){var i=this.dataItem();if(i&&i.FieldName&&"-1"!=i.FieldName){this.input.attr("placeholder",t.emptyField.Caption),this.value("");for(var a in t._store._fields)if(t._store._fields[a].FieldName==i.FieldName){t._store.AddNewRow(void 0,1,a),t._store._items[t._store._items.length-1].IsAddByUser=!0;var n=t._store._items.length-1;0==t._store.isFilterGrid&&t._store._items.length>0&&KD.isEmpty(t._store._items[0].FieldName)&&(t._store._items[0].IsAddByUser=!1),t.addBtnTop=t.addRowItem(t._store._items,n,t.addBtnTop),0==t._store.isFilterGrid&&t.addbtn_div.css("margin-top",KD.convertToPX(t.addBtnTop/12)-10+"px");break}}}};e("#"+t.addbtn_id).data("kendoComboBox")&&e("#"+t.addbtn_id).data("kendoComboBox").destroy();var r=e("#"+t.addbtn_id).kendoComboBox(o).data("kendoComboBox");if(r&&r.setDataSource(n),r&&r.text(""),r&&r.input.attr("placeholder",t.emptyField.Caption).css({height:"1.83em"}),r&&r.list.css({width:"auto","min-width":"170px"}),r&&KD.setAsynchronousFilter(r.input),r&&r.enable(!this.disable),t.rowproxys&&t.rowproxys.length>0)for(var s=0;s<t.rowproxys.length;s++)rowproxy=t.rowproxys[s].row,rowproxy.setDisabled&&rowproxy.setDisabled(this.disable);e(".k-combobox",t.addbtn_div).css({top:t.isFilterGrid?"-0.23em":"0em",left:t.isFilterGrid?"0.33em":"1px"}),e(".AddButtonIconStyle",t.addbtn_div).click(function(){i.disable||r.open()}),t.delAllRows&&t.isFilterGrid&&t.delAllRows.off("click").on("click",function(e){
i.deleteAllItems.call(i,t,e)})},UpdateFirstRow:function(e,t){var i=this,a=i.getContent();a._store=e,a.firstrow&&a.firstrow.SetDataContext(e,0,t)},UpdateRow:function(e,t,i){var a=this.getContent();a._store=e,0>t||null==a.rowproxys||void 0==a.rowproxys||a.rowproxys.length<=t||a.rowproxys[t].row.SetDataContext(e,t,i)},release:function(){var t=this.getContent(),i=e("#"+t.addbtn_id).data("kendoComboBox");if(i&&i.destroy&&i.destroy(),t.rowproxys)for(var a=0;a<t.rowproxys.length;a++){var n=t.rowproxys[a],o=t.rowproxys[a].row;o&&o.release&&o.release(),n&&n.release&&n.release()}},showEmptyTips:function(t){var i=this,a=i.getContent();if(t)if(a.emptyshow)a.emptyshow.show();else{var n="../images/biz/default/MainConsole/H5CardLayout/icon_task_NoData.png?"+KD.getVersion(),o=ResManager.LoadKDString("暂无新增条件数据","002014000006413"),r=e(kendo.format('<div class="kd-filterquicker-emptyshow"><img src={0}><p>{1}</p></div>',n,o));a.emptyshow=r,a.append(r)}else a.emptyshow&&a.emptyshow.hide()}},e.fn.KDFilterQuickerRows.defaults={metaHtml:"",defaults:{}}}(jQuery),define("KDFilterQuickerRows",["KD"],function(e){return function(){var t;return t||e.KDFilterQuickerRows}}(this)),KDFilterPanelProxy=KD.extend(KDEditorProxy,{initComponent:function(){var e=$("<div></div>");this.el.append(e),this.el.css({"overflow-y":"auto","overflow-x":"hidden"}),this.component=e,this.component.attr("style","min-height:2em").attr("id",this.baseId+"_c"),this.setVisible(KD.getValue(this.config,"visible",!0)),this.rendered=!0,this.setStylekey(KD.getValue(this.config,"Stylekey","")),this.setToolTip(this.config.tooltip||this.config.description||""),this.createColumn(),this.doLazyAction()},createColumn:function(){var e=(this.el.children(".ui-columnLayout"),$("<div></div>"));e.attr("id",this.baseId+"-cols"),this.component.append(e),this.column=e}}),KDFilterCPEntrysProxy=KD.extend(KDFilterPanelProxy,{exceptMutualEntities:[],loadConfig:function(e){this.exceptMutualEntities=[],KDFilterCPEntrysProxy.superclass.loadConfig.call(this,e)},getOnLineCount:function(){return null==ClientAppProxy.Current.CTX?5:1033==ClientAppProxy.Current.getUserLocalId()?4:5},setListeners:function(e){this._listeners=e},getSelectEntities:function(){var e=[","],t=this;return $.each(this._filterEntitys,function(i,a){t.isChecked(a.Key)&&e.push(a.Key)}),e.push(","),e.join(",")},setSelectEntities:function(e){this.needFireEvent=!1;this._selEntities=e;var t=!1;_progamSetValue=!0;var i=this;$.each(this._filterEntitys,function(e,a){i._isContainEnties(i._selEntities,a.Key)?(t=!0,i.setChecked(a.Key,!0)):i.setChecked(a.Key,!1);var n=i.getDisabled()?!1:!(1==a.IsDefault);i.setEnable(a.Key,n)}),this.needFireEvent=!0,!t&&this._filterEntitys.length>0&&i.setChecked(this._filterEntitys[0].Key,!0),this._progamSetValue=!1},_isContainEnties:function(e,t){var i=!1,t=(t||"").toUpperCase().trim(),a=(e||"").toUpperCase().split(",");if(a.length<=0)return(e||"").toUpperCase().indexOf(t)>-1;for(var n=0;n<a.length;n++)if(a[n].trim()==t)return!0;return i},_getFilterFieldsBySelectEnties:function(e){for(var t=[],i=0;i<this._filterEntitys.length;i++){var a=this._filterEntitys[i];e.toUpperCase().indexOf(a.Key.toUpperCase())>=0&&t.push(a)}return t},setEntities:function(e){if(this._filterEntitys=e,this._entityCheckKeyMap={},this._entryCheckEdits={},this.keyParentKeyMapping={},this.column){var t=this;t.column.empty(),$.each(t._filterEntitys,function(e,i){var a={label:i.Caption,change:function(e,a){t.onchange.call(t,i,e,a)}},n=$("<div id='"+t.baseId+i.Key.toUpperCase()+"'></div>").css({margin:"2.5px 3px",visibility:KD.getValue(i,"visible",!0)?"visible":"hidden","float":"left"});t.column.append(n),n.kendoCheckBox(a);var o=KD.getValue(i,"ParentKey","");i.IsHeader||(t._entryCheckEdits[i.Key]=1,t.keyParentKeyMapping[i.Key.toUpperCase()]||(t.keyParentKeyMapping[i.Key.toUpperCase()]=o.toUpperCase()))})}},onchange:function(e,t,i){if(!this._progamSetValue){var a=!0,n=this._checkIsExceptMutualEntities(e.Key);n&&(a=!1),this._entryCheckEdits[e.Key]&&a?this.entityMutual(e.Key,i):this.excuteDataChange()}},setExceptMutualEntities:function(e){e&&e.split&&(this.exceptMutualEntities=e.split(","))},_checkIsExceptMutualEntities:function(e){var t=!1;if(!KD.isEmpty(this.exceptMutualEntities))for(var i=0;i<this.exceptMutualEntities.length;i++)if(KD.equalsIgnoreCase(this.exceptMutualEntities[i],e)){t=!0;break}return t},entityMutual:function(e,t){var i=void 0,a={},n={};e=e.toUpperCase();var o=this;if(t){for(a[e]=1,this.keyParentKeyMapping[e]&&(i=o.keyParentKeyMapping[e]);!KD.IsNullOrWhiteSpace(i)&&(a[i]=1,this.keyParentKeyMapping[i]);)i=this.keyParentKeyMapping[i];$.each(o.keyParentKeyMapping,function(e){a[e]||e==i||(n[e]=1)})}else this.getNeedUnSelectedKeyList(o.keyParentKeyMapping,n,e);o._progamSetValue=!0,$.each(a,function(e){var t=o._checkIsExceptMutualEntities(e);1!=t&&o.setChecked(e,!0)}),$.each(n,function(e){var t=o._checkIsExceptMutualEntities(e);1!=t&&o.setChecked(e,!1)}),o._progamSetValue=!1,o.excuteDataChange()},getNeedUnSelectedKeyList:function(e,t,i){t[i]=1,$.each(e,function(a){e[a]==i&&(t[a]=1)})},setChecked:function(e,t){var i=$("#"+this.baseId+e.toUpperCase());null!=i&&i.data("kendoCheckBox").value(t)},setDisabled:function(e){var t=this;KDFilterCPEntrysProxy.superclass.setDisabled.call(t,e),$.each(t._filterEntitys,function(e,i){var a=t.getDisabled()?!1:!(1==i.IsDefault);t.setEnable(i.Key,a)})},setEnable:function(e,t){var i=$("#"+this.baseId+e.toUpperCase());null!=i&&i.data("kendoCheckBox").enable(t)},isChecked:function(e){var t=$("#"+this.baseId+e.toUpperCase());return null!=t?t.data("kendoCheckBox").value():!1},excuteDataChange:function(){var e=this.getSelectEntities();if(this.needFireEvent&&this.getFormProxy().fireEvent("UpdateValue",this.key,e,0),this.needFireEvent&&null!=this._listeners){var t=this.getControlFactoryProxy(),i={name:"selectEntities",args:{selectEntities:e}};$.each(this._listeners,function(a,n){var o=t.getCmp(n);null!=o&&(o.lazyActions&&o.lazyActions.push(i),o.setSelectEntities(e))})}}}),KDControlFactoryProxy.registerType("kdfcpentrys",KDFilterCPEntrysProxy),define("KDFilterCPEntrysProxy",["KDEditorProxy","KDCheckBox","KD"],function(e){return function(){var t;return t||e.KDFilterCPEntrysProxy}}(this)),KDFilterSortProxy=KD.extend(KDEditorProxy,{validation:!0,initComponent:function(){KDFilterSortProxy.superclass.initComponent.call(this),this.createLayoutDom(),this.creatSourceFieldList(),this.createMiddlePanel(),this.creatTagetFieldList(),this.doLazyAction()},createLayoutDom:function(){this.sid=this.baseId+"S",this.mid=this.baseId+"M",this.tid=this.baseId+"T",this.btnAdd=this.baseId+"A",this.btnRemove=this.baseId+"R",this.btnRemoveAll=this.baseId+"RA",this.btnUp=this.baseId+"U",this.btnDown=this.baseId+"D",this.el.append($("<table width=100% height='"+this.el.height()+"px' cellspace='0' border='0px'><tbody><tr><td id='"+this.sid+"' width='35%' valign='top' style='padding:0px;margin:0px;' ></td><td width='96px' valign='center' align='center'><table height='100%' width='70px' style='border-spacing: 0px;'><tbody><tr height=105px></tr><tr height=34px><td><button class='kd-filtersort-btn' id='"+this.btnAdd+"' type='button'>Add</button></td></tr><tr height=34px><td><button class='kd-filtersort-btn' id='"+this.btnRemove+"' type='button'>remove</button></td></tr><tr height=34px><td><button class='kd-filtersort-btn' id='"+this.btnRemoveAll+"' type='button' class='kd-text-ellipsis'>remove All</button></td></tr><tr height=15px><td></td></tr><tr height=34px><td><button class='kd-filtersort-btn' id='"+this.btnUp+"' type='button'>Up</button></td></tr><tr height=34px><td><button class='kd-filtersort-btn' id='"+this.btnDown+"' type='button'>Down</button></td></tr><tr></tr></tbody></table></td><td id='"+this.tid+"' width='45%' valign='top' style='padding:0px;margin:0px;'></td></tr></tbody></table>"))},creatSourceFieldList:function(){var e=this,t={id:this.baseId+"SourceFieldList",height:this.el.height()-50,width:"100%",selectable:!0,editable:!1,dataSource:{data:[]},columns:[{field:"Caption",template:'<span class="kd-grid-cellspan kd-filtersort-cellspan" title="#: Caption #">#: Caption #</span>',headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("字段","099002000000030"))},{field:"FieldName",template:'<span class="kd-grid-cellspan" title="#: FieldName #">#: FieldName #</span>',title:"FieldName",hidden:!0}],change:function(t){e.syncUI2Sel(t,e.sourceGrid)}},i=$('<div id="'+t.id+'" style="width:100%;"></div>');$("#"+this.sid);$("#"+this.sid).append(i),i.kendoGrid(t),this.sourceGrid=i.data("kendoGrid")},createMiddlePanel:function(){var e=this;this.createButton(this.btnAdd,ResManager.LoadKDString("加入","099002000000045"),"",function(t){e.btnAddOnClick.call(e,t)}),this.createButton(this.btnRemove,ResManager.LoadKDString("删除","099002000000046"),"",function(t){e.btnRemoveOnClick.call(e,t)});var t=ResManager.LoadKDString("全删","099002000000047");this.createButton(this.btnRemoveAll,t,"",function(t){e.btnRemoveAllOnClick.call(e,t)}),t.length>5&&$("#"+this.btnRemoveAll,this.el).attr("title",t),this.createButton(this.btnUp,ResManager.LoadKDString("上移","099002000000048"),"",function(t){e.btnUpOnClick.call(e,t)}),this.createButton(this.btnDown,ResManager.LoadKDString("下移","099002000000042"),"",function(t){e.btnDownOnClick.call(e,t)})},createButton:function(e,t,i,a){var n={id:e,icon:i,caption:t};n.click=a,$("#"+n.id,this.el).text(n.caption).kendoButton(n)},creatTagetFieldList:function(){var e=this,t={id:this.baseId+"TagetFieldList",height:this.el.height()-50,width:"100%",selectable:!0,editable:!0,autoBind:!0,dataSource:{id:"Number",data:[],autoSync:!1,schema:{model:{fields:{Number:{editable:!1},Caption:{editable:!1},FieldName:{editable:!1},SortType:{editable:!0,defaultValue:{Value:0,Name:ResManager.LoadKDString("升序","0025710030032334")}}}}}},columns:[{field:"Number",template:'<span class="kd-grid-cellspan">#: Number #</span>',width:30,headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("序号","0025710030032346"))},{field:"Caption",template:'<span class="kd-grid-cellspan" title="#: Caption #">#: Caption #</span>',width:120,headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("字段","099002000000030"))},{field:"FieldName",template:'<span class="kd-grid-cellspan" title="#: FieldName #">#: FieldName #</span>',title:"FieldName",hidden:!0},{field:"SortType",template:"#= SortType.Name #",width:60,headerTemplate:'<span title="'+ResManager.LoadKDString("排序方式","099002000000049")+'">'+ResManager.LoadKDString("排序方式","099002000000049")+"</sapn>",editor:function(e,t){$('<input  required data-text-field="Name" data-value-field="Value"  data-bind="value:'+t.field+'"/>').appendTo(e).kendoDropDownList({dataSource:{data:[{Name:ResManager.LoadKDString("升序","099002000000050"),Value:0},{Name:ResManager.LoadKDString("降序","099002000000051"),Value:1}]}})}}],change:function(t){e.syncUI2Sel(t,e.tagGrid)}},i=$('<div id="'+t.id+'" style="width:100%;"></div>'),a=$("#"+this.tid);a.append(i),i.kendoGrid(t),this.tagGrid=i.data("kendoGrid")},syncUI2Sel:function(e,t){if(t&&t.select){var i=t.select(),a=KD.getLocalConfiguration(),n=a.SelectRowBackground==a.DefaultRowBackground?void 0:a.SelectRowBackground||void 0;n&&(rows=i.siblings(),rows.css({"background-color":""}),i.css({"background-color":n}))}},setSortFields:function(e){this.defaultData=e,this._setSourceData(e)},setSelectEntities:function(e){if(this.sourceGrid&&this.defaultData){var t=this.getFieldsBySelectEnties(this.defaultData,e);this.originalDataRows=$.map(t,function(e){return $.extend(!0,{},e)}),this._setSourceData(t)}},getFieldsBySelectEnties:function(e,t){var i=[];return $.each(e,function(e,a){(","+t+",").toUpperCase().indexOf(","+a.EntityKey.toUpperCase()+",")>-1&&i.push(a)}),i},setSortRows:function(e){var t=new Array;for(i=0;i<e.length;i++){var a=e[i],n=a.SortType,o=ResManager.LoadKDString("升序","0025710030032334");0!=n&&(o=ResManager.LoadKDString("降序","0025710030032335"));var r=a.Caption.filter(function(e){return e.Key==KD.cookieLanguageId()}),s={Number:i+1,Caption:r[0].Value,FieldName:a.FieldName,SortType:{Name:o,Value:n}};t.push(s)}this._setTagData(t)},_setSourceData:function(e){var t=new kendo.data.DataSource({data:e,autoSync:!0,schema:{model:{fields:{FieldName:{editable:!1},Caption:{editable:!1}}}}});this.sourceGrid.setDataSource(t),this.sourceGrid.content&&this._setTableTouchActionToAuto(this.sourceGrid.content);var i=this;$("tr[role='row']","#"+this.sid).dblclick(function(e){i.btnAddOnClick(e)})},_setTagData:function(e){this.currentRows=e;var t=new kendo.data.DataSource({data:e,autoSync:!0,schema:{model:{id:"Number",fields:{Number:{editable:!1},Caption:{editable:!1},FieldName:{editable:!1},SortType:{editable:!0,defaultValue:{Value:0,Name:ResManager.LoadKDString("升序","0025710030032334")}}}}}});this.tagGrid.setDataSource(t),this.tagGrid.content&&this._setTableTouchActionToAuto(this.tagGrid.content)},_setTageSelectIndex:function(e){var t=this.tagGrid.tbody.find(">tr:not(.k-grouping-row)").eq(e);this.tagGrid.select(t)},btnAddOnClick:function(e){var t=this.sourceGrid.select();if(!(null==t||t.length<=0)){var i=this.sourceGrid.dataItem(t),a=this.tagGrid.dataItems();for(var n in a)if(a[n].FieldName==i.FieldName)return;a.push({Number:a.length+1,Caption:i.Caption,FieldName:i.FieldName,SortType:{Name:ResManager.LoadKDString("升序","0025710030032334"),Value:0}});var o=this.tagGrid.select(),r=this.copyNewTagData(a),s=this.tagGrid.dataItem(o);this._setTagData(r),null!=s&&this._setTageSelectIndex(s.Number-1)}},copyNewTagData:function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i];t.push({Number:a.Number,Caption:a.Caption,FieldName:a.FieldName,SortType:{Name:a.SortType.Name,Value:a.SortType.Value}})}return t},_setTableTouchActionToAuto:function(e){!KD.isEmpty(e)&&KD.isMobileOS()&&e.find("table").css("touchAction","auto")},btnRemoveOnClick:function(e){var t=this.tagGrid.select();if(!(null==t||t.length<=0)){for(var i=this.tagGrid.dataItem(t),a=this.tagGrid.dataItems(),n=[],o=0;o<a.length;o++)a[o].FieldName!=i.FieldName&&n.push({Number:0,Caption:a[o].Caption,FieldName:a[o].FieldName,SortType:{Value:a[o].SortType.Value,Name:a[o].SortType.Name}});$.each(n,function(e,t){t.Number=e+1});var r=this.copyNewTagData(n);this._setTagData(r),i.Number==a.length&&i.Number&&i.Number-2>=0?this._setTageSelectIndex(i.Number-2):i.Number&&i.Number-1>=0&&this._setTageSelectIndex(i.Number-1)}},btnRemoveAllOnClick:function(e){this._setTagData([])},btnUpOnClick:function(e){var t=this.tagGrid.select();if(!(t.length<=0)){var i=this.tagGrid.dataItem(t);null!=i&&this._moveRow(i,!0)}},btnDownOnClick:function(e){var t=this.tagGrid.select();if(!(t.length<=0)){var i=this.tagGrid.dataItem(t);null!=i&&this._moveRow(i,!1)}},_moveRow:function(e,t){var i=this.tagGrid.dataItems();if(this.currentRows&&!(this.currentRows.length<=0)){var a=0;if(t){if(1==e.Number)return;a=e.Number-1}else{if(e.Number==i.length)return;a=e.Number+1}for(var n=this.tagGrid.dataItems()[a-1],o=0;o<this.currentRows.length;o++){var r=this.currentRows[o];r.Number==a?(r.Caption=e.Caption,r.FieldName=e.FieldName,r.SortType.Value=e.SortType.Value,r.SortType.Name=e.SortType.Name):r.Number==e.Number&&(r.Caption=n.Caption,r.FieldName=n.FieldName,r.SortType.Value=n.SortType.Value,r.SortType.Name=n.SortType.Name)}this._setTagData(this.currentRows),this._setTageSelectIndex(a-1)}},validating:function(e){return void 0==e&&(e=!0),this.commitValueToForm(),!0},commitValueToForm:function(e){if(void 0!=this.tagGrid){var t=this.getCommitData(e);this.getFormProxy().storeData(t.key,t.value,t.row,t.parentRow)}},getCommitData:function(e){var t=[],i=this.tagGrid.dataItems();i.sort(function(e,t){return e.Number>t.Number?1:-1});for(var a=0;a<i.length;a++){var n=i[a].SortType;t.push({FieldName:i[a].FieldName,SortType:n.Value})}return{key:this.postKey,value:JSON.stringify(t),row:this.getRow(),parentRow:this.getParentRow()}}}),KDControlFactoryProxy.registerType("kdsp",KDFilterSortProxy),define("KDFilterSortProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDFilterSortProxy}}(this)),KDFilterShowHideProxy=KD.extend(KDEditorProxy,{validation:!0,defaultData:[],originalDataRows:[],showHideFields:[],showHideRows:[],currentRows:[],key:"",initComponent:function(){KDFilterShowHideProxy.superclass.initComponent.call(this),this.createLayoutDom(),this.creatFieldList(),this.createOpPanel(),this.doLazyAction()},createLayoutDom:function(){this.sid=this.baseId+"Col",this.btnDefault=this.baseId+"ColRA",this.btnUp=this.baseId+"ColU",this.btnDown=this.baseId+"ColD",this.numberEdit=this.baseId+"ColNum",this.linkToLine=this.baseId+"ColTo",this.currentSelectNum=this.baseId+"currentSelectNum",this.el.css("overflow","auto").append($("<table width=100% class='showHideFilterAll' height=100%><tbody><tr><td valign='top' id='"+this.sid+"' width='450px' height='100%'></td><td valign='top' style='width:auto;float:right;height:"+(this.el.height()-32)+"px;'><table height=100% style='min-width:80px;' class='kd-filter-operate-container'><tbody><tr height=90px></tr><tr height=34px role='UpDownBtn'><td><button class='kd-filtersort-btn' id='"+this.btnUp+"' type='button'>Up</button></td></tr><tr height=15px></tr><tr height=34px role='UpDownBtn'><td><button class='kd-filtersort-btn' id='"+this.btnDown+"' type='button'>Down</button></td></tr><tr role='UpDownBtn'><td style='height:8.3em'><table style=''><tr height=20px><td><div style='float:left;display:inline;'><a id='"+this.linkToLine+"' class='k-link KDButton ConsoleFunctionButtonStyle' style='padding-left:10px;text-decoration:underline;'></a></div></td></tr><tr  height=34px><td style='padding-top: 0px;padding-left: 10px'><input id='"+this.numberEdit+"' name='numberEdit_el' style='height:20px;width:55px;padding-top:0px;margin-top:0px;'/></td></tr><tr  height=5px><td></td></tr></table></td></tr><tr height=34px><td><button class='kd-filtersort-btn' id='"+this.btnDefault+"' type='button'>Default</button></td></tr><tr><td style='vertical-align:bottom;padding-bottom:2.5em;'><span id='"+this.currentSelectNum+"' class='currentSelectNum' value='0'>"+ResManager.LoadKDString("当前选中0列","0025710030034381")+"</span></td></tr></tbody></table></td><td></td></tr></tbody></table>"))},creatFieldList:function(){var e=this,t=(' data-field="Visible" data-rowId="'+KDStore.C_HeadCheckAllRowId+'" ',{id:this.baseId+"_ColumnList",height:this.el.height()-32,width:"450px",selectable:!0,editable:!0,dataSource:{data:[]},autoBind:!0,filterable:{mode:"row"},resizable:!0,save:function(e){},columns:[{field:"Number",template:'<span class="kd-grid-cellspan">#: Number #</span>',width:40,headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("序号","0025710030032346")),filterable:!1},{field:"Caption",template:'<span class="kd-grid-cellspan" title="#: Caption #">#: Caption #</span>',headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("字段","099002000000030")),filterable:{cell:{showOperators:!1,operator:"contains",suggestionOperator:"contains",template:function(e){e.element.attr("placeholder",ResManager.LoadKDString("过滤条件","0991733000003935")).css("width","100%").addClass("k-textbox").keyup(function(e){setTimeout(function(){$(e.target).trigger("change")})})}}}},{field:"FieldName",template:'<span class="kd-grid-cellspan" title="#: FieldName #">#: FieldName #</span>',title:"FieldName",hidden:!0},{field:"Visible",title:ResManager.LoadKDString("显示","099002000000040"),width:60,headerTemplate:'<input type="checkbox" onclick="return false;" class="k-checkbox gridCheck gridCheckHeader"  data-field="Visible" data-rowId="'+KDStore.C_HeadCheckAllRowId+'" /><label class="k-checkbox-label k-headerCheckbox-label" for=":before">'+ResManager.LoadKDString("显示","099002000000040")+"</label>",template:'<div data-role="checkbox" class="kd-grid-celldiv  #= Locked ? "kd-filtergrid-celldiv-locked" : "" #" ><input type="checkbox" onclick="return false;" class="k-checkbox gridCheck gridCheckCell"  data-field="Visible" data-rowId="#= Number-1 #"  #= Visible ?  checked="checked":"" # /><label class="k-checkbox-label" for=":before"></label></div>',filterable:!1},{field:"ColWidth",width:60,template:'<span class="kd-grid-cellspan">#: ColWidth #</span>',headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1" style="border-left: 1px solid #AAADB4;">{0}</a>',ResManager.LoadKDString("宽度","099002000000041")),filterable:!1}],change:function(t){e.syncUI2Sel(t,e.columnsGrid)}}),i=$('<div id="'+t.id+'" style="width:450px;"></div>'),a=$("#"+this.sid);a.append(i),i.kendoGrid(t),this.columnsGrid=i.data("kendoGrid"),$("#"+this.sid).delegate(".k-headerCheckbox-label","click",function(){var t=this,i=$(".gridCheck",$(t).parent());if(i.length){var a=!i.is(":checked"),n=i.data();n.field;i[getPropName()]("checked",a);var o=$(t).closest(".k-grid").data("kendoGrid");o.table.find(".kd-grid-celldiv:not(.kd-filtergrid-celldiv-locked)").find(".gridCheckCell")[getPropName()]("checked",a);for(var r,s=o.dataItems(),l=0;l<s.length;l++)if(r=s[l],!KD.isEmpty(r)&&!r.Locked){r.Visible=a;var d=e._getRowByFieldName(r.FieldName);KD.isEmpty(d)||(d.Visible=a)}if(e.currentRows&&!(e.currentRows.length<=0)){for(var c=0,l=0;l<e.currentRows.length;l++)r=e.currentRows[l],c=r.Visible?c+1:c;$("#"+e.currentSelectNum).text(ResManager.LoadKDString("当前选中","0025710030033501")+" "+c+" "+ResManager.LoadKDString("列","0025710030033502")).attr("value",c)}}}),$("#"+this.sid+' tbody[role="rowgroup"]').delegate('.kd-grid-celldiv[data-role="checkbox"]',"click",function(t){var i=this;if(!$(i).hasClass("kd-filtergrid-celldiv-locked")){var a=$(".gridCheck",$(i)),n=!a.is(":checked");a.data();a[getPropName()]("checked",n);var o=$(this).parent().parent().index(),r=$(i).closest(".k-grid").data("kendoGrid").dataItems()[o];r.Visible=n,e.currentRows[r.Number-1].Visible=n;for(var s=e.currentRows,l=0,d=0;d<s.length;d++)1==s[d].Visible&&l++;var c=$(".gridCheck",$("#"+e.sid+" .k-headerCheckbox-label").parent()),h=l==s.length?!0:!1;c[getPropName()]("checked",h),$("#"+e.currentSelectNum).text(ResManager.LoadKDString("当前选中","0025710030033501")+" "+l+" "+ResManager.LoadKDString("列","0025710030033502")).attr("value",l)}})},_getRowByFieldName:function(e){var t,i=this;if(!KD.isEmpty(i.currentRows)&&!KD.isEmpty(e))for(var a=0;a<i.currentRows.length;a++){var n=i.currentRows[a];if(n=n||{},KD.equalsIgnoreCase(n.FieldName,e)){t=n;break}}return t},syncUI2Sel:function(e,t){if(t&&t.select){var i=t.select(),a=KD.getLocalConfiguration(),n=a.SelectRowBackground==a.DefaultRowBackground?void 0:a.SelectRowBackground||void 0;n&&(rows=i.siblings(),rows.css({"background-color":""}),i.css({"background-color":n}))}},createOpPanel:function(){var e=this;this.createButton(this.btnUp,ResManager.LoadKDString("上移","0025710030032347"),"",function(t){e.btnUpOnClick.call(e,t)}),this.createButton(this.btnDown,ResManager.LoadKDString("下移","099002000000042"),"",function(t){e.btnDownOnClick.call(e,t)});var t={caption:ResManager.LoadKDString("调至（行）","00215190000007097")};$("#"+this.linkToLine).text(t.caption).click(function(t){e.linkToLineOnClick.call(e,t)}),t={decimals:0,format:"n0",min:1,step:1,change:function(t){e.linkToLineOnClick.call(e,t)}},$("#"+this.numberEdit).kendoNumericTextBox(t),$("#"+this.numberEdit).parent().keydown(function(t){var i=t.keyCode;13==i&&e.linkToLineOnClick.call(e,t)}),this.createButton(this.btnDefault,ResManager.LoadKDString("默认值","099002000000044"),"",function(t){e.btnDefaultOnClick.call(e,t)})},createButton:function(e,t,i,a){var n={id:e,icon:i,caption:t};n.click=a,$("#"+n.id).text(n.caption).kendoButton(n)},setShowHideFields:function(e){this.defaultData=e,this.originalDataRows=$.map(e,function(e){return $.extend(!0,{},e)}),this._setData(e),this.columnsGrid.select&&this.columnsGrid.select("tr:eq(0)")},setShowHideRows:function(e){this.originalDataRows=$.map(e,function(e){return $.extend(!0,{},e)}),this._setData(e),this.columnsGrid.select&&this.columnsGrid.select("tr:eq(0)")},setWidthColumnVisible:function(e){if(this.columnsGrid){var t=0==e?"hideColumn":"showColumn";this.columnsGrid[t]("ColWidth")}},setUpDownButtonVisible:function(e){if(this.el){var t=this.el.find('.showHideFilterAll .kd-filter-operate-container [role="UpDownBtn"]'),i={};e?i.visibility="visible":i.visibility="hidden",t.css(i)}},setSelectEntities:function(e){if(this.columnsGrid){var t=this.columnsGrid.dataSource.data(),i=this.getFieldsBySelectEnties(this.defaultData,e);if(this.originalDataRows=$.map(i,function(e){return $.extend(!0,{},e)}),t&&t.length>0){for(var a=this.defaultData.length,n=0;n<t.length;n++)for(var o=0;a>o;o++)if(!(KD.isEmpty(t[n])||KD.isEmpty(t[n].FieldName)||KD.isEmpty(this.defaultData[o])||KD.isEmpty(this.defaultData[o].FieldName))&&t[n].FieldName==this.defaultData[o].FieldName&&(this.defaultData[o].ColWidth=t[n].ColWidth,this.defaultData[o].Visible=t[n].Visible,t.length==i.length)){if(n==o)break;var r=this.defaultData[n],s=this.defaultData[o];this.defaultData[o]=r,this.defaultData[n]=s;break}var l=[];if(i&&i.length)for(var d=0;d<this.defaultData.length;d++)for(var c=0;c<i.length;c++)KD.isEmpty(i[c])||KD.isEmpty(i[c].FieldName)||KD.isEmpty(this.defaultData[d])||KD.isEmpty(this.defaultData[d].FieldName)||this.defaultData[d].FieldName==i[c].FieldName&&l.push(i[c])}l.map(function(e,t){return e.ColIndex=t+1}),this.defaultData.map(function(e,t){return e.ColIndex=t+1}),this._setData(l),this.columnsGrid.select&&this.columnsGrid.select("tr:eq(0)")}},getFieldsBySelectEnties:function(e,t){var i=[];return $.each(e,function(e,a){(","+t+",").toUpperCase().indexOf(","+a.EntityKey.toUpperCase()+",")>-1&&i.push(a)}),i},btnUpOnClick:function(e){var t=this.columnsGrid.select();if(!(t.length<=0)){var i=this.columnsGrid.dataItem(t);null!=i&&(this._moveRow(i,!0),this.commitValueToForm())}},btnDownOnClick:function(e){var t=this.columnsGrid.select();if(!(t.length<=0)){var i=this.columnsGrid.dataItem(t);null!=i&&(this._moveRow(i,!1),this.commitValueToForm())}},linkToLineOnClick:function(e){var t=this.columnsGrid.select(),i=this.currentRows.length;if(!(t.length<=0)){var a=$("#"+this.numberEdit).data("kendoNumericTextBox").value();if(a>i&&(a=i,$("#"+this.numberEdit).data("kendoNumericTextBox").value(a)),""!=a&&0!=a){var n=this.columnsGrid.dataItem(t);null!=n&&(this._moveRow(n,!1,a),this.commitValueToForm())}}},btnDefaultOnClick:function(e){var t=this.columnsGrid.select(),i=-1;t.length>0&&(i=this.columnsGrid.dataItem(t));var a=$.map(this.originalDataRows,function(e){var t=$.extend(!0,{},e);return void 0!=e.DefaultVisible&&(t.Visible=e.DefaultVisible),t});if(this._setData(a),-1!=i){var n=this.columnsGrid.tbody.find(">tr:not(.k-grouping-row)").eq(i.Number-1);this.columnsGrid.select(n)}},getGridAllDataItems:function(){return this.columnsGrid&&this.columnsGrid.dataSource&&this.columnsGrid.dataSource.data()},_moveRow:function(e,t,i){if(this.currentRows&&!(this.currentRows.length<=0)){if(void 0==i)if(t){if(1==e.Number)return;i=e.Number-1}else{if(e.Number==this.currentRows.length)return;i=e.Number+1}else if(0>=i||i>this.currentRows.length)return;for(var a=this.getGridAllDataItems()[i-1],n=0;n<this.currentRows.length;n++){var o=this.currentRows[n];o.Number==i?(o.Caption=e.Caption,o.Visible=e.Visible,o.FieldName=e.FieldName,o.ColWidth=e.ColWidth):o.Number==e.Number&&(o.Caption=a.Caption,o.Visible=a.Visible,o.FieldName=a.FieldName,o.ColWidth=a.ColWidth)}this._refData(i-1)}},_refData:function(e){this._setData(this.currentRows);var t=this.columnsGrid.tbody.find(">tr:not(.k-grouping-row)").eq(e);this.columnsGrid.select(t),$("input",t).focus()},_setData:function(e){for(var t=this,i=!0,a=0,n=0;n<e.length;n++)e[n].Number=n+1,e[n].Visible?a++:i=!1;$(".gridCheckHeader",$("#"+t.sid))[getPropName()]("checked",i),this.currentRows=e;var o=new kendo.data.DataSource({data:e,schema:{model:{fields:{FieldName:{editable:!1},Number:{editable:!1},Caption:{editable:!1},Visible:{editable:!1,type:"boolean"},ColWidth:{editable:!0,type:"number",validation:{decimals:0,format:"n0",min:0,step:1}},Locked:{editable:!1,type:"boolean"}}}}});this.columnsGrid&&this.columnsGrid.dataSource&&this.columnsGrid.dataSource.filter&&void 0!=this.columnsGrid.dataSource.filter()&&o.filter(this.columnsGrid.dataSource.filter()),this.columnsGrid.setDataSource(o),this.columnsGrid.content&&this._setTableTouchActionToAuto(this.columnsGrid.content),$("#"+this.currentSelectNum).text(ResManager.LoadKDString("当前选中","0025710030033501")+" "+a+" "+ResManager.LoadKDString("列","0025710030033502")).attr("value",a)},getLastSelectEntitiesActionArgs:function(e){for(var t=e.length-1;t>=0;t--){var i=e[t];if("selectEntities"==i.name&&i.args.selectEntities)return i.args.selectEntities}return null},getUpdateStateActionArgs:function(e){for(var t=0;t<e.length-1;t++){var i=e[t];"updateState"==i.name&&(i.args.setShowHideRows&&(this.showHideRows=i.args.setShowHideRows,this.key=i.args.key),i.args.setShowHideFields&&(this.showHideFields=i.args.setShowHideFields))}},validating:function(e){return this.commitValueToForm(),!0},commitValueToForm:function(e){var t={};if(this.isDontLazy()){var i=this.columnsGrid.dataSource.data();if(i&&i.length>0)for(var a=this.defaultData.length,n=0;n<i.length;n++)for(var o=0;a>o;o++)if(!(KD.isEmpty(i[n])||KD.isEmpty(i[n].FieldName)||KD.isEmpty(this.defaultData[o])||KD.isEmpty(this.defaultData[o].FieldName))&&i[n].FieldName==this.defaultData[o].FieldName){if(this.defaultData[o].ColWidth=i[n].ColWidth,this.defaultData[o].Visible=i[n].Visible,n==o)break;var r=this.defaultData[n],s=this.defaultData[o];this.defaultData[o]=r,this.defaultData[n]=s;break}t=this.getCommitData(i,this.postKey)}else{this.getUpdateStateActionArgs(this.lazyActions);var l=this.getLastSelectEntitiesActionArgs(this.lazyActions);if(this.showHideRows){var d=this.showHideRows;l&&this.showHideFields&&(d=this.getFieldsBySelectEnties(this.showHideFields,l)),t=this.getCommitData(d,this.key)}}this.getFormProxy().storeData(t.key,t.value,t.row,t.parentRow)},getCommitData:function(e,t){var i=[];if(e.sort(function(e,t){return e.Number>t.Number?1:-1}),this.isDontLazy())for(var a=0;a<e.length;a++){var n=e[a],o=n.Visible?1:0;i.push({F:n.FieldName,V:o,W:parseInt(n.ColWidth),L:!1,I:n.ColIndex})}else for(var a=0;a<e.length;a++){var n=e[a],o=n.Visible?1:0;i.push({F:n.FieldName,V:o,W:parseInt(n.ColWidth),L:!1,I:n.ColIndex})}return{key:t,value:JSON.stringify(i),row:this.getRow(),parentRow:this.getParentRow()}},_setTableTouchActionToAuto:function(e){!KD.isEmpty(e)&&KD.isMobileOS()&&e.find("table").css("touchAction","auto")},doLayout:function(){KDFilterShowHideProxy.superclass.doLayout.call(this);var e=this;KD.delayInvoke(function(){if(e.columnsGrid&&e.columnsGrid.wrapper){var t=e.el.find("#"+e.sid);e.columnsGrid.wrapper.width(450);for(var i=t.siblings(),a=11,n=0;n<i.length;n++)a=a+$(i[n]).outerWidth()+4;var o=e.el.width()-a;o=450>o?450:o,e.columnsGrid.wrapper.width(o)}},500)}}),KDControlFactoryProxy.registerType("kdshc",KDFilterShowHideProxy),define("KDFilterShowHideProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDFilterShowHideProxy}}(this)),KDClientSimpleFilterProxy=KD.extend(KDControlProxy,{filterTitle:"",loadConfig:function(e){KDClientSimpleFilterProxy.superclass.loadConfig.call(this,e),this.filterTitle=KD.getValue(e,"filtertitle","")},initComponent:function(){var e=$(kendo.format('<span class="k-textbox k-space-left" style="width: 90%;"><input type="text" placeholder="{0}"><a href="#" class="k-icon k-i-search">&nbsp;</a></span>',this.filterTitle));this.el.append(e);var t=this;$("input",e).keyup(function(e){t.OnFilterTextChanged(e)})},OnFilterTextChanged:function(e){var t=e.currentTarget.value.trim(),i=this.getControlFactoryProxy().getCmp(this.config.targetkey),a=i.getControl().children("div");a.filter(function(e){return $(e).find(".k-link").text()!=t});if(t&&t.length>0)for(var n in a){var o=a.eq(n);(0!=n||o.attr("id")!=this.el.attr("id"))&&(o.find(".kd-link").text().indexOf(t)<0?o.hide():o.show());
}else for(n=0;n<a.length;n++)$(a[n]).show()}}),KDControlFactoryProxy.registerType("kdclientsimplefilter",KDClientSimpleFilterProxy),define("KDClientSimpleFilterProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDClientSimpleFilterProxy}}(this)),function(e){e.fn.KDFilterQuicker=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDFilterQuicker.prototype,e.fn.KDControlBase.defaults,e.fn.KDFilterQuicker.defaults,t);this.fq=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.fq.filterschemelb=e("<span  class='kd-filterquicker-myplan'>"+ResManager.LoadKDString("我的方案","0025710030032336")+"</span>"),this.fq.filtertop=e("<div filter-role='filtertop' class='kd-filterquicker-filtertop'></div>"),this.fq.filtercontent=e("<div filter-role='filtercontent' class='kd-filtercontent-container'><span class=\"kd-filtercontent-container-title\">"+ResManager.LoadKDString("快捷过滤","0025710030032337")+"</span>NaN"),this.fq.defaultQuikerRow=e("<div filter-role='defaultQuikerRow' style='overflow:hidden;min-width:514px;padding-bottom:2px;'></div>"),this.fq.filterQuikerRows=e("<div filter-role='filterQuikerRows' class='kd-filtercontent-filterQuikerRows-container'></div>");var a=e(this);return this.each(function(){a=e(this);e.meta?e.extend(i,opts,a.data()):i})},e.fn.KDFilterQuicker.prototype={getContent:function(){return this.fq},_store_PropertyChanged:function(e,t){"DefaultItem"==t&&e.LoadDefaultQuikerRow()},loadConfig:function(t){t.Y=10,KD.setAttachmentData(this,t),KD.layout.setAbsolute(this,t),$this=this,$this.filterschemecontentWidth="1033"==KD.cookieLanguageId()?71:53;var i=$this.getContent();i._store=new FilterQuickerEntity;var a=$this._store_PropertyChanged;i._store.setpropertyChanged(a),i._store.init(),$this.btnSearchId=this.baseId+"_Search",i.filtertop.appendTo(i),i.filterschemelb.appendTo(i.filtertop),i.filterschemecontent=e("<div filter-role='filterschemecontent' style='margin-left:"+$this.filterschemecontentWidth+"px;height:auto;margin-right: 16px;'></div>"),i.filterschemecontent.appendTo(i.filtertop),i.filtercontent.appendTo(i);var n={id:this.baseId+"_dfr",name:this.baseId+"_dfr"},o={id:this.baseId+"_dfr",height:30,width:345};i.defaultQuikerRow=i.defaultQuikerRow.KDFilterQuickerRow(n),i.defaultQuikerRow.attr("id",this.baseId+"_dfr"),i.defaultQuikerRow.baseId=this.baseId+"_dfr",i.defaultQuikerRow.proxy=this.fq.proxy,i.defaultQuikerRow.loadConfig(o),i.defaultQuikerRow.getContent().appendTo(i.filtercontent),i.defaultQuikerRow.css({position:"relative",width:"auto"}),i.rowsvisible=!1,i.btnSearch=e("<a id='"+$this.baseId+"_search' ctrlrole='linkButton' class='ui-linkbutton KDButton BlueButtonStyle kd-filterquicker-btnSearch-container'> <div class=\"kd-btn-filterQuick-search\" style=\"background-image:url("+KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png")+')" title="'+ResManager.LoadKDString("搜索","099002000002787")+'"></div></a>'),i.btnSearch.appendTo(i.filtercontent),i.btnSearch.off("click").click(function(){i.filterQuikerRows.css("visibility","hidden"),i.proxy.barItemClick.call(i.proxy,"btnSearch")}),i.openbtn=e("<div id='"+this.baseId+"_openbtn' class='kd-btn-filterQuick-showMore'  style= 'background-image:url("+KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png")+");' title="+ResManager.LoadKDString("批量设置","00215181000006204")+" ></div>"),i.openbtn.appendTo(i.filtercontent),i.openbtn.click(function(){var e=i.proxy&&i.proxy.el;return e&&e.find(".filterquickerguidetips-nextstep").length>0?void e.find(".filterquickerguidetips-nextstep .tip-next").click():1==i.filterQuikerFormsShow?void(i.closebtn&&i.closebtn.click()):void i.showFilterQuickerForms(i,this)}),e(".kdQuickFilterContainer_editorct",i).off("keydown").on("keydown",function(t){var a=t.keyCode||t.which||t.charCode;13==a&&(KD.isIeBrowser()&&i._store&&i._store._items&&i._store._items[0]&&i._store._items[0]&&(i._store._items[0].ValueObject=e(t.target).val()),KD.delayInvoke(function(){i.proxy.barItemClick.call(i.proxy,"btnSearch")}))}),i.btnSaveScheme=e(kendo.format("<div id='{0}_SaveScheme' class='kd-filterquicker-SaveBtn' title='{1}'>{1}</div>",$this.baseId,ResManager.LoadKDString("保存","099002000002788"))),i.btnSaveScheme.appendTo(i.filtercontent),i.btnSaveScheme.click(function(){i.proxy.barItemClick.call(i.proxy,"SaveScheme")}),i.btnClearScheme=e(kendo.format("<div id='{0}_ClearScheme' class='kd-filterquicker-ClearBtn' title='{1}'>{1}</div>",$this.baseId,ResManager.LoadKDString("重置","099002000002789"))),i.btnClearScheme.appendTo(i.filtercontent),i.btnClearScheme.click(function(){i.proxy.barItemClick.call(i.proxy,"ClearScheme")}),i.btnShowMoreScheme=e(kendo.format("<div id='{0}_ShowMoreScheme' class='kd-filterquicker-ShowMoreBtn kd-filterquicker-ShowMoreBtn-collapse' style='background-image:url({1})' title='{2}'></div>",$this.baseId,KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),ResManager.LoadKDString("展开","00215181000006356"))),i.btnShowMoreScheme.appendTo(i.filtercontent),i.btnShowMoreScheme.click(function(){var t,a=e(this),n=a.hasClass("kd-filterquicker-ShowMoreBtn-collapse");KD.isEmpty(i.proxy)||(n?(a.removeClass("kd-filterquicker-ShowMoreBtn-collapse").addClass("kd-filterquicker-ShowMoreBtn-expand").attr("title",ResManager.LoadKDString("收缩","00215181000006357")),i.proxy.isLineSpread=t=!0):(a.addClass("kd-filterquicker-ShowMoreBtn-collapse").removeClass("kd-filterquicker-ShowMoreBtn-expand").attr("title",ResManager.LoadKDString("展开","00215181000006356")),i.proxy.isLineSpread=t=!1),i.showFilterQuikerItemScheme(t))});var r={id:this.baseId+"Rs",name:this.baseId+"Rs"},s={id:this.baseId+"Rs",width:560};i.filterQuikerRows=i.filterQuikerRows.KDFilterQuickerRows(r),i.filterQuikerRows.attr("id",this.baseId+"_drs"),i.filterQuikerRows.baseId=this.baseId+"_drs",i.closebtn=e("<img id='"+this.baseId+"_closebtn' class='kd-filterquicker-condition-closebtn' onmouseover=\"this.src='content/themes/images/btn_filterUp_press.png'\" onmouseout= \"this.src='content/themes/images/btn_filterUp_normal.png'\" style='background: white;margin-left:520px;margin-top:5px;cursor:pointer;text-align:right;position: absolute;z-index:101;display:none;' width='20px' height='21px' alt='收缩快捷过滤条件' src='content/themes/images/btn_filterUp_normal.png'></img>"),i.closebtn.appendTo(i.filterQuikerRows),i.closebtn.click(function(){i.defaultQuikerRow.SetDataContext(i._store,0,i.defaultQuikerRow.DataContext),i.filterQuikerRows.css("visibility","hidden"),i.rowsvisible=!1,i.filterQuikerFormsShow=!1}),i.filterQuikerRows.loadConfig(s),i.filterQuikerRows.proxy=this.fq.proxy,i.filterQuikerRows.getContent().appendTo(i.filtercontent),i.filterQuikerRows.css("visibility","hidden")},LoadDefaultQuikerRow:function(){return null==this.defaultQuikerRow?void(this.needLoadInTemplate=!0):(this.BindingDefaultQuikerRow(),void(this.proxy&&this.proxy.showFilterQuickerTipGuide.call(this.proxy)))},showFilterQuickerForms:function(t,i){if(!KD.isEmpty(i)&&!KD.isEmpty(t)){var a=t.filterQuikerRows;if(a){a.SetItemsSource&&a.SetItemsSource(t._store,!0),a.UpdateFirstRow&&t._store&&t._store._items&&a.UpdateFirstRow(t._store,t._store._items[0]);var n=e(i).position();if(t.proxy&&t.proxy.el){var o=t.proxy.el.width()-t.defaultQuikerRow.outerWidth()-52,r=t.proxy.getParentProxy(),s=n.top+e(i).width(),l={visibility:"visible","margin-top":s};if(r&&r.el){var d=r.el.height()-s-20;l["max-height"]=d>0&&380>d?d:"380px"}o>a.width()?l.left=n.left:(l.right="0px",l.left=""),a.css(l)}t.rowsvisible=!0,t.filterQuikerFormsShow=!0}}},BindingDefaultQuikerRow:function(){try{var t=this.getContent();if(this.isBindingDefaultQuikerRow)return;if(this.isBindingDefaultQuikerRow=!0,t&&t.defaultQuikerRow&&t._store&&t._store._items&&t._store._items.length>0){t.defaultQuikerRow.find(".kddefaultRowItem").remove(),t.defaultQuikerRow.rowproxys=[];for(var i=0;i<t._store._items.length;i++){var a;if(i>0){var n=kendo.guid()+"_dfr",o={id:this.baseId+"_dfr",name:this.baseId+"_dfr"},r={id:this.baseId+"_dfr",height:30,width:"auto",isNoneAbsPosition:!0,ctOrientation:!0};if(rowControl=e("<div class='kddefaultRowItem' id="+n+" style='position:relative;display:inline-block;'></div>").KDFilterQuickerRow(o),rowControl){rowControl.baseId=n,rowControl.proxy=this.fq.proxy,rowControl.loadConfig(r);var s=rowControl.getContent();s&&s.appendTo(t.defaultQuikerRow),rowControl.SetDataContext&&rowControl.SetDataContext(t._store,i,t._store._items[i],void 0,!1),a=rowControl}}else t.defaultQuikerRow.SetDataContext(t._store,i,t._store._items[i]),a=t.defaultQuikerRow;t.defaultQuikerRow.rowproxys.splice(i,0,a)}t.proxy&&t.proxy.doLayout.call(t.proxy),1==t.filterQuikerFormsShow&&t.showFilterQuickerForms(t,t.btnSearch),t.proxy.isLineSpread&&t.btnShowMoreScheme&&t.btnShowMoreScheme.is(":visible")?(t.btnShowMoreScheme.removeClass("kd-filterquicker-ShowMoreBtn-collapse").addClass("kd-filterquicker-ShowMoreBtn-expand"),t.showFilterQuikerItemScheme(!0)):(t.btnShowMoreScheme.removeClass("kd-filterquicker-ShowMoreBtn-expand").addClass("kd-filterquicker-ShowMoreBtn-collapse"),t.showFilterQuikerItemScheme(!1))}}catch(l){KD.Error.raise({sourceClass:"KDFilterQuicker",sourceMethod:"BindingDefaultQuikerRow",msg:l.stack})}finally{this.isBindingDefaultQuikerRow=!1}},hiddenFilterQuicker:function(){var e=this.getContent(),t={visibility:"hidden",margin:"auto",width:"0px",padding:"0px",height:"0px",display:"none"};e.parent&&e.parent().css(t)},showFilterQuicker:function(){var e=this.getContent(),t={visibility:"viisble",width:"100%",display:"block"};e.parent&&e.parent().css(t)},showFilterQuikerItemScheme:function(e){var t=this.getContent(),i=t.defaultQuikerRow;if(!KD.isEmpty(i)&&t.proxy&&t.proxy.config){if(e?i.css("height","auto"):i.css("height",t.proxy.defaultQuikerRowHeight+"px"),0!=t.proxy.visible){var a=i.height();a>t.proxy.defaultQuikerRowHeight?t.proxy.config.height=a+t.proxy.config.originHeight-t.proxy.defaultQuikerRowHeight:t.proxy.config.height=t.proxy.config.originHeight}var n=t.proxy.getParentProxy();n&&n.doLayout.call(n)}},SetFieldsStore:function(e){this._isInit=!0;var t=new Array,i={FieldName:"",CompareGroupID:"",Editor:{},Caption:"",EntityKey:"-999",CompareTypes:{}};t.push(i);for(var a in e){var n=e[a];n.AllowAutoList=this.getAllowAutoList(),t.push(n)}var o=this.getContent();o._store.SetFieldsStore(t),o._store.AddNewRow(void 0,0),this._isInit=!1},SetComparersStore:function(e){this._isInit=!0;var t=KD.cloneObject(e),i=this.getContent();i._store.SetComparersStore(t),this._isInit=!1},doLayout:function(){var e=this;e.schemeItems&&this.SetSchemeItems(e.schemeItems)},setDisplayLine:function(e){this._Schemedisplayline=e||1},setSameXTypeRowTakeValue:function(e){for(var t=this.getContent(),i=t._store.getItems(),a=0;a<i.length;a++)i[a].SameXTypeRowTakeValue=e},SetSchemeItems:function(t){var i=this;i.schemeItems=t,i.moreSchemeItems=[];var a=this.getContent();this._isInit=!0,a._store.SetSchemeItems(i,t),a.filterschemecontent.empty(),a.schemeproxys=[];var n=a.baseId;for(var o in t){var r=t[o],s={};s.data=r,s.control=e("<div schemeRootId='"+n+"' ctrol='"+r.Id+"' style='position:relative;' class='"+(1==r.Selected?"SelectedSchemeItemControlTemplate'>":"SchemeItemControlTemplate'>")+KD.htmlUtil.encode(r.Name)+"<div class='kd-icon-quickFilter-selecter'></div></div>"),s.control.appendTo(a.filterschemecontent);var l=a.filtertop.height()/s.control.outerHeight();l=parseInt(l),l>this._Schemedisplayline?(this._initMoreSchemeBtn(a.filterschemecontent),i.moreSchemeItems.push(r),s.control.remove()):s.control.click(function(e){i._schemeItemClick(e)})}this._isInit=!1},_schemeItemClick:function(t){var i=this,a=this.getContent(),n=a.baseId;a.filterQuikerRows.css("visibility","hidden");var o=e(t.target).attr("ctrol");for(var r in a._store._SchemeItems){var s=a._store._SchemeItems[r];if(s.Id==o){if(1==s.Selected)return;a.onFitlerSchemeChanged&&(e("div[schemeRootId='"+n+"']",a).removeClass("SelectedSchemeItemControlTemplate").addClass("SchemeItemControlTemplate"),e("div[ctrol='"+o+"']",a).length<=0&&i.popupMoreSchemeDiv?(e("div[schemeRootId='"+n+"']",i.popupMoreSchemeDiv).removeClass("SelectedSchemeItemControlTemplate").addClass("SchemeItemControlTemplate"),e("div[ctrol='"+o+"']",i.popupMoreSchemeDiv).addClass("SelectedSchemeItemControlTemplate").removeClass("SchemeItemControlTemplate")):e("div[ctrol='"+o+"']",a).addClass("SelectedSchemeItemControlTemplate").removeClass("SchemeItemControlTemplate"),i._setSelectSchemeItem(s),a.onFitlerSchemeChanged(s));break}}},_initMoreSchemeBtn:function(){var t=this;if(this.popupMoreSchemeDiv&&this.popupMoreSchemeDiv.data&&this.popupMoreSchemeDiv.data("kendoPopup").close(),!(t.moreSchemeItems&&t.moreSchemeItems.length>0)){var i=this.getContent(),a=e("<div style='position:absolute;right:0px;cursor: pointer;margin-top: 0.8em;'><span title='"+ResManager.LoadKDString("显示更多方案","0025710030033064")+"' class='k-icon k-i-arrow-s'></span></div>");i.filterschemecontent.append(a),this.moreBtn=a,a.click(function(e){t._initPopupMoreSchemeBtn()})}},_initPopupMoreSchemeBtn:function(){var t=this,i={origin:"bottom right",position:"top right",anchor:this.moreBtn,collision:"fit",open:function(e){var t=a.proxy;if(t){var i=t.getParentProxy().el.height()-t.el.height();e.sender&&e.sender.element.css({"max-height":i})}}},a=this.getContent(),n=a.baseId,o=void 0;if(this.popupMoreSchemeDiv){var r=this.popupMoreSchemeDiv.data("kendoPopup");r&&r.destroy&&r.destroy(),this.popupMoreSchemeDiv.empty(),o=this.popupMoreSchemeDiv}else o=e("<div filter-role='moreSchemeItem' class='kd-filterquicker-moreschemeitem-contain'></div>"),e("document.body").append(o);for(var s=0;s<this.moreSchemeItems.length;s++){var l=this.moreSchemeItems[s],d={};d.data=l,d.control=e("<div schemeRootId='"+n+"' style='float:none;margin-top: 0.8em;display: block;' ctrol='"+l.Id+"' class='"+(1==l.Selected?"SelectedSchemeItemControlTemplate'>":"SchemeItemControlTemplate'>")+KD.htmlUtil.encode(l.Name)+"<div class='kd-icon-quickFilter-selecter' style='top: inherit;margin-top: -2em;right: 0px;'></div></div>"),d.control.appendTo(o),d.control.click(function(e){t._schemeItemClick(e)})}o.kendoPopup(i).data("kendoPopup").open(),this.popupMoreSchemeDiv=o},_setSelectSchemeItem:function(e){var t=this.getContent();for(var i in t._store._SchemeItems){var a=t._store._SchemeItems[i];a.Selected=!1,e.Id==a.Id&&(a.Selected=!0)}},SetData:function(e){var t=this.getContent(),i=-1,a=t._store.getItems();if(a.length>0)for(var n=0;n<a.length;n++)if(a[n].IsAddByUser){i=n;break}t._store.clearItems();for(var n=0;t.filterQuikerRows.rowproxys&&n<t.filterQuikerRows.rowproxys.length;n++){var o=t.filterQuikerRows.rowproxys[n],r=t.filterQuikerRows.rowproxys[n].row;o&&o.release&&o.release(),r&&r.release&&(r.release(),r.remove())}if(t.filterQuikerRows.rowproxys=[],t._store.LoadData(this,e),i>0)for(var s=t._store.getItems(),n=i;n<s.length;n++)s[n].IsAddByUser=!0;1==t.rowsvisible&&t.filterQuikerRows.UpdateRow(t._store,0,t._store._items[0])},setAllowAutoList:function(e){var t=this.getContent();t._store.setAllowAutoList(e)},getAllowAutoList:function(){var e=this.getContent();return e._store.getAllowAutoList()},SetValeObject:function(e,t){var i=this.getContent();i._store.SetItemValue(e,t),this.updateRowUI(e)},updateRowUI:function(e){var t=this.getContent();if(!(0>e||null==t._store||!t._store._items||t._store._items.length<=e)){var t=this.getContent();t.defaultQuikerRow&&t.defaultQuikerRow.rowproxys.length>0&&t.defaultQuikerRow.rowproxys[e]&&t.defaultQuikerRow.rowproxys[e].SetDataContext(t._store,e,t._store._items[e],void 0,!1),t.filterQuikerRows.UpdateRow(t._store,e,t._store._items[e])}},SetServiceConfig:function(e){var t=this.getContent();t._store.ServiceConfig=e},release:function(){var e=this.getContent();e.defaultQuikerRow&&e.defaultQuikerRow.release&&e.defaultQuikerRow.release(),e.filterQuikerRows&&e.filterQuikerRows.release&&e.filterQuikerRows.release(),this.popupMoreSchemeDiv&&this.popupMoreSchemeDiv.data&&(this.popupMoreSchemeDiv.data("kendoPopup").destroy(),this.popupMoreSchemeDiv&&this.popupMoreSchemeDiv.remove())},GetSetting:function(){var e=this.getContent();return e._store.GetSetting()}},e.fn.KDFilterQuicker.defaults={metaHtml:"",defaults:{}}}(jQuery),define("KDFilterQuicker",["KD"],function(e){return function(){var t;return t||e.KDFilterQuicker}}(this)),KDFilterQuickerProxy=KD.extend(KDEditorProxy,{visibleSave:!0,visibleClearScheme:!0,defaultQuikerRowHeight:30,lastVisible:void 0,createControl:function(e){return KDItemContainerProxy.superclass.createControl.call(this,e),this.el=this.el.KDFilterQuicker({}),this.el.attr("id",this.baseId).addClass("kd-filter-quick"),this.el.baseId=this.baseId,this.el},loadConfig:function(e){var t=this;e.width="100%";var i=t.getFormProxy();(i.dformConfig||i.config).isUseSmallScreenModel&&(e.height=75,this.el.addClass("kd-filter-quick-smallmodel")),t.config.height&&(t.config.originHeight=t.config.height),KDFilterQuickerProxy.superclass.loadConfig.call(this,e),this.setRequestLock(!0),this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(this.config)),this.el.onFitlerSchemeChanged=function(e){var i=t.getFormProxy();i.lockControl.call(i,t);var a=i&&i.getLayoutSetting&&i.getLayoutSetting(),n={};n.setting=a,i.fireEvent.call(i,"FilterSchemeChangedExt","FQKFILTERPANEL",e.Id,n)},this.el.fq.filterQuikerRows.css("z-index",(this.el.closest('div[role="dialog"]').css("z-index")||0)+100),this.setSchemeDisplayLine(1),this.setVisibleSave(KD.getValue(e,"VisibleSave",void 0))},initComponent:function(){KDFilterQuickerProxy.superclass.initComponent.call(this),this.doLazyAction()},setVisible:function(e){KDFilterQuickerProxy.superclass.setVisible.call(this,e),this.lastVisible!=e&&(this.lastVisible=e,0==e?(this.config.realHeight=this.config.height,this.config.height=0,this.el&&this.el.hiddenFilterQuicker()):(this.config.height<=0&&(this.config.height=this.config.realHeight),this.el.showFilterQuicker()),this.doParentLayout())},setAllowAutoList:function(e){this.el&&this.el.setAllowAutoList&&this.el.setAllowAutoList(e)},getAllowAutoList:function(){return this.el.getAllowAutoList()},setCompareTypes:function(e){this._innerCompareTypeGroup=e,this.el.SetComparersStore(this._innerCompareTypeGroup)},setCompareValue:function(e){var t=KD.getValue(e,"row",0),i=KD.getValue(e,"value","");this.el.SetValeObject(t,i)},setFilterFields:function(e){try{if(this._innerFilterFields=e,void 0==this._innerCompareTypeGroup)return;for(var t in this._innerFilterFields){var i=this._innerFilterFields[t];i.CompareTypes=KD.filter.getCompareTypesByGroupIds(this._innerCompareTypeGroup,i.CompareGroupID);var a=KD.getValue(i.Editor,"lookup","");a&&(a.proxykey=this.baseId,a.key=i.FieldName,a.AllowAutoList=this.getAllowAutoList())}this.el.SetServiceConfig(this.ServiceConfig),this.el.SetFieldsStore(this._innerFilterFields)}catch(n){KD.writeError(n)}},doLayout:function(){var e=this;this.el.doLayout();var t=this.el&&this.el.defaultQuikerRow;if(!KD.isEmpty(t)){if(t.children("div").length>1){var i=t.children("div").length,a=t.children("div").outerWidth(),n=a*i,o=this.el.width()-200-n,r=parseInt((this.el.width()-200)/a)*a,s=this.el.find(".kd-filterquicker-ShowMoreBtn");0>o?(t.css("max-width",r),s.css("display","inline-block")):(t.css("max-width","none"),s.css("display","none"))}else this.el.find(".kd-filterquicker-ShowMoreBtn").css("display","none");var l=t.height();if(l!=t.lastdolayoutHeight&&t.proxy){0!=this.visible&&(l>t.proxy.defaultQuikerRowHeight?t.proxy.config.height=l+t.proxy.config.originHeight-t.proxy.defaultQuikerRowHeight:t.proxy.config.height=t.proxy.config.originHeight);var d=t.proxy.getParentProxy();t.lastdolayoutHeight=t.height(),d&&d.doLayout.call(d)}e.el.find(".filterquickerguidetips-container").length>0&&e.setFilterQuickerGuideTipsPosition(e.filerQuickerGuideTipsStep)}},setSchemeList:function(e){this._innerSchemeList=e,this.el.SetSchemeItems(this._innerSchemeList)},setFilterRows:function(e){this.el.SetData(e)},showFilterQuickerTipGuide:function(){var e=this,t=e.getFormProxy();if(t.dformConfig&&t.dformConfig.showType&&t.dformConfig.showType==KDDynamicFormShowType.NewTabPage&&!ClientAppProxy.Current.FilterQuickerGuideTips&&!ClientAppProxy.Current.OperateFilterQuickerGuideTips){var i=function(e){e=e||{};var t=" ";e.anchor==KD.dock.Top&&(t=" kd-anchor-top");var i=$(kendo.format('<div class="filterquickerguidetips-container {5} {6}" style="z-index:{0};"><div class="kd-filterquickerguidetips-innercontainer"><div class="tip-logo" style="background-image:url({1});"></div><div class="tip-content">{2}</div><div class="tip-steps-container"><span class="tip-steps">{3}</span><span class="tip-next">{4}</span></div><div class="tip-line"></div></div></div>',e.zIndex,e.logoUrl,e.content,e.steps,e.btnText,e.roleClass,t));return i},a=function(){var t=$('<div class="kd-filterquickerguidetips-container"></div>'),a=$('<div class="kd-fullscreen-shawdow"></div>');t.append(a);var o=$('<div class="kd-fullscreen-transparentShawdow"></div>');t.append(o);var r=KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),s=o.css("z-index");s=parseInt(s)+1;var l={};l.zIndex=s,l.logoUrl=r,l.content=ResManager.LoadKDString("新版快捷过滤对于多个过滤字段采用平铺展示，提升了过滤效率和使用体验，让快捷过滤更轻松","00215181000006325"),l.btnText=ResManager.LoadKDString("开始学习","00215181000007091"),l.roleClass="filterquickerguidetips-anchorpointer",l.anchor=KD.dock.Top;var d=i(l);t.append(d),t.find(".filterquickerguidetips-anchorpointer .tip-next").on("click",function(){e.el.find(".kd-filterquickerguidetips-container").remove();var t=e.el.find(".kd-btn-filterQuick-showMore");t.click(),e.el&&e.el.defaultQuikerRow&&e.el.defaultQuikerRow.removeClass("kd-guidepromptintro-zindex"),n()});var c=e.el&&e.el.defaultQuikerRow;e.el.append(t),c.addClass("kd-guidepromptintro-zindex"),e.filerQuickerGuideTipsStep=1,e.setFilterQuickerGuideTipsPosition(e.filerQuickerGuideTipsStep);var h=ClientAppProxy.Current.mainConsoleForm;h&&h.fireCustomEvents.call(h,"showFilterQuickerTipGuide","showFilterQuickerTipGuide","1"),ClientAppProxy.Current.OperateFilterQuickerGuideTips=!0},n=function(){var t=$('<div class="kd-filterquickerguidetips-container"></div>'),a=$('<div class="kd-fullscreen-shawdow"></div>');t.append(a);var n=$('<div class="kd-fullscreen-transparentShawdow"></div>');t.append(n);var r=$("<div class='kd-handmasker kd-handmasker-down'></div>");t.append(r);var s=KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),l=n.css("z-index");l=parseInt(l)+1;var d={};d.zIndex=l,d.logoUrl=s,d.content=ResManager.LoadKDString("点击设置，可以对过滤字段和条件进行增删改","00215181000003880"),d.steps="1/2",d.btnText=ResManager.LoadKDString("下一步","002014030021536"),d.roleClass="filterquickerguidetips-nextstep";var c=i(d);t.append(c),t.find(".filterquickerguidetips-nextstep .tip-next").on("click",function(){e.el.find(".kd-filterquickerguidetips-container").remove(),e.el.find(".kd-filtercontent-filterQuikerRows-container").removeClass("kd-guidepromptintro-filterQuikerRows-container");var t=e.el.find(".kd-btn-filterQuick-showMore");t.removeClass("kd-guidepromptintro-nextstepzindex"),t.click(),o()});var h=e.el.find(".kd-filtercontent-filterQuikerRows-container");e.el.append(t),h.addClass("kd-guidepromptintro-filterQuikerRows-container"),e.el.find(".kd-btn-filterQuick-showMore").addClass("kd-guidepromptintro-nextstepzindex"),e.filerQuickerGuideTipsStep=2,e.setFilterQuickerGuideTipsPosition(e.filerQuickerGuideTipsStep)},o=function(){var t=$('<div class="kd-filterquickerguidetips-container"></div>'),a=$('<div class="kd-fullscreen-shawdow"></div>');t.append(a);var n=$('<div class="kd-fullscreen-transparentShawdow"></div>');t.append(n);var o=KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),r=n.css("z-index");r=parseInt(r)+1;var s={};s.zIndex=r,s.logoUrl=o,s.content=ResManager.LoadKDString("当条件超过一行时，可点击右上角【展开按钮】查看全部条件；展开后再点击【收起按钮】，条件内容可收起。同时支持记忆用户关闭前的展开状态。","00215181000006330"),s.btnText=ResManager.LoadKDString("完成指引","00215181030033934"),s.roleClass="filterquickerguidetips-endstep",s.anchor=KD.dock.Top;var l=i(s);t.append(l),t.find(".filterquickerguidetips-endstep .tip-next").on("click",function(){e.el.find(".kd-filterquickerguidetips-container").remove();var t=e.el.find(".kd-filterquicker-ShowMoreBtn");t.removeClass("kd-guidepromptintro-zindex"),0==e.showMoreBtnLastStatus&&t.hide(),e.filerQuickerGuideTipsStep=void 0});var d=e.el.find(".kd-filterquicker-ShowMoreBtn");e.el.append(t),d.is(":visible")?e.showMoreBtnLastStatus=!0:(e.showMoreBtnLastStatus=!1,d.css("display","inline-block")),d.addClass("kd-guidepromptintro-zindex"),e.filerQuickerGuideTipsStep=3,e.setFilterQuickerGuideTipsPosition(e.filerQuickerGuideTipsStep)};a()}},setFilterQuickerGuideTipsPosition:function(e){var t=this;if(!KD.isEmpty(e)){var i,a,n=t.el.find(".filterquickerguidetips-container"),o=n.outerWidth(!0);if(1==e){if(i=t.el&&t.el.defaultQuikerRow){a=i.position();var r=i.outerHeight(!0),s=r-30+104+"px";n.css({left:a.left-o/2+i.outerWidth(!0)/2,top:s})}}else if(2==e){i=t.el.find(".kd-filtercontent-filterQuikerRows-container"),a=i.position(),n.css({left:a.left-o-14,top:"90px"});var l=t.el.find(".kd-btn-filterQuick-showMore"),d=l.position(),c=t.el.find(".kd-filterquickerguidetips-container .kd-handmasker");c.css({left:d.left,top:d.top-c.height()})}else if(3==e&&(i=t.el.find(".kd-filterquicker-ShowMoreBtn"),i.css("display","inline-block"),a=i.position(),n.css({left:a.left-o/2,top:t.el.height()}),t.el&&t.el.filtercontent)){var h=t.getChildrenTotalSize(t.el.filtercontent),u=t.el.width()-h.width;o/2>u&&(n.css({left:"unset",right:"0px"}),n.find(".tip-line").css({left:"unset",right:u}))}}},getChildrenTotalSize:function(e){if(e){for(var t=0,i=0,a=0;a<e.children().length;a++){var n=$(e.children()[a]);n.is(":visible")&&!n.hasClass("kd-filtercontent-filterQuikerRows-container")&&(t+=n.outerWidth(!0),i+=n.outerHeight(!0))}return{width:t,height:i}}},setSameXTypeRowTakeValue:function(e){this.el.setSameXTypeRowTakeValue(e)},focus:function(e){this.el&&this.el.defaultQuikerRow&&this.el.defaultQuikerRow.PART_Value_td&&this.el.defaultQuikerRow.PART_Value_td.find("input").focus()},Validating:function(e){void 0==e&&(e=!0);var t=JSON.stringify(this.el.GetSetting()),i=this.getFormProxy();return i.storeData.call(i,this.getKey(),t,0,0),!0},barItemClick:function(e,t){this.Validating(!1);var i=this.getFormProxy();i.lockControl.call(i,this),void 0===t?i.fireEvent.call(i,"ToolBarItemClick",this.getKey(),e):i.fireEvent.call(i,"ToolBarItemClick",this.getKey(),e,t)},setSchemeDisplayLine:function(e){this._Schemedisplayline=1,this.el.setDisplayLine(this._Schemedisplayline),this.el.SetSchemeItems(this._innerSchemeList)},setVisibleClearScheme:function(e){void 0!=e&&this.el&&this.el.btnClearScheme&&(this.visibleClearScheme=e,e?this.el.btnClearScheme.show():this.el.btnClearScheme.hide())},setVisibleSave:function(e){void 0!=e&&this.el&&this.el.btnClearScheme&&this.el.btnSaveScheme&&(this.visibleSave=e,e?(this.el.btnSaveScheme.show(),this.el.btnClearScheme.css({"margin-left":"7.1em;"})):(this.el.btnSaveScheme.hide(),this.el.btnClearScheme.css({"margin-left":"4.187em"})))},getLayoutSetting:function(){var e={};return e.isLineSpread=this.isLineSpread,e},loadLayoutSetting:function(e){KD.isEmpty(e)||(this.isLineSpread=KD.getValue(e,"isLineSpread",!1))}}),KDControlFactoryProxy.registerType("kdquickerfilter",KDFilterQuickerProxy),define("KDFilterQuickerProxy",["KDEditorProxy","KD","KDFilterQuicker"],function(e){return function(){var t;return t||e.KDFilterQuickerProxy}}(this)),KDFilterStatusProxy=KD.extend(KDContainerProxy,{loadConfig:function(e){KDFilterStatusProxy.superclass.loadConfig.call(this,e),this.el.css({"min-height":"30px",height:"100px",position:"relative"})},setDisabled:function(e){},setStatusFields:function(e){this.isChilderLoaded=!1,this.children=this.children||[];var t=e;if($.isArray(t)){this.oldData=this.data,this.data={items:t},this.children||$.each(this.children,function(e,t){t.release()}),this.el.empty(),this.clearControls(this.oldData),this.clearControls(this.data);var i=23*(t.length/2+1);if(this.config.height=i,this.parentProxy){var a=this.parentProxy.config;for(var n in a.items){var o=a.items[n];if(o.id==this.config.id){o.height=i;break}}this.parentProxy.reLayout&&this.parentProxy.reLayout.call(this.parentProxy)}this.el.css({height:i,position:"relative","padding-top":"5px"});var r=this.getControlFactoryProxy();for(var n in t){o=t[n],o.isNoneAbsPosition=!0;var s=r.createControl(o),l=s.getControl();l.appendTo(this.el),l.css({"padding-top":"3px"}),s.loadConfig(o),this.children.push(s)}this.initchildren(),this.isChilderLoaded=!0}},SetStatusValues:function(e){this.setStatusValues(e)},setStatusValues:function(e){if($.isArray(e)){var t=this.getControlFactoryProxy();for(var i in e){var a=e[i],n=a.Key,o=a.Value;if(n&&o){var r=t.getCmp(n);r&&r.setValue(o)}}}},getSetting:function(){var e=[];for(var t in this.children){var i=this.children[t],a=i.getKey(),n=i.getValue();if(n){var o={Key:a,Value:n};e.push(o)}}return JSON.stringify(e)},validating:function(){var e=this.getSetting(),t=this.getFormProxy();return t.storeData.call(t,this.getKey(),e,0,0),!0}}),KDControlFactoryProxy.registerType("statusfilterpanel",KDFilterStatusProxy),define("KDFilterStatusProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDFilterStatusProxy}}(this)),KDFilterSummaryProxy=KD.extend(KDEditorProxy,{tagGrid:null,lastUpdateStateActionArgs:{},MaxLevelScope:5,initComponent:function(){KDFilterSummaryProxy.superclass.initComponent.call(this),this.createLayoutDom(),this.creatSourceFieldList(),this.createMiddlePanel(),this.creatTagetFieldList(),this.doLazyAction()},loadConfig:function(e){KDFilterSummaryProxy.superclass.loadConfig.call(this,e),this.MaxLevelScope=KD.getValue(e,"MaxLevelScope",this.MaxLevelScope)},createLayoutDom:function(){this.sid=this.baseId+"S",this.mid=this.baseId+"M",this.tid=this.baseId+"T",this.btnAdd=this.baseId+"A",this.btnRemove=this.baseId+"R",this.btnRemoveAll=this.baseId+"RA",this.btnUp=this.baseId+"U",this.btnDown=this.baseId+"D";var e="1033"==ResManager.Language?"6.5em":"5.2em";this.el.append($("<table width=100% height='"+KD.layout.getActualHeight(this.el)+"px' cellspace='0' border='0px'><tbody><tr><td id='"+this.sid+"' width='200px' valign='top' style='padding:0px;margin:0px;' ></td><td valign='top' align='center'><table  style='min-width:"+e+";' height=100%><tbody><tr height=50px></tr><tr height=34px><td><button id='"+this.btnAdd+"' type='button'>Add</button></td></tr><tr height=34px><td><button id='"+this.btnRemove+"' type='button'>remove</button></td></tr><tr height=34px><td><button id='"+this.btnRemoveAll+"' type='button'>remove all</button></td></tr><tr height=15px><td></td></tr><tr height=34px><td><button id='"+this.btnUp+"' type='button'>Up</button></td></tr><tr height=34px><td><button id='"+this.btnDown+"' type='button'>Down</button></td></tr><tr></tr></tbody></table></td><td id='"+this.tid+"'  valign='top' style='padding:0px;margin:0px;'></td></tr></tbody></table>"))},creatSourceFieldList:function(){var e={id:this.baseId+"SourceFieldList",height:KD.layout.getActualHeight(this.el)-50,width:"190px",selectable:!0,editable:!1,dataSource:{data:[]},columns:[{field:"Caption",template:'<span class="kd-grid-cellspan" title="#: Caption #">#: Caption #</span>',headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("字段","099002000000030"))},{field:"FieldName",template:'<span class="kd-grid-cellspan" title="#: FieldName #">#: FieldName #</span>',title:"FieldName",hidden:!0},{field:"SupportGroup",template:'<span class="kd-grid-cellspan">#: SupportGroup #</span>',title:"SupportGroup",hidden:!0}]},t=$('<div id="'+e.id+'"></div>');$("#"+this.sid);$("#"+this.sid).append(t),t.kendoGrid(e),this.sourceGrid=t.data("kendoGrid")},createMiddlePanel:function(){var e=this;this.createButton(this.btnAdd,ResManager.LoadKDString("加入","099002000000045"),"plus",function(t){e.btnAddOnClick.call(e,t)}),this.createButton(this.btnRemove,ResManager.LoadKDString("删除","099002000000046"),"pencil",function(t){e.btnRemoveOnClick.call(e,t)}),this.createButton(this.btnRemoveAll,ResManager.LoadKDString("全删","099002000000047"),"close",function(t){
e.btnRemoveAllOnClick.call(e,t)}),this.createButton(this.btnUp,ResManager.LoadKDString("上移","099002000000048"),"arrow-n",function(t){e.btnUpOnClick.call(e,t)}),this.createButton(this.btnDown,ResManager.LoadKDString("下移","099002000000042"),"arrow-s",function(t){e.btnDownOnClick.call(e,t)})},createButton:function(e,t,i,a){var n={id:e,icon:i,caption:t};n.click=a,$("#"+n.id).text(n.caption).kendoButton(n)},creatTagetFieldList:function(){var e=this,t="#if (SupportGroup!='1') {# background-color:\\#FFEE62 #}#",i={id:this.baseId+"TagetFieldList",width:"280px",selectable:!0,editable:!0,height:KD.layout.getActualHeight(this.el)-50,dataSource:{data:[]},columns:[{field:"Number",template:'<span class="kd-grid-cellspan">#: Number #</span>',width:30,headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("序号","0025710030032346"))},{field:"Caption",template:'<span class="kd-grid-cellspan">#: Caption #</span>',width:90,headerTemplate:kendo.format('<a href="#" class="k-link" tabindex="-1">{0}</a>',ResManager.LoadKDString("字段","099002000000030"))},{field:"MinScale",width:50,editable:!0,template:'<span style="'+t+'" class="kd-grid-cellspan">#:MinScale #</span>',title:ResManager.LoadKDString("最小级次","099002000000052"),editor:function(t,i){e._setTagGridEditor(t,i)}},{field:"MaxScale",width:50,editable:!0,template:'<span style="'+t+'" class="kd-grid-cellspan">#: MaxScale #</span>',title:ResManager.LoadKDString("最大级次","099002000000053"),editor:function(t,i){e._setTagGridEditor(t,i)}},{field:"SupportGroup",hidden:!0,template:'<span class="kd-grid-cellspan">#: SupportGroup #</span>',title:"SupportGroup"},{field:"FieldName",template:'<span class="kd-grid-cellspan">#: FieldName #</span>',title:"FieldName",hidden:!0}]},a=$('<div id="'+i.id+'"></div>'),n=$("#"+this.tid);n.append(a),a.kendoGrid(i),this.tagGrid=a.data("kendoGrid")},setSummaryFields:function(e){this._setSourceData(e)},_setSourceData:function(e){var t=new kendo.data.DataSource({data:e,schema:{model:{fields:{FieldName:{editable:!1},Caption:{editable:!1}}}}});this.sourceGrid.setDataSource(t);var i=this;$("tr[role='row']","#"+this.sid).dblclick(function(e){i.btnAddOnClick(e)})},_setTagData:function(e){this.currentRows=e;var t=new kendo.data.DataSource({data:e,schema:{model:{fields:{Number:{editable:!1},Caption:{editable:!1},FieldName:{editable:!1},SupportGroup:{editable:!1},MinScale:{editable:!0},MaxScale:{editable:!0}}}}});this.tagGrid.setDataSource(t)},_setTageSelectIndex:function(e){var t=this.tagGrid.tbody.find(">tr:not(.k-grouping-row)").eq(e);this.tagGrid.select(t)},_setTagGridEditor:function(e,t){var i=this;if("0"==t.model.SupportGroup){var a=0==t.model[t.field]?"":t.model[t.field];$('<span class="kd-grid-cellspan">'+a+"</span>").appendTo(e)}else $('<input data-bind="value:'+t.field+'"  />').appendTo(e).kendoNumericTextBox({step:1,format:"n0",decimals:0,change:function(e){var t=this.value(),a=i.tagGrid.select(),n=i.tagGrid.dataItem(a),o=$(e.sender.element).attr("data-bind").replace("value:","");n[o]=t},min:0,max:i.MaxLevelScope,value:t.model[t.field]})},setSummaryRows:function(e){var t=new Array;for(i=0;i<e.length;i++){var a=e[i],n="1"==a.SupportGroup,o={Number:i+1,Caption:KD.isArray(a.Caption)?a.Caption[0].Value:a.Caption,MinScale:n?a.MinScale:"",MaxScale:n?a.MaxScale:"",FieldName:a.FieldName,SupportGroup:a.SupportGroup};t.push(o)}this._setTagData(t)},setSelectEntities:function(e){},getLastUpdateStateActionArgs:function(e){for(var t=e.length-1;t>=0;t--){var i=e[t];if("updateState"==i.name&&i.args.setSummaryRows){this.lastUpdateStateActionArgs=i.args;break}}},btnAddOnClick:function(e){var t=this.sourceGrid.select();if(!(null==t||t.length<=0)){var i=this.sourceGrid.dataItem(t),a=this.tagGrid.dataItems();for(var n in a)if(a[n].FieldName==i.FieldName)return;a.push({Number:a.length+1,Caption:i.Caption,FieldName:i.FieldName,SupportGroup:i.SupportGroup,MinScale:"1"==i.SupportGroup?0:"",MaxScale:"1"==i.SupportGroup?0:""});var o=this.tagGrid.select(),r=$.map(a,function(e){return $.extend(!0,{},e)}),s=this.tagGrid.dataItem(o);this._setTagData(r),null!=s&&this._setTageSelectIndex(s.Number-1)}},btnRemoveOnClick:function(e){var t=this.tagGrid.select();if(!(null==t||t.length<=0)){for(var i=this.tagGrid.dataItem(t),a=this.tagGrid.dataItems(),n=[],o=0;o<a.length;o++)a[o].FieldName!=i.FieldName&&n.push({Number:0,Caption:a[o].Caption,FieldName:a[o].FieldName,SupportGroup:a[o].SupportGroup,MinScale:a[o].MinScale,MaxScale:a[o].MaxScale});$.each(n,function(e,t){t.Number=e+1});var r=$.map(n,function(e){return $.extend(!0,{},e)});this._setTagData(r),i.Number==a.length&&i.Number&&i.Number-2>=0?this._setTageSelectIndex(i.Number-2):i.Number&&i.Number-1>=0&&this._setTageSelectIndex(i.Number-1)}},btnRemoveAllOnClick:function(e){this._setTagData([])},btnUpOnClick:function(e){var t=this.tagGrid.select();if(!(t.length<=0)){var i=this.tagGrid.dataItem(t);null!=i&&this._moveRow(i,!0)}},btnDownOnClick:function(e){var t=this.tagGrid.select();if(!(t.length<=0)){var i=this.tagGrid.dataItem(t);null!=i&&this._moveRow(i,!1)}},_moveRow:function(e,t){var i=this.tagGrid.dataItems();if(this.currentRows&&!(this.currentRows.length<=0)){var a=0;if(t){if(1==e.Number)return;a=e.Number-1}else{if(e.Number==i.length)return;a=e.Number+1}for(var n=this.tagGrid.dataItems()[a-1],o=0;o<this.currentRows.length;o++){var r=this.currentRows[o];r.Number==a?(r.Caption=e.Caption,r.SupportGroup=e.SupportGroup,r.FieldName=e.FieldName,r.MinScale=e.MinScale,r.MaxScale=e.MaxScale):r.Number==e.Number&&(r.Caption=n.Caption,r.FieldName=n.FieldName,r.MinScale=n.MinScale,r.MaxScale=n.MaxScale)}this._setTagData(this.currentRows),this._setTageSelectIndex(a-1)}},validating:function(e){return this.commitValueToForm(),!0},commitValueToForm:function(){var e={};if(this.isDontLazy())e=this.getCommitData(this.tagGrid.dataItems(),this.postKey);else{if(this.getLastUpdateStateActionArgs(this.lazyActions),void 0==this.lastUpdateStateActionArgs.setSummaryRows)return;e=this.getCommitData(this.lastUpdateStateActionArgs.setSummaryRows,this.lastUpdateStateActionArgs.key)}this.getFormProxy().storeData(e.key,e.value,e.row,e.parentRow)},getCommitData:function(e,t){var i=[];if(e.sort(function(e,t){return e.Number>t.Number?1:-1}),this.isDontLazy())for(var a=0;a<e.length;a++){var n=e[a],o=""==n.MinScale?0:parseInt(n.MinScale),r=""==n.MaxScale?0:parseInt(n.MaxScale);i.push({FieldName:n.FieldName,MinScale:o,MaxScale:r})}else for(var a=0;a<e.length;a++){var n=e[a];i.push({FieldName:n.FieldName,MinScale:n.MinScale,MaxScale:n.MaxScale})}return{key:t,value:JSON.stringify(i),row:this.getRow(),parentRow:this.getParentRow()}}}),KDControlFactoryProxy.registerType("kdsummary",KDFilterSummaryProxy),define("KDFilterSummaryProxy",["KDEditorProxy","KD"],function(e){return function(){var t;return t||e.KDFilterSummaryProxy}}(this)),KDSQLFilterGridProxy=KD.extend(KDKendoGridProxy,{fieldTextName:"fieldText",createControl:function(e){KDSQLFilterGridProxy.superclass.createControl.call(this,e)},isEditable:function(){return!0},loadConfig:function(e){this._filterRows=[],KDSQLFilterGridProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDSQLFilterGridProxy.superclass.initComponent.call(this),this.doLazyAction()},createColumnsAndStore:function(e){var t=this,i=this.getGridoption();i.formatCellEditor=function(e,i,a,n,o){t.formatCellEditor.call(t,e,i,a,n,o)},i.afterSaveCell=function(e,i,a,n,o,r){t.afterSaveCell.call(t,e,i,a,n,o,r)},this.initGrid(i),this.el.show()},setCompareValueInner:function(e,t,i,a){if(e){var n={row:e.RowId,value:t,isTitle:a};KD.isEmpty(i)||(n[this.fieldTextName]=i),this.setCompareValue(n,!0)}},setCompareValue:function(e,t){var i=KD.getValue(e,"row",0),a=KD.getValue(e,"value",""),n=KD.getValue(e,"isTitle",""),o=KD.getValue(e,this.fieldTextName,void 0),r=this._filterRows&&this._filterRows[i];r&&(KD.isEmpty(n)?r.Value=a:r.IsTitle=n,KD.isEmpty(o)||(r[this.fieldTextName]=o),1!=t&&this._setDataSource(this._filterRows))},setFilterFields:function(e){this._innerFilterFields=e;for(var t=this._innerFilterFields.length,i=0;t>i;i++){var a=this._innerFilterFields[i],n=a.Editor.lookup;null!=n&&(n.proxykey=this.getKey(),n.key=a.KeyWord)}},onFieldChange:function(e,t){var i=this.component.getSelectedRow();this.afterSaveCell(i,"FilterField",t.current,i,1,null)},setFilterRows:function(e,t){var i=this;t=void 0==t?!0:t,this._filterRows=e,null==this._filterRows&&(this._filterRows=[]);for(var a=this._filterRows.length,n=0;a>n;n++){var o=this._filterRows[n];o.FilterField=this.getFieldByKeyWord(this._innerFilterFields,o.KeyWord);var r=i._getDisplayStringByConfig(o.FilterField,o);void 0!=r&&(o[this.fieldTextName]=r),KD.filter.loadRowValue(o)}this._setDataSource(this._filterRows)},getFieldByKeyWord:function(e,t){for(var i=e.length,a=0;i>a;a++){var n=e[a];if(n.KeyWord==t)return n}return null},changeValueEditor:function(e,t){var i=t.model.RowId,a=t.model,n=a,o=n.FilterField,r=o.Editor;r.id=this.getBaseId()+"-SQLFilter-"+t.field+"_"+i,(null==r||void 0==r)&&(isemptyEditor=!0,r={xtype:"textfield",editable:!1});var s=r.xtype,l=this._getEditorTemplate(s,t),d=$(l).appendTo(e),c=this._getEditorOptions(r,a);if("bosf7field"==s){var h=this.getControlFactoryProxy().createControl(r);if(!KD.isEmpty(h)){var u=a&&a.Value;r.dock=5,r.ownerKey=this.getKey(),r.isForBatchFilter=!0,h.loadConfig(r),h.parentProxy=this,h.setIsSqlFilterSearch(!0),a&&h._setPostKey(a.KeyWord),h.setRow(i),h.initComponent(),h.el.appendTo(d),h.setValue.call(h,u)}}else switch(s){case"timefield":d.kendoTimePicker(c);break;case"datefield":d.kendoDatePicker(c);break;case"datetimefield":d.kendoDateTimePicker(c);break;case"numberfield":d.kendoNumericTextBox(c);break;case"kdcombo":d.kendoDropDownList(c);break;case"textfield":d.kendoMaskedTextBox(c)}},_getEditorOptions:function(e,t){var i=this,a={id:e.id,value:t.Value};switch(e.xtype){case"timefield":case"datetimefield":case"datefield":a.format=i._getDateTimeFormat(e),a.change=function(a){var n=this.value(),o="";if(!KD.isEmpty(n)){o=new Date(n);var r=i._getDateTimeFormat(e),s=o.format(r)}t.set("Value",s),i.setCompareValueInner(t,s)};break;case"numberfield":e.decimalIntLength==e.decimalScale?$.extend(a,{format:"n0",decimals:0}):$.extend(a,{step:.1}),a.change=function(e){var a=this.value();a=KD.isEmpty(a)?"":a,t.set("Value",a),i.setCompareValueInner(t,a)};break;case"kdcombo":for(var n=[],o=0;o<e.store.length;o++){var r=e.store[o];n.push({alias:r[1],name:r[1],value:r[0]})}$.extend(a,{autoBind:!0,height:300,dataTextField:"name",dataValueField:"value",change:function(e){var i=this.value();t.set("Value",i)},select:function(e){var a=this.value();t.set("Value",a);var n=e.dataItem||{},o=n.name;t.set(i.fieldTextName,o),i.setCompareValueInner(t,a,o)},dataSource:{data:n}});break;case"bosf7field":$.extend(a,e,{buttonClick:function(e){var a=t.RowId,n=t.FilterField.KeyWord,o=t.Value?t.Value:"";void 0!=o.name&&(o=o.name),i.validating.call(i);var r=i.getFormProxy();r&&r.fireEvent.call(r,"FilterGridF7ButtonClick",i.getKey(),n,o,a)},change:function(e,a){a=a||"",t&&t.set("Value",a),i.setCompareValueInner(t,a)}});break;case"textfield":a.mask="",a.change=function(e){var a=this.value();a=KD.isEmpty(a)?"":a,t&&t.set("Value",a),i.setCompareValueInner(t,a)}}return a},_getDateTimeFormat:function(e){var t="yyyy/M/d",i=KD.getValue(e,"displayFormatString",null),a=KD.getValue(e,"mask",null),n=KD.getValue(e,"format",null);return null!=a?t=a:null!=i?t=i:null!=n&&(t=n),t},_getEditorTemplate:function(e,t){var i='<input data-bind="value:'+t.field+'")>';switch(e){case"bosf7field":i="<div>";break;case"kdcombo":case"timefield":case"datetimefield":case"datefield":i=i.replace('data-bind="value:'+t.field+'"',"")}return i},validating:function(){var e=JSON.stringify(this.getFilterSetting(this.getKendoGrid().dataItems()));return this.getFormProxy().storeData(this.getKey(),e,0,0),!0},getFilterSetting:function(e,t){var i=[];return $.each(e,function(e,a){if(1==t||a.FilterField){var n={};a.FilterField&&(n.KeyWord=a.KeyWord,n.Value=void 0==a.Value?"":void 0==a.Value.name?a.Value:a.Value.name,n.IsTitle="1"==a.IsTitle?!0:!1),i.push(n)}}),i},_setDataSource:function(e){for(var t=0;t<e.length;t++)e[t].RowId=t,(null==e[t].Value||void 0==e[t].Value)&&(e[t].Value="");var i=new kendo.data.DataSource({data:e,schema:{model:{fields:{Caption:{editable:!1},IsTitle:{editable:!0,type:"Boolean"}}}}});this.getKendoGrid().setDataSource(i)},getGridoption:function(){var $this=this,ops={height:"100%",width:"100%",editable:!0,dataSource:{data:[]},save:function(e){if(void 0!==e.values.Value&&e.values.Value instanceof Date){var t=e.values.Value.format($this._getDateTimeFormat(e.model.FilterField.Editor)),i=e.model.Value;t!==i&&e.model.set("Value",t)}},columns:[{field:"RowId",hidden:!0},{field:"Caption",editable:!1,width:200,title:ResManager.LoadKDString("字段","099002000000030"),template:'<span class="kd-grid-cellspan">#: Caption #</span>'},{field:"KeyWord",title:"KeyWord",hidden:!0},{field:"FilterField",title:"FilterField",hidden:!0},{field:"Value",width:200,title:ResManager.LoadKDString("值","099002000000032"),editable:!0,editor:function(e,t){$this.changeValueEditor(e,t)},template:function(e){return $this.getTemplate.call($this,"Value",e)}},{field:"IsTitle",width:100,title:ResManager.LoadKDString("标题","099002000000097"),editable:!0,type:"Boolean",template:'<span class="kd-grid-cellspan"> #= IsTitle ?"'+ResManager.LoadKDString("是","0991733000003969")+'":"'+ResManager.LoadKDString("否","0991733000003970")+'"#</span>',editor:function(container,options){var rowdata=options.model;$('<input data-bind="value:'+options.field+'"  />').appendTo(container).kendoDropDownList({dataTextField:"Name",dataValueField:"Value",dataSource:{data:[{Name:ResManager.LoadKDString("是","0991733000003969"),Value:!0},{Name:ResManager.LoadKDString("否","0991733000003970"),Value:!1}]},value:options.model.IsTitle,change:function(e){var isTitle=this.value();isTitle=KD.isEmpty(isTitle)?!1:eval(isTitle),rowdata&&rowdata.set("IsTitle",isTitle),$this.setCompareValueInner(rowdata,null,null,isTitle)}})}}]};return ops},getTemplate:function(e,t){var i="",a=this._getValueByRowData(e,t);return i=kendo.format('<span class="kd-grid-cellspan">{0}</span>',a)},_getValueByRowData:function(e,t){var i="";if(t){var a=KD.isValidProp(t,this.fieldTextName)?this.fieldTextName:"Value";i=t.get?t.get(a):t[a]}return KD.isEmpty(i)&&(i=""),i},_getDisplayStringByConfig:function(e,t){var i=void 0;if(e&&t){var a=e.Editor||{};if("kdcombo"==a.xtype)for(var n=a.store||[],o=t.Value,r=0;r<n.length;r++){var s=n[r];s[0]==o&&(i=s[1])}}return i}}),KDControlFactoryProxy.registerType("kdsqlfcpgrid",KDSQLFilterGridProxy),define("KDSQLFilterGridProxy",["KDKendoGridProxy","KDBosF7Proxy","KD"],function(e){return function(){var t;return t||e.KDSQLFilterGridProxy}}(this)),function(e){e.fn.KDFilterGrid=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDFilterGrid.prototype,e.fn.KDControlBase.defaults,e.fn.KDFilterGrid.defaults,t);return this.fq=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,this.fq.filtercontent=e("<div role='filtercontent' style='width:100%;'></div>"),this.fq.filtertitle=e("<div style='width:100%;height:25px;padding-top:2px;'></div>"),this.fq.filterQuikerRows=e("<div role='filterQuikerRows' class='kdFilterRowsContent' style='overflow:auto;border: 1px solid #dddddd;'></div>"),$this=e(this),this.options=t,this.each(function(){var t=e(this);e.meta?e.extend(i,opts,t.data()):i})},e.fn.KDFilterGrid.prototype={getContent:function(){return this.fq},_store_PropertyChanged:function(e,t){},doLayout:function(e){var t=this,i=t.getContent();e&&6==e.dock&&i.css({height:KD.layout.getActualHeight(i.parent()),width:KD.layout.getActualWidth(i.parent())});var a=KD.layout.getActualWidth(i.filtercontent),n=KD.layout.getActualHeight(i)-35;this.fq.filterQuikerRows.css("width",a+"px"),this.fq.filterQuikerRows.doLayout(),n>=0&&this.fq.filterQuikerRows.css("height",n+"px")},loadConfig:function(e){var t=this,i=t.getContent();KD.setAttachmentData(this,e),KD.layout.setAbsolute(this,e),i._store=new FilterQuickerEntity;var a=t._store_PropertyChanged;a.source=this,i._store.setpropertyChanged(a),i._store.init(),i._store.TotalColumns=0,i._store.isFilterGrid=!0,i.filtertitle.appendTo(i),i.filtercontent.appendTo(i);var n=KD.layout.getActualWidth(i.filtercontent),o=KD.layout.getActualHeight(i)-35,r={id:this.baseId+"Rs",name:this.baseId+"Rs",onchange:function(e,i){t.options.onchange.call(t,e,i)}},s={id:this.baseId+"Rs",width:n,isFilterGrid:!0};i.filterQuikerRows=i.filterQuikerRows.KDFilterQuickerRows(r),i.filterQuikerRows.getContent().appendTo(i.filtercontent),this.fq.filterQuikerRows.css("height",o+"px"),i.filterQuikerRows.attr("id",this.baseId+"_drs"),i.filterQuikerRows.baseId=this.baseId+"_drs",i.filterQuikerRows.addbtnParent=i.filtertitle,i.filterQuikerRows.loadConfig(s),i.filterQuikerRows.proxy=this.fq.proxy,this.setDisabled(KD.getValue(e,"disabled",!1))},setDisabled:function(e){var t=this.getContent();t.filterQuikerRows.setDisabled&&t.filterQuikerRows.setDisabled(e)},setExpRowLimit:function(e){var t=this.getContent();t.filterQuikerRows&&t.filterQuikerRows.setExpRowLimit&&t.filterQuikerRows.setExpRowLimit(e)},SetFieldsStore:function(e){this._isInit=!0;var t=new Array;for(var i in e){var a=e[i];a.AllowAutoList=this.getAllowAutoList(),t.push(a)}var n=this.getContent();n._store.SetFieldsStore(t),this._isInit=!1},SetComparersStore:function(e){this._isInit=!0;var t=new Array;for(var i in e){var a=e[i];t.push(a)}var n=this.getContent();n._store.SetComparersStore(t),this._isInit=!1},SetData:function(e){var t=this.getContent();t._store.LoadData(this,e);for(var i=t._store.getItems(),a=0;a<i.length;a++)i[a].IsAddByUser=!0;t.filterQuikerRows.SetItemsSource(t._store,!0)},setAllowAutoList:function(e){var t=this.getContent();t._store.setAllowAutoList(e)},getAllowAutoList:function(){var e=this.getContent();return e._store.getAllowAutoList()},SetValeObject:function(e,t){var i=this.getContent();i._store.SetItemValue(e,t),this.updateRowUI(e)},updateRowUI:function(e){var t=this.getContent();if(!(0>e||null==t._store||!t._store._items||t._store._items.length<=e)){var t=this.getContent();t.filterQuikerRows.UpdateRow(t._store,e,t._store._items[e])}},SetServiceConfig:function(e){var t=this.getContent();t._store.ServiceConfig=e},GetSetting:function(){var e=this.getContent();return e._store.GetSetting()}},e.fn.KDFilterGrid.defaults={metaHtml:"",defaults:{}}}(jQuery),define("KDFilterGrid",["KDFilterQuickerRows","FilterQuickerEntity","KD"],function(e){return function(){var t;return t||e.KDFilterGrid}}(this)),KDFilterGridProxy=KD.extend(KDEditorProxy,{createControl:function(e){var t=this;return KDFilterGridProxy.superclass.createControl.call(this,e),this.el=this.el.KDFilterGrid({onchange:function(e,i){t.onchange.call(t,e,i)}}),this.el.attr("id",this.baseId),this.el.baseId=this.baseId,this.el},isEditable:function(){return!0},loadConfig:function(e){this.setCompareTypeGroup(KD.getValue(e,"compareTypeGroup",[])),this.setLogicData(KD.getValue(e,"logicData",[])),this._filterRows=[],KDFilterGridProxy.superclass.loadConfig.call(this,e),this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(this.config)),this.setExpRowLimit(KD.getValue(e,"expRowLimit",125)),this.el.SetData(this._filterRows)},initComponent:function(){KDFilterGridProxy.superclass.initComponent.call(this),this.doLazyAction()},setExpRowLimit:function(e){this.el&&this.el.setExpRowLimit(e)},setCompareTypeGroup:function(e){this._innerCompareTypeGroup=e,$.each(this._innerCompareTypeGroup,function(e,t){t.name=t.ID,t.alias=t.Name,t.value=t.ID})},setLogicData:function(e){this._innerLogicStore=e,$.each(this._innerLogicStore,function(e,t){t.name=t.Value,t.alias=t.Name,t.value=t.Value})},setCompareValue:function(e){var t=KD.getValue(e,"row",0),i=KD.getValue(e,"value","");this.el.SetValeObject(t,i)},setFilterFields:function(e){this._innerFilterFields=e;for(var t=this._innerFilterFields.length,i=0;t>i;i++){var a=this._innerFilterFields[i];a.CompareTypes=KD.filter.getCompareTypesByGroupIds(this._innerCompareTypeGroup,a.CompareGroupID);var n=a.Editor.lookup;null!=n&&(n.proxykey=this.getKey(),n.key=a.FieldName),a.Editor&&a.Editor.maxLength&&(a.Editor.maxLength=void 0)}for(var o in this._innerFilterFields){var a=this._innerFilterFields[o];if(KD.filter.isNeedRemoveFiledCompareTypes(a,this._innerFilterFields))for(var i=a.CompareTypes.length-1;i>-1;i--){var r=a.CompareTypes[i];(200==r.GroupID||201==r.GroupID)&&(a.CompareTypes=this.removeCompareTypes(a.CompareTypes,r))}}this.el.SetFieldsStore(this._innerFilterFields)},removeCompareTypes:function(e,t){for(var i=[],a=0;a<e.length;a++){var n=e[a];n.ID!=t.ID&&i.push(n)}return i},doLayout:function(){this.el&&this.el.doLayout&&this.el.doLayout(this.config)},setSelectEntities:function(e){if(this._innerFilterFields&&this.selectEntities!=e){this.selectEntities=e;var t=KD.filter.getFilterSetting(this._filterRows);this.currentFields=KD.filter.getFieldsBySelectEnties(this._innerFilterFields,e),this.el.SetFieldsStore(this.currentFields),this.setFilterRows(t)}},setDisabled:function(e){this.el.setDisabled&&!KD.isEmpty(e)&&(this.disabled=e,this.el.setDisabled(e))},setAllowAutoList:function(e){this.el&&this.el.setAllowAutoList&&this.el.setAllowAutoList(e)},setFilterRows:function(e,t){var i=this,a={value:e,autoEmptyDel:t};KD.delayInvoke(function(e){e=e||{};var t=e.value,a=e.autoEmptyDel;i.setFilterRowsCore(t,a)},void 0,!0,a)},setFilterRowsCore:function(e,t){t=void 0==t?!0:t;var i=[];this._filterRows=e,null==this._filterRows&&(this._filterRows=[]);for(var a=this._filterRows.length,n=0;a>n;n++){var o=this._filterRows[n];if(o.FilterField=KD.filter.getFieldByName(this.currentFields||this._innerFilterFields,o.FieldName),null==o.FilterField)0!=t&&i.push(n);else if(o.CompareType=KD.filter.getCompareTypeById(this._innerCompareTypeGroup,o.Compare),o.CompareTypes=o.FilterField.CompareTypes,o.LogicObject=KD.filter.getFilterLogic(this._innerLogicStore,o.Logic),null==o.CompareType||200!=o.CompareType.GroupID&&201!=o.CompareType.GroupID)KD.filter.loadRowValue(o);else{var r=null;null==r?KD.filter.loadRowValue(o):KD.filter.loadFieldsComboValue(o,r)}}a=i.length;for(var n=a-1;n>=0;n--)this._filterRows.splice(i[n],1);0==this._filterRows.length,this.el.SetData(this._filterRows),this.setDisabled(this.getDisabled())},validating:function(){if(void 0==this.el)return!0;if(this.el.GetSetting){var e=JSON.stringify(this.el.GetSetting());this.getFormProxy().storeData(this.getKey(),e,0,0)}return!0}}),KD.filter={getCompareTypesByGroupIds:function(e,t){var i=(t||"").split(","),a=e.filter(function(e){return i.indexOf(e.GroupID.toString())>-1});return a},getFieldsBySelectEnties:function(e,t){var i=[];return $.each(e,function(e,a){(","+t+",").toUpperCase().indexOf(","+a.EntityKey.toUpperCase()+",")>-1&&i.push(a)}),i},getCompareTypeById:function(e,t){for(var i=e.length,a=0;i>a;a++){var n=e[a];if(n.ID==t)return n}return null},getFieldByName:function(e,t){if(KD.isEmpty(e))return null;for(var i=e.length,a=0;i>a;a++){var n=e[a];if(n.FieldName==t)return n}return null},getFilterLogic:function(e,t){for(var i=e.length,a=0;i>a;a++){var n=e[a];if(n.Value==t)return n}return null},loadRowValue:function(e){},getFilterSetting:function(e,t){var i=[];return $.each(e,function(e,a){if(1==t||a.FilterField){var n={};a.FilterField&&(n.Left=a.Left?a.Left:"",n.FieldName=a.FilterField.FieldName,n.Compare=a.Compare,n.Value=void 0==a.Value?"":void 0==a.Value.name?a.Value:a.Value.name,n.Right=a.Right?a.Right:"",n.Logic=a.Logic?a.Logic:"0"),i.push(n)}}),i},isNeedRemoveFiledCompareTypes:function(e,t){if(null==e||null==t)return!0;var i=null==e.Editor?"":e.Editor.xtype;if(""==i)return!0;for(var a in t){var n=t[a];if(null!=n&&void 0!=n.FieldName&&""!=n.fieldName&&void 0!=n.Caption&&""!=n.Caption&&this.equalsIgnoreCase(n.EntityKey,e.EntityKey)&&!this.equalsIgnoreCase(n.FieldName,e.FieldName)){var o=null==n.Editor?"":n.Editor.xtype;if(o==i)return!1;if(!(("timefield"!=o&&"datefield"!=o&&"datetimefield"!=o||"timefield"!=i&&"datefield"!=i&&"datetimefield"!=i)&&("numberfield"!=o&&"digitfield"!=o||"numberfield"!=i&&"digitfield"!=i)))return!1}}return!0},equalsIgnoreCase:function(e,t){return null==e&&null==t?!0:null==e||null==t?!1:e.toUpperCase()===t.toUpperCase()}},KDControlFactoryProxy.registerType("kdfcpgrid",KDFilterGridProxy),define("KDFilterGridProxy",["KDEditorProxy","KDFilterGrid","KD"],function(e){return function(){var t;return t||e.KDFilterGridProxy}}(this)),KDBatchFilterGridProxy=KD.extend(KDKendoGridProxy,{dyFieldColNum:0,titlePanel:null,_cbFields:[],_cbFieldsCompare:[],_innerFilterFields:[],_cbMakeupType:null,AllowBlockPaste:!0,createControl:function(e){return e.enableSelCol=!1,KDBatchFilterGridProxy.superclass.createControl.call(this,e),this.el},loadConfig:function(e){this.dyFieldColNum=KD.getValue(e,"dyfieldcolnum",3);var t={id:"ToolBar",xtype:"toolbar",items:[{id:"tbAddRow",text:ResManager.LoadKDString("新增行","0991733000003955"),visible:!0,xtype:"button"},{id:"tbDelRow",text:ResManager.LoadKDString("删除行","0991733000003960"),visible:!0,xtype:"button"},{id:"tbDelAllRow",text:ResManager.LoadKDString("全部删除","0991733000003961"),visible:!0,xtype:"button"},{id:"tbInsertRow",text:ResManager.LoadKDString("插入行","0991733030033489"),visible:!0,xtype:"button"}]};e.tbar=t,this._initTitlePanel(),KDBatchFilterGridProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDBatchFilterGridProxy.superclass.initComponent.call(this)},initToolbar:function(){var e=this;KDBatchFilterGridProxy.superclass.initToolbar.call(this),this.tbarPxy.clickHandler=function(t){e._toolBarClickHandler.call(e,t)}},_initTitlePanel:function(){this.titlePanel=$(kendo.format("<div id='{0}_titlePanel'></div>",this.baseId)),this.titlePanel=this.titlePanel.KDPanel(),this.titlePanel.dock=KD.dock.top;var e=this.dyFieldColNum/3;this.titlePanel.css({"min-heigth":15+30*e,height:"auto"}),this.el.addControl(this.titlePanel),this._initTitleMakeupType(),this._resetFields()},_toolBarClickHandler:function(e){var t=this,i=e.id.substring((this.getPageId()+"-"+this.config.tbar.id).length+1);if(!(void 0==t.config.columns||t.config.columns.length<=1))switch(i){case"tbInsertRow":var a=t.getUIFocusedRowId();0>a&&(a=0);var n=t._createNewFilterRow(a);0>=a&&(a=1),t.insertRow(a,n[0],!0);break;case"tbDelAllRow":for(var o=[],r=0;r<t.store.rows.length;r++)o.push(t.store.rows[r].rowId);0!=o.length&&t.deleteRows(o);break;case"tbDelRow":var s=t.getUIFocusedCellData()||{},a=s.rowId;t.deleteRow(a),a-=1,0>=a?a=0:this.store&&this.store.rows&&a>=this.store.rows.length&&(a=this.store.rows.length-1),s.rowId=a,KD.delayInvoke(function(e){t.setFocusRowIndex(e.rowId+1),t.setFocusCell(e.rowId,e.field)},10,!0,s);break;case"tbAddRow":var n=t._createNewFilterRow();t.appendRowsCore(n)}},_createNewFilterRow:function(e){for(var t=[],i=[],a=this.config.columns,n=0;n<a.length;n++)if(0==n){var o=e;this.store.rows&&this.store.rows.length-1>=0&&(o=this.store.rows.length),void 0!=e&&(o=e),i[n]=o||0,KD.isNumber(i[n])&&(i[n]=i[n]+1)}else i.push("");return t.push(i),t},_initTitleMakeupType:function(){var e=$(KD.format('<div class="kd-grid-filter-makeuptype-container"><span class="kd-grid-filter-makeuptype-title">{0}</span><input id={1} class="kd-grid-filter-makeuptype"></input></div>',ResManager.LoadKDString("组合方式","0991733000005667"),this.baseId+"_cbMakeupType"));this.titlePanel.addControl(e);var t=e.find(".kd-grid-filter-makeuptype");t.kendoDropDownList({dataSource:[{name:ResManager.LoadKDString("列组合","0991733000005668"),value:"Column"},{name:ResManager.LoadKDString("行组合","0991733000005669"),value:"Row"}],autoBind:!0,value:"Row",dataTextField:"name",dataValueField:"value"}),this._cbMakeupType=t},_resetFields:function(){var e=this;this._cbFields.length>0&&(this.titlePanel.children().remove(),this._initTitleMakeupType()),this._cbFields=[],this._cbFieldsCompare=[];for(var t=0;t<this.dyFieldColNum;t++){var i=$("<input>");if(i.css({width:"165px","margin-top":"8px","margin-left":"8px"}).attr("id",this.baseId+"_cbFields_"+t),this._cbFields.push(i),this.titlePanel.addControl(i),i.kendoDropDownList({dataSource:[],autoBind:!0,optionLabel:ResManager.LoadKDString("请选择字段","0991733000003962"),dataTextField:"Caption",height:"350",dataValueField:"FieldName",change:function(t){var i=$(t.sender.element).attr("id");e._isHaveFieldColumn(this.value(),i)||e._cbFieldChange(t)}}),t<this.dyFieldColNum-1){var a=$("<input>");a.css({width:"60px","margin-top":"8px","margin-left":"8px"}).attr("id",this.baseId+"_cbFieldsCompare_"+t),this._cbFieldsCompare.push(a),this.titlePanel.addControl(a),a.kendoDropDownList({dataSource:[{name:ResManager.LoadKDString("且","0991733000003940"),value:"AND"},{name:ResManager.LoadKDString("或","0991733000003963"),value:"OR"}],autoBind:!0,value:"AND",dataTextField:"name",dataValueField:"value"})}}},_isHaveFieldColumn:function(e,t){if(KD.isEmpty(e))return!1;for(var i=0;i<this._cbFields.length;i++){var a=this._cbFields[i].data("kendoDropDownList");if(this._cbFields[i].attr("id")!=t&&a.value()==e)return!0}return!1},_getFilterFieldsBySelectEnties:function(e){for(var t=[],i=0;i<this._innerFilterFields.length;i++){var a=this._innerFilterFields[i];e.indexOf(a.EntityKey)>=0&&t.push(a)}return t},getGridContentSize:function(){var e=KDBatchFilterGridProxy.superclass.getGridContentSize.call(this),t=this.titlePanel.height();return e.height&&t>0&&(e.height=e.height-t-2),e},fireEntityRowClick:function(e){this.selOp.syncUI2Sel(e)},dblClick:function(e){},_cbFieldChange:function(e){this._resetData(!1)},_resetColumn:function(){this.config.columns=[],this.config.indexKey="BatchFilterIndexKey".toUpperCase(),this.config.columns.push({dataIndex:"BatchFilterIndexKey".toUpperCase(),header:"",visible:!1,width:10,colAlignType:3,isForBatchFilter:!0,colIndex:0});for(var e=!1,t=this._getUniqueField(),i=0;i<t.length;i++){var a=t[i].data("kendoDropDownList"),n=a.dataItem();if(!KD.IsNullOrWhiteSpace(a.value())){n.Editor.isForBatchFilter=!0,n.Editor.ownerKey=this.getKey(),n.FieldName=n.FieldName.toUpperCase();var o={dataIndex:n.FieldName,header:n.Caption,visible:!0,colIndex:i+1,width:50,isForBatchFilter:!0,editor:n.Editor};o.editor.editable=!0,o.editor.disabled=!1,this.config.isForBatchFilter=!0,this.config.columns.push(o),e=!0}}e&&(this.config.columns[0].visible=!0);var r=this.getStore();1==this.config.columns.length&&r&&r.rows&&(r.rows=[]),this.createColumnsAndStore(this.config)},setCompareValue:function(e){this.setFieldstates(e)},_rowValues:{},setMakeUpType:function(e){if(this._cbMakeupType){var t=this._cbMakeupType.data("kendoDropDownList");t&&("Row"==e?t.value("Row"):t.value("Column"))}},setFilterRowsWithMakeUpType:function(e){if(e){var t=KD.getValue(e,"MakeUpType","");this.setMakeUpType(t);var i=KD.getValue(e,"Source",[]);if("Row"==t){for(var a={},n=0;n<i.length;n++)for(var o=0;o<i[n].length;o++){var r=i[n][o],s=r.FieldName;if(a.hasOwnProperty(s)){var l=a[s].Value,d=KD.getValue(r,"Value","");KD.IsNullOrWhiteSpace(d)||(a[s].Value=l+","+d)}else a[s]=r}if(a){var c=[];for(var h in a)c.push(a[h]);this.setFilterRows(c)}}else this.setFilterRows(i)}},setFilterRows:function(e){this._rowValues={};for(var t=0;t<this._cbFields.length;t++){var i=this._cbFields[t].data("kendoDropDownList");i.setDataSource(this._getFilterFieldsBySelectEnties(this._selEntities)),i.value("")}for(var t=0;t<this._cbFieldsCompare.length;t++){var i=this._cbFieldsCompare[t].data("kendoDropDownList");i.value("AND")}var a=this._cbMakeupType.data("kendoDropDownList").value();if(void 0!=e&&e.length>0)for(var n=0,o=this._rowValues.maxValuesCount=0,t=0;t<e.length;t++){var r=e[t],s=r.FieldName,l=this._cbFields[n].data("kendoDropDownList");l.value(s);var d=KD.getValue(r,"Logic","AND");if(d="0"==d?"AND":"OR",n<this._cbFieldsCompare.length){var c=this._cbFieldsCompare[n].data("kendoDropDownList");c.value(d)}if(!KD.IsNullOrWhiteSpace(s)){var h=KD.getValue(r,"Value",""),u=[];if(!KD.isEmpty(h))if("Row"==a)u=h.split(",");else{var p=KD.parseObject(h);u=KD.isArray(p)?p:h.split(",")}this._rowValues[s]=u,u.length>o&&(o=u.length,this._rowValues.maxValuesCount=o);
}n++}this._resetData(!0)},_resetData:function(e){if(this.oldRows=this._getGridRowData(e),this._resetColumn(),!(void 0==this.config.columns||this.config.columns.length<=2)){var t={rows:this.oldRows};this.setData(t)}},_getUniqueField:function(){for(var e=[],t={},i=0;i<this._cbFields.length;i++){var a=this._cbFields[i].data("kendoDropDownList"),n=a.value().toUpperCase();void 0==t[n]&&(e.push(this._cbFields[i]),t[n]=!0)}return e},_getGridRowData:function(e){var t=[];if(e){for(var i=void 0!=this._rowValues.maxValuesCount?this._rowValues.maxValuesCount:1,a=0;i>a;a++){var n=[];n[0]=a+1;for(var o=0;o<this._cbFields.length;o++){var r=this._cbFields[o].data("kendoDropDownList"),s=r.value();void 0!=this._rowValues[s]?void 0==this._rowValues[s][a]?n.push(""):n.push(this._rowValues[s][a]):n.push("")}t.push(n)}return t}KD.isEmpty(this.store.rows)&&(this.store.rows=[{}]);for(var a=0;a<this.store.rows.length;a++){var l=[];l[0]=a+1;for(var d=this.store.rows[a],c=this._getUniqueField(),o=0;o<c.length;o++){var r=c[o].data("kendoDropDownList"),s=this.store.converFieldName(r.value()).toUpperCase(),h=this.store.getColumnDescriptor&&this.store.getColumnDescriptor.call(this.store,s),u=this._getValueByRowData(h,d,s);void 0!=u?l.push(u):l.push("")}t.push(l)}return t},setFilterFields:function(e){this._innerFilterFields=e,this._resetFields(),this._innerFilterFields.length>0&&this.setSelectEntities(this._innerFilterFields[0].EntityKey)},setSelectEntities:function(e){if(this._selEntities=e,!(this._innerFilterFields.length<=0))for(var t=0;t<this._cbFields.length;t++){var i=this._cbFields[t].data("kendoDropDownList");i.setDataSource(this._getFilterFieldsBySelectEnties(this._selEntities))}},getSetting:function(){for(var e={},t=[],i=[],a={},n=0;n<this._cbFields.length;n++){var o=this._cbFields[n].data("kendoDropDownList");if(!KD.IsNullOrWhiteSpace(o.value())&&t.indexOf(o.value())<0&&(t.push(o.value()),n<this._cbFields.length-1)){var r=this._cbFieldsCompare[n].data("kendoDropDownList");a[o.value()]=r.value()}}var s="Column";if(this._cbMakeupType){var l=this._cbMakeupType.data("kendoDropDownList");s=l.value(),e.MakeUpType=s}if("Row"==s)for(var d=[],c=0;c<this.store.rows.length;c++){d=[];for(var h=this.store.rows[c],n=0;n<t.length;n++){var u=t[n],p={FieldName:u},g=this.store.getColumnDescriptor(u),f=this._getValueByRowData(g,h,u),m=void 0==f?"":f.toString();KD.IsNullOrWhiteSpace(m)||(p.Value=m,void 0!=a[u]?p.Logic=a[u]:p.Logic="OR",d.push(p))}d.length>0&&i.push(d)}else for(var n=0;n<t.length;n++){for(var u=t[n],p={FieldName:u},v=[],c=0;c<this.store.rows.length;c++){var h=this.store.rows[c],g=this.store.getColumnDescriptor(u),f=this._getValueByRowData(g,h,u),m=void 0==f?"":f.toString();KD.IsNullOrWhiteSpace(m)||v.push(m)}KD.isEmpty(v)||(p.Value=KD.stringify(v),void 0!=a[u]?p.Logic=a[u]:p.Logic="OR",i.push(p))}return e.Source=i,e},_getValueByRowData:function(e,t,i){var a;return i=i||"",e&&e.getValueByRowData?a=e.getValueByRowData.call(e,t,i):t&&(a=t[this.store.converFieldName(i).toUpperCase()]),a},validating:function(){if(void 0==this.el)return!0;if(this.getSetting){var e=JSON.stringify(this.getSetting());this.getFormProxy().storeData(this.getKey(),e,0,0)}return!0},setAllowBlockPaste:function(e){this.AllowBlockPaste=!0},doBlockPasting:function(e){var t=this,i="",a=t.getStore(),n=t.getUIFocusedCellData();if(n&&n.field&&!KD.isEmpty(e)&&a){n.field=a.revertKendoFieldName(n.field);var o=!0;try{var r="",s=a.getVisibleCols.call(a);for(var l in s){var d=s[l],c=d.getFieldName.call(d);r+=c+","}r.length>0&&(r=r.substring(0,r.length-1),r+="\n"),r+=e,e=r,e=e.replace("\r","\n").replace("\n\n","\n");var h=e.split("\n"),u=h.length-1,p=n.rowId||1;if(u>a.rows.length-p)for(var g=a.rows.length-p+1;u>g;g++){var f={};f.id=t.getPageId()+"-"+t.config.tbar.id+"-tbInsertRow",t._toolBarClickHandler(f),o=!1}var m=[];h.length>0&&!KD.isEmpty(h[0]+"")&&this._setFieldKeyList(n.field,h[0]+"",m);for(var g=1;g<h.length;g++){var v=h[g]+"";if(KD.isEmpty(v))p++;else{var y=v.split("	");y.length;if(KD.isEmpty(m)){i=!1;break}var b=0;for(var D in y)if(b<=m.length-1){var k=m[b]||"",C=y[D]||"",x=a.getColumnDescriptor(k);x&&("datefield"==x.xtype||"datetimefield"==x.xtype||"timefield"==x.xtype?C=C&&C.length>=5?x.getDisplayValue.call(x,C,p,void 0,!1):"":"numberfield"==x.xtype&&(C=x.getDisplayValue.call(x,C,p)),x.setSvrValue.call(x,p,C)),b++}p++}}o&&t.setRefreshGridDataFlag(o)}catch(w){var K=this.getFormProxy(),S=ResManager.LoadKDString("粘贴异常","014002000003962"),I=w.message+"\r\n"+w.stack;return KD.writeError(w),K.showErrMsgStr(S,I),!0}}return i},_isShowContextMenu:function(){var e=KDBatchFilterGridProxy.superclass._isShowContextMenu.call(this);if(e){var t=$(this.getCurrentElement());t.find(".k-gridCellstate-disabled").length>0&&(e=!1)}return e},_setFieldKeyList:function(e,t,i){if(KD.isEmpty(i)){var a=0,n=t.substring(t.indexOf(e)).split(",");for(var o in n)KD.equalsIgnoreCase(e,n[o])?i[a++]=n[o]:a>0&&(i[a++]=n[o])}}}),KDControlFactoryProxy.registerType("kdbatchfilter",KDBatchFilterGridProxy),KDBatchFilterGridProxy_blankholder=KD.extend(KDEditorProxy,{createControl:function(e){return KDBatchFilterGridProxy_blankholder.superclass.createControl.call(this,e),this.el.html(KD.getWaitToDevelop("[批量过滤条件]功能")),this.el},loadConfig:function(e){KDBatchFilterGridProxy_blankholder.superclass.loadConfig.call(this,e)},initComponent:function(){KDBatchFilterGridProxy_blankholder.superclass.initComponent.call(this)},setFilterFields:function(e){},setSelectEntities:function(e){},validating:function(){return!0}}),define("KDBatchFilterGridProxy",["KDFilterGridProxy","KD"],function(e){return function(){var t;return t||e.KDKendoGridProxy}}(this)),KDNaviBarProxy=KD.extend(KDControlProxy,{data:null,currentHeight:140,defaultHeight:14,defaultShowRows:2,defaultShowHeight:14.5,eachRowHeight:7,eachRowWidth:9.8,eachRowMaxItems:8,iconHeight:"",iconWidth:"",maxHeight:28,oftenFunsMaxNum:32,showMoreItemTitle:ResManager.LoadKDString("点击展开常用功能","0991733000003976"),hiddenMoreItemTitle:ResManager.LoadKDString("点击折叠常用功能","0991733000003977"),isCard:!1,isSmartCard:!1,displayMode:"",defaultImg:"../images/biz/default/FunctionGroup/Html5/Function_Default.png",unselectImg:"../images/biz/default/FunctionGroup/Html5/add.png",noOftenFunction:"../images/biz/default/MainConsole/H5CardLayout/noContent.png",cardAddPoint:"../images/biz/default/MainConsole/H5CardLayout/add.png",readOnlyForAooPlat:!1,hoverShowDeleteBtn:!1,isstdcommfun:!1,isDefaultItem:!1,isAllowDragSort:!1,isDragSortMode:!1,isInsertDragModel:!0,naviOperActionArgs:{ClickOper:"Click",DelOper:"Del",EditOper:"Edit",NewOper:"New",ChangeIndexOper:"ChangeIndexOper",ChangeIndexRangeOper:"ChangeIndexRangeOper"},loadConfig:function(e){KDNaviBarProxy.superclass.loadConfig.call(this,e),this.lastEachRowMaxItems=0,this.setRequestLock(!0),this.hoverShowDeleteBtn=KD.isManagementSite(),this.storageName=KD.generateUserHashID()+"_"+this.getFormProxy().dformConfig.formid+"_oftenFunctionOpenState",this.isShowMore="true"==KD.storage.getItem(this.storageName)?!0:!1},initComponent:function(){KDNaviBarProxy.superclass.initComponent.call(this)},doLayout:function(){if(KDNaviBarProxy.superclass.doLayout.call(this),null!=this.data){this.isAppPlat&&(this.isshow=$(".kd-appPlatFunctionCard-del").is(":visible"),this.platItem());var e=parseInt(this.el.width()/(this.eachRowWidth*KD.getCurrentFontsize()));e=e>=this.eachRowMaxItems?this.eachRowMaxItems:e,this.lastEachRowMaxItems!=e&&this.GenItems()}},setData:function(e){this.defaultItems=[],this.oftenFunsMaxNum=e.oftenFunsMaxNum||this.oftenFunsMaxNum,this.data=e.items||[],this.isShowMoreBtn=e.isShowMoreBtn||"show",this.isCard=e.isCard||this.isCard,this.isSmartCard=e.isSmartCard||this.isSmartCard,this.customInlineStyle=e.customInlineStyle||{},this.displayMode=e.displayMode||this.displayMode,this.iconHeight=e.iconHeight||this.iconHeight,this.iconWidth=e.iconWidth||this.iconWidth,this.eachRowMaxItems=e.eachRowMaxItems||this.eachRowMaxItems,this.isAppPlat=e.appplat,this.readOnlyForAooPlat=e.readonlyforaooplat,this.hoverShowDeleteBtn=e.hovershowdeletebtn?e.hovershowdeletebtn:KD.isManagementSite(),this.isstdcommfun=e.isstdcommfun,this.isDefaultItem=e.isdefaultitem,KD.isEmpty(e.defaultShowRows)||(this.defaultShowRows=e.defaultShowRows,this.defaultShowHeight=this.defaultHeight=this.eachRowHeight*this.defaultShowRows),this.releaseDragSort(),e.appplat?this.platItem():this.GenItems(),this.enableDrapSort(!0)},platItem:function(){this.data=this.data||[],this.el.empty(),this.component=$("<div>"),this.component.addClass("kd-consoleFunction-panel").css({"font-size":"14px","padding-left":"2.3em"}),this.el.append(this.component);var e=parseInt(this.el.width()/(this.eachRowWidth*KD.getCurrentFontsize())),t=e>=this.eachRowMaxItems?!0:!1;e=e>=this.eachRowMaxItems?this.eachRowMaxItems:e,this.lastEachRowMaxItems=e,this.data&&this._createPlatCommFuncItems(t);var i=(this.data.length<this.oftenFunsMaxNum?this.data.length+1:this.data.length)/e;i=i-parseInt(i)>0?parseInt(i)+1:i,this.itemRowsCount=i,0!=this.data.length?(this._createAppPlatDefaultItem(e,2,!1),this.defaultHeight=i*this.eachRowHeight):0==this.data.length&&(this.defaultHeight=this.defaultShowHeight,this._createAppPlatDefaultItem(e,2,!1))},GenItems:function(){this.data=this.data||[];var e=this;this.el.empty(),this.component=$("<div>"),this.component.addClass("kd-consoleFunction-panel").css("height",this.currentHeight/10+"em"),this.isCard?this.component.css({"padding-left":"0.7em","padding-top":"0.8em",height:"14em"}):(this.component.css("height",this.currentHeight/10+"em"),0==this.data.length&&this.component.css("height","10.7em")),KD.isEmpty(this.customInlineStyle)||this.component.css(this.customInlineStyle),this.el.append(this.component);var t=parseInt(this.el.width()/(this.eachRowWidth*KD.getCurrentFontsize())),i=t>=this.eachRowMaxItems?!0:!1;if(t=t>=this.eachRowMaxItems?this.eachRowMaxItems:t,this.lastEachRowMaxItems=t,this.data.length>0&&this._createCommfuncItems(i),0==this.data.length)return this.defaultHeight=this.defaultShowHeight,void this._createNullDom();var a=(this.data.length<this.oftenFunsMaxNum?this.data.length+1:this.data.length)/t;a=a-parseInt(a)>0?parseInt(a)+1:a,this.itemRowsCount=a,a>this.defaultShowRows||this.currentHeight&&this.currentHeight/10>this.maxHeight?(this.showMoreBtn=$(kendo.format('<div class="kd-consoleFunction-showmore" title={0} tabindex="-1"><a href="javascript:void(0);"  onclick="javascript:return false;" ><span class="kendo-color">{1}</span><span class="kd-consoleFunction-arrow kd-consoleFunction-arrow-down"> </span></a></div>',this.showMoreItemTitle)),this.showMoreBtn.click(function(t){var i=e.showMoreBtn.find("span.kd-consoleFunction-arrow"),a=i.hasClass("kd-consoleFunction-arrow-down");e._showMoreItem(a)}),this.el.append(this.showMoreBtn),"hide"==this.isShowMoreBtn&&this.showMoreBtn.css("display","none"),this._createDefaultItem(t,a>=4?a:4,i,this.isDefaultItem)):0!=this.data.length&&(this._createDefaultItem(t,this.defaultShowRows,i,this.isDefaultItem),this.defaultHeight=a*this.eachRowHeight),e.isstdcommfun&&(this.component.addClass("kd-stdconsoleFunction-panel"),this.showMoreBtn&&this.showMoreBtn.css("display","none"),this.component.css("height","auto")),e._showMoreItem(this.isShowMore)},deleteItemClick:function(e){var t=this._getCurrentItem($(e.currentTarget).closest(".kd-consoleFunction-subnav").attr("id"));if(this.isCard)var t=this._getCurrentItem($(e.currentTarget).closest(".kd-comFunsCard-item").attr("id"));var i=this.getFormProxy();i.lockControl.call(i,$this),i.fireEvent.call(i,"NaviOperAction",this.naviOperActionArgs.DelOper,t.key,t.index,t.id,null,null)},openFormClick:function(e,t){var i=$(e).closest(".kd-consoleFunction-subnav").attr("id");if(this.isCard)var i=$(e).closest(".kd-comFunsCard-item").attr("id");this._openForm(i)},_createCommfuncItems:function(e){var t,i,a,n,o,r=this;this.isCard||this.data.sort(function(e,t){return parseInt(e.index)>parseInt(t.index)?1:-1});var s=r.hoverShowDeleteBtn?"kd-consoleFunction-managebtn":"";s=r.hoverShowDeleteBtn?"kd-consoleFunction-managebtn":"";for(var l=0;l<this.data.length;l++){var d=this.data[l];t=$(kendo.format('<div id="{0}" class="{1}"></div>',d.id,this.isCard?"kd-comFunsCard-item":"kd-consoleFunction-subnav")),childDiv=$(kendo.format('<div  class="kd-consoleFunction-subchildnav"></div>')),e&&!this.isstdcommfun&&t.css("width",100/this.eachRowMaxItems+"%"),i=$(kendo.format('<a href="javascript:void(0);" class="kd-consoleFunction-btn {1}" title="{0}"></a>',d.description,s)),d.thumbnailname&&d.thumbnailname.length>0&&(o=d.thumbnailname.indexOf("\\")>=0||d.thumbnailname.indexOf("/")>=0?d.thumbnailname:"../images/biz/default/FunctionGroup/Html5/"+d.thumbnailname+".png"),this.isCard?o="../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/"+d.icon+".png":this.isSmartCard&&(o="../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/SmartCommFuncCard/"+d.icon+".png");var c="";KD.isEmpty(this.iconHeight)||(c=kendo.format("{0} height: {1};",c,this.iconHeight)),KD.isEmpty(this.iconWidth)||(c=kendo.format("{0} width: {1};",c,this.iconWidth)),a=$(kendo.format('<span><img src="{0}" style="{1}"></span>',o?o:this.defaultImg,c)),n=$(kendo.format(' <span class="{1}">{0}</span>',d.text,this.isCard?"kd-funcText-color":"kendo-color")),curItemDel=$(kendo.format('<div class="{0}" title="'+ResManager.LoadKDString("点击删除此项","0991733000003978")+'"><img src="../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/delete.png"><div>',this.isCard?"kd-consoleFunctionCard-del":"kd-consoleFunction-del")),i.append(a).append(n),0!=d.enabelDel&&i.append(curItemDel),t.append(childDiv.append(i)),a.click(function(e){r.openFormClick.call(r,this,e)}),n.click(function(e){r.openFormClick.call(r,this,e)}),curItemDel.click(function(e){r.deleteItemClick.call(r,e)}),this.component.append(t)}},_createPlatCommFuncItems:function(e){for(var t,i,a=this,n=0;n<this.data.length;n++){var o=this.data[n];t=KD.isIeBrowser()?$(kendo.format('<div id="{0}" class="{1}" style="height:2.38em; margin-left: 10px;"></div>',o.id,"kd-consoleFunction-subnav")):$(kendo.format('<div id="{0}" class="{1}" style="height:2.38em"></div>',o.id,"kd-consoleFunction-subnav")),childDiv=$(kendo.format('<div class="kd-consoleFunction-subchildnav kd-appConsoleFunction-subchildnav"></div>')),i=$(kendo.format('<div href="javascript:void(0);" class="kd-appPlat-funcText" title="{0}">{1}</div>',o.description,o.description)),curItemDel=$(kendo.format('<div class="{0}" title="'+ResManager.LoadKDString("点击删除此项","0991733000003978")+'"><img src="../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/delete.png"><div>',"kd-appPlatFunctionCard-del")),t.append(childDiv.append(i).append(curItemDel)),a.readOnlyForAooPlat?t.append(childDiv.append(i)):t.append(childDiv.append(i).append(curItemDel)),this.component.append(t),e&&(curItemDivWidth=this.component.width()/this.eachRowMaxItems,curItemDivWidth>=childDiv.width()?t.css("width",curItemDivWidth+"px"):t.css("width",childDiv.width()+"px")),this.isshow&&curItemDel.show(),childDiv.click(function(e){a.openFormClick.call(a,this,e)}),curItemDel.click(function(e){a.deleteItemClick.call(a,e)})}},_createNullDom:function(){var e,t,i,a,n=this,o={};o={},o.id="noOftenFunctionDefaultId",o.index=0,this.defaultItems.push(o),e=$(kendo.format('<div id="{0}" class="kd-noConsoleFunction-nav"></div>',"noOftenFunctionDefaultId")),childDiv=$(kendo.format('<div  class="kd-noConsoleFunction-subchildnav"></div>')),t=$(kendo.format('<a href="javascript:void(0);" class="kd-noConsoleFunction-btn" title="{1}">{0}</a>',ResManager.LoadKDString("立即添加","0991733000006715"))),i=$(kendo.format('<span class="kd-noConsoleFunction-img" ><img src="{0}"></span>',this.noOftenFunction)),a=$(kendo.format(' <span class="kendo-color">{0}</span>',ResManager.LoadKDString("暂无内容","0991733000006716"))),childDiv.append(i).append(a).append(t),e.append(childDiv),t.click(function(e){var t=$(this).closest(".kd-noConsoleFunction-nav").attr("id");n._addFunction(t)}),this.component.append(e)},_openForm:function(e){var t=this,i=t._getCurrentItem(e);if(i){var a=t.getFormProxy();a.lockControl.call(a,t),a.fireEvent.call(a,"NaviOperAction",t.naviOperActionArgs.ClickOper,"FNAVIBAR",i.index,i.key,null,null)}},_createDefaultItem:function(e,t,i,a){var n,o,r,s,l=this,d={};if(this.data.length<this.oftenFunsMaxNum){d={},d.id="defaultId0",d.index=0,this.defaultItems.push(d),n=$(kendo.format('<div id="{0}" class="{1} kd-comFunsCard-item-add"></div>',"defaultId0",this.isCard?"kd-comFunsCard-item":"kd-consoleFunction-subnav")),childDiv=$(kendo.format('<div  class="kd-consoleFunction-subchildnav"></div>')),i&&!this.isstdcommfun&&n.css("width",100/this.eachRowMaxItems+"%"),o=$(kendo.format('<a href="javascript:void(0);" class="kd-consoleFunction-btn" title="{0}"></a>',ResManager.LoadKDString("点击添加","0991733030034188")));var c=this.isCard?"kd-console-communfun-adddefaultimg":"";c=a?"kd-console-communfun-imgdefaultstyle":c;var h=this.isCard||a?this.cardAddPoint:this.unselectImg,u="";KD.isIeBrowser()&&a&&(u="kd-console-communfun-imgdefaultstyle-iebrowser"),r=$(kendo.format('<span class="kd-noConsoleFunction-img"><img src="{0}" class="{1} {2}"></span>',h,c,u)),s=$(kendo.format(' <span class="{1}" style="color:silver;">{0}</span>',ResManager.LoadKDString("点击添加","0991733030034188"),this.isCard?"kd-funcText-color":"kendo-color")),o.append(r).append(s),this.isCard&&s.css("display","none"),n.append(childDiv.append(o)),r.click(function(e){var t=$(this).closest(".kd-consoleFunction-subnav").attr("id");if(l.isCard)var t=$(this).closest(".kd-comFunsCard-item").attr("id");l._addFunction(t)}),s.click(function(e){var t=$(this).closest(".kd-consoleFunction-subnav").attr("id");if(l.isCard)var t=$(this).closest(".kd-comFunsCard-item").attr("id");l._addFunction(t)}),this.component.append(n)}},_createAppPlatDefaultItem:function(e,t,i){var a,n,o=this,r={};this.data&&(r.id="defaultId0",r.index=0,this.defaultItems.push(r),a=$(kendo.format('<div id="{0}" class="{1}" style="height:3em"></div>',"defaultId0","kd-consoleFunction-subnav")),childDiv=$(kendo.format('<div class="kd-consoleFunction-subchildnav kd-appConsoleFunction-subchildnav"></div>')),i&&a.css("width",100/this.eachRowMaxItems+"%"),n=$(kendo.format('<div style="color: #3880FF;" href="javascript:void(0);" class="kd-appPlat-funcText" title="">'+ResManager.LoadKDString("+添加常用","0991733000008898")+"</div>")),a.append(childDiv.append(n)),n.click(function(e){var t=$(this).closest(".kd-consoleFunction-subnav").attr("id");o._addFunction(t)}),o.readOnlyForAooPlat||this.component.append(a))},_addFunction:function(e){var t=this,i=t._getCurrentDefaultItem(e);if(i){var a=t.getFormProxy();a.lockControl.call(a,t),a.fireEvent.call(a,"NaviOperAction",t.naviOperActionArgs.NewOper,"FNAVIBAR",i.index,null,null,null)}},_getCurrentDefaultItem:function(e){for(var t in this.defaultItems)if(this.defaultItems[t].id==e)return this.defaultItems[t].index=t,this.defaultItems[t]},_getCurrentItem:function(e){var t,i=0;for(var a in this.data){if(KD.isRunInForIn(a,this.data)&&(t=this.data[a]||{},t.orderNumber=t.orderNumber||i,t.id==e))return t.index=a,t;i++}},_showMoreItem:function(e){this.showMoreBtn&&(e?(this.showMoreBtn.attr("title",this.hiddenMoreItemTitle),this.showMoreBtn.find(".kd-consoleFunction-arrow").removeClass("kd-consoleFunction-arrow-down").addClass("kd-consoleFunction-arrow-up")):(this.showMoreBtn.attr("title",this.showMoreItemTitle),this.showMoreBtn.find(".kd-consoleFunction-arrow").removeClass("kd-consoleFunction-arrow-up").addClass("kd-consoleFunction-arrow-down"))),this._changeSize(e),KD.storage.setItem(this.storageName,this.isShowMore||!1)},_changeSize:function(e){var t=this;this.isShowMore=e,e&&(this.maxHeight=0==this.data.length?this.defaultHeight:this.itemRowsCount*(this.eachRowHeight+.15)),t._changeSizeDetail(t.isShowMore)},_changeSizeDetail:function(e){this.currentHeight=this.defaultHeight,e?this.currentHeight=this.maxHeight:this.itemRowsCount<=this.defaultShowRows&&this.showMoreBtn&&this.showMoreBtn.css("visibility","hidden"),this.el.css({height:"auto"}),this.lastHeight=this.lastHeight?this.lastHeight:this.defaultHeight;var t=100*((this.itemRowsCount||4)-this.defaultShowRows);t=t>=500?t:500,this.isCard||this.isstdcommfun||this.component&&this.component.css({height:this.lastHeight+"em"}).animate({height:this.currentHeight+"em"},t),this.lastHeight=this.currentHeight},_changeSizeDetails:function(e){e?this.currentHeight/10==this.maxHeight?clearInterval(this.inderval):(this.currentHeight/10>this.maxHeight&&(this.currentHeight=10*this.maxHeight-2),this.currentHeight+=2,this.component.css("height",this.currentHeight/10+"em"),this.el.css("height",this.currentHeight/10+1+1.5+"em")):this.currentHeight/10==this.defaultHeight?(clearInterval(this.inderval),this.itemRowsCount<=2&&this.showMoreBtn&&this.showMoreBtn.css("visibility","hidden")):(this.currentHeight/10<this.defaultHeight&&(this.currentHeight=10*this.defaultHeight+2),this.currentHeight-=2,this.component.css("height",this.currentHeight/10+"em"),this.el.css("height",this.currentHeight/10+1+1.5+"em"))},release:function(){KDNaviBarProxy.superclass.release.call(this)},setEditCardInfo:function(e){"delete"==e&&($(".kd-consoleFunction-del",this.el).css("display","block"),$(".kd-consoleFunctionCard-del",this.el).css("display","block"),$(".kd-appPlatFunctionCard-del",this.el).show()),this.enableDrapSort(!1,!0)},setIsAllowDragSort:function(e){this.isAllowDragSort=e},releaseDragSort:function(){if(this.component){var e=this.component.data("kendoSortable");e&&e.destroy()}},enableDrapSort:function(e,t){if(this.isAllowDragSort&&this.component)if(e){this.isDragSortMode=!0;var i=this._getDrapSortOptions();this.component.kendoSortable(i)}else if(this.isDragSortMode=!1,t){var a=this.component.data("kendoSortable");a&&a.destroy&&a.destroy()}},_getDrapSortOptions:function(){var e=this,t={filter:".kd-consoleFunction-subnav:not(.kd-comFunsCard-item-add)",autoScroll:!0,start:function(t){0==e.isInsertDragModel&&KD.delayInvoke(function(e){$(e).show()},void 0,void 0,t.item),0==e.isDragSortMode&&t.preventDefault()},move:function(t){if(0==e.isInsertDragModel){var i=$(t.item);i.show(),$(this.element).find(".kd-consoleFunction-subnav").css({opacity:"1"}).removeClass("kd-consoleFunction-subnav-dragdock"),$(t.target).css({opacity:"0.5"}).addClass("kd-consoleFunction-subnav-dragdock")}},end:function(t){if(0==e.isInsertDragModel){$(this.element).find(".kd-consoleFunction-subnav").css({opacity:"1"});var i=$(this.element).find(".kd-consoleFunction-subnav.kd-consoleFunction-subnav-dragdock");i.removeClass("kd-consoleFunction-subnav-dragdock"),t.dragDockElement=i,e._changeIndexOper.call(e,t)}},change:function(t){e.isInsertDragModel&&e._changeIndexOper.call(e,t)},cancel:function(e){}};return 0==e.isInsertDragModel&&(t.container=this.el.find(".kd-consoleFunction-panel"),t.placeholder=function(e){return $(e).clone().css({width:"0px",overflow:"hidden"})}),t},_changeIndexOper:function(e){if(this.data&&e){var t,i,a=this,n=a.naviOperActionArgs.ChangeIndexOper;if(0==a.isInsertDragModel?(n=a.naviOperActionArgs.ChangeIndexOper,t=this._getCurrentItem($(e.dragDockElement).attr("id")),i=this._getCurrentItem($(e.item).attr("id"))):(n=a.naviOperActionArgs.ChangeIndexRangeOper,t=this.data[e.newIndex],i=this.data[e.oldIndex],t.orderNumber=t.orderNumber||e.newIndex,i.orderNumber=i.orderNumber||e.oldIndex),t&&i&&t.id!=i.id){var o={},r=i.id+" ",s=t.id+" ";o[r]=parseInt(t.orderNumber)+1,o[s]=parseInt(i.orderNumber)+1;var l=a.getFormProxy();l.lockControl.call(l,a),l.fireEvent.call(l,"NaviOperAction",n,"FNAVIBAR",-1,"",o,null)}}}}),KDControlFactoryProxy.registerType("navibar",KDNaviBarProxy),KDControlFactoryProxy.registerType("kdcardnavibar",KDNaviBarProxy),KDCompanyNewsProxy=KD.extend(KDControlProxy,{rowHeight:105,imageWidth:80,imageHeight:80,companyNewsDefaultImage:"../images/biz/default/MainConsole/H5CardLayout/icon_card_companynew_defaultimg.png",loadConfig:function(e){KDCompanyNewsProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDCompanyNewsProxy.superclass.initComponent.call(this),this.component=$("<div>").appendTo(this.el)},setData:function(e){this.rowHeight=e.rowHeight||this.rowHeight,this.imageWidth=e.imageWidth||this.imageWidth,this.imageHeight=e.imageHeight||this.imageHeight,this.GenItems(e)},GenItems:function(e){if(this.component&&e){var t=this;t.component.empty();var i=e.items;i=this._generalDataSource(i);var a=t.component.find("kd-company-news-list");0==a.length&&(a=$('<div unselectable="on" class="kd-company-news-list"></div>').appendTo(t.component));var n=t._getItemTemplate();a.kendoListView({dataSource:i,template:n,autoBind:!0,selectable:!0,navigatable:!0,change:function(e){t._itemClick.call(t,e)}}),KD.isEmpty(i)?t.setNodataTipsVisible(!0):t.setNodataTipsVisible(!1)}},_generalDataSource:function(e){if(!e)return[];for(var t=[],i={},a=0;a<e.length;a++){var n=e[a];i={},i.id=n.id||"",i.key=n.key||"",i.text=n.text||"",i.description=n.description||"",i.focusshowmodel=n.key||"",i.index=n.index||"",i.imgurl=this._getImageUrl(n.imgurl||this.companyNewsDefaultImage),i.author=n.author||"",i.stylekey=n.stylekey||"",a==e.length-1&&(i.stylekey=i.stylekey+" kd-item-last"),t.push(i)}return t},_getItemTemplate:function(){var e="",t=14,i=26,a=(this.component.width()||this.el.width())-this.imageWidth-t-i;return e=kendo.format('<div class="kd-company-news-item-container {10}" data-id="{0}" data-key="{1}" style="height:{6}px;"><img class="kd-item kd-img-log" src="{2}" style="width:{7}px;height:{11}px;"><div class="kd-item-text-container" style="left:{8}px;width:{9}px;"><div class="kd-item kd-title" title="{3}">{3}</div><div class="kd-item kd-desc" title="{4}">{4}</div><div class="kd-item kd-author">{5}</div></div></div>',"#:id #","#:key #","#:imgurl #","#:text #","#:description #","#:author #",this.rowHeight,this.imageWidth,this.imageWidth+t,a,"#:stylekey #",this.imageHeight)},_getImageUrl:function(e){var t="";return t=KD.isUrl(e)?e:this.isPicture(e)?~e.indexOf("../")?e:"../"+e:"data:image/jpeg;base64,"+e},isPicture:function(e){var t=".jpeg|.gif|.jpg|.png|.bmp|.pic|.ico|";if(e.indexOf(".")>-1){var i=e.lastIndexOf("."),a=e.substring(i,this.length)+"|";if(a=a.toLowerCase(),t.indexOf(a)>-1)return!0}return!1},_itemClick:function(e,t){if(e&&e.sender){var i=e.sender.dataItem(e.sender.current())||{},a=this.getFormProxy();a&&a.fireEvent.call(a,"ButtonClick",i.key,i.id,null)}},setNodataTipsVisible:function(e){if(!KD.isEmpty(e)){var t=ResManager.LoadKDString("很抱歉，暂时没有相关数据~","0141072000005298"),i=!1;if(KD.isObject(e)?(t=e.text||t,i=e.visible):i=e,!this.NodataTips){var a=kendo.format('<div class="chart-nodata" style=" padding-top: 0px;"><img src="{0}" onerror="this.onerror=null;this.src=&quot;{0}&quot;"><p>{1}</p></div>',"../images/biz/default/MainConsole/H5CardLayout/icon_task_NoData.png",t);this.NodataTips=$(a),this.el.append(this.NodataTips)}i?(this.NodataTips.show(),this.component&&this.component.hide()):(this.NodataTips.hide(),this.component&&this.component.show())}}}),KDControlFactoryProxy.registerType("companynews",KDCompanyNewsProxy),KDWorFlowApproveProxy=KD.extend(KDCompanyNewsProxy,{rowHeight:100,data:[],NodataTips:null,naviOperActionArgs:{ClickOper:"Click",DelOper:"Del",EditOper:"Edit",NewOper:"New"},initComponent:function(){KDWorFlowApproveProxy.superclass.initComponent.call(this),this.component=$('<div class="kd-agencytask-card-list kd-workflowapprove-list"></div>').appendTo(this.el)},loadConfig:function(e){KDWorFlowApproveProxy.superclass.loadConfig.call(this,e),this.NodataTips=null,this.data=[]},GenItems:function(e){if(this.component&&e){var t=this;t.component.empty();var i=e.items;this.data=i,this._generalDataSource(i,!0),KD.isEmpty(i)?t.setNodataTipsVisible(!0):t.setNodataTipsVisible(!1)}},_generalDataSource:function(e,t){var i=this;e.length;if(!e)return[];var a=[],n={},o=ResManager.LoadKDString("审批记录","00210735000023362"),r=kendo.format('<div class="kd-allapprove-container"><span class="kd-approvecntTitle">'+o+':</span><div class="kd-approvalMessage"></div></div>');this.component.append(r);for(var s in e)if(KD.isRunInForIn(s,e)){var l,d=e[s],c=0,h="";if(KD.isEmpty(d))continue;if(e&&e[s]&&e[s].approvalstatus){KD.getImageUrlByNameAndVersion("kd_icon_extend.png");if(l=this._createStateItem(e[s].approvalstatus,s,e.length),n={},n=i._setItemObj(d,s),a.push(n),n.chidren&&n.chidren.length&&(c=n.chidren.length),t){if(null!=n.chidren){var u=n.chidren;h+=this._createExistChildrenObjItem(u,c,l)}else h+=this._createItem(n,l);var p=s;i._attachmentAdd(n,h,p)}}}return this.component.find(".kd-approve-preview").click(function(e){var t=$(this).attr("attachmentname"),a=$(this).attr("attachmentsize"),n=$(this).attr("key"),o={};o.FileInfos=[],o.FileInfos.push({FileName:t,FileSize:a,Key:n});var r=i.getFormProxy();r&&r.fireCustomEvents.call(r,i.getKey(),"FilePreview",KD.stringify(o))}),this.component.find(".kd-approve-download").click(function(e){var t=$(this).attr("attachmentname"),a=$(this).attr("attachmentsize"),n=$(this).attr("key"),o={};o.FileInfos=[],o.FileInfos.push({FileName:t,FileSize:a,Key:n});var r=i.getFormProxy();r&&r.fireCustomEvents.call(r,i.getKey(),"FileDownland",KD.stringify(o))}),this.component.find(".kd-attachshowBtn-container").click(function(){var e=$(this).attr("datakey");i.component.find(".kd-allatthideshow[datakey="+e+"]").toggle()}),a},_setItemObj:function(e,t){return dataobj={},dataobj.key=e.key||"",dataobj.index=t,dataobj.approvalstatus=e.approvalstatus||"",dataobj.nodename=e.nodename||"",dataobj.comments=e.comments||"",dataobj.opinion=e.opinion||"",dataobj.approver=e.approver||"",dataobj.icon=e.icon||"",dataobj.time=e.time||"",dataobj.chidren=e.chidren||null,dataobj.attach=e.attach||null,dataobj},_createExistChildrenObjItem:function(e,t,i){var a=this,i=i,n="";if(this.component&&e){for(var o=0;o<e.length;o++){var r=e[o],s=a._createTemplate(r),l=kendo.format('<span class="kd-approve-splitLine"></span>');n+=s,o<e.length-1&&(n+=l)}var d=kendo.format('<div class="kd-messageBox">{1}<div class="kd-arrowhead-container"><div class="kd-arrowhead"><div class="kd-arrowheadCover"></div></div></div><div class="kd-approveMessage-container"><div class="kd-childrenApprove-container">{0}</div></div></div>',n,i);return d}},_createItem:function(e,t){var i=this,t=t;if(this.component&&e){var a=i._createTemplate(e),n=kendo.format('<div class="kd-messageBox">{1}<div class="kd-arrowhead-container"><div class="kd-arrowhead"><div class="kd-arrowheadCover"></div></div></div><div class="kd-approveMessage-container">{0}</div></div>',a,t);return n}},_createStateItem:function(e,t,i){var e=e,t=t,i=i,a="",n=KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),o="",r='<div class="kd-approve-straightLineBefore"></div>',s='<div class="kd-approve-straightLineAfter"></div>',l="",d="";switch(KD.isIeBrowser()&&(r="",s="",o="kd-singleStateShowIsIE",l="kd-approvalStatusContainerisIE"),0==t?r='<div class="kd-approve-straightLineBefInvisible"></div>':t==i-1&&(s='<div class="kd-approve-straightLineAftInvisible"></div>'),e){case"Consent":d="kd-consentIcon";break;case"Idled":d="kd-idledIcon";break;case"Failure":d="kd-failureIcon";break;case"Reject":d="kd-rejectIcon";break;case"Prediction":d="kd-predictionIcon";break;case"Abort":d="kd-abortIcon"}return a='<div class="kd-approvalStatusContainer '+l+'">'+r+'<div class="kd-singleStateShow '+o+'"><div class=""><a class="kd-approveIconCurrency '+d+'" style="background-image:url('+n+')"></a></div></div>'+s+"</div>"},_createTemplate:function(e){if(!KD.isEmpty(e)){var t="",i="",a="",n="";if(KD.isIeBrowser()&&(a="kd-approve-commentsisIe",n="kd-approveComments-container-isIe"),KD.isEmpty(e.icon))KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),t=kendo.format('<img style="width:100%;height:100%;border-radius: 50%;" src="{0}">',"../images/biz/default/MainConsole/person_default_headimage.png?version="+KD.getVersion());else{var o=e.icon;KD.isUrl(o)?t=kendo.format('<img style="width:100%;height:100%;border-radius: 50%;" src="{0}">',o):(o="data:image/jpeg;base64,"+o,t=kendo.format('<img style="width:100%;height:100%;border-radius: 50%;" src="{0}">',o));
}null!=e.time&&""!=e.time&&(i=kendo.format('<span class="kd-approve-datetext" title="{0}">{0}</span>',KD.htmlUtil.encode(null!=e.time&&""!=e.time?e.time:"")));var r=kendo.format('<div class="kd-approverIcon-container"><span class="kd-approverIcon">{5}</span></div><div class="kd-eachapprovalMsg"><span class="kd-approve-maintext" title="{1}{2}{3}">{1} {2} {3}</span><div class="kd-approveComments-container '+n+'"><span class="kd-approve-comments '+a+'" title="{4}">{4}</span></div>{6}</div>',e.key,KD.htmlUtil.encode(null!=e.nodename&&""!=e.nodename?e.nodename:""),KD.htmlUtil.encode(null!=e.approver&&""!=e.approver?e.approver:""),KD.htmlUtil.encode(null!=e.opinion&&""!=e.opinion?e.opinion:""),KD.htmlUtil.encode(e.comments),t,i);return r}},_attachmentAdd:function(e,t,i){var e=e,t=t,i=i,a="",n="",o="",r=i,s="",l="kd-attachmentoperation",d=KD.getImageUrlByNameAndVersion("kd_icon_extend.png");if(KD.isIeBrowser()&&(s="kd-attachshowBtnisIe-container",l="kd-attachmentoperation-ie"),e.attach&&0!=e.attach.length){var c,h=e.attach.length,u=ResManager.LoadKDString("预览","002014030031191"),p=ResManager.LoadKDString("下载","002014000005885"),g=ResManager.LoadKDString("附件","002014000005886"),f=kendo.format('<span class="kd-approve-splitLine"></span>'),m=kendo.format('<div class="kd-attachtitlecnt"><span class="kd-attachcontainer-title">'+g+'({0})</span><a class="kd-attach-downloadicon" style="background-image:url('+d+')"></a></div>',h);o=kendo.format('<div class="kd-attachshowBtn-container '+s+'" datakey="{0}"><span class="kd-attachmentfont">'+g+'</span><span class="kd-attachdownBtn"></span></div>',r);for(var v=0;h>v;v++){var y=KD.htmlUtil.encode(e.attach[v].attachmentname);c=e.attach[v].attachmentsize&&KD.htmlUtil.encode((e.attach[v].attachmentsize/1024).toFixed(1))>0?KD.htmlUtil.encode((e.attach[v].attachmentsize/1024).toFixed(1))+"M":KD.htmlUtil.encode(e.attach[v].attachmentsize)+"KB";var b=kendo.format('<a class="kd-approve-preview" attachmentname="{0}" attachmentsize="{1}" key="{2}">'+u+"</a>",y,c,e.attach[v].key),D=kendo.format('<a class="kd-approve-download" attachmentname="{0}" attachmentsize="{1}" key="{2}">'+p+"</a>",y,c,e.attach[v].key),k=kendo.format('<div class="kd-attachContainer" key="{2}"><div class="kd-attachmessage"><a class="kd-attachIcon" style="background-image:url('+d+')"></a><span class="kd-attachmentname" title="{0}">{0}</span><span class="kd-attachmentsize" title="{1}">({1})</span></div><div class="'+l+'">{3}{4}</div></div>',y,c,e.attach[v].key,b,D);a+=k}var n=kendo.format('<div class="kd-allatthideshow" datakey="{3}"><div class="kd-allattcontainer">{2}{0}{1}</div><div>',m,a,f,r)}var C=this.component.find(".kd-approvalMessage");C.append(t);var x=this.component.find(".kd-approveMessage-container");e.attach&&0!=e.attach.length&&""!=n&&($(x[i]).append(o),$(x[i]).append(n),e.chidren&&e.chidren.length>0&&$(this.component.find(".kd-attachshowBtn-container")).css("bottom","28px"))}}),KDControlFactoryProxy.registerType("workflowapprove",KDWorFlowApproveProxy),KDAgencyTaskProxy=KD.extend(KDCompanyNewsProxy,{rowHeight:100,data:[],NodataTips:null,IsProcessBtnVisible:!0,naviOperActionArgs:{ClickOper:"Click",DelOper:"Del",EditOper:"Edit",NewOper:"New"},initComponent:function(){KDAgencyTaskProxy.superclass.initComponent.call(this),this.component=$('<div class="kd-agencytask-card-list"/>').appendTo(this.el)},loadConfig:function(e){KDAgencyTaskProxy.superclass.loadConfig.call(this,e),this.NodataTips=null,this.data=[],this.IsProcessBtnVisible=KD.getValue(this.config,"isprocessbtnvisible",!0)},GenItems:function(e){if(this.component&&e){var t=this;t.component.empty();var i=e.items;this.data=i=this._generalDataSource(i,!0),KD.isEmpty(i)?t.setNodataTipsVisible(!0):t.setNodataTipsVisible(!1)}},_generalDataSource:function(e,t){if(!e)return[];for(var i=[],a={},n=0;n<e.length;n++){var o=e[n];KD.isEmpty(o)||(a={},a.key=o.key,a.index=n,a.title=o.title,a.author=o.author,a.createtime=o.createtime,a.content=o.content,a.icon=o.icon||"",a.warntype=o.warntype||"",a.processbtncontent=o.processbtncontent||ResManager.LoadKDString("处理","0991733000003974"),a.processbtnvisibility=KD.isEmpty(o.processbtnvisibility)||0!=o.processbtnvisibility?!0:!1,i.push(a),t&&this._createItem(a))}return i},_createItem:function(e){var t=this;if(this.component&&e){var i="",a=0==this.IsProcessBtnVisible?!1:e.processbtnvisibility,n=kendo.format('<div class="kd-agencytask-processbtn" style="display:{2}" data-key="{1}">{0}</div>',e.processbtncontent,e.key,a?"block":"none");KD.IsNullOrWhiteSpace(e.warntype)||(n=kendo.format('<span class="kd-warningtype" style="float:right">{0}</span>',KD.htmlUtil.encode(e.warntype))),i=kendo.format('<div class="kd-agencytask-card-item-container" data-key="{0}"><div><div class="kd-item-content-left"><div class="kd-item kd-title" data-key="{0}" data-role="title"></div></div><div class="kd-item-content-right">{6}</div></div><div class="kd-item kd-desc"  data-key="{0}" data-role="content"></div><div class="kd-item-author-container"><div class="kd-item kd-author"  data-key="{0}" data-role="author" title=""></div><div class="kd-item kd-time"  data-key="{0}" data-role="createtime" title=""></div></div></div>',e.key,e.title,e.content,e.author,e.createtime,e.warntype,n);var o=$(i);this.component.append(o),t._bindField(o,e),o.find(".kd-title").click(function(){var e=$(this).attr("data-key"),i=$(this).attr("data-role");t._itemClick.call(t,e,i)}),o.find(".kd-agencytask-processbtn").click(function(){var e=$(this).attr("data-key"),i="process";t._itemClick.call(t,e,i)})}},_bindField:function(e,t){e.find(".kd-title").text(t.title),e.find(".kd-title").attr("title",t.title),e.find(".kd-desc").text(t.content),e.find(".kd-desc").attr("title",t.content),e.find(".kd-author").text(t.author),e.find(".kd-author").attr("title",t.author),e.find(".kd-time").text(t.createtime),e.find(".kd-time").attr("title",t.createtime),KD.IsNullOrWhiteSpace(t.warntype)||e.find(".kd-warningtype").text(t.warntype)},_itemClick:function(e,t){var i=this,a=i._getCurrentItem(e);if(!KD.isEmpty(a)){var n=i.getFormProxy();n.lockControl.call(n,i);var o={};o.btnkey=t,n.fireEvent.call(n,"NaviOperAction",i.naviOperActionArgs.ClickOper,this.getKey(),a.index,a.key,o)}},_getCurrentItem:function(e){for(var t={},i=0;i<this.data.length;i++){var a=this.data[i];if(a.key==e){t=a;break}}return t}}),KDControlFactoryProxy.registerType("agencytask",KDAgencyTaskProxy),KDNavGroupCardProxy=KD.extend(KDAgencyTaskProxy,{displayColumnNum:2,data:[],allfuncdata:[],setData:function(e){this.GenItems(e)},initComponent:function(){KDNavGroupCardProxy.superclass.initComponent.call(this),this.component=$('<div class="kd-agencytask-card-list kd-navgroupcard-card-list"/>').appendTo(this.el)},GenItems:function(e){if(this.component&&e){var t=this;t.component.empty();var i=e.items;this.data=i=this._generalDataSource(i,!0),!KD.isEmpty(i)&&t.allfuncdata&&t.allfuncdata.length>0?t.setNodataTipsVisible(!1):t.setNodataTipsVisible(!0)}},loadConfig:function(e){KDNavGroupCardProxy.superclass.loadConfig.call(this,e),this.displayColumnNum=KD.getValue(this.config,"discolumnnum",2),this.NodataTips=null,this.data=[]},_generalDataSource:function(e,t){var i=this;if(this.allfuncdata=[],!e)return[];for(var a=0;a<e.length;a++){var n=e[a];t&&(this._createItem(n),this.component.find(".kd-row-item").off("click").on("click",function(e){i._onItemClick.call(i,e)}),this.el.css({height:"auto"}))}return e},_onItemClick:function(e){var t=this._getCurrentItem($(e.currentTarget).attr("data-id")),i=this.getFormProxy();i.lockControl.call(i,$this);var a={};a.btnkey="item",i.fireEvent.call(i,"NaviOperAction",this.naviOperActionArgs.ClickOper,this.getKey(),t.index,t.key,a,null)},_createItem:function(e){if(this.component&&e){var t=kendo.format('<div class="kd-navgroupcard-card-grouptitle"><span class="" title="{0}" style="cursor:default">{0}</span></div>',KD.htmlUtil.encode(e.text));if(this.component.append($(t)),e.item)for(var i=0;i<e.item.length;i++){for(var a="<div class='kd-navgroupcard-card-row'>",n=i;n<i+this.displayColumnNum&&!(n>=e.item.length);n++){var o=e.item[n];this.allfuncdata.push(o),a+=kendo.format("<span data-id={1} class='kd-row-item' title='{0}'>{0}</span>",KD.htmlUtil.encode(o.text),KD.getValue(o,"id",""))}i=n-1,a+="</div>",this.component.append($(a))}}},_getCurrentItem:function(e){var t,i=0;for(var a in this.allfuncdata){if(KD.isRunInForIn(a,this.allfuncdata)&&(t=this.allfuncdata[a]||{},t.orderNumber=i,t.id==e))return t.index=a,t;i++}},doLayout:function(){KDNaviBarProxy.superclass.doLayout.call(this),this.el.css({height:"auto"})}}),KDControlFactoryProxy.registerType("navgroupcard",KDNavGroupCardProxy),KDBillListCardProxy=KD.extend(KDAgencyTaskProxy,{rowHeight:84,data:[],NodataTips:null,fieldsCount:5,maxRowCount:6,displayShortCutBtn:void 0,setData:function(e){this.fieldsCount=e.fieldsCount||this.fieldsCount,this.GenItems(e)},initComponent:function(){KDBillListCardProxy.superclass.initComponent.call(this),this.component=$('<div class="kd-agencytask-card-list kd-billlist-card-list"/>').appendTo(this.el)},loadConfig:function(e){KDBillListCardProxy.superclass.loadConfig.call(this,e),this.maxRowCount=KD.getValue(this.config,"maxrowcount",6),this.NodataTips=null,this.data=[]},setMaxRowCount:function(e){var t=parseInt(e);KD.isNaN(t)||(this.maxRowCount=t)},setDisplayShortCutBtn:function(e){KD.isEmpty(e)||(this.displayShortCutBtn=e)},GenItems:function(e){if(this.component&&e){var t=this;t.component.empty(),this.setMaxRowCount(e.maxRowCount),this.setDisplayShortCutBtn(e.isDisplayShortCutBtn);var i=e.items;this.data=i=this._generalDataSource(i,!0),KD.isEmpty(i)?t.setNodataTipsVisible(!0):t.setNodataTipsVisible(!1)}},_generalDataSource:function(e,t){if(!e)return[];var i=[],a={},n=this.maxRowCount,o="none",r="none",s="none";this.fieldsCount>5&&this.fieldsCount<=7?o="block":this.fieldsCount>7&&this.fieldsCount<=9?(o="block",r="block"):this.fieldsCount>9&&(o="block",r="block",row6Visible="block");for(var l=0;n>l;l++){var d=e[l];if(!KD.isEmpty(d)){a={},a.key=d.PkName,a.index=l;for(var c="field",h=0;h<this.fieldsCount;h++){var u=c+(h+1).toString(),p=this._getItemDataObject(d[u]);a[u]=p}i.push(a),t&&this._createItem(a,o,r,s)}}return i},_getItemDataObject:function(e){var t=KD.isEmpty(e)?{}:KD.parseObject(e);return t},_createItem:function(e,t,i,a){function n(e){var t=$(this);if(!t.hasClass("kd-title-billlisttitle")||o.displayShortCutBtn){var i=t.parent(),a=i.attr("data-key"),n=t.attr("data-role");o._itemClick.call(o,a,n)}}var o=this;if(this.component&&e){var r=kendo.format('<span class="kd-billlist-fieldtitle"></span><span class="kd-billlist-fieldcontent"></span></span>'),s=r;this.displayShortCutBtn&&(s=kendo.format('<div class="kd-agencytask-processbtn"  data-key="{1}">{0}</div>',ResManager.LoadKDString("处理","0991733000003974"),e.key));var l="";l=kendo.format('<div class="kd-agencytask-card-item-container" data-key="{0}" style="min-height:{1}px;"><div class="kd-item kd-title" data-key="{0}"><span class="kd-title-billlist kd-billlist-field1" data-role="field1" title="">{5}</span><span class="kd-title-billlisttitle kd-billlist-field4" data-role="field4" title="">{6}</span></div><div class="kd-item kd-desc"  data-key="{0}"><span class="kd-billlist-content kd-billlist-field2" data-role="field2" title="">{5}</span></div><div class="kd-item-author-container"><div class="kd-item kd-author kd-billlist-field3" data-key="{0}" data-role="field3" title="">{5}</div><div class="kd-item kd-time kd-billlist-field5"  data-key="{0}" data-role="field5" title="">{5}</div></div><div style="display:{2}" class="kd-item-author-container"><div class="kd-item kd-author kd-billlist-field6" data-role="field6" title="">{5}</div><div class="kd-item kd-time kd-billlist-field7" data-role="field7" title="">{5}</div></div><div style="display:{3}" class="kd-item-author-container"><div class="kd-item kd-author kd-billlist-field8" data-role="field8" title="">{5}</div><div class="kd-item kd-time kd-billlist-field9" data-role="field9" title="">{5}</div></div><div style="display:{4}" class="kd-item-author-container"><div class="kd-item kd-author kd-billlist-field10" data-role="field10" title=""></div></div></div>',e.key,o.rowHeight,t,i,a,r,s);var d=$(l);this.component.append(d),o._bindField(d,e),d.find(".kd-title-billlist,.kd-title-billlisttitle").click(KD.throttle(n,500))}},_bindField:function(e,t){for(var i,a,n,o,r=".kd-billlist-field",s="field",l=(kendo.format('<span class="kd-billlist-fieldname" title="{0}">{0}</span><span class="kd-billlist-fieldvalue" title="{1}">{1}</span>'),0);10>l;l++)i=r+(l+1).toString(),a=s+(l+1).toString(),n=t&&t[a]&&!KD.isEmpty(t[a].FieldName)?t[a].FieldName+":":"",o=t&&t[a]&&!KD.isEmpty(t[a].FieldValue)?t[a].FieldValue:"",e.find(i).find(".kd-billlist-fieldtitle").text(n),e.find(i).find(".kd-billlist-fieldcontent").text(o),e.find(i).find(".kd-billlist-fieldcontent").attr("title",o)}}),KDControlFactoryProxy.registerType("billlistcard",KDBillListCardProxy),KDMessageSimpleListProxy=KD.extend(KDAgencyTaskProxy,{rowHeight:48,initComponent:function(){KDMessageSimpleListProxy.superclass.initComponent.call(this),this.component.addClass("kd-message-card-simplelist")},loadConfig:function(e){KDMessageSimpleListProxy.superclass.loadConfig.call(this,e),this.NodataTips=null,this.data=[]},_generalDataSource:function(e,t){if(!e)return[];for(var i=[],a={},n=0;n<e.length;n++){var o=e[n];KD.isEmpty(o)||(a={},a.key=o.key,a.index=o.index||n,a.title=o.title,a.author=o.author,a.createtime=o.createtime,a.content=o.content,a.icon=this._getImageUrl(o.icon||""),a.handle=o.handle||"",KD.isObject(o.data)?(a.data=o.data.data,a.datacolor=o.data.color||"",a.datafontsize=o.data.fontsize||""):a.data=o.data||"",i.push(a),t&&this._createItem(a))}return i},_createItem:function(e){var t=this,i=0,a=0;if(this.component&&e){var n="";n=kendo.format('<div class="kd-agencytask-card-item-container kd-messagesimplelist-card-item-container" data-key="{0}" style="height:{6}px;"><div class="kd-item kd-icon"  data-key="{0}" data-role="title" style="background-image: url({1});"></div><div class="kd-item-container"><div class="kd-item kd-title"  data-key="{0}" data-role="title"  title="{2}" style="line-height:{6}px;" >{2}</div><div class="kd-item kd-data"  data-key="{0}" data-role="data" style="line-height:{6}px; color:{5};font-size:{7}" >({4})</div><div class="kd-item '+(KD.isEmpty(e.handle)?"":"kd-handle")+' "  data-key="{0}" data-role="handle" >{3}</div></div></div>',e.key,e.icon,e.title,e.handle,e.data,e.datacolor,t.rowHeight,e.datafontsize);var o=$(n);this.component.append(o),KD.isEmpty(e.handle)||(0>=a&&(i=o.find(".kd-handle").outerWidth(),a=o.find(".kd-item-container").width(),a-=i),o.find(".kd-item-container .kd-title").css({"max-width":a})),o.find(".kd-title").click(function(){var e=$(this).attr("data-key"),i=$(this).attr("data-role");t._itemClick.call(t,e,i)}),o.find(".kd-handle").click(function(){var e=$(this).attr("data-key"),i=$(this).attr("data-role");t._itemClick.call(t,e,i)}),o.find(".kd-data").click(function(){var e=$(this).attr("data-key"),i=$(this).attr("data-role");t._itemClick.call(t,e,i)})}}}),KDControlFactoryProxy.registerType("messagesimplelist",KDMessageSimpleListProxy),KDGuideCardProxy=KD.extend(KDAgencyTaskProxy,{rowHeight:96,initComponent:function(){KDGuideCardProxy.superclass.initComponent.call(this),this.component.addClass("kd-guide-card-simplelist")},loadConfig:function(e){KDGuideCardProxy.superclass.loadConfig.call(this,e),this.NodataTips=null,this.data=[]},GenItems:function(e){if(this.component&&e){var t=this;t.component.empty();var i=e;this.data=i=this._generalDataSource(i,!0),KD.isEmpty(i)?t.setNodataTipsVisible(!0):t.setNodataTipsVisible(!1)}},_generalDataSource:function(e,t){if(!e)return[];for(var i=[],a={},n=e.carddetail,o=0;o<n.length;o++){var r=n[o];if(!KD.isEmpty(r)){a={},a.id=r.id,a.steptype=r.steptype,a.detailtile=r.detailtile,a.formid=r.formid,a.content=r.content,a.helplink=r.helplink,a.link=r.link,a.icon=this._getImageUrl(r.icon||""),a.remark=r.remark||"",a.iconwidth=r.iconwidth||"",a.detailfuncid=r.detailfuncid||"",KD.isObject(r.data)?(a.data=r.data.data,a.datacolor=r.data.color||""):a.data=r.data||"",i.push(a);var s=n.length-1==o?!0:!1;t&&this._createItem(a,s)}}return n},_createItem:function(e,t){var i=this,a=0,n=0;if(this.component&&e){var o="",r=this.el.width()&&this.el.width()>0?this.el.width():0,s=!KD.IsNullOrWhiteSpace(e.iconwidth)&&r>0?r-e.iconwidth-28:300,l="",d="",c="",h="",u=e.helplink&&null!=e.helplink?KD.IsNullOrWhiteSpace(e.helplink)?"none":"inline-block":"none",p=KD.getImageUrlByNameAndVersion("kd_icon.png");if(!KD.IsNullOrWhiteSpace(e.steptype))switch(e.steptype.toString()){case"0":l="formicon",d="formspantitle",c="formbtnhelp",h="formhandle";break;case"1":l="linkicon",d="linkpantitle",c="linkbtnhelp",h="linkhandle";break;case"2":l="texticon",d="textpantitle",c="linkbtnhelp",h="linkhandle";break;default:l="texticon",d="textpantitle",c="linkbtnhelp",h="linkhandle"}var g=t?"kd-lastitem-container":"",f=KD.equalsIgnoreCase(e.steptype.toString(),"2")?"auto":"pointer";o=kendo.format('<div class="kd-smartguide-card-item-container" data-key="{0}" style="height:'+i.rowHeight+'px;"><div class="kd-item kd-icon"><div class="kd-guide-icon" data-key="{0}" data-formid="{3}" data-link="{4}" data-role="'+l+'" data-detailfuncid="{5}" style="background-image: url('+e.icon+');cursor:{6};"></div></div><div class="kd-item-container '+g+'" style="width:'+s+'px"><div class="kd-item kd-title" data-role="title"><div><span class="kd-span-title" title="{1}" data-formid="{3}" data-link="{4}" data-key="{0}" style="cursor:{6}" data-role="'+d+'" data-detailfuncid="{5}">{1}</span><span style="display:'+u+";background-image:url("+p+')" class="kd_guide_btnhelp" data-helplink="'+e.helplink+'" data-key="{0}" data-role="'+c+'" title="'+ResManager.LoadKDString("帮助链接","014003000005568")+'"></span></div></div><div class="kd-item kd-handle" data-key="{0}" data-role="'+h+'" data-formid="{3}" data-detailfuncid="{5}" data-link="{4}" title="{2}"><div><span style="cursor:{6}">{2}</span></div></div></div></div>',e.id,e.detailtile,e.remark,e.formid,e.link,e.detailfuncid,f);var m=$(o);this.component.append(m),KD.isEmpty(e.handle)||(0>=n&&(a=m.find(".kd-handle").outerWidth(),n=m.find(".kd-item-container").width(),n-=a),m.find(".kd-item-container .kd-title").css({"max-width":n})),m.find(".kd-guide-icon").click(function(){var e=$(this).attr("data-key"),t=$(this).attr("data-role"),a=$(this).attr("data-detailfuncid"),n=$(this).attr("data-link"),o=KD.equalsIgnoreCase(t,"formicon")?a:n;KD.equalsIgnoreCase(t,"formicon")&&!KD.IsNullOrWhiteSpace(a)?i._skipTo.call(i,e,t,o):KD.IsNullOrWhiteSpace(n)||i._skipTo.call(i,e,t,o)}),m.find(".kd-span-title").click(function(){var e=$(this).attr("data-key"),t=$(this).attr("data-role"),a=$(this).attr("data-detailfuncid"),n=$(this).attr("data-link"),o=KD.equalsIgnoreCase(t,"formspantitle")?a:n;KD.equalsIgnoreCase(t,"formspantitle")&&!KD.IsNullOrWhiteSpace(a)?i._skipTo.call(i,e,t,o):KD.IsNullOrWhiteSpace(n)||i._skipTo.call(i,e,t,o)}),m.find(".kd_guide_btnhelp").click(function(){var e=$(this).attr("data-key"),t=($(this).attr("data-role"),$(this).attr("data-helplink"));i._skipTo.call(i,e,"helpbtn",t)}),m.find(".kd-handle").click(function(){var e=$(this).attr("data-key"),t=$(this).attr("data-role"),a=$(this).attr("data-detailfuncid"),n=$(this).attr("data-link"),o=KD.equalsIgnoreCase(t,"formhandle")?a:n;KD.equalsIgnoreCase(t,"formhandle")&&!KD.IsNullOrWhiteSpace(a)?i._skipTo.call(i,e,t,o):KD.IsNullOrWhiteSpace(n)||i._skipTo.call(i,e,t,o)})}},_skipTo:function(e,t,i){var a=this,n=a.getFormProxy(),o={};n&&n.fireEvent.call(n,"NaviOperAction",t,"guidecard",e,i,o)}}),KDControlFactoryProxy.registerType("guidecard",KDGuideCardProxy),KDMonitorDynamicCardListProxy=KD.extend(KDMessageSimpleListProxy,{initComponent:function(){KDMonitorDynamicCardListProxy.superclass.initComponent.call(this),this.component.addClass("kd-monitor-dynamiccard-list")},setNodataTipsVisible:function(e){if(!KD.isEmpty(e)){var t=ResManager.LoadKDString("很抱歉，暂时没有相关数据~","0141072000005298"),i=!1;if(KD.isObject(e)?(t=e.text||t,i=e.visible):i=e,!this.NodataTips){var a=kendo.format('<div class="kd-monitorcard-nodata-image"></div><div class="kd-monitorcard-nodata-font">{0}</div>',t);this.NodataTips=$(a),this.el.append(this.NodataTips)}i?(this.NodataTips.show(),this.component&&this.component.hide()):(this.NodataTips.hide(),this.component&&this.component.show())}},_generalDataSource:function(e,t){if(!e)return[];for(var i=[],a={},n=0;n<e.length;n++){var o=e[n];KD.isEmpty(o)||(a={},a.key=o.key,a.index=o.index||n,a.time=o.time,a.date=o.date,a.warnname=o.warnname,a.description=o.description,a.status=o.status,a.icontitle=o.icontitle,i.push(a),t&&this._createItem(a))}return i},_createItem:function(e){if(this.component&&e){var t="";t=kendo.format('<div class="kd-agencytask-card-item-container kd-monitordynamic-card-item-container" data-key="{0}"><div class="kd-item kd-data-time" data-key="{0}" data-role="data">{1}</div><div class="kd-item kd-data-date" data-key="{0}" data-role="data">{2}</div><div class="kd-item kd-cutline" data-key="{0}" data-role="data"></div><div class="kd-item kd-data-warnname" data-key="{0}" data-role="data" title="{3}">{3}</div><div class="kd-item kd-data-description" data-key="{0}" data-role="data" title="{4}">{4}</div><div class="kd-item kd-icon" data-key="{0}" data-role="data" title="{5}"></div></div>',e.key,e.time,e.date,e.warnname,e.description,e.icontitle);var i=$(t);this.component.append(i),KD.isEmpty(e.status)||(0==e.status?i.addClass("kd-status-success"):1==e.status&&i.addClass("kd-status-fail"))}}}),KDControlFactoryProxy.registerType("monitordynamiccardlist",KDMonitorDynamicCardListProxy),KDRiskWarningNoticeProxy=KD.extend(KDControlProxy,{initComponent:function(){KDRiskWarningNoticeProxy.superclass.initComponent.call(this),this.el.addClass("kd-riskwarning-container"),this.component=$("<div>").appendTo(this.el)},loadConfig:function(e){KDRiskWarningNoticeProxy.superclass.loadConfig.call(this,e);var t=KD.getValue(e,"background","");this.maxHeight=KD.getValue(e,"maxheight",""),t&&this.el.css("background-color",t),this.NodataTips=null,this.data=[]},setData:function(e){this.GenItems(e)},GenItems:function(e){if(this.component&&e){var t=this;t.component.empty();var i=KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),a=$(kendo.format("<div class='kd-riskwarning-title' type='{0}' title='{1}'><span class='kd-riskwarning-icon' style= 'background-image:url({2});'></span>{1}</div>",e.HeadLevel||1,e.HeadLine||"",i));t.component.append(a);var n=e.WarnDetail;n&&n.length>3&&a.css({position:"relative",left:"-5px"}),n=this._generalDataSource(n);var o=t.component.find("kd-riskwarning-detail-list");0==o.length&&(o=$('<div unselectable="on" class="kd-riskwarning-detail-list"></div>').appendTo(t.component)),this.maxHeight&&o.css({"max-height":this.maxHeight,overflow:"auto"});var r=t._getItemTemplate();o.kendoListView({dataSource:n,template:r,autoBind:!0,change:function(e){}});var s=this.getFormProxy(),l=s&&s.el&&s.el.closest(".k-window-content");l&&l.data("kendoWindow")&&l.data("kendoWindow").center()}},_generalDataSource:function(e){if(!e)return[];for(var t={1:ResManager.LoadKDString("提醒","002014030024528"),2:ResManager.LoadKDString("警告","002014030024527"),3:ResManager.LoadKDString("紧急","002014030021485")},i=[],a={},n=0;n<e.length;n++){var o=e[n];KD.isEmpty(o)||(a={},a.index=o.index||n,a.title=o.Title||"",a.level=String(o.Level)||"1",a.levelname=t[a.level],a.content=o.Content||"",a.dotvisible=o.Content?"inline-block":"none",i.push(a))}return i},_getItemTemplate:function(){var e=kendo.format('<div class="kd-riskwarning-item-container"  data-key="{0}"><span class="kd-item-warning-title" title="{1}">{1}</span><span class="kd-item-warning-type" type="{2}">{4}</span><div  class="kd-item-warning-desc" title="{3}"><span class="kd-dot" style="display:{5}"></span><span class="kd-item-warning-desc-content">{3}</span></div></div>',"#:index #","#:title #","#:level #","#:content #","#:levelname #","#:dotvisible #");return e}}),KDControlFactoryProxy.registerType("riskwarningnotice",KDRiskWarningNoticeProxy),define("KDNaviBarProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDNaviBarProxy}}(this)),KDVerNavibarProxy=KD.extend(KDContainerProxy,{loadConfig:function(e){KDVerNavibarProxy.superclass.loadConfig.call(this,e),this.containerEl=$("<div class='kd-verNaviContainer'></div>"),this.el.append(this.containerEl).addClass("kd-control-verNavibar")},setData:function(e){if(this.containerEl&&this.containerEl.empty&&this.containerEl.empty(),!KD.isEmpty(e)){for(var t=this,i=KD.getValue(e,"selectIndex",0),a=KD.getValue(e,"items",[]),n="",o=0;o<a.length;o++){var r=a[o];if(i==r.index)var s=KD.format("<div id='{0}' attrKey='{3}' attrIndex='{4}' class='kd-verNaviItem kd-verNaviSelect' title='{2}'><div class='kd-verNaviItemIcon'><img class='kd-varNavIcon' src='{5}' style='display:none;' /><img class='kd-varNavIconSelect'  src='{7}'  /></div><div class='kd-verNaviItemText'><span>{1}</span></div><div class='kd-verNaviItemData'><span>{6}</span></div></div>",this.getPageId()+"-item-"+r.key,r.text,r.tips,r.key,r.index,r.icon,r.remarkCount,r.selectIcon);else var s=KD.format("<div id='{0}' attrKey='{3}' attrIndex='{4}' class='kd-verNaviItem' title='{2}'><div class='kd-verNaviItemIcon'><img class='kd-varNavIcon' src='{5}'/><img class='kd-varNavIconSelect' style='display:none;' src='{7}'  /></div><div class='kd-verNaviItemText'><span>{1}</span></div><div class='kd-verNaviItemData'><span>{6}</span></div></div>",this.getPageId()+"-item-"+r.key,r.text,r.tips,r.key,r.index,r.icon,r.remarkCount,r.selectIcon);n+=s}""!=n&&(this.containerEl.append($(n)),$(".kd-verNaviItem",this.containerEl).click(function(e){var i=$(e.target).closest(".kd-verNaviItem"),a=i.attr("attrKey"),n=i.attr("attrIndex"),o=$(".kd-verNaviSelect",t.containerEl);$(".kd-varNavIconSelect",o).hide(),$(".kd-varNavIcon",o).show(),o.removeClass("kd-verNaviSelect"),i.addClass("kd-verNaviSelect"),$(".kd-varNavIconSelect",i).show(),$(".kd-varNavIcon",i).hide(),t.handleClick.call(t,e,a,n)}))}},handleClick:function(e,t,i){var a=this.getFormProxy();a.fireEvent.call(a,"NaviOperAction","Click",this.getKey(),i,t,null,null)},setNavigateSetting:function(e){var t=this;e=KD.isObject(e)?e:{};var i=t.el.find(".kd-verNaviSetItem");if(0==i.length){var a=kendo.format("<div class='kd-verNaviSetItem' style='display:none' title={0}><div class='kd-verNaviItemIcon'><div class='kd-varNavIcon kd-varnavIconPosition' style='background-image:url({1})' ></div><div class='kd-varNavIconSelect kd-varNavIconSelectPosition' style='display:none;background-image:url({1})' ></div></div><div class='kd-verNaviItemText kd-verNaviSetItemText'><span>{0}</span></div></div>",e.title||ResManager.LoadKDString("设置","0991733000003906"),KD.getImageUrlByNameAndVersion("kd_icon_extend.png"));i=$(a),this.el.append(i),t.el.find(".kd-verNaviSetItemText span").click(function(e){t.handleSetNavClick.call(t,e)})}e.visible?(this.containerEl.css({bottom:"51px","box-shadow":"0px 0px 2px 0px rgba(0,0,0,0.20)"}),i.show()):(this.containerEl.css({bottom:"0px"}),i.hide())},handleSetNavClick:function(e){var t=this.getFormProxy();t.fireEvent.call(t,"NaviOperAction","Kingdee.BOS.TabControl.SettingClick",this.getKey(),0,null,null,null)}}),KDControlFactoryProxy.registerType("verNavibar",KDVerNavibarProxy),KDMutilNavibarProxy=KD.extend(KDContainerProxy,{loadConfig:function(e){KDMutilNavibarProxy.superclass.loadConfig.call(this,e),this.containerEl=$("<div class='kd-MutliNavContainer'></div>"),this.el.append(this.containerEl)},setData:function(e){var t=this;if(this.containerEl&&this.containerEl.empty&&this.containerEl.empty(),!KD.isEmpty(e)){var i=t.getStyleKey(e.stylekey),a="<div class='kd-typeContain {2}' data-key='{3}'><div class='kd-typeMsg'><span title='{1}'>{0}</span></div><div class='kd-typeMsgSelectCon'></div></div>",n=kendo.format("<div class='kd-MutilNavTypeCont {0}' style='{1}'>",i,"transform: translateX(0px)");e.items.map(function(t,i){var o=t.key==e.selectKey?"kd-typeSelected":"";n+=KD.format(a,t.text,t.tips,o,t.key)}),n+="</div>",this.containerEl.append($(n));var o=$('<div class="kd-MutilNavibar-icon-container"><span class="kd-MutilNavibar-icon kd-MutilNavibar-icon-left kd-MutilNavibar-icon-disabled"></span><span class="kd-MutilNavibar-icon-split">|</span><span class="kd-MutilNavibar-icon kd-MutilNavibar-icon-right"></span></div>');this.containerEl.append(o),$(".kd-typeContain",this.el).click(function(e){t._handleSelectChange.call(t,e)}),o.find(".kd-MutilNavibar-icon-left").click(function(e){t._handlemove.call(t,this,!1)}),o.find(".kd-MutilNavibar-icon-right").click(function(e){t._handlemove.call(t,this,!0)});var r=this.containerEl.find(".kd-MutilNavLinkTypeCont").width()||0;if(this.containerEl.width()>r?o.css("display","none"):o.css("display","inline-block"),e.enableSearch){var s='<div class=\'kd-MutilNavSearchCont\'><span class="k-textbox k-space-right" style="width: 100%;"><input class="kd-searchInput" type="text"><a href="#" class="k-icon k-i-search">&nbsp;</a></span></div>';this.containerEl.append($(s)),this._searchComponent(e)}}},getStyleKey:function(e){if(KD.isEmpty(e))return"";var t="";switch(e){case 1:t="kd-MutilNavLinkTypeCont"}return t},_handleSelectChange:function(e){var t=this;$(".kd-typeContain",this.el).removeClass("kd-typeSelected");var i=$(e.target).closest(".kd-typeContain").addClass("kd-typeSelected").data("key"),a=t.getFormProxy();a.lockControl.call(a,t);$(".kd-searchInput",t.el).val();a.fireCustomEventsNoData.call(a,"kingdee.bos.MutilNavibar.itemChange",t.key,i)},_searchComponent:function(e){var t=this,i=t.getFormProxy();i.lockControl.call(i,t),$(".kd-searchInput",this.el).attr("placeholder",e.searchTips||"").off("change").on("change",function(e){var a=$(".kd-searchInput",t.el).val();i.fireCustomEventsNoData.call(i,"kingdee.bos.MutilNavibar.search",t.key,a)}),$(".k-i-search",this.el).click(function(e){var a=$(".kd-searchInput",t.el).val();i.fireCustomEventsNoData.call(i,"kingdee.bos.MutilNavibar.search",t.key,a)})},_handlemove:function(e,t){var i=this,a=$(e);if(!a.hasClass("kd-MutilNavibar-icon-disabled")){var n=this.containerEl.find(".kd-MutilNavLinkTypeCont"),o=i.containerEl.find(".kd-MutilNavibar-icon-container").width(),r=i.containerEl.find(".kd-MutilNavibar-icon-right"),s=i.containerEl.find(".kd-MutilNavibar-icon-left"),l=i._getTransformDomX(n),d=0,c=this.containerEl.width()-n.width()-o;if(t){if(c>l)return void a.addClass("kd-MutilNavibar-icon-disabled");s.removeClass("kd-MutilNavibar-icon-disabled"),d=-120}else{if(l>=0)return void a.addClass("kd-MutilNavibar-icon-disabled");r.removeClass("kd-MutilNavibar-icon-disabled"),d=120}var h=l+d;n.css({transform:"translateX("+h+"px)"}),c>h&&r.addClass("kd-MutilNavibar-icon-disabled"),h>=0&&s.addClass("kd-MutilNavibar-icon-disabled")}},_getTransformDomX:function(e){var t=e.attr("style");if(t&&t.match){var i=/translateX\(-?\d+/g,a=t.match(i);t=a&&a.length>0?a[0].replace("translateX(",""):0}else t=0;return parseInt(t)},doLayout:function(){var e=this;if(KDMutilNavibarProxy.superclass.doLayout.call(this),e.containerEl&&e.containerEl.find(".kd-MutilNavLinkTypeCont").length>0){var t;t=e.containerEl.find(".kd-MutilNavLinkTypeCont").width()-e.containerEl.width()>0?"inline-block":"none",e.containerEl.find(".kd-MutilNavibar-icon-container").css("display",t)}}}),KDControlFactoryProxy.registerType("MutilNavibar",KDMutilNavibarProxy),KDCostAccountCardProxy=KD.extend(KDContainerProxy,{itemAccountWidth:0,handleMoveDistance:148,loadConfig:function(e){KDCostAccountCardProxy.superclass.loadConfig.call(this,e),this.handleMoveDistance=KD.getValue(e,"handlemovedistance",148),this.containerEl=$("<div class='kd-CostAccountContainer'></div>"),this.el.append(this.containerEl)},setData:function(e){var t=this;if(this.containerEl&&this.containerEl.empty&&this.containerEl.empty(),!KD.isEmpty(e)&&!KD.isEmpty(e.items)){this.handleMoveDistance=KD.isNumber(e.handlemovedistance)?e.handlemovedistance:this.handleMoveDistance;
var i="<div class='kd-typeContain {2}' data-key='{3}'><div class='kd-typeTitle'><span title='{1}'>{0}</span></div><div class='kd-typeMsgBtnMask' style='color:{8};border-color:{8}'>{4}</div><div class='kd-typeTime' title='{5}'>{5}</div><div class='kd-typeDescription' title='{6}'>{6}</div><div class='kd-typeOperateContain'>{7}</div></div>",a=kendo.format("<div class='kd-CostAccountType' style='{0}'>","transform: translateX(0px)");e.items.map(function(t,n){for(var o=t.key==e.selectKey?"kd-typeSelected":"",r="",s=t.msgMaskColor||"",l=0;l<t.operatetitle.length;l++){var d=kendo.format("<span class='kd-typeOperateBtn' data-key='{1}'>{0}</span>",t.operatetitle[l].value,t.operatetitle[l].key);r+=d}a+=KD.format(i,t.title,t.title,o,t.key,t.msgMask,t.time,t.descript,r,s)}),a+="</div>";var n=kendo.format("<div class='kd-costaccount-iconContain' style='display:{0}'><span class='kd-costaccount-icon kd-costaccount-pre kd-costaccount-icon-disabled'></span></div><div class='kd-costaccount-list'>{1}</div><div class='kd-costaccount-iconContain' style='display:{0}'><span class='kd-costaccount-icon kd-costaccount-next'></span></div>","none",a);this.containerEl.append($(n));var o=this.containerEl.find(".kd-costaccount-list"),r=this.containerEl.find(".kd-costaccount-iconContain"),s=this.el.width()-2*r.width();this.itemAccountWidth=this.containerEl.find(".kd-typeContain").outerWidth()*e.items.length,s>0&&this.itemAccountWidth>s&&(r.css("display","inline-block"),o.css("width",s)),t.containerEl.find(".kd-costaccount-pre").click(function(e){t._handlemove.call(t,this,!1)}),t.containerEl.find(".kd-costaccount-next").click(function(e){t._handlemove.call(t,this,!0)}),this.containerEl.find(".kd-typeOperateBtn").click(function(e){t._handleSelectAccountBtn(e),e.stopPropagation()}),this.containerEl.find(".kd-typeContain").click(function(e){t._handleSelectChange(e)})}},doLayout:function(){if(KDCostAccountCardProxy.superclass.doLayout.call(this),this.el.find(".kd-costaccount-iconContain").is(":visible")){var e=this.containerEl.find(".kd-costaccount-list"),t=this.el.width()-2*this.containerEl.find(".kd-costaccount-iconContain").width();e.css("width",t)}},_handleSelectChange:function(e){var t=this;this.el.find(".kd-typeContain").removeClass("kd-typeSelected");var i=$(e.target).closest(".kd-typeContain").addClass("kd-typeSelected").data("key"),a=t.getFormProxy();a.lockControl.call(a,t),a.fireCustomEventsNoData.call(a,"kingdee.bos.CostAccount.itemChange",t.key,KD.stringify(i))},_handleSelectAccountBtn:function(e){var t=this;t.el.find(".kd-typeContain").removeClass("kd-typeSelected");var i=$(e.target),a=i.data("key"),n=i.closest(".kd-typeContain").addClass("kd-typeSelected").data("key"),o={cardkey:n,btnkey:a},r=t.getFormProxy();r.lockControl.call(r,t),r.fireCustomEventsNoData.call(r,"kingdee.bos.CostAccount.operateClick",t.key,KD.stringify(o))},_handlemove:function(e,t){var i=this,a=$(e);if(!a.hasClass("kd-costaccount-icon-disabled")){var n=this.containerEl.find(".kd-CostAccountType"),o=i.containerEl.find(".kd-costaccount-pre"),r=i.containerEl.find(".kd-costaccount-next"),s=i._getTransformDomX(n),l=0,d=this.el.width()-2*this.containerEl.find(".kd-costaccount-iconContain").width()-this.itemAccountWidth;if(!(d>0)){if(t){if(d-this.handleMoveDistance>s)return void a.addClass("kd-costaccount-icon-disabled");r.removeClass("kd-costaccount-icon-disabled"),l=-this.handleMoveDistance}else{if(s>=0)return void a.addClass("kd-costaccount-icon-disabled");o.removeClass("kd-costaccount-icon-disabled"),l=this.handleMoveDistance}var c=s+l;n.css({transform:"translateX("+c+"px)"}),c<d-this.handleMoveDistance?r.addClass("kd-costaccount-icon-disabled"):r.removeClass("kd-costaccount-icon-disabled"),c>=0?o.addClass("kd-costaccount-icon-disabled"):o.removeClass("kd-costaccount-icon-disabled")}}},_getTransformDomX:function(e){var t=e.attr("style");if(t&&t.match){var i=/translateX\(-?\d+/g,a=t.match(i);t=a&&a.length>0?a[0].replace("translateX(",""):0}else t=0;return parseInt(t)}}),KDControlFactoryProxy.registerType("CostAccount",KDCostAccountCardProxy),define("KDVerNavibarProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDVerNavibarProxy}}(this)),KDCardManageCenter=KD.extend(KDControlProxy,{data:null,currentBusinessGroupIndex:0,loadConfig:function(e){KDCardManageCenter.superclass.loadConfig.call(this,e),this.currentBusinessGroupIndex=KD.getValue(e,"currentBusinessGroupIndex",0),this.isBusinessGroupSelect=KD.getValue(e,"isBusinessGroupSelect",!1)},initComponent:function(){KDCardManageCenter.superclass.initComponent.call(this),this.component=$(kendo.format('<div style="width:100%;height:100%;">')),this.el.append(this.component),1==this.isBusinessGroupSelect?(this.businessGroupAddPanel=$(kendo.format('<div style="height:25px; overflow-y: auto;">')),this.businessGroups=$(kendo.format('<div class="kd-nav-businessGroupSelect">')),this.component.append(this.businessGroupAddPanel).append(this.businessGroups)):(this.component.css({"border-right":"1px solid #E0E5EB"}),this.businessGroups=$(kendo.format('<div class="kd-nav-businessGroupManage">')),this.cardDetails=$('<ul unselectable="on" class="k-list k-reset kd-nav-carditems">'),this.component.append(this.businessGroups).append(this.cardDetails))},doLayout:function(){KDCardManageCenter.superclass.doLayout.call(this)},setData:function(e){void 0==e&&(e=[]),this.dataSource=e,this.setBusinessGroupNavigation(e)},setBusinessGroupNavigation:function(e){var t,i,a=this;this.businessGroups.empty();for(var n=0;n<e.length;n++)i=e[n],1==this.isBusinessGroupSelect?(t=$(kendo.format('<div id={0} class="kd-nav-businessGroupSelectItem">{1}<div class="kd-nav-businessGroupSelectItem-log"></div></div>',i.id,i.title)),t.click(function(e){var t=$(this),i=t.attr("id");t.siblings().removeClass("kd-nav-businessGroup-select"),t.addClass("kd-nav-businessGroup-select"),a._preViewCardForm("selectBusinessGroup",i,"")}),this.businessGroups.append(t),n==this.currentBusinessGroupIndex&&(t.addClass("kd-nav-businessGroup-select"),a._preViewCardForm("selectBusinessGroup",i.id,i.title))):(t=$(kendo.format('<div id={0} class="kd-nav-businessGroup" title="{1}">{1}</div>',i.id,i.title)),t.click(function(e){var t=$(this),i=t.attr("id");t.siblings().removeClass("kd-nav-businessGroup-select"),t.addClass("kd-nav-businessGroup-select");var n=a._getCardItems(i);a.setCardItems(n)}),this.businessGroups.append(t),n==this.currentBusinessGroupIndex&&(t.addClass("kd-nav-businessGroup-select"),a.setCardItems(i.cardList)))},_getCardItems:function(e){var t;for(var i in this.dataSource)if(this.dataSource[i].id+""==e+""){t=this.dataSource[i].cardList;break}return t},setCardItems:function(e){if(0==this.isBusinessGroupSelect&&e&&e.length>0){var t=this;t.cardDetails.empty();for(var i=0;i<e.length;i++){var a=e[i],n=$(kendo.format('<li class="k-item" formid="{0}" cardid="{1}" parameter="{4}"><input type="checkbox" class="k-checkbox kd_Enter2tab" id="I_{2}"><label id="L_{2}" tabindex="-1" class="k-checkbox-label" for="I_{0}">{3}</label></li>',a.cardFormId,a.cardId,KD.Guid.NewGuid().ToString()+a.cardId,a.cardTitle||"&nbsp;",a.parameters));n.click(function(e){var i=$(this);i.siblings().find("input.k-checkbox").prop("checked",!1),i.find("input.k-checkbox").prop("checked",!0),t.lastSelectCard&&new Date-t.lastSelectCard.time<500||(t._preViewCardForm("preViewForm",i.attr("formid"),i.find(".k-checkbox-label").text(),i.attr("parameter")),t.lastSelectCard={check:i.find("input.k-checkbox").prop("checked"),time:new Date})}),t.cardDetails.append(n)}for(var o,r,s=t.cardDetails.children(),i=0;i<s.length;i++)o=s[i],r=$(".k-checkbox-label",o),r.height()>20&&(r.addClass("kd-text-ellipsis"),$(o).attr("title",r.text()));$(t.cardDetails.children()[0]).find("input.k-checkbox").prop("checked",!0),t._preViewCardForm("preViewForm",e[0].cardId,e[0].cardTitle,e[0].parameters)}},_preViewCardForm:function(e,t,i,a){var n=this,o=n.getFormProxy();o.lockControl.call(o,n);var r=i,s=0;if(a){var l={};l.parameters=a}else var l=null;o.fireEvent.call(o,"NaviOperAction",e,r,s,t,l,null)},release:function(){KDCardManageCenter.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("cardmanagecenter",KDCardManageCenter),define("KDCardManageCenter",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDCardManageCenter}}(this)),KDSearchTextFieldProxy=KD.extend(KDContainerProxy,{defaultIconUrl:"../images/biz/default/MainConsole/H5CardLayout/CommFuncCard/kd_fullsearch_menu_Seach.png",loadConfig:function(e){KDSearchTextFieldProxy.superclass.loadConfig.call(this,e),this.iconbackground=KD.getValue(this.config,"background","#E8EBF0"),this.iconUrl=KD.getValue(this.config,"inputicon",this.defaultIconUrl),this.inputPlaceholder=KD.getValue(this.config,"placeholder","")},initComponent:function(e){KDSearchTextFieldProxy.superclass.initComponent.call(this,e);var t=this;this.el.empty().addClass("kd-kd-Searchtextfield-el");var i=KD.getValue(this.config,"iconplace",""),a=KD.getValue(this.config,"iconoriginsize",!1),n=a?"":"height:inherit;";this.iconContainer=$(kendo.format('<span class="kd-Searchtextfield-iconcontainer" style="background-color:{0};height:{1}px;width:{1}px;float:{2};"><img class="kd-Searchtextfield-inputicon" style="{3}"></span>',this.iconbackground,this.el.height(),i,n)).appendTo(this.el),this.setInputIcon(this.iconUrl),this.component=$(kendo.format('<input class="k-textbox" placeholder="{0}" style="width:{1}px;border:none;padding:0px;height:inherit;">',this.inputPlaceholder,this.el.width()-this.iconContainer.width())).appendTo(this.el),this.component.focus(function(){t.el.addClass("kd_ui_warnning")}),this.component.blur(function(){t.el.removeClass("kd_ui_warnning")}),this.component.keydown(function(e){13==e.keyCode&&t.sendSearchTextFireCustomEvents()}),this.iconContainer.click(function(){t.sendSearchTextFireCustomEvents()})},setInputIcon:function(e){if(!KD.isEmpty(e)){var t=this.iconContainer.find(".kd-Searchtextfield-inputicon");KD.isUrl(e)?t.attr({src:e}):this.IsPicture(e)?~e.indexOf("../")?t.attr({src:e}):t.attr({src:"../"+e}):t.attr({src:"data:image/jpeg;base64,"+e})}},IsPicture:function(e){var t=".jpeg|.gif|.jpg|.png|.bmp|.pic|.ico|";if(e.indexOf(".")>-1){var i=e.lastIndexOf("."),a=e.substring(i,this.length)+"|";if(a=a.toLowerCase(),t.indexOf(a)>-1)return!0}return!1},setEmptyTip:function(e){KD.isEmpty(e)||(this.inputPlaceholder=e,this.el.find(".k-textbox").attr("placeholder",e))},setInputText:function(e){e=KD.isEmpty(e)?"":e,this.el.find(".k-textbox").val(e)},sendSearchTextFireCustomEvents:function(){var e=this.component.val(),t=this.getFormProxy(),i=new Object;i.value=e,i.row=0,t&&t.fireCustomEvents.call(t,this.key,KD.CONST.CustomEventName.KDSearchTextFieldCustomEvent,KD.stringify(i))}}),KDControlFactoryProxy.registerType("searchtextfield",KDSearchTextFieldProxy),define("KDSearchTextFieldProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDSearchTextFieldProxy}}(this)),KDCustomNaviBarProxy=KD.extend(KDNaviBarProxy,{style:"",styleKey:"",orientation:"",loadConfig:function(e){KDCustomNaviBarProxy.superclass.loadConfig.call(this,e),this.Control=new Object,this.setStyle(e.style),this.el.addClass(this.styleKey),this.IsChangedPageButtonVisible=e.pagebuttonvisible||!1,this.setData(e.data),this.setOrientation(e.orientation||0)},getStyle:function(){return this.style},setStyle:function(e){if(e!=this.style)switch(this.style=e,e){case"0":this.styleKey="ConsoleWorkflowStyle";break;case"1":this.styleKey="ConsoleTaskStyle";break;case"2":this.styleKey="ConsoleWarnMsgStyle";break;default:this.styleKey=e}},setData:function(e){this.data=e,this.GenItems()},setOrientation:function(e){KD.layout.setOrientation(this,0==parseInt(e)?"Vertical":"Horizontal")},Control:null,GenItems:function(){var e=this;if(this.el.empty(),this.Control||(this.Control={}),this.Control.Items=new Array,this.Control.MaxPresenterCount=0,this.data){var t="";for(var i in this.data){if(i>=15)break;var a=this.LoadItemModel(this.data[i]);switch(this.data[i].buttonitemmodeldata.resultname&&(a.resultname=this.data[i].buttonitemmodeldata.resultname),this.styleKey){case"ConsoleWorkflowStyle":t+='<a style="display:block;" attach-data="Link" title="'+a.ToolTip+'" id="'+a.Key+'">'+(a.Header||"default")+"</a>";break;case"ConsoleTaskStyle":t+='<div style="display:block;" id="'+a.Key+'"><span style="float:left;">'+ResManager.LoadKDString("来自","0991733000003975")+'</span><a class="CtNavWeibo" attach-data="ShowWeiBo" >'+a.OtherData+'</a><a class="CtNavLink" attach-data="Link" title="'+a.ToolTip+'">'+a.Header+'</a><a class="CtNavProcess" attach-data="Process">'+ResManager.LoadKDString("处理","0991733000003974")+"</a></div>";break;case"ConsoleWarnMsgStyle":t+='<div style="display:block;" id="'+a.Key+'"><span style="color:#0E8BEB; display:inline-block; float:left;">'+a.OtherData+'</span><a class="CtNavLink" attach-data="View" title="'+a.ToolTip+'" style="font-weight:'+(0==a.status?"bold":"normal")+'">'+a.Header+'</a><a class="CtNavProcess" attach-data="Process">'+ResManager.LoadKDString("处理","0991733000003974")+"</a></div>";break;case"ConsoleFinishedTaskStyle":t+='<div style="display:block;" id="'+a.Key+'"><span style="float:left;">'+ResManager.LoadKDString("来自","0991733000003975")+'</span><a class="CtNavWeibo" attach-data="ShowWeiBo" >'+a.OtherData+'</a><a class="CtNavLink" attach-data="Link" title="'+a.ToolTip+'">'+a.Header+'</a><a class="CtNavProcess" attach-data="Process">'+a.resultname+"</a></div>";break;case"ConsoleWorkflowMsgStyle":t+='<a style="display:block;" attach-data="Link" title="'+a.ToolTip+'" id="'+a.Key+'">'+(a.Header||"default")+"</a>"}this.Control.Items.push(a)}this.el.append(t),$("a",this.el).click(function(t){var i=null,a=t.target.id||$(t.target).parent().attr("id"),n=t.target.attributes["attach-data"].value,o=0;for(var r in e.Control.Items)if(e.Control.Items[r].Key==a){i=e.Control.Items[r],o=r;break}e.comandClick(i,o,n),$(this).css("font-weight","normal")}),this.Control.MaxPresenterCount=this.data.length}},LoadItemModel:function(e){var t=new Object;if(null==e||0==e.Count)return null;t.Header=e.text||"",t.ToolTip=e.tooltip||t.Header,e.width&&(t.Width=e.width),e.x&&(t.Left=e.x),t.Key=e.key||"",t.Height=25;var i=e.buttonitemmodeldata||new Object;t.CanExecuteCommand=i.canexecutecommand||!1;var a=e.icon||null;return null!=a&&(KD.isUrl(a)?t.Icon=a:t.Icon=kendo.format("{0}{1}",ClientAppProxy.Current.CTX.ServerUrl,a),t.ShowIcon=!0),t.ShowIcon=e.showicon||t.ShowIcon,t.IsShowKeyValue=i.isshowkeyvalue||("Visible"==t.IsShowKeyValue?"Visible":"Collapsed"),t.InitialKeyValue=i.initialkeyvalue||t.InitialKeyValue,t.KeyValue=i.keyvalue||t.KeyValue,t.OtherData=i.otherdata||t.OtherData,t.status=e.status||"1",t},comandClick:function(e,t,i){var a=e.KeyValue||"";e&&this.getFormProxy().fireEvent("NaviOperAction","Click",i,t,a,{style:this.style,key:e.Key,keyvalue:a})}}),KDControlFactoryProxy.registerType("kdcustomnavibar",KDCustomNaviBarProxy),define("KDCustomNaviBarProxy",["KDNaviBarProxy","KD"],function(e){return function(){var t;return t||e.KDCustomNaviBarProxy}}(this)),KDMsgListControlProxy=KD.extend(KDControlProxy,{header:"",isFirstExpanded:!0,loadConfig:function(e){KDMsgListControlProxy.superclass.loadConfig.call(this,e),this.el.css("width","100%"),this.key=e.key||"",this.header=e.header||"",this.isFirstExpanded=e.isFirstExpanded||this.isFirstExpanded,this.setItemGroups(e.itemgoups)},setItemGroups:function(e){if(e){var t=this;this.items=new Array;var i="";for(var a in e){var n=e[a];i+='<div style="display:block;" id="'+n.key+'"><div class="msgListItemTitle"><input type="checkbox" attach-value="'+n.key+'" name="'+n.id+'">'+n.itemtitle+'</div><div class="msgListItemContent">'+t._getMsgListItemContent(n)+'<div><a class="processBtn" attach-value="'+n.key+'" style="cursor:pointer;margin-right: 25px;">'+ResManager.LoadKDString("处理","0991733000003974")+"</a></div></div></div>",this.items.push(n)}this.el.append(i),this.isFirstExpanded&&($(".msgListItemContent:first",this.el).show(),$(".msgListItemTitle:first",this.el).addClass("ui-msgitem-active"),$(":checkbox:first",this.el)[getPropName()]("checked",!0)),$(".msgListItemTitle",this.el).click(function(){return"block"==$(this).next().css("display")?$(this).next().css({display:"none"}):($(".msgListItemContent",this.el).slideUp("fast"),$(".msgListItemTitle",this.el).removeClass("ui-msgitem-active"),$(this).addClass("ui-msgitem-active"),$(this).next().slideDown("fast"),void $(this).children(":checkbox").click())}),$(":checkbox",this.el).click(function(e){var i=$(this).attr("attach-value"),a=t.getItemBykey(i);if(a){var n=t.getFormProxy();n.lockControl.call(n,t),n.fireEvent.call(n,"CustomEvents",t.config.key,"EntityRowClick",KD.stringify({keyvalue:a.key,ischecked:$(this)[getPropName()]("checked")}))}KD.stopBubble(e)}),$(".processBtn",this.el).click(function(){var e=$(this).attr("attach-value"),i=t.getItemBykey(e);if(i){var a=t.getFormProxy();a.lockControl.call(a,t),a.fireEvent.call(a,"CustomEvents",i.id,i.id+"Process",KD.stringify({keyvalue:i.key,key:i.id}))}}),$(".msgListItemContent .kd-msgListItemContent-link",this.el).click(function(){var e=$(this).attr("attach-value"),i=t.getItemBykey(e);if(i){var a=$(this).attr("id"),n={};i.linklist&&(n=i.linklist[a]);var o=t.getFormProxy();o.lockControl.call(o,t),o.fireEvent.call(o,"CustomEvents",t.config.key,"Kingdee.BOS.MsgControl.LinkClick",KD.stringify(n))}})}},_getMsgListItemContent:function(e){var t="";if(KD.isObject(e.itemcontent)&&!KD.isEmpty(e.itemcontent.template)){if(t=e.itemcontent.template,e.itemcontent.items){e.linklist={};for(var i=0;i<e.itemcontent.items.length;i++){var a=e.itemcontent.items[i];a.msgItemId=e.id,a.msgItemKey=e.key,e.linklist[a.key]=a;var n="";if("outerlink"==a.xtype){var o=a.parameter&&a.parameter.url;n=kendo.format('<a class="kd-msgListItemContent-outerlink" target="_blank"  attach-value="{0}" id="{1}" href="{2}">{3}</a>',e.key,a.key,o,a.text)}else n=kendo.format('<span class="kd-msgListItemContent-link" attach-value="{0}" id="{1}"">{2}</span>',e.key,a.key,a.text);t=t.replace("{"+a.key+"}",n)}}}else t=KD.isObject(e.itemcontent)&&KD.isEmpty(e.itemcontent.template)?e.itemcontent.template||"":e.itemcontent;return t},_linkContentClick:function(e){},getItemBykey:function(e){var t;for(var i in this.items)if(this.items[i].key==e){t=this.items[i];break}return t},checkAllItem:function(e){"True"==e.attachmsg?this.el.find(":checkbox")[getPropName()]("checked",!0):this.el.find(":checkbox")[getPropName()]("checked",!1)}}),KDControlFactoryProxy.registerType("kdmsglistcontrol",KDMsgListControlProxy),define("KDMsgListControlProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDMsgListControlProxy}}(this)),KDStatusTrackerProxy=KD.extend(KDControlProxy,{loadConfig:function(e){KDStatusTrackerProxy.superclass.loadConfig.call(this,e),this.el.addClass("KDMyStateDiagramStyle")},setData:function(e){if(e.items&&0!=e.items.length){e.currentstate||(e.currentstate=e.items[0].key);var t=e.items,i=this.config.width,a=t.length,n=(i-20-24*a)/(a-1),o="<div class='KDstateDisgramContainer' style='margin:10px,20px'>",r=!0;for(var s in t){var l=!1;e.currentstate==t[s].key&&(l=!0,r=!1),t.indexOf(t[s])+1==t.length&&1==r&&(l=!0),o+=this.bulidNode(t[s],n,r,l),s!=t.length-1&&(o+=this.bulidLine(t[s],n,r))}o+="</div>",this.el.append(o)}},bulidNode:function(e,t,i,a){var n=a?"ui-item-finish":i?"ui-item-active":"";return'<div class="ui-item-node '+n+'"><ul style="padding: 0px;margin-top:24px;margin-left: -'+t+"px;width: "+(2*t+24)+'px;"><li class="tx2" style="list-style:none;text-align:center;">'+e.lable+'</li><li id="track_time_0" class="tx3"  style="list-style:none;text-align:center">'+(e.date||"")+"<br> "+(e.time||"")+"</li></ul></div>"},bulidLine:function(e,t,i){return'<div class="ui-item-line '+(i?"ui-item-active":"")+'" style="width:'+t+'px;"><ul></ul></div>'}}),KDControlFactoryProxy.registerType("kdstatustracker",KDStatusTrackerProxy),define("KDStatusTrackerProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDStatusTrackerProxy}}(this)),function(e){KDLocalServices=function(e){},$.extend(KDLocalServices,{connectionAddr_http:"ws://127.0.0.1:9268",connectionAddr_https:"wss://127.0.0.1:9269",getConnectStr:function(){var t=e.getConnectConfig().localServiceUrl||(KDLocalServices.isIeHttps()?KDLocalServices.connectionAddr_https:KDLocalServices.connectionAddr_http);return t},isIeHttps:function(){return e.isIeHttps()},getSocket:function(){var e=window.WebSocket||window.Websocket||window.webSocket||window.websocket||window.MozWebSocket;return e},hasSocket:function(){return!(void 0===KDLocalServices.getSocket())},startLocalServer:function(t,i){var a=t.callback||i;e.isFunction(a)&&a({sucess:!0})},createServicesChannel:function(t,i){var a=KDLocalServices;if(a.isIeHttps()){delete a.ws;var n=t.error||i;e.isFunction(n)&&n({message:"nonsupport websocket!",returnValue:!1,type:"iehttps"})}else if(a.ws&&1==a.ws.readyState)e.isFunction(i)&&i({message:"success!",returnValue:!0,type:"open"});else{delete a.ws;var o=KDLocalServices.getSocket(),r=null;try{if(o)r=a.ws=a.ws||new o(KDLocalServices.getConnectStr()),r.onopen=function(n){a.ws=r;var o=t.open||i;e.isFunction(o)&&o(n)},r.onmessage=function(a){var n=t.message||i;e.isFunction(n)&&n(a)},r.onclose=function(n){var o=t.close||i;n.normalClose=a.normalClose,delete a.normalClose,e.isFunction(o)&&o(n),delete a.ws},r.onerror=function(n){var o=t.error||i;e.isFunction(o)&&o(n),delete a.ws};else{delete a.ws;var n=t.error||i;e.isFunction(n)&&n({message:"nonsupport websocket!",returnValue:!1,type:"open"})}}catch(s){e.writeError(s),a.ws=void 0}}},sendData:function(t){var i=KDLocalServices;if(void 0!==i.ws&&1==i.ws.readyState){var a=e.isString(t)?t:e.stringify(t);i.ws.send(a)}},close:function(){},alertToStartService:function(){if(!($("span.k3cloudapp-configure-localservice-flag").length>0)&&e.isWinOS()){var t=ResManager.LoadKDString("系统检测到您本机未启用或已停用金蝶云星空本地服务，启用后可提供以下功能","0025710000008621")+"<br/>"+ResManager.LoadKDString("1、浏览器直接打印；","0025710000008373")+"<br/>"+ResManager.LoadKDString("2、获取IP地址和机器MAC地址。","0025710000008475")+'<span class="k3cloudapp-configure-localservice-flag"/><br/>&nbsp',i=(e.getUrlRoot()||"").replace(/http[s]{0,}\:\/\//,"k3cloud://")+"/Clientbin/K3cloudclient/KDK3CloudLocalTray.manifest?LoginUrl="+(e.getUrlRoot()||"")+"/",a=t,n=ResManager.LoadKDString("金蝶云星空本地服务安装引导","0025710000008622"),o=ResManager.LoadKDString("打开金蝶云星空本地服务","0025710000008623");e.writeLog("KDLocalServices::","alertToStartService!",!0);var r=!0;e.openK3CloudApp(i,n,o,a,r)}},closeAlert:function(){var t=$("span.k3cloudapp-configure-localservice-flag").closest(".k-window-content").data("kendoWindow");t&&e.isFunction(t.close)&&t.close()},alertNoSupportIeHttps:function(){var e=ResManager.LoadKDString("由于IE浏览器安全机制限制，当前运行在https协议上，暂时还不支持本地服务的调用！请采用其他浏览器，例如：谷歌（chrome）、火狐（firefox）。","0025710000008569");KDMessageBox.show({type:KDMessageBox.KDMesBoxType.Warning,sourceClass:"",sourceMethod:"",msg:e})}})}(KD),define("KDLocalServices",["KD"],function(e){return function(){var t;return t||e.KDLocalServices}}(this)),function(e){KDLocalServiceClient=function(e){},$.extend(KDLocalServiceClient,{acts:{},closeAlert:function(){KDLocalServices.closeAlert()},getClientInfo:function(t,i,a){if(!KDLocalServices.hasSocket())return void(t&&t(i,{ReturnPacks:""}));var n=KDLocalServiceClient,o=n.getActionPack("GetClientInfo",i);o.ignoreMessage=!(1==parseInt((e.getConnectConfig()||{}).autoCheckLocalServiceTray||"0"));var r=function(e,i){a||KDLocalServices.close(),o.ignoreMessage||i.IsSuccessful||n.hasAlert||(n.hasAlert=!0,"iehttps"==i.type?KDLocalServices.alertNoSupportIeHttps():KDLocalServices.alertToStartService()),t(e,i)};n.sendData([o],r,i)},checkOrUpdateVersion:function(e,t){var i=KDLocalServiceClient;i.getClientInfo(function(t,i){var a=i.ReturnPacks||[],n=a.length>0?a[0]:{};"1.0.0.0"==n.Version,KDLocalServices.close(),e(t,i)},t,!0)},invokeLocalAction:function(t,i,a,n,o,r){var s=KDLocalServiceClient;if(!KDLocalServices.hasSocket())return void(t&&t(i,{ReturnPacks:"",isSupportSocket:!1}));var l=s.getDynActionPack(a,"",n,o);l.ignoreMessage=!(1==parseInt((e.getConnectConfig()||{}).autoCheckLocalServiceTray||"0"));var d=function(e,i){r||KDLocalServices.close(),l.ignoreMessage||i.IsSuccessful||s.hasAlert||(s.hasAlert=!0,"iehttps"==i.type?KDLocalServices.alertNoSupportIeHttps():KDLocalServices.alertToStartService()),t(e,i)};s.sendData([l],d,i)},invokeLocalActionExt:function(t,i,a,n,o,r,s){var l=KDLocalServiceClient;if(!KDLocalServices.hasSocket())return void(t&&t(i,{ReturnPacks:"",isSupportSocket:!1}));var d=l.getDynActionPack(a,n,o,r),c=(r[0]||{}).ignoreMessage,h=!(1==parseInt((e.getConnectConfig()||{}).autoCheckLocalServiceTray||"0"));d.ignoreMessage=void 0!==c?c:h;var u=function(e,i){s||KDLocalServices.close(),d.ignoreMessage||i.IsSuccessful||("iehttps"==i.type?KDLocalServices.alertNoSupportIeHttps():KDLocalServices.alertToStartService()),t(e,i)};l.sendData([d],u,i)},exit:function(e,t){if(!KDLocalServices.hasSocket())return void(e&&e(t,{ReturnPacks:""}));var i=KDLocalServiceClient,a=i.getActionPack("Exit",t),n=function(t,i){KDLocalServices.close(),e(t,i)};i.sendData([a],n,t)},initChannel:function(t,i,a){var n=KDLocalServiceClient,o=t.actId||"";KDLocalServices.createServicesChannel({open:function(t){KDLocalServiceClient.closeAlert(),e.isFunction(a)&&a(i,t)},message:function(t){n.sendDataCallBack(i,t),e.writeLog("KDLocalServiceClient::",((t||{}).data||"").substr(0,900),!0)},close:function(t){n.setBusy(!1,i);var a=n.getErrData(t,o,"close");t.data=e.stringify(a),n.sendDataCallBack(i,t),e.writeLog("KDLocalServiceClient::",a.Message,!0)},error:function(t){n.setBusy(!1,i);var a=n.getErrData(t,o,"error");t.data=e.stringify(a),n.sendDataCallBack(i,t),e.writeLog("KDLocalServiceClient::",a.Message,!0)}},function(t){e.isFunction(a)&&a(i,t)})},sendData:function(e,t,i){var a=KDLocalServiceClient,n=e[0]||{};a.acts[n.actId]={callback:t,args:e,scope:i},a.initChannel(n,i,function(t,i){KDLocalServices.sendData(e)})},sendDataCallBack:function(t,i){var a=KDLocalServiceClient,n=e.parseObject(i.data),o=(n.ActionPacks?n.ActionPacks[0]:{})||{},r=(o?o.actId:"")||"",s=a.acts[r];n.type=i.type,delete a.acts[r],s&&e.isFunction(s.callback)&&s.callback(s.scope,n),a.setBusy(!1,t)},setBusy:function(e,t){var i=t.owner;i&&i.setBusy.call(i,e)},getActionPack:function(t,i,a,n){for(var o=(KDLocalServiceClient,{success:!0,actionKey:"ClientActions",methodName:t,params:[null],pageId:"",jobId:"",message:"",isoId:"",actId:e.Guid.NewGuid().ToString()}),r=[],s=2;s<arguments.length;s++){var l=arguments[s];r.push(l)}return 0==r.length&&r.push(null),o.params=r,o},getDynActionPack:function(t,i,a,n){var o=(KDLocalServiceClient,{success:!0,actionKey:i||"ClientActions",clsAsmStr:a||"Kingdee.BOS.LocalActions.Actions.ClientActionHandler,Kingdee.BOS.LocalActions",targetMethod:t,methodName:"DoTargetMethodProxy",params:[null],pageId:"",jobId:"",message:"",isoId:"",actId:e.Guid.NewGuid().ToString()});return o.params=n,o},getErrData:function(e,t,i){var a={actId:t},n={},o={IsSuccessful:!1,Message:(e||{}).data||i,ActionPacks:[a],ReturnPacks:[n]};return o}})}(KD),define("KDLocalServiceClient",["KD","KDLocalServices"],function(e){return function(){var t;return t||e.KDLocalServiceClient}}(this)),KDActiveXPrinter=function(){},$.extend(KDActiveXPrinter,{PrintVersion:"2.0.1.0",isNeedCheckListMaxPage:!0,isNeedCheckNoteMaxPage:!1,checkPrintVer:function(e){var t=KDActiveXPrinter.getPrintVersion(),i=e&&e.GetVer(),a=parseInt((i||"").replace(/\./g,"")),n=parseInt((t||"").replace(/\./g,""));return a>=n},getPrintVersion:function(){return KDActiveXPrinter.PrintVersion},initPrnActiveXObj:function(){var e=void 0;try{window.ActiveXObject&&(e=new ActiveXObject("WPFPrintLib.WFMain"))}catch(t){KD.writeError(t),e=void 0}return e},getPrnAObjRet:function(e){var t=KD.parseObject(e),i=t.message.split("|"),a={success:t.IsSuccessful||i[0],printService:"KDActiveXPrinter",params:[null],pageId:t.pageId,jobId:t.jobId||i[1],message:i[2]||t.message,isoId:"",printAddress:""};if(KD.BatchPrintArgs){var n=KD.BatchPrintArgs[a.isoId];a.pageId=n?n.pageId:a.pageId}return a},getPrnJobInfo:function(e,t){var i=KDReportPlugInProxy.getPrnJobInfo(e,t);return i},selectPrinterByType:function(e,t,i){return KDActiveXPrinter.selectPrinterExt(e,t,i)},selectPrinter:function(e,t){return KDActiveXPrinter.selectPrinterExt(0,e,t)},queryPrinterInfo:function(e,t,i){var a="";if(!KD.supportActiveX())return alert(ResManager.LoadKDString("浏览器未支持ActiveX打印组件，请使用IE浏览器或者桌面客户端应用进行打印.","0991733000003982")),KD.isFunction(t)&&t(a),a;try{var n=KDActiveXPrinter.initPrnActiveXObj(),o=!KDActiveXPrinter.checkPrintVer(n);o&&(void 0==KDActiveXPrinter.isConfirmUpdate&&(KDActiveXPrinter.isConfirmUpdate=confirm(ResManager.LoadKDString("有新版本打印组件，要更新吗？","0991733000003983"))),KDActiveXPrinter.isConfirmUpdate||(o=!1));var r=function(o){if(e&&(a=n.QueryPrinterInfo(KD.stringify(e))),KD.isFunction(t)){var r={returnPack:KD.parseObject(a)};t(i,r)}};n&&!o?r(n):KDActiveXPrinter.downloadPrintMsi()}catch(s){alert("错误代码："+s.message)}return a},selectPrinterExt:function(e,t,i){var a="";if(!KD.supportActiveX())return alert(ResManager.LoadKDString("浏览器未支持ActiveX打印组件，请使用IE浏览器或者桌面客户端应用进行打印.","0991733000003982")),KD.isFunction(t)&&t(a),a;try{var n=KDActiveXPrinter.initPrnActiveXObj(),o=!KDActiveXPrinter.checkPrintVer(n);o&&(void 0==KDActiveXPrinter.isConfirmUpdate&&(KDActiveXPrinter.isConfirmUpdate=confirm(ResManager.LoadKDString("有新版本打印组件，要更新吗？","0991733000003983"))),KDActiveXPrinter.isConfirmUpdate||(o=!1));var r=function(o){if(a=0!=e?n.SelectPrinter(arguments[0]):n.GetPrinterName(),KD.isFunction(t)){var r={returnvalue:a,returnPack:{Selected:!!a,PrinterName:a}};t(i,r)}};n&&!o?r(n):KDActiveXPrinter.downloadPrintMsi()}catch(s){alert("错误代码："+s.message)}return a},printDocumentExt:function(e,t,i,a){i&&i.data&&(i.data=KD.stringify(i.data));var n=((i.pages||[])[0]||{}).printinfo||{};"ListReport"==e||n.printAddress?KDActiveXPrinter.printDocument(e,t,i,a):KDActiveXPrinter.selectPrinter(function(o,r){if(!KD.IsNullOrWhiteSpace((r||{}).returnvalue)){var s=r.returnvalue,l=n.printjobid;KDReportPlugInProxy.printJobState.set(KD.KDPrintConst.PrinterAddress,l,s);for(var d=0;d<i.pages.length;d++)i.pages[d].printinfo.printerAddress=s;KDActiveXPrinter.printDocument(e,t,i,a)}},a)},printDocument:function(e,t,i,a){var n=this;if(KD.supportActiveX()){var o=n.getPrnJobInfo(e,i);if(KDJSPrinter.checkMaxPagesRule(o,e,t,i)){var r=KDActiveXPrinter.initPrnActiveXObj(),s=!KDActiveXPrinter.checkPrintVer(r),l=function(a){try{a.SetHost(window),a.SetFunc("Finish","onPrinted"),a.SetFunc("PrintErr","onPrintedErr"),a.SetFunc("PageSetup","onPageSetup"),a.SetFunc("PreviewPrintBtnClick","onPreviewPrintBtnClick"),a.SetGraphicsMode(1);var n=KD.isString(i)?i:KD.stringify(i);a.Print(e,t,n)}catch(o){KD.writeError(o),alert(o.message)}};if(s&&(void 0==KDActiveXPrinter.isConfirmUpdate&&(KDActiveXPrinter.isConfirmUpdate=confirm(ResManager.LoadKDString("有新版本打印组件，要更新吗？","0991733000003983"))),KDActiveXPrinter.isConfirmUpdate||(s=!1)),r&&!s)l(r);else if(KDActiveXPrinter.downloadPrintMsi(),a&&a.onPrintedErr){var d={message:"upgrade!",isSuccess:!1};a.onPrintedErr.call(a,d)}}}else{var c=ResManager.LoadKDString("浏览器未支持ActiveX打印组件，请使用IE浏览器或者桌面客户端应用进行打印.","0991733000003982");if(alert(c),a&&a.onPrintedErr){var d={message:c,isSuccess:!1};a.onPrintedErr.call(a,d)}}},downloadPrintMsi:function(){var e=$('<iframe style="position:absolute;top:0px;left:0px;height:0px;width:1px;border:0px;" src="'+KD.getUrlRoot()+'/silverlight/WPFPrintSetup.msi"/>');e.ready(function(){$(this).remove()}),$(document.body).append(e)},getPrnJobInfo:function(e,t){var i=e,a=t,n={};switch(i){case"NoteReport":var o=a.pages[0].printinfo||{},r=KDReportPlugInProxy.printJobState.get(KD.KDPrintConst.PrinterAddress,o.printjobid);n={isoId:o.actionIsoId,jobId:o.printjobid,pageId:o.pageId,printAddress:r};break;case"ListReport":var s=KD.KDPrintConst.ListPrintJobId,o=a.PrintConfig||{},r=KDReportPlugInProxy.printJobState.get(KD.KDPrintConst.PrinterAddress,s);n={
isoId:o.actionIsoId,jobId:s,pageId:o.PageId,printAddress:r}}return n}}),define("KDActiveXPrinter",["KD"],function(e){return function(){var t;return t||e.KDActiveXPrinter}}(this)),function(e){function t(){return i()}function i(){var e=KDXmlUtils.getBigStr(function(){});return e}KDXmlUtils=function(){};var a=KDXmlUtils;$.extend(KDXmlUtils,{getBigStr:function(e){return e.toString().split("\n").slice(1,-1).join("\n")+"\n"},parseXml2Json:function(e){e=KDXmlUtils.clearXaml(e);var t=a.parseXml(e),i=a.xmltojson(t);return i},clearXaml:function(e){var t=e;return t.length>0&&"<"!=t.substr(0,1)&&(t=t.substr(1)),t},parseXml:function(t){var i={};try{i=a.createXMLDOM(),i.async=!1,i.loadXML(t)}catch(n){try{parser=new DOMParser,i=parser.parseFromString(t,"text/xml")}catch(n){e.writeError(n)}}return i},xmltojson:function(e){var t=void 0,i=e.childNodes;if(1==i.length)t=a.getXmlNodeAttrs(i[0]);else if(i.length>1){t=[];for(var n=0;i>n;n++){var o=a.getXmlNodeAttrs(i[n]);t.push(o)}}else t={};return t},getXmlNodeAttrs:function(t){var i={items:[]},n=t.attributes||[],o=t.childNodes||[];o.length;i.xtype=t.nodeName;for(var r=0;r<n.length;r++)n[r]&&n[r].nodeName&&n[r].nodeValue&&(n[r].nodeValue||"").toString().trim()&&(i[n[r].nodeName]=n[r].nodeValue);for(var r=0;r<o.length;r++){var s=o[r],l=a.getXmlNodeAttrs(s);"#text"!=s.nodeName?i.items.push(l):(s.nodeValue||"").toString().trim()&&(i.text=(i.text||"")+s.nodeValue)}return e.isEmpty(i.items)&&delete i.items,i},createXMLDOM:function(){var e;if(window.ActiveXObject)e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false";else{if(!document.implementation||!document.implementation.createDocument)return;e=document.implementation.createDocument("","",null)}return e},getDebugXML:function(){return t()}})}(KD),define("KDXmlUtils",["KD"],function(e){return function(){var t;return t||e.KDXmlUtils}}(this)),function(e){KDPrintXML2HTMLPaser=function(){},$.extend(KDPrintXML2HTMLPaser,{strategys:{Grid:"drawGrid",TextBlock:"drawTextBlock",Border:"drawBorder",Canvas:"drawCanvas",ResourceDictionary:"getResourceDictionary"},excludeArrange:{"Grid.Resources":!0,ResourceDictionary:!0,Style:!0,Setter:!0,"Grid.RowDefinitions":!0,RowDefinition:!0,"Grid.ColumnDefinitions":!0,ColumnDefinition:!0,"Canvas.Clip":!0},resourcesKeys:{"Grid.Resources":!0,"Canvas.Resources":!0},gridProps:{"Grid.RowDefinitions":!0,"Grid.ColumnDefinitions":!0},fetchResourceDictionary:function(e){for(var t={},i=e.items||[],a=0;a<i.length;a++)for(var n=i[a]||{},o=n.items||[],r=0;r<o.length;r++){var s=o[r],l={},d=s.items||[];if("system:String"==s.xtype)l.text=s.text;else for(var c=0;c<d.length;c++){var h=d[c];l[h.Property]=h.Value}t["{StaticResource Key}".replace("Key",s.Key||s["x:Key"])]=l}return t},fetchHightLvlProps:function(e){var t={};return(e.FontSize||0)>8&&(t.FontSize=e.FontSize),!!e.Background&&(t.Background=e.Background),t},arrangeModel:function(t,i,a){var n="Canvas.Left",o="Canvas.Top",r=KDPrintXML2HTMLPaser,s=t,l=t.items||[];if(e.isEmpty(i))for(var d=0;d<l.length;d++)if(r.resourcesKeys[l[d].xtype]){i=$.extend(i||{},r.fetchResourceDictionary(l[d]));break}for(var d=0;d<l.length;d++){var c=l[d];if(r.excludeArrange[c.xtype]){if(r.gridProps[c.xtype]){var h=c.xtype.replace("Grid.","");if(t[h]=c,"ColumnDefinitions"==h&&t.Width){var u=c.items||[],p=0,g=[];for(var f in u)e.isRunInForIn(f,u)&&(u[f].Width?p+=parseInt(u[f].Width):g.push(u[f]));var m=(parseInt(t.Width)-p)/g.length;for(var f in g)e.isRunInForIn(f,g)&&(g[f].Width=m)}}}else{var v="Image"!=c.xtype?c.Style||"":((c.Source||"").split(",")[0]||"").replace("{Binding Source=",""),y=i[v]||{};e.isEmpty(y)||($.extend(c,y,r.fetchHightLvlProps(c)),delete c.Style),"TextBlock"==c.xtype&&(c[n]||(c[n]=t[n]),c[o]||(c[o]=t[o])),r.arrangeModel(c,i,a),"Border"==t.xtype&&c.isPreviewWarn&&(t.isPreviewWarn=!0)}}if(a.isPreview){var b=s,D=12;if(b.Text&&b.FontSize<D){var k=e.format("({0}, {1})",b[n]||0,b[o]||0),C=ResManager.LoadKDString("浏览器最小可用字体为9号。","0025710030048139");msg=e.format(C,k,b.Text||"",b.FontSize,D),a.messages.push({model:b,message:msg}),b.warnMessage=msg,b.isPreviewWarn=!0}}return s},draw:function(e,t,i){var a={message:"",detailMessage:"",messages:[],isSuccess:!1,isPreview:e.hasClass("__jspreview_content")},n=KDPrintXML2HTMLPaser;if(t&&t.xaml){var o=KDXmlUtils.parseXml2Json(t.xaml),r={},s=n.arrangeModel(o,r,a),l=n.generalHtml(s,i);e.append($(l).css({"background-color":"rgb(255,255,255)"})),a.isSuccess=!0}else a.message=ResManager.LoadKDString("没有可用页面数据！","0025710000008026"),e.append($('<div style="block"><span>'+ret.message+"</span></div>").css({"background-color":"rgb(255,255,255)"}));var d=new stringBuilder,c=a.messages,h=7;if(c.length>0){for(var u=0;u<c.length&&h>u;u++){var p=c[u];p.message&&d.appendLine(p.message)}a.message=ResManager.LoadKDString("存在浏览器未支持的数据！","0025710030046576"),a.detailMessage=d.toString()+(c.length>h?"...":"")}return a},generalHtml:function(t,i){var a=KDPrintXML2HTMLPaser,n=$('<div style="display:inline-block;">DOMParser!</div>'),o=a["general"+t.xtype];if(e.isFunction(o)){t.isRoot=!0;var r={position:"Canvas"==t.xtype?"relative":"",width:parseInt(t.Width),height:parseInt(t.Height)};i.isHTMLPrinting&&(r.height="auto"),n.empty().css(r).append(o(t,i))}var s=i.isHTMLPrinting?n[0].innerHTML:n[0].outerHTML;return s},generalChildren:function(t,i,a){for(var n=KDPrintXML2HTMLPaser,o=i.items||[],r=0;r<o.length;r++){var s=o[r],l=n["general"+s.xtype];if(e.isFunction(l)){s.container=i;var d=l(s,a);t.append(d)}}},generalGrid:function(t,i){var a=KDPrintXML2HTMLPaser,n=i.isHTMLPrinting&&t.isRoot,o=parseInt(t.Height),r=parseInt(t.Width),s={border:"0 solid",height:o,width:r,display:"block",position:"relative","background-color":"rgb(255, 255, 255)"};n&&(o-=parseInt(((i.TopMargin+i.BottomMargin)/254*96).toString()),r-=parseInt(((i.LeftMargin+i.RightMargin)/254*96).toString()),$.extend(s,{top:0,left:0,overflow:"hidden",width:r,height:o}));var l=t.Height&&t.Width?'height="'+o+'px" width="'+r+'px"':"",d=t["data-type"]?'data-type="'+t["data-type"]+'"':"",c=$('<div class="kd-jsprinter kd-jsprinter-canvas">').css(s),h=$("<table "+l+' cellpadding="0" cellspacing="0" '+d+"></table>").appendTo(c),u={display:"block"};t.Width||$.extend(u,{width:"100%"}),t.Height&&$.extend(u,{height:o}),h.css(u);var p=(t.RowDefinitions||{}).items||[{Height:"25"}],g=(t.ColumnDefinitions||{}).items||[{Width:"36"}],f=[];if("True"==(t["Grid.InnerMerger"]||"")){var m={};for(var v in t.items)if(e.isRunInForIn(v,t.items)){var y=t.items[v]||{};if("Border"==y.xtype){var b=parseInt(y["Grid.Row"]||"0"),D=parseInt(y["Grid.Column"]||"0"),k=e.format("R{0}C{1}",b,D);m[k]=y}}for(var C=0;C<p.length;C++){for(var x=[],w=0;w<g.length;w++){var K=!1,k=e.format("R{0}C{1}",C,w),S=m[k];if(!e.isEmpty(S)){K=!0;var I=parseInt((S||{})["Grid.ColumnSpan"]||"1"),P=parseInt((S||{})["Grid.RowSpan"]||"1");if(I>1)for(var v=w+1;v<g.length;v++){var F=e.format("R{0}C{1}",C,v),y=m[F];y&&(y["Grid.Column"]=e.format("{0}",parseInt(y["Grid.Column"]||"1")-I+1))}if(P>1)for(var v=1;P>v;v++)for(var T=w+1;T<g.length;T++){var F=e.format("R{0}C{1}",C+v,T),y=m[F];y&&(y["Grid.Column"]=e.format("{0}",parseInt(y["Grid.Column"]||"1")-1))}}K&&x.push(g[w])}f.push(x)}}for(var _={},C=0;C<p.length;C++){var A=_[C]=$("<tr></tr>").appendTo(h),o=!n||0!=C&&C!=p.length-1?parseInt(p[C].Height):0,L={height:o,"max-height":o,"min-height":o};p[C].Height&&A.css(L).attr({height:o});for(var M=f[C]||g||[],w=0;w<M.length;w++){var E=M[w];if(!e.isEmpty(E)){var B=$('<td valign="top"></td>').appendTo(A),r=!n||0!=w&&w!=M.length-1?parseInt(E.Width):0,R={width:r,"max-width":r,"min-width":r};E.Width&&B.css(R).attr({width:r})}}$('<td style="width:100%"></td>').appendTo(A)}for(var N=t.items||[],C=0;C<N.length;C++){var H=N[C],O=H["Grid.ColumnSpan"]||1,V=H["Grid.RowSpan"]||1;if(handler=a["general"+H.xtype],e.isFunction(handler)){var j=handler(H,i),z=H["Grid.Row"]||0,E=H["Grid.Column"]||0,U=_[z]||_[0],q=$(U[0].cells[E])||$(U[0].cells[0]);q&&V>1&&((q[0]||{}).rowSpan=V),q&&O>1&&((q[0]||{}).colSpan=O),j&&q&&q.append(j)}}return c},generalCanvas:function(t,i){var a=KDPrintXML2HTMLPaser,n=i.isHTMLPrinting&&t.isRoot,o=parseInt(t.Width),r=parseInt(t.Height),s=parseInt(t["Canvas.Left"]||0),l=parseInt(t["Canvas.Top"]||0),d=$('<div class="kd-jsprinter kd-jsprinter-canvas" style="@media:print;">').css({position:"absolute",left:s,top:l,width:o,height:r});for(var c in t.items)if(e.isRunInForIn(c,t.items)){var h=t.items[c],u=parseInt(h["Canvas.Left"]||0),p=parseInt(h["Canvas.Top"]||0);"Canvas"==h.xtype&&$.extend(h,{Width:h.Width?h.Width:o-u,Height:h.Height?h.Height:r-p})}return a.generalChildren(d,t,i),n&&(d=$(d[0].innerHTML).css({top:0,left:0,position:"relative"})),KDPrintXML2HTMLPaser.debugAppendGeneralItem(d,i),d},isAbsPos:function(e){return void 0!==e["Canvas.Left"]},convertXAMLColor:function(e,t){var i=e||t||"#00FFFFFF";return i="#00FFFFFF"==i?"":9==i.length?"#"+i.substr(3):i},getThickness:function(e){var t=(e||"0,0,0,0").split(",");return{left:parseInt(t[0]||"0"),top:parseInt(t[1]||"0"),right:parseInt(t[2]||"0"),bottom:parseInt(t[3]||"0")}},getBorderHeight:function(e,t){var i=e.Height?parseFloat(e.Height)-2*(t.top+t.bottom||1):KDListReportHelper.cellDefaultHeight-3;return i},getBorderWidth:function(e,t){var i=e.Width?parseFloat(e.Width)-2*(t.left+t.right||1):"";return i},generalBorder:function(t,i){var a=KDPrintXML2HTMLPaser,n=a.convertXAMLColor(t.Background),o=a.convertXAMLColor(t.BorderBrush);o=9==o.length?"#"+o.substr(3):o;var r=$('<div class="kd-jsprinter kd-jsprinter-border">'),s=a.getThickness(t.BorderThickness),l=a.getThickness(t.Padding),d={display:"block","background-color":n,"border-left":(s.left?s.left+"px solid":"")+" "+o,"border-top":(s.top?s.top+"px solid":"")+" "+o,"border-right":(s.right?s.right+"px solid":"")+" "+o,"border-bottom":(s.bottom?s.bottom+"px solid":"")+" "+o,"padding-left":l.left,"padding-top":l.top,"padding-right":l.right,"padding-bottom":l.bottom,height:a.getBorderHeight(t,s),width:a.getBorderWidth(t,s),"text-align":t.TextAlignment||"left"};if(1==t.items.length&&"TextBlock"==t.items[0].xtype&&$.extend(d,{overflow:"hidden"}),a.isAbsPos(t)){var c=parseFloat(t["Canvas.Left"]),h=parseFloat(t["Canvas.Top"]),u=c-Math.round(1e4*c)/1e4,p=h-Math.round(1e3*h)/1e3;r.attr({"data-cleft":c,"data-ctop":h}),$.extend(d,{display:"inline-block",position:"absolute",left:c,top:h,transform:e.format("translateX({0}px) translatey({1}px)",u,p)})}return t.isPreviewWarn&&$.extend(d,{borderBottom:"1px dotted #f58368",cursor:"help"}),r.css(d),a.generalChildren(r,t,i),r},generalTextBlock:function(t,i){var a=KDPrintXML2HTMLPaser,n=a.convertXAMLColor(t.Foreground,"#FF000000"),o=t.container||{},r=a.getThickness(o.BorderThickness),s="Wrap"==t.TextWrapping,l=parseFloat(t.FontSize),d=t.FontStyle||"normal",c=e.format("{0}",t.TextDecorations||"").toLowerCase().replace(","," ").replace("strikethrough","line-through"),h={overflow:"hidden","font-family":t.FontFamily,"font-size":t.FontSize?l:"inherit","font-style":d,"font-weight":(t.FontWeight||"").toLowerCase(),display:"block","vertical-align":"middle","text-align":t.TextAlignment||"",color:9==n.length?"#"+n.substr(3):n,"word-wrap":s?"break-word":"",padding:t.Padding||"1px"},u=12,p=l/u,g=1>p?1/p:1;1!=g&&$.extend(h,{fontSize:u,transformOrigin:"left "+("Bottom"==t.VerticalAlignment?"bottom":"top"),transform:e.format("scale({0})",p)});var f=void 0!==o["Canvas.Top"]||void 0!==o["Canvas.Left"];if("Top"==t.VerticalAlignment){var m=o.Width?o.Width-3:o.Width;$.extend(h,{width:(t.Width||m)*g||""})}else if("Bottom"==t.VerticalAlignment){var m=o.Width?o.Width-3:o.Width;$.extend(h,{width:(t.Width||m)*g||""}),f&&$.extend(h,{position:"absolute",bottom:1})}else if("Center"==t.VerticalAlignment){var m=o.Width?o.Width-3:o.Width;$.extend(h,{width:(t.Width||m)*g||"",display:"table",height:a.getBorderHeight(o,r)*g})}t.Height&&!e.isNaN(parseFloat(t.Height))&&(h.height=t.Height*g);var v=e.htmlUtil.encode(t.Text||""),y="",b="";v=v.replace(/[ ]/g,"&ensp;").replace(/[　]/g,"&emsp;").replace(/\n/g,"<br>");var D=(e.isNumber(h["font-size"])?h["font-size"]+2:14)*g,k="line-height:"+D+"px;width:"+h.width+"px;";return k+=s?"display:block;word-wrap:break-word;":"display:inline-block;height:auto;overflow:hidden;white-space:nowrap;",c&&(k+=e.format("text-decoration: {0} 1px;",c)),t.warnMessage&&(y=e.htmlUtil.encode(t.warnMessage.replace(/"/g,'"'))),v=e.format('<span style="{0}" title="{1}">{2}</span>',k,y,v),"table"==h.display&&(v=e.format('<span style="display:table-cell;vertical-align:middle;">{0}</span>',v)),b=$(e.format('<span class="kd-jsprinter kd-jsprinter-textblock">{0}</span>',v)).css(h)},generalImage:function(e,t){var i=$('<image class="kd-jsprinter kd-jsprinter-image" style="height:inherit;width:inherit;">');return e.text&&i.attr({src:"data:image/jpeg;base64,"+e.text}),i},generalline:function(t,i){var a=$('<div class="kd-jsprinter kd-jsprinter-line" style="height:0px;">'),n=parseFloat(t.X1),o=parseFloat(t.X2),r=parseFloat(t.Y1),s=parseFloat(t.Y2),l=o-n,d=s-r,c=Math.sqrt(Math.pow(l,2)+Math.pow(d,2)),h=Math.round(180*Math.asin(d/c)/Math.PI,2),u=(t.StrokeDashArray||"3,3",t.StrokeThickness||"1"),p="0px solid transparent",g=t.Stroke||"transparent";return opt={display:"inline-block",position:"absolute",left:n,top:r,width:c,transformOrigin:"0 0",transform:e.format("rotate({0}deg)",h),borderTop:e.format("{0}px dashed {1}",u,g),borderBottom:p,borderLeft:p,borderRight:p},a.css(opt),a},debugAppendGeneralItem:function(t,i){if(e.isDebug()){var a={xtype:"Line",Stroke:"Red",X1:"0",X2:"122",Y1:"0",Y2:"54",StrokeThickness:"1",StrokeDashArray:"3,3"},n=KDPrintXML2HTMLPaser["general"+a.xtype];e.isFunction(n)&&t.append(n(a,i))}}})}(KD),define("KDPrintXML2HTMLPaser",["KD","KDXmlUtils"],function(e){return function(){var t;return t||e.KDPrintXML2HTMLPaser}}(this)),function(e){function t(i,a){var n=void 0;for(var o in a)if(e.isRunInForIn(o,a)){var r=a[o]||{},s=r.id;if(i&&e.equalsIgnoreCase(i,s)){n=r;break}e.isEmpty(r.items)||(n=t(i,r.items))}return n}function i(e,t,i){var a=e.initToolbar(null,t,function(t){e.onToolbarItemClick.call(e,t)}),n=i.sender.element;formTbr=$(".__jspreview_toolbar",n).empty().append(a)}function a(t){var a=t,n=(window.innerHeight||600)-80;try{var o=window.__previewProxy||{};e.isFunction(o.release)&&o.release.call(o);var r=$(".__jspreview").data("kendoWindow");r&&r.close(),$(".__jspreview").remove()}catch(s){e.writeError(s)}var l=a.dataProxy&&e.isFunction(a.dataProxy.hasPageSetup)&&a.dataProxy.hasPageSetup(),d=$('<div class="__jspreview" style="overflow:hidden;">').appendTo($(document.body));$('<div class="__jspreview_toolbar" style="height:35px;">').appendTo(d),$('<div class="__jspreview_content" style="overflow:scroll;background-color:rgb(220,220,220);display:inline-block;padding:20px 20px;display:block;height:inherit;text-align:center">').appendTo(d),$('<div class="__jspreview_status" style="padding: 3px; height:21px;"><span class="__jspreview_status_text"></span><span class="__jspreview_status_message"></span></div>').appendTo(d);return d.kendoWindow({title:ResManager.LoadKDString("打印预览","0025710000007617"),actions:["Maximize","Close"],height:n,width:.618*n/.382,close:function(e){e.sender.wrapper.remove(),a&&a.release()},resize:function(){a.doLayout.call(a)},open:function(t){e.isFunction(a.initToolbar)?i(a,l,t):_initOldToolbar(a,l,t),a.doLayout.call(a),a.opened.call(a);var n=d.data("kendoWindow");n&&e.isFunction(n.center)&&n.center(),e.delayInvoke(function(){var t=1==e.getLocalConfiguration().IsDefNomalPreviewWindow;t||n&&e.isFunction(n.maximize)&&n.maximize();var i=1==e.getLocalConfiguration().IsPreviewAutoSize;i&&e.delayInvoke(function(){e.isFunction(a.__zoomPageFitFill)&&a.__zoomPageFitFill.call(a)},200)},200)}}),d}KDJSPreviewProxy=function(){},$.extend(KDJSPreviewProxy.prototype,{zoomLevels:[0,.5,.75,1,1.5,2,3,5],defaultItemKeys:{},reqProxyGotoPageCmds:{btnPv_FirstPg:!0,btnPv_LastPg:!0,btnPv_NextPg:!0,btnPv_PrevPg:!0,tbFirst:!0,tbLast:!0,tbNext:!0,tbPrevious:!0},reqProxyCmds:{btnPv_Print:!0,btnPv_Setting:!0,tbPrint:!0,tbPageSetup:!0},init:function(e,t){var i=this;i.rptOptions=e,i.dataProxy=t},getData:function(){var e=this,t=e.dataProxy||{},i=t.printPack||{},a=i.data||{};return a},getTotalPages:function(){var e=this,t=e.dataProxy.getTotalPages();return t},doCommand:function(e){var t=this;t.dataProxy.modelCommandHandler(e)},getPrnPage:function(e){var t=this,i=t.dataProxy.getPrnPage(e);return i},opened:function(){var e=this;window.__previewProxy=e,e.currentPageIndex=0,e.zoomLevel=3,e.drawPage(e.currentPageIndex),e.dataProxy.fireEvents("PrintVewShow","preview"),e.previewForm&&e.previewForm.off("keydown").on("keydown",function(t){e.onPreviewFormKeyDown.call(e,t)})},getFormProxy:function(){var e=this;return e.dataProxy&&e.dataProxy.owner?e.dataProxy.owner:!1},getShortCutKey:function(t){var i=t.key||String.fromCharCode(t.keyCode||t.which),a=t.ctrlKey||t.metaKey,n=t.shiftKey,o=t.altKey,r=[];a&&r.push("Control"),n&&r.push("Shift"),o&&r.push("Alt");var s=i;return t.code&&e.CONST.ShortCutKeyToggle[t.code]&&(s=e.CONST.ShortCutKeyToggle[t.code]),-1==r.indexOf(s)&&r.push(s.toUpperCase()),r},getExistShutCutBarItem:function(e){var t=void 0,i=this,a=i.tbarPxy,n=e.sort().toString().toUpperCase();if(a)for(var o=a.shortcutkeyContainer||[],r=0;r<o.length;r++){var s=o[r].shortcut||[];if(s.sort().toString().toUpperCase()==n){t=o[r];break}}return t},onPreviewFormKeyDown:function(t){var i=this,a=t.keyCode||t.which||t.charCode;if(112==a)t.preventDefault(),t.stopPropagation();else if(t&&e.isCombinationOrFunctionKey(t)){var n=i.getShortCutKey(t),o=i.getExistShutCutBarItem(n),r=i.tbarPxy;if(r&&o)r.toolBarItemClick.call(r,o.id);else{var s=n.join(" + ");i.fireExtendCommand.call(i,s)}}},onToolbarItemClick:function(i){var a=this,n=i,o=a.currentPageIndex||0,r=a.getTotalPages(),s=((a.tbarPxy||{}).config||{}).items||[];switch(tbItem=t(i,s)||{},afterClose=tbItem.afterclose,n){case"tbFirst":if(0>=r)return;a.currentPageIndex=0;break;case"tbLast":if(0>=r)return;a.currentPageIndex=r-1;break;case"tbNext":if(o+1>=r)return;a.currentPageIndex++;break;case"tbPrevious":if(0>o-1)return;a.currentPageIndex--;break;case"tbPrint":var l=a.getFormProxy();l&&l.fireEvent.call(l,"ButtonClick","Kingdee.BOS.PrintViewPrint","Kingdee.BOS.PrintViewPrint",null);break;case"tbPageSetup":break;case"tbZoomIn":delete a.zoomScale,a.zoomLevel++,a.zoomLevel>a.zoomLevels.length-1&&(a.zoomLevel=a.zoomLevels.length-1),a.__zoomPage();break;case"tbZoomOut":delete a.zoomScale,a.zoomLevel--,a.zoomLevel<1&&(a.zoomLevel=1),a.__zoomPage();break;case"tbClose":a.close();break;case"tbZoomFill":a.__zoomPageFitFill();break;default:var d="tbZoom_";if(e.equalsIgnoreCase(d,n.substr(0,d.length))){var c=parseInt(n.substr(d.length));!e.isNaN(c)&&c&&(delete a.zoomScale,a.zoomLevel=c,a.__zoomPage())}}(KDJSPreviewProxy.isReqCmds(n)||KDJSPreviewProxy.isGotoPage(n)||!KDJSPreviewProxy.isDefaultItem(n))&&a.fireExtendCommand.call(a,n),afterClose&&a.close()},fireExtendCommand:function(e){var t=this;t.doCommand.call(t,{cmdKey:e,scope:t,currentPageIndex:t.currentPageIndex||0,callback:function(e){KDJSPreviewProxy.isGotoPage(e.cmdKey)?(t.drawPage.call(t,t.currentPageIndex),t.__zoomPageFitFill.call(t)):t.close.call(t)}})},onCommand:function(t){var i=this,a=t.target,n=a.data("button").options.id,o=i.currentPageIndex||0,r=i.getTotalPages();switch(n){case"btnPv_FirstPg":if(0>=r)return;i.currentPageIndex=0;break;case"btnPv_LastPg":if(0>=r)return;i.currentPageIndex=r-1;break;case"btnPv_NextPg":if(o+1>=r)return;i.currentPageIndex++;break;case"btnPv_PrevPg":if(0>o-1)return;i.currentPageIndex--;break;case"btnPv_Print":var s=i.getFormProxy();s&&s.fireEvent.call(s,"ButtonClick","Kingdee.BOS.PrintViewPrint","Kingdee.BOS.PrintViewPrint",null);break;case"btnPv_Setting":break;case"btnPv_ZoomIn":i.zoomLevel++,i.zoomLevel>i.zoomLevels.length-1&&(i.zoomLevel=i.zoomLevels.length-1),i.__zoomPage();break;case"btnPv_ZoomOut":i.zoomLevel--,i.zoomLevel<1&&(i.zoomLevel=1),i.__zoomPage();break;case"btnPv_Close":i.close();break;default:var l=parseInt(n.substr("btnPv_Zoom_".length));!e.isNaN(l)&&l&&(i.zoomLevel=l,i.__zoomPage())}(KDJSPreviewProxy.isReqCmds(n)||KDJSPreviewProxy.isGotoPage(n))&&i.fireExtendCommand.call(i,scStr)},showMessage:function(e){var t=this;t.__updateStatusText(e)},__updateStatusText:function(t){var i=this,a=$(".__jspreview_status_text",i.previewForm),n=($(".__jspreview_status_message",i.previewForm),(t||{}).message||(t||{}).msg||"",(t||{}).detailMessage||"",(i.currentPageIndex||0)+1),o=i.getTotalPages(),r=0==o?ResManager.LoadKDString("当前没有数据","0025710000004280"):ResManager.LoadKDString("当前第{0}页/总共{1}页","0025710000007953");a.text(e.format(r,n,o))},__zoomTableMakeUp:function(t){var i=this,a=$(".__jspreview_content",i.previewForm);e.delayInvoke(function(){$('[data-type="list data area"] tbody:eq(0)',a).css({zoom:1>t?1-.08*(1-t):1})},100)},__zoomPage:function(){var e=this,t=$(".__jspreview_content",e.previewForm),i=parseFloat(e.zoomScale||e.zoomLevels[e.zoomLevel]);t.children().css({zoom:i}),e.__zoomTableMakeUp.call(e,i)},__zoomPageFitFill:function(){var t=1==e.getLocalConfiguration().IsPreviewAutoSize;if(t){var i=this,a=$(".__jspreview_content",i.previewForm),n=a.height(),o=e.parseObject((i.dataProxy.dataPack.PrintConfig||{}).PrintPageSetting),r=(o||{}).paperheight||n;e.isEmpty(o)&&(o=((i.dataProxy.dataPack.pages||[])[i.currentPageIndex]||{}).printinfo,r=e.equalsIgnoreCase(o.orientation,"LANDSCAPE")?o.paperwidth:o.paperheight),i.zoomScale=n/r;for(var s=0;s<i.zoomLevels.length;s++){var l=i.zoomLevels[s];if(l>i.zoomScale){i.zoomLevel=0==s?0:s-1;break}}a.children().css({zoom:i.zoomScale}),i.__zoomTableMakeUp.call(i,i.zoomScale)}},drawPage:function(t){var i=this,a=$(".__jspreview_content",i.previewForm),n=i.getData(),o=e.cloneObject(n.printSetting),r=i.getPrnPage(t);a.empty();var s=KDPrintXML2HTMLPaser.draw(a,r,o);a.append($('<div style="width:1px;height:30px;display:block;"/>')),i.__zoomPage(),i.__updateStatusText(s)},show:function(){var t=this;e.delayInvoke(function(){t.previewForm=a(t)})},close:function(){var e=this,t=e.previewForm?e.previewForm.data("kendoWindow"):void 0;t&&t.close()},doLayout:function(){var e=this;e.previewForm=e.previewForm||$(".__jspreview"),$(".__jspreview_content",e.previewForm).css({height:e.previewForm.height()-120})},release:function(){var e=this;e.dataProxy.fireEvents("PrintVewClose","preview"),e.previewContent&&delete e.previewContent,e.tbarPxy&&e.tbarPxy.release.call(e._toolBarProxy),e.previewForm&&(e.previewForm.off("keydown"),e.close(),delete e.previewForm),delete window.__previewProxy},initToolbar:function(t,i,a){var n=this,o=t||n.getMenuMetaData(i),r=void 0;if(o){var s=n.dataProxy.owner;o.entryKey=s.pageId,o=n.initMenuBarState(o),o=n.fixedMenuBarMetaFromDefault(o,"tbZoomFill",i);var l=s.controlFactoryProxy,d=l.getCmp.call(l,o.id);d&&d.release&&d.release.call(d);var c=n.tbarPxy=l.createControl.call(l,o);c.loadConfig.call(c,o),c.initComponent.call(c),e.isFunction(a)&&(c.toolBarItemClick=a),r=c.el}return r},fixedMenuBarMetaFromDefault:function(t,i,a){var n=this,o=t;try{for(var r=t.items||[],s=!1,l=0;l<r.length;l++){var d=r[l],c=d.id||"";if(e.equalsIgnoreCase(c,i)){s=!0;break}}if(!s&&r.length>1)for(var h=n.getMenuMetaData(a),u=h.items||[],l=0;l<u.length;l++){var d=u[l],c=d.id||"";if(e.equalsIgnoreCase(c,i)){r.splice(1,0,d);break}}}catch(p){}return o},getSvrPrintSetting:function(){var e=this,t={};return t=((((e.dataProxy||{}).printArg||{}).printConfig||{}).ServicePara||{}).printConfig||{}},initMenuBarState:function(i){var a=this,n=i;try{var o=a.getSvrPrintSetting();if(e.isEmpty(o))return n;var r=o.ButtonMetaData;e.isEmpty(r)||(n=$.extend({entryKey:"printpreview",height:34,dock:e.dock.Top,actionKey:"EntryBarItemClick"},r));var s=o.ButtonSetting,l=(s||{}).states,d=(n||{}).items;if(e.isEmpty(l)||e.isEmpty(d))return n;for(var c in l)if(e.isRunInForIn(c,l)){var h=l[c]||{},u=h.key,p=t(u,d);if(!e.isEmpty(p))for(var g in h)if(!e.equalsIgnoreCase("key",g)){var f=h[g];void 0!==f&&(p[g]=f)}}}catch(m){e.writeError(m)}return n},getMenuMetaData:function(t){var i={id:"_preview_toolbar",entryKey:"printpreview",xtype:"toolbar",height:34,dock:e.dock.Top,actionKey:"EntryBarItemClick",items:[{xtype:"splitbutton",id:"tbZoom",showTitle:!0,text:ResManager.LoadKDString("缩放","0025710000007954"),items:[{text:"50%",id:"tbZoom_1",xtype:"button",disabled:!1,visible:!0},{text:"75%",id:"tbZoom_2",xtype:"button",disabled:!1,visible:!0},{text:"100%",id:"tbZoom_3",xtype:"button",disabled:!1,visible:!0},{text:"150%",id:"tbZoom_4",xtype:"button",disabled:!1,visible:!0},{text:"200%",id:"tbZoom_5",xtype:"button",disabled:!1,visible:!0},{text:"300%",id:"tbZoom_6",xtype:"button",disabled:!1,visible:!0},{text:"500%",id:"tbZoom_7",xtype:"button",disabled:!1,visible:!0}]},{shortcut:"Shift + F",xtype:"button",id:"tbZoomFill",showTitle:!0,text:ResManager.LoadKDString("适应窗口","0025710030046774"),tooltipType:"Shift + F",disabled:!1,visible:1==e.getLocalConfiguration().IsPreviewAutoSize,icon:"",showprocessbar:!1},{shortcut:"Shift + A",xtype:"button",id:"tbZoomIn",showTitle:!0,text:ResManager.LoadKDString("放大","0025710000007619"),disabled:!1,visible:!0,tooltipType:"Shift + A",icon:"",showprocessbar:!1},{shortcut:"Shift + S",xtype:"button",id:"tbZoomOut",showTitle:!0,text:ResManager.LoadKDString("缩小","0025710000007620"),disabled:!1,visible:!0,tooltipType:"Shift + S",icon:"",showprocessbar:!1},{shortcut:"Control + P",xtype:"button",id:"tbPrint",showTitle:!0,text:ResManager.LoadKDString("打印","0025710000007618"),disabled:!1,visible:!0,tooltipType:"Control + P",icon:"tbtn_print.gif",showprocessbar:!1},{shortcut:"Control + S",xtype:"button",id:"tbPageSetup",showTitle:!0,text:ResManager.LoadKDString("设置","0991733000003906"),disabled:!1,visible:!!t,tooltipType:"Control + S",icon:"tbtn_pagesetup.gif",showprocessbar:!1},{shortcut:"Shift + Home",xtype:"button",id:"tbFirst",showTitle:!0,text:ResManager.LoadKDString("首页","0025710030032942"),disabled:!1,visible:!0,tooltipType:"Control + Home",icon:"tbtn_first.gif",showprocessbar:!1},{shortcut:"Shift + L",xtype:"button",id:"tbPrevious",showTitle:!0,text:ResManager.LoadKDString("上一页","0991733030032097"),disabled:!1,visible:!0,tooltipType:"Shift + L",icon:"tbtn_previous.gif",showprocessbar:!1},{shortcut:"Shift + N",xtype:"button",id:"tbNext",showTitle:!0,text:ResManager.LoadKDString("下一页","0991733000003895"),disabled:!1,visible:!0,tooltipType:"Shift + N",icon:"tbtn_next.gif",showprocessbar:!1},{shortcut:"Shift + End",xtype:"button",id:"tbLast",showTitle:!0,text:ResManager.LoadKDString("末页","0025710000008024"),disabled:!1,visible:!0,tooltipType:"Shift + End",icon:"tbtn_last.gif",showprocessbar:!1},{shortcut:"Shift + Escape",xtype:"button",id:"tbClose",showTitle:!0,text:ResManager.LoadKDString("退出","0025710000008025"),disabled:!1,visible:!0,tooltipType:"Shift + Escape",icon:"tbtn_quit.gif",showprocessbar:!1}]};return KDJSPreviewProxy.setDefaultItemKeys(i),i}}),$.extend(KDJSPreviewProxy,{isGotoPage:function(e){return!!KDJSPreviewProxy.prototype.reqProxyGotoPageCmds[e]},isReqCmds:function(e){return!!KDJSPreviewProxy.prototype.reqProxyCmds[e]},isPrint:function(e){return"btnPv_Print"==e||"tbPrint"==e},isPageSetup:function(e){return"btnPv_Setting"==e||"tbPageSetup"==e},isDefaultItem:function(e){return!!KDJSPreviewProxy.prototype.defaultItemKeys[e]},setDefaultItemKeys:function(t){var i=KDJSPreviewProxy,a=(t||{}).items||[],n=KDJSPreviewProxy.prototype.defaultItemKeys;for(var o in a)if(e.isRunInForIn(o,a)){var r=a[o],s=(r||{}).id||"";s&&(n[s]=!0),e.isArray(r.items)&&i.setDefaultItemKeys(r)}},showMessage:function(t){var i=!0,a=window.__previewProxy||{};return i=e.isFunction(a.showMessage)?a.showMessage.call(a,t):!1}})}(KD),define("KDJSPreviewProxy",function(){}),function(e){function t(){var t=!e.isMacOS();return t}function i(e){var t=e.printJobId||"default";return"__jsDocPrint_"+t}function a(t){var a=t,n=i(t),o="simsun";try{var r=$("#"+n).data("kendoWindow");r&&r.close(),$("#"+n).remove()}catch(s){e.writeError(s)}var l=(t.dataProxy&&e.isFunction(t.dataProxy.hasPageSetup)&&t.dataProxy.hasPageSetup(),$('<div id="'+n+'" class="__jsDocPrint" style="overflow:hidden;">').appendTo($(document.body))),d=$('<div id="'+n+'_prograssbar" class="__jsDocPrint_prograssbar" style="overflow:hidden;overflow:hidden;background:white;height:100%;display: block;text-align:center;padding:20px;">').appendTo(l),c=$('<iframe class="__jsDocPrint_frame" src="about:blank" />').appendTo(l);t.prograssbar=d,c.off("load").on("load",function(t){frameBody=$($(t.target).contents()[0].body),frameBody.css({"font-size":"12px","font-family":e.format("arial,{0}",o),margin:0,padding:0}),a.prnDocContainer=frameBody,a.prnDocContainer.ready(function(){a.doLayout.call(a),a.opened.call(a)})});$('<div class="__jspreview_status" style="padding: 3px; height:21px;"><span class="__jsDocPrint_status_text"></span></div>').appendTo(l);l.kendoWindow({title:ResManager.LoadKDString("金蝶提示","0991733000004008"),actions:["Close"],width:240,height:100,close:function(e){e.sender.wrapper.remove(),a&&a.release()},resize:function(){a.doLayout.call(a)},open:function(e){e.sender.element}});var h=l.data("kendoWindow");return h&&e.isFunction(h.center)&&h.center(),l}function n(e){var t=void 0,a="#"+i(e),n=$("iframe",a)[0];return n&&n.contentWindow&&(t=n.contentWindow),t}function o(t,i){i&&(i.print(),t&&e.isFunction(t.close)&&t.close.call(t))}function r(e){var t=n(e);o(e,t)}KDHTMLPrintDocProxy=function(){},$.extend(KDHTMLPrintDocProxy.prototype,{drawPage:function(t){var i=this,a=i.getDocContainer(),n=i.getData(),o=e.cloneObject(n.printSetting),r=(o.PrintJobId,i.getPrnPage(t));$("<!--startprint"+t+"-->").appendTo(a),o.isHTMLPrinting=!e.equalsIgnoreCase("false",e.getConnectConfig().isHTMLDocPrintRawData),KDPrintXML2HTMLPaser.draw(a,r,o),$("<div style='@media:print; page-break-after:always; height:0px;'>").appendTo(a),$("<!--endprint"+t+"-->").appendTo(a)},setData:function(e,t,i){var a=this;a.rptOptions=e,a.prnPack=i,a.dataProxy=t,a.isDataReady=!0},drawPages:function(){var e=this;e.isUIReady&&e.drawPagesCore()},drawPagesCore:function(){var i=this;if(!i.isDrawing){i.isDrawing=!0;var a=i.getTotalPages();i.prograssbar.text(ResManager.LoadKDString("正在生成打印页面！","00214298000004760")),e.delayInvoke(function(){for(var o=0;a>o;o++)i.drawPage(o);i.prograssbar.text(ResManager.LoadKDString("正在打印！","00214298000004761")),e.delayInvoke(function(){if(t()){var a=n(i);if(a){a.afterPrint=function(){i.close.call(i)};var o="";e.isDebug()&&(o="debugger;");var s="<script type='text/javascript'> this.focus(); this.print(); "+o+" window.afterPrint();</script>",l=i.getDocContainer.call(i);$(s).appendTo(l)}else i.close.call(i)}else r(i)})})}},show:function(){var t=this;t.isShowed||(t.isShowed=!0,e.delayInvoke(function(){t.prnDocForm=a(t)}))},opened:function(){var e=this;e.prograssbar.text(ResManager.LoadKDString("正在获取打印数据！","00214298000004762")),e.isUIReady=!0,e.isDataReady&&e.drawPagesCore()},close:function(){var t=this;e.isFunction(t.releaseCallback)&&t.releaseCallback(t.printJobId||"default"),t.isDrawing=!1,t.isDataReady=!1,t.isUIReady=!1,t.isShowed=!1;var i=t.prnDocForm?t.prnDocForm.data("kendoWindow"):void 0;i&&i.close()},getData:function(){var e=this,t=e.prnPack||{},i=t.data||{};return i},getPrnPage:function(e){var t=this,i=t.getData(),a=i.pages||[],n=a[e]||{xaml:t.dataProxy.getMessagePageTemplate(),index:e,printinfo:(a[0]||{}).printinfo||{}};return n},getTotalPages:function(){var e=this,t=e.dataProxy.getTotalPages();return t},doCommand:function(e){var t=this;t.dataProxy.modelCommandHandler(e)},getDocContainer:function(){var e=this.prnDocContainer;return e},doLayout:function(){var e=this,t="#"+i(e);e.prnDocForm=e.prnDocForm||$(t),e.getDocContainer().css({height:e.prnDocForm.height()-120})},release:function(){var e=this;e.previewContent&&delete e.previewContent,e.prnDocForm&&(e.close(),delete e.prnDocForm)}})}(KD),define("KDHTMLPrintDocProxy",function(){}),function(e){KDListReportHelper=function(e){},$.extend(KDListReportHelper,{cellDefaultHeight:21,cellDefaultHeaderHeight:35,cellDefaultFooterHeight:35,listDefaultHeaderHeight:21,listDefaultFooterHeight:21,getCtrlKeyRegx:function(){
return/[\u0000]|[\u0001]|[\u0002]|[\u0003]|[\u0004]|[\u0005]|[\u0006]|[\u0007]|[\u0008]|[\u000b]|[\u000c]|[\u000d]|[\u000e]|[\u000f]|[\u0010]|[\u0011]|[\u0012]|[\u0013]|[\u0014]|[\u0015]|[\u0016]|[\u0017]|[\u0018]|[\u0019]|[\u001a]|[\u001b]|[\u001c]|[\u001d]|[\u001e]|[\u001f]|[\u001c]|[\u007f]/gm},covertSpecialChar:function(t){if(e.isEmpty(t))return"";var i=(t||"").replace(/\&/g,"&amp;").replace(/\</gm,"&lt;").replace(/\>/gm,"&gt;").replace(/\"/gm,"&quot;").replace(/\'/gm,"&#39;");return i=i.replace(KDListReportHelper.getCtrlKeyRegx(),""),i&&"{"==i.substring(0,1)&&(i=" "+i),i},getMessagePageTemplate:function(t){return'<Canvas Width="500" Height="100"><Border Canvas.Left="5" Canvas.Top="10" Height="50" Width="300">'+e.format('<TextBlock Foreground="Red" Text="{0}">',t||"No data!")+"</TextBlock></Border></Canvas>"},getPageContentXaml:function(e,t,i){var a=i[e];if(null==t)return a.Xaml=KDListReportHelper.getMessagePageTemplate(),a.Xaml;if(0==((t.data||{}).actualDataRow||0))return a.Xaml=KDListReportHelper.getMessagePageTemplate(ResManager.LoadKDString("没有取到数据，请检查查询条件和打印权限。","0025710000004279")),a.Xaml;KDListReportHelper.setPageNumber(e+1,a);var n=KDListReportHelper.createPagesXaml(t,a);return n},createPagesXaml:function(e,t){var i=new stringBuilder;i.appendLine(KDListReportHelper.getPageGridLayout(t)),i.appendLine(KDListReportHelper.getPageDataLayout(e,t));var a=KDListReportHelper.getReportString(i.toString(),t);return a},formatCaption:function(t,i,a,n){var o="";if(t){var r=new Date;o=KDListReportHelper.covertSpecialChar(t),o=o.replace("{page}",i.toString()).replace("{totalpages}",a.toString()).replace("{date}",e.format("{0}-{1}-{2}",r.getFullYear(),r.getMonth()+1,r.getDate())).replace("{time}",e.format("{0}:{1}:{2}",r.getHours(),r.getMinutes(),r.getSeconds())).replace("{title}",n).replace("{user}",ClientAppProxy.Current.CTX.UserName||"").replace("{empty}","")}else o="";return o},setPageNumber:function(e,t){var i=t,a=i.ColPages*i.RowPages,n={Size:i.HeaderTemplate.Size,LeftCaption:KDListReportHelper.formatCaption(i.HeaderTemplate.LeftCaption,e,a,i.billTitle),MiddleCaption:KDListReportHelper.formatCaption(i.HeaderTemplate.MiddleCaption,e,a,i.billTitle),RightCaption:KDListReportHelper.formatCaption(i.HeaderTemplate.RightCaption,e,a,i.billTitle)};i.Header=n,n={Size:i.FooterTemplate.Size,LeftCaption:KDListReportHelper.formatCaption(i.FooterTemplate.LeftCaption,e,a,i.billTitle),MiddleCaption:KDListReportHelper.formatCaption(i.FooterTemplate.MiddleCaption,e,a,i.billTitle),RightCaption:KDListReportHelper.formatCaption(i.FooterTemplate.RightCaption,e,a,i.billTitle)},i.Footer=n,i.IsShowPageTitle&&(n={Size:i.PageTitleTemplate.Size,LeftCaption:KDListReportHelper.formatCaption(i.PageTitleTemplate.LeftCaption,e,a,i.billTitle),MiddleCaption:KDListReportHelper.formatCaption(i.PageTitleTemplate.MiddleCaption,e,a,i.billTitle),RightCaption:KDListReportHelper.formatCaption(i.PageTitleTemplate.RightCaption,e,a,i.billTitle)},i.PageTitle=n),i.PageIndex=e},getRowColor:function(e,t){var i=e;return 0>i?t.ListHeaderColor:i%2==0?t.ListDoubleColor:t.ListSingleColor},getTextAlgin:function(e){var t=e.DefaultColAlignType,i=e.ColAlignType;return 0==i&&(i=t),1==i?"Left":2==i?"Right":3==i?"Center":"numberfield"==e.XType?"Right":"Left"},getCellString:function(e,t,i,a,n,o){var r=i.Hidden||i.Size.Width<6||i.Size.Height<6;if(r)return"";var s=new stringBuilder,l=" Style='{StaticResource BorderStyleColHeader}'",d=" Style='{StaticResource BorderStyleDataCell}'",c=" Style='{StaticResource TextBlockStyle2}'",h=o;h||(h=0==t.Col?"1,1,1,0":"0,1,1,0");var u=i.LineColor?i.LineColor:"#FF9d9d9d",p=i.Size.Height;s.append("<Border BorderThickness='"+h+"' BorderBrush='"+u+"' "),s.append(' TextAlignment = "'+i.HorizontalAlignment+'" '),s.append(' VerticalAlignment = "Center" '),i.Hidden||s.append(' Background="'+i.Background+'"'),s.append(' Grid.Row="'+t.Row+'"'),s.append(' Grid.Column="'+t.Col+'" '),t.RowSpan&&s.append(' Grid.RowSpan="'+t.RowSpan+'" '),t.ColSpan&&s.append(' Grid.ColumnSpan="'+t.ColSpan+'" '),n?(s.append(l),i.Hidden?(s.append(' Visibility="Collapsed"'),s.append(' Height="0"')):p>0&&s.append(' Height="'+p+'"')):(s.append(d),s.append(' Height="'+p+'"')),s.append(">");var g="";if(g?s.append("<TextBlock FontFamily='SimSun, Arial, MS Serif, "+g+"' Margin='0'"):s.append("<TextBlock FontFamily='SimSun, Arial, MS Serif' Margin='0'"),i.Hidden)s.append(' Visibility="Collapsed"'),s.append(' Height="0"');else{var p=i.Size.Height-4;p>0&&s.append(' Height="'+p+'"')}var f=i.Size.Width-6;return f>0&&s.append(' Width="'+f+'"'),s.append(' Text="'+KDListReportHelper.covertSpecialChar(e)+'" '),s.append(c),s.append("/>"),s.appendLine("</Border>"),s.toString()},appendRowSeqNum:function(t,i,a){var n="";if(e.isDebug()){var o=a+1,r={Hidden:!t,Background:"transparent",HorizontalAlignment:"Left",Size:{Width:100,Height:21},LineColor:"transparent"},s={Col:i,Row:o};n=KDListReportHelper.getCellString(o.toString(),s,r,1,!1,"0,0,0,0")}return n},getPageDataLayout:function(t,i){var a=new stringBuilder,n=e.parseObject(t.data)||{},o=KDListReportHelper.getPageSetting(t),r=n.rows||[],s=n.rowcount||0,l=i.Columns,d=i.ColumnHeaderRows||1,c=0,h={CellHeight:i.RowHeight,CellRows:i.CellRows,RptPages:3,HeaderRows:1,FooterRows:1,IsShowTitle:!1,TitleColCount:0,TitleRowCount:0,ListHeaderColor:o.ListHeaderColor||"#D3D3D3",ListSingleColor:o.ListSingleColor||"#FFFFFF",ListDoubleColor:o.ListDoubleColor||"#FFFFFF",ReportTeamColor:o.ReportTeamColor||"#D3D3D3"},u=h.HeaderRows,p=h.CellHeight,g=h.CellRows,f=KDListReportHelper.listDefaultHeaderHeight,m=KDListReportHelper.listDefaultFooterHeight;IsShowTitle=i.IsShowPageTitle,TitleColCount=i.TitleColCount,e.isEmpty(n.titles)||(TitleData=n.titles||[],TitleRowCount=TitleData.length%TitleColCount>0?TitleData.length/TitleColCount+1:TitleData.length/TitleColCount);for(var v=0;v<l.length;v++){var y=l[v];y.Visible&&(c+=y.Width)}if(!KDListReportHelper.genRptTableMergerHeaders(i,o,u,a)){for(var v=0;v<l.length;v++){var y=l[v];if(y.Visible){var b={Hidden:!i.IsShowListHeader,Background:KDListReportHelper.getRowColor(-1,h),HorizontalAlignment:"Center",Size:{Width:y.Width,Height:1==d?f:p*d},LineColor:i.LineColor},D={Col:v,Row:0},k=0==v?"1,1,1,0":"0,1,1,0",C=(y.Header||"").replace(/\&/g,"_"),x=KDListReportHelper.getCellString(C,D,b,u,!0,k);a.appendLine(x)}}a.appendLine(KDListReportHelper.appendRowSeqNum(i.IsShowListHeader,l.length,-1))}for(var w=function(t,i){var a="",n=i>=0&&i<t.length?t[i]:"";return e.isArray(n)&&(n=n.length>0?n[0]:""),a=e.isString(n)?n:n.toString()},K=0,S=i.StartRow;S<=i.EndRow&&s>S;S++){K++;for(var v=0;v<l.length;v++){var y=l[v];if(y.Visible&&S<r.length){var I=y.Index,P=r[S]||[],F=P.length>I&&I>=0?w(P,I):"",b={Hidden:!y.Visible,Background:KDListReportHelper.getRowColor(S,h),HorizontalAlignment:KDListReportHelper.getTextAlgin(y),Size:{Width:y.Width,Height:p*g-1},LineColor:i.LineColor},D={Col:v,Row:K-1+u},x=KDListReportHelper.getCellString(F,D,b,r.length+u);a.appendLine(x)}}a.appendLine(KDListReportHelper.appendRowSeqNum(i.IsShowListHeader,l.length,S-i.StartRow))}var T={Background:h.ReportTeamColor,HorizontalAlignment:"right",Size:{Width:c,Height:m},LineColor:i.LineColor},_=K+h.HeaderRows,A={Col:0,Row:_,RowSpan:1,ColSpan:l.length},L=ResManager.LoadKDString("合计:{0} 行记录","0025710000007621"),M=e.format(L,s),k="1,1,1,1",E=KDListReportHelper.getCellString(M,A,T,s+u,!0,k);return a.appendLine(E),a.toString()},genRptTableMergerHeaders:function(t,i,a,n){var o=!1,r=n,s=t.RowHeight,l=new stringBuilder,d=t.MergerInfo||KDListReportHelper.getDefaultMergerInfo();if(d.IsHeaderMerged){o=!0;for(var c=t.Columns,h=0,u=0,p=0;p<c.length;p++){var g=c[p];g.Visible&&(u++,h+=g.Width,l.appendLine(e.format('<ColumnDefinition Width="{0}"/>',g.Width)))}r.appendLine(e.format('<Grid VerticalAlignment="Top" Height = "{0}" Width = "{1}"  Grid.ColumnSpan="{2}" Grid.InnerMerger="True">',d.Headers*i.PrintingCellHeight,h,u)),r.appendLine("<Grid.ColumnDefinitions>"),r.appendLine(l.toString()),r.appendLine("</Grid.ColumnDefinitions>"),r.appendLine("<Grid.RowDefinitions>");for(var f=0;f<d.Headers;f++)r.appendLine(e.format('<RowDefinition Height="{0}"/>',i.PrintingCellHeight));r.appendLine(e.format("</Grid.RowDefinitions>"));var m=KDListReportHelper.getMergerCells(t);for(var v in m){var y=m[v];if(!y.IsColMerged&&!y.IsRowMerged){var b={Hidden:!i.IsShowListHeader,Background:i.ListHeaderColor,HorizontalAlignment:"Center",Size:{Width:y.Width,Height:y.RowSpan*s-1},LineColor:t.LineColor},D={Col:y.Location.Col,Row:y.Location.Row,ColSpan:y.ColSpan,RowSpan:y.RowSpan},k=KDListReportHelper.getCellString(y.Name,D,b,a,"1,1,1,0");r.appendLine(k)}}r.appendLine("</Grid>")}return o},getMergerLocation:function(t,i){return e.format("R{0}C{1}",t,i)},getMergerCells:function(t){for(var i=t.Columns,a=t.MergerInfo||KDListReportHelper.getDefaultMergerInfo(),n={},o=a.Headers,r=0,s=0;s<i.length;s++){var l=i[s];if(l.Visible){r+=l.Visible?l.Width:0;var d=l.Header||" ",c=d.replace(/\&amp;/g,"&").split("&"),h=c.length;o=Math.max(h,o);for(var u=new stringBuilder,p=0;p<c.length;p++){var g=KDListReportHelper.getMergerLocation(p,s),f=p<c.length-1,m=c[p];u.append(e.format("{0}{1}",0==p?"":"-",m)),n[g]={IsVisible:l.Visible,Name:m,NamePath:u.toString(),Key:l.DataIndex,Width:l.Width,Location:{Row:p,Col:s},IsBland:f,RowSpan:1,ColSpan:1,GridControlBandName:f?c[0]:""}}}}var v=[];for(var y in i)e.isRunInForIn(y,i)&&i[y].Visible&&v.push(i[y]);var b=[];for(var y in n)e.isRunInForIn(y,n)&&n[y].IsBland&&(b[y]=n[y]);var D=v.length;for(var k in b)if(e.isRunInForIn(k,b)){var C=b[k];if(C.IsColMerged)continue;for(var p=C.Location.Col+1;D>p;p++){var x=KDListReportHelper.getMergerLocation(C.Location.Row,p),w=n[x],K=!e.isEmpty(w)&&w.NamePath==C.NamePath;if(!K)break;var S=C;w.IsVisible&&(S.ColSpan++,S.Width+=w.Width,null!=w&&(w.IsColMerged=!0))}}for(var x in n)for(var I=n[x],p=I.Location.Row+1;o>p;p++){var x=KDListReportHelper.getMergerLocation(p,I.Location.Col),P=KDListReportHelper.getMergerLocation(p-1,I.Location.Col+1),w=n[x],F=n[P],K=void 0===w||!e.isEmpty(w)&&w.Name==I.Name,T=K&&!e.isEmpty(F);if(T&&F.Name==I.Name&&(K=!1),!K)break;var S=I;S.RowSpan++,null!=w&&(w.IsRowMerged=!0)}for(var x in n){var I=n[x];I.IsBland||KDListReportHelper.realCellMergeUp(n,I,I)}if(o<a.Headers){var _=a.Headers-o;for(var x in n){var I=n[x];0==I.Location.Row&&(I.RowSpan+=_)}}return n},realCellMergeUp:function(t,i,a){if(!(a.Location.Row-1<0)){var n=KDListReportHelper.getMergerLocation(a.Location.Row-1,a.Location.Col),o=t[n],r=!e.isEmpty(o),s=KDListReportHelper.getMergerLocation(a.Location.Row-1,a.Location.Col-1),l=t[s],d=!e.isEmpty(l),c=KDListReportHelper.getMergerLocation(),h=t[c],u=!e.isEmpty(h);!r||a.Name!=o.Name||u&&o.Name==h.Name||d&&o.Name==l.Name||(i.RowSpan+=1,i.Location={Row:i.Location.Row-1,Col:i.Location.Col},KDListReportHelper.realCellMergeUp(t,i,o))}},initMergerInfo:function(t,i){var a={},n=KDListReportHelper.getDefaultMergerInfo();try{if(i.IsHeaderMerger){var o=!1,r=0;for(var s in t)if(e.isRunInForIn(s,t)&&(col=t[s],!e.isEmpty(col.header)&&col.header.indexOf("&")>=0)){o=!0;var l=col.header.split("&").length;l>r&&(r=l)}a={IsHeaderMerged:o,Headers:r},o&&(i.ColumnHeaderRows=r)}else a=n}catch(d){a=n}return a},getDefaultMergerInfo:function(){return{IsHeaderMerged:!1,Headers:1}},getPageGridLayout:function(t){for(var i=t.ColumnHeaderRows||1,a=t.FooterRows||1,n=t.RowHeight,o=KDListReportHelper.listDefaultHeaderHeight,r=t.CellRows||1,s=t.Columns,l=t.PageSize,d=s.length,c=1==i?o:n*i,h=new stringBuilder("<Grid.ColumnDefinitions>"),u=0;d>u;u++){var p=s[u];h.appendLine('<ColumnDefinition Width="'+p.Width+'" />')}e.isDebug()&&h.appendLine('<ColumnDefinition Width="100" />'),h.appendLine("</Grid.ColumnDefinitions>"),h.appendLine("<Grid.RowDefinitions>");var g=0;g=t.IsShowListHeader?c:0,h.appendLine('<RowDefinition Height="'+g+'" />');for(var u=0;l>u;u++)g=n*r,h.appendLine('<RowDefinition Height="'+g+'" />');return g=n*a,h.appendLine('<RowDefinition Height="'+g+'" />'),h.appendLine("</Grid.RowDefinitions>"),h.toString()},getRptTitleString:function(t,i,a,n){var o=KDListReportHelper,r=a,s=n,l=i;if(e.isEmpty(i))return"";var d=new stringBuilder,c="Style='{StaticResource TextBlockStyle2}'";d.appendLine(e.format("<Grid.ColumnDefinitions>"));for(var h=0;r>h;h++)d.appendLine(e.format('  <ColumnDefinition Width="{0}"/>',t/r));d.appendLine(e.format("</Grid.ColumnDefinitions>")),d.appendLine(e.format("<Grid.RowDefinitions>"));for(var h=0;s>h;h++)d.appendLine(e.format('  <RowDefinition Height="{0}" />',o.cellDefaultHeight));d.appendLine(e.format("</Grid.RowDefinitions>"));for(var h=0;h<l.length;h++){var u=l[h].label+": "+l[h].value,p=parseInt((h%r).toString()),g=parseInt((h/r).toString()),f=e.format('<TextBlock Grid.Column="{0}" Grid.Row="{1}" TextAlignment="Left" ',p,g),m='HorizontalAlignment="Left" VerticalAlignment="Center" FontSize="13" Text="'+u+'" ',v=e.format('{0} Height="{1}" />',c,o.cellDefaultHeight-4);d.appendLine(f+m+v)}return d.toString()},getDevResourceDebug:function(){var e=KDXmlUtils.getBigStr(function(){});return e},getDevResource:function(){var t=KDListReportHelper.C_PageResDictStr||"";if(e.isEmpty(t)){var i=function(){var e=new stringBuilder;return e.appendLine("<ResourceDictionary>"),e.appendLine("<Style Key='BorderStyleTitle' TargetType='Border'>"),e.appendLine("<Setter Property='BorderThickness' Value='0,0,0,0' />"),e.appendLine("<Setter Property='BorderBrush' Value='#00000000' />"),e.appendLine("<Setter Property='Background' Value='#FFFFFFFF' />"),e.appendLine("<Setter Property='Padding' Value='1,1,1,1' />"),e.appendLine("</Style>"),e.appendLine("<Style Key='BorderStyleColHeader' TargetType='Border'>"),e.appendLine("<Setter Property='Background' Value='#FFD4D4D4' />"),e.appendLine("<Setter Property='Padding' Value='1,1,1,1' />"),e.appendLine("</Style>"),e.appendLine("<Style Key='BorderStyleDataCell' TargetType='Border'>"),e.appendLine("<Setter Property='Background' Value='#FFFFFFFF' />"),e.appendLine("<Setter Property='Padding' Value='1,1,1,1' />"),e.appendLine("</Style>"),e.appendLine("<Style Key='TextBlockStyle1' TargetType='TextBlock'>"),e.appendLine("<Setter Property='FontFamily' Value='SimSun, Arial, MS Serif' />"),e.appendLine("<Setter Property='FontSize' Value='18.66667' />"),e.appendLine("<Setter Property='Foreground' Value='#FF000000' />"),e.appendLine("<Setter Property='VerticalAlignment' Value='Center' />"),e.appendLine("<Setter Property='TextWrapping' Value='Wrap' />"),e.appendLine("</Style>"),e.appendLine("<Style Key='TextBlockStyle2' TargetType='TextBlock'>"),e.appendLine("<Setter Property='FontFamily' Value='SimSun, Arial, MS Serif' />"),e.appendLine("<Setter Property='FontSize' Value='12' />"),e.appendLine("<Setter Property='Foreground' Value='#FF000000' />"),e.appendLine("<Setter Property='VerticalAlignment' Value='Center' />"),e.appendLine("<Setter Property='TextWrapping' Value='Wrap' />"),e.appendLine("</Style>"),e.appendLine("<Style Key='TextBlockStyle3' TargetType='TextBlock'>"),e.appendLine("<Setter Property='FontFamily' Value='SimSun, Arial, MS Serif' />"),e.appendLine("<Setter Property='FontSize' Value='12' />"),e.appendLine("<Setter Property='Foreground' Value='#FF000000' />"),e.appendLine("<Setter Property='VerticalAlignment' Value='Center' />"),e.appendLine("<Setter Property='TextWrapping' Value='Wrap' />"),e.appendLine("</Style>"),e.appendLine("<Style Key='TextBlockStyle4' TargetType='TextBlock'>"),e.appendLine("<Setter Property='FontFamily' Value='SimSun, Arial, MS Serif' />"),e.appendLine("<Setter Property='FontSize' Value='12' />"),e.appendLine("<Setter Property='Foreground' Value='#FF000000' />"),e.appendLine("<Setter Property='VerticalAlignment' Value='Center' />"),e.appendLine("<Setter Property='TextWrapping' Value='Wrap' />"),e.appendLine("</Style>"),e.appendLine("<Style Key='TextBlockStyle5' TargetType='TextBlock'>"),e.appendLine("<Setter Property='FontFamily' Value='SimSun, Arial, MS Serif' />"),e.appendLine("<Setter Property='FontSize' Value='12' />"),e.appendLine("<Setter Property='FontWeight' Value='Bold' />"),e.appendLine("<Setter Property='Foreground' Value='#FF000000' />"),e.appendLine("<Setter Property='VerticalAlignment' Value='Center' />"),e.appendLine("<Setter Property='TextWrapping' Value='Wrap' />"),e.appendLine("</Style>"),e.appendLine("</ResourceDictionary>"),e.toString()};KDListReportHelper.C_PageResDictStr=i(),t=KDListReportHelper.C_PageResDictStr||""}return t},getReportString:function(t,i){var a=i.IsShowPageTitle,n=i.TitleColCount,o=0,r=i.Titles;null!=r&&(o=a?KDListReportHelper.getTitleRowCount(r,n):0);var s=i.Margin,l="Style='{StaticResource BorderStyleTitle}'",d="Style='{StaticResource TextBlockStyle2}'",c=0,h="",u=i.Footer.Size.Width-s.Left-s.Right;c=o*i.RowHeight,h=KDListReportHelper.getRptTitleString(u,r,n,o);var p=((i.ColumnHeaderRows||1)*(i.RowHeight||20),i.RowHeight||20,i.Scale.Height-s.Top-s.Bottom-i.Header.Size.Height-i.Footer.Size.Height-c),g=i.DataScale.Width-6;0>g&&(g=0);var f=new stringBuilder;f.append(e.format('<Grid Height = "{0}" Width = "{1}"',i.Scale.Height,i.Scale.Width)),f.append(' VerticalAlignment="Top"'),f.appendLine(">"),f.appendLine("<Grid.Resources>"),f.appendLine(KDListReportHelper.getDevResource()),f.appendLine("</Grid.Resources>"),f.appendLine(e.format("<Grid.RowDefinitions>")),f.appendLine(e.format('<RowDefinition Height="{0}"/>',s.Top)),f.appendLine(e.format('<RowDefinition Height="{0}"/>',i.Header.Size.Height)),f.appendLine(e.format('<RowDefinition Height="{0}"/>',c)),f.appendLine(e.format('<RowDefinition Height="{0}"/>',p)),f.appendLine(e.format('<RowDefinition Height="{0}"/>',i.Footer.Size.Height)),f.appendLine(e.format('<RowDefinition Height="{0}"/>',s.Bottom)),f.appendLine(e.format("</Grid.RowDefinitions>")),f.appendLine(e.format("<Grid.ColumnDefinitions>")),f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',s.Left)),f.appendLine(e.format("<ColumnDefinition/>")),f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',s.Right)),f.appendLine(e.format("</Grid.ColumnDefinitions>")),f.appendLine(e.format('<Border Grid.Column="1" Grid.Row="1" Height="{1}" {0}>',l,i.Header.Size.Height)),f.appendLine(e.format('<Grid data-type="页眉">')),f.appendLine(e.format("<Grid.ColumnDefinitions>"));var m=i.Header.Size.Width-s.Left-s.Right-4,v=parseInt((m/3).toString());f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',v)),f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',v)),f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',v)),f.appendLine(e.format("</Grid.ColumnDefinitions>")),f.appendLine(e.format('<TextBlock Grid.Column="0" TextAlignment="Left" HorizontalAlignment="Left" VerticalAlignment="Center" FontSize="13" Width="{0}" Text="{1}" {2}/>',v-2,i.Header.LeftCaption,d)),f.appendLine(e.format('<TextBlock Grid.Column="1" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="18" Width="{0}" Text="{1}" {2}/>',v,i.Header.MiddleCaption,d)),f.appendLine(e.format('<TextBlock Grid.Column="2" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="13" Width="{0}" Text="{1}" {2}/>',v-2,i.Header.RightCaption,d)),f.appendLine(e.format("</Grid>")),f.appendLine(e.format("</Border>")),a&&(f.appendLine(e.format('<Border Grid.Column="1" Grid.Row="2" Height="{0}" {1}>',c,l)),f.appendLine(e.format('<Grid data-type="表头信息">')),f.appendLine(h),f.appendLine(e.format("</Grid>")),f.appendLine(e.format("</Border>"))),f.appendLine(e.format('<Border  Grid.Column="1" Grid.Row="3" BorderThickness="0" BorderBrush="#00000000" Background=\'#FFFFFFFF\' Height="{0}">',p)),f.appendLine(e.format('<Grid Height="{0}" data-type="list data area">',p)),f.appendLine(t),f.appendLine(e.format("</Grid>")),f.appendLine(e.format("</Border>")),f.appendLine(e.format('<Border Grid.Column="1" Grid.Row="4" Background=\'#FFFFFFFF\' Height="{0}" {1}>',i.Footer.Size.Height-2,l)),f.appendLine(e.format('<Grid data-type="页脚">')),f.appendLine(e.format("<Grid.ColumnDefinitions>"));var y=i.Footer.Size.Width-s.Left-s.Right-4,b=parseInt((y/3).toString());return f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',b)),f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',b)),f.appendLine(e.format('<ColumnDefinition Width="{0}"/>',b-5)),f.appendLine(e.format("</Grid.ColumnDefinitions>")),f.appendLine(e.format('<TextBlock Grid.Column="0" TextAlignment="Left" HorizontalAlignment="Left" VerticalAlignment="Center" FontSize="13" Width="{0}" Text="{1}" {2}/>',b-2,i.Footer.LeftCaption,d)),f.appendLine(e.format('<TextBlock Grid.Column="1" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="13" Width="{0}" Text="{1}" {2}/>',b,i.Footer.MiddleCaption,d)),f.appendLine(e.format('<TextBlock Grid.Column="2" TextAlignment="Right" HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="13" Width="{0}" Text="{1}" {2}/>',b-5,i.Footer.RightCaption,d)),f.appendLine(e.format("</Grid>")),f.appendLine(e.format("</Border>")),f.appendLine(e.format("</Grid>")),f.toString()},getDM2PX:function(e){var t=t||.92,i=2.54;return parseInt(e/i*t)},getTitleRowCount:function(e,t){var i=0;return null!=e&&(i+=e.length%t>0?e.length/t+1:e.length/t),parseInt(i)},getPageScale:function(t){var i=e.isEmpty(t.PageScale)||0==t.PageScale?1:t.PageScale;return i},getPageSize:function(e){var t=KDListReportHelper,i=t.getPageScale(e),a={Width:parseInt((e.paperwidth/i).toString())-1,Height:parseInt((e.paperheight/i).toString())-1};return a.Width<=0&&(a.Width=783),a.Height<=0&&(a.Height=1112),a},getDataHeight:function(e,t){var i=KDListReportHelper,a=e.IsShowTitlePerPage,n=KDListReportHelper.cellDefaultHeight,o=e.HeaderHeightData||KDListReportHelper.cellDefaultHeaderHeight,r=e.FooterHeightData||KDListReportHelper.cellDefaultFooterHeight,s=e.ColumnHeaderRows||1,l=e.IsShowListHeader?i.listDefaultHeaderHeight*s:0,d=i.listDefaultFooterHeight,c=i.getPageSize(e),h=0,u=e.TitleColCount||3,p=t||[];p&&p.length>0&&(h=a?KDListReportHelper.getTitleRowCount(p,u):0);var g=h*n,f=c.Height-g-i.getDM2PX(e.TopMargin)-i.getDM2PX(e.BottomMargin)-o-r-l-d;return 0>f?1:f},getDataWidth:function(e){var t=KDListReportHelper,i=t.getPageSize(e),a=i.Width-t.getDM2PX(e.LeftMargin)-t.getDM2PX(e.RightMargin);return a},calcPageSize:function(t){var i=KDListReportHelper.cellDefaultHeight,a=(t.PrintConfig,KDListReportHelper.getPageSetting(t)),n=a.CellRows||1,o=e.getValue(t.data,e.KDPrintConst.ListRptViceTitles,[]),r=KDListReportHelper.getDataHeight(a,o),s=parseInt((r/(i*n)).toString());return 0>=s&&(s=1),parseInt(s.toString())},splitColumnsIntoPage:function(e){for(var t=[],i=(e.PrintConfig,KDListReportHelper.getPageSetting(e)),a=e.Columns||[],n=i.MergerInfo,o=0,r=0,s=KDListReportHelper.getPageFeature(e),l=KDListReportHelper.getPageAvaibleWidth(s),d=0;d<a.length;d++){var c=a[d],h=KDListReportHelper.getListRptColumn(c),u=h.Visible?h.Width:0;h.Width=u,o+=u,o>l?(s.StartCol=r,s.EndCol=h.Index-1,s.IsDataPageStart=0==r,t.push(s),s=KDListReportHelper.getPageFeature(e),s.Columns.push(h),r=h.Index,o=u):s.Columns.push(h)}if(s.Columns.length>0){var p=s.Columns[s.Columns.length-1];s.EndCol=p.Index,t.push(s)}for(var g=KDListReportHelper.calcPageSize(e),d=0;d<t.length;d++){var f=t[d],m=d,v=parseInt((m/t.length).toString()),y=v*g;$.extend(f,{StartRow:y,EndRow:y+g-1,ColPages:t.length,RowPages:parseInt((f.RowCount/g).toString())+(f.RowCount%g>0?1:0),PageSize:g,MergerInfo:n})}return t},getDefaultPageSet:function(){var t=function(){return{PaperName:"A4",IsCustomPaper:!1,paperheightdm:2969,paperwidthdm:2100,paperheight:1122,paperwidth:793,IsPortrait:!0,IsLandscape:!1,PaperOrientation:0,LeftMargin:15,RightMargin:15,TopMargin:5,BottomMargin:5,IsPrintAll:!0,PrintPages:"",IsShowListHeader:!0,TitleColCount:3,IsShowTitlePerPage:!0,MaxRecords:1e4,HeaderLeft:"",HeaderMiddle:"{title}",HeaderRight:"",FooterLeft:e.format(ResManager.LoadKDString("打印人:{0}","0025710000008352"),"{user}"),FooterMiddle:e.format(ResManager.LoadKDString("页码:{0}","0025710000008353"),"{page}/{totalpages}"),FooterRight:e.format(ResManager.LoadKDString("打印时间:{0}","0025710000008354"),"{date} {time}"),BusinessObjectId:"",PageId:"",HeaderHeightData:35,FooterHeightData:35,HeaderHeight:35,FooterHeight:35,AutoStrategy:0,PrintingCellWidth:120,PrintingCellHeight:21,PrintingCellMaxWidth:0,PrintingCellMaxHeight:0,SelectedListGroups:null,ListHeaderColor:"#D3D3D3",ListSingleColor:"#FFFFFF",ListDoubleColor:"#FFFFFF",ReportTeamColor:"#C8C8C8"}}();return t},getPageSetting:function(t){var i=(t||{}).PrintConfig||{},a=e.parseObject(i.PrintPageSetting||{}),n=t.Columns||[];e.isEmpty(a)&&(a=KDListReportHelper.getDefaultPageSet());var o=a.IsHeaderMerger&&1==a.ColumnHeaderRows&&e.isEmpty(a.MergerInfo);if(o){var r=KDListReportHelper.initMergerInfo(n,a);r.merged&&(a.ColumnHeaderRows=r.headers),a.MergerInfo=r,i.PrintPageSetting=e.stringify(a)}else e.isEmpty(a.MergerInfo)&&(a.MergerInfo=KDListReportHelper.getDefaultMergerInfo());return a},getPageFeature:function(t){var i=KDListReportHelper,a=t.PrintConfig,n=KDListReportHelper.getPageSetting(t),o=e.parseObject(t.data)||{},r=e.getValue(t.data,e.KDPrintConst.ListRptViceTitles,[]),s=o.rowcount||0,l={billTitle:a[e.KDPrintConst.BillTitle],RowHeight:KDListReportHelper.cellDefaultHeight,CellRows:n.CellRows||1,Scale:i.getPageSize(n),LineColor:n.LineColor,ColumnHeaderRows:n.ColumnHeaderRows||1,DataScale:{Width:KDListReportHelper.getDataWidth(n),Height:KDListReportHelper.getDataHeight(n,r)},IsShowListHeader:n.IsShowListHeader,Columns:[],Margin:{Left:i.getDM2PX(n.LeftMargin),Top:i.getDM2PX(n.TopMargin),Right:i.getDM2PX(n.RightMargin),Bottom:i.getDM2PX(n.BottomMargin)},IsShowPageTitle:n.IsShowTitlePerPage,TitleColCount:n.TitleColCount,PageIndex:0,Titles:o.titles||[],RowCount:-1==s?1e4:s},d=l.Scale;return n.IsShowTitlePerPage&&(l.PageTitle={Size:{Width:d.Width,Height:n.HeaderHeightData},LeftCaption:n.HeaderLeft,MiddleCaption:n.HeaderMiddle,RightCaption:n.HeaderRight},l.PageTitleTemplate=l.PageTitle),l.Header={Size:{Width:d.Width,Height:n.HeaderHeightData||i.cellDefaultHeaderHeight},LeftCaption:n.HeaderLeft,MiddleCaption:n.HeaderMiddle,RightCaption:n.HeaderRight},l.HeaderTemplate=l.Header,l.Footer={Size:{Width:d.Width,Height:n.FooterHeightData||i.cellDefaultFooterHeight},LeftCaption:n.FooterLeft,MiddleCaption:n.FooterMiddle,RightCaption:n.FooterRight},l.FooterTemplate=l.Footer,l},getListRptColumn:function(e){var t={DataIndex:e.dataIndex,Header:e.header,Width:e.width,Visible:e.visible,ColAlignType:e.colAlignType,DefaultColAlignType:e.defaultColAlignType,XType:e.xtype,Index:e.colIndex};return t},getPageAvaibleWidth:function(e){return e.Scale.Width-e.Margin.Left-e.Margin.Right}})}(KD),define("KDListReportHelper",["KD","KDPrintXML2HTMLPaser"],function(e){return function(){var t;return t||e.KDListReportHelper}}(this)),function(e){KDJSPrinter=function(e){},$.extend(KDJSPrinter,{PrintVersion:"1.0.0.0",MaxPrintPages:100,acts:{},reportTypeOptions:{ListReport:{converter:"converListReport",getPages:"getListReportTotalPageCount"},NoteReport:{converter:"converNoteReport",getPages:"getNoteReportTotalPageCount"}},selectPrinter:function(e,t){return{message:"pure js printer is unsupport to selected local printers!"}},queryPrinterInfo:function(t,i,a){var n={Message:"pure js printer is unsupport to selected local printers!",Error:!0,JobId:t.JobId},o={returnPack:n},r=KDLocalServicesPrinter;e.isFunction(i)?i(a,o):r.setBusy(!1,a)},SelectPrinterExt:function(e,t,i){return{message:"pure js printer is unsupport to selected local printers!"}},printDocument:function(t,i,a,n,o){var r=(KDJSPrinter,KDJSPrinter.reportTypeOptions[t]),s=r.converter,l=o||{};if(e.isFunction(KDJSPrinter[s])){l.data=KDJSPrinter[s](a);var d=new KDJSPreviewProxy;d.init(r,n),d.show()}},checkMaxPagesRule:function(t,i,a,n){var o=!0,r=(t||{}).pageId||"",s=(" "+(a||"")).indexOf("Preview")>0,l="ListReport"==i,d=KDJSPrinter.reportTypeOptions[i],c=d.getPages,h=l?"isNeedCheckListMaxPage":"isNeedCheckNoteMaxPage",u=KDPrintingStrategy.getPrinter(a,{pageId:r})[h];if(!u)return o;var p=KDJSPrinter[c](n),r=t.pageId,g=t.jobId;if(!(p<=KDJSPrinter.MaxPrintPages)){var f=l?ResManager.LoadKDString("列表","0025710000004947"):ResManager.LoadKDString("单据套打","0025710000004948"),m=s?ResManager.LoadKDString("预览","0025710000004949"):ResManager.LoadKDString("打印","0025710000007618"),v=ResManager.LoadKDString("【{0}】最大允许【{1}】的页数是{2}页纸，当前数据生成了{3}页纸，数据量太大。请修改数据范围。","0025710000004950"),y=e.format(v,f,m,KDJSPrinter.MaxPrintPages,p);onPrinted({pageId:r,jobId:g,success:!1,printService:"KDHTMLPrinter",message:y}),o=!1}return o},getPrnJobInfo:function(e,t){var i=KDReportPlugInProxy.getPrnJobInfo(e,t);return i},getPrnAObjRet:function(e){var t={success:e.IsSuccessful,printService:"KDJSPrinter",params:[null],pageId:e.pageId,jobId:e.jobId,message:e.message,isoId:"",printAddress:""};return $.extend(t,e),t},getNoteReportTotalPageCount:function(e){var t=e.count||0;return t},getListReportTotalPageCount:function(e){var t=KDListReportHelper.splitColumnsIntoPage(e),i=t[0]||{ColPages:0,RowPages:0,PageSize:0},a=i.ColPages*i.RowPages;return a},converNoteReport:function(e){var t=e.count||0,i={printSetting:{},pages:{length:t},datainfo:{}},a=(e.pages||{})[0].printinfo||{};$.extend(i.printSetting,{IsCustomPaper:"custom"==a.papername,IsLandscape:"PORTRAIT"!=a.orientation,PaperName:a.papername,PaperHeight:a.paperheight,PaperHeightDM:a.paperheightdm,PaperWidth:a.paperwidth,PaperWidthDM:a.paperwidthdm,PrinterAddress:a.printerAddress||"",RightMargin:a.marginright,RightMarginWidth:a.marginright,TopMargin:a.margintop,TopMarginHeight:a.margintop,LeftMargin:a.marginleft,LeftMarginWidth:a.marginleft,BottomMargin:a.marginbottom,BottomMarginHeight:a.marginbottom,PrintJobId:a.printjobid,ActionIsoId:a.actionIsoId,IncludeHardMargin:a.includeHardMargin,PageId:a.pageId});for(var n=0;n<e.pages.length;n++){var o=e.pages[n];i.pages[n]=o}return $.extend(i.datainfo,{colPageCount:1,totalPages:t,totalFeatures:void 0,StartIndex:e.startIndex,IsPrintable:e.isPrintable}),i},converListReport:function(t){var i={printSetting:{},pages:[],datainfo:{}},a=t.PrintConfig||{},n=KDListReportHelper.getPageSetting(t),a=t.PrintConfig,o=KDListReportHelper.splitColumnsIntoPage(t);$.extend(i.printSetting,{IsCustomPaper:n.IsCustomPaper,IsLandscape:n.IsLandscape,PaperName:n.PaperName,PaperHeight:n.paperheight,PaperHeightDM:n.paperheightdm,PaperWidth:n.paperwidth,PaperWidthDM:n.paperwidthdm,PrinterAddress:"",RightMargin:n.RightMargin,RightMarginWidth:n.RightMarginWidth,TopMargin:n.TopMargin,TopMarginHeight:n.TopMarginHeight,LeftMargin:n.LeftMargin,LeftMarginWidth:n.LeftMarginWidth,BottomMargin:n.BottomMargin,BottomMarginHeight:n.BottomMarginHeight,PrintJobId:a.PrintJobId,ActionIsoId:a.PrintJobId,IncludeHardMargin:!1,PageId:a.pageId});for(var r=o[0]||{ColPages:0,RowPages:0,PageSize:0},s=r.ColPages*r.RowPages,l=[],d=0;d<r.RowPages;d++)for(var c=0;c<o.length;c++){var h=e.cloneObject(o[c]);$.extend(h,{StartRow:d*r.PageSize,EndRow:d*r.PageSize+r.PageSize-1}),l.push(h)}for(var d=0;d<l.length;d++){var u=KDListReportHelper.getPageContentXaml(d,t,l);i.pages.push({xaml:u,index:d})}return $.extend(i.datainfo,{colPageCount:r.ColPages,totalPages:s,totalFeatures:l,StartIndex:0,IsPrintable:!0}),i}})}(KD),define("KDJSPrinter",["KD","KDPrintXML2HTMLPaser","KDJSPreviewProxy","KDHTMLPrintDocProxy","KDListReportHelper"],function(e){return function(){var t;return t||e.KDJSPrinter}}(this)),function(e){KDLocalServicesPrinter=function(e){},$.extend(KDLocalServicesPrinter,{PrintVersion:"1.0.0.0",isNeedCheckListMaxPage:!1,isNeedCheckNoteMaxPage:!1,acts:{},__doCallback:function(t,i,a){var n=KDLocalServicesPrinter;e.isFunction(i)?i(a,t):n.setBusy(!1,a)},setGraphicsMode:function(e,t,i){var a=KDLocalServicesPrinter,n=a.getActionPack("SetGraphicsMode",i,1);a.sendData([n],function(e,i){a.__doCallback(i,t,e)},i)},queryPrinterInfo:function(t,i,a){var n=KDLocalServicesPrinter;n.setBusy(!1,a);var o=e.cloneObject(t),r=function(t,a,n){var o=n.getActionPack("QueryPrinterInfo",a,e.stringify(t));n.sendData([o],function(t,a){var o=((a||{}).ReturnPacks||[])[0],r={returnPack:e.parseObject(o)};n.__doCallback(r,i,t)},a)};o.IsDialog?n.selectPrinter(function(t,i){
var s=i||{},l=e.isObject(s.returnPack)?s.returnPack:{PrinterName:s.returnvalue},d=l.PrinterName||"";o.PrintAddress=d,o.IsDialog=!1,r(o,a,n)},a):r(o,a,n)},selectPrinterExt:function(e,t,i){var a=KDLocalServicesPrinter,n=a.getActionPack("SelectPrinter",i,e);a.sendData([n],function(e,i){a.__doCallback(i,t,e)},i)},selectPrinterByType:function(e,t,i){var a=KDLocalServicesPrinter;a.selectPrinter(t,i,e)},selectPrinter:function(e,t,i){var a=KDLocalServicesPrinter;a.selectPrinterExt(i||100,function(t,i){var n=[],o=i.ReturnPacks?i.ReturnPacks[0]:{},r=o.AllPrinterNames||[],s=o.PrinterName||"";n.push([s,s]);for(var l=0;l<r.length;l++)r[l]&&s!=r[l]&&n.push([r[l],r[l]]);a.selectPrinterUI({scope:t,data:n,callback:e})},t)},printDocumentExt:function(t,i,a,n,o){var r=KDLocalServicesPrinter,s=(" "+(i||"")).indexOf("Preview")>0;if(s)r.printDocument(t,i,a,n,o);else{var l=r.getPrnJobInfo(t,a);if(!KDJSPrinter.checkMaxPagesRule(l,t,i,a))return;r.setBusy(!1,n),r.selectPrinter(function(s,d){var c=d.returnvalue||"";KDReportPlugInProxy.printJobState.set(e.KDPrintConst.PrinterAddress,l.jobId,c),c?(r.setBusy(!0,n),r.printDocument(t,i,a,n,o)):onPrinted({pageId:l.pageId,jobId:l.jobId,success:!1,printService:"KDLocalServicesPrinter",message:ResManager.LoadKDString("当前操作已被用户取消！","0025710000007549")})},r)}},printDocument:function(t,i,a,n,o){var r=KDLocalServicesPrinter,s=(" "+(i||"")).indexOf("Preview")>0;if(s){r.getPrnJobInfo(t,a);KDJSPrinter.printDocument(t,i,a,n,o)}else e.isString(a.data)||(a.data=e.stringify(a.data)),r.setGraphicsMode(1,function(n,o){var s=r.getPrnJobInfo(t,a),l=r.getActionPack("Print",n,t,i,a);r.sendData([l],function(t,i){r.setBusy(!1,t),onPrinted({pageId:s.pageId,jobId:s.jobId,success:!0,printService:"KDLocalServicesPrinter",message:e.format(ResManager.LoadKDString("数据已经输出到打印机[{0}]！","0025710000007551"),s.printAddress)})},n)},n)},initChannel:function(t,i){var a=KDLocalServicesPrinter;KDLocalServices.createServicesChannel({open:function(a){e.isFunction(t)&&t(i,a)},message:function(t){KDLocalServicesPrinter.sendDataCallBack(i,t),e.writeLog("KDLocalServicesPrinter::",((t||{}).data||"").substr(0,300),!0)},close:function(t){a.setBusy(!1,i),KDLocalServices.alertToStartService(),e.writeLog("KDLocalServicesPrinter::",(t||{}).data||"close！",!0)},error:function(t){a.setBusy(!1,i),e.writeLog("KDLocalServicesPrinter::",(t||{}).message||"error！",!0),"iehttps"==t.type&&KDLocalServices.alertNoSupportIeHttps()}},function(a){e.isFunction(t)&&t(i,a)})},sendData:function(e,t,i){var a=KDLocalServicesPrinter;KDLocalServicesPrinter.acts[e[0].actId]={callback:t,args:e,scope:i},a.initChannel(function(t,i){KDLocalServices.sendData(e)},i)},sendDataCallBack:function(t,i){var a=KDLocalServicesPrinter,n=e.parseObject(i.data),o=(n.ActionPacks?n.ActionPacks[0]:{})||{},r=(o?o.actId:"")||"",s=KDLocalServicesPrinter.acts[r];n.type=i.type,delete KDLocalServicesPrinter.acts[r],s&&e.isFunction(s.callback)&&s.callback(s.scope,n),a.setBusy(!1,t)},getPrnJobInfo:function(e,t){var i=KDReportPlugInProxy.getPrnJobInfo(e,t);return i},getActionPack:function(t,i){for(var a=KDLocalServicesPrinter,n={success:!0,actionKey:"PrintActions",methodName:t,params:[null],pageId:"",jobId:"",message:"",isoId:"",actId:e.Guid.NewGuid().ToString()},o=[],r=2;r<arguments.length;r++){var s=arguments[r];if("Print"==t&&4==r){var l=arguments[2],d=arguments[4];$.extend(n,a.getPrnJobInfo(l,d));var c=KDReportPlugInProxy.printJobState.get(e.KDPrintConst.PrinterAddress,n.jobId)||"";switch(l){case"NoteReport":if(d&&e.isArray(d.pages))for(var h=0;h<d.limit;h++){var u=d.pages[h.toString()];u.printinfo.printerAddress=c}break;case"ListReport":d.PrintConfig.PrinterAddress=c}s=e.isString(d)?d:e.stringify(d)}o.push(s)}return 0==o.length&&o.push(null),n.params=o,n},getPrnAObjRet:function(e){var t={success:e.IsSuccessful,printService:"KDLocalServicesPrinter",params:[null],pageId:e.pageId,jobId:e.jobId,message:e.message,isoId:"",printAddress:""};return $.extend(t,e),t},setBusy:function(e,t){var i=t.owner;i&&i.setBusy.call(i,e)},selectPrinterUI:function(e){var t=KDLocalServicesPrinter,i=e.scope,a="display:none;margin-top:20px;margin-left:5px;height:35px;width:100px;background:#2FA7FF;border-radius:4px;",n='<div class="kd-printer-selectui"><div style="margin-left:30px; margin-top: 20px;"><div><select class="kd-printer-selPrinter" style="margin-top:15px;width: 230px;line-height:35px;display:none;"></select></div><div style="display:inline-block;"><button class="kd-printer-selBtnOK" style="'+a+'" type="button" class="k-button">'+ResManager.LoadKDString("确定","099002000000004")+'</button></div><div style="display:inline-block;"><button class="kd-printer-selBtnCancel" style="'+a+'" type="button" class="k-button">'+ResManager.LoadKDString("取消","0991733000003922")+"</button></div></div></div>",o=$(n);o.appendTo($(document.body)),o.kendoWindow({title:ResManager.LoadKDString("请选择打印机","0025710000007548"),actions:[],width:300,height:170,close:function(t){var a={Selected:!!i.printerName,PrinterName:i.printerName};e.callback(e.scope,{returnvalue:i.printerName,returnPack:a}),o.remove()},open:function(a){var n=$(a.sender.element),r=$(".kd-printer-selPrinter",n),s={target:r,scope:i,defaultId:i.printerName||"",data:e.data,changed:function(e){i.printerName=e.sender?e.sender.value():""}};t.__initPrinterList(s),$(".kd-printer-selBtnOK",n).show().kendoButton({enable:!0,width:100,click:function(e){i.printerName=r.val();var t=o.data("kendoWindow");return t&&t.close(),!1}}),$(".kd-printer-selBtnCancel",n).show().kendoButton({enable:!0,width:100,click:function(e){i.printerName="";var t=o.data("kendoWindow");return t&&t.close(),!1}})}});var r=o.data("kendoWindow");r&&r.center()},__initPrinterList:function(t){var i=t.data,a=t.target,n=e.getEnumSource(i),o=t.changed,r=t.rendered,s=t.scope,l={dataSource:n,popup:{origin:"bottom right",position:"top right"},dataTextField:"alias",dataValueField:"value",height:350,autoWidth:!0,valueTemplate:'<span title="#: alias #" class="toolTip"> #: alias #</span>',noDataTemplate:ResManager.LoadKDString("没有数据","0991733030033490"),animation:{close:{effects:"fadeOut zoom:out",duration:300},open:{effects:"fadeIn zoom:in",duration:300}},change:function(t){e.isFunction(o)&&o(s,t)},dataBound:function(t){e.isFunction(r)&&r(s,t)}};n&&n.length>=8&&(l.filter="contains",l.minLength=1,l.delay=0),a.kendoDropDownList(l)}})}(KD),define("KDLocalServicesPrinter",["KD","KDJSPrinter","KDLocalServices"],function(e){return function(){var t;return t||e.KDLocalServicesPrinter}}(this)),function(e){KDHTMLPrinter=function(e){},$.extend(KDHTMLPrinter,{PrintVersion:"1.0.0.0",isNeedCheckListMaxPage:!0,isNeedCheckNoteMaxPage:!0,isHtmlPrinting:!0,acts:{},selectPrinter:function(t,i){var a={errMessage:ResManager.LoadKDString("浏览器打印机不支持此操作！","00214298000004833"),returnvalue:""},n=KDLocalServicesPrinter;e.isFunction(t)?t(i,a):n.setBusy(!1,i)},setBusy:function(e,t){var i=t.owner;i&&i.setBusy.call(i,e)},queryPrinterInfo:function(t,i,a){var n={Message:ResManager.LoadKDString("浏览器打印机不支持此操作！","00214298000004833"),Error:!0,JobId:t.JobId},o={returnPack:n},r=KDLocalServicesPrinter;e.isFunction(i)?i(a,o):r.setBusy(!1,a)},SelectPrinterExt:function(t,i,a){var n={errMessage:ResManager.LoadKDString("浏览器打印机不支持此操作！","00214298000004833"),returnvalue:""},o=KDLocalServicesPrinter;e.isFunction(i)?i(a,n):o.setBusy(!1,a)},printDocumentExt:function(e,t,i,a,n){var o=KDLocalServicesPrinter,r=(" "+(t||"")).indexOf("Preview")>0;if(r){o.getPrnJobInfo(e,i);KDJSPrinter.printDocument(e,t,i,a,n)}else KDHTMLPrinter.printDocument(e,t,i,a,n)},printDocument:function(t,i,a,n,o){var r=KDHTMLPrinter,s=KDJSPrinter.reportTypeOptions[t],l=s.converter,d=(" "+(i||"")).indexOf("Preview")>0,c=r.getPrnJobInfo(t,a),h=c.pageId,u=c.jobId;if(KDJSPrinter.checkMaxPagesRule(c,t,i,a)){var p=o||{};if(e.isFunction(KDJSPrinter[l])){p.data=KDJSPrinter[l](a),r.prnPacks=r.prnPacks||{};var g=r.prnPacks[u]=r.prnPacks[u]||{data:{pages:{}}};g.data.datainfo=g.data.datainfo||p.data.datainfo,g.data.printSetting=g.data.printSetting||p.data.printSetting,r.docPrns=r.docPrns||{};var f=r.docPrns[u];f||(f=new KDHTMLPrintDocProxy,f.releaseCallback=function(e){delete r.docPrns[u],delete r.prnPacks[u]},f.printJobId=u,r.docPrns[u]=f),f.show(),t==e.KDPrintConst.ListReport&&$.extend(a,{isPrintable:!0,startIndex:0,count:p.data.datainfo.totalPages,limit:p.data.datainfo.totalPages});for(var m=0;m<a.limit;m++){var v=m+a.startIndex;g.data.pages[v]=p.data.pages[m]}a.startIndex+a.limit==a.count&&(f.setData(s,n,g),f.drawPages()),d||onPrinted({pageId:h,jobId:u,success:!0,printService:"KDHTMLPrinter",message:""})}}},getPrnAObjRet:function(e){var t={success:e.IsSuccessful,printService:"KDHTMLPrinter",params:[null],pageId:e.pageId,jobId:e.jobId,message:e.message,isoId:"",printAddress:""};return $.extend(t,e),t},getPrnJobInfo:function(e,t){var i=KDReportPlugInProxy.getPrnJobInfo(e,t);return i}})}(KD),define("KDHTMLPrinter",["KD","KDJSPrinter"],function(e){return function(){var t;return t||e.KDHTMLPrinter}}(this)),function(e){KDPDFPrinter=function(e){},$.extend(KDPDFPrinter,{PrintVersion:"1.0.0.0",acts:{},reportTypeOptions:{ListReport:{converter:"converListReport"},NoteReport:{converter:"converNoteReport"}},selectPrinter:function(e,t){return{message:"pure js printer is unsupport to selected local printers!"}},SelectPrinterExt:function(e,t,i){return{message:"pure js printer is unsupport to selected local printers!"}},printDocument:function(t,i,a,n,o){var r=(KDJSPrinter,KDJSPrinter.reportTypeOptions[t]),s=r.converter,l=o||{};if(e.isFunction(KDJSPrinter[s])){l.data=KDJSPrinter[s](a);var d=new KDJSPreviewProxy;d.init(r,n),d.show()}}})}(KD),define("KDPDFPrinter",["KD"],function(e){return function(){var t;return t||e.KDPDFPrinter}}(this)),KDPrintingStrategy=function(){},$.extend(KDPrintingStrategy,{getPageId:function(e){var t=e||{},i=t.owner||{},a=t.pageId||i.pageId||"";return a},getPrinter:function(e,t){var i="",a=KDPrintingStrategy,n=("."+(e||"")).toLowerCase().indexOf("preview")>0;return n?i=KDLocalServicesPrinter:(i=a.getH5PrintDrv(e,t),KD.isEmpty(i)&&(i=a.getDefaultPrinter(e,t))),i},getDefaultPrinter:function(e,t){var i=void 0,a=("."+(e||"")).toLowerCase().indexOf("preview")>0;if(a)i=KDLocalServicesPrinter;else if(KD.getConnectConfig().specH5PrintDrv){var n=KD.getConnectConfig().specH5PrintDrv;i=!KD.isIeBrowser()&&KD.equalsIgnoreCase(n,"KDActiveXPrinter")?this.getStrategyPrinter():window[n],i||(alert(ResManager.LoadKDString("统一指定的打印机驱动不存在，请检查服务器上的配置[SpecH5PrintDrv]项目是否正确。","0025710000004764")),i=KDHTMLPrinter)}else i=this.getStrategyPrinter(),i||alert(ResManager.LoadKDString("浏览器未支持打印组件或本地打印服务的调用，请使用最新高版本的浏览器或者桌面客户端应用进行打印.","0025710000007956"));return i},getStrategyPrinter:function(){var e=void 0;return!KD.isWinOS()||KD.isEdgeHttps()?e=KDHTMLPrinter:KD.isIeHttps()?e=KDHTMLPrinter:KD.supportWebSocket()?e=KDLocalServicesPrinter:KD.supportActiveX()&&(e=KDActiveXPrinter),KD.isInnerWebBrowser()&&(e=void 0!==KDActiveXPrinter.initPrnActiveXObj()?KDActiveXPrinter:KDHTMLPrinter),e},selectPrinter:function(e,t){var i=KDPrintingStrategy.getPageId(t);KD.delayInvoke(function(){var a=KDPrintingStrategy.getPrinter("",{pageId:i});void 0!==a&&a.selectPrinter(e,t)})},queryPrinterInfo:function(e,t,i){var a=KDPrintingStrategy.getPageId(i);KD.delayInvoke(function(){var n=KDPrintingStrategy.getPrinter("",{pageId:a});void 0!==n&&KD.isFunction(n.queryPrinterInfo)&&n.queryPrinterInfo(e,t,i)})},selectPrinterByType:function(e,t,i){var a=KDPrintingStrategy.getPageId(i);KD.delayInvoke(function(){var n=KDPrintingStrategy.getPrinter("",{pageId:a});void 0!==n&&KD.isFunction(n.selectPrinterByType)&&n.selectPrinterByType(e,t,i)})},printDocumentExt:function(e,t,i,a,n){var o=KDPrintingStrategy.getPageId(a),r=KDPrintingStrategy.getPrinter(t,{pageId:o});void 0!==r&&r.printDocumentExt(e,t,i,a,n)},printDocument:function(e,t,i,a,n){var o=KDPrintingStrategy.getPageId(a),r=KDPrintingStrategy.getPrinter(t,{pageId:o});void 0!==r&&r.printDocument(e,t,i,a,n)},getPrnAObjRet:function(e){var t=KDPrintingStrategy.getPageId(e),i=KD.format(",{0}",(e||{}).jobId||"").toLowerCase().indexOf("list")>0?"PrintListJSON.PrintAnsy":"PrintSync",a=KDPrintingStrategy.getPrinter(i,{pageId:t}),n=void 0;return a&&a.getPrnAObjRet&&(n=a.getPrnAObjRet(e)),n},setH5PrintDrv:function(e){var t=KDPrintingStrategy;t.drintDrvOptions=t.drintDrvOptions||{};for(var i in e)if(KD.isRunInForIn(i,e)){var a=e[i]||{},n={},o=a.targetType||"";if(!KD.isEmpty(o))if("page"==o){var r=a.target||"",s=ClientAppProxy.Current.getAliveForm(r);KD.isEmpty(s)||(n[o]=a,s.drintDrvOptions=n)}else if("form"==o){var l=(a.target||"").toLowerCase();if(!KD.isEmpty(l)){var d=KDPrintingStrategy.getPrintTypeId(l,a.printType);n[d]=a,$.extend(t.drintDrvOptions,n)}}else if("user"==o){var d=KDPrintingStrategy.getPrintTypeId(o,a.printType);n[d]=a,$.extend(t.drintDrvOptions,n)}else n[o]=a,$.extend(t.drintDrvOptions,n)}},getH5PrintDrv:function(e,t){var i="",a=KDPrintingStrategy,n="",o=KDPrintingStrategy.getPageId(t),r=$.extend({},a.drintDrvOptions);if(!KD.isEmpty(o)){var s=ClientAppProxy.Current.getAliveForm(o);KD.isEmpty(s)||(KD.equalsIgnoreCase(s.getFormId.call(s),"BOS_PrintProcessing")&&(s=ClientAppProxy.Current.getAliveForm(s.dformConfig.parentPageId||"")||s),n=KDPrintingStrategy.getPrintTypeId(s.getFormId.call(s),e),r=$.extend(r,s.drintDrvOptions||{}))}var l=KDPrintingStrategy.getPrintTypeId("user",e),d=["page",n,l];for(var c in d)if(KD.isRunInForIn(c,d)){var h=d[c];if(i=(r[h]||{}).specH5PrintDrv||"",!KD.isEmpty(i))break}var u=window[i];return!KD.isIeBrowser()&&KD.equalsIgnoreCase(i,"KDActiveXPrinter")&&(u=this.getStrategyPrinter()),u},getPrintType:function(e){var t=KD.format(",{0}",e).toLowerCase().indexOf("list")>0?"list":"note";return t},getPrintTypeId:function(e,t){var i=KDPrintingStrategy.getPrintType(t),a=KD.format("{0}_{1}",(e||"").toLowerCase(),i);return a}}),define("KDPrintingStrategy",["KDActiveXPrinter","KDLocalServicesPrinter","KDHTMLPrinter","KDPDFPrinter"],function(e){return function(){var t;return t||e.KDPrintingStrategy}}(this)),KD.PrintMode={NotePrint:"KDNotePageBuilder",ListPrint:"KDListPageBuilder"},KD.KDPrintConst={ListReport:"ListReport",NoteReport:"NoteReport",Ret_Message:"message",Ret_IsSuccessfull:"isSuccessfull",Ret_IsVisualList:"visuallist",Ret_PrintJobId:"printjobid",BillTitle:"BillTitle",ListRptViceTitles:"titles",PrintUser:"User",AfterPrintEvents:"AfterPrintEvents",PrinterAddress:"printerAddress",ServiceMethodName:"methodName",PageId:"pageId",ActionIsoId:"actionIsoId",ContinueOrNot:"continueOrNot",IncludeHardMargin:"includeHardMargin",DataUrl:"DataUrl",Key:"Key",Operation:"operation",GroupInfo:"GroupInfo",Pages:"pages",Count:"count",StartRecord:"StartRecord",RecordCount:"RecordCount",PrintConfig:"printConfig",PrintPageSetting:"PrintPageSetting",Columns:"columns",PageBuilder:"PageBuilder",OperationKey:"OperationKey",ServicePara:"ServicePara",GridKey:"GridKey",Print:"Print",Preview:"Preview",PrintMergePreview:"PrintMergePreview",ListPrintJobId:"ListPrint",ListRptViceTitles:"titles",PrintPageSetting_KEY:"Kingdee_BOS_LIST_PAGESETTINS"},KDReportPlugInProxy=function(){},$.extend(KDReportPlugInProxy,{RowCountLimit:1e4,printJobState:{get:function(e,t){return(KDReportPlugInProxy.printJobState[e]||{})[t]||""},set:function(e,t,i){var a=KDReportPlugInProxy.printJobState[e];!a&&(a=KDReportPlugInProxy.printJobState[e]={}),a[t]=i},remove:function(e,t){var i=KDReportPlugInProxy.printJobState[e];i&&delete i[t]},removeAdd:function(e){for(var t in KDReportPlugInProxy.printJobState)if(KD.isRunInForIn(t,KDReportPlugInProxy.printJobState)){var i=KDReportPlugInProxy.printJobState[t];i&&delete i[e]}}},getPlugin:function(e,t){var i=void 0;switch(e){case KD.PrintMode.ListPrint:i=new KDListReportPlugInProxy;break;case KD.PrintMode.NotePrint:i=new KDNoteReportPlugInProxy}return i.owner=t,i},selectPrinter:function(e,t){KDPrintingStrategy.selectPrinter(e,t)},queryPrinterInfo:function(e,t,i){KDPrintingStrategy.queryPrinterInfo(e,t,i)},selectPrinterExt:function(e,t,i){KDPrintingStrategy.selectPrinterByType(e,t,i)},printDocumentExt:function(e,t,i,a,n){KDPrintingStrategy.printDocumentExt(e,t,i,a,n)},printDocument:function(e,t,i,a,n){KDPrintingStrategy.printDocument(e,t,i,a,n)},getPrnAObjRet:function(e){var t=KDPrintingStrategy.getPrnAObjRet(e);return t},getPrnJobInfo:function(e,t){var i=e,a=t,n={};switch(i){case"NoteReport":var o=a.pages[0].printinfo||{},r=KDReportPlugInProxy.printJobState.get(KD.KDPrintConst.PrinterAddress,o.printjobid);n={isoId:o.actionIsoId,jobId:o.printjobid,pageId:o.pageId,printAddress:r};break;case"ListReport":var s=KD.KDPrintConst.ListPrintJobId,o=a.PrintConfig||{},r=KDReportPlugInProxy.printJobState.get(KD.KDPrintConst.PrinterAddress,s);n={isoId:o.actionIsoId,jobId:s,pageId:o.PageId,printAddress:r}}return n}}),KDReportPlugInProxy.prototype={},$.extend(KDReportPlugInProxy.prototype,{getRowCountLimit:function(){return KDReportPlugInProxy.RowCountLimit},getFormProxy:function(){return this.owner},hasPageSetup:function(){return!0},fireEvents:function(e,t){var i=this.getFormProxy(),a=this.getEventPack(t);i.fireCustomEvents.call(i,e,"",KD.stringify(a))},getEventPack:function(e){var t=this.printArg||{},i=t.printConfig||{},a={pageID:i.pageId||i.pageID,printJobId:t.printJobId,action:e,printBarName:null,PageBuilder:i.PageBuilder,actionIsoId:t.isoId,pageId:i.pageId||i.pageID,curPageId:i.pageId||i.pageID};return a},doPrintCommand:function(e){this.printArg=e;var t=e[KD.KDPrintConst.PageBuilder],i=e[operation],a=KD.getWaitToDevelop("["+t+"."+i+"]"+ResManager.LoadKDString("功能","0991733000003984")),n={msg:a,description:JSON.stringify(e),type:KDMessageBox.KDMesBoxType.Warning};KDMessageBox.show(n)},isPreview:function(e){return KD.equalsIgnoreCase(e,KD.KDPrintConst.Preview)||KD.equalsIgnoreCase(e,KD.KDPrintConst.PrintMergePreview)},callback:function(e,t,i){var a=this,n=a.getFormProxy(),o=e||"";if(o.startsWith("[{")||o.startsWith("{")||(e='{"pages":{"0":{"xaml":"<Canvas></Canvas>","index":0,"printinfo":{"printjobid":"x","papername":"A4","orientation":"PORTRAIT","marginleft":0,"marginright":0,"margintop":0,"marginbottom":0,"paperwidth":1,"paperheight":1,"paperwidthdm":1,"paperheightdm":1}}},"count":1,"limit":1,"startIndex":0,"isPrintable":true}'),e&&e.startsWith("[{")){var r=KD.parseObject(e);a.getFormProxy().doActions(r)}else e&&e.startsWith("{")?a.isPreview.call(a,a.action)?a.doPreviewCallback.call(a,e,t,i):a.doCallback.call(a,e,t,i):a.errcallback.call(a,e,"failure",i);n.setBusy(!1)},modelCommandHandler:function(e){KD.isFunction(e.callback)&&e.callback.call(e.scope,e)},errcallback:function(e,t,i){var a=this,n=a.getFormProxy();a.doErrcallback.call(a,e,t,i),n.setBusy(!1)},doCallback:function(e,t,i){},doPreviewCallback:function(e,t,i){},doErrcallback:function(e,t,i){},onPrinted:function(e){this.completedAction&&this.owner&&this.completedAction.call(this.owner,e)},onPrintedErr:function(e){this.errorAction&&this.owner&&this.errorAction.call(this.owner,e)},getMessagePageTemplate:function(e){return KDListReportHelper.getMessagePageTemplate(e)}}),onPreviewPrintBtnClick=function(e){var t=KDReportPlugInProxy.getPrnAObjRet(e),i=ClientAppProxy.Current.getAliveForm.call(ClientAppProxy.Current,t.pageId);return i&&i.onPreviewPrintBtnClick.call(i,t),!0},onPrinted=function(e){var t=KDReportPlugInProxy.getPrnAObjRet(e),i=ClientAppProxy.Current.getAliveForm.call(ClientAppProxy.Current,t.pageId);return i&&i.printCallBack.call(i,t),!0},onPrintedErr=function(e){var t=KDReportPlugInProxy.getPrnAObjRet(e),i=ClientAppProxy.Current.getAliveForm.call(ClientAppProxy.Current,t.pageId);return i&&i.printCallBack.call(i,t),!0},onPageSetup=function(e){var t=ResManager.LoadKDString("页面设置功能开发中,请暂时使用桌面客户端完成该操作.","0991733000003985");return void alert(t)},define("KDReportPlugInProxy",["KDPrintingStrategy"],function(e){return function(){var t;return t||e.KDListReportPlugInProxy}}(this)),KDNoteReportPlugInProxy=KD.extend(KDReportPlugInProxy,{hasPageSetup:function(){return!1},doPrintCommand:function(e){var t=this;t.printArg=e,t.firstLoad=!0;var i=e.printConfig||{};t.pageId=i.pageID||"",t.action=i.action,t.isoId=i.actionIsoId,void 0!==i.printerAddress&&KDReportPlugInProxy.printJobState.set(KD.KDPrintConst.PrinterAddress,i.printJobId,i.printerAddress);var a=i.methodName||i.MethodName;void 0!==a&&KDReportPlugInProxy.printJobState.set(KD.KDPrintConst.ServiceMethodName,i.printJobId,a),t.getBatchReport(e,0,-1)},getReport:function(e,t){var i=this,a=new ReportDataProxy;e.printConfig.start=t||0,a.getNoteReport(i,e)},getBatchReport:function(e,t,i){var a=this,n=new ReportDataProxy;e.printConfig.start=t||0,e.printConfig.pageSize=void 0===i?-1:i,n.getNoteReport(a,e)},modelCommandHandler:function(e){var t=this,i=t.getFormProxy(),a=e.cmdKey,n=t.printArg||{},o=t.printArg.printConfig||{},r=o.pageSize,s=o.pageIndex=e.currentPageIndex,l=(t.printPack||{}).data||{},d=(l.pages||[],t.pageFlags=t.pageFlags||{});if(KDJSPreviewProxy.isGotoPage(a)){var c=s;if(d[c])KD.isFunction(e.callback)&&e.callback.call(e.scope,e);else{t.commOptions=e;var h=s-s%t.dataPack.limit;t.getBatchReport(n,h,r)}}else if(KDJSPreviewProxy.isPrint(a)){var u=KD.cloneObject(n);$.extend(u.printConfig,{action:"PreviewPrint"}),i.doPrintCommand(u),KD.isFunction(e.callback)&&e.callback.call(e.scope,e)}else if(!KDJSPreviewProxy.isDefaultItem(a)){var p=KD.isEmpty(o)?"":KD.stringify(o);i.fireCustomEvents.call(i,KD.format("NOTE_PREVIEW_{0}",a),"MainBarItemClick",p),a&&a.indexOf&&a.indexOf("_CloseAfter")>=0&&e&&KD.isFunction(e.callback)&&e.callback.call(e.scope,e)}},getTotalPages:function(){var e=this,t=(e.printPack||{}).data||{},i=t.datainfo||{},a=i.totalPages||0;return a},createData:function(e){var t=KD.getValue(e,"count",-1)||0,i=KD.getValue(e,"limit",-1)||0,a=KD.getValue(e,"startIndex",-1)||0,n=KD.getValue(e,"isPrintable",!0);return{pages:new Array(t),count:t,limit:i,isPrintable:n,startIndex:a}},checkPageCount:function(e){var t=KD.getValue(e,"count",-1)||0,i=e.pages||[];-1!=t&&t<i.length&&i.splice(t,i.length-t)},setPrnPageData:function(e){for(var t=this,i=KD.getValue(e,"count",-1)||0,a=KD.getValue(e,"limit",-1)||0,n=KD.getValue(e,"startIndex",-1)||0,o=(t.printArg||{},t.printArg.printConfig||{},t.dataPack=t.dataPack||t.createData(e)),r=t.pageFlags=t.pageFlags||{},s="1"==KD.getLocalConfiguration().PrintIncludeHardMargin,l=1==KD.getLocalConfiguration().UseClientPrinterSetting,d=e.pages||[],c=0;a>c;c++){var h=d[c.toString()];r[c+n]=!0,o.pages[c+n]=h;var u=h.printinfo,p=u.printjobid;u.pageId=t.pageId,u.actionIsoId=t.isoId,u.printerAddress=KDReportPlugInProxy.printJobState.get(KD.KDPrintConst.PrinterAddress,p),u.includeHardMargin=s,u.isUseClientPrinterSetting=l,h.index=c+n}if(t.checkPageCount(o,i),!KD.isEmpty(t.printPack)&&t.printPack.data)for(var g=t.printPack.data.pages||{},c=0;a>c;c++){var h=o.pages[c+n];g[c+n]=h}},getPrnPage:function(e){var t=this,i=(t.printPack||{}).data||{},a=i.pages||[],n=a[e]||{xaml:t.getMessagePageTemplate(),index:e,printinfo:(a[0]||{}).printinfo||{}};return n},doCallback:function(e,t,i){var a=this,n=e,o=KD.parseObject(n),r=(o.count||0,o.startIndex||0,o.limit||0),s=o.pages,l=s?s[0].printinfo:{},d=l.printjobid,c=KDReportPlugInProxy.printJobState.get(KD.KDPrintConst.PrinterAddress,d);if(void 0!==d){var h="1"==KD.getLocalConfiguration().PrintIncludeHardMargin,u=1==KD.getLocalConfiguration().UseClientPrinterSetting;if(a.printPack=a.printPack||{},a.setPrnPageData(o),!KD.isArray(s)){for(var p=[],g=0;r>g;g++){var f=s[g.toString()],m=f.printinfo.printjobid;f.printinfo.pageId=a.pageId,f.printinfo.actionIsoId=a.isoId,f.printinfo.printerAddress=KDReportPlugInProxy.printJobState.get(KD.KDPrintConst.PrinterAddress,m),f.printinfo.includeHardMargin=h,f.printinfo.isUseClientPrinterSetting=u,p.push(f)}o.pages=p,n=o}var v=a.isPreview.call(a,a.action),y=v?"Preview":"PrintSync";c?KDReportPlugInProxy.printDocument("NoteReport",y,n,a,a.printPack):KDReportPlugInProxy.printDocumentExt("NoteReport",y,n,a,a.printPack)}},doPreviewCallback:function(e,t,i){var a=this,n=e,o=KD.parseObject(n);KD.getValue(e,"count",-1)||0,KD.getValue(o,"startIndex",-1)||0;if(a.printPack=a.printPack||{},a.setPrnPageData(o),a.firstLoad){a.firstLoad=!1;var r=a.isPreview.call(a,a.action),s=r?"Preview":"PrintSync";KDReportPlugInProxy.printDocument("NoteReport",s,a.dataPack,a,a.printPack)}else a.commOptions&&KD.isFunction(a.commOptions.callback)&&a.commOptions.callback.call(a.commOptions.scope,a.commOptions)},doErrcallback:function(e,t,i){}}),define("KDNoteReportPlugInProxy",["KDReportPlugInProxy","KD"],function(e){return function(){var t;return t||e.KDNoteReportPlugInProxy}}(this)),KDListReportPlugInProxy=KD.extend(KDReportPlugInProxy,{getTitles:function(){var e=(this.dataPack||{}).titles||[];return e},doPrintCommand:function(e){var t=this;t.printArg=t.validServicePara(e),t.printArg.printJobId=KD.KDPrintConst.ListPrintJobId,t.firstLoad=!0,t.getBatchReport(e,0,-1)},getReport:function(e,t){var i=this;i.pageSize=KDListReportHelper.calcPageSize(i.generalDataPack());var a=new ReportDataProxy;e.printConfig.pageIndex=t||0,a.getListReport(i,e)},getBatchReport:function(e,t,i){var a=this,n=a.printArg.printConfig||{},o=a.generalDataPack();n.PrintPageSetting||(n.PrintPageSetting=o.PrintPageSetting),this.pageSize=KDListReportHelper.calcPageSize(o);var r=a.getRowCountLimit();"Preview"==n.OperationKey&&(r=a.pageSize||a.getRowCountLimit(),n.pageIndex=t||0);var s=new ReportDataProxy;n.pageSize=r,n.start=n.pageIndex*n.pageSize,s.getListReport(a,a.printArg)},modelCommandHandler:function(e){var t=this,i=t.getFormProxy(),a=e.cmdKey,n=t.printArg||{},o=t.printArg.printConfig||{},r=o.pageSize,s=o.pageIndex=e.currentPageIndex,l=(t.printPack||{}).data||{},d=(l.pages||[],l.datainfo||{}),c=d.colPageCount||1,h=parseInt((s+1)/c)+((s+1)%c==0?0:1)-1;if(KDJSPreviewProxy.isGotoPage(a))t.dataPageFlags&&t.dataPageFlags[h]?KD.isFunction(e.callback)&&e.callback.call(e.scope,e):(t.commOptions=e,t.getBatchReport(n,h,r));else if(KDJSPreviewProxy.isPrint(a)){var u=KD.cloneObject(n);$.extend(u.printConfig,{OperationKey:"PrintAnsy",pageIndex:0}),i.doPrintCommand(u),KD.isFunction(e.callback)&&e.callback.call(e.scope,e)}else KDJSPreviewProxy.isPageSetup(a)?(i.fireEvent.call(i,"MainBarItemClick",KD.KDPrintConst.PrintPageSetting_KEY),KD.isFunction(e.callback)&&e.callback.call(e.scope,e)):KDJSPreviewProxy.isDefaultItem(a)||i.fireCustomEvents.call(i,KD.format("LIST_PREVIEW_{0}",a),"MainBarItemClick","")},generalDataPack:function(e){var t=this,i=e||t.printArg||{},a=t.getFormProxy(),n=a.dformConfig,o=i.printConfig.OperationKey,r=i.printConfig.ServicePara.columns,s={Operation:o,Columns:r},l=i.printConfig.ServicePara[KD.KDPrintConst.PrintConfig];if(l[KD.KDPrintConst.BillTitle]=n?n.getBillTitle():"",!l[KD.KDPrintConst.PrintPageSetting]){var d=KDListReportHelper.getDefaultPageSet();l[KD.KDPrintConst.PrintPageSetting]=KD.stringify(d)}return l[KD.KDPrintConst.ActionIsoId]=i.isoId,l[KD.KDPrintConst.PrintUser]=(ClientAppProxy.Current.CTX||{}).UserName||"...",s.PrintConfig=l,s},getTotalPages:function(){var e=this,t=((e.dataPack||{}).data||{}).actualDataRow||0,i=(e.printPack||{}).data||{},a=i.datainfo||[],n=0==t?0:a.totalPages||0;return n},getPrnPage:function(e){var t=this,i=(t.printPack||{}).data||{},a=i.datainfo||[],n=a.totalFeatures;xaml=KDListReportHelper.getPageContentXaml(e,t.dataPack,n);var o={xaml:xaml,index:e};return o},createListData:function(e,t){return{rows:new Array(e),rowcount:e,limit:t}},checkRowCount:function(e){var t=KD.getValue(e,"rowcount",-1)||0,i=e.rows||[];-1!=t&&t<i.length&&i.splice(t,i.length-t)},initTitlesDebugData:function(e){if(KD.isDebug()&&KD.isEmpty(KD.getValue(e,KD.KDPrintConst.ListRptViceTitles,[]))){var t=[{label:"Code",value:"0000001"},{label:"Created Date",value:"2018-05-09"},{label:"Creater",value:"demo"},{label:"Created Org.",value:"Sales Org."},{label:"Doc. Status",value:"Audited"},{label:"The Data",value:"Debugger Data"}];e[KD.KDPrintConst.ListRptViceTitles]=t}},setListPrnPageData:function(e){var t=this,i=(t.printArg||{},t.printArg.printConfig||{}),a=i.pageSize,n=KD.getValue(e,"rowcount",a)||0,o=(KD.getValue(e,"startrow",0)||0,i.pageIndex||0);n=-1==n?t.getRowCountLimit():n,t.initTitlesDebugData(e);var r=t.dataPack.data=t.dataPack.data||t.createListData(n,a),s=t.dataPageFlags=t.dataPageFlags||{};if(r.titles=KD.getValue(e,KD.KDPrintConst.ListRptViceTitles,[]),r.actualDataRow=(e.rows||[]).length,s[o]=!0,t.checkRowCount(r,n),!KD.isEmpty(e.rows))for(var l=0;a>l;l++){var d=l+a*o;if(!(n>d&&d<r.rows.length))break;r.rows[d]=e.rows[l]}},doCallback:function(e,t,i){var a=this,n="PrintListJSON",o=e,r=a.printArg.printConfig||{};try{var s=KD.parseObject(o),l=a.dataPack=a.dataPack||a.generalDataPack(),d=s.rows,c=r.ServicePara.columns,h=r.OperationKey;n=n+"."+h;var u=(" "+(n||"")).indexOf("Preview")>0;if(!u&&0==(d||{}).length){var p=a.getFormProxy(),g=ResManager.LoadKDString("没有取到数据，请检查查询条件和打印权限。","0025710000004279"),f=[{actionname:"showConfirm",params:[{title:"",msg:g,option:0,msgType:0}]}];return void p.doActions.call(p,f)}var m={datefield:!0,datetimefield:!0,numberfield:!0},v=s.titles||[];$.each(v,function(e){var t=v[e]||{};t.label=KDListReportHelper.covertSpecialChar(t.label||""),t.value=KDListReportHelper.covertSpecialChar(t.value||"")}),$.each(c,function(e){var t=c[e];1==m[t.xtype]?$.each(d,function(e){var i=d[e],a=i[t.colIndex];KD.isArray(a)?a=a.length>0?a[0]:"":"string"!=typeof a&&(a=JSON.stringify(a)),a&&(a=KDListReportHelper.covertSpecialChar(a)),i[t.colIndex]=a}):$.each(d,function(e){var i="",a=d[e]||{},n=a[t.colIndex]||"";KD.isString(n)?i=KDListReportHelper.covertSpecialChar(n):KD.isArray(n)&&(i=KDListReportHelper.covertSpecialChar(n[0]||"")),a[t.colIndex]=i})}),a.setListPrnPageData(s)}catch(y){KD.writeError(y)}a.printPack=a.printPack||{},a.firstLoad?(a.firstLoad=!1,KDReportPlugInProxy.printDocumentExt(KD.KDPrintConst.ListReport,n,l,a,a.printPack)):a.commOptions&&KD.isFunction(a.commOptions.callback)&&a.commOptions.callback.call(a.commOptions.scope,a.commOptions)},doErrcallback:function(e,t,i){},validServicePara:function(e){var t=e;try{var i=t.printConfig.ServicePara.printConfig.PrintPageSetting;if(!KD.isEmpty(i)){var a=KD.parseObject(t.printConfig.ServicePara.printConfig.PrintPageSetting);a.PrintingCellHeight<21&&(a.PrintingCellHeight=21),t.printConfig.ServicePara.printConfig.PrintPageSetting=KD.stringify(a)}}catch(n){}return t}}),define("KDListReportPlugInProxy",["KDReportPlugInProxy","KD"],function(e){return function(){var t;return t||e.KDListReportPlugInProxy}}(this)),KDSchedulerProxy=KD.extend(KDControlProxy,{loadConfig:function(e){KDSchedulerProxy.superclass.loadConfig.call(this,e),this.setResourceCaptioin(e.ResourceCaptioin||""),this.setIsCancelShowEditForm(e.isnotshowform||!1)},initComponent:function(){this.toolbarProxy=this._createToolbar(),this.resourceCombo=this._buildResourceCombo(),this.calendar=this._createCalendar(),this.KDSchedulerDateNavigate=this._createKDSchedulerDateNavigate(),this.rendered=!0},_createToolbar:function(){var e=new Object;e.actionKey="MainBarItemClick",e.id="SchedulerToolbar",e.ismainmenu=!0,e.parent=this.baseId,e.showicon=!1,e.visible=!0,e.dock=KD.dock.Top,e.height=30,e.xtype="toolbar";var t=this.getControlFactoryProxy(),i=t.createControl.call(t,e);return i.loadConfig.call(i,e),i.initComponent.call(i),this.el.append(i.el),i},_buildResourceCombo:function(){var e=new Object;e.id="LIGHTAPPTITLE",e.width=750,e.height=21,e.labelText=this.ResourceCaption,e.labelWidth=70,e.xtype="kditemcontainer";var t=new Object;e.item=t,t.xtype="kdcombo",t.isMulti=!0,t.id="LIGHTAPPTITLE-editor";var i=this.getControlFactoryProxy().createControl(e),a=$("<div></div>");a.append(i.getControl()),this.toolbarProxy.el.find("ul").append(a),i.loadConfig(e),i.initComponent(),i.editor.setValue(""),i.el.css("position","initial");var n=i.editor,o=this;return n.onchange=function(e,t){o._onSelectComboClose(e)},n},_onSelectComboClose:function(e){for(var t=this,i=t.resourceCombo.getValue(),a=t.calendar.data(),n=0;n<a.length;n++){var e=a[n];-1==i.indexOf(e.ResourceId)?t.el.find(".event_"+e.ResourceId+"_class").parent().css("display","none"):t.el.find(".event_"+e.ResourceId+"_class").parent().css("display","block");
}},getCalendarOptions:function(){var e=this,t={date:new Date,dateHeaderTemplate:kendo.template("<strong>#=kendo.toString(date, 'yyyy-MM-dd')#</strong>"),height:665,messages:{allDay:ResManager.LoadKDString("整天","0025710030032348"),today:ResManager.LoadKDString("今天","0025710030032349"),views:{week:ResManager.LoadKDString("周","0991733000003966"),month:ResManager.LoadKDString("月","0991733000003967"),day:ResManager.LoadKDString("日","0991733000003965"),workWeek:ResManager.LoadKDString("工作日","0025710030032350")}},views:["month","workWeek","week","day"],dataSource:[],editable:{destroy:!1,move:!1},eventTemplate:'<div class="#: className #">#: title #</div>',edit:function(t){if(t.preventDefault(),e.IsCancelShowEditForm){var i=t.event,a=e._CreateEventItemFromAppointment(i);e.getFormProxy().fireCustomEvents(e.key,"EventItemDoubleClick",JSON.stringify(a))}},remove:function(e){e.preventDefault()},select:function(e,t){},navigate:function(t){e._selectDatesChanged(t.date,t.view),e.KDSchedulerDateNavigate&&e.KDSchedulerDateNavigate.data("kendoCalendar")&&e.KDSchedulerDateNavigate.data("kendoCalendar").value(t.date)}};return t},_selectDatesChanged:function(e,t){var i=1;switch(t){case"month":i=21;break;case"week":i=4;break;case"workWeek":i=3}var a=new Array,n=new Date;n.setTime(e.getTime()),n.setDate(n.getDate()-i),a.push("/Date("+n.getTime()+"+0800)/"),n.setDate(n.getDate()+1);for(var o=0;i>o;o++)a.push("/Date("+n.getTime()+"+0800)/"),n.setDate(n.getDate()+1);n.setTime(e.getTime()),n.setDate(n.getDate()+i);for(var o=0;i-1>o;o++)a.push("/Date("+n.getTime()+"+0800)/"),n.setDate(n.getDate()-1);this.getFormProxy().fireCustomEvents(this.key,"SelectedDatesChanged",JSON.stringify(a))},_createCalendar:function(){var e=this,t=$('<div id="'+this.baseId+'-calendar" style="padding-top:30px;margin-left:5px;margin-bottom:5px;margin-right:5px;"></div>');this.el.append(t);var i=t.kendoScheduler(this.getCalendarOptions()).data("kendoScheduler");return this._selectDatesChanged(new Date,"month"),t.bind("mousewheel",function(t){var i=$(t.target).closest(".fc-scroller");if(i.length>0){var a=i[0].scrollHeight;if(0!=i.scrollTop()&&i.scrollTop()+i.height()!=a)return}var n=!1;120==t.originalEvent.wheelDelta?(0==i.length||0==i.scrollTop())&&($(".k-nav-prev",e.el).click(),n=!0):-120==t.originalEvent.wheelDelta&&(0==i.length||i.scrollTop()+i.height()==i[0].scrollHeight)&&($(".k-nav-next",e.el).click(),n=!0),n&&KD.stopBubble(t)}),i},_CreateEventItemFromAppointment:function(e){var t=new Object;t.ReminderInfo="",t.Description=e.title,t.AllDay=e.allDay;var i=void 0!=e.end.toDate?e.end.toDate().getTime():e.end.getTime();t.EndTime="/Date("+(i.toString().endWith("888")?i-888:i)+"+0800)/",t.Label=e.label,null!=e.RecurrenceInfo?t.RecurrenceInfo=e.RecurrenceInfo:t.RecurrenceInfo=string.Empty,t.ResourceId=e.ResourceId;var a=void 0!=e.start.toDate?e.start.toDate().getTime():e.start.getTime();return t.StartTime=a-888,t.Status=e.Status,t.Subject=e.title,t.Id=e.id,t.Type=e.Type,t.PatternEventItemId=this._getPatternId(e),t.Duration=e.Duration,e.ResourceIds.lenght>0?t.ResourceIds=e.ResourceIds.join(","):t.ResourceIds="",t},_getPatternId:function(e){var t=e.RecurrencePattern;return null!=t?1==t.Type?null==t.Id?-1:parseInt(t.Id):this._getPatternId(t):null==t?-1:parseInt(t.Id)},_createKDSchedulerDateNavigate:function(){var e=this,t=($('<div style="display:none"></div>'),new Object);t.xtype="kdschedulerdatenavigate",t.id="schedulerdatenavigate",t.isshowweek=!0;var i=this.getControlFactoryProxy(),a=i.createControl.call(i,t);a.loadConfig.call(a,t),a.initComponent.call(a),a.el.css("display","none"),this.el.append(a.el);var n=a.component;return a.onSelect=function(t,i){e.calendar.date(t)},n},addSubButtonItem:function(e,t,i){var a=this,n=new Object;n.caninvokeoperation=!1,n.id=e,n.showTitle=!0,n.showicon=!1,n.showprocessbar=!1,n.text=t,n.tooltipType="text",n.visible=!0,n.xtype="splitbutton",n.caninvokeoperation=!1,n.items=new Array;for(var o in i){var r=i[o];n.items.push(this._buildButtonItemConfig(r))}this.toolbarProxy.addItem(n);for(var o in n.items)var i=n.items[o];this.toolbarProxy.clickHandler=function(e){var t=$(".kdmenuitem-content",e.target)[getPropName()]("id"),i=this.getButtonKey(t);a.getFormProxy().fireCustomEvents(a.key,"UsedefineButtonClick",i)}},addButtonItem:function(e){if(e&&e.length>0){var t=this._buildButtonItemConfig(e[0]);this.toolbarProxy.addItem(t)}},_buildButtonItemConfig:function(e){var t=new Object;return t.caninvokeoperation=!0,t.id=e.ButtonName,t.showTitle=!0,t.showicon=!1,t.showprocessbar=!1,t.text=e.Description,t.tooltipType="text",t.visible=!0,t.xtype="button",t.key=e.ButtonName,t},addEventItem:function(e){var t=new Array,i=new Array;for(var a in e){var n=e[a],o=this._createEventItemFromJObect(n);this.resourceIds=this.resourceIds||new Array,-1==this.resourceIds.indexOf(n.resourceid)&&this.resourceIds.push(n.resourceid),t.push(o),i.push(n.id)}for(var a in i)this.calendar.removeEvent(i[a]);var r=new kendo.data.SchedulerDataSource({data:t});this.calendar.setDataSource(r),this._onSelectComboClose()},_createEventItemFromJObect:function(e){if(null==e)return null;var t=new Object;return t.Type=e.type||0,t.start=e.starttime,t.end=e.endtime!=e.starttime?e.endtime:e.endtime+".888",t.Description=e.description,t.allDay="true"==t.allday?!0:!1,t.label=e.label||0,t.ResourceId=e.resourceid||"_empty",t.Status=e.status||0,t.title=e.subject||"",t.RecurrenceInfo=e.recurrenceinfo||"",t.ReminderInfo=e.reminderinfo||"",t.id=void 0===e.id?-1:e.id,t.PatternEventItemId=void 0===e.patterid?-1:e.patterid,t.ResourceIds=this._formatResourceId(e.resourceids,t.ResourceId),t.Duration=e.duration,t.className="event_"+e.resourceid+"_class",t.backgroundColor=this._getStatuColor(e.status),t.textColor="black",t},_getStatuColor:function(e){var t="#F0F3F8";switch(e){case"2":t="#F0F3F8";break;case"1":t="#E6EFDB";break;case"0":t="#E3EDEF"}return t},_formatResourceId:function(e,t){return null==e?[t]:e instanceof Array?e:e.split(",")}}),$.extend(KDSchedulerProxy.prototype,{IsCancelShowEditForm:!1,ResourceCaption:"",setResource:function(e){if(this.resourceCombo){this.resourceCombo.store=e,this.resourceCombo.setStore(e);for(var t=e[0][0]+",",i=1;i<e.length;i++)t=t+","+e[i][0];this.resourceCombo.setValue(t)}},setResourceCaptioin:function(e){this.ResourceCaption=e,this.resourceCombo&&this.resourceCombo.itemContainer.el.find("[role='kdlabel']").text(e)},setIsCancelShowEditForm:function(e){this.IsCancelShowEditForm=e}}),KDControlFactoryProxy.registerType("kdscheduler",KDSchedulerProxy),define("KDSchedulerProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDSchedulerProxy}}(this)),KDPyramidControlProxy=KD.extend(KDControlProxy,{createControl:function(e){KDPyramidControlProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDPyramidControlProxy.superclass.loadConfig.call(this,e)},pyramid_PyramidClick:function(e){this.getFormProxy().fireCustomEvents(this.key,"PyramidEvents",e)},setValue:function(e){for(var t=this,i=this._initSize(),a=kendo.drawing,n=kendo.geometry,o=a.Surface.create(this.el,{click:function(e){var i=e.element.options;if(i&&i.FLevel){var a=i.FLevel,n={FLevel:a};t.pyramid_PyramidClick(KD.stringify(n))}}}),r=i.width/2,s=1,l=e.length,d=i.height/l,c=i.width/(2*l),h=0;h<e.length;h++){var u=e[h],p=.15*d*(h+1),g=0==h?d*h:d*h+s,f={x:0==h?r-s:c*(l-h)+p-s,y:0==h?g:g-p},m={x:r-s,y:g},v={x:r-s,y:d*(h+1)-s},y={x:v.x+s-c*(h+1)+p,y:d*(h+1)-s-p},b=new a.Path({fill:{color:this._getColor(h)},tooltip:{content:u.FLevel},FLevel:u.FLevel,FCount:u.FCount}).moveTo(f.x,f.y).lineTo(m.x,m.y).lineTo(v.x,v.y).lineTo(y.x,y.y).close();o.draw(b);var D={x:m.x+2*s,y:m.y},k={x:2*r-(f.x+s)+s,y:f.y},C={x:2*r-(y.x+s)+s,y:y.y},x={x:v.x+2*s,y:v.y},w=new a.Path({fill:{color:this._getColor(h)},tooltip:{content:u.FLevel},FLevel:u.FLevel+"_back",FCount:u.FCount}).moveTo(D.x,D.y).lineTo(k.x,k.y).lineTo(C.x,C.y).lineTo(x.x,x.y).close();o.draw(w);var K={x:0==h?f.x-c/2+10:f.x+c/2,y:0==h?f.y+d/2-10:f.y+d/2-15},K=new n.Point(K.x,K.y),S=new a.Text(u.FCount,K);o.draw(S);var I=new n.Point(i.width+10,K.y),S=new a.Text(u.FLevel,I);o.draw(S);var P=(new a.Path).moveTo(i.width-y.x-8,K.y+7.5).lineTo(i.width+5,K.y+7.5).close();o.draw(P)}},_initSize:function(){var e={width:this.el.parent().width()-75,height:this.el.parent().height()-60};return this.el.width(e.width+75),this.el.height(e.height+60),e},_getColor:function(e){var t=e%10,i="#ffa449";switch(t){case 0:i="#ffa449";break;case 1:i="#ffe644";break;case 2:i="#7acd65";break;case 3:i="#4da8fb";break;case 4:i="#ae6efe";break;case 5:i="#ff5a49";break;case 6:i="#f5f76e";break;case 7:i="#33a27c";break;case 8:i="#4e72f4";break;case 9:i="#7c6df3"}return i}}),KDControlFactoryProxy.registerType("kdpyramid",KDPyramidControlProxy),define("KDPyramidControlProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDPyramidControlProxy}}(this)),KDFunnelControlProxy=KD.extend(KDPyramidControlProxy,{loadConfig:function(e){KDFunnelControlProxy.superclass.loadConfig.call(this,e)},pyramid_PyramidClick:function(e){var t=this.getFormProxy();t.fireCustomEvents(this.key,"FunnelEvents",e)},setValue:function(e){var t=this,i=this._initSize(),a=e.length,n=.6*i.width,o=10,r=$("<div funnelRole='ovalDiv' style='width:60%;float:left;'></div>"),s=$("<div funnelRole='titleDiv' style='width:40%;float:left;'></div>");this.el.append(r),this.el.append(s),this.el.append($('<div style="clear:both;"></div>'));for(var l=0,d=.85,c=0;a>c;c++){var h=e[c],u=n-2*o*c,p=(n-o*c)/2,g=0==c?0:0-l-d*p;l=0==c?0:l+d*p;var f="background:"+this._getColor(c)+";z-index:"+(a-c)+";width:"+u+"px;height:"+p+"px;border-radius:"+p+"px / "+p/2+"px;top:"+g+"px;margin-left:"+o*c+"px;position: relative;border-color: white;border-style: solid;",m=$(kendo.format("<div style='{0}' key='{1}'></div>",f,h.FKey));r.append(m),r.click(function(e){var i=$(e.target),a=i.attr("key"),n={FKey:a};t.pyramid_PyramidClick(KD.stringify(n))});var v=$(kendo.format("<div style='margin-top:8px;margin-left: 20px;'><span style='height:10px;width:20px;background:{3};display:inline-block;'></span><span style='margin-left: 10px;'>  {0}、{1}--{2}</span></div>",c+1,h.FName,h.FValue,this._getColor(c)));s.append(v)}},_initSize:function(){var e={width:this.el.parent().width(),height:this.el.parent().height()};return this.el.width(e.width),this.el.height(e.height),e}}),KDControlFactoryProxy.registerType("kdfunnelid",KDFunnelControlProxy),define("KDFunnelControlProxy",["KDPyramidControlProxy","KD"],function(e){return function(){var t;return t||e.KDFunnelControlProxy}}(this)),KDPictureScrollProxy=KD.extend(KDControlProxy,{ImageItemHeight:null,ImageItemWidth:null,FailLoadDisplayText:null,IsNewCard:void 0,ImageLoadFailUrl:"/images/biz/default/MainConsole/H5CardLayout/loadfail01.png",NodataText:ResManager.LoadKDString("暂无数据","0991733000006734"),NodataImageUrl:"../images/biz/default/MainConsole/H5CardLayout/Nodata.png",loadConfig:function(e){KDPictureScrollProxy.superclass.loadConfig.call(this,e),e.imagesdata&&this.setImagesData(e.imagesdata)},initComponent:function(){KDPictureScrollProxy.superclass.initComponent.call(this),this.rendered=!0},setSelectItem:function(e){},setImageItemHeight:function(e){this.ImageItemHeight=e},setImageItemWidth:function(e){this.ImageItemWidth=e},setImageLoadFailUrl:function(e){this.ImageLoadFailUrl=e},setNodataTemplate:function(e){KD.isObject(e)&&(this.NodataText=e.text||this.NodataText,this.NodataImageUrl=e.imageUrl||this.NodataImageUrl)},setFocusOn:function(e){var t=this.baseId+"_headlink_c";this.el.find("#"+t)&&this.el.find("#"+t).focus()},setFailLoadDisplayText:function(e){this.FailLoadDisplayText=e},setIsNewCard:function(e){this.IsNewCard=e},setInfoData:function(e){function t(e){$(L[R]).removeClass("active"),$(L[e]).addClass("active"),$(T).stop(!0,!0),$(T).fadeIn(O,function(){s.find("a[sid='"+e+"']").prependTo(s),s.css("marginLeft","0px");var t=s.find("a").eq(0).attr("closeable");t&&KD.equalsIgnoreCase(t,"true")&&s.find("a").eq(0).children(".kd-loop-closead").css({display:"inline-block"})}),R=N=e}var i=this;if(i.el.empty(),e&&e.length>0){var a=this.baseId+"_headlink_c",n=kendo.format("<div class='kd-picscroll-accordionhead'><a id='{0}' href='#'></a></div>",a);this.el.append(n);var o=KD.isEmpty(this.ImageItemWidth)?"":kendo.format("width:{0}px;",this.ImageItemWidth),r=$(kendo.format("<div class='loop-showbox' id='{0}' style='{1}'></div>",this.baseId+"_LOOP-SHOWBOX",o)),s=$(kendo.format("<div class='loop-imagebox' id='{0}' style='height:{1}px;max-width:100%'></div>",this.baseId+"_LOOP-IMAGEBOX",this.ImageItemHeight)),l=$("<div class='loop-icobox' id='"+this.baseId+"_LOOP-ICOBOX'></div>"),d=KD.getImageUrlByNameAndVersion("kd_big_icon_extend.png"),c="";KD.isEmpty(this.ImageItemHeight)||(c="top:"+(this.ImageItemHeight-26)/2+"px;");var h=$(kendo.format("<div class='loop-slide-left' style= 'background-image:url({0});{1}'></div>",d,c)),u=$(kendo.format("<div class='loop-slide-right' style= 'background-image:url({0});{1}'></div>",d,c));this.el.append(r),r.append(s),r.append(l),r.append(h),r.append(u),1==e.length?(h.hide(),u.hide()):(r.off("mouseenter").on("mouseenter",function(){$(this).find(".loop-slide-left").css("display","block"),$(this).find(".loop-slide-right").css("display","block")}),r.off("mouseleave").on("mouseleave",function(){$(this).find(".loop-slide-left").css("display","none"),$(this).find(".loop-slide-right").css("display","none")}));for(var p=0;p<e.length;p++){var g=e[p].entryUrl,f=e[p].image,m=f&&f.replace("data:image/png;base64,",""),v="",y="";if(KD.isEmpty(m)){var b=this.FailLoadDisplayText?this.FailLoadDisplayText:"";y=this.IsNewCard?"loadfailedimg":"oldcard-loadfailedimg",v=kendo.format('<span class="kd-imgloadfailed-tip">{0}</span>',b)}var D=e[p].closable&&KD.equalsIgnoreCase(e[p].closable.toString(),"true")?!0:!1,k=e[p].infoid?e[p].infoid:"",C=e[p].isTop&&e[p].isTop?!0:!1,x=this.baseId+"_LOOP-IMAGE"+p,w=0===p&&1==D?"display:block":"display:none",K=$(kendo.format("<a class='kd-picscroll-container' sid='{4}' style='{3}' id='"+x+"' href='#' data-href='"+g+"' infoid='"+k+"' closeable='"+D+"'><img class='"+y+"' src='"+f+"'/>"+v+"<div class='kd-loop-closead' style='{2}'><div class='kd-picclosebtn-closed'><div class='kd-picclosebtn-bg'></div></div><div class='kd-poprectangle-container'><div class='kd-triangle-container'></div><div class='kd-picpopover-content'><div class='kd-popover-option'><div class='kd-popover-optiontext' canceltype='{0}'>"+ResManager.LoadKDString("屏蔽这条推送","014003030033906")+"</div></div><div class='kd-popover-option'><div class='kd-popover-optiontext' canceltype='{1}'>"+ResManager.LoadKDString("对这类推送不感兴趣","014003030033907")+"</div></div></div></div></div></div></a>",0,1,w,o,p));if(s.append(K),K.children("img").on("click",function(){var e=i.getFormProxy();e.fireCustomEvents.call(e,"LoopImage","ChartImageClick",$(this).parent("a").data("href"))}),K&&K.unbind("mouseover").bind("mouseover",function(e){V=!1}),K&&K.unbind("mouseout").bind("mouseout",function(e){V=!0}),h.unbind("mouseover").bind("mouseover",function(e){V=!1}),h.unbind("mouseout").bind("mouseout",function(e){V=!0}),u.unbind("mouseover").bind("mouseover",function(e){V=!1}),u.unbind("mouseout").bind("mouseout",function(e){V=!0}),h.off("click").on("click",function(){if(e.length>1){var i=parseInt(L.closest(".active").attr("rel"));i--,0>i&&(i=e.length-1),t(i)}}),u.off("click").on("click",function(){if(e.length>1){var i=parseInt(L.closest(".active").attr("rel"));i++,i%=e.length,t(i)}}),D){var S=K.find(".kd-picclosebtn-closed"),I=K.find(".kd-poprectangle-container"),P=K.find(".kd-popover-option");S&&S.unbind("mouseover").bind("mouseover",function(e){V=!1}),I&&I.unbind("mouseover").bind("mouseover",function(e){V=!1}),P&&P.unbind("click").bind("click",function(e){$(this).parents(".kd-loop-closead").css({display:"none"});var t=i.getFormProxy(),a=$(i.el.find(".loop-imagebox").children("a")[0]).attr("infoid")?$(i.el.find(".loop-imagebox").children("a")[0]).attr("infoid"):$(this).parents("a.kd-picscroll-container").attr("infoid");"0"==$(this).children(".kd-popover-optiontext").attr("canceltype")?a&&!KD.isEmpty(a)&&t&&t.fireCustomEvents.call(t,"LoopImage","CloseAdDirectly",a):a&&!KD.isEmpty(a)&&t&&t.fireCustomEvents.call(t,"LoopImage","CloseAdOpenWindow",a)})}0==p?l.append($("<span rel='0' class='loop-icobox-dot active' id='"+this.baseId+"_LOOP-ICO"+p+"' istop='"+C+"' >0</span>")):l.append($("<span rel='"+p+"' class='loop-icobox-dot' id='"+this.baseId+"_LOOPICO"+p+"' istop='"+C+"' >"+p+"</span>"))}l.find(".loop-icobox-dot").hover(function(){V=!1,$(this).siblings(".loop-icobox-dot").removeClass("active"),$(this).addClass("active");var e=parseInt($(this).attr("rel"));t(e)},function(){V=!0});var F,T=r.children(".loop-imagebox")[0],_=r.children(".loop-icobox")[0],A=$(T).children("a"),L=$(_).children("span"),M=$(T).children().length,E=$(A).width(),B=E*M,R=parseInt($($(_).children(".active")[0]).attr("rel")),N=0,H=5e3,O=3e3,V=($($(_).children(".active")[0]).attr("istop"),!0);$(T).css({width:B+"px"}),A.children("img").off("error").on("error",function(){if("yes"!=$(this).attr("haderr")){var e=KD.getUrlSubRoot()+i.ImageLoadFailUrl;$(this).attr("src",e).attr("haderr","yes")}});var j=function(i,a){function n(e){return e&&null!==e?"true"==e.children("span.active").next("span").attr("istop")?!0:e.find("span").last().attr("id")===e.children("span.active").attr("id")&&"true"==e.find("span").first().attr("istop")?!0:!1:!1}var o=s.next(".loop-icobox");if(F=n(o)?KD.delayInvoke(j,14e3,!0):KD.delayInvoke(j,H,!0),e.length>1)V&&(i+1?N=i:(R=parseInt(L.closest(".active").attr("rel")),N=(R+1)%e.length),$(L[R]).removeClass("active"),$(L[N]).addClass("active"),s.find("a").eq(0).children(".kd-loop-closead").css({display:"none"}),t(N));else{var r=s.find("a").eq(0).attr("closeable");r&&KD.equalsIgnoreCase(r,"true")&&s.find("a").eq(0).children(".kd-loop-closead").css({display:"inline-block"})}};F="true"==s.next(".loop-icobox").find("span").first().attr("istop")?KD.delayInvoke(j,14e3,!0):KD.delayInvoke(j,H,!0),1==e.length&&l.hide()}else{var z=$(kendo.format("<div style='padding-top: 0px' class=\"chart-nodata\"><img id='{0}' src=\"{2}\"><p>{1}</p></div>",this.baseId+"_nodataImg",this.NodataText,this.NodataImageUrl));this.el.append(z)}},setImagesData:function(e){if(this.el.empty(),null!=e&&null!=e.items){var t=e.items,i=$('<div class="clearfix" style="height:500px;width:352px;" ></div>'),a=$('<div class="clearfix" ><a id="spec_n1" class="jqzoom" rel="gal1"><img data-img="1" width="350" height="350" /></a></div>'),n=$('<div id="spec_list" class="jqzoomthumbList" style="position:relative"><a href="javascript:;" class="spec-control" id="spec-forward"></a><a href="javascript:;" class="spec-control backward" id="spec-backward"></a></div>'),o=$('<div class="spec_items"></div>'),r=$('<ul id="thumblist" class="thumbullist" style=""></ul>');r.width(62*t.length>310?62*t.length:310);for(var s in t){var l=t[s],d=$("<li><a href='javascript:void(0);' class=\"zoomThumbNormal\" rel=\"{gallery:'gal1',smallimage:'"+l.images2+"',largeimage:'"+l.images3+'\'}"><img alt="'+l.title+'" src="'+l.images1+'" width="50" height="50"></a></li>');r.append(d),0==s&&(a.find("img").attr("src",l.images2),a.find("a").attr("title",l.title),a.find("a").attr("href",l.images3),d.addClass("zoomThumbActive"))}o.append(r),n.append(o),i.append(a),i.append(n),this.el.append(i),$(".jqzoom").jqzoom({zoomType:"standard",lens:!0,preloadImages:!1,alwaysOn:!1,zoomHeight:400,zoomWidth:400,title:!1,preloadText:ResManager.LoadKDString("图片加载中","0991733000003979")}),this.el.find("li>a").hover(function(e){$(this).click()});var c=this;this.el.find(".spec-control").click(function(){var e=$(this).hasClass("backward")?!1:!0,t=c.el.find(".thumbullist"),i=parseInt(t.css("left"));e?0>i&&t.animate({left:i+62>=0?0:i+62}):t.width()-310>-i&&t.animate({left:i-"62"})})}}}),KDControlFactoryProxy.registerType("kdpicturescroll",KDPictureScrollProxy),define("KDPictureScrollProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDPictureScrollProxy}}(this)),KDSchedulerDateNavigateProxy=KD.extend(KDControlProxy,{createControl:function(e){e.x=0,e.width=196,KDSchedulerProxy.superclass.createControl.call(this,e)},loadConfig:function(e){KDSchedulerProxy.superclass.loadConfig.call(this,e),this.RowCount=e.rowcount||1,this.ShowTodayButton=e.isshowtoday||!0,this.HighlightSpecialDates=e.ishighlightdates||!0,this.ShowWeekNumbers=e.isshowweek||!0,this.WeekNumberRule=e.weekrule||1,this.setSchedulerProxyKey(e.scproxyKey||"")},initComponent:function(){if(KD.IsNullOrWhiteSpace()){var e=this;(new Date).getFullYear();this.component=this.el.kendoCalendar({culture:"zh_CN",format:"yy-mm-dd",change:function(t,i){e.onSelect&&e.onSelect(this.value(),i)}}),this.component.addClass("KDSchedulerDataNavigate")}else;this.rendered=!0},onSelect:function(e,t){}}),$.extend(KDSchedulerDateNavigateProxy.prototype,{RowCount:0,HighlightSpecialDates:"",ShowTodayButton:!0,ShowWeekNumbers:!0,_weekrulenumber:1,setRowCount:function(e){this.RowCount=e},setHighlightSpecialDates:function(e){this.HighlightSpecialDates=e},setShowTodayButton:function(e){this.ShowTodayButton=e},setShowWeekNumbers:function(e){this.ShowWeekNumbers=e},setWeekNumberRule:function(e){},setSchedulerProxyKey:function(e){if(""!=e){this.el.empty();var t=this.getFormProxy(),i=t.getControlProxy(e),a=i.KDSchedulerDateNavigate;a.appendTo(this.el),a.css({display:"block"}),this.component=a}}}),KDControlFactoryProxy.registerType("kdschedulerdatenavigate",KDSchedulerDateNavigateProxy),define("KDSchedulerDateNavigateProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDSchedulerDateNavigateProxy}}(this)),KDBroadcastBoxProxy=KD.extend(KDControlProxy,{parent:null,partLinkFireCustomEvent:!1,isMultiMode:!1,datasource:[],formProxy:null,loadConfig:function(e){var t=this;t.config=e,t.Control=new Object,t.Control.Src=e.src||"",t.Control.Title=e.title||"",t.Control.ContentText=e.content||"",t.Control.LinkContent=e.linkcontent||"",t.ContentImgSrc=e.contentimg||"",KD.isUrl(t.ContentImgSrc)||""==t.ContentImgSrc||(t.ContentImgSrc=KD.getUrlRoot()+"/"+t.ContentImgSrc),t.Id=e.id||"",t.StackBroad=e.stackbroad||!1,t.StackBroadMillSeconds=e.stackbroadmillss||0,t.StackBroad&&KDBroadcastBoxProxy.LoadStackBroadcaseBoxs.push(t),t.Control.LinkUrl=e.linkurl||"",t.Control.CategoryTitle=e.categorytitle||"",this.Control.CategoryIsLink=e.categoryislink||!1,this.Control.CategoryLinkTag=e.categorylinktag||"";var i=e.minheight||0;i>0&&(t.Control.MinHeight=i);var a=e.minwidth||0;a>0&&(t.Control.MinWidth=a),t.Control.height=e.height||150,t.Control.width=e.width||300,t.Control.PartLinkFireCustomEvent=e.firelinkevent||!1,t.Control.UserBehaviorOpName=e.userbehavioropname||"",t.Control.CategoryNotPopAgainFun=e.categorynotpopagainfun||!1,t.AutoCloseInterval=KD.getValue(e,"autocloseinterval",0),t.Control.TargetPageId=KD.getValue(e,"targetpageid",""),KD.IsNullOrWhiteSpace(t.Control.TargetPageId)||(t.formProxy=ClientAppProxy.Current.getAliveForm(t.Control.TargetPageId)),t.Control.LinkTag=KD.getValue(e,"linktag",""),t.datasource.push({categorytitle:e.categorytitle||"",content:t.Control.ContentText,linkcontent:t.Control.LinkContent,linkurl:e.linkurl||"",title:t.Control.Title,categoryislink:t.Control.categoryislink,categorylinktag:t.Control.categorylinktag}),e.style&&2==e.style&&(t.Control.OtherItems=e.otheritems,t.isMultiMode=!0,t.datasource=t.datasource.concat(e.otheritems))},ShowBroadcastBox:function(e,t,a){a=a||!0;var n=t.items;if(null==n||0==n.Count){var o=new KDBroadcastBoxProxy;return o.Parent=e,o.loadConfig(t),a&&o.Navigate(),o}var r=0==KDBroadcastBoxProxy.LoadStackBroadcaseBoxs.length;r&&(r=null==KDBroadcastBoxProxy.LastOpenStackBroadcase);var s=null;for(i=0;i<n.length;i++){var l=n[i];if(null!=l){var o=new KDBroadcastBoxProxy;o.Parent=e,l.height=t.height||l.height||0,l.minheight=t.minheight||l.minheight||0,l.autocloseinterval=t.autocloseinterval||l.autocloseinterval||0,l.width=t.width||l.width||0,l.minwidth=t.minwidth||l.minwidth||0,o.loadConfig(l),a&&!o.getStackBroad()&&o.Navigate(),i==n.Count-1&&(s=o)}}return r&&KDBroadcastBoxProxy.NavgateStackBroadBox(),s},Navigate:function(){var e,t=this,i=KD.htmlUtil.encode(t.Control.ContentText).replace(/\r\n/g,"<br/>"),a=KD.htmlUtil.encode(t.Control.Title),n=t.getConfig(),o='<div style="z-index: 8002; position: fixed; bottom: 2px; right: 45px;height: '+this.Control.height+"px;width: "+this.Control.width+'px;background-color:white;border:1px solid #C3E3F8;border-radius:3px;box-shadow: 0 0 3px #C3E3E3;"><div style="background:#C3E3F8;height:25px;line-height:25px; padding-left:10px;" role="title"><span style="display: inline-block;overflow: hidden;height: 25px;width: 85%;font-weight: bold" title="'+a+'">'+a+'</span><a class="KDBroadcastBoxCloseButton" role="closeBox">&nbsp;</a></div><div style="padding: 20px 10px 0 10px;">'+i+'</div><a id="Part_Link" style="position: absolute;right: 16px;bottom: 12px;color: blue;text-decoration: underline;cursor: pointer;" onclick="javascript:void(0);">'+t.Control.LinkContent+"</a></div>",r=KD.getUrlRoot()+"/images/biz/default/Common/icon_next.png",s=KD.getUrlRoot()+"/images/biz/default/MainConsole/close.png",l=KD.getUrlRoot()+"/images/biz/default/MainConsole/closeHover.png",d=KD.IsNullOrWhiteSpace(t.Control.CategoryTitle)&&KD.IsNullOrWhiteSpace(t.Control.LinkContent),c='<span id="Part_CategoryLink" style="display: inline-block;'+(t.Control.CategoryIsLink?"cursor: pointer;color: #0C88DC;":"color:#797979;")+'overflow: hidden;font-size: 12px;margin-left:13px">'+t.Control.CategoryTitle+"</span>",h='<div style="z-index: 8002; position: fixed; bottom: 2px; right: 45px;height: inherit;height:190px;width:285px;background-color:white;border: 1px solid #e8e8e8;border-radius:3px;box-shadow: 0 0 3px #e5e5e5;"><div style="height:40px;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #e5e5e5;" role="title"><a style="float: left;position: relative;background-image: url('+t.ContentImgSrc+'); top:50%;margin-top: -12px;width: 20px;height: 20px;margin-left: 13px;margin-right: 10px;background-size: 100% 100%;" role="iconimg"></a><span style="display: inline-block;overflow: hidden;width: 77%;top:50%;position:relative;margin-top: -9px;font-size: 13px;text-overflow: ellipsis;white-space: nowrap;" title="'+a+'">'+a+'</span><a style="float:right;position:relative;background-image: url('+s+');padding:1px 6px;background-position:left;background-repeat: no-repeat;cursor: pointer;width:10px;height:10px;top:50%;margin-top:-15px;margin-right:10px;" role="closeBox"></a></div><div role="content" style="line-height: 24px;height:'+(d?115:100)+"px;font-size: 13px;overflow: hidden;margin: 10px 10px 10px 10px;text-overflow: ellipsis;display:-webkit-box;-webkit-line-clamp:"+(d?5:4)+';-webkit-box-orient:vertical;" title="'+i+'">'+i+"</div>"+(d?"":'<div style="vertical-align: bottom;height: 30px;">'+c+'<span id="Part_Link" style="color: #0C88DC;cursor: pointer;font-size: 12px;float: right;margin-right: 10px;">'+t.Control.LinkContent+'</span><a style="float: right;background-image: url('+r+");width: 10px;height: 10px;margin-right: 3px;background-size: 100% 100%;margin-top: 2px;"+(t.Control.LinkContent?"":"display:none;")+'" role="iconimg"></a></div>')+"</div>",u=$('<div class="NewsBroadBox" style="height: '+this.Control.height+"px; width: "+this.Control.width+'px;"><div class="categorytitle" role="title"><span id="newbroadcategory">'+t.Control.CategoryTitle+'</span><a class="KDBroadcastBoxCloseButton" role="closeBox">&nbsp;</a></div><div class="BroadContainer"><div class="newbroadtitle">'+a+'</div><div class="newbroadcontent">'+i+'</div><a class="newbroadlink" target="_blank" href="'+(t.Control.LinkUrl||"#")+'">'+t.Control.LinkContent+'</a><div class="newbroadbuttons"><span id="PART_PreButton"></span><span id="PART_NextButton"></span></div></div></div>');!n||3!=n.style&&"KDCloudNewStyle"!=n.stylekey?(e=$(o),t.Parent.append(t.isMultiMode?u:e)):(e=$(h),t.Parent.append(e),e.find('[role="closeBox"]').hover(function(){$(this).css("background-image","url("+l+")")},function(){$(this).css("background-image","url("+s+")")})),t.isMultiMode?(u.find(".KDBroadcastBoxCloseButton").click(function(){u.fadeOut("slow")}),u.fadeIn("slow"),u.find("#PART_PreButton").click(function(){var e=t.datasource.findIndex(function(e,t){return e.title==$(".newbroadtitle").text()&&e.content==$(".newbroadcontent").text()});if(0==e)return void $(this).addClass("disable");e<t.datasource.length-1&&$("#PART_NextButton").removeClass("disable"),$(this).removeClass("disable");var i=t.datasource[e-1];$("#newbroadcategory").text(i.categorytitle),$(".newbroadtitle").text(i.title),$(".newbroadcontent").text(i.content),$(".newbroadlink").text(i.linkcontent).attr("href",i.linkurl||"#")}),u.find("#PART_NextButton").click(function(){var e=t.datasource.findIndex(function(e,t){return e.title==$(".newbroadtitle").text()&&e.content==$(".newbroadcontent").text()});if(e==t.datasource.length-1)return void $(this).addClass("disable");e>0&&$("#PART_PreButton").removeClass("disable"),$(this).removeClass("disable");var i=t.datasource[e+1];$("#newbroadcategory").text(i.categorytitle),$(".newbroadtitle").text(i.title),$(".newbroadcontent").text(i.content),$(".newbroadlink").text(i.linkcontent).attr("href",i.linkurl||"#")})):(e.find(".KDBroadcastBoxCloseButton,[role='closeBox']").click(function(){if(t.formProxy){var i={};i.opkey=(t.getKey()||t.Id||"Part_CloseBtCk")+".PartCloseBtCk",i.opname=t.Control.UserBehaviorOpName+"_手动关闭",t.formProxy.fireCustomEventsNoData.call(t.formProxy,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(i))}e.fadeOut("slow"),t.getStackBroad()&&t.getStackBroadMillSeconds()>0&&(KDBroadcastBoxProxy.LastOpenStackBroadcase=null,KD.delayInvoke(KDBroadcastBoxProxy.NavgateStackBroadBox,t.getStackBroadMillSeconds()))}),t.Control.CategoryIsLink&&e.find("#Part_CategoryLink").click(function(){if(t.formProxy)if(t.Control.CategoryNotPopAgainFun&&t.Control.CategoryLinkTag)t.formProxy.fireCustomEventsNoData.call(t.formProxy,"Kingdee.BOS.BroadcaseBoxPopNotAgainLinkClick","Kingdee.BOS.BroadcaseBoxPopNotAgainLinkClick",t.Control.CategoryLinkTag);else{t.formProxy.fireCustomEventsNoData.call(t.formProxy,t.getKey()||t.Id||"Part_CategoryLink","Kingdee.BOS.BroadcaseBoxCategoryLinkClick",t.Control.CategoryLinkTag);var i={};i.opkey=(t.getKey()||t.Id||"Part_CategoryLink")+".PartCategoryBtCk",i.opname=t.Control.UserBehaviorOpName,t.formProxy.fireCustomEventsNoData.call(t.formProxy,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(i))}e.fadeOut("slow"),t.getStackBroad()&&t.getStackBroadMillSeconds()>0&&(KDBroadcastBoxProxy.LastOpenStackBroadcase=null,KD.delayInvoke(KDBroadcastBoxProxy.NavgateStackBroadBox,t.getStackBroadMillSeconds()))}),e.find("#Part_Link").click(function(){if(KD.IsNullOrWhiteSpace(t.Control.LinkUrl)||window.open(t.Control.LinkUrl,t.Control.LinkContent),t.Control.PartLinkFireCustomEvent&&null!=t.formProxy&&t.formProxy.fireCustomEvents(t.getKey()||t.Id||"Part_Link","ButtonClick",t.Control.LinkTag),t.formProxy){var i={};i.opkey=(t.getKey()||t.Id||"Part_Link")+".PartLinkBtCk",i.opname=t.Control.UserBehaviorOpName,t.formProxy.fireCustomEventsNoData.call(t.formProxy,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(i))}e.fadeOut("slow"),t.getStackBroad()&&t.getStackBroadMillSeconds()>0&&(KDBroadcastBoxProxy.LastOpenStackBroadcase=null,KD.delayInvoke(KDBroadcastBoxProxy.NavgateStackBroadBox,t.getStackBroadMillSeconds()))}),e.fadeIn("slow")),0!=t.AutoCloseInterval&&KD.delayInvoke(function(){if(t.formProxy){var i={};i.opkey=(t.getKey()||t.Id||"Part_AutoClose")+".PartAutoClose",i.opname=t.Control.UserBehaviorOpName+"_自动关闭",t.formProxy.fireCustomEventsNoData.call(t.formProxy,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(i))}t.isMultiMode?u.remove():e.remove(),t.getStackBroad()&&t.getStackBroadMillSeconds()>0&&(KDBroadcastBoxProxy.LastOpenStackBroadcase=null,KD.delayInvoke(KDBroadcastBoxProxy.NavgateStackBroadBox,t.getStackBroadMillSeconds()));
},t.AutoCloseInterval)},getStackBroad:function(){return this.config?this.config.stackbroad||!1:!1},getStackBroadMillSeconds:function(){return this.config?this.config.stackbroadmillss||0:0}}),KDBroadcastBoxProxy.LoadStackBroadcaseBoxs=[],KDBroadcastBoxProxy.LastOpenStackBroadcase=null,KDBroadcastBoxProxy.NavgateStackBroadBox=function(){var e=KDBroadcastBoxProxy.LoadStackBroadcaseBoxs;if(e.length>0){var t=e[0];t&&(t.Navigate.call(t),KDBroadcastBoxProxy.LastOpenStackBroadcase=t),KDBroadcastBoxProxy.LoadStackBroadcaseBoxs.splice(0,1)}},KDMesCenterTypeProxy=KD.extend(KDControlProxy,{parentControlKey:"",currentMessageIndex:0,messageDataSource:[],allowClose:!1,actionFormProxy:void 0,toastMsgId:0,audioControlProxy:void 0,audioControlProxyKey:void 0,contentClickTypeKey:"clickAction",setParentControlProxy:function(e,t){if(!this.parentControlProxy||e&&!KD.equalsIgnoreCase(this.parentControlKey,e)){this.parentControlKey=e;var i=this.actionFormProxy||this.getFormProxy();t=t||i.getControlProxy.call(i,e),this.parentControlProxy=t}},setActionFormProxy:function(e){this.actionFormProxy=e},setBtnMessageIsHighlightRemind:function(e){this.parentControlProxy&&this.parentControlProxy.setBtnMessageIsHighlightRemind&&this.parentControlProxy.setBtnMessageIsHighlightRemind.call(this.parentControlProxy,e)},doLayout:function(){KDMesCenterTypeProxy.superclass.doLayout.call(this);var e=this.getKendoControl();e&&e._resize&&e._resize({type:"resize"})},showToastMsg:function(e){var t=this;t.toastMsgId=t.toastMsgId+1;var i,a=this.getKendoControl();if(a?a.open():(this.loadConfig(this.config),a=this.getKendoControl(),a&&a.open()),this.component);else{this.component=$('<div class="kd-mescentertype-component"></div>'),this.el.addClass("kd-mescentertype-el").append(this.component);var n=$('<div class="kd-mescentertype-tips"></div><div class="kd-mescentertype-title-container"><div class="kd-mescentertype-title"></div><div class="kd-mescentertype-typle"></div><div class="kd-mescentertype-close"></div></div>');this.component.append(n);var o=$('<div class="kd-mescentertype-content-container"><div class="kd-mescentertype-content"></div></div>');this.component.append(o);var i=$('<div class="kd-mescentertype-operate-container kd-mescentertype-operate-container-page"><div class="kd-mescentertype-operate "></div><div class="kd-mescentertype-page-container"><div class="kd-mescentertype-page-btn kd-mescentertype-page-pre"></div><div class="kd-mescentertype-page"></div><div class="kd-mescentertype-page-btn kd-mescentertype-page-next"></div></div></div>');this.component.append(i),this.component.find(".kd-mescentertype-title-container .kd-mescentertype-close").on("click",function(e){var i=t._getMessageDataSourceIds();t._closePop.call(t,e,"closeclick",i)}),this.component.find(".kd-mescentertype-content-container .kd-mescentertype-content").on("click",function(e){var i=$(this);if(i.hasClass("kd-btn-link")){var a={};a.key=t.component.attr("messagekey");var n=t.component.attr("clickType");KD.isEmpty(n)||(a[t.contentClickTypeKey]=n),t.fireMesageContentClickAction.call(t,"countclick",a),t._closePop.call(t)}}),this.component.find(".kd-mescentertype-operate-container .kd-mescentertype-page-pre").on("click",function(e){t.currentMessageIndex=t.currentMessageIndex-1,t.showMessageByIndex.call(t,t.currentMessageIndex)}),this.component.find(".kd-mescentertype-operate-container .kd-mescentertype-page-next").on("click",function(e){t.currentMessageIndex=t.currentMessageIndex+1,t.showMessageByIndex.call(t,t.currentMessageIndex)}),i=this.component.find(".kd-mescentertype-operate-container .kd-mescentertype-operate"),i.on("click",function(e){t._closePop.call(t,e,"moreclick")})}var r=KD.isArray(e)?e[0]:e,s=parseFloat(r.autocloseinterval);s>0&&(t.timeOutId=setTimeout(function(e){t._closePop.call(t,e)},1e3*s,void 0),t.el.mouseover(function(e){clearTimeout(t.timeOutId),t.timeOutId=void 0}),t.el.mouseout(function(e){void 0==t.timeOutId&&(t.timeOutId=setTimeout(function(){t._closePop.call(t,e)},1e3*s))})),this.messageDataSource=r.msgItems||[],this.currentMessageIndex=0,this.showMessageByIndex.call(this,this.currentMessageIndex),i=i||this.component.find(".kd-mescentertype-operate-container .kd-mescentertype-operate");var l=r.moretitle;KD.isEmpty(l)?i.hide():(i.text(l),i.show())},showMessageByIndex:function(e){var t=this;e=parseInt(e),0>e&&(e=0),e>this.messageDataSource.length-1&&(e=this.messageDataSource.length-1);var i=this.messageDataSource[e]||{};this.component.attr({messagekey:i.key});var a=this.contentClickTypeKey,n=KD.getValue(i,a,"");this.component.attr({clickType:n}),KD.isEmpty(n)||KD.delayInvoke(function(e){t.doLayout.call(t)});var o=(this.component.find(".kd-mescentertype-title-container .kd-mescentertype-title").text(i.msgTitle),i.msgLevelContent),r=this.component.find(".kd-mescentertype-title-container .kd-mescentertype-typle");o?r.show().text(o).css({"border-color":i.msgLevelColor,color:i.msgLevelColor}):r.hide();var s=this.component.find(".kd-mescentertype-content-container .kd-mescentertype-content");s.text(i.content).attr({title:i.content});var l=i.callbackUrl;KD.isEmpty(l)?s.removeClass("kd-btn-link"):s.addClass("kd-btn-link");var d=this.component.find(".kd-mescentertype-operate-container.kd-mescentertype-operate-container-page"),c=this.component.find(".kd-mescentertype-operate-container .kd-mescentertype-page"),h=this.component.find(".kd-mescentertype-operate-container .kd-mescentertype-page-container");if(this.messageDataSource.length>1){h.show(),d.show();var u=e+1+" / "+this.messageDataSource.length;c.text(u)}else h.hide(),d.hide();this.currentMessageIndex=e},_getMessageDataSourceIds:function(){var e=[];if(this.messageDataSource)for(var t=0;t<this.messageDataSource.length;t++){var i=this.messageDataSource[t];e.push(i.key)}return e},_closePop:function(e,t,i){this.allowClose=!0;var a=this.getKendoControl.call(this);a&&a.close(),clearTimeout(this.timeOutId),this.timeOutId=void 0;var n={};n.isAnimate=!1,this.beginAnimateBtnMessageRing(n),t&&this.fireMesageContentClickAction.call(this,t,i)},beginAnimateBtnMessageRing:function(e){this.parentControlProxy&&this.parentControlProxy.beginAnimateBtnMessageRing&&this.parentControlProxy.beginAnimateBtnMessageRing.call(this.parentControlProxy,e)},fireMesageContentClickAction:function(e,t){var i=this.actionFormProxy||this.getFormProxy();if(i){var a=KD.isEmpty(t)?null:KD.stringify(t);"countclick"==e?i.fireCustomEventsNoData.call(i,KD.CONST.CustomEventName.KDMesconcentratorConteClick,KD.CONST.CustomEventName.KDMesconcentratorConteClick,a):"moreclick"==e?i.fireCustomEventsNoData.call(i,KD.CONST.CustomEventName.KDMesconcentratorMoreClick,KD.CONST.CustomEventName.KDMesconcentratorMoreClick,a):"closeclick"==e&&i.fireCustomEventsNoData.call(i,KD.CONST.CustomEventName.KDMesconcentratorCloseClick,KD.CONST.CustomEventName.KDMesconcentratorCloseClick,a)}},setMainConsolePlayAudio:function(e){this.audioControlProxy&&this.audioControlProxy.play&&this.audioControlProxy.play.call(this.audioControlProxy,e)},setAudioControlProxy:function(e,t){if(!this.audioControlProxy||e&&!KD.equalsIgnoreCase(this.audioControlProxyKey,e)){this.audioControlProxyKey=e;var i=this.actionFormProxy||this.getFormProxy();t=t||i.getControlProxy.call(i,e),this.audioControlProxy=t}},getKendoCType:function(){return"kendoPopup"},loadConfig:function(e){var t=this;KDMesCenterTypeProxy.superclass.loadConfig.call(this,e),this.setParentControlProxy(e.anchorControlId),this.parentControlProxy?this.el[this.getKendoCType()]({anchor:this.parentControlProxy.el,origin:"bottom right",position:"top right",close:function(e){t.allowClose||e.preventDefault(),t.allowClose=!1}}):this.el.hide()},getKendoControl:function(){var e;return this.el&&(e=this.el.data(this.getKendoCType())),e},initComponent:function(){KDMesCenterTypeProxy.superclass.initComponent.call(this)},createControl:function(e){KDMesCenterTypeProxy.superclass.createControl.call(this,e)}}),KDControlFactoryProxy.registerType("kdmescentertype",KDMesCenterTypeProxy),define("KDBroadcastBoxProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDBroadcastBoxProxy}}(this)),KDKendoNotificationProxy=KD.extend(KDControlProxy,{notificationWidth:null,notificationHeight:38,notificationType:{banner:2,kaiping:3,menuBar:4,card:5,textWindow:6},initComponent:function(){KDKendoNotificationProxy.superclass.initComponent.call(this)},loadConfig:function(e){KDRiskWarningNoticeProxy.superclass.loadConfig.call(this,e)},getKendoCType:function(){return"kendoNotification"},showToastMsg:function(e){this.data=[];var t=this.el.data("kendoNotification");t&&t.hide(),this.GenItems(e)},GenItems:function(e){if(!KD.isEmpty(e)){var t=this._getItemTemplate(),i=this;if(i.dataSource=e,i.msgData=e.msgItems,!KD.isArray(i.msgData))return;i.wrapper&&i.wrapper.remove(),this.index=0;var a=i.msgData[0];i.getMsgShowStyleClass(i.dataSource.msgStyle);var n=(this.el[this.getKendoCType()]({hideOnClick:!1,appendTo:i.getMsgContainer(i.dataSource.msgStyle,a.objectTypeId)||null,autoHideAfter:0,height:a.msgHeight||i.notificationHeight,width:a.msgWidth||i.notificationWidth,templates:t,position:{pinned:!0,top:20,left:0,bottom:null,right:null},show:function(e){i.wrapper=e.element;var t=i.getMsgShowStyleClass(i.dataSource.msgStyle);n&&n.options.appendTo?i.wrapper.addClass(t):(e.element.closest(".k-animation-container").addClass(t),i.wrapper=e.element.parent()),i.autoClosePop(n),i.wrapper.find(".kd-notification-btnclose").off("click").on("click",function(){i.wrapper.remove(),i.index++;var e=ClientAppProxy.Current.getMainConsoleForm();e=e||i.getFormProxy();var t=$(this).closest(".k-notification").find(".kd-notification-text").attr("messagekey");if(e){var a=t?KD.stringify([t]):null;e.fireCustomEvents.call(e,KD.CONST.CustomEventName.KDMesconcentratorCloseClick,KD.CONST.CustomEventName.KDMesconcentratorCloseClick,a)}return KD.isEmpty(i.msgData[i.index])?void(i.menuProxy&&i.menuProxy.sizeChange()):void(n&&i._showNotificationText(n,i.index))}),i.wrapper.find(".kd-notification-text").off("click").on("click",function(){var e=ClientAppProxy.Current.getMainConsoleForm();e=e||i.getFormProxy();var t={};if(t.key=$(this).attr("messagekey"),e&&e.fireCustomEventsNoData){var a=KD.isEmpty(t)?null:KD.stringify(t);e.fireCustomEventsNoData.call(e,KD.CONST.CustomEventName.KDMesconcentratorConteClick,KD.CONST.CustomEventName.KDMesconcentratorConteClick,a)}})},hide:function(e){n&&n.options.appendTo?i.wrapper=e.element:i.wrapper=e.element.parent(),i.wrapper.remove(),i.index++,!KD.isEmpty(i.msgData[i.index])&&n?i._showNotificationText(n,i.index):this.menuProxy&&this.menuProxy.sizeChange()}}),this.el.data("kendoNotification")),o=this.getMsgTemplate(a);n.show(this._formatShowMsgData(a),o),this.menuProxy&&this.menuProxy.sizeChange()}},_formatShowMsgData:function(e){var t={myMessage:"",title:"",weburl:"nullurl",background:""};return KD.isEmpty(e)?t:t={msgkey:e.key,myMessage:KD.htmlUtil.encode(e.content),title:KD.htmlUtil.encode(e.msgTitle)||"",weburl:e.callbackUrl||"nullurl",background:e.msgBackImage||"",forecolor:KD.getValue(e,"msgForeColor","#333333"),customizeUrlText:e.callbackUrlText||ResManager.LoadKDString("了解详情 ","00215181000007696"),footerButtonText:e.footerText||ResManager.LoadKDString("我知道了 ","014002000000970")}},_getItemTemplate:function(){var e=KD.getImageUrlByNameAndVersion("kd_icon_extend.png"),t=kendo.format("<div class='kd-notification-template-commonstyle kd-myWarning' title='{1}' ><span class='kd-notification-icon' style= 'background-image:url({0});'></span><span class='kd-notification-text' role='{2}' messagekey='{3}' style='color:{4};'>{1}</span><div class='kd-notification-btnclose'></div></div>",e,"#= myMessage #","#= weburl #","#= msgkey #","#= forecolor #"),i=kendo.format("<div class='kd-notification-template-commonstyle kd-myRemind'  title='{1}' ><span class='kd-notification-icon' style= 'background-image:url({0});'></span><span class='kd-notification-text' role='{2}' messagekey='{3}' style='color:{4};'>{1}</span><div class='kd-notification-btnclose'></div></div>",e,"#= myMessage #","#= weburl #","#= msgkey #","#= forecolor #"),a=kendo.format("<div class='kd-notification-template-commonstyle kd-myError'   title='{1}' ><span class='kd-notification-icon' style= 'background-image:url({0});'></span><span class='kd-notification-text' role='{2}' messagekey='{3}' style='color:{4};'>{1}</span><div class='kd-notification-btnclose'></div></div>",e,"#= myMessage #","#= weburl #","#= msgkey #","#= forecolor #"),n=kendo.format("<div class='kd-notification-text kd-notification-kaipingtemplate' style='background: url(data:image/png;base64,{0}) no-repeat center;background-size: 100% 100%;' messagekey='{1}' role='{2}'><div class='kd-cardtemplate-title'></div><div class='kd-cardtempalte-detail'></div><div class='kd-notification-btnclose'></div></div>","#= background #","#= msgkey #","#= weburl #"),o=kendo.format("<div class='kd-notification-textwindow-container'><div class='kd-notification-textwindow-title'><div title='{0}' class='kd-notification-titledetails'>{0}</div><div class='kd-notification-btnclose'></div></div><div class='kd-notification-textwindow-content'>{1}<span role='{2}' messagekey='{3}' class='kd-notification-text'>{4}</span></div><div class='kd-notification-textwindow-footer'><div class='kd-notification-btnclose'>{5}</div></div></div>","#= title #","#= myMessage #","#= weburl #","#= msgkey #","#= customizeUrlText #","#= footerButtonText #"),r=[{type:"warning",template:t},{type:"remind",template:i},{type:"error",template:a},{type:"kaiping",template:n},{type:"textwindow",template:o}];return r},_showNotificationText:function(e,t){if(!KD.isEmpty(e)&&!KD.isEmpty(e.options)){var i=this;i.msgData[t]&&(e.options.height=i.msgData[t].msgHeight||i.notificationHeight,e.options.width=i.msgData[t].msgWidth||i.notificationWidth,e.options.appendTo=i.getMsgContainer(i.dataSource.msgStyle,i.msgData[t].objectTypeId),e.show(i._formatShowMsgData(i.msgData[t]),i.getMsgTemplate(i.msgData[t])))}},autoClosePop:function(e){var t=this,i=KD.getValue(t.dataSource,"autocloseinterval",5);i>0&&e&&(clearTimeout(t.timeOutId),t.timeOutId=setTimeout(function(i){t.wrapper.remove(),t.index++,KD.isEmpty(t.msgData[t.index])?t.menuProxy&&t.menuProxy.sizeChange():t._showNotificationText.call(t,e,t.index)},1e3*i,void 0),t.wrapper.mouseover(function(e){clearTimeout(t.timeOutId),t.timeOutId=void 0}),t.wrapper.mouseout(function(a){void 0==t.timeOutId&&(t.timeOutId=setTimeout(function(){t.wrapper.remove(),t.index++,KD.isEmpty(t.msgData[t.index])?t.menuProxy&&t.menuProxy.sizeChange():t._showNotificationText.call(t,e,t.index)},1e3*i))}))},getMsgContainer:function(e,t){var i=this,a=null;if(4==e){var n=ClientAppProxy.Current.getMainTab(),o=ClientAppProxy.Current.getAliveForms(t||"");if(0==o.length?n&&n.lastShowObj&&(o=ClientAppProxy.Current.getAliveForm(n.lastShowObj.subFromId)):o=o[o.length-1],o&&o.mainMenu){i.menuProxy=o.mainMenu;var r=o.mainMenu.el;a=r&&r.children()[0]||null}}return a},getMsgTemplate:function(e){var t="remind";if(KD.isEmpty(e))return t;var i=e.msgLevel;switch(e.msgStyle){case this.notificationType.banner:case this.notificationType.menuBar:t=2==i?"warning":3==i?"error":"remind";break;case this.notificationType.kaiping:t="kaiping";break;case this.notificationType.textWindow:t="textwindow"}return t},getMsgShowStyleClass:function(e){var t="kd-notification-bannerstyle";switch(e){case this.notificationType.banner:t="kd-notification-bannerstyle";break;case this.notificationType.kaiping:t="kd-notification-kaipingstyle",this.notificationHeight=450,this.notificationWidth=600;break;case this.notificationType.menuBar:t="kd-menu-item-right kd-notification-menuBarstyle";break;case this.notificationType.textWindow:t="kd-notification-textwindow",this.notificationHeight=258}return t}}),KDControlFactoryProxy.registerType("kdnotification",KDKendoNotificationProxy),define("KDKendoNotificationProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDKendoNotificationProxy}}(this)),function(e){e.fn.KDChartControl=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDChartControl.prototype,e.fn.KDControlBase.defaults,e.fn.KDChartControl.defaults,t);this.fq=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i;e(this);return this.each(function(){var t=e(this);e.meta?e.extend(i,opts,t.data()):i})},e.fn.KDChartControl.prototype={getContent:function(){return this.fq},loadConfig:function(e){KD.setAttachmentData(this,e),KD.layout.setAbsolute(this,e)}},e.fn.KDChartControl.defaults={metaHtml:"",defaults:{}}}(jQuery),KDChartControlProxy=KD.extend(KDControlProxy,{cleartimer:null,onDelete:null,XTitle:null,YTitle:null,LabelsVisibility:!1,Style:"",StyleKey:"",ChartType:"line",DisplayIndex:0,AttachStore:null,SeriesPointsStore:null,DataKey:null,IsLoadData:!1,NoDataImg:null,CacheID:null,width:0,height:0,IsLoadCacheData:!0,IsLoadData:!1,XValueSubStrLen:0,barStack:!1,setXTitle:function(e){this.XTitle=e},getXTitle:function(e){return this.XTitle},setYTitle:function(e){this.YTitle=e},getYTitle:function(e){return this.XTitle},setStyle:function(e){switch(this.Style=e,e.toString()){case"1":this.setStyleKey("KDChartControlLineStyle");break;case"2":this.setStyleKey("KDChartControlPieStyle");break;case"3":this.setStyleKey("KDChartControlPillarStyle");break;case"4":this.setStyleKey("KDChartControlStackStyle");break;case"5":this.setStyleKey("KDChartControlBarStackedStyle"),this.barStack=!0;break;case"6":this.setStyleKey("KDChartControlSideBySideStackedStyle");break;case"7":this.setStyleKey("KDChartControlImageStyle");break;case"8":this.setStyleKey("KDChartControlConsoleImageStyle");break;case"9":this.setStyleKey("KDHRankingCustomChart");break;case"10":this.setStyleKey("KDVRankingCustomChart");break;case"11":this.setStyleKey("KDChartControlDonutStyle");break;default:this.StyleKey=""}},setStyleKey:function(e){switch(this.StyleKey=e,e){case"KDChartControlLineStyle":this.ChartType="line";break;case"KDChartControlPieStyle":this.ChartType="pie";break;case"KDChartControlDonutStyle":this.ChartType="donut";break;case"KDChartControlPillarStyle":this.ChartType="column";break;case"KDChartControlStackStyle":this.ChartType="area";break;case"KDChartControlBarStackedStyle":this.ChartType="column";break;case"KDChartControlSideBySideStackedStyle":this.ChartType="column";break;case"KDChartControlImageStyle":this.ChartType="column";break;case"KDChartControlConsoleImageStyle":this.ChartType="column";break;case"KDHRankingCustomChart":this.ChartType="polarScatter";break;case"KDVRankingCustomChart":this.ChartType="polarScatter";break;case"mscombi2d":this.ChartType="bar";break;default:this.ChartType="line"}},createControl:function(e){return this.setStyle(KD.getValue(e,"style",this.Style)),KDChartControlProxy.superclass.createControl.call(this,e),this.el=this.el.KDChartControl({}),this.el.attr("id",this.baseId),this.el.baseId=this.baseId,this.el},initComponent:function(){KDChartControlProxy.superclass.initComponent.call(this)},loadConfig:function(e){KDChartControlProxy.superclass.loadConfig.call(this,e),this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(this.config)),this.MaxCategoryCout=KD.getValue(e,"MaxCategoryCout",-1),this.width=KD.getValue(e,"width",0),this.height=KD.getValue(e,"height",0),this.IsLoadData=KD.getValue(e,"isloaddata",!1),this.CacheID=KD.getValue(e,"cacheid",this.CacheID),this.DataKey=KD.getValue(e,"datakey",this.DataKey),this.XTitle=KD.getValue(e,"xtitle",""),this.YTitle=KD.getValue(e,"ytitle",""),this.YTitleAlignment=KD.getValue(e,"ytitlealign",0),this.RefreshVisibility=KD.getValue(e,"refreshvisble",!0),this.LabelsVisibility=KD.getValue(e,"labelsvivible",!0),this.IsCardChart=KD.getValue(e,"isCardChart",!1),e.isCardChart&&(this.LabelsVisibility=!e.isCardChart),this.TickmarksLength=KD.getValue(e,"marklen",5),this.XTitleToolTip=KD.getValue(e,"xtitletooltip",""),this.RefreshToolTip=KD.getValue(e,"refreshtooltip",""),this.DisplayIndex=KD.getValue(e,"displayindex",0),this.NoDataImg=KD.getValue(e,"nodataimg",null),this.Bar2DModelName=KD.getValue(e,"bar2dmlname",""),this.Pie2DModelName=KD.getValue(e,"pie2dmlname",""),this.Marker2DModelName=KD.getValue(e,"marker2dmlname",""),this.IsDemo=KD.getValue(e,"isdemo",!1),this.AttachStore=KD.getValue(e,"attachstore",null),this.SeriesPointsStore=KD.getValue(e,"seriespointsstore",new Array),this.StyleKey=KD.getValue(e,"stylekey",this.StyleKey),this.customLabels=KD.getValue(e,"customLabels",null),this.setStyleKey(this.StyleKey);KD.getValue(e,"imagesource",null);this.XCrosshair=KD.getValue(e,"XCrosshair",!1),this.YCrosshair=KD.getValue(e,"YCrosshair",!0);KD.getValue(e,"linkurl",""),KD.getValue(e,"candelete",!1),KD.getValue(e,"imagecanclick",!1);this.el.css({overflow:"hidden",position:"relative",height:"inherit"}),this.updateChartState(this.config),this.asynSeiersPoint=KD.getValue(e,"asynSeiersPoint",!1),this.asynSeiersPoint&&this.getFormProxy().fireCustomEvents(this.key,"asynSeiersPoint")},CallServer:function(e){this.getFormProxy().fireCustomEvents(this.DataKey,e,this.CacheID)},updateChartState:function(e){$.extend(this.config,e),this.setStyle(KD.getValue(e,"style",this.Style)),this.width=KD.getValue(e,"width",this.width),this.height=KD.getValue(e,"height",this.height),this.DataKey=KD.getValue(e,"datakey",this.DataKey),this.IsLoadData=KD.getValue(e,"isloaddata",this.IsLoadData),this.CacheID=KD.getValue(e,"cacheid",this.CacheID),this.NoDataImg=KD.getValue(e,"nodataimg",this.NoDataImg),this.Disabled=KD.getValue(e,"disabled",this.Disabled),this.Visible=KD.getValue(e,"visible",this.Visible),this.ToolTip=KD.getValue(e,"tooltip",this.ToolTip),this.setStyle(KD.getValue(e,"style",this.Style)),this.XTitle=KD.getValue(e,"xtitle",this.XTitle),this.YTitle=KD.getValue(e,"ytitle",this.YTitle),this.YTitleAlignment=KD.getValue(e,"ytitlealign",0),this.DisplayIndex=KD.getValue(e,"displayindex",this.DisplayIndex),this.RefreshVisibility=KD.getValue(e,"refreshvisble",!0),this.LabelsVisibility=KD.getValue(e,"labelsvivible",!1),this.IsCardChart=KD.getValue(e,"isCardChart",!1),e.isCardChart&&(this.LabelsVisibility=!e.isCardChart),this.XTitleToolTip=KD.getValue(e,"xtitletooltip",""),this.RefreshToolTip=KD.getValue(e,"refreshtooltip",""),this.TickmarksLength=KD.getValue(e,"marklen",5),this.Bar2DModelName=KD.getValue(e,"bar2dmlname",""),this.Pie2DModelName=KD.getValue(e,"pie2dmlname",""),this.Marker2DModelName=KD.getValue(e,"marker2dmlname",""),this.IsDemo=KD.getValue(e,"isdemo",this.IsDemo),this.AttachStore=KD.getValue(e,"attachstore",this.AttachStore),this.customLabels=KD.getValue(e,"customLabels",null);KD.getValue(e,"imagesource",null);this.XCrosshair=KD.getValue(e,"XCrosshair",!1),this.YCrosshair=KD.getValue(e,"YCrosshair",!0);KD.getValue(e,"linkurl",""),KD.getValue(e,"candelete",!1),KD.getValue(e,"imagecanclick",!1);this.updateChartSeiersPoint(KD.getValue(e,"seriespointsstore",this.SeriesPointsStore))},LoadChartCache:function(e){var t=KD.getValue(e,"cacheid",this.CacheID);t!=this.CacheID?this.IsLoadCacheData=!1:(this.IsLoadCacheData=!0,this.NoDataImg=KD.getValue(e,"nodataimg",this.NoDataImg),this.Disabled=KD.getValue(e,"disabled",this.Disabled),this.Visible=KD.getValue(e,"visible",this.Visible),this.ToolTip=KD.getValue(e,"tooltip",this.ToolTip),this.Style=KD.getValue(e,"style",this.Style),this.XTitle=KD.getValue(e,"xtitle",this.XTitle),this.YTitle=KD.getValue(e,"ytitle",this.YTitle),this.YTitleAlignment=KD.getValue(e,"ytitlealign",0),this.RefreshVisibility=KD.getValue(e,"refreshvisble",!0),this.LabelsVisibility=KD.getValue(e,"labelsvivible",!1),this.IsCardChart=KD.getValue(e,"isCardChart",!1),e.isCardChart&&(this.LabelsVisibility=!e.isCardChart),this.TickmarksLength=KD.getValue(e,"marklen",5),this.XTitleToolTip=KD.getValue(e,"xtitletooltip",""),this.RefreshToolTip=KD.getValue(e,"refreshtooltip",""),this.Bar2DModelName=KD.getValue(e,"bar2dmlname",""),this.Pie2DModelName=KD.getValue(e,"pie2dmlname",""),this.Marker2DModelName=KD.getValue(e,"marker2dmlname",""),this.customLabels=KD.getValue(e,"customLabels",null),this.SeriesPointsStore=KD.getValue(e,"seriespointsstore",this.SeriesPointsStore),this.XCrosshair=KD.getValue(e,"XCrosshair",!1),this.YCrosshair=KD.getValue(e,"YCrosshair",!0))},CreateToCacheData:function(){var e=new{};return e.datakey=this.DataKey,e.cacheid=this.CacheID,e.disabled=this.Disabled,e.visible=this.Visible,e.tooltip=this.ToolTip,e.style=this.Style,e.xtitle=this.XTitle,e.ytitle=this.YTitle,e.ytitlealign=this.YTitleAlignment,e.displayindex=this.DisplayIndex,e.seriespointsstore=this.SeriesPointsStore,e.nodataimg=this.noDataImgSoureUrl,e.refreshvisble=this.RefreshVisibility,e.labelsvivible=this.LabelsVisibility,e.marklen=this.TickmarksLength,e.xtitletooltip=this.XTitleToolTip,e.refreshtooltip=this.RefreshToolTip,e.bar2dmlname=this.Bar2DModelName,e.pie2dmlname=this.Pie2DModelName,e.marker2dmlname=this.Marker2DModelName,e.customLabels=this.customLabels,e},setEmptyData:function(e){this.el&&this.el.html('<div style="left: 20%;position: relative;display: inline-block;padding-top: 30px;">'+e+"</div>")},getBlocking:function(){return this.blocking||(this.blocking=new KD.blocking),this.blocking},setIsWaitting:function(e){this.isWaitting=e,e?this.getBlocking().show():this.getBlocking().hide()},getPieDataSet:function(e){if(e.length<=0||"pie"!=this.ChartType)return e;for(var t=0;t<e.length;t++){for(var i=0,a=e[t],n=0;n<a.data.length;n++){var o=a.data[n];i+=parseFloat(o.value)}for(var n=0;n<a.data.length;n++){var o=a.data[n];o.pieValue=(o.value/i*100).toFixed(2)}}return e},UnitsPercent:.4,YUnitsTitle:"",formatYaxisValue:function(e,t){if(this.IsTenThoundUnits=!1,this.IstenMillionUnits=!1,!(null==e||void 0==e||e.length<=0)){for(var i=0,a=0,n=0,o=0;o<e.length;o++)for(var r=e[o],s=r.points,l=0;l<s.length;l++){var d=s[l];i++;var c=d.yvalue;d.yvalue_tenthousand=1*c/1e4,c>1e3&&a++,c>1e7&&n++,d.yvalue_tenmillion=1*c/1e7}this.IsTenThoundUnits=1*a/i>=this.UnitsPercent,this.IstenMillionUnits=1*n/i>=this.UnitsPercent,this.IsTenThoundUnits&&this.IstenMillionUnits&&(this.IsTenThoundUnits=!1),this.IsCardChart||"pie"!=this.ChartType||(this.IsTenThoundUnits=!1,this.IstenMillionUnits=!1),this.YUnitsTitle="",this.YTitle=(this.YTitle||"").replace(ResManager.LoadKDString("(千万)","0991733000006730"),"").replace(ResManager.LoadKDString("(万)","0991733000006731"),""),this.IstenMillionUnits?(this.YTitle+=ResManager.LoadKDString("(千万)","0991733000006730"),this.YUnitsTitle=ResManager.LoadKDString("千万","0991733000006732")):this.IsTenThoundUnits&&(this.YTitle+=ResManager.LoadKDString("(万)","0991733000006731"),this.YUnitsTitle=ResManager.LoadKDString("万","0991733000006733"))}},getKDChart:function(){var e=$("#"+this.baseId+"_chartEL").data("kendoChart");return e},setLegendPosition:function(e){if(!KD.isEmpty(e)){var t=this.getKDChart(),i=t&&t.options;if(KD.isObject(e))for(var a in e){var e=e[a];KD.equalsIgnoreCase(a,"template")&&i&&(i.legend.labels.template=e),KD.equalsIgnoreCase(e,"position")&&i&&(i.legend.position=e)}else this.legendPosition=e,t&&i&&(i.legend.position=e);t&&t.setOptions(i)}},dealCategories:function(e){if(null!=this.customLabels)for(var t=0,i=0;i<e.length;i++){var a=e[i];this.customLabels[t]&&this.customLabels[t].xvalue==a?t++:e[i]=""}return e},getChartOptions:function(e,t){var i=this;e=this.dealCategories(e),t=i.getPieDataSet(t);var a=this.width>0?this.width:KD.layout.getActualWidth(this.el),n=this.height>0?this.height:KD.layout.getActualHeight(this.el),o="#: value==undefined #";(void 0==e||0==e.length)&&(o="#: 0 #");var r={renderAs:"svg",categoryAxis:{majorGridLines:{visible:!1},labels:{rotation:e.length>10?45:0,align:"center",visual:function(e){var t=new kendo.geometry.Rect(e.rect.origin,[e.rect.size.width,100]),a=new kendo.drawing.Layout(t,{orientation:"vertical",alignContent:"center",alignItems:"center"}),n=e.text||"";if(i.controlFactoryProxy.controls.BILLCONTROLS&&"BOS_H5ChartFormReport"==i.controlFactoryProxy.controls.BILLCONTROLS.formId){var o=6,r=0,s=0;for(r=0;r<n.length&&(o-=n.charCodeAt(r)>128?2:1,!(0>=o));r++);for(o=6,s=r;s<n.length&&(o-=n.charCodeAt(s)>128?2:1,!(0>=o));s++);a.append(new kendo.drawing.Text(n.slice(0,r))),a.append(new kendo.drawing.Text(s<n.length?n.slice(r,s)+"...":n.slice(r,s)))}else{if(i.config.isCardChart&&"pie"!=i.ChartType&&n&&n.length){var l=-1,d=0;switch(i.IstenMillionUnits?d=3:i.IsTenThoundUnits&&(d=2),!0){case i.currCategoryCout>=5&&n.length>5-d:l=5-d;break;case i.currCategoryCout>=4&&n.length>6-d:l=6-d;break;case i.currCategoryCout>=3&&n.length>7-d:l=7-d;break;case i.currCategoryCout>=2&&n.length>8-d:l=8-d;break;case i.currCategoryCout>=1&&n.length>9-d:l=9-d;break;case i.currCategoryCout>=0&&n.length>10-d:l=10-d}if(~l){d>0&&(l+=1);var c=n.substring(0,l).replace(/[^\x00-\xff]/g,"rr").length-n.substring(0,l).length;n=0===c?n.substring(0,l)+"..":l-2>c?n.substring(0,l-1)+"..":n.substring(0,l-2)+".."}}i.XValueSubStrLen>0&&"column"==i.ChartType&&n.length>i.XValueSubStrLen&&(n=n.substring(0,i.XValueSubStrLen)+"..");var h=new kendo.drawing.Text(n);i.cateAxisLabelsRotation&&h.transform(kendo.geometry.transform().rotate(i.cateAxisLabelsRotation,[e.rect.size.width/2,50])),a.append(h)}return a.reflow(),a}},crosshair:{tooltip:{template:o,visible:this.XCrosshair?!1:!0},visible:this.XCrosshair?!0:!1},title:{text:this.XTitle,rotation:0,position:"center"},line:{visible:!0,color:"#E8E8E8"},categories:e},legend:{position:this.legendPosition?this.legendPosition:"right",visible:!0},axisDefaults:{majorGridLines:{dashType:"dash",color:"#E2E2E2"},title:{rotation:this.YTitle.length>=8?270:0,text:this.YTitle,position:"top",font:"12px Microsoft YaHei"},crosshair:{tooltip:{template:"#: value.toFixed(2) #",visible:!1},visible:this.YCrosshair?!0:!1},line:{visible:!1},labels:{font:"12px Microsoft YaHei"}},series:t,seriesDefaults:{labels:{visible:this.customLabels?!1:"donut"==i.ChartType?!1:this.LabelsVisibility,background:"transparent",font:"12px Microsoft YaHei",template:this.IsCardChart||"pie"!=this.ChartType?"#= value#":"#:category # : #= kendo.format('{0:P}', percentage) #",position:"pie"==i.ChartType?"insideEnd":"outsideEnd",margin:{bottom:10,right:0,left:"area"==i.ChartType?-20:0}},overlay:{gradient:"none"},border:{width:0}},render:function(e){e.sender.surface.bind("click",function(e){i.onShapeClick.call(i,e)})},axisLabelClick:function(e){i.writeLog("axisLabelClick   "+e.axis.type,e.value)},legendItemClick:function(e){i.writeLog("legendItemClick   ")},noteClick:function(e){i.writeLog("noteClick   "+e)},plotAreaClick:function(e){i.writeLog("plotAreaClick   "+e)},seriesClick:function(e){i.writeLog("seriesClick   "+e)},seriesHover:function(e){i.writeLog("seriesHover   "+e)},chartArea:{height:n,width:a},tooltip:{visible:!0,format:"{0}",shared:!1,template:"pie"==i.ChartType?"#:category # : #= kendo.format('{0:P}', percentage) #":"#:series.name #   #:category # : #: value #"+i.YUnitsTitle}};return this.valueAxes&&(r.valueAxes=this.valueAxes),this.categoryAxisCrossingValues&&(r.categoryAxis.axisCrossingValues=this.categoryAxisCrossingValues),this.cateAxisLabelsRotation&&(r.categoryAxis.labels.rotation=this.cateAxisLabelsRotation),this.valueAxisLabelsTemplate&&(r.valueAxis?r.valueAxis.labels.template=this.valueAxisLabelsTemplate:r.valueAxis={labels:{template:this.valueAxisLabelsTemplate,font:"12px Microsoft YaHei"}}),this.tooltipTemplate&&(r.tooltip.template=this.tooltipTemplate),this.valueAxisMajorUnit&&(r.valueAxis?r.valueAxis.majorUnit=this.valueAxisMajorUnit:r.valueAxis={majorUnit:this.valueAxisMajorUnit}),this.axisShared&&(r.tooltip.shared=this.axisShared),this.barStack&&(r.seriesDefaults.stack=this.barStack),r},setCustomLabels:function(e){this.customLabels=KD.isArray(e)?e:null},setAxisShared:function(e){this.axisShared=e?!0:!1},setValueAxes:function(e){try{this.valueAxes=KD.parseObject(e)}catch(t){this.valueAxes=null}},setCategoryAxisCrossingValues:function(e){try{this.categoryAxisCrossingValues=KD.parseObject(e)}catch(t){this.categoryAxisCrossingValues=null}},setCateAxisLabelsRotation:function(e){try{this.cateAxisLabelsRotation=KD.parseObject(e)}catch(t){this.cateAxisLabelsRotation=null;
}},setXValueSubStrLen:function(e){try{this.XValueSubStrLen=parseInt(e)}catch(t){this.XValueSubStrLen=0}},setValueAxisLabelsTemplate:function(e){this.valueAxisLabelsTemplate=e},setTooltipTemplate:function(e){this.tooltipTemplate=e},setValueAxisMajorUnit:function(e){this.valueAxisMajorUnit=e},onShapeClick:function(e,t){var i=e.originalEvent.target.textContent;this.XTitle&&i===this.XTitle&&this.getFormProxy().fireCustomEvents(this.DataKey,"ChartXTileClick",this.CacheID)},writeLog:function(e){console&&console.log&&console.log(e)},updateSeriersPoints:function(e){this.updateChartSeiersPoint(e)},setSeriesPointsStore:function(e){this.updateSeriersPoints(e)},setNodataChartTipsContent:function(e){this.NodataChartTipsContent=e;var t=this.el.find(".chart-nodata").find("p"),i=e&&e.text;t&&t.length>0&!KD.isEmpty(i)&&t.text(i)},setNodataChartTips:function(){var e=this.getFormId(),t=this.NodataChartTipsContent&&this.NodataChartTipsContent.image,i=this.NodataChartTipsContent&&this.NodataChartTipsContent.text,a="LIVE_PCCard"===e?"../images/biz/default/MainConsole/H5CardLayout/icon_task_NoData.png":"../images/biz/default/MainConsole/H5CardLayout/Nodata.png",n=$(kendo.format("<div class='chart-nodata'><img id='{0}' src='"+(t?t:a)+"' onerror='this.onerror=null;this.src=\""+a+"\"'><p>{1}</p></div>",this.baseId+"_nodataImg",i?i:ResManager.LoadKDString("暂无数据","0991733000006734")));this.el.append(n)},updateChartSeiersPoint:function(e){var t=this;if(t.currCategoryCout=0,t.formatYaxisValue(e,!0),this.SeriesPointsStore=e,this.el&&this.el.empty(),!e||0===e.length)return void this.setNodataChartTips.call(this);var i=-1,a=-1,n=0;for(var o in e){var r=e[o];for(var s in r.points)a++,0===r.points[s].yvalue&&i++,n<r.points[s].yvalue&&(n=r.points[s].yvalue)}if(t.controlFactoryProxy.controls.BILLCONTROLS&&"BOS_H5ChartFormReport"==t.controlFactoryProxy.controls.BILLCONTROLS.formId&&(this.IsTenThoundUnits&&(n/=1e4),this.IstenMillionUnits&&(n/=1e7),this.setValueAxisMajorUnit(1>n/3?1:Math.ceil(n/3))),i==a&&(!t.controlFactoryProxy.controls.BILLCONTROLS||"BOS_H5MyWorkChart"!=t.controlFactoryProxy.controls.BILLCONTROLS.formId))return void this.setNodataChartTips.call(this);var l=(this.XTitle?this.XTitle+"--"+this.YTitle+"<Br>"+ResManager.LoadKDString("没可用数据！","0991733000003964"):ResManager.LoadKDString("没可用数据！","0991733000003964"),[]),d=[];for(var o in e){var r=e[o],c=this.LoadSeriesPoints(r);d.push(c);for(var h in c){var u=c[h].Argument,p=!1;for(var g in l)if(l[g]==u){p=!0;break}0==p&&(-1==this.MaxCategoryCout||this.MaxCategoryCout>=l.length)&&(l.push(u),t.currCategoryCout++)}}var f=[];for(var o in e){var r=e[o],m=this.AddSeriesPoints(l,d[o],r,"KDChartControlPieStyle"==this.StyleKey?!0:!1);f.push(m)}var v=this.getChartOptions(l,f),y=$(kendo.format("<div id='{0}'></div>",this.baseId+"_chartEL"));this.el.append(y),y.kendoChart(v),this.setIsWaitting(!1)},oncleartimer:function(){clearInterval(this.cleartimer),this.cleartimer=null},AddSeriesPoints:function(e,t,i,a){var n={},o=[];for(var r in e){var s={};s.value="0",a&&1==a&&(s.label=e[r]);for(var l in t)if(null!=this.customLabels&&e[r]==t[l].ArgumentValue||null==this.customLabels&&e[r]==t[l].Argument){var d=t[l].yvalue;s.yvalue=d,s.value=d,this.IstenMillionUnits?s.value=t[l].yvalue_tenmillion.toFixed(4):this.IsTenThoundUnits&&(s.value=t[l].yvalue_tenthousand.toFixed(4)),s.xvalue=t[l].xvalue,s.target=50,KD.isEmpty(t[l].brush)||(s.color=t[l].brush),s.category=e[r];break}o.push(s)}n.data=o,n.field="value";var c=KD.getValue(i,"brush","");if(KD.isEmpty(c)||(n.color=c),n.type=i.type?i.type:this.ChartType,"donut"==this.ChartType){var h={};h.gradient="none",n.overlay=h}i.axis&&(n.axis=i.axis),i.serieLine&&(n.line=i.serieLine),n.tooltip={visible:this.IsCardChart||"pie"!=this.ChartType?!0:!1},n.markers={visible:this.customLabels?!1:!0,background:"white",size:6};var u=KD.getValue(i,"displayname","");n.name=u,""==u&&(n.name=KD.getValue(i,"name",""));var p=KD.getValue(i,"renderAs","");return""!=p&&(n.renderAs=p),n},GetDouble:function(e,t){if(void 0!=e&&null!=e){var i=e[t];if(null!=i&&void 0!=i&&""!=i.toString()){var a=Number(i);if(NaN!=a)return a}}},GetDate:function(e,t){if(void 0!=e&&null!=e){var i=e[t];if(null!=i&&void 0!=i&&""!=i){var a=Date(i);if(NaN!=a)return a}}},LoadSeriesPoints:function(e){var t=[],i=KD.getValue(e,"points",new Array);for(var a in i){var n,o,r,s=i[a];if(o=this.GetDouble(s,"yvalue"),void 0!=o){n=this.GetDouble(s,"xvalue"),r=this.GetDate(s,"xvalue");var l={};if(l.yvalue_tenmillion=this.GetDouble(s,"yvalue_tenmillion"),l.yvalue_tenthousand=this.GetDouble(s,"yvalue_tenthousand"),l.xvalue=n,l.yvalue=o,l.brush=KD.getValue(s,"brush",""),void 0==n||isNaN(n))if(void 0!=r){var d=KD.getValue(s,"xtext","");l.Argument=d,l.ArgumentValue=KD.getValue(s,"xvalue",""),t.push(l)}else{var d=KD.getValue(s,"xtext","");""==d&&(d=KD.getValue(s,"xvalue","")),l.Argument=d,l.ArgumentValue=KD.getValue(s,"xvalue",""),t.push(l)}else l.Argument=KD.getValue(s,"xtext",n.toString()),l.ArgumentValue=n,t.push(l)}}return t},release:function(){try{delete this.blocking,FusionCharts(this.baseId).dispose()}catch(e){}},setLabelsvisible:function(e){this.LabelsVisibility=e}}),KDControlFactoryProxy.registerType("kdchart",KDChartControlProxy),define("KDChartControlProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDChartControlProxy}}(this)),function(e){e.fn.KDChartContainer=function(t){var i=e.extend(this,e.fn.KDControlBase.prototype,e.fn.KDChartContainer.prototype,e.fn.KDControlBase.defaults,e.fn.KDChartContainer.defaults,t);return this.fq=""!=this.getMetaHtml()?e(this.getMetaHtml()).appendTo(i):i,$this=e(this),this.each(function(){$this=e(this);e.meta?e.extend(i,opts,$this.data()):i})},e.fn.KDChartContainer.prototype={getContent:function(){return this.fq},loadConfig:function(e){KD.setAttachmentData(this,e),KD.layout.setAbsolute(this,e),$this=this}},e.fn.KDChartContainer.defaults={metaHtml:"",defaults:{}}}(jQuery),KDChartContainerProxy=KD.extend(KDControlProxy,{player:null,charts:[],ChartStates:[],width:0,height:0,isStopAnimateWhenHover:!0,createControl:function(e){return KDChartContainerProxy.superclass.createControl.call(this,e),this.el=this.el.KDChartContainer({}),this.el.attr("id",this.baseId),this.el.baseId=this.baseId,this.el},initComponent:function(){KDChartContainerProxy.superclass.initComponent.call(this)},loadConfig:function(e){KDChartContainerProxy.superclass.loadConfig.call(this,e),this.el.loadConfig&&(this.el.proxy=this,this.el.loadConfig(this.config)),this.width=KD.getValue(e,"width",0),this.height=KD.getValue(e,"height",0),this.isStopAnimateWhenHover=KD.getValue(e,"isstopanimatewhenhover",!0),5==KD.getValue(e,"dock",0)?(this.el.css("width","100%"),this.el.css("height","100%")):this.width>0&&this.width<60?this.el.css("width","60px"):this.width>0&&this.el.css("width",this.width+"px"),this.OpenCache=KD.getValue(e,"opencache",!1),this.setStartDisplayIndex(),this.setStartDisplayIndex(KD.getValue(e,"startdisplayIndex",0));var t=KD.getValue(e,"charts",new Array);this.AddCharts(t),this.OpenCache&&this.LoadCacheConfig(),this.el.css({overflow:"hidden",position:"relative"})},attachOnlineImages:function(e){var t=e.configurl;if(""!=t){t+=-1!=t.indexOf("?")?"&xxx="+this.getBaseId():"?xxx="+this.getBaseId();e.cachekey;forceshowwhenhasimg=KD.getValue(e,"forceshowwhenhasimg",!1)}},addImages:function(e){var t=this;this.el.css("width","inherit");var i=this.getBaseId(),a="<div class='picAddContainer'>",n=this.el&&this.el.width(),o=this.el&&this.el.height(),r=n&&n>0?"width:"+n+"px;":"",s=o&&o>0?"height:"+o+"px;":"",l="",d="";for(var c in e){var h=Number(c)+1,u=e[c].linkurl?'href="'+e[c].linkurl+'"':"";a+='<a id="piclink'+i+h+'" '+u+' target="_blank" title="'+e[c].xtitle+'" attach-id="'+e[c].id+'" attach-key="'+e[c].key+'" style="'+r+s+'"><img id="picitem'+i+h+'" class="picAddImgItem" style="z-index:'+h+";"+e[c].cssforh5+';"  src="'+t._getImgUrl(e[c].imagesource)+'" /></a>',l+='<span id="picbtn'+i+h+'" class="picAddBtnItem '+i+'btnItem">'+h+"</span>",d+='<span id="picTitle'+i+h+'" style="display: inline-block;" class="'+i+'titleItem">'+e[c].xtitle+"</span>"}a+="</div>",a+='<div class="picAddBtnContainer" style="bottom:5px;"><div class="picAddBtnPanel" style="margin-top:10px;font-size:1.3em;">',"CP"!=KD.getEntryRole().toUpperCase()&&(a+=d),a+='</div><div class="picAddBtnPanel" style="text-align: right;">',a+=l,a+="</div></div>",this.el.append(a);var p=$("a",this.el);p.length>0&&p.click(function(){var e=t.getFormProxy();t.getSync()?e.fireSyncCustomEvents.call(e,t.getKey(),"AdImgItemClick",JSON.stringify({id:$(this).attr("attach-id"),key:$(this).attr("attach-key")})):e.fireCustomEvents.call(e,t.getKey(),"AdImgItemClick",JSON.stringify({id:$(this).attr("attach-id"),key:$(this).attr("attach-key")}))}),p.length>0&&p.unbind("mouseover").bind("mouseover",function(e){t.isStopAnimateWhenHover=!1}),p.length>0&&p.unbind("mouseout").bind("mouseout",function(e){t.isStopAnimateWhenHover=!0}),$("#picbtn"+i+"1").css("background-color","#FFA500"),$("#picbtn"+i+"1").css("color","white"),$("#picbtn"+i+"1").attr("isSelect",1),$("."+i+"titleItem").hide("fast"),$("#picTitle"+i+"1").show("fast"),$("#picTitle"+i+"1").css("margin-right",(this.el.width()-$("#picTitle"+i+"1").width())/2+"px"),$(".picAddBtnItem").bind("click",function(e){var t=$("."+i+"btnItem[isSelect=1]"),a=$("#piclink"+i+e.target.innerText),n=$("#picitem"+i+e.target.innerText),o=$("#picbtn"+i+s),r=$("#picbtn"+i+e.target.innerText);if(0==t.length||e.target.innerText!=t.text()){var s=0==t.length?0:t.text();$("#picitem"+i+s).hide(),n.fadeIn("fast"),n.css({opacity:"1"}),a.css({opacity:"1"}),a.siblings().hide(),a.fadeIn("fast"),o.css({"background-color":"#D3D3D3",color:"black"}),o.attr("isSelect",0),$("#picTitle"+i+s).hide("fast"),r.css({"background-color":"#FFA500",color:"white"}),r.attr("isSelect",1),$("#picTitle"+i+e.target.innerText).show("fast")}});var g=this.setPicState;t.player=KD.setInterval(function(){g(i,t)},4e3,"KDChartContainerProxy.addImages()")},_getImgUrl:function(e){var t="data:image/jpeg;base64,";return 0==e.indexOf("/")||0==e.toUpperCase().indexOf("WWW")||0==e.toUpperCase().indexOf("HTTP")?t=e:t+=e,t},setPicState:function(e,t){if(!t||KD.isEmpty(t.isStopAnimateWhenHover)||t.isStopAnimateWhenHover){var i=$("."+e+"btnItem[isSelect=1]"),a=$("."+e+"titleItem");0==i.length&&(i=$("#picbtn"+e+"1"));var n=i.text();$("#piclink"+e+n).hide(),i.attr("isSelect",0),a.hide("fast"),i.css({"background-color":"#D3D3D3",color:"black"}),0!=$("#picitem"+e+(Number(n)+1)).length?($("#picitem"+e+(Number(n)+1)).fadeIn("fast"),$("#piclink"+e+(Number(n)+1)).fadeIn("fast"),$("#picbtn"+e+(Number(n)+1)).attr("isSelect",1),$("#picTitle"+e+(Number(n)+1)).show("fast"),$("#picbtn"+e+(Number(n)+1)).css({"background-color":"#FFA500",color:"white"})):($("#picitem"+e+"1").fadeIn("fast"),$("#piclink"+e+"1").fadeIn("fast"),$("#picbtn"+e+"1").attr("isSelect",1),$("#picTitle"+e+"1").show("fast"),$("#picbtn"+e+"1").css({"background-color":"#FFA500",color:"white"}))}},setChartStates:function(e){if(this.ChartStates=e,null==e||0==e.Count)return void(this.Visible=!1);for(var t in e){var i=e[t];this.updateChartState(i)}},updateChartState:function(e){var t=KD.getValue(e,"datakey",null);if(!t&&void 0!=t&&t.length>0)for(var i in this.charts){var a=this.charts[i];a.Key==t&&a.updateChartState.call(cahrt,e)}},updateChartData:function(e){this.dataUpdating=!0;var t=KD.getValue(e,"datakey",null),i=null;for(var a in this.charts)if(this.charts[a].DataKey==t){this.setStartDisplayIndex(),this.setStartDisplayIndex(a),i=this.charts[a];break}null!=i&&(this.updateCurrentChart(i),i.updateChartState.call(i,e));var n=this,o=setTimeout(function(){clearTimeout(o),n.svrDataCallingIndex=void 0,n.dataUpdating=void 0},1e3)},setStartDisplayIndex:function(e){this.StartDisplayIndex&&void 0!=e||(this.StartDisplayIndex=0),"string"==typeof e&&(e=parseInt(e)),this.StartDisplayIndex=this.StartDisplayIndex+e},getStartDisplayIndex:function(){return this.StartDisplayIndex||(this.StartDisplayIndex=0),this.StartDisplayIndex},updateCharts:function(e){var t=KD.getValue(e,"charts",new Array);for(var i in this.charts){var a=!1;for(var n in t){var o=t[n];if(KD.getValue(o,"datakey",null)==this.charts[i].DataKey){a=!0;break}}0==a&&this.charts.splice(i)}var r="";for(var n in t){var o=t[n],s=KD.getValue(o,"datakey",null),l=KD.getValue(o,"selected",!1);l&&(r=s);var d=null;for(var i in this.charts)if(this.charts[i].DataKey==s){d=this.charts[i];break}null!=d?d.CacheID!=KD.getValue(o,"cacheid",null)&&d.updateChartState(o):($.extend(o,{width:this.el.width()-150,height:this.el.height()-10}),d=new KDChartControlProxy,d.setControlFactoryProxy.call(d,this.getControlFactoryProxy()),d.createControl.call(d,o),d.loadConfig.call(d,o),d.FormProxy=this.getFormProxy(),d.updateChartState(o),this.charts.push(d))}},onPreChartClick:function(){if(this.getStartDisplayIndex()>0&&this.charts.length>0){for(this.setStartDisplayIndex(-1);this.charts.length-1<this.getStartDisplayIndex();)this.setStartDisplayIndex(-1);var e=this.charts[this.getStartDisplayIndex()];this.updateCurrentChart(e)}},onNextChartClick:function(){if(this.getStartDisplayIndex()<this.charts.length-1&&this.charts.length>0){this.setStartDisplayIndex(1);var e=this.charts[this.getStartDisplayIndex()];this.updateCurrentChart(e)}},AddCharts:function(e){if(e&&0!=e.length){var t=null;for(var i in this.charts){var a=this.charts[i];a&&a.release.call(a),delete this.charts[i]}this.charts=[];for(var n in e){var a=e[n];a.width=5==this.config.dock?this.el.parent().width()-60:this.width,a.height=5==this.config.dock?this.el.parent().height():this.height;var o=this.AddChart(a);n==this.getStartDisplayIndex()&&(t=o)}this.updateCurrentChart(t)}},updateCurrentChart:function(e){if(null==e&&(this.setStartDisplayIndex(),e=this.charts[0]),1==this.charts.length)this.el.empty(),this.el.append(e.getControl());else{this.el.empty(),0==this.getStartDisplayIndex()?(this.prebtn=$("<a style='margin-top:70px;margin-left:5px;' class='PreChartButtonStyledisabled'></a>"),this.nextbtn=$("<a  style='margin-top:70px;margin-right:5px;'  class='NextChartButtonStyle'></a>")):this.getStartDisplayIndex()>=this.charts.length-1?(this.prebtn=$("<a click='onPreChartClick' style='margin-top:70px;margin-left:5px;' class='PreChartButtonStyle'></a>"),this.nextbtn=$("<a style='margin-top:70px;margin-right:5px;'  class='NextChartButtonStyledisabled'></a>")):(this.prebtn=$("<a style='margin-top:70px;margin-left:5px;' class='PreChartButtonStyle'></a>"),this.nextbtn=$("<a style='margin-top:70px;margin-right:5px;'  class='NextChartButtonStyle'></a>")),this.el.append(this.prebtn),e.getControl().css({"float":"center",display:"inline-block"}),this.el.append(e.getControl()),this.el.append(this.nextbtn);var t=this;this.prebtn&&this.prebtn.length&&"PreChartButtonStyle"==this.prebtn.attr("class")&&this.prebtn.click(function(){t.onPreChartClick&&t.onPreChartClick.call(t)}),this.nextbtn&&this.nextbtn.length&&"NextChartButtonStyle"==this.nextbtn.attr("class")&&this.nextbtn.click(function(){t.onNextChartClick&&t.onNextChartClick.call(t)})}e.updateChartState.call(e,e.config),this.dataUpdating||this.svrDataCallingIndex==e.DisplayIndex||(this.svrDataCallingIndex=e.DisplayIndex,e.setIsWaitting.call(e,!0),e.getFormProxy.call(e)||e.setControlFactoryProxy.call(e,this.getControlFactoryProxy()),e.CallServer.call(e,"UpdateChartData"))},AddChart:function(e){var t=KD.getValue(e,"datakey",null),i=null;for(var a in this.charts)if(this.charts[a].Key==t){i=this.charts[a];break}if(null==i){i=new KDChartControlProxy,i.setControlFactoryProxy(this.getControlFactoryProxy());for(var a in this.charts)if(this.charts[a].DisplayIndex>=n){n=a;break}n>this.charts.length&&(n=this.charts.length),0>n&&(n=0);var n=KD.getValue(e,"displayindex",0);i.baseId=this.baseId+"_chart"+n,i.createControl(e),i.config=e,i.initComponent(),i.loadConfig(e),i.FormProxy=this.getFormProxy(),this.charts.splice(n,0,i)}return i},LoadCacheConfig:function(){},release:function(){clearInterval(this.player);try{if(this.charts)for(var e in this.charts){var t=this.charts[e];t&&$.isFunction(t.release)&&t.release.call(t),delete this.charts[e]}}catch(i){}void 0!=this.player&&window.clearInterval(this.player),this.charts=[],KDChartContainerProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdchartcontainer",KDChartContainerProxy),define("KDChartContainerProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDChartContainerProxy}}(this)),function(e){KDGanttStore=e.extend(KDkendoStore,{FieldMap:[],serverFieldName:["Content","Start","Finish"],InnerPropertyNames:["Content","Start","Finish","Completion","IsMilestone","IsCompleted","AssignmentsContent","Predecessors","Indentation","CompletedFinish"],Cols:{Content:!0,Start:!0,Finish:!0,IsMilestone:!0,IsCompleted:!0,AssignmentsContent:!0},getkendoGridBaseOptions:function(){var e={height:600};return $.extend(e,{toolbar:[{name:"pdf",text:ResManager.LoadKDString("导出PDF","0991733000003958")}],editable:!1,tooltip:{visible:!0,template:"#= task.title #"},views:[{type:"day"},{type:"week",selected:!0},{type:"month"},{type:"year"}],dependencies:{predecessorId:1,successorId:2,type:1}}),e},loadConfig:function(e){KDGanttStore.superclass.loadConfig.call(this,e),e.colmap&&this.LoadFieldMap(e.colmap)},getkendoGridOptions:function(e){var t=this,i=KDGanttStore.superclass.getkendoGridOptions.call(this,e);$.extend(i,{dataSource:{data:t._formatRows(t.rows),autoBind:!0},messages:{noRecords:ResManager.LoadKDString("没有数据！","0991733000003937"),views:{day:ResManager.LoadKDString("日","0991733000003965"),week:ResManager.LoadKDString("周","0991733000003966"),month:ResManager.LoadKDString("月","0991733000003967"),year:ResManager.LoadKDString("年","0991733000003968")}}});var a=i.columns;return i.columns=this._dealGanttColumns(a),i},_dealGanttColumns:function(t){for(var i=[],a=0;a<t.length;a++){var n=t[a],o=this._getPropertyName(n.field);this._isInnerProperty(o)?this.Cols[o]&&i.push(n):e.isEmpty(o)||this.Cols[o]||i.push(n)}return i},_isInnerProperty:function(e){for(var t=this.InnerPropertyNames.length-1;t>=0;t--)if(e.toUpperCase()==this.InnerPropertyNames[t].toUpperCase())return!0;return!1},_getPropertyName:function(e){var t=this.FieldMap[e.toUpperCase()];return void 0!=t&&null!=t?t.propertyName:null},_formatRows:function(e){e=e||[];for(var t=0;t<e.length;t++){var i=e[t];for(var a in this.FieldMap){var n=this.FieldMap[a],o=i[a];void 0!=i[a]&&n.isForJS&&(i[n.jsColumnName]=o),("FISCOMPLETED"==a||"FISMILESTONE"==a)&&(i[a]=o?ResManager.LoadKDString("是","0991733000003969"):ResManager.LoadKDString("否","0991733000003970"))}}return e},LoadFieldMap:function(e){for(var t=0;t<e.length;t++){var i=!1,a=!1,n=e[t].propertyName,o=e[t].mapColumnName;switch(e[t].propertyName){case"Content":i=!0,n="title",a=!0;break;case"Start":n="start",i=!0,a=!0;break;case"Finish":n="end",i=!0,a=!0;break;case"CompletedFinish":case"IsCompleted":case"IsMilestone":case"Completion":a=!0;break;case"Indentation":n="orderId",i=!0,a=!0;break;case"Predecessors":n="parentId",i=!0,a=!0;break;case"AssignmentsContent":a=!0,i=!0}this.FieldMap[o.toUpperCase()]={jsColumnName:n,isForJS:i,isWPFColumn:a,mapColumnName:o,propertyName:e[t].propertyName}}}})}(KD),define("KDGanttStore",["KD","KDStore"],function(e){return function(){var t;return t||e.KDGanttStore}}(this)),KDGanttChartProxy=KD.extend(KDKendoGridProxy,{createControl:function(e){return e.dock=KD.dock.Fill,e.height=600,KDGanttChartProxy.superclass.createControl.call(this,e)},renderGrid:function(e){return this.gridEl.kendoGantt(e)},getKendoGrid:function(){var e=this.gridEl?this.gridEl.data("kendoGantt"):void 0;return e},setParameter:function(e){},noVisibleCol:{},setColVisible:function(e,t){var i=(this.getKendoGrid(),this.getStore()),a=e.getFieldName.call(e);e.getKendoFieldName.call(e);if(t)i.setVisibleCol.call(i,a,!0),$("th[data-field='"+a+"'][role='columnheader']",this.el).show(),delete this.noVisibleCol[a];else{i.setVisibleCol.call(i,a,!1);for(var n=$("th[data-field='"+a+"'][role='columnheader']",this.el),o=n.parent(),r=0,s=$("tbody[role='rowgroup']",this.el),l=0;l<o.children().length;l++){var d=$(o.children()[l]);if(d.attr("data-field")==a&&"columnheader"==d.attr("role")){r=l,this.noVisibleCol[a]=r,$("td:eq("+r+")",s).hide(),d.hide();break}}}},createNewStore:function(){return $.extend(new KDGanttStore,{virtualScroll:!this.isInVertical})},setBarItemStates:function(e){},getUIFocusedRowId:function(){return 0},getDataSource:function(e){var t=[];if(e&&e.data)for(var i=0;i<e.data.length;i++){var a=e.data[i];if(!KD.IsNullOrWhiteSpace(a.parentId))if(a.parentId.indexOf(","))for(var n=a.parentId.split(","),o=0;o<n.length;o++){var r=n[o].trim();KD.IsNullOrWhiteSpace(r)||t.push({predecessorId:a.FROWID,successorId:r,type:3})}else t.push({predecessorId:a.FROWID,successorId:a.parentId,type:3});a.parentId=null}return this.dependenciesDataSource=new kendo.data.GanttDependencyDataSource({data:t}),new kendo.data.GanttDataSource(e)},getCurrentElement:function(){var e=this,t=e.getKendoGrid();return t.select()},onRefreshGridData:function(){var e=this;try{var t=e.getKendoGridOptions.call(e),i=e.getKendoGrid(),a=e.getUIFocusedRowId();e.initDefFocusedRowIndex&&e.initDefFocusedRowIndex(a),delete e.lastFocusedRowId;var n=(e.getStore.call(e),e.getDataSource(t.dataSource));if(i.setDataSource.call(i,n),e.syncColHeadValue&&e.syncColHeadValue(),t.dataSource.data.length<=0)return;i.setDependenciesDataSource.call(i,this.dependenciesDataSource);var o=$("tbody[role='rowgroup']",this.el);for(var r in this.noVisibleCol){var s=this.noVisibleCol[r];o.find("tr").find("td:eq("+s+")").hide()}}catch(l){KD.writeError(l)}}}),KDControlFactoryProxy.registerType("kdganttgrid",KDGanttChartProxy),define("KDGanttChartProxy",["KDKendoGridProxy","KD","KDGanttStore"],function(e){return function(){var t;return t||e.KDGanttChartProxy}}(this)),KDWorkflowDesignerProxy=KD.extend(KDControlProxy,{createControl:function(e){var t=KDWorkflowDesignerProxy.superclass.createControl.call(this,e);return t},loadConfig:function(e){KDWorkflowDesignerProxy.superclass.loadConfig.call(this,e),KD.writeLog("KDWorkflowDesignerProxy.loadWorkflow",ResManager.LoadKDString("HTML5端暂时未支持，请使用其他端进行流程设计。","0025710000008047"),!0),this.el.empty().append('<span style="padding: 10px 10px;display: block;">'+ResManager.LoadKDString("HTML5端暂时未支持，请登录GUI客户端进行流程设计。","0141072000004751")+"</span>")},loadWorkflow:function(e){KD.writeLog("KDWorkflowDesignerProxy.loadWorkflow",ResManager.LoadKDString("HTML5端暂时未支持，请使用其他端进行流程设计。","0025710000008047"),!0),this.el.empty().append('<span style="padding: 10px 10px;display: block;">'+ResManager.LoadKDString("HTML5端暂时未支持，请登录GUI客户端进行流程设计。","0141072000004751")+"</span>")},doLayout:function(){}}),KDControlFactoryProxy.registerType("kdflowdesigner",KDWorkflowDesignerProxy),define("KDWorkflowDesignerProxy",["KDControlProxy","KD","MindFusion_Diagramming","KDFlowNode"],function(e){return function(){var t;return t||e.KDWorkflowDesignerProxy}}(this)),function(){KDWorkflowViewProxy=KD.extend(KDControlProxy,{loadConfig:function(e){KDWorkflowViewProxy.superclass.loadConfig.call(this,e)},createControlDom:function(){var e=this;e.canvasId=e.baseId+"_diagram";var t=$('<iframe src="KDWorkflowView.html">');return t},initComponent:function(){KDWorkflowViewProxy.superclass.initComponent.call(this)},setDesignerXml:function(e){},addActiveState:function(e){}})}(),function(){MindFusion.Diagramming.Diagram.prototype.onTooltip=function(){var e=this.getItemAt(this.tooltipPoint,!0,!1);if(e&&e.tooltip){var t=this.get_element().id+"_tooltip",i=this.tooltipDiv=document.createElement("div");document.body.appendChild(i),i.setAttribute("id",t),i.setAttribute("class","DiagramTooltip"),i.innerHTML=e.tooltip,i.style.left=this.tooltipX+20+"px",i.style.top=this.tooltipY+"px",i.style.width="auto",i.style.position="absolute",i.style.display="block",i.style.background="white",i.style.border="solid 1px",i.style.zIndex=KD.CONST.WorkflowChartZindex+2}},MindFusion.Diagramming.Diagram.prototype.clearTooltip=function(){this.tooltipTimeoutId&&clearTimeout(this.tooltipTimeoutId);var e=$(".DiagramTooltip");this.tooltipDiv&&e.length>0&&(document.body.removeChild(this.tooltipDiv),this.tooltipDiv=null),e.remove()},KD.isMobileOS&&KD.isMobileOS()&&(MindFusion.Diagramming.Diagram.prototype._updateFocusable||(MindFusion.Diagramming.Diagram.prototype._updateFocusable=MindFusion.Diagramming.Diagram.prototype.updateFocusable,MindFusion.Diagramming.Diagram.prototype.updateFocusable=function(e){try{MindFusion.Diagramming.Diagram.prototype._updateFocusable(e)}catch(t){KD.writeLog("MindFusion.Diagramming.Diagram.prototype.updateFocusable",t.message)}}),MindFusion.Diagramming.Diagram.prototype.onTouchMove=function(e){try{if(e){var t=e.touches;this.preventDefaultTouch&&1==t.length&&(this.lastTouch=this.emulateMouse(e),this.onMouseMove(this.lastTouch),KD.isMobileOS()||e.preventDefault())}}catch(i){KD.writeLog("MindFusion.Diagramming.Diagram.prototype.updateFocusable",i.message)}});var e=MindFusion.Diagramming.Diagram;KDWorkflowChartProxy_MindFusion=KD.extend(KDControlProxy,{draw:null,activeState:{},formProxy:null,brushStyles:null,curShapeNode:null,limitLoadCount:100,drawMaxWidthOrHeight:16e3,maxRight:0,maxBottom:0,loadConfig:function(e){KDWorkflowChartProxy_MindFusion.superclass.loadConfig.call(this,e),this.el.off("mouseleave").on("mouseleave",function(){MindFusion.Diagramming.Diagram.prototype.clearTooltip()})},createControlDom:function(){var e=this;e.formProxy=e.getFormProxy(),e.canvasId=e.baseId+"_diagram";var t=$('<div style="overflow:auto;z-index:20000"><canvas id="'+e.canvasId+'" style="overflow:auto;"></canvas></div>');return t},release:function(){MindFusion.Diagramming.Diagram.prototype.clearTooltip(),this.draw&&this.draw.clearAll(),KDWorkflowChartProxy_MindFusion.superclass.release.call(this)},loadFlowXml:function(e){},setDesignerXml:function(e){var t=this;try{if(t._readyDesignerData(e),t.draw=t._getDraw(),!t.draw)return;this.draw.clearAll(),this.draw.setCustomNodeType(MindFusion.Diagramming.KDFlowNode);var i=this.jsonData.Properties.Bounds.split(",");try{this.draw.setBounds(new MindFusion.Drawing.Rect(parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])))}catch(a){if(i[2]&&i[3]){t.draw.scale=1;var n=2500,o=parseFloat(i[2])>n?n:parseFloat(i[2]),r=parseFloat(i[3])>n?n:parseFloat(i[3]);this.draw.setBounds(new MindFusion.Drawing.Rect(0,0,o,r))}}this.draw.setAutoResize(parseInt(this.jsonData.Properties.AutoResize)),this.draw.setMeasureUnit(parseInt(this.jsonData.Properties.MeasureUnit)),this.draw.setAdjustmentHandlesSize(parseInt(this.jsonData.Properties.AdjustmentHandlesSize)),this.draw.setShadowsStyle(null),this.draw.setTooltipDelay(50),this.draw.setAllowUnconnectedLinks(this._getBoolValue(this.jsonData.Properties.AllowUnconnectedLinks)),this.draw.setDefaultShape(this.jsonData.Properties.DefaultShape.Id),this.draw.setFont(new MindFusion.Drawing.Font("sans-serif",parseInt(this.jsonData.Properties.Font.Unit),!1,this._getBoolValue(this.jsonData.Properties.Font.Italic)));var s=this._getBrsh(this.jsonData.Properties.ShapeBrush.Id);s&&this.draw.setShapeBrush(s),s=this._getPen(this.jsonData.Properties.ShapePen.Brush.Id),s&&this.draw.setShapePen(s),this.draw.setLinkCrossings(parseInt(this.jsonData.Properties.LinkCrossings)),this.draw.setCrossingRadius(parseInt(this.jsonData.Properties.CrossRadius)),s=this._getBrsh(this.jsonData.Properties.LinkBrush.Id),s&&this.draw.setLinkBrush(s),s=this._getPen(this.jsonData.Properties.LinkPen.Brush.Id),s&&this.draw.setLinkPen(s),this.draw.setLinkBaseShapeSize(parseInt(this.jsonData.Properties.LinkBaseShapeSize)),this.draw.setLinkHeadShape(this.jsonData.Properties.LinkHeadShape.Id),this.draw.setLinkHeadShapeSize(parseInt(this.jsonData.Properties.LinkHeadShapeSize)),this.draw.setAlignToGrid(this._getBoolValue(this.jsonData.Properties.AlignToGrid)),this.draw.setGridColor(this.jsonData.Properties.GridColor),this.draw.setGridOffsetX(parseInt(this.jsonData.Properties.GridOffsetX)),this.draw.setGridOffsetY(parseInt(this.jsonData.Properties.GridOffsetY)),this.draw.setGridSizeX(parseInt(this.jsonData.Properties.GridSizeX)),this.draw.setGridSizeY(parseInt(this.jsonData.Properties.GridSizeY)),this.draw.setGridPointSize(parseInt(this.jsonData.Properties.GridPointSize));var l=this.jsonData.Nodes,d=l?l.Node:[],c=this.jsonData.Links,h=[];c&&KD.isArray(c.Link)?h=c.Link:c&&KD.isObject(c.Link)&&h.push(c.Link),t._loadXMLNodeAndLink(d,h)}catch(u){var p=t.getFormProxy();p&&p.showErrMsgStr.call(p,ResManager.LoadKDString("由于当前浏览器自身限制，无法正常查看拓扑图，请更换浏览器查看（推荐谷歌浏览器）。","00215181000007446")),KD.writeError(u)}},_loadXMLNodeAndLink:function(e,t){var i,a=this,n=this.limitLoadCount,o=a.drawMaxWidthOrHeight;if(e&&e.length){e.length<n&&(this.limitLoadCount=n=e.length);for(var r=0;n>r;r++){var s=e[r],l=a._getRect(s);a.maxRight=a.maxRight<l.x+l.width+20?l.x+l.width+20:a.maxRight,a.maxBottom=a.maxBottom<l.y+l.height+20?l.y+l.height+20:a.maxBottom}i=e.slice(n,e.length)}else{var s=e;a._getRect(s)}if(i&&i.length)KD.delayInvoke(function(){a._loadXMLNodeAndLink.call(a,i,t)},100);else{this.allLink=t,this.hideLinks=[];for(var d=0;d<t.length;d++){var c=t[d];c.Visible&&"FALSE"!=c.Visible.toString().toUpperCase()||this.hideLinks.push(c),a._getLinePath(c)}a.draw.setBehavior(MindFusion.Diagramming.Behavior.SelectOnly);var h=!1;a.maxRight>=o&&(a.maxRight=o,h=!0),a.maxBottom>=o&&(a.maxBottom=o,h=!0);var u=a.draw.bounds&&a.draw.bounds.width,p=a.draw.bounds&&a.draw.bounds.height;if(a.maxRight=u>a.maxRight?a.maxRight:u,a.maxBottom=p>a.maxBottom?a.maxBottom:p,a.draw.setBounds(new MindFusion.Drawing.Rect(0,0,a.maxRight,a.maxBottom)),h){var g=a.getFormProxy();g&&g.showErrMsgStr.call(g,ResManager.LoadKDString("当前拓扑图节点过多，超过了浏览器显示限制，导致拓扑图无法完整显示，建议您重新设计拓扑图","00215476030048269"))}}},zoomOut:function(){if(!(this.draw.zoomFactor>260)){var e=this.draw.zoomFactor+15;this.draw.setZoomFactor(e)}},zoomIn:function(){if(!(this.draw.zoomFactor<40)){var e=this.draw.zoomFactor-15;this.draw.setZoomFactor(e)}},elementsVisibleChange:function(e){KD.Error.raise({sourceClass:"KDWorkflowChartProxy_MindFusion",sourceMethod:"setElementsVisibleChange",msg:"H5端暂时不支持显示简化流程图，请使用其他客户端"})},_resetLinkStatu:function(e){if(this.hideLinks)for(var t=0;t<this.hideLinks.length;t++){var i=this.hideLinks[t];i.Visible=e}},_getHideLinks:function(){this.hideLinks=[];for(var e=0;e<this.allLink.length;e++){var t=this.allLink[e];t.Visible&&"FALSE"!=t.Visible.toString().toUpperCase()||this.hideLinks.push(t)}},_getDraw:function(){var t=this;return t.draw||MindFusion.AbstractionLayer.createControl(e,null,null,null,$("#"+t.canvasId)[0])},_readyDesignerData:function(e){this.activeState=e.workflowchartmetadata.DictActivityState,this.activeToolTip=e.workflowchartmetadata.DictActivityToolTip,this.dicItemName=e.workflowchartmetadata.DictItemName,this.ActivityRouter=e.workflowchartmetadata.ActivityRouter,this.jsonData=$.xml2json(e.workflowchartmetadata.DesignerXml);var t={Bounds:"",AutoResize:1,MeasureUnit:7,AdjustmentHandlesSize:8,AllowUnconnectedLinks:"False",DefaultShape:{},Font:{Unit:7,Italic:"False"},ShapeBrush:{},ShapePen:{Brush:{},DashOffset:0,DashStyle:0,Width:1},LinkCrossings:1,CrossRadius:5,LinkBrush:{},LinkPen:{Brush:{},DashOffset:0,DashStyle:0,Width:1},LinkBaseShapeSize:13,LinkHeadShape:{},LinkHeadShapeSize:13,AlignToGrid:"False",GridColor:"",GridOffsetX:0,GridOffsetY:0,GridSizeX:20,GridSizeY:20,GridPointSize:5};this.jsonData.Properties=$.extend(t,this.jsonData.Properties);var i=this.jsonData.Resources.Brushes.Brush;this.brushStyles=[];for(var a=0;a<i.length;a++){var n=i[a],o={type:n.Type,color:n.Color,myIndex:n.Index};this.brushStyles.push(o)}},_getRect:function(e){var t={Bounds:"",Class:"",ItemName:"",Locked:"",NodeImgKey:"",RefFlowElementId:""};e=$.extend(t,e);var i=e.RefFlowElementId,a=this,n=(a.formProxy,new KDFlowNode(this.draw));if(this.dicItemName&&void 0!=this.dicItemName[i]){var o=this.dicItemName[i];KD.isEmpty(o)||(e.ItemName=o)}n.canvasContext=document.getElementById(a.canvasId).getContext("2d"),n.metaNodeInfo=e,n.subImageList=[],
n.Id=e.Id,n.draw=this.draw;var r=e.Bounds.split(","),s=new MindFusion.Drawing.Rect(parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]));if(n.setBounds(s),n.raiseClicked=function(){a.curShapeNode=this,a.onNodeClick(this.RefFlowElementId)},n.raiseDoubleClicked=function(){a.curShapeNode=this,a.onNodeDoubleClick(this.RefFlowElementId)},this._addActiveState(e.RefFlowElementId),n.activebackgroundColor=2==this.activeState[e.RefFlowElementId]?"#2D9BF3":"",this.draw.addItem(n),n.setZIndex(KD.CONST.WorkflowChartZindex),this.dicItemName&&void 0!=this.dicItemName[i]){var o=this.dicItemName[i],l=o;this.activeToolTip&&!KD.IsNullOrWhiteSpace(this.activeToolTip[i])&&(l=this.activeToolTip[i]),n.setTooltip(KD.convertToHtmlString(l))}return this._setNoteChartTipImg(i,r),s},onNodeClick:function(e){var t=this;if(t.getFormProxy()){var i={},a=e;i.Key=a,i.Value=t.activeState[a],t.getFormProxy().fireCustomEvents("FSelectedNodeId","NodeSelected",JSON.stringify(i),null)}},onNodeDoubleClick:function(e){var t=this;if(t.getFormProxy()){var i={},a=e;i.Key=a,i.Value=t.activeState[a],t.getFormProxy().fireCustomEvents("FSelectedNodeId","NodeDoubleClick",JSON.stringify(i),null)}},_getLinePath:function(e){var t=new MindFusion.Diagramming.DiagramLink(this.draw);t.Id=e.Id,t.setStyle(parseInt(e.Style)),t.setAutoRoute(this._getBoolValue(e.AutoRoute)),t.setZIndex(KD.CONST.WorkflowChartZindex),t.setStrokeThickness(parseInt(e.StrokeThickness));for(var i,a,n=this.draw.nodes,o=!1,r=!1,s=0;s<n.length;s++){var l=n[s];if(o||l.Id!=e.Origin.Id||(i=l,o=!0),r||l.Id!=e.Destination.Id||(a=l,r=!0),o&&r)break}t.setOrigin(i),t.setOriginAnchor(parseInt(e.OriginAnchor)),t.setDestination(a),t.setDestinationAnchor(parseInt(e.DestinationAnchor));for(var d=[],s=0;s<e.Points.Point.length;s++){var c=e.Points.Point[s].split(","),h=new MindFusion.Drawing.Point(parseFloat(c[0]),parseFloat(c[1]));d.push(h)}t.setPoints(d),t.updateFromPoints();var u=e.RefFlowElementId;if(this.dicItemName&&void 0!=this.dicItemName[u]){var p=this.dicItemName[u];KD.isEmpty(p)||(e.Text=p)}e.Text&&e.Text.length>0&&t.setText(e.Text),t.setTextStyle(MindFusion.Diagramming.LinkTextStyle.Center);var g=new MindFusion.Drawing.Font("sans-serif",12,!1,!1);t.setFont(g);this.activeState[e.Id];this.renderLinks(t,e),this.draw.addItem(t)},renderLinks:function(e,t){e.setHeadBrush("#78DCFF");for(var i=0;i<this.ActivityRouter.length;i++){var a=this.ActivityRouter[i];if(e.getOrigin&&e.getDestination&&e.getOrigin().RefFlowElementId==a.Key.toString()&&e.getDestination().RefFlowElementId==a.Value.toString())return e.setPen("LightGreen"),void e.setHeadBrush("LightGreen")}},_getBoolValue:function(e){return void 0==e||"FALSE"==e.toString().toUpperCase()?!1:"TRUE"==e.toString().toUpperCase()?!0:void 0},_getBrsh:function(e){if(void 0==e||!e.toString)return null;var t=$.grep(this.brushStyles,function(t,i){return t.myIndex.toString()==e.toString()?t:void 0},null);return t&&t.length>0?t[0]:null},_getPen:function(e){if(void 0==e||!e.toString)return null;var t=$.grep(this.brushStyles,function(t,i){return t.myIndex.toString()==e.toString()?t:void 0},null);return t&&t.length>0?t[0].color:null},_addActiveState:function(e){return this.activeState[e]||(this.activeState[e]=0),e},_getNodeById:function(e){for(var t=null,i=0;i<this.draw.nodes.length;i++){var a=this.draw.nodes[i];if(a.RefFlowElementId==e){t=a;break}}return t},_getLinkById:function(e){for(var t=null,i=0;i<this.draw.links.length;i++){var a=this.draw.links[i];if(node.Id==e){t=a;break}}return t},_setNoteChartTipImg:function(e,t){var i=this;if(this.activeState&&void 0!=this.activeState[e]){var a="";switch(this.activeState[e]){case-1:a="ChartActivityPrediction.png";break;case 1:a="ChartActivityComplete.png";break;case 2:a="wf_FinalApprovalTipImg.png";break;case 4:a="ChartActivityError.png";break;case 5:a="ChartActivityTerminate.png";break;case 6:a="ChartActivityReject.png";break;default:return}a=KD.getUrlRoot()+"/images/silverlight/default/workflowDesigner/"+a;var n=new MindFusion.Diagramming.ShapeNode(this.draw),o=parseFloat(t[0]),r=parseFloat(t[1]),s=parseFloat(t[2]);parseFloat(t[3]);n.setBounds(new MindFusion.Drawing.Rect(o+s-17,r+12,16,16)),n.setText(""),n.Id=2e4+e,n.RefFlowElementId=e,n.draw=this.draw,n.setImageLocation(a),n.setHandlesStyle(0),n.setZIndex(KD.CONST.WorkflowChartZindex+1),this.activeToolTip[e]&&n.setTooltip(KD.convertToHtmlString(this.activeToolTip[e])),n.raiseClicked=function(){i.curShapeNode=this,i.onNodeClick(this.RefFlowElementId),KD.isMobileOS()&&i.onNodeDoubleClick(this.RefFlowElementId)},n.raiseDoubleClicked=function(){i.curShapeNode=this,i.onNodeDoubleClick(this.RefFlowElementId)},n.setTransparent(1),n.setVisible(!0),this.draw.addItem(n)}}})}(),KDControlFactoryProxy.registerType("kdworkflowchart",KDWorkflowChartProxy_MindFusion),function(){KDSilverlightFormProxy=KD.extend(KDControlProxy,{hostWindowProxy:null,formdata:null,createControl:function(e){var t=e||{};return this.el=$("<div></div>"),t.dock==KD.dock.Fill?this.el.css({height:"inherit",width:"100%"}):this.getIsMain()?this.el.css({height:"inherit",width:"100%"}):this.el.css({height:t.height,width:t.width}),this.el.addClass("ui-form"),this.el.addClass("wform"),this.el.addClass("kdform"),this.el=this.el.KDPanel(),this.el},loadConfig:function(e){var t=this;KDSilverlightFormProxy.superclass.loadConfig.call(this,e);var i="inhtml5=true&username="+ClientAppProxy.Current.CTX.UserName+"&locaid=2052";i+="&dbid="+ClientAppProxy.Current.CTX.DBid+"&token="+ClientAppProxy.Current.CTX.UserToken;i+="&aspnetsessionId="+KD.getAspNetSessionId(),void 0==document.rootForm.silverlightFormArgs&&(document.rootForm.silverlightFormArgs=[]),document.rootForm.silverlightFormArgs.push(this.formdata),i+="&fromdataindex="+(document.rootForm.silverlightFormArgs.length-1),iframe=this.el.iframe=$("<iframe style='overflow:hidden' src='../Silverlight/IndexSL.aspx?"+i+"'></iframe>"),iframe.off("load").on("load",function(){var e=$(t.contentDocument.body);e.css({height:"auto"});var i=e.innerHeight(),a=e.innerWidth();$(this).css({height:i,width:a,overflow:"hidden"})}),this.el.append(this.el.iframe)},setHostWindowProxy:function(e){this.hostWindowProxy=e}})}(),KDControlFactoryProxy.registerType("kdsilverlightform",KDSilverlightFormProxy),define("KDWorkflowChartProxy_MindFusion",["KDFlowNode","KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDWorkflowChartProxy_MindFusion}}(this)),KDInitGuideWorkbenchProxy=KD.extend(KDControlProxy,{loadConfig:function(e){KDInitGuideWorkbenchProxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDInitGuideWorkbenchProxy.superclass.initComponent.call(this),this.component=$(kendo.format('<div style="width:100%;height:100%;">')),this.el.append(this.component),this.el.css({"background-color":"#fff",padding:"30px 0px 15px 0px"}),this.workbenchGroups=$(kendo.format('<div class="kd-workbenck-accordion">')),this.workbenchItems=$('<div class="kd-workbench-items">'),this.component.append(this.workbenchGroups).append(this.workbenchItems)},doLayout:function(){KDInitGuideWorkbenchProxy.superclass.doLayout.call(this)},setData:function(e){void 0==e&&(e=[]),this._setBusinessGroupNavigation(e)},setStepInfos:function(e){var t=this;if(null!=e&&!KD.isEmpty(e.stepname)){var i=t.workbenchGroups.find("[stepname="+e.stepname+"]"),a=i.find(".kd_divinitguide_button");!KD.isEmpty(e.color)&&i.find(".kd_divinitguide_button")&&i.find(".kd_divinitguide_button").css({"background-color":e.color}),!KD.isEmpty(e.buttontext)&&i.find(".kd_divinitguide_button")&&i.find(".kd_divinitguide_button").find("span").html(e.buttontext),t._setButtonTextAnimate(e.buttonisanimate,e.buttontext,a),!KD.isEmpty(e.steptile)&&i.find(".kd_divinitguide_center").find(".kd_steptitle_link")&&i.find(".kd_divinitguide_center").find(".kd_steptitle_link").html(e.steptile),!KD.isEmpty(e.description)&&i.find(".kd_divinitguide_center").find(".kd_divinitguide_descriptionwithtitle>span")&&i.find(".kd_divinitguide_center").find(".kd_divinitguide_descriptionwithtitle>span").html(e.description),!KD.isEmpty(e.studytime)&&i.find(".kd_divinitguide_stepstudytime")&&i.find(".kd_divinitguide_stepstudytime").empty();var n=KD.isEmpty(e.studytimecolor)?"":e.studytimecolor;if(!KD.isEmpty(e.studytimeclickenable)&&KD.equalsIgnoreCase(e.studytimeclickenable,"true")){var o=$(kendo.format('<span><a class="kd_stepstudytime_link" steptitleurl="{0}">{0}</a></span>',e.studytime));!KD.isEmpty(n)&&$(i.find(".kd_divinitguide_stepstudytime")).css({color:n}),i.find(".kd_divinitguide_stepstudytime").append(o),i.find(".kd_divinitguide_stepstudytime").attr("title",KD.htmlUtil.encode(e.studytime).replace(/\"/g,"&quot;")),o&&o.find(".kd_stepstudytime_link")&&o.find(".kd_stepstudytime_link").unbind("click").bind("click",function(e){var i=t.getFormProxy(),a="clickStudyTimeLink",n=KD.isEmpty($(this).attr("formid"))?"":$(this).attr("formid"),o=0,r={stepname:$(this).parents(".kd_divinitguidestep").attr("stepname")};t&&t.component&&(o=$(t.component).find(".kd-workbenck-accordion")&&$(t.component).find(".kd-workbenck-accordion").attr("orgid"));var s=o;i&&i.fireEvent.call(i,"NaviOperAction",a,n,0,s,r,null)})}else{var r=$(kendo.format("<span>{0}</span>",e.studytime));!KD.isEmpty(n)&&$(i.find(".kd_divinitguide_stepstudytime")).css({color:n}),i.find(".kd_divinitguide_stepstudytime").append(r),i.find(".kd_divinitguide_stepstudytime").attr("title",KD.htmlUtil.encode(e.studytime).replace(/\"/g,"&quot;"))}}},setStepStatus:function(e){var t=this;if(null!=e){var i;KD.isEmpty(e.stepname)||(i=t.workbenchGroups.find("[stepname="+e.stepname+"]").find(".kd_divinitguide_button"),!KD.isEmpty(e.color)&&i&&i.css({"background-color":e.color}),!KD.isEmpty(e.buttontext)&&i&&i.find("span").html(e.buttontext),t._setButtonTextAnimate(e.buttonisanimate,e.buttontext,i))}},_setButtonTextAnimate:function(e,t,i){var a=this,n=0;e&&1==e?null==a.timer&&(a.timer=KD.setInterval(function(){if(n>3)n=0;else{var e;switch(n){case 0:e=t;break;case 1:e=t+".";break;case 2:e=t+"..";break;case 3:e=t+"..."}$(i).find("span").html(e),n++}},500,"KDInitGuideWorkbenchProxy.setStepStatus()")):null!=this.timer&&clearInterval(this.timer)},_setBusinessGroupNavigation:function(e){var t,i=this;if(this.workbenchGroups.empty(),e&&e.orgid&&this.workbenchGroups.attr("orgid",e.orgid),null!=e&&null!=e.children)for(var a=KD.isEmpty(["stepBarHeight"])?"51px":e.stepBarHeight+"px",n=0;n<e.children.length;n++)t=e.children[n],this._buildMenuItem(t,i,a)},_buildMenuItem:function(e,t,i){var a,n,o,r,s,l=!KD.isEmpty(e.buttonwidth)&&e.buttonwidth>0?e.buttonwidth:159,d=$(kendo.format('<div id="div_initguidestep{0}" stepname="{1}" class="kd_divinitguidestep"  style="height:{2}"></div>',e.id,e.stepname,i)),c=$(kendo.format('<div class="kd_divinitguide_seq"><span class="kd_spaninitguide_seqnum">{0}</span></div>',e.id)),h=$(kendo.format('<div style="width:calc(100% - 48px - {0}px)" class="kd_divinitguide_center"></div>',l)),u=$(kendo.format('<div class="kd_divinitguide_steplinks"></div>')),p=$(kendo.format("<span></span>"));if(e.linklist&&e.linklist.length>0){for(var g=0;g<e.linklist.length;g++)r=e.linklist[g],o=r.formid&&!KD.isEmpty(r.formid)?$(kendo.format('<a class="kd_linkinitguide_link" formid="{0}">{1}</a>',KD.isEmpty(r.formid)?"":r.formid,KD.isEmpty(r.name)?"":r.name)):$(kendo.format('<a class="kd_linkinitguide_link" target="_blank" href="{0}">{1}</a>',KD.isEmpty(r.url)?"":r.url,KD.isEmpty(r.name)?"":r.name)),p.append(o);u.append(p)}var f=e.descriptionmaxwidthpercent&&e.descriptionmaxwidthpercent>0?kendo.format("max-width:{0}%",e.descriptionmaxwidthpercent):"";if(KD.isEmpty(e.steptile))n=$(kendo.format('<div class="kd_divinitguide_description" style="{2}" title="{1}"><span>{0}</span></div>',KD.htmlUtil.encode(e.description).replace(/\"/g,"&quot;"),e.description,f));else{var m=e.titleclickenable&&1==e.titleclickenable?"color:#0E8BEB;":"";m=e.titlefontsize&&e.titlefontsize>12?m+"font-size:"+e.titlefontsize+"px":m,a=$(kendo.format('<a class="kd_steptitle_link" title="{1}" style="{2}" steptitleurl="{0}">{1}</a>',e.steptitleurl,e.steptile,m,KD.htmlUtil.encode(e.steptile).replace(/\"/g,"&quot;"))),n=$(kendo.format('<div class="kd_divinitguide_descriptionwithtitle" style="{2}" title="{1}"><span>{0}</span></div>',e.description,KD.htmlUtil.encode(e.description).replace(/\"/g,"&quot;"),f)),h.append(a),a&&a.unbind("click").bind("click",function(e){var i=t.getFormProxy(),a="clickStepTitle",n=$(this).attr("steptitleurl");t&&t.component&&(orgid=$(t.component).find(".kd-workbenck-accordion")&&$(t.component).find(".kd-workbenck-accordion").attr("orgid"));var o=orgid;i&&i.fireEvent.call(i,"NaviOperAction",a,n,0,o,null,null)})}s=!KD.isEmpty(e.buttonwidth)&&e.buttonwidth>0?"width:"+e.buttonwidth+"px;":"",s+=KD.isEmpty(e.buttoncolor)?"":"background-color:"+e.buttoncolor;var v,y,b=KD.isEmpty(e.studytimecolor)?"":"color:"+e.studytimecolor,D=e.studytimemaxwidthpercent&&e.studytimemaxwidthpercent>0?kendo.format("max-width:{0}%",e.studytimemaxwidthpercent):"";KD.isEmpty(e.studytimeclickenable)||1!=e.studytimeclickenable?y=$(kendo.format('<div class="kd_divinitguide_stepstudytime" title="{2}" style="{1};{3}"><span>{0}</span></div>',e.studytime,b,KD.htmlUtil.encode(e.studytime).replace(/\"/g,"&quot;"),D)):(v=$(kendo.format('<span><a class="kd_stepstudytime_link" steptitleurl="{0}">{0}</a></span>',e.studytime)),y=$(kendo.format('<div class="kd_divinitguide_stepstudytime" title="{1}" style="{0};{2}"></div>',b,KD.htmlUtil.encode(e.studytime).replace(/\"/g,"&quot;"),D)),y.append(v)),v&&v.find(".kd_stepstudytime_link")&&v.find(".kd_stepstudytime_link").unbind("click").bind("click",function(e){var i=t.getFormProxy(),a="clickStudyTimeLink",n=KD.isEmpty($(this).attr("formid"))?"":$(this).attr("formid"),o=0,r={stepname:$(this).parents(".kd_divinitguidestep").attr("stepname")};t&&t.component&&(o=$(t.component).find(".kd-workbenck-accordion")&&$(t.component).find(".kd-workbenck-accordion").attr("orgid"));var s=o;i&&i.fireEvent.call(i,"NaviOperAction",a,n,0,s,r,null)});var k=$(kendo.format('<div class="kd_divinitguide_button {0}" style="{3}" isfinishedstep="{1}"><span class="kd_divinitguide_buttonspan">{2}</span></div>',e.isfinishedstep&&KD.equalsIgnoreCase(e.isfinishedstep.toString(),"true")?"kd_divinitguide_buttonfinished":"kd_divinitguide_buttonunfinished",e.isfinishedstep,e.buttoninittext,s));h.append(n),h.append(u),h.append(y),d.append(c),d.append(h),d.append(k),k&&k.unbind("click").bind("click",function(e){var i=t.getFormProxy(),a="clickStepButton",n=d.attr("stepname"),o=0;t&&t.component&&(o=$(t.component).find(".kd-workbenck-accordion")&&$(t.component).find(".kd-workbenck-accordion").attr("orgid")),d.attr("isfinishedstep","true");var r=o;i&&i.fireEvent.call(i,"NaviOperAction",a,n,0,r,null,null)}),p.children()&&p.children().unbind("click").bind("click",function(e){var i=t.getFormProxy(),a="clickLink",n=KD.isEmpty($(this).attr("formid"))?"":$(this).attr("formid"),o=0,r={stepname:$(this).parents(".kd_divinitguidestep").attr("stepname")};t&&t.component&&(o=$(t.component).find(".kd-workbenck-accordion")&&$(t.component).find(".kd-workbenck-accordion").attr("orgid"));var s=o;KD.isEmpty($(this).attr("formid"))?i&&i.fireEvent.call(i,"NaviOperAction",a,n,1,s,r,null):i&&i.fireEvent.call(i,"NaviOperAction",a,n,0,s,r,null)}),this.workbenchGroups.append(d)},timer:null,timeStop:function(){null!=this.timer&&clearInterval(this.timer)},release:function(){clearInterval(this.timer),KDInitGuideWorkbenchProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdinitguideworkbench",KDInitGuideWorkbenchProxy),define("KDInitGuideWorkbenchProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDInitGuideWorkbenchProxy}}(this)),KDConsoleRightMenuProxy=KD.extend(KDControlProxy,{isManageSite:!1,controlHeight:0,isShowStar:!0,menuWidth:0,editGroupActionName:"EditGroup",emptyGroupStyleName:"kd-group-empty",menuDisplayModelList:{columnModel:"Col",rowModel:"Row"},menuDisplayModel:0,tipsArray:[],loadConfig:function(e){KDConsoleRightMenuProxy.superclass.loadConfig.call(this,e),this.changeDisplayModelBtn=void 0},initComponent:function(){var e=this;KDConsoleRightMenuProxy.superclass.initComponent.call(this);var t="100%";this.component=$(kendo.format('<div class="kd-allmenu-tree" style="width:{0};height:{1}">',t)),this._checkComponentHeight(),this.el.append(this.component),this.el.css({"background-color":"#fff",padding:"0px 0px 0px 0px"}),this.el.addClass("kd-consolerightmenu"),this._initOperateAreaContainer(),this._bindActionEvent(),this.consoleRightMenuGroups=$(kendo.format('<div class="kd-consolerightmenu-accordion"></div>'));var i=this.baseId+"_headlink_c",a=kendo.format("<div class='kd-consolerightmenu-accordionhead'><a id='{0}' href='#'></a></div>",i);this.component.append($(a)).append(this.consoleRightMenuGroups),this.consoleRightMenuGroups[0].addEventListener("wheel",function(t){var i=$(this);e._rollerScroll.call(e,t,i)}),this.setMenuDisplayModel(this.menuDisplayModel)},_rollerScroll:function(e,t){if(this._isMenuDisplayColModel()){t=$(t);var i=0;e||(e=window.event),e=e||{},i=e.wheelDelta,KD.isEmpty(e.wheelDelta)&&(i=-e.deltaY);var a=t.scrollLeft()-i;t.scrollLeft(a)}},_checkComponentHeight:function(){if(this.component){var e=0,t=this.getFormProxy(),i="100%";if(!t||t.dformConfig&&t.dformConfig.openstyle&&t.dformConfig.openstyle.ShowType==KDDynamicFormShowType.NewTabPage)e=KD.getWindowHeight()-KD.getBillHeadHeight();else{var a=t&&t.hostWindowProxy,n=a&&a.el&&a.el.childFormCt;e=n?n.height():this.controlHeight;var o=KD.getScrollBarHeight();i=kendo.format("calc(100% - {0}px)",o)}this.component.css({height:e+"px",width:i})}},doLayout:function(){this._checkComponentHeight(),KDConsoleRightMenuProxy.superclass.doLayout.call(this)},setRightPanelData:function(e){void 0==e&&(e=[]);var t=this;t.menuWidth=e.menuwidth?e.menuwidth:t.menuWidth,t.controlHeight=e.controlheight,t.isShowStar=e.isshowstar||!1,t._setGroupsNavigation(e);var i=this.baseId+"_headlink_c";t.el.find(".kd-consolerightmenu-accordionhead").find("#"+i)&&t.el.find(".kd-consolerightmenu-accordionhead").find("#"+i).focus()},setItemTipsContent:function(e){KD.isArray(e)&&(this.tipsArray=e)},_setGroupsNavigation:function(e){var t=this;if(this.consoleRightMenuGroups.empty(),null!=e&&null!=e.children){for(var i=0;i<e.children.length;i++)groupiteminfo=e.children[i],this.consoleRightMenuGroups.append(this._buildGroupItem(groupiteminfo,t));this.consoleRightMenuGroups.append($('<div class="kd_consolerightmenu_line"></div>'))}},_getButtonIdByCardId:function(e,t){var i="";return t=t||this.getFormProxy(),i=(t&&t.baseId)+"-"+(KD.isEmpty(e)?"":e)},_buildGroupItem:function(e,t){var i=this,a=$(kendo.format('<div id="{0}" class="kd_consolerightmenu_groupitem"></div>',e.id)),n=$(kendo.format('<div class="kd_consolerightmenu_groupitemtitle">{0}</div>',e.title)),o=$(kendo.format('<div class="kd_consolerightmenu_groupitemline"></div>')),r=$(kendo.format('<div class="kd_consolerightmenu_groupmenuitems"></div>')),s=this._isMenuDisplayColModel();1==s?(r=this.consoleRightMenuGroups,r.append(a.append(n)),i.menuWidth>0&&n.width(i.menuWidth)):(a.append(n),a.append(o),a.append(r)),this._initGroupEditBtn(e,n);var l,d,c,h=KD.getValue(e,"enableSubGroup",""),u=KD.equalsIgnoreCase(h+"","true");i.menuWidth>0&&(c=kendo.format("width: {0}px",i.menuWidth)),e.children=e.children||[],KD.isEmpty(e.children)&&a.addClass(this.emptyGroupStyleName);var p=this._getGroupEmptyTips(e);KD.isEmpty(p)||a.append($(p));for(var g=0;g<e.children.length;g++){d=e.children[g];var f=t&&t.getFormProxy(),m=i._getButtonIdByCardId(d.cardid,f),v=!d.startype||KD.isEmpty(d.startype)||KD.equalsIgnoreCase(d.startype,"none")?m+"-none_c":m+"-"+d.startype+"-"+d.commfunid+"_c",y=KD.isEmpty(d.catileicon)?"":d.catileicon,b=KD.getValue(d,"catiletext",""),D=KD.getValue(d,"catilebackcolor","#F99742"),k=KD.getValue(d,"catiletooltip",""),C=KD.getValue(d,"cardid",""),x=this.isShowStar?"":"kd_managesitemenu_star";d.shownormalicon===!1&&(x+=" kd_state_unstable");var w="",K="";if(KD.isEmpty(y)){if(!KD.isEmpty(b)){w=kendo.format("max-width: calc(100% - {0}px);",75);var S=kendo.format("background-color: {0}; ",D);y=kendo.format('<span class="kd_consolerightmenu_linkcatile" title="{0}" style =" {1}"><span class="kd-icon" style="border-top-color:{3};"></span ><span class="kd-text">{2}</span></span>',k,S,b,D)}}else{switch(y){case"trialed_1033.png":w="max-width:94px",K="69px";break;case"triallimt_1033.png":w="max-width:70px",K="93px";break;default:w="max-width:115px",K="48px"}var I=kendo.format("../images/biz/default/Common/{0}",y);y=kendo.format('<span style="width:{2}" class="kd_consolerightmenu_linkcatile" title="{0}"><img src="{1}"></span>',k,I,K)}var P=KD.format('<span data-role="checkbox" class="kd-treemenu-checkbox-container"><input type="checkbox" onclick="return false;" style="height:16px;display: inline-block;" class="k-checkbox"  checked="checked" ><label class="k-checkbox-label" for=":before" formid={0}></label></span>',d.cardid||"");l=$(kendo.format('<div id="{5}" class="kd_consolerightmenu_divlink" style="{12}" groupid="{13}" data-itemid="{14}">{11}<div class="kd_consolerightmenu_linkcontainer"><a id="{6}" class="kd_consolerightmenu_link" title="{1}" formid="{0}"><span class="kd_consolerightmenu_linkspan" style="{10}">{1}</span>{9}</a><a id="{7}" class="{2} {8}" title="{3}" formid="{0}" commfunid="{4}"></a></div></div>',KD.isEmpty(d.cardid)?"":d.cardid,KD.isEmpty(d.text)?"":d.text,!d.startype||KD.isEmpty(d.startype)||KD.equalsIgnoreCase(d.startype,"none")?"kd_menu_star":KD.equalsIgnoreCase(d.startype,"grey")?"kd_menu_greystar kd_menu_star":"kd_menu_redstar kd_menu_star",!d.startype||KD.isEmpty(d.startype)||KD.equalsIgnoreCase(d.startype,"none")?ResManager.LoadKDString("添加常用功能","014003030033828"):KD.equalsIgnoreCase(d.startype,"grey")?ResManager.LoadKDString("移动常用功能","014003030033826"):ResManager.LoadKDString("取消常用功能","014003030033827"),d.commfunid&&!KD.isEmpty(d.commfunid)?d.commfunid:"",m,m+"_c",v,x,y,w,P,c,e.id,C));for(var F=l.attr("data-itemid"),T=this.tipsArray,_=0;_<T.length;_++){var A=T[_],L=A.itemid;if(A.menu=d.text,L==F){var M=this.baseId+"-"+L+"-kdtooltip",E=this.getLineTipsDefConfig(M),B=this.getFormProxy(),R=B.createInnerControl(E);R.setIsOnlineTips.call(R,!0),R.setTipsData.call(R,A);var N=R.getLineTipsOptions(),H=l.find("a.kd_consolerightmenu_link");H.kendoKDTooltip(N);break}}var O=this._getSubGroupTemplate(d,u,r);KD.isEmpty(O)||r.append($(O)),r.append(l)}return r&&r.find("a.kd_consolerightmenu_link").unbind("click").bind("click",function(e){if(i.isEditModel()){var a=$(this).closest(".kd_consolerightmenu_divlink");return void a.children(".kd-treemenu-checkbox-container").find(".k-checkbox-label").click()}var n=t&&t.getFormProxy(),o=$(this).attr("formid");n&&n.fireEvent.call(n,"ButtonClick",o,"click")}),r&&r.find("a.kd_menu_star").unbind("click").bind("click",function(e){var i,a=t&&t.getFormProxy(),i=$(this).attr("formid"),n=$(this).attr("commfunid");i=$(this).attr("class").indexOf("kd_menu_redstar")>-1?"STARTREMOVEFORMCOMMUNFUN"+i+"COMMFUNID"+n:$(this).attr("class").indexOf("kd_menu_greystar")>-1?"STARTMIGRATEFROMCURCOMMUNFUN"+i+"COMMFUNID"+n:"STARTADDTOCOMMUNFUN"+i,a&&a.fireEvent.call(a,"ButtonClick",i,"click")}),this._isMenuDisplayColModel()&&(a=[]),a},_getGroupEmptyTips:function(e){var t="";e=e||{};var i=KD.getValue(e,"emptytips","");if(!KD.isEmpty(i)&&KD.isEmpty(e.children)){var a=this._isMenuDisplayColModel(),n="";1==a&&this.menuWidth>0&&(n+=kendo.format("width:{0}px;",this.menuWidth)),t=kendo.format('<div class="kd-emptytips-container" style="{0}"><div class="kd-text">{1}</div></div>',n,i)}return t},_getSubGroupTemplate:function(e,t,i){e=e||{};var a="";if(t){var n=e.subgroupid;if(this._isNeedSubGroup(n,i)){var o=e.subgroupname,r=this._isMenuDisplayColModel(),s="";1==r&&this.menuWidth>0&&(s+=kendo.format("width:{0}px;",this.menuWidth)),a=kendo.format('<div class="kd-console-menu-subgroup" id="{0}" style="{1}"><div class="kd-text">{2}</div></div>',n,s,o)}}return a},_isNeedSubGroup:function(e,t){var i=!1;if(e+="",!KD.isEmpty(e)){t=$(t||this.el);var a=t.find("#"+e);0==a.length&&(i=!0)}return i},_initGroupEditBtn:function(e,t){var i=this;e=e||{};var a=KD.getValue(e,"editBtn","");if(!KD.isEmpty(a)){t=$(t);var n=$(kendo.format('<div class="kd-console-group-btn">{0}</div>',a));t.append(n),n.click(function(e){var t=$(this),a=t.closest(".kd_consolerightmenu_groupitem"),n=a.attr("id"),o={id:n},r=i.getFormProxy();r&&r.fireCustomEvents.call(r,i.key,i.editGroupActionName,KD.stringify(o))})}},setMenuDisplayModel:function(e){this.menuDisplayModel=e;var t="";this._isMenuDisplayColModel()?(this.el.addClass(this.menuDisplayColModelStyleKey),t=ResManager.LoadKDString("竖向排版","0991733000006684")):(this.el.removeClass(this.menuDisplayColModelStyleKey),t=ResManager.LoadKDString("横向排版","0991733000003532")),this.changeDisplayModelBtn&&this.changeDisplayModelBtn.attr({title:t})},_isMenuDisplayColModel:function(){return this.menuDisplayModel==this.menuDisplayModelList.columnModel},release:function(){KDConsoleRightMenuProxy.superclass.release.call(this)}}),function(){$.extend(KDConsoleRightMenuProxy.prototype,{customSettingBtnKey:"FBtnCustomSetting",cancelCustomSettingBtnKey:"FBtnCancelCustomSetting",determineCustomSettingBtnKey:"FBtnDetermineCustomSetting",resetCustomSettingBtnKey:"FBtnResetCustomSetting",helpAssistantBtnKey:"FBtnHelpAssistant",updateValueAction:"UpdateValue",customVisibleStyleKey:"kd-state-hidden",customDisableStyleKey:"kd-state-disabled",editModelStyleKey:"kd-mainconsole-function-edit",menuDisplayColModelStyleKey:"kd-mainconsole-function-colmodel",changeMenuDisplayRowModelKey:"ChangeMenuDisplayRowModel",changeMenuDisplayColModelKey:"ChangeMenuDisplayColModel",changeMenuDisplayModelKey:"ChangeMenuDisplayModel",helpAssistantBtn:{},editModel:"",changeDisplayModelBtn:void 0,_initOperateAreaContainer:function(){var e=this,t=KD.getImageUrlByNameAndVersion("kd_icon_extend.png");this.operateAreaContainer=$('<div class="kd-consolerightmenu-operateArea-Container"><div class="kd-ui-masklayerDiv"></div></div>'),this.component.append(this.operateAreaContainer);var i="../images/silverlight/default/toolbar/system_menu_help.png?version="+KD.getVersion(),a=$(kendo.format('<div class="kd-consolerightmenu-btn-item helpAssistantVisibleBtn" title="{2}"><span class="kd-icon">&nbsp;</span><span class="kd-text">{1}</span></div>',i,"",ResManager.LoadKDString("打开帮助助手","002014000007325")));this.operateAreaContainer.append(a),this.helpAssistantBtn=a,a.click(function(t){var i=e.getFormProxy();i&&i.fireCustomEvents.call(i,e.key,e.helpAssistantBtnKey,null);var a={};a.opkey=e.key+".Kingdee.BOS.KDConsoleRightMenuProxy."+e.customSettingBtnKey,a.opname="菜单自定义可见性",i&&i.fireCustomEventsNoData.call(i,KD.CONST.CustomEventName.PutUserBehavior,KD.CONST.CustomEventName.PutUserBehavior,KD.stringify(a))});var n=$(kendo.format('<div  class="kd-consolerightmenu-btn-item cancelcustomVisibleBtn" style=";">{0}</div>',ResManager.LoadKDString("取消","0991733000003922")));this.operateAreaContainer.append(n),n.click(function(t){var i=e.getFormProxy();i&&i.fireCustomEvents.call(i,e.key,e.cancelCustomSettingBtnKey,null)});var o=$(kendo.format('<div  class="kd-consolerightmenu-btn-item resetcustomVisibleBtn" style=";">{0}</div>',ResManager.LoadKDString("恢复默认","0991733030032664")));this.operateAreaContainer.append(o),o.click(function(t){var i=e.getFormProxy();i&&i.fireCustomEvents.call(i,e.key,e.resetCustomSettingBtnKey,null)});var r=$(kendo.format('<div  class="kd-consolerightmenu-btn-item determinecustomVisibleBtn" style=;">{0}</div>',ResManager.LoadKDString("完成","0991733000006452")));this.operateAreaContainer.append(r),r.click(function(t){var i=e.getFormProxy();i&&i.fireCustomEvents.call(i,e.key,e.determineCustomSettingBtnKey,null);var a={};a.opkey=e.key+".Kingdee.BOS.KDConsoleRightMenuProxy."+e.determineCustomSettingBtnKey,a.opname="菜单自定义可见性->完成",i&&i.fireCustomEventsNoData.call(i,KD.CONST.CustomEventName.PutUserBehavior,KD.CONST.CustomEventName.PutUserBehavior,KD.stringify(a))});var s=$(kendo.format('<div  class="kd-consolerightmenu-btn-item customVisibleBtn" title="{2}"><span class="kd-icon" style="background-image:url({0});">&nbsp;</span><span class="kd-text">{1}</span></div>',t,"",ResManager.LoadKDString("个性化设置主控台菜单的显示/隐藏","0991733000005701")));this.operateAreaContainer.append(s),s.click(function(t){var i=e.getFormProxy();i&&i.fireCustomEvents.call(i,e.key,e.customSettingBtnKey,null);var a={};a.opkey=e.key+".Kingdee.BOS.KDConsoleRightMenuProxy."+e.customSettingBtnKey,a.opname="菜单自定义可见性",i&&i.fireCustomEventsNoData.call(i,KD.CONST.CustomEventName.PutUserBehavior,KD.CONST.CustomEventName.PutUserBehavior,KD.stringify(a))});var l=$(kendo.format('<div class="kd-consolerightmenu-spilt-line" role="customVisibleBtnLine"></div>'));this.operateAreaContainer.append(l);var d=$(kendo.format('<div  class="kd-consolerightmenu-btn-item kd-state-colmodel" title="{2}"><span class="kd-icon" style="background-image:url({0});">&nbsp;</span><span class="kd-text">{1}</span></div>',t,ResManager.LoadKDString("",""),ResManager.LoadKDString("横向排版","0991733000003532")));this.operateAreaContainer.append(d),d.click(function(t){var i=e.getFormProxy();i&&i.fireCustomEvents.call(i,e.key,e.changeMenuDisplayModelKey,null)}),this.changeDisplayModelBtn=d},setCustomFunctionAreaDisabed:function(e){this.operateAreaContainer&&(e?this.operateAreaContainer.addClass(this.customDisableStyleKey):this.operateAreaContainer.removeClass(this.customDisableStyleKey))},_bindActionEvent:function(){var e=this;e.component&&e.component.undelegate(".kd-treemenu-checkbox-container .k-checkbox-label","click").delegate(".kd-treemenu-checkbox-container .k-checkbox-label","click",function(t){var i=$(t.target),a=i.parent(),n=a.find("input.k-checkbox"),o=!n.is(":checked");n[getPropName()]("checked",o);var r=e.getFormProxy(),s="testgroupId",l=i.attr("formid"),d={formId:l,checked:o};r&&r.fireCustomEvents.call(r,e.key,e.updateValueAction,KD.stringify(d),s)})},setEditModelBtnVisible:function(e){var t=this;KD.delayInvoke(function(i){if(t.operateAreaContainer){var a=t.operateAreaContainer.find(".kd-consolerightmenu-btn-item.customVisibleBtn"),n=t.operateAreaContainer.find('.kd-consolerightmenu-spilt-line[role="customVisibleBtnLine"]');e?(a.removeClass(t.customVisibleStyleKey),n.css({display:"inline-block"})):(a.addClass(t.customVisibleStyleKey),n.css({display:"none"}))}})},isEditModel:function(){var e=1==this.editModel;return e},setEditModel:function(e){this.editModel=e,1==e?this.el.addClass(this.editModelStyleKey):this.el.removeClass(this.editModelStyleKey)},setConsoleMenuVisible:function(e){if(KD.isArray(e)){var t=this.component.find(".kd-consolerightmenu-accordion .kd_consolerightmenu_divlink");t.removeClass(this.customVisibleStyleKey);var i=this.component.find(".kd-consolerightmenu-accordion .kd_consolerightmenu_divlink .kd-treemenu-checkbox-container input.k-checkbox");i[getPropName()]("checked",!0);for(var a=0;a<e.length;a++){var n=e[a];if(n){var o=this._getButtonIdByCardId(n.formId),r=this.el.find("#"+o),s=0==n.checked?!1:!0;0==s?r.addClass(this.customVisibleStyleKey):r.removeClass(this.customVisibleStyleKey),r.find(".kd-treemenu-checkbox-container input.k-checkbox")[getPropName()]("checked",s)}}this._synMenuGroupVisisble()}},_synMenuGroupVisisble:function(){for(var e,t=this.el.find(".kd_consolerightmenu_groupitem "),i=!0,a=0;a<t.length;a++){if(e=$(t[a]),this._isMenuDisplayColModel()){var n=e.attr("id"),o=this.el.find(kendo.format('.kd_consolerightmenu_divlink[groupid="{0}"]:not(.kd-state-hidden)',n));i=o.length>0?!0:!1}else{var r=e.find(".kd_consolerightmenu_groupmenuitems");i=r.length>0&&r.height()<=4?!1:!0}var s=e.hasClass(this.emptyGroupStyleName);i||s?e.removeClass(this.customVisibleStyleKey):e.addClass(this.customVisibleStyleKey)}},setCustomHelpAssistantBtnStyle:function(e){var t=this;if(KD.isObject(e)){var i=e.visible,a=e.icon?e.icon:"images/silverlight/default/toolbar/system_menu_help.png",n=e.hoveicon?e.hoveicon:"images/silverlight/default/toolbar/system_menu_helpHove.png";
if(0==i)1==this.helpAssistantBtn.is(":visible")&&this.helpAssistantBtn.hide();else if(1==i){0==this.helpAssistantBtn.is(":visible")&&this.helpAssistantBtn.show().css("display","inline-block");var o=ClientAppProxy.Current.getMainTab();o.AllowHelpAssistant=!0}var a=e.icon?e.icon:"images/silverlight/default/toolbar/system_menu_help.png",n=e.hoveicon?e.hoveicon:"images/silverlight/default/toolbar/system_menu_helpHove.png";if(a){var r=this.helpAssistantBtn.children(".kd-icon");r.css("background-image","url(../"+a+"?version="+KD.getVersion()+")")}this.helpAssistantBtn.off("mouseenter").on("mouseenter",function(e){t.changeHelpBtnIconEvent(e,n)}),this.helpAssistantBtn.off("mouseleave").on("mouseleave",function(e){t.changeHelpBtnIconEvent(e,a)})}},changeHelpBtnIconEvent:function(e,t){var i=$(e.currentTarget).children(".kd-icon");i.css({"background-image":"url(../"+t+"?version="+KD.getVersion()+")"})},beginTwinkle:function(e,t){if(!KD.isNaN(parseFloat(t))&&0!=parseFloat(t)){var i=this.helpAssistantBtn&&this.helpAssistantBtn.find("span.kd-icon");!e||KD.isString(e)&&"FALSE"===e.toUpperCase()?i.removeClass("kd-messagering-animate"):(i.addClass("kd-messagering-animate"),t=1e3*parseFloat(t),KD.delayInvoke(function(){i.removeClass("kd-messagering-animate")},t))}}})}(),KDControlFactoryProxy.registerType("kdconsolerightmenu",KDConsoleRightMenuProxy),define("KDConsoleRightMenuProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDConsoleRightMenuProxy}}(this));var K3Combine={ua:navigator.userAgent,invokePlugin:function(e){/MSIE([^;]+)/.test(this.ua)?this.invokeIEPlugin(e):this.invokeOtherPlugin(e)},invokeIEPlugin:function(e){var t=document.all("k3cloudhubContainer");if(void 0!=t&&null!=t){var i;if(i=document.getElementById("mmx"),(void 0==i||null==i)&&(i=document.createElement("object"),i.id="mmx",i.classid="clsid:C8E0F40F-8F1F-492A-A121-8BC9133E0E7D",i.style.position="absolute",i.style.zIndex=-1100,i.style.visibility="hidden",i.style.width="0px",i.style.height="0px",i.style.left="0px",i.style.top="0px",t.appendChild(i)),null==i.object)confirm(ResManager.LoadKDString("未安装云之家客户端，是否先下载最新客户端并安装?\n下载安装后需关闭浏览器重新登录系统方可使用。","0991733000004001"))&&window.open("http://www.kdweibo.com/res/client/desktop/CloudHubSetup.exe");else{var a=e;a.indexOf("?")<0&&(a="KdCloudHub://start/open/close/?"+a),i.OpenURL(a)}}},invokeOtherPlugin:function(e){var t=!1,i=!1,a=document.all("k3cloudhubContainer");if(void 0!=a&&null!=a){var n;n=document.all("pluginIdXX"),(void 0==n||null==n)&&(n=document.createElement("embed"),n.id="pluginIdXX",n.width="0",n.height="0",n.type="application/npkdcldhub",a.appendChild(n));for(var o=navigator.plugins.length-1;o>=0;o--)if("npKdCldHub.dll"==navigator.plugins[o].filename){if(n.OpenURL){var r=e;r.indexOf("?")<0&&(r="KdCloudHub://start/open/close/?"+r),n.OpenURL(r),i=!0}else alert(ResManager.LoadKDString("请允许浏览器运行该插件并刷新页面！","0991733000004002"));return void(t=!0)}t||confirm(ResManager.LoadKDString("未安装云之家客户端，是否先下载最新客户端并安装?\n下载安装后需关闭浏览器重新登录系统方可使用。","0991733000004001"))&&window.open("http://www.kdweibo.com/res/client/desktop/CloudHubSetup.exe")}}};define("KDCloudHub",function(){}),function(e){colVisibleHandler=function(t,i,a,n,o,r){if(a&&e.isFunction(a.isVisible)){var s=a.isVisible();if(o[t]==s)return}var l=i.store;i.setColVisible.call(i,a,o[t]);var d=a.getFieldName();if(r){var c=!1;if(o[t]&&i.getKendoGrid()&&i.getKendoGrid().columns&&i.getKendoGrid().columns.length>0){for(var h=!1,u=0;u<i.getKendoGrid().columns.length;u++){var a=i.getKendoGrid().columns[u];if(a.field==d){h=!0;break}}c=!h}l&&l.updateView&&0==c&&(c=!0),l&&l.setUpdateView.call(l,c),r.call(i,{key:t,colKey:d,rowData:n,updateView:c,updateColHide:!0})}},cellValueHandler=function(t,i,a,n,o,r){var s=(i.store,a.getFieldName());if(n){var l=n&&n.rowId;a.setSvrValue.call(a,l,o[t]),a.getDimensionValue(e.KDGridActionKeys.HasError,l)&&!e.isEmpty(o[t])&&a.setHasError.call(a,n,!1),i.addCellChange.call(i,a,n),r&&!i.isInit&&r.call(i,{key:t,colKey:s,rowData:n,updateView:!0})}},colWidthHandler=function(e,t,i,a,n,o){var r=t.store,s=i.getFieldName();i.setWidth(n[e]);t.setGridOptions.call(t,{columns:{field:s,width:i.width}});o&&(r&&r.setUpdateView.call(r,!0),o.call(t,{key:e,colKey:s,rowData:a,updateView:!0}))},fireUpdateHandler=function(e,t,i,a,n,o){t.store;i.setFireUpdate.call(i,n[e])},mustInputHandler=function(e,t,i,a,n,o){var r=t.store,s=n[e];if("boolean"==typeof s)i.setMustInput.call(i,s);else for(var l in s)if(-1==parseInt(l))i.setMustInput.call(i,s[l]);else{var d=r.getColumnDescriptor(l);d&&d.setMustInput.call(d,s[l])}r&&r.setUpdateView.call(r,!0)},xColDspCtrlTypeHandler=function(e,t,i,a,n,o){var r=(t.store,i.getFieldName());i.setXColDspCtrlType.call(i,n[e]),t.addCellChange.call(t,i,a),o&&!t.isInit&&o.call(t,{key:e,colKey:r,rowData:a,updateView:!0})},isRedBlueHandler=function(e,t,i,a,n,o){var r=t.store,s=i.getFieldName();r.isRedBlue=n[e],i.setIsRedBlue.call(i,n[e]),o&&!t.isInit&&o.call(t,{key:e,colKey:s,rowData:a,updateView:!0})},allowAutoListHandler=function(e,t,i,a,n,o){t.store;i.setAllowAutoList.call(i,n[e])},isLocatedFirstRowHandler=function(e,t,i,a,n,o){t.store;i.setIsLocatedFirstRow&&i.setIsLocatedFirstRow.call(i,n[e])},showEditButtonHandler=function(e,t,i,a,n,o){t.store;i.setShowEditButton.call(i,n[e])},colHeaderHandler=function(e,t,i,a,n,o){var r=t.store,s=i.getFieldName();i.setCaption.call(i,n[e]);t.setGridOptions.call(t,{columns:{field:s,title:i.header}});o&&(r&&r.setUpdateView.call(r,!0),o.call(t,{key:e,colKey:s,rowData:a,updateView:!0}))},colHeaderAlignmentHandler=function(e,t,i,a,n,o){var r=t.store,s=i.getFieldName.call(i);i.setHeaderAlignment.call(i,n[e]);t.setGridOptions.call(t,{columns:{field:s,headerAttributes:i.getHeaderAttributes.call(i)}});o&&(r&&r.setUpdateView.call(r,!1),o.call(t,{key:e,colKey:s,rowData:a,updateView:!1}))},storeHandler=function(e,t,i,a,n,o){var r=(t.store,i.getFieldName());i.setStore(n[e]),o&&!t.isInit&&o.call(t,{key:e,colKey:r,rowData:a,updateView:!0})},menuStateHandler=function(e,t,i,a,n,o){var r=(t.store,i.getFieldName());i.setStore(n[e]);var s=n[e];o&&!t.isInit&&o.call(t,{key:e,colKey:r,rowData:a,data:s,updateView:!1})},focusedStateHandler=function(e,t,i,a,n,o){var r=(t.store,i.getFieldName()),s=n[e];s=n.FocusRowIndex,s=n.MoveFirstRowIndex,s=n.MovePreviousRowIndex,s=n.MoveNextRowIndex,s=n.MoveLastRowIndex,s=void 0===s?-1:s,o&&o.call(t,{key:e,colKey:r,rowData:a,data:s,updateView:!1})},colorHandler=function(t,i,a,n,o,r){var s=(t==e.KDGridActionKeys.Backcolor?"background":"color",i.store),l=n&&n.rowId,d=a&&a.getFieldName(),c=o[t]||"transparent";if("string"==typeof c)updateCellProp(t,a,n,o),i.addCellChange.call(i,a,n);else for(var h in c){var u=c[h],p=u,g=a;if(!g){var f=s.getIndexKey.call(s);g=s.getColumnDescriptor.call(s,f)}if(l=parseInt(h),g&&l>=0){d=g.getFieldName();var m=s.getRowDataByServerRowId.call(s,l);i.addCellChange.call(i,a,m)}else if(0>l){l=s.getRowId(n),i.addCellChange.call(i,null,n);continue}updateCellProp(t,g,m,u)}r&&!i.isInit&&r.call(i,{key:t,colKey:d,rowData:n,data:p,updateView:!0})},IsMk=function(e,t,i,a,n,o){i&&i.setIsMk&&i.setIsMk.call(i,n[e])},MkModel=function(e,t,i,a,n,o){i&&i.setMkModel&&i.setMkModel.call(i,a,n[e]),o&&o.call(t,{key:e,rowData:a})},MkVal=function(e,t,i,a,n,o){i&&i.setMkVal&&i.setMkVal.call(i,a,n[e])},cellDisabledHandler=function(t,i,a,n,o,r){var s=i.store,l=a.getFieldName.call(a);if(!o||l==(o.key||"").toUpperCase()){var d=o[t];if(e.isObject(d)){var c=d["true"]||[],h=d["false"]||[];for(var u in c){var p=s.getRowDataByServerRowId.call(s,c[u]),g={row:c[u],key:l};g[e.KDGridActionKeys.Disabled]=!0,cellDisabledHandler(t,i,a,p,g,r)}for(var u in h){var p=s.getRowDataByServerRowId.call(s,h[u]),g={row:h[u],key:l};g[e.KDGridActionKeys.Disabled]=!1,cellDisabledHandler(t,i,a,p,g,r)}}else{if(t==e.KDGridActionKeys.Disabled){i.disableActions=i.disableActions||[];var f={row:o.row,key:o.key};f[e.KDGridActionKeys.Undisabled]=!d,i.disableActions.push(f)}n?updateCellProp(t,a,n,o):(a.setDisabled.call(a,n,d),updateCellProp(t,a,void 0,o)),r&&!i.isInit&&r.call(i,{key:t,colKey:l,rowData:n,updateView:!0})}}},cellUnDisabledHandler=function(e,t,i,a,n,o){var r=(t.store,i?i.getFieldName():void 0);if(r){var s=n[e];a?updateCellProp(e,i,a,n):(i.setUndisabled.call(i,a,s),updateCellProp(e,i,void 0,n)),o&&!t.isInit&&o.call(t,{key:e,colKey:r,rowData:a,updateView:!0})}},cellReadOnlyHandler=function(e,t,i,a,n,o){var r=(t.store,n[e]);a?updateCellProp(e,i,a,n):(i.setReadonly.call(i,a,r),updateCellProp(e,i,void 0,n))},cellHasErrorHandler=function(e,t,i,a,n,o){var r=n[e];a?updateCellProp(e,i,a,n):(i.setHasError.call(i,a,r),updateCellProp(e,i,void 0,n))},cellSplitPatternHandler=function(e,t,i,a,n,o){i&&i.setSplitPattern&&i.setSplitPattern.call(i,n[e])},headertooltipHandler=function(e,t,i,a,n,o){i&&i.setHeaderToolTip&&i.setHeaderToolTip.call(i,n[e])},tooltipEnabledHandler=function(t,i,a,n,o,r){if(!n){var s=o[t],l=!1;e.isObject(s)?l=e.getValue(s,"-1",!1):void 0!==o[t]&&(l=o[t]),a.tooltipEnabled(l),r&&!i.isInit&&r.call(i,{key:t,colKey:colKey,rowData:n,updateView:!0})}},tooltipIndicatorEnabledHandler=function(t,i,a,n,o,r){if(!n){var s=o[t],l=!1;e.isObject(s)?l=e.getValue(s,"-1",!1):void 0!==o[t]&&(l=o[t]),a.tooltipIndicatorEnabled(l),r&&!i.isInit&&r.call(i,{key:t,colKey:colKey,rowData:n,updateView:!0})}},tooltipHandler=function(t,i,a,n,o,r){var s=!1,l=i.store;if(n){var d=e.getValue(o,t,{});if(!e.isEmpty(d)){s=!0;var c={};for(var h in d){var u=parseInt(h);c[u]=u;var p=l.getRowDataByServerRowId.call(l,u);updateCellProp(t,a,p,o)}r&&!i.isInit&&r.call(i,{key:t,colKey:colKey,rowData:n,updateView:!0})}}else void 0!==o[t]&&(s=!0,updateCellProp(t,a,n,o),r&&!i.isInit&&r.call(i,{key:t,colKey:colKey,rowData:n,updateView:!0}))},cellHiddenHandler=function(t,i,a,n,o,r){var s=!1,l=i.store;if(n){var d=e.getValue(o,t,{});if(!e.isEmpty(d)){s=!0;var c={};for(var h in d){var u=parseInt(h);c[u]=u;var p=l.getRowDataByServerRowId.call(l,u);updateCellProp(t,a,p,o)}r&&!i.isInit&&r.call(i,{key:t,colKey:colKey,rowData:n,updateView:!0})}}else void 0!==o[t]&&(s=!0,updateCellProp(t,a,n,o),r&&!i.isInit&&r.call(i,{key:t,colKey:colKey,rowData:n,updateView:!0}))},updateCellProp=function(t,i,a,n){var o=!1,r=e.isObject(n)?n[t]:void 0==n?void 0:n;if(void 0!==r){o=!0;var s="set"+t.substr(0,1).toUpperCase()+t.substr(1,t.length-1);i&&$.isFunction(i[s])?i[s].call(i,a,r):e.writeLog("updateCellProp Error","method="+s,!0)}return o},propHandler=function(e,t,i,a,n,o){var r=(t.store,i.getFieldName());n[e],updateCellProp(e,i,a,n);o&&!t.isInit&&o.call(t,{key:e,colKey:r,rowData:a,updateView:!0})},cellDecimalHandler=function(e,t,i,a,n,o){var r=(t.store,i.getFieldName());n[e];ret=updateCellProp("decimalPrecision",i,a,n);var s=s||ret;ret=updateCellProp("decimalIntLength",i,a,n),s=s||ret,ret=updateCellProp("maxValue",i,a,n),s=s||ret,ret=updateCellProp("minValue",i,a,n),s=s||ret,t.addCellChange.call(t,i,a),o&&!t.isInit&&o.call(t,{key:e,colKey:r,rowData:a,updateView:!0})},lookupHandler=function(e,t,i,a,n,o){t.store;i.setLookup.call(i,n[e])},exAndUrlHandler=function(e,t,i,a,n,o){t.store;i.setExAndUrl.call(i,n[e])},UpUrlHandler=function(e,t,i,a,n,o){t.store;i.setUpUrl.call(i,n[e])},exDownloadUrlHandler=function(e,t,i,a,n,o){t.store;i.setExDownloadUrl.call(i,n[e])},isCanDownlandHandler=function(e,t,i,a,n,o){t.store;i.setExCanDownland&&i.setExCanDownland.call(i,n[e])},function(e){e.KDGridActionKeys=e.KDGridActionKeys||{},$.extend(e.KDGridActionKeys,{BarItemStates:"barItemStates",SetFocusRowIndex:"SetFocusRowIndex",ColVisible:"visible",Disabled:"disabled",Undisabled:"undisabled",ColValue:"value",Forecolor:"forecolor",Backcolor:"backcolor",IsMk:"IsMk",MkModel:"MkModel",MkVal:"MkVal",FocusRowIndex:"FocusRowIndex",IsRedBlue:"isRedBlue",AllowAutoList:"AllowAutoList",IsLocatedFirstRow:"IsLocatedFirstRow",NumFmtInfo:"NumFmtInfo",xColDspCtrlType:"xColDspCtrlType",Mask:"mask",Lookup:"lookup",CellHidden:"CellHidden",Width:"width",DecimalPrecision:"decimalPrecision",DecimalIntLength:"decimalIntLength",MaxValue:"maxValue",MinValue:"minValue",Store:"store",Caption:"caption",Header:"header",HeaderAlignment:"headeralignment",Fontbold:"fontbold",ShowEditButton:"showEditButton",FireUpdate:"fireUpdate",MustInput:"mustInput",mustinput:"mustinput",TooltipEnabled:"tooltipenabled",TooltipIndicatorEnabled:"tooltipindicatorenabled",Tooltip:"Tooltip",ExAndUrl:"extandurl",ExDownloadUrl:"exdownloadurl",IsCanDownland:"iscandownland",UpUrl:"upurl",ReadOnly:"readonly",HasError:"hasError",SplitPattern:"splitPattern",Headertooltip:"headertooltip"})}(e),function(e){if(e.KDGridCellStateHandler=e.KDGridCellStateHandler||{getCellStateHandler:function(e){var t=this._handlers[e];return t},doHandler:function(e,t,i,a,n){for(var o in a){a[o];this.doIt(o,e,t,i,a,n)}if(null==t)for(var o in this._wholeRowHandlerKeys)this.doIt(o,e,t,i,a,n)},doIt:function(t,i,a,n,o,r){var s=this._handlers[t];if(s)try{s(t,i,a,n,o,r)}catch(l){e.writeError(l);var d=a?a.dataIndex+","+a.header+(a.editor?","+a.editor.xtype:""):"";e.Error.raise({sourceClass:"KDKendoGridProxy_CellState",sourceMethod:"doIt("+t+")<br>target:"+d+"<br>",name:ResManager.LoadKDString("执行表格Action错误","0991733000003936"),msg:l.message+"<p>"+l.stack+"<p>"+e.obj2str(o)})}}},!e.KDGridCellStateHandler._wholeRowHandlerKeys){var t=[];e.KDGridCellStateHandler._wholeRowHandlerKeys=t,t.push(e.KDGridActionKeys.Backcolor),t.push(e.KDGridActionKeys.Forecolor),t.push(e.KDGridActionKeys.FocusRowIndex)}if(!e.KDGridCellStateHandler._handlers){var i={};e.KDGridCellStateHandler._handlers=i,i[e.KDGridActionKeys.ColValue]=cellValueHandler,i[e.KDGridActionKeys.Width]=colWidthHandler,i[e.KDGridActionKeys.ColVisible]=colVisibleHandler,i[e.KDGridActionKeys.Store]=storeHandler,i[e.KDGridActionKeys.BarItemStates]=menuStateHandler,i[e.KDGridActionKeys.Caption]=colHeaderHandler,i[e.KDGridActionKeys.Header]=colHeaderHandler,i[e.KDGridActionKeys.HeaderAlignment]=colHeaderAlignmentHandler,i[e.KDGridActionKeys.FocusRowIndex]=focusedStateHandler,i[e.KDGridActionKeys.SetFocusRowIndex]=focusedStateHandler,i[e.KDGridActionKeys.FireUpdate]=fireUpdateHandler,i[e.KDGridActionKeys.MustInput]=mustInputHandler,i[e.KDGridActionKeys.mustinput]=mustInputHandler,i[e.KDGridActionKeys.xColDspCtrlType]=xColDspCtrlTypeHandler,i[e.KDGridActionKeys.IsRedBlue]=isRedBlueHandler,i[e.KDGridActionKeys.AllowAutoList]=allowAutoListHandler,i[e.KDGridActionKeys.IsLocatedFirstRow]=isLocatedFirstRowHandler,i[e.KDGridActionKeys.ShowEditButton]=showEditButtonHandler,i[e.KDGridActionKeys.Forecolor]=colorHandler,i[e.KDGridActionKeys.Backcolor]=colorHandler,i[e.KDGridActionKeys.IsMk]=IsMk,i[e.KDGridActionKeys.MkModel]=MkModel,i[e.KDGridActionKeys.MkVal]=MkVal,i[e.KDGridActionKeys.Disabled]=cellDisabledHandler,i[e.KDGridActionKeys.Undisabled]=cellUnDisabledHandler,i[e.KDGridActionKeys.DecimalPrecision]=cellDecimalHandler,i[e.KDGridActionKeys.DecimalIntLength]=cellDecimalHandler,i[e.KDGridActionKeys.MaxValue]=cellDecimalHandler,i[e.KDGridActionKeys.MinValue]=cellDecimalHandler,i[e.KDGridActionKeys.Fontbold]=propHandler,i[e.KDGridActionKeys.Tooltip]=tooltipHandler,i[e.KDGridActionKeys.TooltipEnabled]=tooltipEnabledHandler,i[e.KDGridActionKeys.TooltipIndicatorEnabled]=tooltipIndicatorEnabledHandler,i[e.KDGridActionKeys.CellHidden]=cellHiddenHandler,i[e.KDGridActionKeys.Mask]=propHandler,i[e.KDGridActionKeys.NumFmtInfo]=propHandler,i[e.KDGridActionKeys.Lookup]=lookupHandler,i[e.KDGridActionKeys.ExAndUrl]=exAndUrlHandler,i[e.KDGridActionKeys.ExDownloadUrl]=exDownloadUrlHandler,i[e.KDGridActionKeys.IsCanDownland]=isCanDownlandHandler,i[e.KDGridActionKeys.UpUrl]=UpUrlHandler,i[e.KDGridActionKeys.ReadOnly]=cellReadOnlyHandler,i[e.KDGridActionKeys.HasError]=cellHasErrorHandler,i[e.KDGridActionKeys.SplitPattern]=cellSplitPatternHandler,i[e.KDGridActionKeys.Headertooltip]=headertooltipHandler}}(e)}(KD),define("KDKendoGridProxy_CellState",["KDKendoGridProxy","KD"],function(e){return function(){var t;return t||e.KDKendoGridProxy_CellState}}(this)),define("KDKendoGridProxy_CellEditor",["KDKendoGridProxy","KD"],function(e){return function(){var t;return t||e.KDKendoGridProxy_CellEditor}}(this)),function(){KDGridSelOpStrategy=function(){},KDGridSelOpStrategy.getOpStratege=function(e){var t=e,i=t.config,a=void 0;return a="kdgrid"==i.xtype&&e.isViewGrid.call(e)?t.isMultiSelectMode.call(t)?new KDViewGridSelOp:new KDViewGridSingleSelOp:"kdgrid"==i.xtype?t.isMultiSelectMode.call(t)?new KDEditGridSelOp:new KDEditGridSingleSelOp:"kdtreegrid"==i.xtype?new KDTreeListSelOp:"kdbatchfilter"==i.xtype?new KDEditGridSelOp:new KDGridSelOpStrategy,a&&(a.setOwnerProxy(e),a.loadConfig(i)),a},KDGridSelOpStrategy.prototype={},function(e){$.extend(e.prototype,{aTitle:"KDGridSelOpStrategy",ownerProxy:void 0,_isFirstLoad:!1,_defFocusedRowId:-1,_lastFocusedRowId:-1,_focusedRowId:-1,_isCellChanged:!1,_lastFocusedFieldName:"",_focusedFieldName:"",_lastSelectedRowIds:"",_selectedRowIds:"",setOwnerProxy:function(e){this.ownerProxy=e},cellChangedFlag:function(){return this._isCellChanged},beginCellChanged:function(){this._isCellChanged=!0},endCellChanged:function(){this._isCellChanged=!1},loadConfig:function(e){this.config=e,this.config.FireCellSelectChangeEvent=1==KD.getValue(this.config,"FireCellFocuedEvent",0)?!0:!1},isDefSelected:function(e){return void 0!==e&&(this.config.IsDefaultSelected=e),this.config.IsDefaultSelected},isCellSelectChangeEvent:function(e){return void 0!==e&&(this.config.FireCellSelectChangeEvent=e?!0:!1),this.config.FireCellSelectChangeEvent},isFireCellFocuedEvent:function(){return this.config.FireCellSelectChangeEvent},isViewGrid:function(){return this.config&&"VIEWGRID"==this.config.gridtype},isMultiSelectMode:function(){var e=!1,t=this,i=t.config,a=void 0===i.IsListMultiSel?!t.isEditable():i.IsListMultiSel;return e=t.isViewGrid()?t.isSelColEnable()&&a:a},isSingleSelectMode:function(){return!this.isMultiSelectMode()},isSelColEnable:function(){return this.config&&!!this.config.enableSelCol||this.isViewGrid()},isFlowViewList:function(){return this.isViewGrid()&&(KDFlowlayoutProxy.isInVertical(this.config)||KDFlowlayoutProxy.isInColumn(this.config))},isFlowEditGrid:function(){return this.isEditable()&&KDFlowlayoutProxy.isFlowlayoutChild(this.config)},isEditable:function(){var e=this.isViewGrid();return e?!e:KD.getValue(this.config,"editable",!0)},isRowSelChanged:function(){return(this._lastFocusedRowId!=this._focusedRowId||this._lastSelectedRowIds!=this._selectedRowIds)&&!this.cellChangedFlag()},isColSelChanged:function(){return this._lastFocusedFieldName!=this._focusedFieldName},isCellChanged:function(){return this.cellChangedFlag()&&(this._lastFocusedRowId!=this._focusedRowId||this._lastSelectedRowIds!=this._selectedRowIds)||this.isColSelChanged()},isLastCell:function(e){return e.rowId==this._lastFocusedRowId&&e.field==this._lastFocusedFieldName},isUserCurrentPara:function(e){return"current"==e},isHeaderCheckAll:function(e){return e&&KDStore.isColSelector(e.field)&&e.rowId==KDStore.C_HeadCheckAllRowId},_setSelectedRowIds:function(e,t){this._selectedRowIds=t;var i=parseInt(KD.stringify(e).split(",")[0]||"-1");this._focusedRowId=isNaN(i)?-1:i},__arr2str:function(e){return KD.stringify(e||[]).replace(/[\[\]\s]/g,"")},__str2arr:function(e,t){e=KD.isString(e)?e.replace(/\s/g,""):"";var i=[],a=""==e?[]:e.split(",");for(var n in a){var o=parseInt(a[n]);isNaN(o)||i.push(o)}if(void 0!==t){var r=parseInt(t);!isNaN(r)&&i.indexOf(r)<0&&i.splice(0,0,r)}return i},getFocusedRowId:function(){var e=KD.isString(this._focusedRowId)?parseInt(this._focusedRowId):this._focusedRowId;return e},getSelectedRowIds:function(){return this._selectedRowIds||""},isSelectedRow:function(e){var t=this.getSelectedRowIdArray();return t.indexOf(e)>=0},getSelectedRowIdArray:function(){return this.__str2arr(this.getSelectedRowIds())},getSelectedRows:function(){var e=this,t=e.ownerProxy;if(!t.rendered)return[];for(var i=t.getStore.call(t),a=e.getSelectedRowIds()+"",n=a.split(","),o=0;o<n.length;o++)(isNaN(parseInt(n[o]))||i.getRowIndexByServerRowId.call(i,n[o])<0)&&(n.splice(o,1),o--);return n},_checkRowId:function(e){return void 0===e?-1:e},setFirstLoad:function(){this._isFirstLoad=!0},resetFirstLoad:function(){this._isFirstLoad=!1},isFirstLoad:function(){return 1==this._isFirstLoad},isNeedRefreshOwner:function(e){var t=this,i=10,a=3,n=t.ownerProxy.getStore.call(t.ownerProxy),o=n.rows.length>i||(KD.isArray(e)?e.length>a:!1);return o}})}(KDGridSelOpStrategy),function(e){$.extend(e.prototype,{initConfigSelected:function(e){this.reset(),this.isDefSelected(KD.getValue(e,"allowdefaultselected",!0))},initDataSelected:function(e){},svrCmdSelectedChanged:function(e){var t=this,i=t.ownerProxy.getStore.call(t.ownerProxy),a=i.selColDescriptor;if(!t.isUserCurrentPara(e)){var n=t.__str2arr(e),o=e,r=void 0===n[0]?-1:n[0];t._setSelectedRowIds(r,o)}(t.isDefSelected()||!t.isFirstLoad())&&(t.syncSel2UI(),t.syncColHeadValue()),t.isFirstLoad()&&($.extend(t,{_lastFocusedRowId:-1,_lastFocusedFieldName:"",_lastSelectedRowIds:""}),t.fireRowChanged({rowId:t._focusedRowId,field:t._focusedFieldName}),t.resetFirstLoad(),a&&a.isInit.call(a,!1))},syncColHeadValue:function(){var e=this,t=e.ownerProxy.getStore.call(e.ownerProxy);t&&t.syncColHeadValue&&t.syncColHeadValue.call(t)},syncSel2UI:function(){var e=this,t=e.ownerProxy;t.isInit=!0;var i=sels=this.__str2arr(e._selectedRowIds||"",e._focusedRowId||0);for(var a in i)t.setSelection.call(t,i[a]);t.isInit=!1},clearUISelection:function(e){var t=this,i=t.ownerProxy,a=i.getStore.call(i),n=a.selColDescriptor,o=i.getKendoGrid.call(i);i.isInit=!0,o&&o.clearSelection&&o.clearSelection(),n&&n.unselected&&n.unselected.call(n,{sender:o,isForceClear:e}),n&&n.selectedMaps&&(n.selectedMaps={}),$.extend(t,{_lastSelectedRowIds:"",_selectedRowIds:"",_lastFocusedRowId:0,_focusedRowId:0}),i.isInit=!1},syncUI2Sel:function(e){var t=this,i=e.rowId;if(-1!=i){var a=t.ownerProxy.getKendoGrid.call(t.ownerProxy),n=t.ownerProxy.getStore.call(t.ownerProxy),o=n.selColDescriptor,r=a?a.select():[],s=KD.isEmpty(r)||void 0===r||0==r.length?[i]:s||[],l=e.field,d=t.getLocalConfiguration()||{},c=this.ownerProxy.isIgnoreLocalColReset,h=!0;t.isViewGrid()&&(!d.DisabledColReset&&c?h=!1:d.DisabledColReset&&c?h=!1:!d.DisabledColReset||c&&void 0!=c||(h=!1),(d.DisabledColReset||!h)&&(l="SELECTED"));var u=KDStore.isColSelector(l);if(u&&(s=n.getSelectedIds.call(n)),!KD.isEmpty(r))for(var p=0;p<r.length;p++){var g=a.dataItem(r[p]),f=g&&void 0!==g.rowId?g.rowId:"";h||"SELECTED"==e.field?(u?f!=i:!0)&&s.indexOf(f)<0&&s.push(f):$.inArray(f,s)>-1?s.splice(s.indexOf(f),1):s.push(f)}if(o){var m=t.isNeedRefreshOwner(s);h&&o.unselected.call(o,{sender:a}),o.beginBatchUpdate.call(o),o.needRefreshOwner.call(o,m),o.setSelectState.call(o,{sender:a},s),o.endBatchUpdate.call(o,{},!0)}return t.__arr2str(s)}},reset:function(){this.resetFirstLoad(),$.extend(this,{_defFocusedRowId:-1,_lastFocusedRowId:-1,_focusedRowId:-1,_lastFocusedFieldName:"",_focusedFieldName:"",_lastSelectedRowIds:"",_selectedRowIds:""})},fireRowChanged:function(e){var t=this,i=e.rowId,a=e.field,n="";if(t.endCellChanged(),void 0===i)return t._lastSelectedRowIds;if(n=t.isFirstLoad()?t.getSelectedRowIds():e.noSync?i+"":t.syncUI2Sel(e),0>i&&(i=t._lastFocusedRowId),t._setSelectedRowIds(i,n),!t.isRowSelChanged())return t._lastSelectedRowIds;$.extend(t,{_lastSelectedRowIds:n,_selectedRowIds:n,_lastFocusedRowId:t._focusedRowId,_lastFocusedFieldName:a||"",_focusedFieldName:a||""});var o=i,r=t.ownerProxy.getKey.call(t.ownerProxy),s=t.ownerProxy.getFormProxy.call(t.ownerProxy),l={frm:s,onwerKey:r,fieldName:a,cellData:e,svrRowId:o};return KD.delayInvoke(function(e){if(!KD.isEmpty(e)){var i=e.frm,a=e.onwerKey,n=e.fieldName,o=e.cellData,r=e.svrRowId;i&&(i.commitDataBeforeGridRowChanged&&i.commitDataBeforeGridRowChanged.call(i,a,n),KD.getValue(o,"isSyncSvrEvent",!1)?i.fireSyncEvent.call(i,"EntityRowClick",a,t._checkRowId(r)):i.fireEvent.call(i,"EntityRowClick",a,t._checkRowId(r)))}},20,!1,l),t.getSelectedRowIds()},fireCellChanged:function(e){var t=this,i=t.ownerProxy,a=e.rowId,n=e.field;if(t._focusedFieldName=n||"",t.beginCellChanged(),0>a&&(a=t._lastFocusedRowId),t.isFireCellFocuedEvent()&&null!=a&&(e.forceFire||t.isCellChanged()||a!=t._lastFocusedRowId)){var o=t.ownerProxy.getKey.call(t.ownerProxy),r=t.ownerProxy.getFormProxy.call(t.ownerProxy),s={frm:r,onwerKey:o,rowId:a,lastFldName:t._lastFocusedFieldName||"",lastRowId:void 0==t._lastFocusedRowId?-1:t._lastFocusedRowId,sendFieldName:n||i.getFirstVisColName.call(i)||""};KD.delayInvoke(function(e){var t=e.frm;if(t){var i=e.onwerKey,a=e.lastFldName,n=e.lastRowId,o=e.sendFieldName,r=e.rowId;t.fireEventNoData.call(t,"EntryCellFocued",i,o,n,r,a,null)}},10,!1,s)}t._lastFocusedFieldName=n||"",1!=i.isIgnoreClickStatus&&i.setLastFocusTD(e)},afterRowDataChange:function(e){this.fireRowChanged(e),e.forceFire=!0,e.isEnterJump=!0,this.fireCellChanged(e)},getLocalConfiguration:function(){return KD.isEmpty(this.localConfiguration)&&(this.localConfiguration=KD.getLocalConfiguration()),this.localConfiguration}})}(KDGridSelOpStrategy)}(),define("KDGridSelOpStrategy",["KDKendoGridProxy"],function(e){return function(){var t;return t||e.KDGridSelOpStrategy}}(this)),function(e){KDEditGridSelOp=KD.extend(e,{aTitle:"KDEditGridSelOp",isDefSelected:function(e){return void 0!==e&&(this.config.IsDefaultSelected=e),void 0===this.config.IsDefaultSelected||this.config.IsDefaultSelected},initConfigSelected:function(e){KDEditGridSelOp.superclass.initConfigSelected.call(this,e)},initDataSelected:function(e){var t=this,i=0,a="0";t.reset(),$.extend(this,{_focusedRowId:i,_selectedRowIds:a}),t.isDefSelected()&&t.setFirstLoad()},svrCmdSelectedChanged:function(e){KDEditGridSelOp.superclass.svrCmdSelectedChanged.call(this,e)},syncColHeadValue:function(){KDEditGridSelOp.superclass.syncColHeadValue.call(this)},syncSel2UI:function(){var e=this,t=e.ownerProxy,i=t.getStore.call(t);t.isInit=!0,e.isDefSelected()&&!e._selectedRowIds&&i.getRowCount.call(i)>0&&this._setSelectedRowIds(0,"0");var a=sels=this.__str2arr(e._selectedRowIds||"",e._focusedRowId||0);for(var n in a)t.setSelection.call(t,a[n]);t.isInit=!1},clearUISelection:function(){KDEditGridSelOp.superclass.clearUISelection.call(this)},syncUI2Sel:function(e){return KDEditGridSelOp.superclass.syncUI2Sel.call(this,e)},reset:function(){this.resetFirstLoad(),$.extend(this,{_defFocusedRowId:0,_lastFocusedRowId:-1,_focusedRowId:0,_lastFocusedFieldName:"",_focusedFieldName:"",_lastSelectedRowIds:"",_selectedRowIds:"0"})},fireRowChanged:function(e){KDEditGridSelOp.superclass.fireRowChanged.call(this,e)},fireCellChanged:function(e){KDEditGridSelOp.superclass.fireCellChanged.call(this,e)},afterRowDataChange:function(e){var t=this;t.clearUISelection(),KDEditGridSelOp.superclass.afterRowDataChange.call(t,e)}})}(KDGridSelOpStrategy),define("KDEditGridSelOp",["KDGridSelOpStrategy"],function(e){return function(){var t;return t||e.KDEditGridSelOp}}(this)),function(e){KDEditGridSingleSelOp=KD.extend(e,{aTitle:"KDEditGridSingleSelOp",isDefSelected:function(e){return void 0!==e&&(this.config.IsDefaultSelected=e),void 0===this.config.IsDefaultSelected||this.config.IsDefaultSelected},initConfigSelected:function(e){KDEditGridSingleSelOp.superclass.initConfigSelected.call(this,e)},initDataSelected:function(e){var t=this,i=0,a="0";t.reset(),$.extend(this,{_focusedRowId:i,_selectedRowIds:a}),t.isDefSelected()&&t.setFirstLoad()},svrCmdSelectedChanged:function(e){KDEditGridSelOp.superclass.svrCmdSelectedChanged.call(this,e)},syncColHeadValue:function(){KDEditGridSingleSelOp.superclass.syncColHeadValue.call(this)},syncSel2UI:function(){var e=this,t=e.ownerProxy;t.isInit=!0;var i=sels=this.__str2arr(e._selectedRowIds||"",e._focusedRowId||0);for(var a in i)t.setSelection.call(t,i[a]);t.isInit=!1},clearUISelection:function(){KDEditGridSingleSelOp.superclass.clearUISelection.call(this)},syncUI2Sel:function(e){return KDEditGridSingleSelOp.superclass.syncUI2Sel.call(this,e)},reset:function(){this.resetFirstLoad(),$.extend(this,{_defFocusedRowId:0,_lastFocusedRowId:-1,_focusedRowId:0,_lastFocusedFieldName:"",_focusedFieldName:"",_lastSelectedRowIds:"",_selectedRowIds:"0"})},fireRowChanged:function(e){return KDEditGridSingleSelOp.superclass.fireRowChanged.call(this,e)},fireCellChanged:function(e){KDEditGridSingleSelOp.superclass.fireCellChanged.call(this,e)},afterRowDataChange:function(e){var t=this;t.clearUISelection(),KDEditGridSingleSelOp.superclass.afterRowDataChange.call(t,e)}})}(KDGridSelOpStrategy),define("KDEditGridSingleSelOp",["KDGridSelOpStrategy"],function(e){return function(){var t;return t||e.KDEditGridSingleSelOp}}(this)),function(e){KDTreeListSelOp=KD.extend(e,{aTitle:"KDTreeListSelOp",isDefSelected:function(e){return void 0!==e&&(this.config.IsDefaultSelected=e),void 0===this.config.IsDefaultSelected||this.config.IsDefaultSelected},initConfigSelected:function(e){KDTreeListSelOp.superclass.initConfigSelected.call(this,e)},initDataSelected:function(e){var t=this,i=0,a="0";t.reset(),$.extend(this,{_focusedRowId:i,_selectedRowIds:a}),t.isDefSelected()&&t.setFirstLoad()},svrCmdSelectedChanged:function(e){KDTreeListSelOp.superclass.svrCmdSelectedChanged.call(this,e)},syncColHeadValue:function(){KDTreeListSelOp.superclass.syncColHeadValue.call(this)},syncSel2UI:function(){var e=this,t=e.ownerProxy;t.isInit=!0;var i=sels=this.__str2arr(e._selectedRowIds||"",e._focusedRowId||0);for(var a in i)t.setSelection.call(t,i[a]);t.isInit=!1},clearUISelection:function(){KDTreeListSelOp.superclass.clearUISelection.call(this)},syncUI2Sel:function(e){return KDTreeListSelOp.superclass.syncUI2Sel.call(this,e)},reset:function(){this.resetFirstLoad(),$.extend(this,{_defFocusedRowId:0,_lastFocusedRowId:-1,_focusedRowId:0,_lastFocusedFieldName:"",_focusedFieldName:"",_lastSelectedRowIds:"",_selectedRowIds:"0"})},fireRowChanged:function(e){return KDTreeListSelOp.superclass.fireRowChanged.call(this,e)},fireCellChanged:function(e){KDTreeListSelOp.superclass.fireCellChanged.call(this,e)},afterRowDataChange:function(e){var t=this;t.clearUISelection(),KDTreeListSelOp.superclass.afterRowDataChange.call(this,e)}})}(KDGridSelOpStrategy),define("KDTreeListSelOp",["KDGridSelOpStrategy"],function(e){return function(){var t;return t||e.KDTreeListSelOp}}(this)),function(e){KDViewGridSelOp=KD.extend(e,{aTitle:"KDViewGridSelOp",initConfigSelected:function(e){KDViewGridSelOp.superclass.initConfigSelected.call(this,e)},initDataSelected:function(e){var t=this,i=t.ownerProxy.getStore.call(t.ownerProxy),a=i?i.selColDescriptor:void 0;a&&a.reset.call(a);var n=e.selRows||"";this.isDefSelected()&&(n=this.__arr2str(this.__str2arr(e.selRows,e.focusrowindex))),$.extend(this,{_focusedRowId:e.focusrowindex,_focusedFieldName:"",_selectedRowIds:n}),n||this.setFirstLoad()},isBulkData:function(){var e=this,t=e.ownerProxy,i=t.getStore.call(t),a=i.isBulkData.call(i);return a},scrollToSelectRow:function(){var e=this,t=e.ownerProxy,i=t.getKendoGrid.call(t),a=t?t.currentScrollOffset||{top:0,left:0}:{top:0,left:0};if(a.top>0){var n=i.element.find(".k-grid-content");n&&KD.isFunction(n.scrollTop)&&n.scrollTop(a.top)}},isSameRow:function(e){return e=e||{},this._focusedRowId==e.rowId},svrCmdSelectedChanged:function(e){var t=this,i=t.ownerProxy.getStore.call(t.ownerProxy),a=i.selColDescriptor;if(t.isUserCurrentPara(e)){var n=this.getSelectedRowIdArray(),o=0==n.length?[]:i.existRowIds.call(i,n);if(o.length!=n.length){var r=this.__arr2str(o),s=void 0===o[0]?-1:o[0];t._setSelectedRowIds(s,n)}}else{var o=t.__str2arr(e),r=e,s=void 0===o[0]?-1:o[0];t._setSelectedRowIds(s,r)}(t.isDefSelected()||!t.isFirstLoad()||!t.isMultiSelectMode()&&!t.config.editable&&KD.IsNullOrWhiteSpace(this._selectedRowIds))&&(t.syncSel2UI(),t.syncColHeadValue()),t.isFirstLoad()&&($.extend(t,{_lastFocusedRowId:-1,_lastFocusedFieldName:"",_lastSelectedRowIds:""}),t.fireRowChanged({rowId:t._focusedRowId,field:t._focusedFieldName}),t.resetFirstLoad(),a&&a.isInit.call(a,!1))},syncColHeadValue:function(){KDViewGridSelOp.superclass.syncColHeadValue.call(this)},syncSel2UI:function(){var e=this,t=e.ownerProxy,i=t.getKendoGrid.call(t)||{},a=t.getStore.call(t),n=a.selColDescriptor;
t.isInit=!0;var o=sels=this.__str2arr(e.getSelectedRowIds()||"");n.beginBatchUpdate.call(n),n&&n.setSelectState.call(n,{sender:i},o),n.endBatchUpdate.call(n,{},!0),t.isInit=!1},clearUISelection:function(e){KDViewGridSelOp.superclass.clearUISelection.call(this,e)},syncUI2Sel:function(e){return!this.isSameRow(e)&&this.isBulkData()?this.syncUI2SelBulk(e):KDViewGridSelOp.superclass.syncUI2Sel.call(this,e)},handleSelect:function(e){if(ret){var t=this,i=t.ownerProxy,a=(i.getKendoGrid.call(i),i.getLocalConfiguration().SelectRowBackground||""),n=i.el.find('.k-grid-content table tbody[role="rowgroup"] tr'),o=i.el.find(".k-grid-content-locked  table tbody tr");if(n.css("background-color","").removeClass("kd-state-selected"),o.css("background-color","").removeClass("kd-state-selected"),$(".kd-grid-selector .gridCheckCell",i.el)[getPropName()]("checked",!1),Object.keys(e).length>KDStore.C_BulkDataLimit)for(var r=$(".kd-grid-selector",i.el),s=0;s<r.length;s++){var l=$(r[s]),d=l.attr("data-rowid");l&&e[d]&&$(".gridCheckCell",l)[getPropName()]("checked",!0).closest(".kd-grid-selector").parent().parent().css("background-color",a)}else for(var c in e){var l=$(".kd-grid-selector[data-rowid='"+c+"']",i.el);$(".gridCheckCell",l)[getPropName()]("checked",!0).closest(".kd-grid-selector").parent().parent().css("background-color",a)}}},syncUI2SelBulk:function(e){var t=this,i=[],a={},n=(e.rowId,t.ownerProxy),o=n.getStore.call(n),r=n.getKendoGrid.call(n),s=r?r.select():[],l={},d=o.selColDescriptor,c=KDStore.isColSelector(e.field),h=d.selectedMaps,u=d.getKendoFieldName.call(d);d.beginBatchUpdate.call(d);var p=o.rows,g=!1;if(t.isHeaderCheckAll(e)){var f,m=void 0===e.checked?!1:e.checked,v=r.dataSource.filter&&r.dataSource.filter()&&r.dataSource.filter().filters.length>0||!1,y=!0;v&&(f=KD.cloneObject(n.getGridViewRows(!0)));for(var b=0;b<p.length;b++){var D=p[b],k=D.rowId;if(v){y=!1;for(var C=0;C<f.length;C++)if(k==f[C].rowId){y=!0,f.splice(C,1);break}}h[k]=m&&y,D[u]=m&&y,m&&y&&(i.push(k),a[k.toString()]=!0),g=!0}h.all=m,d.endBatchUpdate.call(d,{})}else{if(c){var x=o.getSelectedIds.call(o);for(var b in x)""!==x[b]&&(l[x[b]]=!0)}else for(var b=0;b<s.length;b++){var D=r.dataItem(s[b]),w=D&&void 0!==D.rowId?D.rowId:"";""!==w&&(l[w]=!0)}for(var b=0;b<p.length;b++){var D=p[b],k=D.rowId,m=!!l[k];h[k]=m,D[u]=m,m&&(i.push(k),a[k.toString()]=!0),g=!0}d.endBatchUpdate.call(d,{},!0)}t.syncColHeadValue();var K=t.__arr2str(i);if(g){var S=n.getUIFocusedCellData.call(n);t.handleSelect(a),t.endCellChanged.call(t);var I="tbody tr [data-rowId="+S.rowId+'][data-field="'+S.field+'"]',P=n&&n.el&&n.el.find?n.el.find(I):void 0,F=$(P).closest("td");F.length&&r.current(F)}return KD.delayInvoke(function(){t.scrollToSelectRow.call(t)},50,!0),K},reset:function(){var e=this,t=e.ownerProxy.getStore.call(e.ownerProxy),i=t?t.selColDescriptor:void 0;i&&i.reset.call(i),e.resetFirstLoad(),$.extend(e,{_defFocusedRowId:-1,_lastFocusedRowId:-1,_focusedRowId:-1,_lastFocusedFieldName:"",_focusedFieldName:"",_lastSelectedRowIds:"",_selectedRowIds:""})},fireRowChanged:function(e){var t=this,i=e.rowId,a=e.field,n="";if(t.endCellChanged(),void 0===i)return t._lastSelectedRowIds;if(t.isFirstLoad())n=t.getSelectedRowIds();else if(e.noSync)n=i+"";else if(t.isHeaderCheckAll(e)){var o=t.ownerProxy,r=o.getStore.call(o),s=r.selColDescriptor;rowIdAr=s.getSelectedIds.call(s),n=t.__arr2str(rowIdAr)}else n=t.syncUI2Sel(e);if(0>i&&(i=t._lastFocusedRowId),t._setSelectedRowIds(i,n),!t.isRowSelChanged())return t._lastSelectedRowIds;$.extend(t,{_lastSelectedRowIds:n,_selectedRowIds:n,_lastFocusedRowId:t._focusedRowId,_lastFocusedFieldName:a||"",_focusedFieldName:a||""});var l=i,d=t.ownerProxy.getKey.call(t.ownerProxy),c=t.ownerProxy.getFormProxy.call(t.ownerProxy);return c&&(KD.getValue(e,"isSyncSvrEvent",!1)?c.fireSyncEvent.call(c,"EntityRowClick",d,t._checkRowId(l)):c.fireEvent.call(c,"EntityRowClick",d,t._checkRowId(l))),t.getSelectedRowIds()},fireCellChanged:function(e){KDViewGridSelOp.superclass.fireCellChanged.call(this,e)},afterRowDataChange:function(e){KDViewGridSelOp.superclass.afterRowDataChange.call(this,e)}})}(KDGridSelOpStrategy),define("KDViewGridSelOp",["KDGridSelOpStrategy"],function(e){return function(){var t;return t||e.KDViewGridSelOp}}(this)),function(e){KDViewGridSingleSelOp=KD.extend(KDViewGridSelOp,{aTitle:"KDViewGridSingleSelOp",isRowSelChanged:function(){return this._lastFocusedRowId!=this._focusedRowId&&!this._isCellChanged},initConfigSelected:function(e){KDViewGridSingleSelOp.superclass.initConfigSelected.call(this,e)},initDataSelected:function(e){var t=e.selRows;this.isDefSelected()&&(t=this.__arr2str(this.__str2arr(e.selRows,e.focusrowindex))),$.extend(this,{_focusedRowId:KD.isEmpty(e.focusrowindex)?-1:e.focusrowindex,_focusedFieldName:"",_selectedRowIds:t||""}),(!t||this.isDefSelected())&&this.setFirstLoad()},syncSel2UI:function(){var e=this,t=e.ownerProxy,i=t.getKendoGrid.call(t),a=t.getStore.call(t),n=a.selColDescriptor;t.isInit=!0;var o=e.getFocusedRowId();-1==o&&KD.IsNullOrWhiteSpace(e._selectedRowIds)&&(o=a.getFirstRowId(),e._selectedRowIds=String(o),e._setSelectedRowIds(o,e._selectedRowIds));var r=sels=[o];n&&n.setSelectState.call(n,{sender:i},r),t.isInit=!1},syncUI2Sel:function(e){var t=this,i=e.rowId;if(-1!=i){var a=t.ownerProxy.getKendoGrid.call(t.ownerProxy),n=t.ownerProxy.getStore.call(t.ownerProxy),o=n.selColDescriptor,r=a?a.select():[],s=void 0===r||0==r.length?[i]:s||[],l=KDStore.isColSelector(e.field);if(l)s=n.getSelectedIds.call(n);else for(var d=0;d<r.length;d++){var c=a.dataItem(r[d]),h=c&&void 0!==c.rowId?c.rowId:"";(l?h!=i:!0)&&s.indexOf(h)<0&&s.push(h)}if(o){for(var d in s)i!=s[d]&&o.setSvrValue.call(o,s[d],!1);s.length>0&&(s=[s[0]],o.setSelectState.call(o,{sender:a},s))}return t.__arr2str(s)}},fireRowChanged:function(e){var t=this,i=e.rowId,a=e.field,n="",o=KDStore.isColSelector(a);if(t._isCellChanged=!1,void 0===i)return t._lastSelectedRowIds;if(n=t.isFirstLoad()?t.getSelectedRowIds():e.noSync?i+"":t.syncUI2Sel(e),0>i&&(i=t._lastFocusedRowId),t._setSelectedRowIds(i,n),!o&&!t.isRowSelChanged())return t._lastSelectedRowIds;$.extend(t,{_lastSelectedRowIds:n,_selectedRowIds:n,_lastFocusedRowId:t._focusedRowId,_lastFocusedFieldName:a||"",_focusedFieldName:a||""});var r=i,s=t.ownerProxy.getKey.call(t.ownerProxy),l=t.ownerProxy.getFormProxy.call(t.ownerProxy);return l&&(KD.getValue(e,"isSyncSvrEvent",!1)?l.fireSyncEvent.call(l,"EntityRowClick",s,t._checkRowId(r)):l.fireEvent.call(l,"EntityRowClick",s,t._checkRowId(r))),t.getSelectedRowIds()}})}(KDGridSelOpStrategy),define("KDViewGridSingleSelOp",["KDViewGridSelOp"],function(e){return function(){var t;return t||e.KDViewGridSingleSelOp}}(this)),KDKendoToolbarProxy=KD.extend(KDControlProxy,{sizeChangePlayer:null,MainTabStyle:null,IsMainMenu:!1,itemsMap:{},isKeyBoardAction:!1,shortcutkeyContainer:[],isSetToolBarAllDisable:!1,isEntryBar:function(){return void 0!==this.config.entryKey},clickHandler:function(e){if(!(this.viewLocked||$(e.target).hasClass("k-state-disabled")||$(e.target).hasClass("kd-menubtn-disabled")||$(e.target).parent().hasClass("k-state-disabled")||$(e.target).parent().hasClass("kd-menubtn-disabled"))){var t=this,i=$(".kdmenuitem-content",e.target)[getPropName()]("id"),a=this.getButtonKey(i),n=this.itemsMap[a];if(this.checkToolBarItemEvent(a)&&t._checkButtonIsNeedClick(n)){if("checkbox"==n.xtype){var o=e.target.find(".kd-toolbar-checkbox-icon");"none"==o.css("display")?o.show():o.hide()}var r=t.toolBarItemClick;r.actionName="ToolBarItemClick";var s=$(e.target).find("[kdrole='kduploadfile']");n.isopenfiledialog&&s.length>0?(s.off("change"),s.val(""),s.off("click").on("click",function(e){KD.stopPropagation(e)}),s.on("change",function(e){var i=t.getFormProxy();i.currentOpenFileDialogFileList=e,this.MainBarItemClickTimeout=KD.delayInvoke(function(){r.call(t,a)},200)}),KD.delayInvoke(function(){s.trigger("click")},500)):this.MainBarItemClickTimeout=KD.delayInvoke(function(){r.call(t,a)},200)}}},toolBarItemClick:function(e){try{var t=this,i=t.getFormProxy(),a=t.itemsMap[e],n=a.validation?i.validating(!0):!0;if(!n)return;if("MainBarItemClick"==t.actionKey)i.lockControl.call(i,t),i.fireEvent.call(i,t.actionKey,e);else{i.lockControl.call(i,t);var o=t.isEntryBar()?t.config.entryKey:t.getKey();i.fireEvent.call(i,t.actionKey,o,e)}}catch(r){KD.writeError(r)}finally{t.MainBarItemClickTimeout=null}},setFullKeyBoardAction:function(e){var t=this;if(!KD.isEmpty(e)){var i=e.key||e.keyCode||e.which,a=e.ctrlKey||e.metaKey,n=e.shiftKey,o=e.altKey,r=t.toolBarItemClick,s=[];a&&s.push("Control"),n&&s.push("Shift"),o&&s.push("Alt");var l=e.key?i:String.fromCharCode(i);e.code&&KD.CONST.ShortCutKeyToggle[e.code]&&(l=KD.CONST.ShortCutKeyToggle[e.code]),-1==s.indexOf(l)&&s.push(l.toUpperCase());for(var d=0;d<t.shortcutkeyContainer.length;d++)if(KD.isArray(t.shortcutkeyContainer[d].shortcut)&&s.sort().toString().toUpperCase()==t.shortcutkeyContainer[d].shortcut.sort().toString().toUpperCase()){e.preventDefault(),KD.stopPropagation(e);var c=t.shortcutkeyContainer[d].id;this.checkToolBarItemEvent(c)&&(r.actionName="ToolBarItemClick",t.isKeyBoardAction=!0,t.MainBarItemClickTimeout=KD.delayInvoke(function(){r.call(t,c)},200));break}}},checkToolBarItemEvent:function(e){var t=!1,i=this.itemsMap[e];return KD.isEmpty(i)||(t=!i.disabled&&i.visible),t},openHanlder:function(e){var t=this,i=$(".kdmenuitem-content",e.target)[getPropName()]("id"),a=this.getButtonKey(i),n=t.itemsMap[a];return void 0==n||0==t.getMenuVisibleCout(n.items)||1==n.disabled&&0==n.caninvokeoperation?void(e._defaultPrevented=!0):void(0!=n.disabled||1!=n.caninvokeoperation||!e.targetActive||e.targetActive.hasClass("k-i-arrow-s")||e.targetActive.hasClass("k-split-button-arrow")||(e._defaultPrevented=!0))},getKendoCType:function(){return"kendoKDToolbar"},getKendoOptions:function(){var e,t=this,i={items:[],click:function(e){t.clickHandler.call(t,e)},open:function(e){var i=t.isSetToolBarAllDisable;return i?void e.preventDefault():(t.openHanlder.call(t,e),void KD.delayInvoke(function(){var e=t.component.find(":hover").find(".kdmenuitem-content").last().attr("id")+"_optionlist";$("#"+e).addClass("kd-toolbar-pop-container").off("keydown").on("keydown",function(e){var i=event.keyCode||event.which||event.charCode;if(112==i){e.preventDefault();var a=$(this).parent().find(":hover").last().text();t.getFormProxy().onF1Click(a)}})},200))}},a=this.getConfig();return e=a.bardata?a.bardata.items:KD.getValue(a,"items",[]),this.visible=e.length>0?!0:!1,$.each(e,function(a){var n=e[a],o=t.getMenuItemOpt.call(t,n,0);i.items.push(o)}),i},getMenuItemClass:function(e,t){var i=e.cssClass||"kdmenuitem kdmenuitem-"+e.xtype+(t||"");return"separator"!=e.xtype&&(i+=" kd-toolbar-gridtoolbar "),i},getMenuItemOpt:function(e,t){var i={},a=this,n=this.getButtonId(e.id);a.itemsMap[e.id]=e;var o=e.tooltip||"";switch(e.xtype){case"button":i={type:e.xtype,text:kendo.format('<span id="{0}" class="kdmenuitem-content" title="{1}">{2}</span>',n,o,e.text),encoded:!1,enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0)},e.isopenfiledialog&&(i.text+='<input tabindex="0" kdrole="kduploadfile" style="width:0;display:none" type="file" name="fileselect[]" size="28" multiple/>');break;case"splitbutton":var r=!1;i={type:"splitButton",text:kendo.format('<span id="{0}" class="kdmenuitem-content" title="{1}">{2}</span>',n,o,e.text),encoded:!1,enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),menuButtons:[]};e.items&&$.each(e.items,function(n){var o=e.items[n],s=null;r=o&&o.items&&o.items.length,r?o&&o.items&&$.each(o.items,function(e){var n=o.items[e];n.text&&n.id||(n.xtype="separator"),s=a.getMenuItemOpt.call(a,n,t+2),$.extend(s,{id:a.getButtonId.call(a,n.id||"")}),i.menuButtons.push(s)}):(s=a.getMenuItemOpt.call(a,o,t+1),$.extend(s,{id:a.getButtonId.call(a,o.id)}),i.menuButtons.push(s))}),(!e.items||e.items.length<=0)&&(i.menuButtons=[]);break;case"checkbox":i={type:"button",text:kendo.format('<span id="{0}" class="kdmenuitem-content kd-toolbar-checkbox-container"><span class="kd-toolbar-checkbox-icon" style="display:{1}"></span><span class="kd-toolbar-checkbox-text">{2}</span></span>',n,1==e.checked?"inline-block":"none",e.text),hidden:!KD.getValue(e,"visible",!0),enable:!KD.getValue(e,"disabled",!1),encoded:!1};break;case"separator":i={type:e.xtype,text:"",hidden:!KD.getValue(e,"visible",!0),enable:!KD.getValue(e,"disabled",!1),cssClass:this.getMenuItemClass(e,t>0?"-H":"-V"),encoded:!1},t>0&&(i.attributes={style:"border: solid 0px;background-color: darkgray;height: 1px;padding: 0px;margin: 0px 8px;"});break;default:KD.Error.raise({sourceClass:"KDKendoToolbarProxy",sourceMethod:"createBarItem",msg:"The '"+e.xtype+"' type has not been Spported"})}return $.extend(i,{id:n,attributes:{"class":this.getMenuItemClass(e)}}),i},getButtonId:function(e){return this.getBaseId()+"-"+(e?e:"")},getButtonKey:function(e){return e?e.substring(this.getBaseId().length+1):""},loadConfig:function(e){this.itemsMap={},this.shortcutkeyContainer=[],this.actionKey=e.actionKey?e.actionKey:"ToolBarItemClick",KDKendoToolbarProxy.superclass.loadConfig.call(this,e),this.setRequestLock(!0),this.barItems={},this.el.css({border:"0px","line-height":this._getLineHeight(),overflow:"hidden"}),this.setMainMenu(KD.getValue(e,"ismainmenu",!1)),this.setMainTabStyle(KD.getValue(e,"maintabstyle",!1))},_getLineHeight:function(){var e=parseInt(this.config.height||0)+"px";return(this.config.dock==KD.dock.Left||this.config.dock==KD.dock.Fill||this.config.dock==KD.dock.Right)&&(e=this.el.parent().height()+"px"),e},initComponent:function(){var e=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(this.getConfig());this.InlineStyle=$.extend(this.InlineStyle||{},e);var t=this.getKendoOptions();this.component=$(kendo.format('<ul style="line-height:{0};height:{0};padding-left: 0px;margin-top: 0px; border:none;" class="kd-toolbar">',this._getLineHeight())).appendTo(this.el)[this.getKendoCType()](t),this.dataModel=this.component.data(this.getKendoCType()),$("a",this.component).css({border:0}),this.menuBtns=this.component.children();this.setInlineStyle(),this.el.addClass(this.getStyleKey()),this.setVisible(KD.getValue(this.config,"visible",!0)),this.rendered=!0,this.setToolTip(this.config.tooltip||this.config.description||""),this.componentWidth=KD.layout.getActualWidth(this.component),this.componentWidth<=2?this.componentIsNeedRefresh=!0:this.componentIsNeedRefresh=!1,0==this.visible&&this._updateHeight();for(var i in this.itemsMap)if(this.itemsMap[i].shortcut){var a=KD.cloneObject(this.itemsMap[i]);a.shortcut=this.itemsMap[i].shortcut.replace(/\s*/g,"").split("+"),this.shortcutkeyContainer.push(a)}},setToolTip:function(e){},_updateHeight:function(){var e,t=this.getParentProxy();if(e=t&&t.baseId&&this.el.parent().attr("data-kdid")?t.baseId+"_top"==this.el.parent().attr("data-kdid"):!1){var i={};i.key=this.getConfig().id,i.height=this.getConfig().height;var a=this.getFormProxy();a.updateToolbarPanelHeight.call(a,i,this.visible)}else this.el.css("display",0==this.visible?"none":"block")},doLayout:function(){KDKendoToolbarProxy.superclass.doLayout.call(this);var e=KD.layout.getActualWidth(this.component);(this.componentWidth!=e||KD.isIeBrowser())&&(this.componentWidth=this.component.width()>2?e:this.componentWidt,this.dataModel&&this.dataModel.resize&&this.dataModel.resize(),this.component.children(":last-child").is(":visible")&&this.component.find(".k-overflow-anchor").hide())},setBarItemStates:function(e,t){this.componentIsNeedRefresh&&(this.dataModel.destroy(),this.el.empty(),this.initComponent());for(var i,a=e.length,n=this.dataModel&&this.component.data(this.getKendoCType()),o=0;a>o;o++){i=e[o],!KD.isEmpty(this.itemsMap[i.key])&&KD.isObject(i)&&$.extend(this.itemsMap[i.key],i);var r=this.getButtonId(i.key),s=this.component.find("#"+r);if(0==s.length){if(!($("#"+r).length>0)){KD.writeLog("setBarItemStates conn't find "+r+"  control",KD.stringify(i),!0);continue}for(var l=n.options&&n.options.items||[],d=!1,c=0;c<l.length;c++){if(l[c].menuButtons)for(var h=0;h<l[c].menuButtons.length;h++)if(l[c].menuButtons[h].id==r){var u=$("#"+l[c].id+"_optionlist");this._setChildBarItemStates(u,r,i),d=!0;break}if(1==d)break}}if(s&&s.length){if(void 0!=i.visible){var p=n._getItem(s).overflow.options.hidden;p=!1,i.visible?n.show(s):n.hide(s)}var g=t?t:i.disabled;if(void 0!=g&&(1==g?(n&&s.addClass("kd-menubtn-disabled"),s.removeClass("kendo-color")):(s.removeClass("kd-menubtn-disabled"),n&&s.addClass("kendo-color"))),void 0!=i.text&&s&&$("#"+r,s).text(i.text),i.click&&(s.click=i.click),void 0!=i.checked){var f=s.find(".kd-toolbar-checkbox-icon");i.checked?f.show():f.hide()}i.tipscontent&&this._setMenuBarTipsContent(i)}}for(var m=this.component[0],h=0;h<m.childNodes.length;h++)if($(m.childNodes[h]).hasClass("kdmenuitem-separator"))this._setSeparatorState(m.childNodes[h]);else if($(m.childNodes[h]).hasClass("k-split-button"))for(var v=$("#"+$(m.childNodes[h]).find(".kdmenuitem").attr("id")+"_optionlist"),y=v.children(),b=0;b<y.length;b++)$(y[b]).children(".kdmenuitem").hasClass("kdmenuitem-separator")&&this._setSeparatorState(y[b]);this.component.children(":last-child").is(":visible")&&this.component.find(".k-overflow-anchor").hide(),this._setIsShowIcon(e),void 0!=this.visible?this.lastVisible=this.visible:this.lastVisible=KD.getValue(this.config,"visible",!0);for(var D=!1,k=this.component&&this.component.children(),o=0;o<k.length;o++){var C=$(k[o]);if(C.hasClass("k-overflow-anchor")){if("hidden"!=C.css("visibility")){D=!0;break}}else if("none"!=C.css("display")){D=!0;break}}D?(this.visible=!0,this.component.show()):(this.visible=!1,this.component.hide()),this.lastVisible!=this.visible&&this._updateHeight()},getMenuVisibleCout:function(e){e=e||[];for(var t=0,i=0;i<e.length;i++){var a=e[i];a.hidden||void 0!=a.visible&&!a.visible||t++}return t},_setSeparatorState:function(e){e=$(e);for(var t=e.next(),i=!1,a=0;a<e.nextAll().length;a++){if(t.length>0&&"none"!=$(t).css("display")){t.children(".kdmenuitem").hasClass("kdmenuitem-separator")||(i=!0);break}t=t.next()}for(var n=e.prev(),o=!1,a=0;a<e.prevAll().length;a++){if(n.length>0&&"none"!=$(n).css("display")&&"hidden"!=$(n).css("visibility")){n.children(".kdmenuitem").hasClass("kdmenuitem-separator")||(o=!0);break}n=n.prev()}i&&o?e.removeClass("kd-ui-hiddenElem"):e.addClass("kd-ui-hiddenElem")},_setChildBarItemStates:function(e,t,i){var a,n;if(!(e.length<1)&&(a=e.find("#"+t),i&&a&&(0==i.visible&&a.addClass("kd-ui-hiddenElem"),1==i.visible&&a.removeClass("kd-ui-hiddenElem"),1==i.disabled&&(a.removeClass("kendo-color"),a.addClass("kd-menubtn-disabled")),0==i.disabled&&(a.removeClass("kd-menubtn-disabled"),a.addClass("kendo-color")),void 0!=i.text&&$("#"+t,this.component).text(v.text),i.click&&!n.hasClass("kd-menubtn-disabled")&&(a.click=v.click),void 0!=i.checked))){var o=a.find(".kd-toolbar-checkbox-icon");i.checked?o.show():o.hide()}},_setIsShowIcon:function(e){for(var t,i,a,n=!1,o=0;o<e.length;o++)if(t=this.getButtonId(e[o].key),i=$("#"+t),a=$("#"+t+"_optionlist"),n=!1,a.length>0){for(var r=a.children(),s=0;s<r.length;s++)if("none"!=$(r[s]).css("display")){n=!0;break}var l=i.parent().find(".k-split-button-arrow .k-icon");l&&l.length>0&&(1==n?l.removeClass("kd-ui-hiddenElem"):l.addClass("kd-ui-hiddenElem"))}},_checkButtonIsNeedClick:function(e){var t=!0;if(!KD.isEmpty(e)&&0==e.caninvokeoperation)if(t=!1,KD.isEmpty(e.items))t=!0;else for(var i=0;i<e.items.length;i++){if(0!=e.items[i].visible){t=!1;break}t=!0}return t},setVisible:function(e){},setDisplay:function(e){var t=e?"block":"none";KD.isEmpty(this.el)||this.el.css({display:t})},setAllItemsDisabled:function(e){var t=this,i=t.config&&t.config.items;e?t.component.addClass("kd-toolbar-incolselection"):t.component.removeClass("kd-toolbar-incolselection"),t.isSetToolBarAllDisable=e,t.setBarItemStates(i,e)},addItem:function(e,t){this.dataModel.add(this.getMenuItemOpt(e))},getItem:function(e){var t=this.getButtonId(e),i=$("#"+t,this.el);return i},setMainMenu:function(e){this.IsMainMenu=e,e&&(this.style="2")},style:"1",setStyle:function(e){this.style=e},getStyle:function(){return"1"==this.style?"MainGrayToolBarStyle":"MainToolBarStyle"},setMainTabStyle:function(e){this.MainTabStyle!=e&&(this.MainTabStyle=e,e&&(this.style="2"))},_releaseChildItmes:function(){for(var e,t,i,a=this.component.children(),n=0;n<a.length;n++)e=$(a[n]),e.hasClass("k-split-button")&&(i=e.find(".kdmenuitem-splitbutton").attr("id"),t=$("#"+i+"_optionlist"),t.length>0&&(t.closest("div.k-animation-container").length>0?t.closest("div.k-animation-container").remove():t.remove()))},release:function(){try{this._releaseChildItmes(),this.dataModel&&this.dataModel.popup&&this.dataModel.popup.destroy&&this.dataModel.popup.destroy(),this.dataModel&&this.dataModel.destroy&&this.dataModel.destroy(),delete this.dataModel,KDKendoToolbarProxy.superclass.release.call(this)}catch(e){}},_setMenuBarTipsContent:function(e){var t=e.tipscontent;if(!KD.isEmpty(t)){var i=e.key;if(i&&this.itemsMap&&this.itemsMap[i]){var a=this.baseId+"-"+i+"-kdtooltip",n=this.getLineTipsDefConfig(a),o=this.getFormProxy(),r=o.createInnerControl(n);r.setIsOnlineTips.call(r,!0),r.setTipsData.call(r,t);var s=$.extend(r.getLineTipsOptions(),{position:"right"}),l=this.component.find("#"+this.getButtonId(i));l.length&&l.kendoKDTooltip(s)}}}}),KDControlFactoryProxy.registerType("kdtoolbar",KDKendoToolbarProxy),KDControlFactoryProxy.registerType("toolbar",KDKendoToolbarProxy),KDKendoToolbarProxy_Galaxy=KD.extend(KDKendoToolbarProxy,{initComponent:function(){KDKendoToolbarProxy_Galaxy.superclass.initComponent.call(this),this.el.children("ul").addClass("kd-toolbar-galaxy");this.component.find(":hover").find(".kdmenuitem-content").last().attr("id")+"_optionlist"},getMenuItemOpt:function(e,t){KDKendoToolbarProxy_Galaxy.superclass.getMenuItemOpt.call(this,e,t);var i={},a=this,n=this.getButtonId(e.id);switch(a.itemsMap[e.id]=e,e.xtype){case"button":i={type:e.xtype,text:'<span id="'+n+'" class="kdmenuitem-content kdmenuitem-content-galaxy">'+e.text+"</span>",encoded:!1,enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0)},e.isopenfiledialog&&(i.text+='<input tabindex="0" kdrole="kduploadfile" style="width:0;display:none" type="file" name="fileselect[]" size="28" multiple/>');break;case"splitbutton":var o=!1;i={type:"splitButton",text:'<span id="'+n+'" class="kdmenuitem-content kdmenuitem-content-galaxy">'+e.text+"</span>",encoded:!1,enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),menuButtons:[]};e.items&&$.each(e.items,function(n){var r=e.items[n],s=null;o=r&&r.items&&r.items.length,o?r&&r.items&&$.each(r.items,function(e){var n=r.items[e];n.text&&n.id||(n.xtype="separator"),s=a.getMenuItemOpt.call(a,n,t+2),$.extend(s,{id:a.getButtonId.call(a,n.id||"")}),i.menuButtons.push(s)}):(s=a.getMenuItemOpt.call(a,r,t+1),$.extend(s,{id:a.getButtonId.call(a,r.id)}),i.menuButtons.push(s))}),(!e.items||e.items.length<=0)&&(i.menuButtons=[]);break;case"separator":i={type:e.xtype,text:"",hidden:!KD.getValue(e,"visible",!0),enable:!KD.getValue(e,"disabled",!1),cssClass:"kdmenuitem-split-galaxy",encoded:!1},t>0&&(i.attributes={style:"border: solid 0px;background-color: darkgray;height: 1px;padding: 0px;margin: 0px 8px;"});break;default:KD.Error.raise({sourceClass:"KDKendoToolbarProxy",sourceMethod:"createBarItem",msg:"The '"+e.xtype+"' type has not been Spported"})}return $.extend(i,{id:n,attributes:{"class":this.getMenuItemClass(e)}}),i},getKendoOptions:function(){var e,t=this,i={items:[],click:function(e){t.clickHandler.call(t,e)},open:function(e){var i=t.isSetToolBarAllDisable;return i?void e.preventDefault():(t.openHanlder.call(t,e),void KD.delayInvoke(function(){var e=t.component.find(":hover").find(".kdmenuitem-content").last().attr("id")+"_optionlist";$("#"+e).is(":visible")&&$($("#"+e)[0]).addClass("kd-toolbarpopup-galaxy"),$("#"+e).addClass("kd-toolbar-pop-container").off("keydown").on("keydown",function(e){var i=event.keyCode||event.which||event.charCode;if(112==i){e.preventDefault();var a=$(this).parent().find(":hover").last().text();t.getFormProxy().onF1Click(a)}})},200))}},a=this.getConfig();return e=a.bardata?a.bardata.items:KD.getValue(a,"items",[]),this.visible=e.length>0?!0:!1,$.each(e,function(a){var n=e[a],o=t.getMenuItemOpt.call(t,n,0);i.items.push(o)}),i}}),KDControlFactoryProxy.registerType("toolbar_Galaxy",KDKendoToolbarProxy_Galaxy),KDControlFactoryProxy.registerType("kdtoolbar_Galaxy",KDKendoToolbarProxy_Galaxy),define("KDKendoToolbarProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDKendoToolbarProxy}}(this)),KDKendoMenuBarProxy=KD.extend(KDControlProxy,{MainTabStyle:null,IsMainMenu:!1,isMenuBar:!0,lastVisible:!0,RightItemList:[],RightItemKeyList:{},CustomizeMnuItems:null,HasCustomizeItem:!1,AllowHelpAssistant:!1,hasHelpAssistantBtn:!1,rightItemClass:"kd-menu-item-right",btnCustomizeMenuId:"btnCustomizeMenu",btnHelpAssistantId:"__defnewhepler__",btnCustomizeClass:"kd-menu-item-btncustomize",btnCustomizeClickedClass:"kd-menu-customizeclicked",customizePopUpUlClass:"kd-menu-ulcustomiseitem",ulCustomiseBtnLastScrollTop:0,defaultBtnIconUrl:"images/silverlight/default/toolbar",rootUrl:void 0,disabledClass:"kd-menubtn-disabled",topPosition:void 0,shortcutkeyContainer:[],selectValueOnClose:"",isEntryBar:function(){return void 0!==this.config.entryKey},clickHandler:function(e){var t=$(e.item);if(!(KD.isMobileOS()&&(t.removeClass("k-state-hover"),KD.delayInvoke(function(){var e=t.children("div.k-animation-container");e.is(":hidden")?e.show():e.hide()},500),$(e.target).hasClass("k-icon"))||t.hasClass("kd-menubtn-disabled"))){var i=this,a=this.getButtonKey($(".kdmenuitem-content",t)[getPropName()]("id"));if(!i.MainBarItemClickTimeout&&"__more"!=a){var n=!1,o=t.find(".kdmenuitem-content").attr("data-targetkey");if(t&&t.length>0&&!KD.IsNullOrWhiteSpace(o))n=!0;else if(!i.checkmainBarItemEvent(a))return;if(KD.equalsIgnoreCase(a,i.btnCustomizeMenuId)){n=!0;var r=!KD.isEmpty(e.item)&&t.find(".kd-animationcontainer-btncustomise:visible"),s=this.getSplitButtonId(this.btnCustomizeMenuId),l=this.component.data(this.getKendoCType());if(KD.isEmpty(r)||0==r.length){t.addClass(this.btnCustomizeClickedClass),l.open("#"+s);var d=this.getFormProxy();if(d){var c={};c.opkey=kendo.format("{0}.{0}__defineitem__",this.getKey()),c.opname="菜单自定义显示",d.fireCustomEventsNoData.call(d,"Kingdee.BOS.PutUserBehavior","Kingdee.BOS.PutUserBehavior",KD.stringify(c))}}else t.removeClass(this.btnCustomizeClickedClass),l.close("#"+s)}else{var h=n?300:1500;if(!(i.lastClickTime&&new Date-i.lastClickTime<h)){i.lastClickTime=new Date;var u=i.itemsMap[a],p=$(e.item).find("[kdrole='kduploadfile']"),g=this.mainBarItemClick;if(g.actionName="MenuBarItemClick",u.isopenfiledialog&&p.length>0)p.off("change"),p.val(""),p.off("click").on("click",function(e){KD.stopPropagation(e)}),p.on("change",function(e){var t=i.getFormProxy();t.currentOpenFileDialogFileList=e,this.MainBarItemClickTimeout=KD.delayInvoke(function(){g.call(i,e,a)},1e3)}),KD.delayInvoke(function(){p.trigger("click")},500);else if(n){var f={eItme:t};this.MainBarItemClickTimeout=KD.delayInvoke(function(){g.call(i,f,a,n)},1e3,!1)}else this.MainBarItemClickTimeout=!0,g.call(i,e,a,n)}}}}},_hideGridBeforeColSelection:function(e){try{var t=this;if(t.config.isContextMenu&&(itemCfg=t.itemsMap[e],itemCfg.isSpecCtxBtn)){var i=t.getFormProxy(),a=t.isEntryBar()?t.config.entryKey:t.getKey(),n=i&&i.getControlProxy&&i.getControlProxy.call(i,a);!KD.isEmpty(n)&&n.el&&KD.equalsIgnoreCase(itemCfg.id,n.C_tbColSelection)&&n.el.hide()}}catch(o){KD.writeError(o)}},mainBarItemClick:function(e,t,i){try{var a=this;if(i)return a.ulCustomiseBtnLastScrollTop=$("."+a.customizePopUpUlClass,a.component).length>0?$("."+a.customizePopUpUlClass,a.component).scrollTop():0,void(!KD.isEmpty(e.eItme)&&a._bindClickEventForCustomiseBtn(e.eItme));a.lastClickTime=void 0;var n=a.getFormProxy(),o=a.itemsMap[t],r=o.validation?n.validating(!0):!0;if(0==o.caninvokeoperation){var s=!1;if(o.items)for(var l=0;l<o.items.length;l++)if(1==o.items[l].visible){s=!0;break}if(s)return}if(!r)return;n.lockControl.call(n,a);var d=a.isEntryBar()?a.config.entryKey:a.getKey();if(a.config.isContextMenu)if(o.isSpecCtxBtn){var c,h=n.getControlProxy.call(n,d);if(h){if(h.isContextMenuBlockCopy.call(h,o)){var u=h.getCurrentElement(),p=h.CopyGridOrginalValue,g=h.store,f=$("[data-field]",u).data(),m=g.getColumnDescriptor(f.field),v=g.getRowDataByServerRowId(f.rowid);m&&h.CopyGridSpecialXtype.indexOf(m.xtype)>-1?c=m.getBlockPasteText&&m.getBlockPasteText.call(m,v):(c=p?m.getOriginalValue(v):u&&u.length>0&&u.text&&u.text(),KD.isEmpty(a.selectValueOnClose)||a.selectValueOnClose==c||(c=a.selectValueOnClose))}h.doSpecCtxCmd&&h.doSpecCtxCmd.call(h,o,c)}}else"EntryBarItemClick"==a.actionKey?n.fireEvent.call(n,a.actionKey,d,t):"ContextMenuClick"==a.actionKey?n.fireEvent.call(n,a.actionKey,t):n.fireCustomEvents.call(n,t,a.actionKey,null);else"MainBarItemClick"==a.actionKey?n.fireEvent.call(n,a.actionKey,t):n.fireEvent.call(n,a.actionKey,d,t)}catch(y){KD.writeError(y)}finally{a.MainBarItemClickTimeout=null}},setBillsFullKeyBoardAction:function(e){if(!KD.isEmpty(e)){var t=this,i=e.key||e.keyCode||e.which,a=e.ctrlKey||e.metaKey,n=e.shiftKey,o=e.altKey,r=t.mainBarItemClick,s=[];a&&s.push("Control"),n&&s.push("Shift"),o&&s.push("Alt");var l=e.key?i:String.fromCharCode(i);e.code&&KD.CONST.ShortCutKeyToggle[e.code]&&(l=KD.CONST.ShortCutKeyToggle[e.code]),-1==s.indexOf(l)&&s.push(l.toUpperCase());for(var d=0;d<t.shortcutkeyContainer.length;d++)if(KD.isArray(t.shortcutkeyContainer[d].shortcut)&&s.sort().toString().toUpperCase()==t.shortcutkeyContainer[d].shortcut.sort().toString().toUpperCase()){e.preventDefault(),KD.stopPropagation(e);var c=t.shortcutkeyContainer[d].id;this.checkmainBarItemEvent(c)&&t.checkCustomizeMnuItemsVisible(c)&&(r.actionName="MenuBarItemClick",t.MainBarItemClickTimeout=KD.delayInvoke(function(){r.call(t,e,c)},200));break}}},checkmainBarItemEvent:function(e){var t=!1,i=this.itemsMap[e];return KD.isEmpty(i)||(t=!i.disabled&&i.visible),t},checkCustomizeMnuItemsVisible:function(e){var t=this,i=this.getBarItemById(this.btnCustomizeMenuId);if(KD.isEmpty(t.CustomizeMnuItems)||KD.isEmpty(i))return!0;for(var a=0;a<t.CustomizeMnuItems.length;a++){var n,o=t.CustomizeMnuItems[a];if(KD.equalsIgnoreCase(o.targetKey,e)){var r;return KD.isEmpty(o.parentkey)?n=i.find("div[data-targetkey="+e+"] input[type=checkbox]").prop("checked"):(r=t._checkMenuItemParentIsHidden(o.parentkey,!0),!r)}}},getKendoCType:function(){return this.config.isContextMenu?"kendoContextMenu":"kendoKDMenu"},getKendoControl:function(){var e;return this.component&&(e=this.component.data(this.getKendoCType())),e},getKendoOptions:function(){var e,t=this,i={dataSource:[],select:function(e){var i=t.getButtonKey($(".kdmenuitem-content",$(e.item))[getPropName()]("id")),a=t.itemsMap[i];i!=t.btnCustomizeMenuId&&a&&0==a.disabled&&e.target&&e.target.hasClass("k-icon")?$(e.item).find(".k-animation-container ul").is(":visible")?this.close(e.item):this.open(e.item):t.clickHandler.call(t,e)},open:function(e){var i=t.getButtonKey($(".kdmenuitem-content",$(e.item))[getPropName()]("id")),a=t.itemsMap[i],n=$(e.item),o=window.getSelection&&window.getSelection()&&window.getSelection().toString();if(KD.isEmpty(o)||(t.selectValueOnClose=o),KD.equalsIgnoreCase(i,t.btnCustomizeMenuId)){if(!$(e.item).hasClass(t.btnCustomizeClickedClass))return void e.preventDefault();$(e.item).removeClass(t.btnCustomizeClickedClass)}if($(e.item).closest("ul").hasClass("kd-menu")&&a&&1==a.caninvokeoperation&&0==a.disabled&&e.target&&!$(e.target).hasClass("k-i-arrow-s")&&e.preventDefault(),a&&1==a.disabled&&0==a.caninvokeoperation)e.preventDefault();else if(t.config.isContextMenu){var r=t.config.parentcontrolproxy;r&&r._isShowContextMenu&&!r._isShowContextMenu.call(r)&&e.preventDefault()}else{var s=n.find(".k-menu-group");s.addClass("kd-toolbar-pop-container"),KD.isIeBrowser()&&s.addClass("kd-menubar-pop-container-iebrowser");
}if(t._isFromBtnCustomize($(e.item))){var l=t.getFormProxy(),d=l&&l.el&&l.el.height(),c=$(window).height();400>d||500>c?t.customizePopUpUlClass="kd-menu-ulcustomiseitem-miniform":t.customizePopUpUlClass="kd-menu-ulcustomiseitem",n.find(".kd-toolbar-pop-container").addClass(t.customizePopUpUlClass),KD.delayInvoke(function(){if(!KD.isEmpty(n)){var e=n.find(".k-animation-container"),t=n.width(),i=(e&&e.width(),0),a=0,o=e.find("li:visible");$.each(o,function(e){var t=$(this);if(a=0,!KD.isEmpty(t)){var n=t.find("div"),o=t.find("label"),r=n&&n.css("margin-left");r=parseInt(r);var s=n&&n.width(),l=o&&o.outerWidth();s&&s>0?(a=r+l+s,a>i&&(i=a)):i=a}}),e.css({width:i+10}),e.children("ul").css({width:i+10});var r=KD.isEmpty(e)?0:e.width();if(r>0&&t>0){var s=t-r+"px";e.addClass("kd-animationcontainer-btncustomise"),e.css({left:s})}}},200)}},scrollable:!0,popupCollision:"fit flip",activate:function(e){t.onActivate&&t.onActivate.call(t,e)}},a=this.getConfig();return e=a.bardata?a.bardata.items:KD.getValue(a,"items",[]),this.config.isContextMenu&&(i.target=this.config.targetEl),i.dataSource.push({text:'<span id="'+this.getButtonId("__more")+'" class="kdmenuitem-content"><span class="k-icon k-i-arrow-s"></span></span>',encoded:!1,direction:"bottom right",cssClass:"kdmenuitem-more"}),$.each(e,function(a){var n=e[a],o=t.getMenuItemOpt.call(t,n,0);!t.HasCustomizeItem&&n.isdefineshow&&t.config&&!t.config.isContextMenu&&(t.HasCustomizeItem=!0,i.closeOnClick=!1),i.dataSource.push(o)}),i},_isImageMenuButton:function(e){var t=!1;return e&&(t=e.icon&&e.showicon&&e.toolbarshowicon),t},getMenuItemClass:function(e,t){var i="kdmenuitem kdmenuitem-"+e.xtype+(t||"");return e.isrightfloat&&(i+=" "+this.rightItemClass,this.RightItemKeyList[e.id]=e),0==e.showdropsownicon&&(i+=" kd-menu-item-ignoredropicon"),this._isImageMenuButton(e)&&(i+=" kd-menu-item-image"),KD.isEmpty(e.customCssClass)||(i+="  "+e.customCssClass),i},getMenuItemOpt:function(e,t){var i={},a=this,n=this.getButtonId(e.id);a.itemsMap[e.id]=e;var o=e.text,r="",s=e.tooltip||"";switch(e.xtype){case"button":a._isImageMenuButton(e)&&(o="&nbsp;",a.rootUrl=a.rootUrl||KD.getUrlRoot(),r+=kendo.format("background-image:url({0});",KD.getImageUrlByNameAndVersion(a.rootUrl+"/"+a.defaultBtnIconUrl+"/"+e.icon))),i={text:kendo.format('<span id="{0}" class="kdmenuitem-content" style="{1}" title="{3}">{2}</span>',n,r,o,s),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1},e.isopenfiledialog&&(i.text+='<input tabindex="0" kdrole="kduploadfile" style="width:0;display:none" type="file" name="fileselect[]" size="28" multiple/>');break;case"splitbutton":var l="",d="";a._isImageMenuButton(e)&&(o="&nbsp;",a.rootUrl=a.rootUrl||KD.getUrlRoot(),r+=kendo.format("background-image:url({0});",KD.getImageUrlByNameAndVersion(a.rootUrl+"/"+a.defaultBtnIconUrl+"/"+e.icon))),1==e.forCustomize&&(l="customize",d="kdmenuitem-content-customize"),i={text:kendo.format('<span id="{0}" data-role="{1}" class="kdmenuitem-content {5}" style="{2}" title="{3}">{4}</span>',n,l,r,s,o,d),encoded:!1,enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),items:[]},e.items&&$.each(e.items,function(n){var o=e.items[n],r=a.getMenuItemOpt.call(a,o,t+1);$.extend(r,{id:a.getButtonId.call(a,e.id)}),i.items.push(r)}),(!e.items||e.items.length<=0)&&(i.items=[]);break;case"checkbox":if(e.targetKey&&!KD.IsNullOrWhiteSpace(e.targetKey)){var c="",t=e.level,h=e.checked;e.nodelevel>0&&(c=15*e.nodelevel+"px"),i={text:kendo.format('<div data-role="checkbox" class="kdmenuitem-content kdmenuitem-checkbox" style="margin-left:{4};" id="{0}" data-targetkey="{2}"><input type="checkbox" checked="{3}" data-checked="{5}" class="k-checkbox kd_Enter2tab" id="I_{0}"><label id="L_{0}" tabindex="-1" class="k-checkbox-label" for="I_{0}">{1}</label></div>',n,e.text,e.targetKey,h,c,h?!0:!1),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1}}else i={text:kendo.format('<div data-role="checkbox" class="kdmenuitem-content kdmenuitem-checkbox" id="{0}"  title=""><input type="checkbox" class="k-checkbox kd_Enter2tab" id="I_{0}"><label id="L_{0}" tabindex="-1" class="k-checkbox-label" for="I_{0}">{1}</label></div>',n,e.text),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1};break;case"separator":i={text:"",cssClass:this.getMenuItemClass(e,t>0?"-H":"-V"),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1};break;default:KD.Error.raise({sourceClass:"KDKendoMenuBarProxy",sourceMethod:"createBarItem",msg:"The '"+e.xtype+"' type has not been Spported"})}return $.extend(i,{id:n,cssClass:i.cssClass||this.getMenuItemClass(e)}),i},getButtonId:function(e){return this.getBaseId()+"-"+(e?e:"").replace(/[\(\),]/g,"")},getSplitButtonId:function(e){return this.getBaseId()+"_splitbtn-"+(e?e:"").replace(/[\(\),]/g,"")},getButtonKey:function(e){return e?e.substring(this.getBaseId().length+1):""},loadConfig:function(e){this.actionKey=e.actionKey?e.actionKey:"ToolBarItemClick";var t=this.getFormProxy();(t.dformConfig||t.config).isUseSmallScreenModel&&this.el.addClass("kd-menu-smallmodel"),KDKendoMenuBarProxy.superclass.loadConfig.call(this,e),this.setRequestLock(!0),this.barItems={},this.itemsMap={},this.RightItemList=[],this.shortcutkeyContainer=[],this.el.addClass("kd-menubar").css({width:"100%",border:"0px",overflow:"display",height:e.height}),this.setMainMenu(KD.getValue(e,"ismainmenu",!1)),this.setMainTabStyle(KD.getValue(e,"maintabstyle",!1))},isDontLazy:function(){return this.rendered&&this.activated},setActivate:function(e){var t=this;t.activated=e,t.isDontLazy()&&(t.doLazyAction(),t.doLayout())},onActivate:function(e){var t=(e.sender,$(e.item)),i=$(t.children()[0]),a=$(t.children()[t.children().length-1]);if(void 0!==i&&void 0!==a){var n=this.getFormProxy(),o=n.el.height(),r=$(window).height()-i.offset().top,s=i.height(),l=a.height(),d=o-s-6;if(a&&a.length>0&&(l>d&&a.css({top:c}),l>=d))if(l>r){var c=s;a.css({"max-height":d}),$("ul",a).css({"max-height":d,"overflow-y":"auto","overflow-x":"hidden"})}else a.css({position:"relative",top:"0px"}),t.width()>a.width()&&(a.width(t.width()),$("ul",a).css({width:"inherit"}))}},doLayout:function(){KDKendoMenuBarProxy.superclass.doLayout.call(this);var e=this;("MainGrayToolBarStyle"==this.getStyle()||"MainToolBarStyle"==this.getStyle())&&(this.el.hasClass("kd-el-floating")&&this.el.css({width:this.el.parent().width()}),e.sizeChange(!0),KDFloatingManager.instance.clearPageData(this.getPageId(),this.el,{dock:"top"}))},resetOverflow:function(){this.el.parent().parent().css("overflow","visible")},oldWidth:0,sizeChange:function(e){var t=this,i=KD.layout.getActualWidth(this.el),a=KD.layout.getActualHeight(this.el);if(this.component&&(i!=this.oldWidth||!e)){this.oldWidth=i;var n=0,o=0,r=this.component.data(this.getKendoCType()),s=this.component.children();if(s[0]){var l=$(s[0]).children("ul.k-menu-group");0==l.length&&(l=$(s[0]).children(".k-animation-container").children("ul.k-menu-group")),l.length>0&&(l=$(l[0]),s=this.component.append(l.children("li")).children())}var d=this.component.children("."+t.rightItemClass),i=KD.layout.getActualWidth(this.component)-$(s[0]).width()-2,c=[],h=[];$.each(d,function(e){var t=d[e];"none"!=$(t).css("display")&&(0==$(t).width()&&r&&r.append(t),n+=$(t).width()+.5+1),n>i?h.push(t):c.push(t),$(t).hasClass("kd-notification-menuBarstyle")?$(t).detach():r&&r.remove(t)}),o=n,$.each(s,function(e){var a=s[e];0!=e&&($(a).hasClass(t.rightItemClass)||("none"!=$(a).css("display")&&(0==$(a).width()&&r&&r.append(a),n+=$(a).width()+.5+1),n>i?h.push(a):c.push(a),r&&r.remove(a)))}),$.each(c,function(e){var t=c[e];$(t).hasClass("kd-notification-menuBarstyle")?r&&r.element.append(t):r&&r.append(t)}),$.each(h,function(e){var t=h[e];r&&r.append(t,s[0])});var u=$(".kdmenuitem-more",this.component),p=this.getBarItemById(this.btnCustomizeMenuId);if(h.length>0){if(o+=u.outerWidth(),u.show().css({right:o+"px"}),p&&!KD.isEmpty(p)){var g=u.width();p.css({right:-1*g+"px"})}var f=this.getKendoOptions()||{};this.component[this.getKendoCType()]({direction:"bottom left",open:f.open,closeOnClick:!this.HasCustomizeItem})}else u.hide(),!KD.isEmpty(p)&&p.css({right:""});var m=this.component.children(".kdmenuitem-checkbox").has(":visible");if(!KD.isEmpty(m)&&m.length>0&&$.each(m,function(e){a>0&&$(m[e]).css({height:a+"px"})}),this.HasCustomizeItem){var v=$("."+t.customizePopUpUlClass,this.component);v.length>0&&v.scrollTop(t.ulCustomiseBtnLastScrollTop)}if(t.hasHelpAssistantBtn&&t.helpBtnData){var y=t.helpBtnData.key,b=t.helpBtnData.hoveicon,D=t.helpBtnData.icon,k=t.menuBtns&&t.menuBtns.find("#"+t.baseId+"-"+y),C=k.parent();C.off("mouseenter").on("mouseenter",function(e){var t=$(e.currentTarget);t.children().css("background-image","url(../images/silverlight/default/toolbar/"+b+"?version="+KD.getVersion()+")")}),C.off("mouseleave").on("mouseleave",function(e){var t=$(e.currentTarget);t.children().css("background-image","url(../images/silverlight/default/toolbar/"+D+"?version="+KD.getVersion()+")")})}}},initComponent:function(){var e=KDFlowlayoutProxy.getFlowLayoutInlineStyleOptions(this.getConfig());delete e["min-height"],this.InlineStyle=$.extend(this.InlineStyle||{},e);var t=this.getKendoOptions();this.component=$('<ul style="padding-left: 0px;margin-top: -3px;" class="kd-menu">').appendTo(this.el)[this.getKendoCType()](t),this.menuBtns=this.component.children();var i=this;$.each(this.menuBtns,function(e){var t=i.menuBtns[e];$(t)[getPropName()]("data-width",$(t).outerWidth(!0))}),$(".kdmenuitem",this.component).css({"border-width":0}),$(".kdmenuitem-separator-H",this.component).css({"padding-top":"0px","padding-bottom":"0px"}),$(".kdmenuitem-more",this.component).css({"float":"right","border-width":0}),$(".kdmenuitem-more .k-link",this.component).css({"padding-left":0}),$(".kdmenuitem-more .k-menu-group .k-item",this.component).length?$(".kdmenuitem-more",this.component).show():$(".kdmenuitem-more",this.component).hide(),this.setInlineStyle(),this.component.css({height:this.config.height-3,width:"auto"}),this.el.addClass(this.getStyleKey()),this.setVisible(KD.getValue(this.config,"visible",!0)),this.rendered=!0,this.enableOrDisVisbleItems=[];var a;a=this.config.bardata?KD.getValue(this.config.bardata,"items",[]):KD.getValue(this.config,"items",[]),this._getEnableOrDisVisbleItems(a),this.HasCustomizeItem&&(null==this.CustomizeMnuItems&&(this.CustomizeMnuItems=[]),this._addCustomizeBtnForBillMenu(),this.menuBtns=this.component.children()),this.enableOrDisVisbleItems.length>0?this.setBarItemStates(this.enableOrDisVisbleItems):this.sizeChange.call(this,!1);for(var n in this.RightItemKeyList){var o=this.getBarItemById(n);KD.isEmpty(o)||this.RightItemList.push(o)}for(var r in this.itemsMap)if(this.itemsMap[r].shortcut){var s=KD.cloneObject(this.itemsMap[r]);s.shortcut=this.itemsMap[r].shortcut.replace(/\s*/g,"").split("+"),this.shortcutkeyContainer.push(s)}},loadLayoutSetting:function(e){try{var t=this;if(!KD.isEmpty(e)&&!KD.isEmpty(this.CustomizeMnuItems)){var i=e.define||{};if(KD.isEmpty(i))return;var a=i.dc||{};if(!KD.isEmpty(a))for(var n,o,r=0;r<a.length;r++){if(n=a[r].dk||"",o=KD.isEmpty(a[r].c)?"":a[r].c,KD.isEmpty(n)||KD.isEmpty(o))return;if(KD.equalsIgnoreCase(o.toString(),"0")){t._setToolBarItemVisible(n,!1);var s=(t.el.children("ul"),this.getBarItemById(this.btnCustomizeMenuId)),l=s.find("div[data-targetkey="+n+"] input[type=checkbox]");l[getPropName()]("checked",!1),l.attr("data-checked",!1)}}}}catch(d){KD.writeError(d)}},getLayoutSetting:function(){try{if(this.CustomizeMnuItems&&this.CustomizeMnuItems.length>0){var e={},t={};e.define=t;var i=[];t.dc=i;var a=this.getBarItemById(this.btnCustomizeMenuId);if(!a||KD.isEmpty(a))return;for(var n=a.find("ul.k-menu-group"),o=!KD.isEmpty(n)&&n.find("li.kd-customiseli-show"),r=0;r<o.length;r++){var s=$(o[r]);if(KD.isEmpty(s))return;var l=KD.isEmpty(s.find("div[data-role=checkbox]"))?"":s.find("div[data-role=checkbox]").attr("data-targetkey"),d=KD.isEmpty(s.find("input[type=checkbox]"))?"":s.find("input[type=checkbox]").attr("data-checked");if(KD.IsNullOrWhiteSpace(l))return;var c=KD.IsNullOrWhiteSpace(d)?1:KD.equalsIgnoreCase(d,"true")?1:0,h={dk:l,c:c};i.push(h)}return KD.isEmpty(e)?null:e}return null}catch(u){return KD.writeError(u),null}},getLayoutSettingIsbecommon:function(){return"1"},_addCustomizeBtnForBillMenu:function(){var e=this,t=e.config&&e.config.items;if(!KD.isEmpty(t)){var i={};i.id=e.btnCustomizeMenuId,i.text=ResManager.LoadKDString("菜单自定义","014003000003638"),i.tooltipType=ResManager.LoadKDString("菜单自定义","014003000003638"),i.tooltip=ResManager.LoadKDString("菜单自定义","014003000003638"),i.visible=!0,i.xtype="splitbutton",i.showTitle=!0,i.forCustomize=!0,i.isrightfloat=!0,i.icon="tbtn_menudefine_h5.png",i.showicon=!0,i.toolbarshowicon=!0,i.showdropsownicon=!1;var a=[],n=[];this.CustomizeMnuItems=e._findItemByRecursiveConfigItem(t,0,a,n),i.items=this.CustomizeMnuItems;for(var o,r,s,l=0;l<=t.length-1;l++)if(!KD.isEmpty(t[l])&&(r=t[l].visible||!1,s=t[l].xtype||"",1==r&&"separator"!=s)){o=t[l];break}o&&!KD.IsNullOrWhiteSpace(o.id)&&e.addItem(i,o.id,!0)}},_addCustomizeBtnForHelpAssistant:function(){var e=this;if(!this.hasHelpAssistantBtn){this.hasHelpAssistantBtn=!0;var t=e.config&&e.config.items;if(!KD.isEmpty(t)){var i={};i.id=e.btnHelpAssistantId,i.text=ResManager.LoadKDString("帮助助手","0025710000004792"),i.tooltipType=ResManager.LoadKDString("帮助助手","0025710000004792"),i.tooltip=ResManager.LoadKDString("帮助助手","0025710000004792"),i.visible=!0,i.xtype="button",i.showTitle=!0,i.forCustomize=!0,i.isrightfloat=!0,i.icon="tbtn_Bulb.png",i.showicon=!0,i.toolbarshowicon=!0;for(var a,n,o,r=0;r<=t.length-1;r++)if(!KD.isEmpty(t[r])&&(n=t[r].visible||!1,o=t[r].xtype||"",1==n&&"separator"!=o)){a=t[r];break}a&&!KD.IsNullOrWhiteSpace(a.id)&&e.addItem(i,a.id,!0)}}},_findItemByRecursiveConfigItem:function(e,t,i,a,n){for(var o=this,r=i,s=a,l=0;l<e.length;l++){var d=e[l]&&e[l].items,c=e[l],h=o._setItemNodeInfo(c,t,n);if(h&&r.push(h)&&a.push(e[l]),d&&d.length>0){var u=c.id;o._findItemByRecursiveConfigItem(d,t+1,r,s,u)}}return i},_setItemNodeInfo:function(e,t,i){var a={};if(!("separator"==e.xtype||e.visible&&1!=e.visible||KD.IsNullOrWhiteSpace(e.text)))return a.id="__definesub__"+e.id,a.targetKey=e.id,a.caninvokeoperation=!1,a.text=e.text,a.showTitle=!0,a.tooltipType="title",a.visible=e.visible,a.xtype="checkbox",a.checked=!0,a.nodelevel=t||0,a.parentkey=i?i:"",a},_setToolBarItemVisible:function(e,t){try{var i=this;if(!e&&!KD.IsNullOrWhiteSpace(e))return;var a=this.getButtonId(e);a="#"+a;var n=$(a,i.el);if("kdmenubar_Galaxy"==this.xtype){var o=n.parent(".kdmenuitem-divcontent-galaxy,.kdmenuitem-content");o.length>0&&(n=o)}var r=!KD.isEmpty(n)&&n.parent("span"),s=KD.isEmpty(r)||KD.isEmpty(r.parent("li"))?null:r.parent("li");if(!s||KD.isEmpty(s))return;t?(s.removeClass("kd-customiseli-hide"),s.addClass("kd-customiseli-show")):(s.removeClass("kd-customiseli-show"),s.addClass("kd-customiseli-hide"))}catch(l){KD.writeError(l)}},_checkMenuItemParentIsHidden:function(e,t){var i,a,n=this,o=this.getBarItemById(this.btnCustomizeMenuId);if(n.CustomizeMnuItems&&n.CustomizeMnuItems.length>0)for(var r=0;r<n.CustomizeMnuItems.length;r++)if(i=n.CustomizeMnuItems[r],KD.equalsIgnoreCase(e,i.targetKey)){if(a=t?o.find("div[data-targetkey="+i.targetKey+"] input[type=checkbox]").prop("checked"):i.visible,0==a)return!0;if(KD.IsNullOrWhiteSpace(i.parentkey))return 1==a?!1:!0;n._checkMenuItemParentIsHidden(i.parentkey)}return!1},_bindClickEventForCustomiseBtn:function(e){if(!KD.isEmpty(e)){var t=this,i=e.find("[data-role=checkbox]"),a=!KD.isEmpty(i)&&i.attr("data-targetkey"),n=!KD.isEmpty(e)&&e.find("input[type=checkbox]"),o=!KD.isEmpty(n)&&n.attr("data-checked"),r={dataTargetKey:a,checkinput:n,checked:o};!KD.isEmpty(o)&&KD.delayInvoke(function(e){t._setToolBarItemByCheckEvent(e)},100,!0,r)}},_setToolBarItemByCheckEvent:function(e){var t=this,i=KD.equalsIgnoreCase(e.checked.toString(),"true")?!1:!0,a=e.checkinput,n=e.dataTargetKey,o=t.config&&t.config.items;a[getPropName()]("checked",i),a.attr("data-checked",i);var r=[],o=t.config&&t.config.items,s=t.CustomizeMnuItems;i?s.length>0&&t._findParentsFromChild(s,n,r):o.length>0&&t._findChildrenItemFromParentID(o,n,r),r.length>0&&t._setTargetItemCheckedStatus(i,r),$.each(t.CustomizeMnuItems,function(e){var a=t.CustomizeMnuItems[e];KD.equalsIgnoreCase(a.targetKey,n)&&(a.visible=i,t._setToolBarItemVisible(n,a.visible),KD.writeLog(kendo.format("_bindClickEventForCustomiseBtn: dataTargetKey {0} item {1}.",n,i?"show":"hide")))}),t.sizeChange(!1)},_setTargetItemCheckedStatus:function(e,t){var i=this;if(!KD.isEmpty(t)&&0!=t.length)for(var a,n=i.getBarItemById(this.btnCustomizeMenuId),o="",r="",s=0;s<t.length;s++){var l=t[s];o=kendo.format("__definesub__{0}",l),r=this.getButtonId(o),r=kendo.format("I_{0}",r),a=$("#"+r,n),a&&a[getPropName()]("checked",e)&&a.attr("data-checked",e),i._setToolBarItemVisible(l,e)}},_findChildrenItemFromParentID:function(e,t,i){try{for(var a=this,n=0;n<e.length;n++){var o=e[n]&&e[n].items,r=e[n];KD.IsNullOrWhiteSpace(t)&&i.push(r.id),KD.equalsIgnoreCase(r.id,t)?r.items&&r.items.length>0&&a._findChildrenItemFromParentID(r.items,"",i):o&&o.length>0&&a._findChildrenItemFromParentID(o,t,i)}}catch(s){KD.writeError("KDKendoMenuBarProxy _findChildrenItemFromParentID Exception:"+s)}},_findParentsFromChild:function(e,t,i){try{var a=this;if(KD.isEmpty(e)||0==e.length)return;for(var n=0;n<e.length;n++){var o=e[n];if(KD.equalsIgnoreCase(o.targetKey,t)){if(KD.isEmpty(o.parentkey))break;i.push(o.parentkey),a._findParentsFromChild(e,o.parentkey,i)}}}catch(r){KD.writeError("KDKendoMenuBarProxy _findParentsFromChild Exception:"+r)}},_isFromBtnCustomize:function(e){if(KD.isEmpty(e))return!1;var t=e.find("span[data-role=customize]");return!KD.isEmpty(t)&&t.length>0?!0:!1},_getEnableOrDisVisbleItems:function(e){for(var t=0;t<e.length;t++){if(0==e[t].visible||e[t].disabled&&1==e[t].disabled||"checkbox"==e[t].xtype){var i={};i.key=e[t].id,i.visible=e[t].visible,i.disabled=e[t].disabled,i.xtype=e[t].xtype,i.checked=e[t].checked,this.enableOrDisVisbleItems.push(i)}e[t].items&&this._getEnableOrDisVisbleItems(e[t].items)}},setToolTip:function(e){},setBarItemStates:function(e){for(var t,i=this,a=e.length,n=this.component.data(this.getKendoCType()),o=0;o<e.length;o++){if(t=e[o],i.CustomizeMnuItems&&i.CustomizeMnuItems.length>0)for(var r=!1,s=0;s<i.CustomizeMnuItems.length;s++){var l=i.CustomizeMnuItems[s];if(t.key&&l.targetKey&&KD.equalsIgnoreCase(t.key,l.targetKey)){if(KD.IsNullOrWhiteSpace(l.parentkey)||(r=i._checkMenuItemParentIsHidden(l.parentkey)),1==r)i._setToolBarItemVisible(l.id,!1),l.visible=!1;else if(0==t.visible)i._setToolBarItemVisible(l.id,!1),l.visible=!1;else{var d;d=s>0?i.CustomizeMnuItems[s-1]:i.CustomizeMnuItems[0],i._setToolBarItemVisible(l.id,!0),l.visible=!0}break}}!KD.isEmpty(this.itemsMap[t.key])&&KD.isObject(t)&&$.extend(this.itemsMap[t.key],t);var c=this.getButtonId(t.key),h="#"+c,u=$(h),p=u.closest("li.kdmenuitem");if(p&&p.length){void 0!=t.visible&&(t.visible?p.show():p.hide(),p[getPropName()]("data-hidden",!t.visible)),1==t.disabled?(n&&p.addClass("kd-menubtn-disabled"),p.removeClass("kendo-color")):(n&&p.addClass("kendo-color"),p.removeClass("kd-menubtn-disabled")),void 0!=t.text&&$("#"+c,this.component).text(t.text),t.click&&!p.hasClass("kd-menubtn-disabled")&&(p.click=t.click),"checkbox"==t.xtype&&void 0!=t.checked&&$("#I_"+c,this.component)[getPropName()]("checked",t.checked),t.icon&&"__defnewhepler__"==t.key&&($("#"+c,p).css("background-image","url(../images/silverlight/default/toolbar/"+t.icon+"?version="+KD.getVersion()+")"),i.helpBtnData=t),t.tipscontent&&this._setMenuBarTipsContent(t)}else a--}for(var g=this.el.find("ul"),f=0;f<g.length;f++)for(var m=0;m<g[f].childNodes.length;m++)($(g[f].childNodes[m]).hasClass("kdmenuitem-separator-H")||$(g[f].childNodes[m]).hasClass("kdmenuitem-separator-V"))&&this._setSeparatorState(g[f].childNodes[m]);if(!this.config.isContextMenu){this.lastVisible=this.visible;var v=!1,y=this.config&&this.config.items;if(!KD.isEmpty(y)&&y.length>0)for(var o=0;o<=y.length-1;o++)if(itemVisible=y[o]&&y[o].visible,1==itemVisible){v=!0;break}v&&0==this.visible&&(v=!1),v?(this.setVisible(!0),this.component.show()):(this.setVisible(!1),this.component.hide()),KD.delayInvoke(function(){i.sizeChange.call(i,!1),i._setIsShowIcon.call(i,e)},300)}},setRightItemKey:function(e){var t,i,a=(e||"").split(",");this.RightItemList=this.RightItemList||[];for(var n in a)t=a[n],i=this.getBarItemById(t),KD.isEmpty(i)||($(i).addClass(this.rightItemClass),this.RightItemList.push(i))},_setSeparatorState:function(e){e=$(e);for(var t=e.next(),i=!1,a=0;a<e.nextAll().length;a++){if(t.length>0&&"none"!=$(t).css("display")){t.hasClass("kdmenuitem-separator-H")||t.hasClass("kdmenuitem-separator-V")||(i=!0);break}t=t.next()}for(var n=e.prev(),o=!1,a=0;a<e.prevAll().length;a++){if(n.length>0&&"none"!=$(n).css("display")){n.hasClass("kdmenuitem-separator-H")||n.hasClass("kdmenuitem-separator-V")||(o=!0);break}n=n.prev()}i&&o?e.removeClass("kd-ui-hiddenElem"):e.addClass("kd-ui-hiddenElem")},_setIsShowIcon:function(e){for(var t,i,a,n,o=!1,r=0;r<e.length;r++)if(t=this.getButtonId(e[r].key),i=this.el.find("#"+t),a=i.closest("li.kdmenuitem"),n=a.find(".k-menu-group"),o=!1,n.length>0){n=$(n[0]);for(var s=n.children(),l=0;l<s.length;l++)if("none"!=$(s[l]).css("display")){o=!0;break}1==o?a.find(".k-icon").removeClass("kd-ui-hiddenElem"):a.find(".k-icon").addClass("kd-ui-hiddenElem")}},setVisible:function(e){if(this.visible=e,this.lastVisible!=this.visible){var t=this.getFormProxy();t.updateMainMenuPanelHeight.call(t,this.visible,this.config)}},addItem:function(e,t,i){var a=this;1==e.disabled&&(e.customCssClass=e.customCssClass+" "+this.disabledClass);var n=a.getMenuItemOpt.call(a,e,0),o=this.component.data(this.getKendoCType());if(o&&o.insertAfter&&n){var r=$("#"+a.getButtonId(t)),s=r.closest("li");i?o.insertBefore(n,s):o.insertAfter(n,s),this.menuBtns=this.component.children()}},removeItem:function(e){var t=this,i=this.component.data(this.getKendoCType());if(i&&i.remove){var a=$("#"+t.getButtonId(e)),n=a.closest("li");i.remove(n)}},setItemProperty:function(e,t){},getItem:function(e){var t=this.getButtonId(e),i=$("#"+t,this.el);return i},_getBarItemKeyIngoreCase:function(e){var t="";for(var i in this.itemsMap)if(KD.equalsIgnoreCase(i,e)){t=i;break}return t},getBarItemById:function(e,t){var i,a=null;t&&(e=this._getBarItemKeyIngoreCase(e));var n=this.getButtonId(e);if(!KD.isEmpty(this.menuBtns))for(var o=0;o<this.menuBtns.length;o++)if(i=$(this.menuBtns[o]),!i.hasClass("kdmenuitem-more")&&i.find("#"+n).length>0){a=i;break}return a},setMainMenu:function(e){this.IsMainMenu=e,e&&(this.style="2")},setAllowDefineItem:function(e){if(this.AllowDefineItem=e,!e){var t=this.getBarItemById(this.btnCustomizeMenuId);KD.isEmpty(t)||t&&t.hide()}},setAllowHelpAssistant:function(e){e&&this._addCustomizeBtnForHelpAssistant();var t=ClientAppProxy.Current.getMainTab();t&&t.setAllowHelpAssistant&&t.setAllowHelpAssistant.call(t,e)},setBarItemBeginTwinkle:function(e,t,i){if(!KD.isNaN(parseFloat(i))&&0!=parseFloat(i)&&this.itemsMap&&this.itemsMap[e]){var a=this.menuBtns&&this.menuBtns.find("#"+this.baseId+"-"+e);!t||KD.isString(t)&&"FALSE"===t.toUpperCase()?a.removeClass("kd-messagering-animate"):(a.addClass("kd-messagering-animate"),i=1e3*parseFloat(i),KD.delayInvoke(function(){a.removeClass("kd-messagering-animate")},i))}},_setMenuBarTipsContent:function(e){var t=e.tipscontent;if(!KD.isEmpty(t)){var i=e.key;if(i&&this.itemsMap&&this.itemsMap[i]){var a=this.getFormProxy();t.formpxy=a,t.ctlId=this.baseId+"-"+i+"-kdtooltip";var n=this.component.find("#"+this.getButtonId(i)),o=n.parent().parent();o.get(0).tipsObj=t}}},style:"1",setStyle:function(e){this.style=e},getStyle:function(){return"1"==this.style?"MainGrayToolBarStyle":"MainToolBarStyle"},setMainTabStyle:function(e){this.MainTabStyle!=e&&(this.MainTabStyle=e,e&&(this.style="2"))},onScroll:function(e,t){0!=this.visible&&this._adjustFloat(e,t)},_adjustFloat:function(e,t){var i=this.el;if($("body").find(i).length>0&&i.length>0&&"none"!=i.css("display")&&i.parent().length>0){KD.isEmpty(this.topPosition)&&(this.topPosition=i.css("top"));var a=t.top;KDFloatingManager.instance.duckList[this.baseId]&&(a+=KDFloatingManager.instance.duckList[this.baseId].top.totalPx);var n=t.left;i.winOffset=t;var o=i.parent().children(".kd-menubar-el-placeholder");0==o.length&&(o=$(kendo.format('<div class="kd-menubar-el-placeholder" style="z-index:-9999;display:none;width:1px;height:{0}px">',i.height())),i.parent().prepend(o));var r=KD.CONST.IsBillHeadFloat?i.parent().offset().top-KD.getBillHeadHeight(!1):i.parent().offset().top,s=KD.CONST.IsBillHeadFloat?0:this.getFormProxy().el.offset().top,l=this.getFormProxy().el.height(),d=i.height();if(a>r&&s+l-d>a){var c={dock:"top",WidthOrHeightName:"width",ParentWidthOrHeightValue:KD.layout.getActualWidth(i),otherSideDockName:"left",otherSideDockValue:i.parent().offset().left-n};KDFloatingManager.instance.setFloat(this.getPageId(),i,c),i.hasClass("kd-el-floating")&&o.show(),i.addClass("kd-menubar-el-floating")}else i.hasClass("kd-el-floating")?(o.hide(),KDFloatingManager.instance.setSink(this.getPageId(),i),i.css({top:this.topPosition}).removeClass("kd-menubar-el-floating")):(o.hide(),i.removeClass("kd-menubar-el-floating"))}},release:function(){KDFloatingManager.instance.release(this.getPageId(),this.el,{dock:"top"});var e=this.component&&this.component.data(this.getKendoCType());e&&e.destroy(),KDKendoMenuBarProxy.superclass.release.call(this)}}),KDControlFactoryProxy.registerType("kdmenubar",KDKendoMenuBarProxy),define("KDKendoMenuBarProxy",["KDControlProxy","KD"],function(e){return function(){var t;return t||e.KDKendoMenuBarProxy}}(this)),KDMenuBarProxy_Galaxy=KD.extend(KDKendoMenuBarProxy,{loadConfig:function(e){KDMenuBarProxy_Galaxy.superclass.loadConfig.call(this,e)},initComponent:function(){KDMenuBarProxy_Galaxy.superclass.initComponent.call(this),this.el.children("ul").addClass("kd-menu-galaxy")},getKendoOptions:function(){var e,t=this,i={dataSource:[],select:function(e){var i=t.getButtonKey($(".kdmenuitem-content",$(e.item))[getPropName()]("id")),a=t.itemsMap[i];i!=t.btnCustomizeMenuId&&a&&0==a.disabled&&e.target&&e.target.hasClass("k-icon")?$(e.item).find(".k-animation-container ul").is(":visible")?this.close(e.item):this.open(e.item):t.clickHandler.call(t,e)},open:function(e){var i=t.config&&t.config.isContextMenu;i&&e.sender&&e.sender.popup&&e.sender.popup.element.length&&e.sender.popup.element.addClass("kdmenu-galaxy-contextpopup");var a=t.getButtonKey($(".kdmenuitem-content",$(e.item))[getPropName()]("id")),n=t.itemsMap[a],o=$(e.item);if(KD.equalsIgnoreCase(a,t.btnCustomizeMenuId)){if(!$(e.item).hasClass(t.btnCustomizeClickedClass))return void e.preventDefault();$(e.item).removeClass(t.btnCustomizeClickedClass)}if($(e.item).closest("ul").hasClass("kd-menu")&&n&&1==n.caninvokeoperation&&0==n.disabled&&e.target&&!$(e.target).hasClass("k-i-arrow-s")&&e.preventDefault(),n&&1==n.disabled&&0==n.caninvokeoperation)e.preventDefault();else{var r=o.find(".k-menu-group");r.addClass("kd-toolbar-pop-container"),KD.isIeBrowser()&&r.addClass("kd-menubar-pop-container-iebrowser")}if(t._isFromBtnCustomize($(e.item))){var s=t.getFormProxy(),l=s&&s.el&&s.el.height(),d=$(window).height();400>l||500>d?t.customizePopUpUlClass="kd-menu-ulcustomiseitem-miniform":t.customizePopUpUlClass="kd-menu-ulcustomiseitem",o.find(".kd-toolbar-pop-container").addClass(t.customizePopUpUlClass),KD.delayInvoke(function(){if(!KD.isEmpty(o)){var e=o.find(".k-animation-container"),t=o.width(),i=(e&&e.width(),0),a=0,n=e.find("li:visible");$.each(n,function(e){var t=$(this);if(a=0,!KD.isEmpty(t)){var n=t.find("div"),o=t.find("label"),r=n&&n.css("margin-left");r=parseInt(r);var s=n&&n.width(),l=o&&o.outerWidth();s&&s>0?(a=r+l+s,a>i&&(i=a)):i=a}}),e.css({width:i+10}),e.children("ul").css({width:i+10});var r=KD.isEmpty(e)?0:e.outerWidth(!0);if(r>0&&t>0){var s=t-r+"px";e.addClass("kd-animationcontainer-btncustomise"),e.css({left:s})}}},200)}},scrollable:!0,popupCollision:"fit flip",activate:function(e){t.onActivate&&t.onActivate.call(t,e)}},a=this.getConfig();return e=a.bardata?a.bardata.items:KD.getValue(a,"items",[]),this.config.isContextMenu&&(i.target=this.config.targetEl),i.dataSource.push({text:'<span id="'+this.getButtonId("__more")+'" class="kdmenuitem-content"><span class="k-icon k-i-arrow-s"></span></span>',encoded:!1,direction:"bottom right",cssClass:"kdmenuitem-more"}),$.each(e,function(a){var n=e[a];0===a&&(n.isFirstItem=!0);var o=t.getMenuItemOpt.call(t,n,0);!t.HasCustomizeItem&&n.isdefineshow&&t.config&&!t.config.isContextMenu&&(t.HasCustomizeItem=!0,i.closeOnClick=!1),i.dataSource.push(o)}),i},getMenuItemOpt:function(e,t){KDMenuBarProxy_Galaxy.superclass.getMenuItemOpt.call(this,e,t);var i={},a=this,n=this.getButtonId(e.id);a.itemsMap[e.id]=e;var o=KD.isIeBrowser()?"line-height:normal;":"",r=e.text,s=e.tooltip||"";switch(e.xtype){case"button":a._isImageMenuButton(e)&&(r="&nbsp;",a.rootUrl=a.rootUrl||KD.getUrlRoot(),o+=kendo.format("background-image:url({0});",KD.getImageUrlByNameAndVersion(a.rootUrl+"/"+a.defaultBtnIconUrl+"/"+e.icon))),i={text:kendo.format('<div id="div_{0}" class="kdmenuitem-divcontent-galaxy"  title="{3}"><span id="{0}" style="{1}" class="kdmenuitem-content">{2}</span></div>',n,o,r,s),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1},e.isopenfiledialog&&(i.text+='<input tabindex="0" kdrole="kduploadfile" style="width:0;display:none" type="file" name="fileselect[]" size="28" multiple/>');break;case"splitbutton":var l="",d="";a._isImageMenuButton(e)&&(r="&nbsp;",a.rootUrl=a.rootUrl||KD.getUrlRoot(),o+=kendo.format("background-image:url({0});",KD.getImageUrlByNameAndVersion(a.rootUrl+"/"+a.defaultBtnIconUrl+"/"+e.icon))),1==e.forCustomize&&(l="customize",d="kdmenuitem-content-customize"),i={text:kendo.format('<div id="div_{0}" class="kdmenuitem-divcontent-galaxy {5}" title="{3}"><span data-role="{1}" id="{0}" style="{2}" class="kdmenuitem-content">{4}</span></div>',n,l,o,s,r,d),encoded:!1,enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),items:[]},e.items&&$.each(e.items,function(n){var o=e.items[n],r=a.getMenuItemOpt.call(a,o,t+1);$.extend(r,{id:a.getButtonId.call(a,e.id)}),i.items.push(r)}),(!e.items||e.items.length<=0)&&(i.items=[]);break;case"checkbox":if(e.targetKey&&!KD.IsNullOrWhiteSpace(e.targetKey)){var c="",t=e.level,h=e.checked;e.nodelevel>0&&(c=15*e.nodelevel+"px"),i={text:kendo.format('<div data-role="checkbox" class="kdmenuitem-content kdmenuitem-checkbox" style="margin-left:{4};" id="{0}" data-targetkey="{2}"><input type="checkbox" checked="{3}" data-checked="{5}" class="k-checkbox kd_Enter2tab" id="I_{0}"><label id="L_{0}" tabindex="-1" class="k-checkbox-label" for="I_{0}">{1}</label></div>',n,e.text,e.targetKey,h,c,h?!0:!1),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1}}else i={text:kendo.format('<div data-role="checkbox" class="kdmenuitem-content kdmenuitem-checkbox" id="{0}"  title=""><input type="checkbox" class="k-checkbox kd_Enter2tab" id="I_{0}"><label id="L_{0}" tabindex="-1" class="k-checkbox-label" for="I_{0}">{1}</label></div>',n,e.text),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1};break;case"separator":i={text:"",cssClass:this.getMenuItemClass(e,t>0?"-H":"-V"),enable:!KD.getValue(e,"disabled",!1),hidden:!KD.getValue(e,"visible",!0),encoded:!1};break;default:KD.Error.raise({sourceClass:"KDKendoMenuBarProxy",sourceMethod:"createBarItem",msg:"The '"+e.xtype+"' type has not been Spported"})}return $.extend(i,{id:n,cssClass:i.cssClass||this.getMenuItemClass(e)}),i},getMenuItemClass:function(e,t){var i=(e.isFirstItem?"kdmenuitem-firstligalaxy":"")+" kdmenuitem kdmenuitem-ligalaxy kdmenuitem-galaxy-"+e.xtype+(t||""),a=e.cssClass||i;
return"separator"!=e.xtype&&(a+=" kd-toolbar-gridtoolbar ",a+=0==e.caninvokeoperation?" k-split-button-arrow ":""),e.isrightfloat&&(a+="kdmenuitem kdmenuitem-"+e.xtype+(t||""),a+=" "+this.rightItemClass,this.RightItemKeyList[e.id]=e),0==e.showdropsownicon&&(a+=" kd-menu-item-ignoredropicon"),this._isImageMenuButton(e)&&(a+=" kd-menu-item-image"),KD.isEmpty(e.customCssClass)||(a+="  "+e.customCssClass),a}}),KDControlFactoryProxy.registerType("kdmenubar_Galaxy",KDMenuBarProxy_Galaxy),define("KDMenuBarProxy_Galaxy",["KDKendoMenuBarProxy"],function(e){return function(){var t;return t||e.KDMenuBarProxy_Galaxy}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.Widget,o=n.extend({_uid:null,inputEl:null,labelEl:null,init:function(t,a){var o=this;o._uid=i.guid()+"_switch",n.fn.init.call(this,t,a),o.inputEl=e("<input>"),o.inputEl.attr("type","checkbox"),o.inputEl.addClass("KD-switch-input"),o.inputEl.id&&""!=o.inputEl.id||(o.inputEl.id=o._uid,o.inputEl.attr("id",o._uid)),o.inputEl.change(function(e){if(a.change){var t=o.inputEl.prop("checked");o._updateByValue.call(o,t),a.change.call(o,e,t)}}),o.labelEl=e('<span class="kd-switch-label kd-switch-active"><span>'+a.label+"</span></span>"),o.swithEl=e('<span class="kd-switch-core" style="width: 40px;"></span>'),e(t).addClass("kd-switch").append(o.inputEl).append(o.swithEl).append(o.labelEl),o.swithEl.off("click").on("click",function(e){if(o._enable){var t=o.inputEl.prop("checked");o._updateByValue.call(o,!t),a.change.call(o,e,!t)}})},options:{name:"Switch",label:""},_updateByValue:function(e){var i=this;e!=t&&(this._value=e,e?i.element.addClass("kd-switch-ischecked"):i.element.removeClass("kd-switch-ischecked"),i.inputEl.prop("checked",e))},value:function(e){this._updateByValue(e);var t=this.inputEl.prop("checked");return t},enable:function(e){var i=this;return e!=t&&(this._enable=e,this.inputEl.attr("disabled",!e),e?i.element.removeClass("kd-switch-disabled"):i.element.addClass("kd-switch-disabled")),!this.inputEl.attr("disabled")}});a.plugin(o)}(window.kendo.jQuery),define("KDSwitch",["KD"],function(e){return function(){var t;return t||e.KDSwitch}}(this)),KDSwitchProxy=KD.extend(KDCheckBoxProxy,{getKendoCType:function(){return"kendoSwitch"},loadConfig:function(e){KDSwitchProxy.superclass.loadConfig.call(this,e),this.fireUpdate=e.fireUpdate&&1==e.fireUpdate,void 0==this.fireUpdate&&(this.fireUpdate=e.item&&e.item.fireUpdate&&1==e.item.fireUpdate)}}),KDControlFactoryProxy.registerType("kdswitch",KDSwitchProxy),define("KDSwitchProxy",["KDCheckBoxProxy","KDSwitch","KD"],function(e){return function(){var t;return t||e.KDSwitchProxy}}(this)),define("KDSplitContainer",function(){}),KDSplitContainerProxy=KD.extend(KDContainerProxy,{splitbarSize:12,splitPosition:void 0,createControl:function(e){var t=this;switch(this.config=e,this.el=$('<div splitter="el">'),e.dock){case KD.dock.None:this.el=$('<div splitter="el">').css({width:e.width,height:e.height});break;case KD.dock.Top:case KD.dock.Bottom:this.el=$('<div splitter="el">').css({height:e.height});break;case KD.dock.Left:case KD.dock.Right:this.el=$('<div splitter="el">').css({width:e.width});break;case KD.dock.Fill:}this.content=$("<div splitter='All' class='k-ui-noborder' style='height:inherit'><div id='"+this.baseId+"_first' splitter='first'></div><div id='"+this.baseId+"_last' splitter='two'></div></div>").appendTo(this.el),this.splitterFirst=t.content.find("div[splitter='first']"),this.splitterTwo=t.content.find("div[splitter='two']");var i=this.getCType();return this.el.attr("id",this.baseId),this.el.dock=this.config.dock,null==i&&(this.el.proxy=this),KD.setAttachmentData(this.el,e),this.el},loadConfig:function(e,t){var i=this;KDSplitContainerProxy.superclass.loadConfig.call(i,e,t)},loadChildren:function(e){var t=this;KDSplitContainerProxy.superclass.loadChildren.call(t,e)},createInnerControl:function(e){var t=this,i=t.getControlFactoryProxy(),a=i.createControl.call(i,e);a.parentProxy=t,t.children.push(a);var n=a.getControl();return n.dock=e.dock,n.css({width:"inherit",height:"inherit",position:"relative"}),t.isAddFirst?n.appendTo(this.splitterTwo):(n.appendTo(this.splitterFirst),t.isAddFirst=!0),a.loadConfig(e),a},initComponent:function(){var e=this;e.content.kendoSplitter(e.getKendoOptions()),KDSplitContainerProxy.superclass.initComponent.call(e),e.splitLine=e.content.children().filter(".k-splitbar"),e.splitLine&&e.splitLine.find(".k-icon.k-expand-next").hide().show(),this.setSplitLineHide()},doLayout:function(){var e=this;if(this.el.doLayout&&this.el.doLayout(this.config),this.children){var t=e.getKendoOptions();if(this.content.resize(),t.max){var i=e.content.data("kendoSplitter");null!=i&&(i.max("#"+this.baseId+"_last",t.max),i.max("#"+this.baseId+"_first",t.max),i.size("#"+this.baseId+"_first",t.panes[0].size),i.size("#"+this.baseId+"_last",t.panes[1].size))}0==e.config.orientstyle?(e.splitterFirst.height(e.el.height()).next().height(e.el.height()),e.splitterTwo.height(e.el.height())):(e.splitterFirst.width(e.el.width()).next().width(e.el.width()),e.splitterTwo.width(e.el.width())),e.setSplitbarHide();var a=e.children[0],n=e.children[1];a.doLayout&&a.doLayout.call(a),n.doLayout&&n.doLayout.call(n),e.splitLine&&e.splitLine.find(".k-icon.k-expand-next").hide().show(),void 0!=e.splitButtonVisible&&this.setSplitButtonVisible(e.splitButtonVisible)}},setSplitButtonVisible:function(e){if(this.splitButtonVisible=e,this.splitLine){var t=this.splitLine.find(".k-icon:not(.k-i-vbar)");e?t.show():t.hide()}},getKendoOptions:function(){var e=this,t=1==e.config.orientstyle?"vertical":"horizontal",i=[],a=0;if(e.config.dock&&e.config.dock!=KD.dock.None){e.el.parent();a=1==e.config.orientstyle?KD.layout.getActualHeight(e.el):KD.layout.getActualWidth(e.el)}else if(a=1==e.config.orientstyle?e.config.height:e.config.width,!KDFlowlayoutProxy.isAbsPosChild(e.config)){var n={width:KDFlowlayoutProxy.getItemWidth(e.el,e.config),height:KDFlowlayoutProxy.getItemHeight(e.el,e.config)};a=1==e.config.orientstyle?n.height:n.width}for(var o=0;o<e.config.items.length;o++)i[o]={collapsible:!0,scrollable:!1,collapsed:!1,min:0},a>0&&(i[o].max=a);var r=e.getSplitPosition(),s=r-e.splitbarSize;switch(0!==a&&(s=r>=a?a-e.splitbarSize:r-e.splitbarSize),i[0].size=s+"px",a>0&&(i[1].size=a-s-e.splitbarSize+"px"),this.panelVisibility=e.config.panelVisibility,0==this.config.orientstyle?this.SplitState=0==this.panelVisibility?KDSplitContainerProxy.SplitState.HorCenter:1==this.panelVisibility?KDSplitContainerProxy.SplitState.HorLeft:KDSplitContainerProxy.SplitState.HorRight:this.SplitState=0==this.panelVisibility?KDSplitContainerProxy.SplitState.VerCenter:1==this.panelVisibility?KDSplitContainerProxy.SplitState.VerTop:KDSplitContainerProxy.SplitState.VerBottom,this.SplitState){case KDSplitContainerProxy.SplitState.VerTop:case KDSplitContainerProxy.SplitState.HorLeft:i[0].collapsed=!0;break;case KDSplitContainerProxy.SplitState.HorRight:case KDSplitContainerProxy.SplitState.VerBottom:i[1].collapsed=!0}var l={orientation:t,panes:i,resize:function(t){e.resize.call(e,t)}};return a>0&&(l.max=a),l},setSplitLineHide:function(e){if(this.splitLine){var t=this.getSplitPosition();void 0!=t&&0>=t||0==e?this.splitLine.hide():this.splitLine.show()}},getSplitPosition:function(e){var t=void 0;return t=KD.isEmpty(this.splitPosition)?this.config&&this.config.splitposition:this.splitPosition,e&&(t=this.splitPosition),t},setSplitPosition:function(e,t){if(e=parseInt(e),!KD.isNaN(e)){var i=this;if(i.splitPosition==e||KD.isEmpty(i.splitPosition)&&i.config&&i.config.splitposition==e)return;if(this.splitPosition=e,!t&&i.content&&i.splitterFirst){var a=i.content.data("kendoSplitter");a.size(i.splitterFirst,e-i.splitbarSize),i.resize()}}},loadLayoutSetting:function(e){if(!KD.isEmpty(e)){var t=e;KD.isString(t)&&(t=KD.parseObject(t));var i=t.sp;this.setSplitPosition(i)}},getLayoutSetting:function(){var e={},t=this.getSplitPosition(!0);return!KD.isEmpty(t)&&this._isNeedGetLayoutSetting()&&(e.sp=t),KD.isEmpty(e)?null:e},_isNeedGetLayoutSetting:function(){var e=!0,t="k-state-collapsed";return e=this.splitterFirst&&this.splitterFirst.hasClass&&this.splitterFirst.hasClass(t)||this.splitterTwo&&this.splitterTwo.hasClass&&this.splitterTwo.hasClass(t)?!1:!0},getLayoutSettingIsbecommon:function(){return"1"},setSplitbarHide:function(){var e=this;("0px"==this.el.css("height")&&1==e.config.orientstyle||"0px"==this.el.css("width")&&1!=e.config.orientstyle)&&e.config.dock!=KD.dock.Fill&&this.el.hide()},setVisible:function(e){var t=this;KDSplitContainerProxy.superclass.setVisible.call(t,e),e&&t.setSplitbarHide()},hideLeftPanel:function(e){var t=this.content.data("kendoSplitter");e?(t.expand("#"+this.baseId+"_last"),t.collapse("#"+this.baseId+"_first")):t.expand("#"+this.baseId+"_first")},hideRightPanel:function(e){var t=this,i=t.content.data("kendoSplitter");e?(i.expand("#"+this.baseId+"_first"),i.collapse("#"+this.baseId+"_last")):i.expand("#"+this.baseId+"_last")},loadConfig:function(e){for(var t=this,i=0;i<e.items.length;i++)e.items[i].dock=5;KDSplitContainerProxy.superclass.loadConfig.call(t,e),t.setSplitbarHide()},setX:function(e){KDSplitContainerProxy.superclass.setX.call(this,e),this.resize()},setY:function(e){KDSplitContainerProxy.superclass.setY.call(this,e),this.resize()},resize:function(e){var t=this;t.isResizing||(t.isResizing=!0,KD.delayInvoke(function(){t.__resizeHander.call(t)}))},__resizeHander:function(){var e=this;if(!e.isDontLazy())return void KD.delayInvoke(function(){e.__resizeHander.call(e)});var t=e.getControlFactoryProxy(),i=t.getCmp.call(t,e.config.id);if(i&&i.children){var a=i.children[0],n=i.children[1],o=void 0;1==e.config.orientstyle?(o=e.splitterFirst.height(),a.getControl().height(o),n.getControl().height(e.splitterTwo.height()-e.splitbarSize)):(o=e.splitterFirst.width(),a.getControl().width(o),n.getControl().width(e.splitterTwo.width()-e.splitbarSize)),e.setSplitPosition.call(e,o+e.splitbarSize,!0),a.doLayout&&a.doLayout.call(a),n.doLayout&&n.doLayout.call(n),e.isResizing=!1,void 0!=e.splitButtonVisible&&this.setSplitButtonVisible(e.splitButtonVisible)}}}),KDControlFactoryProxy.registerType("kdsplitcontainer",KDSplitContainerProxy),$.extend(KDSplitContainerProxy,{SplitState:{HorLeft:0,HorCenter:1,HorRight:2,VerTop:3,VerCenter:4,VerBottom:5}}),define("KDSplitContainerProxy",["KDContainerProxy","KD"],function(e){return function(){var t;return t||e.KDSplitContainerProxy}}(this)),function(e,t){function i(e,t){return"<span class='k-button k-button-icon k-button-bare k-tabstrip-"+e+"' unselectable='on'><span class='k-icon "+t+"'></span></span>"}var a=window.kendo,n=a.ui,o=n.TabStrip,r="k-state-disabled",s=".kendoTabStrip",l="click",d=".k-item:not(."+r+")",c=o.extend({options:{name:"mainTabControl"},_getElemScrollWidth:function(t){for(var i=35,a=0;a<t.children.length;a++)i+=t.children[a].offsetWidth,isNaN(parseInt(e(t.children[a]).css("margin-right")))||(i+=parseInt(e(t.children[a]).css("margin-right"))),isNaN(parseInt(e(t.children[a]).css("margin-left")))||(i+=parseInt(e(t.children[a]).css("margin-left")));return i>t.scrollWidth?i:t.scrollWidth},_scrollable:function(){var e,t,n,o,r=this,l=r.options;r._scrollableAllowed()&&(r.wrapper.addClass("k-tabstrip-scrollable"),e=r.tabGroup[0].offsetWidth,t=r._getElemScrollWidth(r.tabGroup[0]),t>e&&!r._scrollableModeActive?(r._nowScrollingTabs=!1,r._isRtl=a.support.isRtl(r.element),r.wrapper.append(i("prev","k-i-arrow-w")+i("next","k-i-arrow-e")),n=r._scrollPrevButton=r.wrapper.children(".k-tabstrip-prev"),o=r._scrollNextButton=r.wrapper.children(".k-tabstrip-next"),n.on("mousedown"+s,function(){r._nowScrollingTabs=!0,r._scrollTabsByDelta(l.scrollable.distance*(r._isRtl?1:-1))}),o.on("mousedown"+s,function(){r._nowScrollingTabs=!0,r._scrollTabsByDelta(l.scrollable.distance*(r._isRtl?-1:1))}),n.add(o).on("mouseup"+s,function(){r._nowScrollingTabs=!1}),r._scrollableModeActive=!0,r._toggleScrollButtons()):r._scrollableModeActive&&e>=t?(r._scrollableModeActive=!1,r.wrapper.removeClass("k-tabstrip-scrollable"),r._scrollPrevButton.off().remove(),r._scrollNextButton.off().remove()):r._scrollableModeActive?r._toggleScrollButtons():r.wrapper.removeClass("k-tabstrip-scrollable"))},init:function(t,i){var n=this;o.fn.init.call(n,t,i),n.wrapper.children(".k-tabstrip-items").off(l+s," > "+d).on(l+s," > "+d,function(t){var i=n.wrapper[0];if(i!==document.activeElement){var o=a.support.browser.msie;if(o)try{i.setActive()}catch(r){}}n._click(e(t.currentTarget))&&t.preventDefault()})}});n.plugin(c)}(window.kendo.jQuery),define("KDMainTabControl",["KD"],function(e){return function(){var t;return t||e.KDMainTabControl}}(this)),function(e,t){function i(i){var a=i.find(">tr:not(.k-filter-row)"),n=function(){var t=e(this);return!t.hasClass("k-group-cell")&&!t.hasClass("k-hierarchy-cell")},o=e();a.length>1&&(o=a.find("th").filter(n).filter(function(){return this.rowSpan>1})),o=o.add(a.last().find("th").filter(n));var r=m.attr("index");return o.sort(function(i,a){i=e(i),a=e(a);var n=i.attr(r),o=a.attr(r);return n===t&&(n=e(i).index()),o===t&&(o=e(a).index()),n=parseInt(n,10),o=parseInt(o,10),n>o?1:o>n?-1:0}),o}function a(e){for(var t=[],i=0;i<e.length;i++)e[i].columns?t=t.concat(a(e[i].columns)):t.push(e[i]);return t}function n(t,i){var a=N.msie||N.edge;if(i===!0){t=e(t);var n,o;if(n=t.parent().scrollTop(),o=t.parent().scrollLeft(),a)try{t[0].setActive()}catch(r){t[0].focus()}else t[0].focus();t.parent().scrollTop(n).scrollLeft(o)}else e(t).one("focusin",function(e){e.preventDefault()}).focus()}function o(e,t){var i=[];return r(e,t,i),i[i.length-1]}function r(e,t,i){i=i||[];for(var a=0;a<t.length;a++){if(e===t[a])return!0;if(t[a].columns){var n=i.length;if(i.push(t[a]),r(e,t[a].columns,i))return!0;i.splice(n,i.length-n)}}return!1}function s(e){return b(e,function(e){return!e.locked})}function l(t){for(var i=t.find("tr:not(.k-filter-row)"),a=i.filter(function(){return!e(this).children().length}).remove().length,n=i.find("th:not(.k-group-cell,.k-hierarchy-cell)"),o=0;o<n.length;o++)n[o].rowSpan>1&&(n[o].rowSpan-=a);return i.length-a}function d(){return this.style?"none"!==this.style.display:void 0}function c(e){for(var t=[],i=[],a=0;a<e.length;a++)t.push(e[a]),e[a].columns&&(i=i.concat(e[a].columns));return i.length&&(t=t.concat(c(i))),t}function h(e){return b(e,function(e){return e.locked})}function u(t){return e(t).is(":button,a,:input,a>.k-icon,textarea,span.k-select,span.k-icon,span.k-link,.k-input,.k-multiselect-wrap,.k-tool-icon")}function p(t){var i=e(t.currentTarget),a=i.is("th"),o=this.table.add(this.lockedTable),r=this.thead.parent().add(e(">table",this.lockedHeader)),s=u(t.target),l=i.closest("table")[0];if(s&&i.find(m.roleSelector("filtercell")).length)return void this._setCurrent(i);if((l===o[0]||l===o[1]||l===r[0]||l===r[1])&&!e(t.target).is("a.k-i-collapse, a.k-i-expand")){if(this.options.navigatable){try{var d=KD.getActiveElement();this.element&&d&&!e.contains(this.element[0],d[0])&&d&&d.blur&&d.blur()}catch(t){}this._setCurrent(i)}(a||!s)&&setTimeout(function(){H&&e(m._activeElement()).hasClass("k-widget")||u(m._activeElement())||n(l,!0)}),m.support.touch||a&&t.preventDefault()}}function g(e){return f([e]).length>0}function f(e){return b(e,function(e){var t=!e.hidden;return t&&e.columns&&(t=f(e.columns).length>0),t})}var m=window.kendo,v=m.ui,y=v.Grid,b=e.grep,D=".kendoKDGrid",k="th.k-header:not(.k-group-cell):not(.k-hierarchy-cell)",C=e.extend,x=(m._activeElement,m._outerWidth),w=(m._outerHeight,m.keys),K=e.isPlainObject,C=e.extend,S=e.map,I=(e.isArray,e.inArray),P=(Array.prototype.push,e.proxy),F=(m.isFunction,e.isEmptyObject,Math),T="filterMenuInit",_="columnMenuInit",A="columnResize",L="columnLock",M="columnUnlock",E="tabIndex",B="string",R=!1,N=m.support.browser,H=N.msie&&8==N.version,O="tr:not(.k-footer-template):visible",V=":not(.k-group-cell):not(.k-hierarchy-cell):visible",j=O+":first>"+V+":first",z=!1,U="k-grid-norecords",q=y.extend({options:{name:"KDGrid"},kdCopySelection:function(){KD.isMobileOS()||(this.areaClipBoard||(this.areaClipBoard=e("<textarea />").css({position:"fixed",top:"50%",left:"50%",opacity:0,width:0,height:0}).appendTo(this.wrapper)),this.areaClipBoard.val(this.getTSV()))},kdDoCopySelected:function(e){var i=e,a=window.getSelection&&window.getSelection()&&window.getSelection().toString();if(KD.IsNullOrWhiteSpace(a)||(i=a),i||(i=this.areaClipBoard&&this.areaClipBoard.val()),null==i||i==t)return void KD.writeLog("kendo areaClipBoard isnull");if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",i);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var n=document.createElement("textarea");n.textContent=i,n.style.position="fixed",document.body.appendChild(n),null!=i&&i!=t&&n.select();try{return KD.isEmpty(i)?document.execCommand("copy",n):document.execCommand("copy")}catch(o){return KD.writeLog("Copy to clipboard failed.",o),!1}finally{document.body.removeChild(n)}}},clearSelection:function(){try{y.fn.clearSelection.call(this)}catch(e){}},select:function(e){var t=null;try{t=y.fn.select.call(this,e)}catch(i){t=null}return t},getTSV:function(){var t=this,i=t.select();if(!KD.isEmpty(i)){KD.delayInvoke(function(){var e=t&&t.current();e&&e.is(":visible")&&(e.addClass("k-state-focused"),t.options&&t.options.editable||e.focus())},100);var a="	",n=t.options.allowCopy,o=!0;e.isPlainObject(n)&&n.delimeter&&(a=n.delimeter);var r="";if(i.length){i.eq(0).is("tr")&&(i=t.current()),o&&!KD.isEmpty(i)&&i.filter(":visible");var s=[],l=this.columns.length,d=t._isLocked()&&h(t.columns).length,c=!0,u=t.options&&t.options.controlProxy,p=u&&u.CopyGridOrginalValue;KD.isEmpty(i)||e.each(i,function(a,n){var r=i[a];n=e(n);var h=n.closest("tr"),g=h.index(),f=n.index();o&&(f-=n.prevAll(":hidden").length),d&&c&&(c=e.contains(t.lockedTable[0],n[0])),t._groups()&&c&&(f-=t._groups()),f=c?f:f+d,l>f&&(l=f);var m=n.text();if(p&&r){var v=u&&u.store,y=e("[data-field]",r).data(),b=v.getColumnDescriptor(y.field),D=v.getRowDataByServerRowId(y.rowid),k=b&&b.getOriginalValue(D);k&&(m=k)}s[g]||(s[g]=[]),s[g][f]=m});var g=s.length;s=e.each(s,function(e,t){t&&(s[e]=t.slice(l),g>e&&(g=e))}),e.each(s.slice(g),function(e,t){r+=t?t.join(a)+"\r\n":"\r\n"})}return r=r.replace(/\u00A0/g," ")}},_draggable:function(){var i=this;if(i.options.reorderable){i._draggableInstance&&i._draggableInstance.destroy();var a=i.wrapper.children(".k-grid-header");i._draggableInstance=i.wrapper.kendoDraggable({group:m.guid(),autoScroll:!0,filter:i.content?".k-grid-header:first "+k:"table:first>.k-grid-header "+k,dragstart:function(){a.children(".k-grid-header-wrap").unbind("scroll"+D+"scrolling").bind("scroll"+D+"scrolling",function(e){i.virtualScrollable?i.content.find(">.k-virtual-scrollable-wrap").scrollLeft(this.scrollLeft):i.scrollables.not(e.currentTarget).scrollLeft(this.scrollLeft)})},dragend:function(e){a.children(".k-grid-header-wrap").unbind("scroll"+D+"scrolling");var i=this,n=this.element.data("kendoKDGrid"),o=n.columns.length,r=i.options.gethidecols(n),s=o-r;if(n&&null!=n&&n!=t){var l=a.offset().top,d=e.target.offsetTop,c=e.target.offsetHeight,h=l+c,u=d+c,p=e.currentTarget.attr("data-field"),g=parseInt(e.currentTarget.attr("data-index"));if(s>1&&"SELECTED"!=p&&(l-5>u||d>h+5)){if(!KD.isEmpty(g)){var f=n.options&&n.options.controlProxy,m=f&&f.store;m.getColumnDescriptor(p);i.hint.hide(),n.hideColumn(g)}}}},drag:function(e){var t=this;i._hideResizeHandle(),a.children(".k-grid-header-wrap").unbind("scroll"+D+"scrolling");var t=this,n=this.element.data("kendoKDGrid"),o=n.columns.length,r=t.options.gethidecols(n),s=o-r,l=a.offset().top,d=t.hint[0].offsetTop,c=t.hint[0].offsetHeight,h=l+c,u=d+c,p=e.currentTarget.attr("data-field");if(s>1&&"SELECTED"!=p)if(l-5>u||d>h+5){if(0==t.hint.find(".kd-grid-hideColIcon").length){var g=KD.getImageUrlByNameAndVersion("kd_icon_extend.png");t.hint.append('<span class="kd-grid-hideColIcon" style="background-image:url('+g+')"></div>')}}else 0!=t.hint.find(".kd-grid-hideColIcon").length&&t.hint.find(".kd-grid-hideColIcon").remove()},hint:function(t){var i=this,a=t.attr(m.attr("title")),n=this.element.data("kendoKDGrid"),o=n.columns.length,r=i.options.gethidecols(n),s=o-r,l=t.attr("data-field"),d=s>1&&"SELECTED"!=l?'<span class="k-drag-status k-i-denied" />':'<span class="k-icon k-drag-status k-i-denied" />';return a&&(a=m.htmlEncode(a)),e('<div class="k-header k-drag-clue" />').css({width:t.width(),paddingLeft:t.css("paddingLeft"),paddingRight:t.css("paddingRight"),lineHeight:t.height()+"px",paddingTop:t.css("paddingTop"),paddingBottom:t.css("paddingBottom"),paddingLeft:"10px",overflow:"visible"}).html(a||t.attr(m.attr("field"))||t.text()).append(d)},gethidecols:function(e){for(var e=e,t=e.columns.length,i=0,a=0;t>a;a++)e.columns[a].hidden&&i++;return i}}).data("kendoDraggable")}},reorderColumn:function(e,i,n){if(0>e)return void this.trigger(L,{isNeedForceRefreshGridDataFlag:!0,column:i});var r,d=this,c=o(i,d.columns),u=c?c.columns:d.columns,p=I(i,u),g=u[e],f=!!g.locked,m=h(d.columns).length;if(p!==e&&(i.locked||!f||1!=s(d.columns).length)){if(i.locked&&!f&&1==m)return void this.trigger(M,{isNeedForceRefreshGridDataFlag:!0,column:i});d._hideResizeHandle(),n===t&&(n=p>e);var v=[i];d._reorderHeader(v,g,n),d.lockedHeader&&(l(d.thead),l(d.lockedHeader)),g.columns&&(g=a(g.columns),g=g[n?0:g.length-1]),i.columns&&(v=a(i.columns)),d._reorderContent(v,g,n),r=!!i.locked,r=r!=f,i.locked=f,u.splice(n?e:e+1,0,i),u.splice(e>p?p:p+1,1),d._updateLockedCols(),d._updateCols(),d._templates(),d._updateColumnCellIndex(),d._updateTablesWidth(),d._applyLockedContainersWidth(),d._syncLockedHeaderHeight(),d._syncLockedContentHeight(),d._updateFirstColumnClass(),r&&(f?d.trigger(L,{column:i}):d.trigger(M,{column:i}))}},_scrollable:function(){if(y.fn._scrollable.call(this),KD.isMobileOS()&&(KD.isMacOS()||!this.virtualScrollable)){var e=this;e.wrapperdrag=new m.UserEvents(e.content,{global:!0,start:function(e){e.sender.capture()},move:function(e){this.element.scrollTop(this.element.scrollTop()-e.y.delta),this.element.scrollLeft(this.element.scrollLeft()-e.x.delta),e.preventDefault()}})}},_columnMenu:function(){var e,o,r,s,l,d,c=this,h=a(c.columns),u=c.options,p=u.columnMenu,g=(b(c.columns,function(e){return e.columns!==t}).length>0,this._isMobile),f=function(e){c.trigger(_,{field:e.field,container:e.container})},v=function(e){n(e.closest("table"),!0)},y=function(e){c.trigger("sort",{sort:e.sort})&&e.preventDefault()},D=function(e){c.trigger("filter",{filter:e.filter,field:e.field})&&e.preventDefault()},k=u.$angular;if(p){"boolean"==typeof p&&(p={}),d=i(c.thead);for(var x=0,w=d.length;w>x;x++){o=h[x];var K=d.eq(x);o.command||!o.field&&!K.attr("data-"+m.ns+"field")||(e=K.data("kendoColumnMenu"),e&&e.destroy(),s=o.sortable!==!1&&p.sortable!==!1&&u.sortable!==!1?C({},u.sortable,{compare:(o.sortable||{}).compare}):!1,l=u.filterable&&o.filterable!==!1&&p.filterable!==!1?C({pane:c.pane},u.filterable,o.filterable):!1,o.filterable&&o.filterable.dataSource&&(l.forceUnique=!1,l.checkSource=o.filterable.dataSource),l&&(l.format=o.format),r={dataSource:c.dataSource,values:o.values,columns:!0,sortable:!1,filterable:!1,messages:p.messages,owner:c,closeCallback:v,init:f,pane:c.pane,sort:y,filtering:D,filter:g?":not(.k-column-active)":"",lockedColumns:!0},k&&(r.$angular=k),K.kendoColumnMenu(r))}}},_filterable:function(){var e,t,o,r=this,s=a(r.columns),l=function(e){r.trigger(T,{field:e.field,container:e.container})},d=function(e){n(e.closest("table"),!0)},c=function(e){r.trigger("filter",{filter:e.filter,field:e.field})&&e.preventDefault()},h=r.options.filterable;if(h&&typeof h.mode==B&&-1==h.mode.indexOf("menu")&&(h=!1),h){t=i(r.thead);for(var u=0,p=t.length;p>u;u++)if(o=t.eq(u),s[u].filterable!==!1&&!s[u].command&&(s[u].field||o.attr("data-"+m.ns+"field"))){e=o.data("kendoFilterMenu"),e&&e.destroy(),e=o.data("kendoFilterMultiCheck"),e&&e.destroy();var g=s[u].filterable,f=C({},h,g,{dataSource:r.dataSource,values:s[u].values,format:s[u].format,closeCallback:d,title:s[u].title||s[u].field,init:l,pane:r.pane,change:c});g&&g.messages&&(f.messages=C(!0,{},h.messages,g.messages)),g&&g.dataSource&&(f.forceUnique=!1,f.checkSource=g.dataSource),g&&g.multi?o.kendoFilterMultiCheck(f):o.kendoFilterMenu(f)}}},_adjustLockedHorizontalScrollBar:function(){var e=this.table,t=e.parent(),i=e[0].offsetWidth>t[0].clientWidth?m.support.scrollbar():0,a=t.height(),n=t.innerHeight();a=a>=n?a:n,this.lockedContent.height(a-i)},_navigatable:function(){var t=this;if(t.options.navigatable){var i=t.table.add(t.lockedTable),a=t.thead.parent().add(e(">table",t.lockedHeader)),n=i;t.options.scrollable&&(n=n.add(a),a.attr(E,-1)),this._navigatableTables=n,n.off("mousedown"+D+" focus"+D+" focusout"+D+" keydown"+D),a.on("keydown"+D,P(t._openHeaderMenu,t)).find("a.k-link").attr("tabIndex",-1),i.attr(E,F.max(i.attr(E)||0,0)).on("mousedown"+D+" keydown"+D,".k-detail-cell",function(e){e.target!==e.currentTarget&&e.stopImmediatePropagation()}),n.on(m.support.touch?"touchstart"+D:"mousedown"+D,O+">"+V,P(p,t)).on("focus"+D,P(t._tableFocus,t)).on("focusout"+D,P(t._tableBlur,t)).on("keydown"+D,P(t._tableKeyDown,t))}},_tableKeyDown:function(t){var i=this.current(),a=this.virtualScrollable&&this.virtualScrollable.fetching(),n=e(t.target),o=!t.isDefaultPrevented()&&!n.is(":button,a,:input,a>.k-icon");if(a)return void t.preventDefault();if(i=i?i:e(this.lockedTable).add(this.table).find(j),i.length){var r=!1;o&&t.keyCode==w.UP&&(r=this._moveUp(i)),o&&t.keyCode==w.DOWN&&(r=this._moveDown(i)),o&&t.keyCode==(R?w.LEFT:w.RIGHT)&&(r=this._moveRight(i,t.altKey)),o&&t.keyCode==(R?w.RIGHT:w.LEFT)&&(r=this._moveLeft(i,t.altKey)),o&&t.keyCode==w.PAGEDOWN&&(r=this._handlePageDown()),o&&t.keyCode==w.PAGEUP&&(r=this._handlePageUp()),(t.keyCode==w.ENTER||t.keyCode==w.F2)&&(r=this._handleEnterKey(i,t.currentTarget,n)),t.keyCode==w.ESC&&(r=i.hasClass("kd-grid-customheade-voucher")?!0:this._handleEscKey(i,t.currentTarget)),t.keyCode==w.TAB&&(r=this._handleTabKey(i,t.currentTarget,t.shiftKey)),r&&(t.preventDefault(),t.stopPropagation())}},_renderNoRecordsContent:function(){var t=this;if(z)return void(z=!1);if(t.options.noRecords){var i=t.table.parent().children("."+U);i.length&&(t.angular("cleanup",function(){return{elements:i.get()}}),i.remove()),t.dataSource&&t.dataSource.view().length||(i=e(t.noRecordsTemplate({})).insertAfter(t.table),t.angular("compile",function(){return{elements:i.get(),data:[{}]}}))}},_clipboard:function(){var e=this.options,t=e.selectable;if(t&&e.allowCopy){var i=this;e.navigatable||i.table.add(i.lockedTable).attr("tabindex",0).on("mousedown"+D+" keydown"+D,".k-detail-cell",function(e){e.target!==e.currentTarget&&e.stopImmediatePropagation()}).on("mousedown"+D,O+">"+V,P(p,i)),i.copyHandler=P(i.copySelection,i),i.updateClipBoardState=function(){i.areaClipBoard},i.bind("change",i.updateClipBoardState),i.wrapper.on("keydown",i.copyHandler),i.clearAreaHandler=P(i.clearArea,i),i.wrapper.on("keyup",i.clearAreaHandler)}},autoFitColumn:function(t){var n,o,r,s,l,h,u,p=this,f=p.options,m=p.columns,v=p.lockedHeader?i(p.lockedHeader.find(">table>thead")).filter(d).length:0,y="col:not(.k-group-col):not(.k-hierarchy-col)",D="td:visible:not(.k-group-cell):not(.k-hierarchy-cell)";if(t="number"==typeof t?m[t]:K(t)?b(c(m),function(e){return e===t})[0]:b(c(m),function(e){return e.field===t})[0],t&&g(t)){n=I(t,a(m)),s=t.locked,r=s?p.lockedHeader.children("table"):p.thead.parent(),o=r.find("[data-index='"+n+"']"),o.removeClass("kd-colheader-autowrap");var k=s?p.lockedTable:p.table,C=p.footer||e();p.footer&&p.lockedContent&&(C=s?p.footer.children(".k-grid-footer-locked"):p.footer.children(".k-grid-footer-wrap"));var w=C.find("table").first();p.lockedHeader&&!s&&(n-=v);for(var S=0;S<m.length&&m[S]!==t;S++)m[S].hidden&&n--;f.scrollable?(l=r.find(y).eq(n).add(k.children("colgroup").find(y).eq(n)).add(w.find("colgroup").find(y).eq(n)),s||(h=k.parent(),u=h.scrollLeft())):l=k.children("colgroup").find(y).eq(n),KD.writeLog("KDKendoGrid autoFitColumn() "+n);var P=r.add(k).add(w),F=x(o);l.width(""),P.css("table-layout","fixed"),l.width("auto"),P.addClass("k-autofitting"),P.css("table-layout","");var T=Math.ceil(Math.max(x(o),x(k.find("tr:not(.k-grouping-row)").eq(0).children(D).eq(n)),x(w.find("tr").eq(0).children(D).eq(n))))+1;if(l.width(T),t.width=T,f.scrollable){for(var _,L=r.find("col"),M=0,E=0,B=L.length;B>E;E+=1){if(_=L[E].style.width,!_||-1!=_.indexOf("%")){M=0;break}M+=parseInt(_,10)}M&&P.each(function(){this.style.width=M+"px"})}KD.delayInvoke(function(){KD.writeLog("KDKendoGrid autoFitColumn() "+M),N.msie&&8==N.version&&(P.css("display","inline-table"),setTimeout(function(){P.css("display","table")},1)),P.removeClass("k-autofitting"),u&&h.scrollLeft(u),p.trigger(A,{column:t,oldWidth:F,newWidth:T,autoFitColumnClick:!0}),p._applyLockedContainersWidth(),p._syncLockedContentHeight(),p._syncLockedHeaderHeight()},300)}},_refreshEditCell:function(e,t){var i,n,o=this,r=a(o.columns)[o.cellIndex(t)];r&&KD.isFunction(r.refreshEditStateCell)&&(i=t.closest("tr").attr(m.attr("uid")),n=o.dataSource.getByUid(i),r.refreshEditStateCell.call(r,t,C(!0,{},{field:e},{model:n})))},refreshCell:function(e,t){var i,n,o,r=this,s=m.format('tbody tr [data-rowId={0}][data-field="{1}"]',t,e),l=r.wrapper&&r.wrapper.find&&r.wrapper.find(s).closest("td");if(l&&0!=l.length){if(l.hasClass("k-edit-cell")&&!(l.children(".k-gridCellstate-disabled").length>0))return void r._refreshEditCell(e,l);i=l.closest("tr").attr(m.attr("uid")),r.dataSource&&(o=r.dataSource.getByUid(i),n=a(r.columns)[r.cellIndex(l)],r._displayCell(l,n,o))}},_thead:function(){var t,i,a=this,n=a.columns,o=a._hasDetails()&&n.length,r=a._hasFilterRow(),s="",l=a.table.find(">thead"),d=a.element.find("thead:first").length>0;if(l.length||(l=e("<thead/>").insertBefore(a.tbody)),a.lockedHeader&&a.thead?(i=a.thead.find("tr:has(th):not(.k-filter-row)").html(""),i.remove(),i=e(),a._removeLockedContainers()):i=d?a.element.find("thead:first tr:has(th):not(.k-filter-row)"):a.element.find("tr:has(th):first"),!i.length&&(i=l.children().first(),!i.length)){var c=[{rowSpan:1,cells:[],index:0}];for(a._prepareColumns(c,n),t=0;t<c.length;t++)s+="<tr>",o&&(s+='<th class="k-hierarchy-cell" scope="col">&nbsp;</th>'),s+=a._createHeaderCells(c[t].cells,c[t].rowSpan),s+="</tr>";i=e(s)}if(r){var u=e("<tr/>");u.addClass("k-filter-row"),(o||i.find(".k-hierarchy-cell").length)&&u.prepend('<th class="k-hierarchy-cell" scope="col">&nbsp;</th>');var p=(a.thead||l).find(".k-filter-row");p.length&&(m.destroy(p),p.remove()),l.append(u)}i.children().length?o&&!i.find(".k-hierarchy-cell")[0]&&i.prepend('<th class="k-hierarchy-cell" scope="col">&nbsp;</th>'):(s="",o&&(s+='<th class="k-hierarchy-cell" scope="col">&nbsp;</th>'),s+=a._createHeaderCells(n),i.html(s)),i.attr("role","row").find("th").addClass("k-header"),a.options.scrollable||l.addClass("k-grid-header"),i.find("script").remove().end().prependTo(l),a.thead&&a._destroyColumnAttachments(),this.angular("cleanup",function(){return{elements:l.find("th").get()}}),this.angular("compile",function(){return{elements:l.find("th").get(),data:S(n,function(e){return{column:e}})}}),a.thead=l.attr("role","rowgroup"),a._sortable(),a._filterable(),a._filterRow(),a._scrollable(),a._updateCols(),a._columnMenu();var g,f=this.options.scrollable&&h(this.columns).length;f&&(g=a._appendLockedColumnHeader(a.thead.closest(".k-grid-header")),a._appendLockedColumnContent(),a.lockedContent.bind("DOMMouseScroll"+D+" mousewheel"+D,P(a._wheelScroll,a))),a._updateColumnCellIndex(),a._updateFirstColumnClass(),a._resizable(),a._draggable(),a._reorderable(),a._updateHeader(a._groups()),f&&(g&&a._syncLockedHeaderHeight(),a._applyLockedContainersWidth()),a.groupable&&a._attachGroupable();var v=a.options&&a.options.controlProxy;if(!KD.isEmpty(v))for(var y=v.getStore&&v.getStore(),b=v.getFormProxy(),k=i.children("th"),C=0;C<k.length;C++){var x=k.eq(C),w=x.attr("data-field"),K=y&&y.getColumnDescriptor(w),I=K&&K.getColumnLineTipsData.call(K);if(!KD.isEmpty(I)){var F=v.baseId+"-"+w+"-kdtooltip",T=v.getLineTipsDefConfig(F),_=b&&b.createInnerControl(T);
_&&_.setIsOnlineTips.call(_,!0),_&&_.setTipsData.call(_,I);var A=_&&_.getLineTipsOptions();x.kendoKDTooltip(A)}}}});v.plugin(q),m.ui.ColumnSorter.fn._click=function(i){var a,n,o="dir",r="asc",s="single",l="field",d="desc",c=this,h=c.element,u=h.attr(m.attr(l)),p=h.attr(m.attr(o)),g=c.options,f=null===c.options.compare?t:c.options.compare,v=c.dataSource.sort()||[];if(i.preventDefault(),!g.filter||h.is(g.filter)){var y=e(i.target);if(!y.hasClass("k-checkbox-label")&&(p=p===r?d:p===d&&g.allowUnsort?t:r,!this.trigger("change",{sort:{field:u,dir:p,compare:f}}))){if(g.mode===s)v=[{field:u,dir:p,compare:f}];else if("multiple"===g.mode){for(a=0,n=v.length;n>a;a++)if(v[a].field===u){v.splice(a,1);break}v.push({field:u,dir:p,compare:f})}z=!0,this.dataSource.sort(v)}}}}(window.kendo.jQuery),define("KDKendoGrid",["KD"],function(e){return function(){var t;return t||e.KDKendoGrid}}(this)),function(e,t){function i(e,t){var i=(e||{}).field||"";return t.dirty&&t.dirtyFields&&t.dirtyFields[i]&&a(e,t)}function a(e,t){return!e||!t||!e.field||e.selectable||e.command||e.editable&&!e.editable(t)?!1:e.field&&t.editable&&t.editable(e.field)}function n(e){for(var t=[],i=0;i<e.length;i++)e[i].columns?t=t.concat(n(e[i].columns)):t.push(e[i]);return t}function o(e){for(var t=[],i=e.className,a=0,n=e.level;n>a;a++)t.push(L("span",{className:i}));return t}function r(e){return v(e,u("locked"))}function s(e){return v(e,p(u("locked")))}function l(t,i){if(i===!0){t=e(t);var a,n;a=t.parent().scrollTop(),n=t.parent().scrollLeft(),g.focusElement(t),t.parent().scrollTop(a).scrollLeft(n)}else e(t).one("focusin",function(e){e.preventDefault()}).focus()}function d(e,t){var i,a=e.offsetHeight,n=t.offsetHeight;a>n?i=a+"px":n>a&&(i=n+"px"),i&&(e.style.height=t.style.height=i)}function c(t){return e(t).is(":button,a,:input,a>.k-icon,textarea,span.k-select,span.k-icon,span.k-link,.k-input,.k-multiselect-wrap,.k-tool-icon")}function h(t){var i=e(t.currentTarget),a=i.is("th"),n=this.table.add(this.lockedTable),o=this.thead.parent().add(e(">table",this.lockedHeader)),r=c(t.target),s=i.closest("table")[0],d=e(t.target);if(r&&i.find(g.roleSelector("filtercell")).length)return void this._setCurrent(i);if((s===n[0]||s===n[1]||s===o[0]||s===o[1])&&!d.is("a.k-i-collapse, a.k-i-expand")){this.options.navigatable&&this._setCurrent(i),(a||!r)&&setTimeout(function(){U&&e(g._activeElement()).hasClass("k-widget")||c(g._activeElement())||l(s,!0)});var h=new Date;!KD.isEmpty(this.lastClickTime)&&h-this.lastClickTime<500&&d&&d.closest(".k-grid-content").length>0&&"INPUT"!==t.target.nodeName&&d.dblclick(),this.lastClickTime=h,g.support.touch||a&&t.preventDefault()}}function u(e){return function(t){return t[e]}}function p(e){return function(t){return!e(t)}}var g=window.kendo,f=g.ui,m=f.TreeList,v=e.grep,y=".kendoKDTreeList",b=g.data,D=b.Query,k="string",C=KD.isArray,x="incell",w="cancel",K="cellClose",w="cancel",S="save",I="itemChange",P=e.proxy,F=e.inArray,T=e.extend,_="edit",A=g.dom,L=A.element,M=g._outerWidth,E="mousedown",B=g._activeElement,R="click",N="columnResize",H="tabIndex",O=g.keys,V=g.support.browser,j="td:visible",z=A.html,U=V.msie&&8==V.version,q="beforeEdit",G=".",$={wrapper:"k-treelist k-grid k-widget k-display-block",header:"k-header",button:"k-button",alt:"k-alt",editCell:"k-edit-cell",editRow:"k-grid-edit-row",dirtyCell:"k-dirty-cell",group:"k-treelist-group",gridToolbar:"k-grid-toolbar",gridHeader:"k-grid-header",gridHeaderWrap:"k-grid-header-wrap",gridContent:"k-grid-content",gridContentWrap:"k-grid-content",gridFilter:"k-grid-filter",footerTemplate:"k-footer-template",focused:"k-state-focused",loading:"k-i-loading",refresh:"k-i-reload",retry:"k-request-retry",selected:"k-state-selected",status:"k-status",link:"k-link",withIcon:"k-with-icon",filterable:"k-filterable",icon:"k-icon",iconFilter:"k-i-filter",iconCollapse:"k-i-collapse",iconExpand:"k-i-expand",iconHidden:"k-i-none",iconPlaceHolder:"k-icon k-i-none",input:"k-input",dropPositions:"k-i-insert-up k-i-insert-down k-i-plus k-i-insert-middle",dropTop:"k-i-insert-up",dropBottom:"k-i-insert-down",dropAdd:"k-i-plus",dropMiddle:"k-i-insert-middle",dropDenied:"k-i-cancel",dragStatus:"k-drag-status",dragClue:"k-drag-clue",dragClueText:"k-clue-text"},W="tr:visible",J=W+" > td:first:visible",Q=":not(.k-group-cell):not(.k-hierarchy-cell):visible",X="filterMenuInit",Y="filterMenuOpen",Z="filter",ee="sort",te=function(e,t){var i,a=e.length,n=new Array(a);for(i=0;a>i;i++)n[i]=t(e[i],i,e);return n};D.normalizeGroup=D.normalizeGroup||function(e,i,a,n){var o=typeof e===k?{field:e,dir:i,compare:a,skipItemSorting:n}:e,r=C(o)?o:o!==t?[o]:[];return te(r,function(e){return{field:e.field,dir:e.dir||"asc",aggregates:e.aggregates,compare:e.compare,skipItemSorting:e.skipItemSorting}})},D.normalizeSort=D.normalizeSort||function(e,i){if(e){var a=typeof e===k?{field:e,dir:i}:e,n=C(a)?a:a!==t?[a]:[];return v(n,function(e){return!!e.dir})}},g.focusElement=g.focusElement||function(t){t=e(t),t.trigger&&t.trigger("focus")};var ie=g.Observable.extend({init:function(e,t){g.Observable.fn.init.call(this),t=this.options=T(!0,{},this.options,t),this.element=e,this.bind(this.events,t),this.model=this.options.model,this.fields=this._fields(this.options.columns),this._initContainer(),this.createEditable()},events:[],_initContainer:function(){this.wrapper=this.element},createEditable:function(){var e=this.options;this.editable=new f.Editable(this.wrapper,{fields:this.fields,target:e.target,clearContainer:e.clearContainer,model:this.model})},_isEditable:function(e){return e.field&&this.model.editable(e.field)},_fields:function(e){var t,i,a,n=[];for(t=0,i=e.length;i>t;t++)a=e[t],this._isEditable(a)&&n.push({field:a.field,format:a.format,editor:a.editor});return n},end:function(){return this.editable.end()},close:function(){this.destroy()},destroy:function(){this.editable.destroy(),this.editable.element.find("["+g.attr("container-for")+"]").empty().end().removeAttr(g.attr("role")),this.model=this.wrapper=this.element=this.columns=this.editable=null}}),ae=ie.extend({destroy:function(){var e=this;e.editable.destroy(),e.editable.element.off().empty().removeAttr(g.attr("role")),e.model=e.wrapper=e.element=e.columns=e.editable=null}}),ne=m.extend({lastClickTime:null,options:{name:"KDTreeList"},init:function(e,t){m.fn.events&&m.fn.events.indexOf&&(m.fn.events.indexOf(Z)<0&&m.fn.events.push(Z),m.fn.events.indexOf(X)<0&&m.fn.events.push(X),m.fn.events.indexOf(Y)<0&&m.fn.events.push(Y),m.fn.events.indexOf(ee)<0&&m.fn.events.push(ee)),m.fn.init.call(this,e,t),this._navigatable.call(this)},getOptions:function(){var e=this.options,t=e;return t},_navigatable:function(){var t=this;if(t.options.navigatable){var i=t.table.add(t.lockedTable),a=t.thead.parent().add(e(">table",t.lockedHeader));t.options.scrollable&&(i=i.add(a),a.attr(H,-1)),this._navigatableTables=i,i.on("keydown"+y,P(t._tableKeyDown,t)).on(g.support.touch?"touchstart"+y:"mousedown"+y,W+">"+Q,P(h,t))}},autoFitColumn:function(t){var i,a,n,o,r,s=this,l=s.options,d=s.columns,c=g.support.browser,h=s.lockedHeader?leafDataCells(s.lockedHeader.find(">table>thead")).filter(isCellVisible).length:0;if(t="number"==typeof t?d[t]:isPlainObject(t)?v(d,function(e){return e===t})[0]:v(d,function(e){return e.field===t})[0],t&&!t.hidden){i=F(t,d),o=t.locked,n=o?s.lockedHeader.children("table"):s.thead.parent(),a=n.find("th").eq(i),a.removeClass("kd-colheader-autowrap");var u=o?s.lockedTable:s.table,p=s.footer||e();s.footer&&s.lockedContent&&(p=o?s.footer.children(".k-grid-footer-locked"):s.footer.children(".k-grid-footer-wrap"));var f=p.find("table").first();s.lockedHeader&&h>=i&&!o&&(i-=h);for(var m=0;m<d.length&&d[m]!==t;m++)d[m].hidden&&i--;r=l.scrollable?n.find("col:not(.k-group-col):not(.k-hierarchy-col):eq("+i+")").add(u.children("colgroup").find("col:not(.k-group-col):not(.k-hierarchy-col):eq("+i+")")).add(f.find("colgroup").find("col:not(.k-group-col):not(.k-hierarchy-col):eq("+i+")")):u.children("colgroup").find("col:not(.k-group-col):not(.k-hierarchy-col):eq("+i+")");var y=n.add(u).add(f),b=M(a);r.width(""),y.css("table-layout","fixed"),r.width("auto"),y.addClass("k-autofitting"),y.css("table-layout","");var D=Math.ceil(Math.max(M(a),M(u.find("tr").eq(0).children("td:visible").eq(i)),M(f.find("tr").eq(0).children("td:visible").eq(i))));if(r.width(D),t.width=D,l.scrollable){for(var k,C=n.find("col"),x=0,w=0,K=C.length;K>w;w+=1){if(k=C[w].style.width,!k||-1!=k.indexOf("%")){x=0;break}x+=parseInt(k,10)}x&&y.each(function(){this.style.width=x+"px"})}c.msie&&8==c.version&&(y.css("display","inline-table"),setTimeout(function(){y.css("display","table")},1)),y.removeClass("k-autofitting"),s.trigger(N,{column:t,oldWidth:b,newWidth:D,autoFitColumnClick:!0}),s._applyLockedContainersWidth(),s._syncLockedContentHeight(),s._syncLockedHeaderHeight()}},_sortable:function(){var t,i,a,n,o,r=this,s=this.columns,l=e(this.lockedHeader).add(this.thead).find("th"),d=g.attr("field"),c=this.options.sortable,h=function(e){r.trigger(ee,{sort:e.sort})&&e.preventDefault()};if(c)for(n=0,o=l.length;o>n;n++)t=s[n],t.sortable!==!1&&!t.command&&t.field&&(a=l.eq(n),i=a.data("kendoColumnSorter"),i&&i.destroy(),a.attr(d,t.field).kendoColumnSorter(T({},c,t.sortable,{dataSource:this.dataSource,change:h})))},_filterable:function(){var i,a,o,r,s,l,d,c=this,h=this.options.filterable,u=v(this.columns,function(e){return e.columns!==t}).length>0;if(h&&!this.options.columnMenu){var p=P(function(e){this.trigger(X,{field:e.field,container:e.container})},this),g=function(e){c.trigger(Z,{filter:e.filter,field:e.field})&&e.preventDefault()},f=P(function(e){c.trigger(Y,{field:e.field,container:e.container})},this);for(i=u?this.lockedHeader?leafDataCells(this.lockedHeader.find(">table>thead")).add(leafDataCells(this.thead)):leafDataCells(this.thead):e(this.lockedHeader).add(this.thead).find("th"),r=n(this.columns),a=0,o=i.length;o>a;a++){s=r[a],l=i.eq(a);var m=r[a].filterable;if(d=l.data("kendoFilterMenu"),d&&d.destroy(),d=l.data("kendoFilterMultiCheck"),d&&d.destroy(),!s.command&&s.filterable!==!1){var y=T(!0,{},h,s.filterable,{dataSource:c.dataSource,init:p,open:f,change:g});m&&m.multi?l.kendoFilterMultiCheck(y):l.kendoFilterMenu(y)}}}},_tableKeyDown:function(t){var i=!1,a=this.current(),n=e(t.target);!t.isDefaultPrevented()&&!n.is(":button,a,:input,a>.k-icon");a=a?a:e(this.lockedTable).add(this.table).find(J),t.keyCode==O.ENTER&&(i=this._handleEnterKey(a,t.currentTarget,n)),i&&(t.preventDefault(),t.stopPropagation())},_handleEnterKey:function(t,i,a){var n,o=this.options.editable,r=a.closest("[role=gridcell]");return a.is("table")||e.contains(t[0],a[0])||(t=r),t.is("th")?(t.find(".k-link").click(),!0):(n=t.find(":kendoFocusable:first"),n[0]&&t.hasClass("k-state-focused")?(n.focus(),!0):o&&!a.is(":button,.k-button,textarea")?(r[0]||(r=t),this._handleEditing(r,!1,i),!0):!1)},_handleEditing:function(t,i,a){var n,o,r,s,d=this,c=e(g._activeElement()),h=V.msie,u=d.options.editable&&d.options.editable.update!==!1,p=d._isIncellEditable(),f=e(i).parents("tr").index(),m=e(i).index(),v=e(t).parents("tr").index(),y=t.index();if(a=e(a),r=p?t.hasClass($.editCell):t.parent().hasClass("k-grid-edit-row"),d.editor){if(n=d.editor.wrapper,n&&e.contains(n[0],c[0])&&(V.opera?c.blur().change().triggerHandler("blur"):(c.blur(),h&&c.blur())),!d.editor)return void l(a);if(!d.editor.end())return p?d.current(n):d.current(n.children().filter(j).first()),o=n.find(":kendoFocusable:first")[0],void(o&&o.focus());p?(d._preventPageSizeRestore=!0,d.closeCell(),d._preventPageSizeRestore=!1,0===e(d.table).add(d.lockedTable).find(G+$.editCell).length&&d.current(a.find("tbody").children().eq(v).children().eq(y))):(d.saveRow(),r=!0)}if(i=e(i).length&&0===a.find(i).length?a.find("tbody").children().eq(f).children().eq(m):i,i&&d.current(i),l(a,!0),u)if(!r&&!i||i){var b=d.current().index();p?(d.editCell(d.current()),s=e(d.table).add(d.lockedTable).find(G+$.editCell)[0],s?d._current=e(s):d._findCurrentCell&&d.current(d._findCurrentCell())):(d.editRow(d.current().parent()),d.current(d.editor.wrapper.children().eq(b)),d.current().removeClass("k-state-focused"))}else d.dataSource._restorePageSizeAfterAddChild&&d.dataSource._restorePageSizeAfterAddChild()},cellIndex:function(t){var i=0;return this.lockedTable&&!e.contains(this.lockedTable[0],t[0])&&(i=n(r(this.columns)).length),e(t).parent().children().index(t)+i},editCell:function(t){var i=this;if(t=e(t),!t||!t.hasClass("kd-treegridCell-disabled")){var a=n(i.columns)[i.cellIndex(t)],o=i.dataItem(t);o&&a&&(!o.editable||o.editable(a.field))&&i._editCell(t,a,o)}},_editCell:function(e,t,i){var a,n=this;n.trigger(q,{model:i}),n.closeCell(),i._edit=!0,n._cancelEditor(),n._render({editedColumn:t,editedColumnIndex:e.index()}),a=KD.isEmpty(e)?n.table.add(n.lockedTable).find(G+$.editCell).first():e,n.editor=n._createIncellEditor(a,{columns:[t],model:i,change:function(t){n.trigger(S,{values:t.values,container:e,model:i})&&t.preventDefault()}}),n._current=a,n.trigger(_,{container:e,model:i})},_cancelEditor:function(){var e,t=this,i=t.editor;i&&(e=i.model,t._destroyEditor(),t._isIncellEditable()?t._shouldRestorePageSize()&&t.dataSource._restorePageSizeAfterAddChild():t.dataSource.cancelChanges(e),e._edit=!1),t._preventPageSizeRestore=!1},_shouldRestorePageSize:function(){var e=this;return e._isPageable()&&e._isIncellEditable()&&!e._preventPageSizeRestore},_createIncellEditor:function(e,t){var i=this,a=T({},t.columns[0]);return delete a.parentColumn,new ae(e,T({},{fieldRenderer:P(i._cellContent,i),appendTo:i.wrapper,clearContainer:!1,target:i,columns:[a],model:t.model,change:t.change}))},closeCell:function(e){var t,i,a=this,n=(a.editor||{}).element;n&&n[0]&&a._isIncellEditable()&&(i=a.dataItem(n),e&&a.trigger(w,{container:n,model:i})||(a.trigger(K,{type:e?w:S,model:i,container:n}),a._cancelEditor(),n.removeClass($.editCell),t=n.parent().removeClass($.editRow),a.lockedContent&&a._relatedRow(t).removeClass($.editRow),a._render(),a.trigger(I,{item:t,data:i,ns:f}),a.lockedContent&&d(t.css("height","")[0],a._relatedRow(t).css("height","")[0])))},_isIncellEditable:function(){return this._editMode()===x},_items:function(t){return t.find("tr[data-uid]").filter(function(){return!e(this).hasClass($.footerTemplate)})},_footerItems:function(){var t=this.tbody;return this._hasLockedColumns&&(t=t.add(this.lockedTable)),t.find("tr").filter(function(){return e(this).hasClass($.footerTemplate)})},_columnTemplates:function(){var e,t,i,a=n(this.columns);for(e=0,t=a.length;t>e;e++)i=a[e],i.template&&(i.template=g.template(i.template)),i.headerTemplate&&(i.headerTemplate=g.template(i.headerTemplate)),i.footerTemplate&&(i.footerTemplate=g.template(i.footerTemplate))},_trs:function(t){var i,a,n,o,r,s,l,d,c=this,h=[],u=t.level,p=t.data,f=this.dataSource,m=f.aggregates()||{},v=c._getmodelIdField(),y=c._getModelParentIdField(),b=t.columns,D=c._isPageable(),k=t.childrenMap||{};for(s=0,l=p.length;l>s;s++){n=[],i=p[s],d=i[v],r=D?k[d]:i.loaded()?f.childNodes(i):[],o=r&&r.length,a={role:"row"},a[g.attr("uid")]=i.uid,o&&(a["aria-expanded"]=!!i.expanded),t.visible?D||(this._absoluteIndex%2!==0&&n.push($.alt),this._absoluteIndex++):a.style={display:"none"},e.inArray(i.uid,t.selected)>=0&&n.push($.selected),o&&n.push($.group),i._edit&&n.push("k-grid-edit-row"),a.className=n.join(" ");var C=this._tds({model:i,attr:a,level:D?c._renderedModelLevel(i,t):u,editedColumn:t.editedColumn,editedColumnIndex:t.editedColumnIndex},b,P(this._td,this));if(h.push(C),o){if(D&&(r=(t.viewChildrenMap||{})[d]||[]),0===r.length)continue;h=h.concat(this._trs({columns:b,editedColumn:t.editedColumn,editedColumnIndex:t.editedColumnIndex,aggregates:m,selected:t.selected,visible:D?t.visible:t.visible&&!!i.expanded,data:r,childrenMap:t.childrenMap||k,viewChildrenMap:t.viewChildrenMap,level:u+1}))}}return this._hasFooterTemplate()&&i&&(a={className:$.footerTemplate,"data-parentId":i[y]},KD.isEmpty(i[y])&&t.visible||(a.style={display:"none"}),h.push(this._tds({model:m[i[y]],attr:a,level:u,editedColumn:t.editedColumn,editedColumnIndex:t.editedColumnIndex},b,this._footerId))),h},_footerId:function(t){var i=[],a=t.column,n=t.column.footerTemplate||e.noop,r=t.model[a.field]||{},s={role:"gridcell",style:a.hidden===!0?{display:"none"}:{}};return a.expandable&&(i=i.concat(o({level:t.level+1,className:$.iconPlaceHolder}))),a.attributes&&T(!0,s,a.attributes,{style:a.hidden===!0?{display:"none"}:{}}),i.push(z(n(r)||"")),L("td",s,i)},_hasFooterTemplate:function(){return!!v(this.columns,function(e){return e.footerTemplate}).length},_tds:function(e,t,i){for(var a,n=[],o=(e.editedColumn||{}).field,r=this._isIncellEditable(),s=t.length,l=0;s>l;l++){a=t[l];var d=i&&i({model:e.model,column:a,editColumn:!r||r&&a.field===o&&e.editedColumnIndex===l,level:e.level});n.push(d)}return L("tr",e.attr,n)},_td:function(e){var t,n=[],r=e.model,s=e.column,l={role:"gridcell",style:s.hidden===!0?{display:"none"}:{}},d=this._isIncellEditable(),c=!1;return s.attributes&&T(!0,l,s.attributes),r._edit&&s.field&&e.editColumn&&(d||!d&&a(s,r))?(l[g.attr("container-for")]=s.field,d&&(l.className&&-1!==l.className.indexOf($.editCell)?l.className+=" "+$.editCell:l.className||(l.className=$.editCell))):(s.expandable&&(n=o({level:e.level,className:$.iconPlaceHolder}),t=[$.icon],r.hasChildren?t.push(r.expanded?$.iconCollapse:$.iconExpand):t.push($.iconHidden),r._error?t.push($.refresh):!r.loaded()&&r.expanded&&t.push($.loading),n.push(L("span",{className:t.join(" ")})),l.style["white-space"]="nowrap"),i(s,r)&&(l.className?l.className+=$.dirtyCell:l.className||(l.className=$.dirtyCell)),s.command?(l.className&&-1!==l.className.indexOf("k-command-cell")?l.className+=" k-command-cell":l.className||(l.className="k-command-cell"),c=v(s.command,function(e){return e===_||e.name===_}).length>0,n=r._edit&&!this._isIncellEditable()&&c?this._buildCommands(["update","canceledit"]):this._buildCommands(s.command)):n.push(this._cellContent(s,r)),l["class"]&&(l.className=l["class"]+" "+l.className)),L("td",l,n)},_render:function(t){t=t||{};var i=this.options.messages,a=this.dataSource.rootNodes(),o=g.attr("uid"),r=this.select().removeClass("k-state-selected").map(function(t,i){return e(i).attr(o)});if(this._absoluteIndex=0,this._angularItems("cleanup"),this._angularFooters("cleanup"),this._flushCache(),t.error)this._showStatus(g.template("#: messages.requestFailed # <button class='#= buttonClass #'>#: messages.retry #</button>")({buttonClass:[$.button,$.retry].join(" "),messages:i}));else if(a.length){this._hideStatus();try{this._contentTree&&this._contentTree.render&&this._contentTree.render(this._trs({columns:n(s(this.columns)),editedColumn:t.editedColumn,editedColumnIndex:t.editedColumnIndex,aggregates:t.aggregates,selected:r,data:a,visible:!0,level:0}))}catch(l){KD.writeError("KD.writeError:"+l.message,l.stack)}this._hasLockedColumns&&(this._absoluteIndex=0,this._lockedContentTree.render(this._trs({columns:this._lockedColumns(),aggregates:t.aggregates,selected:r,data:a,visible:!0,level:0})))}else this._showStatus(g.htmlEncode(i.noRows));this._touchScroller&&this._touchScroller.contentResized(),this._muteAngularRebind(function(){this._angularItems("compile"),this._angularFooters("compile")}),this.items().filter(function(){return e.inArray(e(this).attr(o),r)>=0}).addClass("k-state-selected"),this._adjustRowsHeight()},_attachEvents:function(){var e=G+$.iconCollapse+", ."+$.iconExpand+", ."+$.refresh,t=G+$.retry;this.element.on(E+y,e,P(this._toggleChildren,this)).on(R+y,t,this._dataSourceFetchProxy).on(R+y,".k-button[data-command]",P(this._commandClick,this)),this._attachCellEditingEventHandlers()},_attachCellEditingEventHandlers:function(){var t=this,i=t.options.editable,a=t.selectable&&t.selectable.options.multiple,n=function(i){var a=B(),n=t.editor||{},o=n.element;!o||e.contains(o[0],a)||o[0]===a||e(a).closest(".k-animation-container").length||n.end()&&(i.relatedTarget||!t._isPageable()||isUndefined(t.dataSource._addChildPageSize)||(t._preventPageSizeRestore=!1),t.closeCell()),t._preventPageSizeRestore=!1};t._isIncellEditable()&&i.update!==!1&&t.wrapper.on(R+y,"tr:not(.k-grouping-row) > td",function(i){var n=e(this),o=t.lockedTable&&n.closest("table")[0]===t.lockedTable[0];return t.current(n),n.hasClass($.editCell)||n.has("a.k-grid-delete").length||n.has("button.k-grid-delete").length||n.closest("tbody")[0]!==t.tbody[0]&&!o||e(i.target).is(":input")||e(i.target).hasClass($.iconExpand)||e(i.target).hasClass($.iconCollapse)||n.hasClass("kdgrid-td-state-disable")?(t.editor?n.hasClass($.editCell)||t.editor.end()&&(a&&e(B()).blur(),t.closeCell()):t.dataSource._restorePageSizeAfterAddChild&&t.dataSource._restorePageSizeAfterAddChild(),void(t._preventPageSizeRestore=!1)):void(t.editor?t.editor.end()&&(a&&e(B()).blur(),t.closeCell(),t.editCell(n)):t.editCell(n))}).on("mousedown"+y,"tr:not(.k-grouping-row) > td",function(i){t.editor&&t._isPageable()&&!isUndefined(t.dataSource._addChildPageSize)?t._preventPageSizeRestore=e(i.target).parents(G+$.editRow).length>0:t._preventPageSizeRestore=!1}).on("focusin"+y,function(){e.contains(this,B())||(clearTimeout(t._closeCellTimeout),t._closeCellTimeout=null)}).on("focusout"+y,function(e){t._closeCellTimeout=setTimeout(function(){n(e)},1)})},_isPageable:function(){var e=this;return e.options.pageable&&e.dataSource&&e.dataSource._isPageable&&e.dataSource._isPageable()},_getmodelIdField:function(){var e={};return this.dataSource&&this.dataSource.options&&this.dataSource.options.schema&&(e=this.dataSource.options.schema),e.id||"treeId"},_getModelParentIdField:function(){var e={};return this.dataSource&&this.dataSource.options&&this.dataSource.options.schema&&(e=this.dataSource.options.schema),e.parentId||"parentId"},_toggle:function(i,a){var n=this,o=e.Deferred().resolve().promise(),r=i.loaded();return n._isIncellEditable()&&n.editor&&(e(B()).change(),n.closeCell()),i._error&&(i.expanded=!1,i._error=t),!r&&i.expanded?o:("undefined"==typeof a&&(a=!i.expanded),i.expanded=a,r||(o=this.dataSource.load(i).always(P(function(){this._render(),this._syncLockedContentHeight()},this))),this._render(),this._syncLockedContentHeight(),o)},current:function(t){var i=this._current;return t=e(t),!t.length||i&&i[0]===t[0]||this._setCurrent(t),this._current},_setCurrent:function(t){var i=this;return t=e(t),t[0]&&(i._updateCurrentAttr(i._current,t),i._current=t),i._current},_updateCurrentAttr:function(t,i){e(t).removeClass($.focused),i.addClass($.focused),this._current=i},setColWidth:function(t,i){var a=this.table,n=this.thead,o=this._headerColsTree&&this._headerColsTree.root;if(!a||!n||!o)return!1;var r=e(o).eq(0),s=a.find("colgroup").eq(0),l=n.find("tr th[data-field="+t+"]").index(),d=r.find("col").eq(l),c=s.find("col").eq(l);d.width(i),c.width(i);var h=this.columns;if(h&&h.length)for(var u=0;u<h.length;u++){var p=h[u],g=p.field&&p.field.toUpperCase();if(g==t.toUpperCase())return void(p.width=i)}},setColIndex:function(e,t){var i=this.columns;if(i&&i.length)for(var a=0;a<i.length;a++){var n=i[a],o=n.field&&n.field.toUpperCase();if(o==e.toUpperCase())return void this.reorderColumn(t,n,!0)}}});f.plugin(ne)}(window.kendo.jQuery),define("KDKendoTreeGrid",["KD"],function(e){return function(){var t;return t||e.KDKendoTreeGrid}}(this)),function(e){var t=window.kendo,i=t.ui,a=i.Draggable,n=(e.grep,{}),o="keyup",r="dragstart",s=a.extend({options:{name:"KDDraggable"},_start:function(i){var a=this,s=a.options,l=s.container,d=s.hint;if(this._shouldIgnoreTarget(i.touch.initialTouch)||s.holdToDrag&&!a._activated)return void a.userEvents.cancel();if(a.currentTarget=i.target,a.currentTargetOffset=e(a.currentTarget).offset(),d){a.hint&&a.hint.stop(!0,!0).remove(),a.hint=t.isFunction(d)?e(d.call(a,a.currentTarget)):d;var c=this._getKDOffset(a.currentTarget);a.hintOffset=c,a.hint.css({position:"absolute",zIndex:2e4,left:c.left,top:c.top}).appendTo(document.body),a.angular("compile",function(){a.hint.removeAttr("ng-repeat");for(var t=e(i.target);!t.data("$$kendoScope")&&t.length;)t=t.parent();return{elements:a.hint.get(),scopeFrom:t.data("$$kendoScope")}})}n[s.group]=a,a.dropped=!1,l&&(a.boundaries=containerBoundaries(l,a.hint)),e(document).on(o,a._captureEscape),a._trigger(r,i)&&(a.userEvents.cancel(),a._afterEnd()),a.userEvents.capture()},_getKDOffset:function(t){var i=void 0;if(t){dragtarget=e(t),i=dragtarget.offset();var a=parseFloat(dragtarget.attr("transform"));a=KD.isNaN(a)?0:a;var n=a/180!=parseInt(a/180);if(n){var o={width:dragtarget.width(),height:dragtarget.height()};i.left=this._getRotatePositionByTruePosition(i.left,o,!0),i.top=this._getRotatePositionByTruePosition(i.top,o,!1)}}return i},_getRotatePositionByTruePosition:function(e,t,i){var a,n={};return i?(n.left=e+t.height/2,a=n.left-t.width/2):(n.top=e+t.width/2,a=n.top-t.height/2),a}});i.plugin(s)}(window.kendo.jQuery),define("KDDragAndDrop",["KD"],function(e){return function(){var t;return t||e.KDDragAndDrop}}(this)),function(e,t){var i=window.kendo,a=i.ui,n=a.ToolBar,o="open",r="close",s="click",l="toggle",d="k-button",c="k-split-button",h="k-split-button-arrow",u="k-overflow-anchor",p="k-overflow-button",g=e.proxy,f=e(document.documentElement),m=i.isFunction,v=n.extend({options:{name:"KDToolbar"},init:function(e,t){var i=this;n.fn.init.call(i,e,t),i.element.on("mouseenter",".k-split-button",g(i._toggleHover,i)).on("mouseleave",".k-split-button",g(i.closePopup,i)).on("mouseenter",".k-split-button-arrow",g(i.openPopup,i))},_toggleHover:function(e){f.trigger("pointerdown"),this._toggle.call(this,e)},openPopup:function(t){var i=e(t.target).closest("."+c).data("splitButton");if(i.options.enable){var a=this.trigger(o,{target:i.element,targetActive:e(t.target)});t.stopPropagation(),a||i.popup.open()}},closePopup:function(t){var i=e(t.target).closest("."+c).data("splitButton");if(i.options.enable&&e(t.relatedTarget).closest(i.popupElement).length<1){var a=this.trigger(r,{target:i.element,targetActive:e(t.target)});a||i.popup.close()}},hide:function(e){var t=this._getItem(e);t.toolbar&&("button"===t.toolbar.options.type&&t.toolbar.options.isChild?(t.toolbar.hide(),t.toolbar.getParentGroup().refresh()):t.toolbar.options.hidden||t.toolbar.hide()),t.overflow&&("button"===t.overflow.options.type&&t.overflow.options.isChild?(t.overflow.hide(),t.overflow.getParentGroup().refresh()):t.overflow.hide()),this.resize(!0)},_buttonClick:function(t){var i,a,n,o,r,c,g,f=this,v=t.target.closest("."+h).length;return t.preventDefault(),v?void f._toggle(t):(a=e(t.target).closest("."+d,f.element),void(a.hasClass(u)||(n=a.data("button"),!n&&f.popup&&(a=e(t.target).closest("."+p,f.popup.container),n=a.parent("li").data("button")),n&&n.options.enable&&(n.options.togglable?(r=m(n.toggleHandler)?n.toggleHandler:null,n.toggle(!n.options.selected,!0),c={target:a,group:n.options.group,checked:n.options.selected,id:n.options.id},r&&r.call(f,c),f.trigger(l,c)):(r=m(n.clickHandler)?n.clickHandler:null,c={sender:f,target:a,id:n.options.id},r&&r.call(f,c),f.trigger(s,c)),n.options.url&&(n.options.attributes&&n.options.attributes.target&&(g=n.options.attributes.target),window.open(n.options.url,g||"_self")),a.hasClass(p)&&f.popup.close(),o=a.closest(".k-split-container"),o[0]&&(i=o.data("kendoPopup"),(i?i:o.parents(".km-popup-wrapper").data("kendoPopup")).close())))))},_toggle:function(t){var i,a=e(t.target).closest("."+c).data("splitButton");t.preventDefault(),a.options.enable&&(i=a.popup.element.is(":visible")?this.trigger(r,{target:a.element,targetActive:e(t.target)}):this.trigger(o,{target:a.element,targetActive:e(t.target)}),i||a.toggle())}});a.plugin(v)}(window.kendo.jQuery),define("KDKendoToolbar",["KD"],function(e){return function(){var t;return t||e.KDKendoToolbar}}(this)),function(e,t){function i(t,i){try{return e.contains(t,i)}catch(a){return!1}}function a(e,t,i){e=e.split(" ")[!t+0]||e;var a={origin:["bottom",i?"right":"left"],position:["top",i?"right":"left"]},n=/left|right/.test(e);return n?(a.origin=["top",e],a.position[1]=o.directions[e].reverse):(a.origin[0]=e,a.position[0]=o.directions[e].reverse),a.origin=a.origin.join(" "),a.position=a.position.join(" "),a}function n(e,t){return e=e.split(" ")[!t+0]||e,e.replace("top","up").replace("bottom","down")}var o=window.kendo,r=o.ui,s=r.Menu,l=o.support.touch&&o.support.mobileOS,d=e.extend,c=e.proxy,h="k-link",u=":not(.k-list) > .k-item",p="div:not(.k-animation-container,.k-list-container)",g="k-state-disabled",f=".k-menu",m=".k-menu-group",v=m+",.k-animation-container",y="select",b=o.support.pointers,D="close",k="open",C="k-state-hover",x="timer",w="zIndex",K="kendoPopup",S="activate",I="deactivate",P="k-menu",F={2:1,touch:1},b=o.support.pointers,T=o.support.msPointers,_=T||b,A=l||_,L=s.extend({options:{name:"KDMenu"},_click:function(t){for(var i,a,n,r=this,s=r.options,l=e(o.eventTarget(t)),d=l[0],c=l[0]?l[0].nodeName.toUpperCase():"",f="INPUT"==c||"SELECT"==c||"BUTTON"==c||"LABEL"==c,m=l.closest("."+h),x=l.closest(u),w=x[0],K=m.attr("href"),S=l.attr("href"),I=e("<a href='#' />").attr("href"),P=!!K&&K!==I,F=P&&!!K.match(/^#/),_=!!S&&S!==I,A=s.openOnClick&&n&&r._isRootItem(x);d&&d.parentNode!=w;)d=d.parentNode;if(!e(d).is(p)){if(x.hasClass(g))return void t.preventDefault();if(t.handled||!r._triggerEvent({item:x[0],type:y,target:l})||f||t.preventDefault(),t.handled=!0,a=x.children(v),n=a.is(":visible"),s.closeOnClick&&(!P||F)&&(!a.length||A))return x.removeClass(C).css("height"),r._oldHoverItem=r._findRootParent(x),r.close(m.parentsUntil(r.element,u)),r.clicked=!1,void(-1!="MSPointerUp".indexOf(t.type)&&t.preventDefault());P&&t.enterKey&&m[0].click(),(r._isRootItem(x)&&s.openOnClick||o.support.touch||(b||T)&&r._isRootItem(x.closest(u)))&&(P||f||_||t.preventDefault(),r.clicked=!0,i=a.is(":visible")?D:k,(s.closeOnClick||i!=D)&&r[i](x,l))}},_triggerEvent:function(e){var t=this;return t.trigger(e.type,{type:e.type,item:e.item,target:e.target})},_mouseenter:function(t){var a=this,n=e(t.currentTarget),o=n.children(".k-animation-container").length||n.children(m).length;if(t.delegateTarget==n.parents(f)[0]){a.options.openOnClick&&!a.clicked||l||(b||T)&&t.originalEvent.pointerType in F&&a._isRootItem(n.closest(u))||(!i(t.currentTarget,t.relatedTarget)&&o?a.open(n,t.target):e(t.target).hasClass("k-i-arrow-s")&&a.open(n,t.target)),(a.options.openOnClick&&a.clicked||A)&&n.siblings().each(c(function(e,t){a.close(t,!0)},a));var r=n.get(0).tipsObj;if(r&&!n.data("kendoKDTooltip")){var s={id:r.ctlId,xtype:"kdtooltip"},d=r.formpxy,h=d.createInnerControl(s);h.setIsOnlineTips.call(h,!0),h.setTipsData.call(h,r);var p=e.extend(h.getLineTipsOptions(),{position:"right"});n.kendoKDTooltip(p)}}},open:function(i,r){var s=this,c=s.options,h="horizontal"==c.orientation,u=c.direction,p=o.support.isRtl(s.wrapper);return i=s.element.find(i),/^(top|bottom|default)$/.test(u)&&(u=p?h?(u+" left").replace("default","bottom"):"left":h?(u+" right").replace("default","bottom"):"right"),i.siblings().find(">.k-popup:visible,>.k-animation-container>.k-popup:visible").each(function(){var t=e(this).data("kendoPopup");t&&t.close(!0)}),i.each(function(){var i=e(this);clearTimeout(i.data(x)),i.data(x,setTimeout(function(){var g,f=i.find(".k-menu-group:first:hidden");if(f[0]&&s._triggerEvent({item:i[0],type:k,target:r})===!1){if(!f.find(".k-menu-group")[0]&&f.children(".k-item").length>1){var m=e(window).height(),v=function(){f.css({maxHeight:m-(o._outerHeight(f)-f.height())-o.getShadows(f).bottom,overflow:"auto"})};o.support.browser.msie&&o.support.browser.version<=7?setTimeout(v,0):v()}else f.css({maxHeight:"",overflow:""});i.data(w,i.css(w)),i.css(w,s.nextItemZIndex++),g=f.data(K);var y=i.parent().hasClass(P),b=y&&h,x=a(u,y,p),F=c.animation.open.effects,T=F!==t?F:"slideIn:"+n(u,y);g?(g=f.data(K),g.options.origin=x.origin,g.options.position=x.position,g.options.animation.open.effects=T):g=f.kendoPopup({activate:function(){s._triggerEvent({item:this.wrapper.parent(),type:S})},deactivate:function(e){e.sender.element.removeData("targetTransform").css({opacity:""}),s._triggerEvent({item:this.wrapper.parent(),type:I})},origin:x.origin,
position:x.position,collision:c.popupCollision!==t?c.popupCollision:b?"fit":"fit flip",anchor:i,appendTo:i,animation:{open:d(!0,{effects:T},c.animation.open),close:c.animation.close},close:function(e){var t=e.sender.wrapper.parent();s._triggerEvent({item:t[0],type:D})?e.preventDefault():(t.css(w,t.data(w)),t.removeData(w),l&&(t.removeClass(C),s._removeHoverItem()))}}).data(K),f.removeAttr("aria-hidden"),g.open()}},s.options.hoverDelay))}),s}});r.plugin(L)}(window.kendo.jQuery),define("KDKendoMenuBar",["KD"],function(e){return function(){var t;return t||e.KDKendoMenuBar}}(this)),function(e,t){function i(e){var i="string"==typeof e?[{name:e,caption:e}]:e,a="[object Array]"===te.call(i)?i:i!==t?[i]:[];return ae(a,function(e){return"string"==typeof e?{name:e,caption:e}:{name:e.name,caption:e.caption,type:e.type}})}function a(e){var i="string"==typeof e?[{name:[e],caption:[e],expand:!1}]:e,a="[object Array]"===te.call(i)?i:i!==t?[i]:[];return ae(a,function(e){return"string"==typeof e?{name:[e],caption:[e],expand:!1}:{name:"[object Array]"===te.call(e.name)?e.name.slice():[e.name],caption:"[object Array]"===te.call(e.caption)?e.caption.slice():[e.caption],expand:e.expand}})}function n(e){return-1!==e.indexOf(" ")&&(e='["'+e+'"]'),e}function o(e,t,i,a){var n,r,s,l;if(i||(i=t),a||(a=0),l=i.members[a],l&&!l.measure){if(s=l.children,r=s.length,i===t?e[W.stringify([l.name])]=!!r:r&&(e[W.stringify(ze(i,a))]=!0),r)for(n=0;r>n;n++)o(e,t,s[n],a);o(e,t,i,a+1)}}function r(t){var i={};t.length&&o(i,t[0]);var a=[];for(var n in i)a.push({name:e.parseJSON(n),expand:i[n]});return a}function s(e,t){var i=t.tuples||[],a=i[0];if(a&&e.length<a.members.length)for(var n=a.members,o=0;o<n.length;o++)if(!n[o].measure){for(var r=!1,s=0;s<e.length;s++)if(0===N(e[s]).indexOf(n[o].hierarchy)){r=!0;break}r||e.push({name:[n[o].name],expand:!1})}}function l(e){for(var t=[],i=e.members,a=0;a<i.length;a++)i[a].measure||t.push({name:[i[a].name],expand:i[a].children.length>0});return t}function d(e,t,i){e=e||{},s(t,e),i.length>1&&t.push({name:le,measure:!0,children:a(i)});var n={members:t};if(e.tuples){var o=x(e.tuples,n);o.tuple&&(t=l(o.tuple))}return t}function c(e){var t=W.getter(e.field,!0);return function(i,a){return e.aggregate(t(i.dataItem),a,i)}}function h(e){return"number"==typeof e&&!isNaN(e)}function u(e){return e&&e.getTime}function p(e){return e[e.length]={value:"",fmtValue:"",ordinal:e.length},e}function g(e,t,i){return e.tuples.length<y(t.tuples,i)?t:void 0}function f(e,t,i,a,n){var o,r,s,l=e.length,d=y(t,a),c=a.length||1;for(r=0;i>r;r++)for(o=0;l>o;o++)s=v(e[o],t)*c,s+=o%c,n[r*l+o].ordinal=r*d+s}function m(e,t,i,a,n){var o,r,s,l=e.length,d=a.length||1;for(r=0;l>r;r++)for(s=v(e[r],t),s*=d,s+=r%d,o=0;i>o;o++)n[r*i+o].ordinal=s*i+o}function v(e,t){return x(t,e).index}function y(e,t){if(!e.length)return 0;for(var i=e.slice(),a=i.shift(),n=1;a;)a.members?[].push.apply(i,a.members):a.children&&(a.measure||(n+=a.children.length),[].push.apply(i,a.children)),a=i.shift();return t.length&&(n*=t.length),n}function b(e){return e||(e={tuples:[]}),e.tuples||(e.tuples=[]),e}function D(e,t,i){if(!e)return 0;var a=Math.max(i.length,1),n=e.members.slice(0,t),o=a,r=n.shift();for(a>1&&(a+=1);r;)r.name===le?o+=a:r.children?[].push.apply(n,r.children):(o++,[].push.apply(n,r.members)),r=n.shift();return o}function k(e,t,i){if(!t[0])return{parsedRoot:null,tuples:e,memberIndex:0,index:0};var a=x(e,t[0]);if(!a.tuple)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};var n=a.tuple.members,o=t[0].members,r=-1;if(n.length!==o.length)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};for(var s=0,l=n.length;l>s;s++)!n[s].measure&&o[s].children[0]&&(-1==r&&o[s].children.length&&(r=s),n[s].children=o[s].children);return i=Math.max(i.length,1),{parsedRoot:a.tuple,index:a.index*i,memberIndex:r,tuples:e}}function C(e,t){var i,a,n=!0;for(e=e.members,t=t.members,i=0,a=e.length;a>i;i++)e[i].measure||t[i].measure||(n=n&&N(e[i])===N(t[i]));return n}function x(e,t){var i,a,n,o,r,s,l,d=0;for(i=0,a=e.length;a>i;i++){if(n=e[i],C(n,t))return{tuple:n,index:d};for(d++,r=0,s=n.members.length;s>r;r++)if(l=n.members[r],!l.measure&&(o=x(l.children,t),d+=o.index,o.tuple))return{tuple:o.tuple,index:d}}return{index:d}}function w(e,t){var i,a,n,o="";for(a=0,n=e.length;n>a;a++)i=e[a],o+=i.name,t[o]||(t[o]=i)}function K(e,t){var i,a,n,o,r=e.members,s="",l="";for(i=0,a=r.length;a>i;i++){if(n=r[i],o){if(t[s+n.name]){s+=n.name,o=t[s];continue}return t[s+n.parentName]?t[s+n.parentName]:t[l+n.parentName]?t[l+n.parentName]:t[l]}if(s+=n.name,o=t[n.parentName],!o&&(o=t[s],!o))return null;o&&(l+=o.name)}return o}function S(e,t){if(0===t.length)return-1;for(var i=t[0],a=e.members,n=0,o=a.length;o>n;n++)if(a[n].name==i.name)return n}function I(i,a){if(!(0>a)){var n={name:le,measure:!0,children:[e.extend({members:[],dataIndex:i.dataIndex},i.members[a])]};i.members.splice(a,1,n),i.dataIndex=t}}function P(e,t){if(e.length<1)return[];for(var i=[],a={},n=S(e[0],t),o=0;o<e.length;o++){var r=e[o];r.dataIndex=o,I(r,n);var s=K(r,a);s?0>n||!s.measure?s.children.push(r):s.children.push(r.members[n].children[0]):i.push(r),w(r.members,a)}return i}function F(e,t){if(!e||!e.length)return t;var i,a,n,o,r,s=[],l=_(e),d=l.length,c=Math.max(t.length/d,1);for(i=0;d>i;i++)for(n=c*i,o=c*l[i],a=0;c>a;a++)r=parseInt(o+a,10),s[parseInt(n+a,10)]=t[r]||{value:"",fmtValue:"",ordinal:r};return s}function T(e,t){if(!e||!e.length)return t;var i,a,n,o,r=[],s=_(e),l=s.length,d=Math.max(t.length/l,1);for(a=0;d>a;a++)for(n=l*a,i=0;l>i;i++)o=s[i]+n,r[n+i]=t[o]||{value:"",fmtValue:"",ordinal:o};return r}function _(e){e=e.slice();for(var i,a,n,o,r,s=[],l=e.shift();l;){for(l.dataIndex!==t&&s.push(l.dataIndex),n=0,i=0,a=l.members.length;a>i;i++)r=l.members[i],o=r.children,r.measure?[].splice.apply(e,[0,0].concat(o)):[].splice.apply(e,[n,0].concat(o)),n+=o.length;l=e.shift()}return s}function A(e){var t=e.split(".");return t.length>2?t[0]+"."+t[1]:e}function L(e,t){var i,a=e.length-1,n=e[a];return i=M(t,n),i&&i.dir?n="ORDER("+n+".Children,"+i.field+".CurrentMember.MEMBER_CAPTION,"+i.dir+")":n+=".Children",e[a]=n,e}function M(e,t){for(var i=0,a=e.length;a>i;i++)if(0===t.indexOf(e[i].field))return e[i];return null}function E(e){var t,i="CROSSJOIN({";return e.length>2?(t=e.pop(),i+=E(e)):(i+=e.shift(),t=e.pop()),i+="},{",i+=t,i+="})"}function B(e,t){var i=e.slice(0);return t.length>1&&i.push("{"+R(t).join(",")+"}"),E(i)}function R(e){for(var i,a=0,n=e.length,o=[];n>a;a++)i=e[a],o.push(i.name!==t?i.name:i);return o}function N(e){return e=e.name||e,"[object Array]"===te.call(e)&&(e=e[e.length-1]),e}function H(e){for(var t=e.length,i=[],a=0;t>a;a++)i.push(e[a].name[0]);return i}function O(e,t){var i,a,n,o=0,r=e.length,s=t.length;for(t=t.slice(0);r>o;o++)for(i=e[o],n=0;s>n;n++)if(a=A(t[n]),-1!==i.indexOf(a)){t[n]=i;break}return{names:t,expandedIdx:n,uniquePath:t.slice(0,n+1).join("")}}function V(e){for(var t,i,a,n,o,r,s=[],l=[],d=[],c=0,h=e.length;h>c;c++)if(t=e[c],n=t.name,r=!1,"[object Array]"!==te.call(n)&&(t.name=n=[n]),n.length>1)l.push(t);else{for(o=A(n[0]),i=0,a=d.length;a>i;i++)if(0===d[i].name[0].indexOf(o)){r=!0;break}r||d.push(t),t.expand&&s.push(t)}return s=s.concat(l),{root:d,expanded:s}}function j(e,t,i){var a="";e=e||[];var n=V(e),o=n.root,r=H(o),s=[];n=n.expanded;var l,d=n.length,c=0,h=[];if(r.length>1||t.length>1){for(s.push(B(r,t));d>c;c++)l=L(n[c].name,i),h=O(l,r).names,s.push(B(h,t));a+=s.join(",")}else{for(;d>c;c++)l=L(n[c].name,i),h.push(l[0]);a+=r.concat(h).join(",")}return a}function z(e){var t="",i=e.value,a=e.field,n=e.operator;return"in"==n?(t+="{",t+=i,t+="}"):(t+="Filter(",t+=a+".MEMBERS",t+=W.format(Te[n],a,i),t+=")"),t}function U(e,t){var i,a,n="",o=e.filters,r=o.length;for(a=r-1;a>=0;a--)i="SELECT (",i+=z(o[a]),i+=") ON 0",a==r-1?(i+=" FROM ["+t+"]",n=i):n=i+" FROM ( "+n+" )";return n}function q(e,t,i){var a="";if(t){a+="<"+e+">";var n;for(var o in t)n=t[o],i&&(o=o.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g,"$1_").toUpperCase().replace(/_$/,"")),a+="<"+o+">"+n+"</"+o+">";a+="</"+e+">"}else a+="<"+e+"/>";return a}function G(e){if(null==e)return[];var t=te.call(e);return"[object Array]"!==t?[e]:e}function $(e){for(var t={tuples:[]},i=G(W.getter("Tuples.Tuple",!0)(e)),a=W.getter("Caption['#text']"),n=W.getter("UName['#text']"),o=W.getter("LName['#text']"),r=W.getter("LNum['#text']"),s=W.getter("CHILDREN_CARDINALITY['#text']",!0),l=W.getter("['@Hierarchy']"),d=W.getter("PARENT_UNIQUE_NAME['#text']",!0),c=0;c<i.length;c++){for(var h=[],u=G(i[c].Member),p=0;p<u.length;p++)h.push({children:[],caption:a(u[p]),name:n(u[p]),levelName:o(u[p]),levelNum:r(u[p]),hasChildren:parseInt(s(u[p]),10)>0,parentName:d(u[p]),hierarchy:l(u[p])});t.tuples.push({members:h})}return t}var W=window.kendo,J=W.ui,Q=W.Class,X=J.Widget,Y=W.data.DataSource,Z=W._outerWidth,ee=W._outerHeight,te={}.toString,ie=function(e){return e},ae=e.map,ne=e.extend,oe=W.isFunction,re="change",se="error",le="Measures",de="progress",ce="stateReset",he="auto",ue="<div/>",pe=".kendoPivotGrid",ge="__row_total__",fe="dataBinding",me="dataBound",ve="expandMember",ye="collapseMember",be="k-i-arrow-s",De="k-i-arrow-e",ke="<span>#: data.member.caption || data.member.name #</span>",Ce='<span class="k-icon k-i-kpi-#=data.dataItem.value > 0 ? "open" : data.dataItem.value < 0 ? "denied" : "hold"#">#:data.dataItem.value#</span>',xe='<span class="k-icon k-i-kpi-#=data.dataItem.value > 0 ? "increase" : data.dataItem.value < 0 ? "decrease" : "equal"#">#:data.dataItem.value#</span>',we='#= data.dataItem ? kendo.htmlEncode(data.dataItem.fmtValue || data.dataItem.value) || "&nbsp;" : "&nbsp;" #',Ke='<table class="k-pivot-layout"><tr><td><div class="k-pivot-rowheaders"></div></td><td><div class="k-pivot-table k-state-default"></div></td></tr></table>',Se={sum:function(e,t){var i=t.accumulator;return h(i)?h(e)&&(i+=e):i=e,i},count:function(e,t){return(t.accumulator||0)+1},average:{aggregate:function(e,i){var a=i.accumulator;return i.count===t&&(i.count=0),h(a)?h(e)&&(a+=e):a=e,h(e)&&i.count++,a},result:function(e){var t=e.accumulator;return h(t)&&(t/=e.count),t}},max:function(e,t){var i=t.accumulator;return h(i)||u(i)||(i=e),e>i&&(h(e)||u(e))&&(i=e),i},min:function(e,t){var i=t.accumulator;return h(i)||u(i)||(i=e),i>e&&(h(e)||u(e))&&(i=e),i}},Ie=Q.extend({init:function(e){this.options=ne({},this.options,e),this.dimensions=this._normalizeDescriptors("field",this.options.dimensions),this.measures=this._normalizeDescriptors("name",this.options.measures)},_normalizeDescriptors:function(e,t){t=t||{};var i,a={};if("[object Array]"===te.call(t)){for(var n=0,o=t.length;o>n;n++)i=t[n],"string"==typeof i?a[i]={}:i[e]&&(a[i[e]]=i);t=a}return t},_rootTuples:function(e,i){var a,n,o,r,s=i.length||1,l=this.dimensions||[],d=0,c=e.length,h=[],u=[];if(c||i.length){for(d=0;s>d;d++){for(a={members:[]},r=0;c>r;r++)n=e[r],o=n.split("&"),a.members[a.members.length]={children:[],caption:(l[n]||{}).caption||"All",name:n,levelName:n,levelNum:"0",hasChildren:!0,parentName:o.length>1?o[0]:t,hierarchy:n};s>1&&(a.members[a.members.length]={children:[],caption:i[d].caption,name:i[d].descriptor.name,levelName:"MEASURES",levelNum:"0",hasChildren:!1,parentName:t,hierarchy:"MEASURES"}),h[h.length]=a}u.push(ge)}return{keys:u,tuples:h}},_expandedTuples:function(e,i,a){var n,o,r,s,l,d,c,h,u,p,g,f=a.length||1,m=this.dimensions||[],v=[],y=[];for(r in e){for(s=e[r],c=this._findExpandedMember(i,s.uniquePath),l=v[c.index]||[],d=y[c.index]||[],h=c.member.names,n=0;f>n;n++){for(o={members:[]},g=0;g<h.length;g++)g===c.member.expandedIdx?(o.members[o.members.length]={children:[],caption:s.value,name:s.name,hasChildren:!1,levelNum:1,levelName:s.parentName+s.name,parentName:s.parentName,hierarchy:s.parentName+s.name},0===n&&d.push(ze(o,g).join(""))):(p=h[g],u=p.split("&"),o.members[o.members.length]={children:[],caption:(m[p]||{}).caption||"All",name:p,levelName:p,levelNum:"0",hasChildren:!0,parentName:u.length>1?u[0]:t,hierarchy:p});f>1&&(o.members[o.members.length]={children:[],caption:a[n].caption,name:a[n].descriptor.name,levelName:"MEASURES",levelNum:"0",hasChildren:!0,parentName:t,hierarchy:"MEASURES"}),l[l.length]=o}v[c.index]=l,y[c.index]=d}return{keys:y,tuples:v}},_findExpandedMember:function(e,t){for(var i=0;i<e.length;i++)if(e[i].uniquePath===t)return{member:e[i],index:i}},_asTuples:function(e,t,i){i=i||[];var a=this._rootTuples(t.root,i),n=this._expandedTuples(e,t.expanded,i);return{keys:[].concat.apply(a.keys,n.keys),tuples:[].concat.apply(a.tuples,n.tuples)}},_measuresInfo:function(e,t){for(var i,a,n=0,o=e&&e.length,r=[],s={},l={},d=this.measures||{};o>n;n++)a=e[n].descriptor.name,i=d[a]||{},r.push(a),i.result&&(s[a]=i.result),i.format&&(l[a]=i.format);return{names:r,formats:l,resultFuncs:s,rowAxis:t}},_toDataArray:function(e,t,i,a){var n,o,r,s,l,d,c,h,u,p,g=[],f=1,m=[],v=i.length||1,y=a.length||1;for(t.rowAxis?(m=t.names,f=m.length):p=t.names,r=0;v>r;r++)for(c=e[i[r]||ge],d=0;f>d;d++)for(t.rowAxis&&(p=[m[d]]),s=0;y>s;s++)for(u=a[s]||ge,h=c.items[u],n=u===ge?c.aggregates:h?h.aggregates:{},l=0;l<p.length;l++)o=p[l],this._addData(g,n[o],t.formats[o],t.resultFuncs[o]);return g},_addData:function(e,t,i,a){var n,o="";t&&(t=a?a(t):t.accumulator,o=i?W.format(i,t):t),n=e.length,e[n]={ordinal:n,value:t||"",fmtValue:o}},_matchDescriptors:function(e,i,a){for(var n,o,r,s,l=i.names,d=i.expandedIdx;d>0;)if(n=l[--d].split("&"),n.length>1&&(o=n[0],r=n[1],s=a[o](e),s=s!==t&&null!==s?s.toString():s,s!=r))return!1;return!0},_calculateAggregate:function(e,t,i){for(var a,n,o={},r=0;r<e.length;r++)n=e[r].descriptor.name,a=i.aggregates[n]||{},a.accumulator=e[r].aggregator(t,a),o[n]=a;return o},_processColumns:function(e,i,a,n,o,r,s,l){for(var d,c,h,u,p,g,f,m,v=o.dataItem,y=0;y<i.length;y++)c=i[y],this._matchDescriptors(v,c,a)&&(m=c.names.slice(0,c.expandedIdx).join(""),g=c.names[c.expandedIdx],d=a[g](v),d=d!==t&&null!==d?d.toString():d,f=g,g=g+"&"+d,p=m+g,h=n[p]||{index:s.columnIndex,parentName:f,name:g,uniquePath:m+f,value:d},u=r.items[p]||{aggregates:{}},r.items[p]={index:h.index,aggregates:this._calculateAggregate(e,o,u)},l&&(n[p]||s.columnIndex++,n[p]=h))},_measureAggregators:function(e){var t,i,a,n,o,r,s=e.measures||[],l=this.measures||{},d=[];if(s.length){for(a=0,n=s.length;n>a;a++)if(t=s[a],i=l[t.name],o=null,i){if(r=i.aggregate,"string"==typeof r){if(o=Se[r.toLowerCase()],!o)throw new Error("There is no such aggregate function");i.aggregate=o.aggregate||o,i.result=o.result}d.push({descriptor:t,caption:i.caption,result:i.result,aggregator:c(i)})}}else d.push({descriptor:{name:"default"},caption:"default",aggregator:function(){return 1}});return d},_buildGetters:function(e){for(var t,i,a={},o=0;o<e.length;o++)i=e[o],t=i.split("&"),t.length>1?a[t[0]]=W.getter(t[0],!0):a[i]=W.getter(n(i),!0);return a},_parseDescriptors:function(e){for(var t=V(e),i=H(t.root),a=t.expanded,n=[],o=0;o<a.length;o++)n.push(O(a[o].name,i));return{root:i,expanded:n}},_filter:function(e,t){if(!t)return e;for(var i,a=0,n=t.filters;a<n.length;a++)i=n[a],"in"===i.operator&&(n[a]=this._normalizeFilter(i));return new W.data.Query(e).filter(t).data},_normalizeFilter:function(e){var t=e.value.split(","),i=[];if(!t.length)return t;for(var a=0;a<t.length;a++)i.push({field:e.field,operator:"eq",value:t[a]});return{logic:"or",filters:i}},process:function(e,t){e=e||[],t=t||{},e=this._filter(e,t.filter);var i=t.measures||[],n="rows"===t.measuresAxis,o=t.columns||[],r=t.rows||[];!o.length&&r.length&&(!i.length||i.length&&n)&&(o=r,r=[],n=!1),o.length||r.length||(n=!1),!o.length&&i.length&&(o=a(t.measures)),o=this._parseDescriptors(o),r=this._parseDescriptors(r);var s,l,d,c,h,u,p,g,f,m,v,y,b,D={},k={},C={},x={columnIndex:0},w=this._measureAggregators(t),K=this._buildGetters(o.root),S=this._buildGetters(r.root),I=!1,P=o.expanded,F=r.expanded,T=0!==F.length,_=e.length,A=0;if(o.root.length||r.root.length)for(I=!0,A=0;_>A;A++)for(l=e[A],d={dataItem:l,index:A},p=D[ge]||{items:{},aggregates:{}},this._processColumns(w,P,K,k,d,p,x,!T),p.aggregates=this._calculateAggregate(w,d,p),D[ge]=p,c=0;c<F.length;c++)h=F[c],this._matchDescriptors(l,h,S)?(f=h.names.slice(0,h.expandedIdx).join(""),u=h.names[h.expandedIdx],m=u,s=S[u](l),s=s?s.toString():s,u=u+"&"+s,g=f+u,C[g]={uniquePath:f+m,parentName:m,name:u,value:s},v=D[g]||{items:{},aggregates:{}},this._processColumns(w,P,K,k,d,v,x,!0),v.aggregates=this._calculateAggregate(w,d,v),D[g]=v):this._processColumns(w,P,K,k,d,{items:{},aggregates:{}},x,!0);return I&&_?(!(w.length>1)||t.columns&&t.columns.length||(o={root:[],expanded:[]}),y=this._asTuples(k,o,n?[]:w),b=this._asTuples(C,r,n?w:[]),k=y.tuples,C=b.tuples,D=this._toDataArray(D,this._measuresInfo(w,n),b.keys,y.keys)):D=k=C=[],{axes:{columns:{tuples:k},rows:{tuples:C}},data:D}}}),Pe=Q.extend({init:function(e,t){this.transport=t,this.options=t.options||{},this.transport.discover||oe(e.discover)&&(this.discover=e.discover)},read:function(e){return this.transport.read(e)},update:function(e){return this.transport.update(e)},create:function(e){return this.transport.create(e)},destroy:function(e){return this.transport.destroy(e)},discover:function(e){return this.transport.discover?this.transport.discover(e):void e.success({})},catalog:function(i){var a=this.options||{};if(i===t)return(a.connection||{}).catalog;var n=a.connection||{};n.catalog=i,this.options.connection=n,e.extend(this.transport.options,{connection:n})},cube:function(e){var i=this.options||{};if(e===t)return(i.connection||{}).cube;var a=i.connection||{};a.cube=e,this.options.connection=a,ne(!0,this.transport.options,{connection:a})}}),Fe=Y.extend({init:function(t){var n,o=((t||{}).schema||{}).cube,r="columns",s={axes:ie,cubes:ie,catalogs:ie,measures:ie,dimensions:ie,hierarchies:ie,levels:ie,members:ie};o&&(s=e.extend(s,this._cubeSchema(o)),this.cubeBuilder=new Ie(o)),Y.fn.init.call(this,ne(!0,{},{schema:s},t)),this.transport=new Pe(this.options.transport||{},this.transport),this._columns=a(this.options.columns),this._rows=a(this.options.rows),n=this.options.measures||[],"[object Object]"===te.call(n)&&(r=n.axis||"columns",n=n.values||[]),this._measures=i(n),this._measuresAxis=r,this._skipNormalize=0,this._axes={}},_cubeSchema:function(t){return{dimensions:function(){var e=[],i=t.dimensions;for(var a in i)e.push({name:a,caption:i[a].caption||a,uniqueName:a,defaultHierarchy:a,type:1});return t.measures&&e.push({name:le,caption:le,uniqueName:le,type:2}),e},hierarchies:function(){return[]},measures:function(){var e=[],i=t.measures;for(var a in i)e.push({name:a,caption:a,uniqueName:a,aggregator:a});return e},members:e.proxy(function(e,i){var a,o,r=i.levelUniqueName||i.memberUniqueName,s=this.options.schema.data,l=oe(s)?s:W.getter(s,!0),d=this.options.data&&l(this.options.data)||this._rawData||[],c=[],h=0,u={};if(r&&(r=r.split(".")[0]),!i.treeOp)return c.push({caption:t.dimensions[r].caption||r,childrenCardinality:"1",dimensionUniqueName:r,hierarchyUniqueName:r,levelUniqueName:r,name:r,uniqueName:r}),c;for(a=W.getter(n(r),!0);h<d.length;h++)o=a(d[h]),!o&&0!==o||u[o]||(u[o]=!0,c.push({caption:o,childrenCardinality:"0",dimensionUniqueName:r,hierarchyUniqueName:r,levelUniqueName:r,name:o,uniqueName:o}));return c},this)}},options:{serverSorting:!0,serverPaging:!0,serverFiltering:!0,serverGrouping:!0,serverAggregates:!0},catalog:function(e){return e===t?this.transport.catalog():(this.transport.catalog(e),this._mergeState({}),this._axes={},void this.data([]))},cube:function(e){return e===t?this.transport.cube():(this.transport.cube(e),this._axes={},this._mergeState({}),void this.data([]))},axes:function(){return this._axes},columns:function(e){return e===t?this._columns:(this._skipNormalize+=1,this._clearAxesData=!0,this._columns=a(e),void this.query({columns:e,rows:this.rowsAxisDescriptors(),measures:this.measures()}))},rows:function(e){return e===t?this._rows:(this._skipNormalize+=1,this._clearAxesData=!0,this._rows=a(e),void this.query({columns:this.columnsAxisDescriptors(),rows:e,measures:this.measures()}))},measures:function(e){return e===t?this._measures:(this._skipNormalize+=1,this._clearAxesData=!0,void this.query({columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:i(e)}))},measuresAxis:function(){return this._measuresAxis||"columns"},_expandPath:function(e,t){var i="columns"===t?"columns":"rows",n="columns"===t?"rows":"columns",o=a(e),r=N(o[o.length-1]);this._lastExpanded=i,o=d(this.axes()[i],o,this.measures());for(var s=0;s<o.length;s++){var l=N(o[s]);if(l===r){if(o[s].expand)return;o[s].expand=!0}else o[s].expand=!1}var c={};c[i]=o,c[n]=this._descriptorsForAxis(n),this._query(c)},_descriptorsForAxis:function(e){var t=this.axes(),i=this[e]()||[];return t&&t[e]&&t[e].tuples&&t[e].tuples[0]&&(i=r(t[e].tuples||[])),i},columnsAxisDescriptors:function(){return this._descriptorsForAxis("columns")},rowsAxisDescriptors:function(){return this._descriptorsForAxis("rows")},_process:function(e,t){this._view=e,t=t||{},t.items=t.items||this._view,this.trigger(re,t)},_query:function(e){var t=this;return e||(this._skipNormalize+=1,this._clearAxesData=!0),t.query(ne({},{page:t.page(),pageSize:t.pageSize(),sort:t.sort(),filter:t.filter(),group:t.group(),aggregate:t.aggregate(),columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:this.measures()},e))},query:function(t){var i=this._mergeState(t);return this._data.length&&this.cubeBuilder?(this._params(i),this._updateLocalData(this._pristineData),e.Deferred().resolve().promise()):this.read(i)},_mergeState:function(e){return e=Y.fn._mergeState.call(this,e),e!==t&&(this._measures=i(e.measures),e.columns?e.columns=a(e.columns):e.columns||(this._columns=[]),e.rows?e.rows=a(e.rows):e.rows||(this._rows=[])),e},filter:function(e){return e===t?this._filter:(this._skipNormalize+=1,this._clearAxesData=!0,void this._query({filter:e,page:1}))},expandColumn:function(e){this._expandPath(e,"columns")},expandRow:function(e){this._expandPath(e,"rows")},success:function(e){var t;this.cubeBuilder&&(t=(this.reader.data(e)||[]).slice(0)),Y.fn.success.call(this,e),t&&(this._pristineData=t)},_processResult:function(e,t){if(this.cubeBuilder){var i=this.cubeBuilder.process(e,this._requestData);e=i.data,t=i.axes}var a,n,o,r,s,l,d=this.columns(),c=this.rows(),h=t.columns&&t.columns.tuples;d.length||!c.length||!h||!this._rowMeasures().length&&this.measures().length||(t={columns:{},rows:t.columns}),d.length||c.length||"rows"!==this.measuresAxis()||!h||(t={columns:{},rows:t.columns}),this._axes={columns:b(this._axes.columns),rows:b(this._axes.rows)},t={columns:b(t.columns),rows:b(t.rows)},a=this._normalizeTuples(t.columns.tuples,this._axes.columns.tuples,d,this._columnMeasures()),n=this._normalizeTuples(t.rows.tuples,this._axes.rows.tuples,c,this._rowMeasures()),this._skipNormalize-=1,this.cubeBuilder||(e=this._normalizeData({columnsLength:t.columns.tuples.length,rowsLength:t.rows.tuples.length,columnIndexes:a,rowIndexes:n,data:e})),"rows"==this._lastExpanded?(o=t.columns.tuples,s=this._columnMeasures(),r=g(t.columns,this._axes.columns,s),r&&(l="columns",t.columns=r,f(o,r.tuples,t.rows.tuples.length,s,e),this.cubeBuilder||(e=this._normalizeData({columnsLength:y(t.columns.tuples,s),rowsLength:t.rows.tuples.length,data:e})))):"columns"==this._lastExpanded&&(o=t.rows.tuples,s=this._rowMeasures(),r=g(t.rows,this._axes.rows,s),r&&(l="rows",t.rows=r,m(o,r.tuples,t.columns.tuples.length,s,e),this.cubeBuilder||(e=this._normalizeData({columnsLength:y(t.rows.tuples,s),rowsLength:t.columns.tuples.length,data:e})))),this._lastExpanded=null;var u=this._mergeAxes(t,e,l);return this._axes=u.axes,u.data},_readData:function(e){var t=this.reader.axes(e),i=this.reader.data(e);return this.cubeBuilder&&(this._rawData=i),this._processResult(i,t)},_createTuple:function(e,t,i){var a,n,o,r,s,l,d,c,h=e.members,u=h.length,p={members:[]},g=0;for(t&&(u-=1);u>g;g++)c=h[g],n=Number(c.levelNum),o=c.name,r=c.parentName,d=c.caption||o,s=c.hasChildren,l=c.hierarchy,a=c.levelName,i&&(d="All",0===n?r=c.name:n-=1,s=!0,o=l=a=r),p.members.push({name:o,children:[],caption:d,levelName:a,levelNum:n.toString(),hasChildren:s,hierarchy:l,parentName:i?"":r});return t&&p.members.push({name:t.name,children:[]}),p},_hasRoot:function(e,t,i){if(t.length)return x(t,e).tuple;for(var a,n,o,r=e.members,s=!0,l=0,d=r.length;d>l;l++)if(a=r[l],o=Number(a.levelNum)||0,n=i[l],!(0===o||n&&a.name===N(n))){s=!1;break}return s},_mergeAxes:function(e,t,i){var a,n,o=this._columnMeasures(),r=this._rowMeasures(),s=this.axes(),l=y(s.rows.tuples,r),d=e.rows.tuples.length,c=y(s.columns.tuples,o),h=e.columns.tuples.length;"columns"==i?(h=c,n=e.columns.tuples):(n=P(e.columns.tuples,o),t=T(n,t));var u=k(s.columns.tuples,n,o);"rows"==i?(d=y(e.rows.tuples,r),n=e.rows.tuples):(n=P(e.rows.tuples,r),t=F(n,t));var p=k(s.rows.tuples,n,r);if(s.columns.tuples=u.tuples,s.rows.tuples=p.tuples,c!==y(s.columns.tuples,o)){a=u.index+D(u.parsedRoot,u.memberIndex,o);var g=c+h;t=this._mergeColumnData(t,a,d,h,g)}else l!==y(s.rows.tuples,r)&&(a=p.index+D(p.parsedRoot,p.memberIndex,r),t=this._mergeRowData(t,a,d,h));return 0===s.columns.tuples.length&&0===s.rows.tuples.length&&(t=[]),{axes:s,data:t}},_mergeColumnData:function(e,t,i,a,n){var o,r,s,l=this.data().toJSON(),d=0,c=Math.max(this._columnMeasures().length,1);for(i=Math.max(i,1),l.length>0&&(d=c,n-=c),o=0;i>o;o++)r=t+o*n,s=e.splice(0,a),s.splice(0,d),[].splice.apply(l,[r,0].concat(s));return l},_mergeRowData:function(e,t,i,a){var n,o,r,s=this.data().toJSON(),l=Math.max(this._rowMeasures().length,1);for(a=Math.max(a,1),s.length>0&&(i-=l,e.splice(0,a*l)),n=0;i>n;n++)r=e.splice(0,a),o=t*a+n*a,[].splice.apply(s,[o,0].concat(r));return s},_columnMeasures:function(){var e=this.measures(),t=[];return"columns"===this.measuresAxis()&&(0===this.columns().length?t=e:e.length>1&&(t=e)),t},_rowMeasures:function(){var e=this.measures(),t=[];return"rows"===this.measuresAxis()&&(0===this.rows().length?t=e:e.length>1&&(t=e)),t},_updateLocalData:function(e,t){this.cubeBuilder&&(t&&(this._requestData=t),e=this._processResult(e)),this._data=this._observe(e),this._ranges=[],this._addRange(this._data),this._total=this._data.length,this._pristineTotal=this._total,this._process(this._data)},data:function(e){var i=this;return e===t?i._data:(this._pristineData=e.slice(0),void this._updateLocalData(e,{columns:this.columns(),rows:this.rows(),measures:this.measures()}))},_normalizeTuples:function(e,t,i,a){var n,o,r,s=a.length||1,l=0,d=[],c={},h=0;if(e.length){if(this._skipNormalize<=0&&!this._hasRoot(e[0],t,i)){for(this._skipNormalize=0;s>l;l++)d.push(this._createTuple(e[0],a[l],!0)),c[l]=l;e.splice.apply(e,[0,e.length].concat(d).concat(e)),l=s}if(a.length)for(r=n=e[l],o=n.members.length-1;n;){if(h>=s&&(h=0),n.members[o].name!==a[h].name&&(e.splice(l,0,this._createTuple(n,a[h])),c[l]=l),l+=1,h+=1,n=e[l],s>h&&(!n||Ue(r,o-1)!==Ue(n,o-1))){for(;s>h;h++)e.splice(l,0,this._createTuple(r,a[h])),c[l]=l,l+=1;n=e[l]}r=n}return c}},_addMissingDataItems:function(e,i){for(;i.rowIndexes[parseInt(e.length/i.columnsLength,10)]!==t;)for(var a=0;a<i.columnsLength;a++)e=p(e);for(;i.columnIndexes[e.length%i.columnsLength]!==t;)e=p(e);return e},_normalizeOrdinals:function(e,t,i){var a=i.lastOrdinal;if(!t)return p(e);if(t.ordinal-a>1)for(a+=1;a<t.ordinal&&e.length<i.length;)e=this._addMissingDataItems(p(e),i),a+=1;return t.ordinal=e.length,e[e.length]=t,e},_normalizeData:function(e){var t,i,a,n=e.data,o=0,r=[];if(e.lastOrdinal=0,e.columnIndexes=e.columnIndexes||{},e.rowIndexes=e.rowIndexes||{},e.columnsLength=e.columnsLength||1,e.rowsLength=e.rowsLength||1,e.length=e.columnsLength*e.rowsLength,a=e.length,n.length===a)return n;for(;r.length<a;)t=n[o++],t&&(i=t.ordinal),r=this._normalizeOrdinals(this._addMissingDataItems(r,e),t,e),e.lastOrdinal=i;return r},discover:function(t,i){var a=this,n=a.transport;return e.Deferred(function(e){n.discover(ne({success:function(t){t=a.reader.parse(t),a._handleCustomErrors(t)||(i&&(t=i(t)),e.resolve(t))},error:function(t,i,n){e.reject(t),a.error(t,i,n)}},t))}).promise().done(function(){a.trigger("schemaChange")})},schemaMeasures:function(){var e=this;return e.discover({data:{command:"schemaMeasures",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.measures(t)})},schemaKPIs:function(){var e=this;return e.discover({data:{command:"schemaKPIs",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.kpis(t)})},schemaDimensions:function(){var e=this;return e.discover({data:{command:"schemaDimensions",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}}},function(t){return e.reader.dimensions(t)})},schemaHierarchies:function(e){var t=this;return t.discover({data:{command:"schemaHierarchies",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),dimensionUniqueName:e}}},function(e){return t.reader.hierarchies(e)})},schemaLevels:function(e){var t=this;return t.discover({data:{command:"schemaLevels",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),hierarchyUniqueName:e}}},function(e){return t.reader.levels(e)})},schemaCubes:function(){var e=this;return e.discover({data:{command:"schemaCubes",restrictions:{catalogName:e.transport.catalog()}}},function(t){return e.reader.cubes(t)})},schemaCatalogs:function(){var e=this;return e.discover({data:{command:"schemaCatalogs"}},function(t){return e.reader.catalogs(t)})},schemaMembers:function(e){var t=this,i=function(e){return function(i){return t.reader.members(i,e)}}(e);return t.discover({data:{command:"schemaMembers",restrictions:ne({catalogName:t.transport.catalog(),cubeName:t.transport.cube()},e)}},i)},_params:function(e){this._clearAxesData&&(this._axes={},this._data=this._observe([]),this._clearAxesData=!1,this.trigger(ce));var t=Y.fn._params.call(this,e);return t=ne({measures:this.measures(),measuresAxis:this.measuresAxis(),columns:this.columns(),rows:this.rows()},t),this.cubeBuilder&&(this._requestData=t),t}});Fe.create=function(e){e=e&&e.push?{data:e}:e;var t=e||{},i=t.data;if(t.data=i,!(t instanceof Fe)&&t instanceof W.data.DataSource)throw new Error("Incorrect DataSource type. Only PivotDataSource instances are supported");return t instanceof Fe?t:new Fe(t)};var Te={contains:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0',doesnotcontain:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") = 0',startswith:', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',endswith:', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',eq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',neq:', NOT {0}.CurrentMember.MEMBER_CAPTION = "{1}"'},_e={schemaCubes:"MDSCHEMA_CUBES",schemaCatalogs:"DBSCHEMA_CATALOGS",schemaMeasures:"MDSCHEMA_MEASURES",schemaDimensions:"MDSCHEMA_DIMENSIONS",schemaHierarchies:"MDSCHEMA_HIERARCHIES",schemaLevels:"MDSCHEMA_LEVELS",schemaMembers:"MDSCHEMA_MEMBERS",schemaKPIs:"MDSCHEMA_KPIS"},Ae={read:function(e){var t='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>';t+="SELECT NON EMPTY {";var i=e.columns||[],a=e.rows||[],n=e.measures||[],o="rows"===e.measuresAxis,r=e.sort||[];return!i.length&&a.length&&(!n.length||n.length&&o)&&(i=a,a=[],o=!1),i.length||a.length||(o=!1),i.length?t+=j(i,o?[]:n,r):n.length&&!o&&(t+=R(n).join(",")),t+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS",(a.length||o&&n.length>1)&&(t+=", NON EMPTY {",t+=a.length?j(a,o?n:[],r):R(n).join(","),t+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"),e.filter?(t+=" FROM ",t+="(",t+=U(e.filter,e.connection.cube),t+=")"):t+=" FROM ["+e.connection.cube+"]",1==n.length&&i.length&&(t+=" WHERE ("+R(n).join(",")+")"),t+="</Statement></Command><Properties><PropertyList><Catalog>"+e.connection.catalog+"</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>",t.replace(/\&/g,"&amp;")},discover:function(t){t=t||{};
var i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">';return i+="<RequestType>"+(_e[t.command]||t.command)+"</RequestType>",i+="<Restrictions>"+q("RestrictionList",t.restrictions,!0)+"</Restrictions>",t.connection&&t.connection.catalog&&(t.properties=e.extend({},{Catalog:t.connection.catalog},t.properties)),i+="<Properties>"+q("PropertyList",t.properties)+"</Properties>",i+="</Discover></Body></Envelope>"}},Le=W.data.RemoteTransport.extend({init:function(e){var t=e;e=this.options=ne(!0,{},this.options,e),W.data.RemoteTransport.call(this,e),oe(t.discover)?this.discover=t.discover:"string"==typeof t.discover?this.options.discover={url:t.discover}:t.discover||(this.options.discover=this.options.read)},setup:function(t,i){return t.data=t.data||{},e.extend(!0,t.data,{connection:this.options.connection}),W.data.RemoteTransport.fn.setup.call(this,t,i)},options:{read:{dataType:"text",contentType:"text/xml",type:"POST"},discover:{dataType:"text",contentType:"text/xml",type:"POST"},parameterMap:function(e,t){return Ae[t](e,t)}},discover:function(t){return e.ajax(this.setup(t,"discover"))}}),Me={cubes:{name:W.getter("CUBE_NAME['#text']",!0),caption:W.getter("CUBE_CAPTION['#text']",!0),description:W.getter("DESCRIPTION['#text']",!0),type:W.getter("CUBE_TYPE['#text']",!0)},catalogs:{name:W.getter("CATALOG_NAME['#text']",!0),description:W.getter("DESCRIPTION['#text']",!0)},measures:{name:W.getter("MEASURE_NAME['#text']",!0),caption:W.getter("MEASURE_CAPTION['#text']",!0),uniqueName:W.getter("MEASURE_UNIQUE_NAME['#text']",!0),description:W.getter("DESCRIPTION['#text']",!0),aggregator:W.getter("MEASURE_AGGREGATOR['#text']",!0),groupName:W.getter("MEASUREGROUP_NAME['#text']",!0),displayFolder:W.getter("MEASURE_DISPLAY_FOLDER['#text']",!0),defaultFormat:W.getter("DEFAULT_FORMAT_STRING['#text']",!0)},kpis:{name:W.getter("KPI_NAME['#text']",!0),caption:W.getter("KPI_CAPTION['#text']",!0),value:W.getter("KPI_VALUE['#text']",!0),goal:W.getter("KPI_GOAL['#text']",!0),status:W.getter("KPI_STATUS['#text']",!0),trend:W.getter("KPI_TREND['#text']",!0),statusGraphic:W.getter("KPI_STATUS_GRAPHIC['#text']",!0),trendGraphic:W.getter("KPI_TREND_GRAPHIC['#text']",!0),description:W.getter("KPI_DESCRIPTION['#text']",!0),groupName:W.getter("MEASUREGROUP_NAME['#text']",!0)},dimensions:{name:W.getter("DIMENSION_NAME['#text']",!0),caption:W.getter("DIMENSION_CAPTION['#text']",!0),description:W.getter("DESCRIPTION['#text']",!0),uniqueName:W.getter("DIMENSION_UNIQUE_NAME['#text']",!0),defaultHierarchy:W.getter("DEFAULT_HIERARCHY['#text']",!0),type:W.getter("DIMENSION_TYPE['#text']",!0)},hierarchies:{name:W.getter("HIERARCHY_NAME['#text']",!0),caption:W.getter("HIERARCHY_CAPTION['#text']",!0),description:W.getter("DESCRIPTION['#text']",!0),uniqueName:W.getter("HIERARCHY_UNIQUE_NAME['#text']",!0),dimensionUniqueName:W.getter("DIMENSION_UNIQUE_NAME['#text']",!0),displayFolder:W.getter("HIERARCHY_DISPLAY_FOLDER['#text']",!0),origin:W.getter("HIERARCHY_ORIGIN['#text']",!0),defaultMember:W.getter("DEFAULT_MEMBER['#text']",!0)},levels:{name:W.getter("LEVEL_NAME['#text']",!0),caption:W.getter("LEVEL_CAPTION['#text']",!0),description:W.getter("DESCRIPTION['#text']",!0),uniqueName:W.getter("LEVEL_UNIQUE_NAME['#text']",!0),dimensionUniqueName:W.getter("DIMENSION_UNIQUE_NAME['#text']",!0),displayFolder:W.getter("LEVEL_DISPLAY_FOLDER['#text']",!0),orderingProperty:W.getter("LEVEL_ORDERING_PROPERTY['#text']",!0),origin:W.getter("LEVEL_ORIGIN['#text']",!0),hierarchyUniqueName:W.getter("HIERARCHY_UNIQUE_NAME['#text']",!0)},members:{name:W.getter("MEMBER_NAME['#text']",!0),caption:W.getter("MEMBER_CAPTION['#text']",!0),uniqueName:W.getter("MEMBER_UNIQUE_NAME['#text']",!0),dimensionUniqueName:W.getter("DIMENSION_UNIQUE_NAME['#text']",!0),hierarchyUniqueName:W.getter("HIERARCHY_UNIQUE_NAME['#text']",!0),levelUniqueName:W.getter("LEVEL_UNIQUE_NAME['#text']",!0),childrenCardinality:W.getter("CHILDREN_CARDINALITY['#text']",!0)}},Ee=["axes","catalogs","cubes","dimensions","hierarchies","levels","measures"],Be=W.data.XmlDataReader.extend({init:function(e){W.data.XmlDataReader.call(this,e),this._extend(e)},_extend:function(e){for(var t,i,a=0,n=Ee.length;n>a;a++)t=Ee[a],i=e[t],i&&i!==ie&&(this[t]=i)},parse:function(e){var t=W.data.XmlDataReader.fn.parse(e.replace(/<(\/?)(\w|-)+:/g,"<$1"));return W.getter("['Envelope']['Body']",!0)(t)},errors:function(e){var t=W.getter("['Fault']",!0)(e);return t?[{faultstring:W.getter("faultstring['#text']",!0)(t),faultcode:W.getter("faultcode['#text']",!0)(t)}]:null},axes:function(e){e=W.getter('ExecuteResponse["return"].root',!0)(e);for(var t,i=G(W.getter("Axes.Axis",!0)(e)),a={columns:{},rows:{}},n=0;n<i.length;n++)t=i[n],"sliceraxis"!==t["@name"].toLowerCase()&&(a.columns.tuples?a.rows=$(t):a.columns=$(t));return a},data:function(e){e=W.getter('ExecuteResponse["return"].root',!0)(e);for(var t=G(W.getter("CellData.Cell",!0)(e)),i=[],a=W.getter("['@CellOrdinal']"),n=W.getter("Value['#text']"),o=W.getter("FmtValue['#text']"),r=0;r<t.length;r++)i.push({value:n(t[r]),fmtValue:o(t[r]),ordinal:parseInt(a(t[r]),10)});return i},_mapSchema:function(e,t){e=W.getter('DiscoverResponse["return"].root',!0)(e);for(var i=G(W.getter("row",!0)(e)),a=[],n=0;n<i.length;n++){var o={};for(var r in t)o[r]=t[r](i[n]);a.push(o)}return a},measures:function(e){return this._mapSchema(e,Me.measures)},kpis:function(e){return this._mapSchema(e,Me.kpis)},hierarchies:function(e){return this._mapSchema(e,Me.hierarchies)},levels:function(e){return this._mapSchema(e,Me.levels)},dimensions:function(e){return this._mapSchema(e,Me.dimensions)},cubes:function(e){return this._mapSchema(e,Me.cubes)},catalogs:function(e){return this._mapSchema(e,Me.catalogs)},members:function(e){return this._mapSchema(e,Me.members)}});ne(!0,W.data,{PivotDataSource:Fe,XmlaTransport:Le,XmlaDataReader:Be,PivotCubeBuilder:Ie,transports:{xmla:Le},readers:{xmla:Be}});var Re=function(e,t){if(!e)return null;for(var i=0,a=e.length;a>i;i++)if(e[i].field===t)return e[i];return null},Ne=function(e,t){for(var i=[],a=0,n=e.length;n>a;a++)e[a].field!==t&&i.push(e[a]);return i};W.ui.PivotSettingTarget=X.extend({init:function(t,i){var a=this;X.fn.init.call(a,t,i),a.element.addClass("k-pivot-setting"),a.dataSource=W.data.PivotDataSource.create(i.dataSource),a._refreshHandler=e.proxy(a.refresh,a),a.dataSource.first(re,a._refreshHandler),i.template||(a.options.template="<div data-"+W.ns+'name="${data.name || data}">${data.name || data}'+(a.options.enabled?'<a class="k-button k-button-icon k-button-bare"><span class="k-icon k-setting-delete"></span></a>':"")+"</div>"),a.template=W.template(a.options.template),a.emptyTemplate=W.template(a.options.emptyTemplate),a._sortable(),a.element.on("click"+pe,".k-button,.k-item",function(t){var i=e(t.target),n=i.closest("["+W.attr("name")+"]").attr(W.attr("name"));n&&(i.hasClass("k-setting-delete")?a.remove(n):a.options.sortable&&i[0]===t.currentTarget&&a.sort({field:n,dir:i.find(".k-i-sort-asc")[0]?"desc":"asc"}))}),(i.filterable||i.sortable)&&(a.fieldMenu=new J.PivotFieldMenu(a.element,{messages:a.options.messages.fieldMenu,filter:".k-setting-fieldmenu",filterable:i.filterable,sortable:i.sortable,dataSource:a.dataSource})),a.refresh()},options:{name:"PivotSettingTarget",template:null,filterable:!1,sortable:!1,emptyTemplate:"<div class='k-empty'>${data}</div>",setting:"columns",enabled:!0,messages:{empty:"Drop Fields Here"}},setDataSource:function(e){this.dataSource.unbind(re,this._refreshHandler),this.dataSource=this.options.dataSource=e,this.fieldMenu&&this.fieldMenu.setDataSource(e),e.first(re,this._refreshHandler),this.refresh()},_sortable:function(){var e=this;e.options.enabled&&(this.sortable=this.element.kendoSortable({connectWith:this.options.connectWith,filter:">:not(.k-empty)",hint:e.options.hint,cursor:"move",start:function(e){e.item.focus().blur()},change:function(t){var i=t.item.attr(W.attr("name"));"receive"==t.action?e.add(i):"remove"==t.action?e.remove(i):"sort"==t.action&&e.move(i,t.newIndex)}}).data("kendoSortable"))},_indexOf:function(e,t){var i,a,n=-1;for(i=0,a=t.length;a>i;i++)if(N(t[i])===e){n=i;break}return n},_isKPI:function(e){return"kpi"===e.type||e.measure},validate:function(e){var t=2==e.type||"aggregator"in e||this._isKPI(e);if(t)return"measures"===this.options.setting;if("measures"===this.options.setting)return t;var i=this.dataSource[this.options.setting](),a=e.defaultHierarchy||e.uniqueName;return this._indexOf(a,i)>-1?!1:(i=this.dataSource["columns"===this.options.setting?"rows":"columns"](),this._indexOf(a,i)>-1?!1:!0)},add:function(t){var i,a,n=this.dataSource[this.options.setting]();for(t=e.isArray(t)?t.slice(0):[t],i=0,a=t.length;a>i;i++)-1!==this._indexOf(t[i],n)&&(t.splice(i,1),i-=1,a-=1);t.length&&(n=n.concat(t),this.dataSource[this.options.setting](n))},move:function(e,t){var i=this.dataSource[this.options.setting](),a=this._indexOf(e,i);a>-1&&(e=i.splice(a,1)[0],i.splice(t,0,e),this.dataSource[this.options.setting](i))},remove:function(e){var t=this.dataSource[this.options.setting](),i=this._indexOf(e,t);i>-1&&(t.splice(i,1),this.dataSource[this.options.setting](t))},sort:function(e){var t=this.options.sortable,i=t===!0||t.allowUnsort,a=i&&"asc"===e.dir,n=this.dataSource.sort()||[],o=Ne(n,e.field);a&&n.length!==o.length&&(e=null),e&&o.push(e),this.dataSource.sort(o)},refresh:function(){var e,i="",a=this.dataSource[this.options.setting](),n=a.length,o=0;if(n)for(;n>o;o++)e=a[o],e=e.name===t?{name:e}:e,i+=this.template(ne({sortIcon:this._sortIcon(e.name)},e));else i=this.emptyTemplate(this.options.messages.empty);this.element.html(i)},destroy:function(){X.fn.destroy.call(this),this.dataSource.unbind(re,this._refreshHandler),this.element.off(pe),this.sortable&&this.sortable.destroy(),this.fieldMenu&&this.fieldMenu.destroy(),this.element=null,this._refreshHandler=null},_sortIcon:function(e){var t=this.dataSource.sort(),i=Re(t,N(e)),a="";return i&&(a="k-i-sort-"+i.dir),a}});var He=X.extend({init:function(i,a){var n,o,r=this;X.fn.init.call(r,i,a),r._dataSource(),r._bindConfigurator(),r._wrapper(),r._createLayout(),r._columnBuilder=n=new qe,r._rowBuilder=o=new Ge,r._contentBuilder=new $e,r._templates(),r.columnsHeader.add(r.rowsHeader).on("click","span.k-icon",function(){var i,a=e(this),s=n,l="expandColumn",d=a.attr(W.attr("path")),c={axis:"columns",path:e.parseJSON(d)};a.parent().is("td")&&(s=o,l="expandRow",c.axis="rows");var h=a.hasClass(be),u=s.metadata[d],p=u.expanded===t;i=h?ye:ve,c.childrenLoaded=u.maxChildren>u.children,r.trigger(i,c)||(s.metadata[d].expanded=!h,a.toggleClass(be,!h).toggleClass(De,h),!h&&p?r.dataSource[l](c.path):r.refresh())}),r._scrollable(),r.options.autoBind&&r.dataSource.fetch(),W.notify(r)},events:[fe,me,ve,ye],options:{name:"KDPivotGrid",autoBind:!0,reorderable:!0,filterable:!1,sortable:!1,height:null,columnWidth:100,configurator:"",columnHeaderTemplate:null,rowHeaderTemplate:null,dataCellTemplate:null,kpiStatusTemplate:null,kpiTrendTemplate:null,messages:{measureFields:"Drop Data Fields Here",columnFields:"Drop Column Fields Here",rowFields:"Drop Rows Fields Here"}},_templates:function(){var e=this.options.columnHeaderTemplate,t=this.options.rowHeaderTemplate,i=this.options.dataCellTemplate,a=this.options.kpiStatusTemplate,n=this.options.kpiTrendTemplate;this._columnBuilder.template=W.template(e||ke,{useWithBlock:!!e}),this._contentBuilder.dataTemplate=W.template(i||we,{useWithBlock:!!i}),this._contentBuilder.kpiStatusTemplate=W.template(a||Ce,{useWithBlock:!!a}),this._contentBuilder.kpiTrendTemplate=W.template(n||xe,{useWithBlock:!!n}),this._rowBuilder.template=W.template(t||ke,{useWithBlock:!!t})},_bindConfigurator:function(){var t=this.options.configurator;t&&e(t).kendoPivotConfigurator("setDataSource",this.dataSource)},cellInfoByElement:function(t){return t=e(t),this.cellInfo(t.index(),t.parent("tr").index())},cellInfo:function(e,i){var a,n=this._contentBuilder,o=n.columnIndexes?n.columnIndexes[e||0]:t,r=n.rowIndexes?n.rowIndexes[i||0]:t;return o&&r?(a=r.index*n.rowLength+o.index,{columnTuple:o.tuple,rowTuple:r.tuple,measure:o.measure||r.measure,dataItem:this.dataSource.view()[a]}):null},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.measuresTarget&&this.measuresTarget.setDataSource(e),this.rowsTarget&&this.rowsTarget.setDataSource(e),this.columnsTarget&&this.columnsTarget.setDataSource(e),this._bindConfigurator(),this.options.autoBind&&e.fetch()},setOptions:function(e){X.fn.setOptions.call(this,e),this._templates()},destroy:function(){X.fn.destroy.call(this),clearTimeout(this._headerReflowTimeout)},_dataSource:function(){var t=this,i=t.options.dataSource;i=e.isArray(i)?{data:i}:i,t.dataSource&&this._refreshHandler?t.dataSource.unbind(re,t._refreshHandler).unbind(ce,t._stateResetHandler).unbind(de,t._progressHandler).unbind(se,t._errorHandler):(t._refreshHandler=e.proxy(t.refresh,t),t._progressHandler=e.proxy(t._requestStart,t),t._stateResetHandler=e.proxy(t._stateReset,t),t._errorHandler=e.proxy(t._error,t)),t.dataSource=W.data.PivotDataSource.create(i).bind(re,t._refreshHandler).bind(de,t._progressHandler).bind(ce,t._stateResetHandler).bind(se,t._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_stateReset:function(){this._columnBuilder.reset(),this._rowBuilder.reset()},_wrapper:function(){var e=this.options.height;this.wrapper=this.element.addClass("k-widget k-pivot"),e&&this.wrapper.css("height",e)},_measureFields:function(){this.measureFields=e(ue).addClass("k-pivot-toolbar k-header k-settings-measures"),this.measuresTarget=this._createSettingTarget(this.measureFields,{setting:"measures",messages:{empty:this.options.messages.measureFields}})},_createSettingTarget:function(t,i){var a='<span tabindex="0" class="k-button" data-'+W.ns+'name="${data.name}">${data.caption}',n=i.sortable,o="";return n&&(o+="#if (data.sortIcon) {#",o+='<span class="k-icon ${data.sortIcon} k-setting-sort"></span>',o+="#}#"),(i.filterable||n)&&(o+='<span class="k-icon k-i-arrowhead-s k-setting-fieldmenu"></span>'),this.options.reorderable&&(o+='<span class="k-icon k-si-close k-setting-delete"></span>'),o&&(a+='<span class="k-field-actions">'+o+"</span>"),a+="</span>",new W.ui.PivotSettingTarget(t,e.extend({template:a,emptyTemplate:'<span class="k-empty">${data}</span>',enabled:this.options.reorderable,dataSource:this.dataSource},i))},_initSettingTargets:function(){this.columnsTarget=this._createSettingTarget(this.columnFields,{connectWith:this.rowFields,setting:"columns",filterable:this.options.filterable,sortable:this.options.sortable,messages:{empty:this.options.messages.columnFields,fieldMenu:this.options.messages.fieldMenu}}),this.rowsTarget=this._createSettingTarget(this.rowFields,{connectWith:this.columnFields,setting:"rows",filterable:this.options.filterable,sortable:this.options.sortable,messages:{empty:this.options.messages.rowFields,fieldMenu:this.options.messages.fieldMenu}})},_createLayout:function(){var t=this,i=e(Ke),a=i.find(".k-pivot-rowheaders"),n=i.find(".k-pivot-table"),o=e(ue).addClass("k-grid k-widget");t._measureFields(),t.columnFields=e(ue).addClass("k-pivot-toolbar k-header k-settings-columns"),t.rowFields=e(ue).addClass("k-pivot-toolbar k-header k-settings-rows"),t.columnsHeader=e('<div class="k-grid-header-wrap" />').wrap('<div class="k-grid-header" />'),t.columnsHeader.parent().css("padding-right",W.support.scrollbar()),t.rowsHeader=e('<div class="k-grid k-widget k-alt"/>'),t.content=e('<div class="k-grid-content" />'),a.append(t.measureFields),a.append(t.rowFields),a.append(t.rowsHeader),o.append(t.columnsHeader.parent()),o.append(t.content),n.append(t.columnFields),n.append(o),t.wrapper.append(i),t.columnsHeaderTree=new W.dom.Tree(t.columnsHeader[0]),t.rowsHeaderTree=new W.dom.Tree(t.rowsHeader[0]),t.contentTree=new W.dom.Tree(t.content[0]),t._initSettingTargets()},_progress:function(e){W.ui.progress(this.wrapper,e)},_resize:function(){this.content[0].firstChild&&(this._setSectionsWidth(),this._setSectionsHeight(),this._setContentWidth(),this._setContentHeight(),this._columnHeaderReflow())},_columnHeaderReflow:function(){var e=this.columnsHeader.children("table");W.support.browser.mozilla&&(clearTimeout(this._headerReflowTimeout),e.css("table-layout","auto"),this._headerReflowTimeout=setTimeout(function(){e.css("table-layout","")}))},_setSectionsWidth:function(){var e,t=this.rowsHeader,i=t.parent(".k-pivot-rowheaders").width(he);e=Math.max(Z(this.measureFields),Z(this.rowFields)),e=Math.max(t.children("table").width(),e),i.width(e)},_setSectionsHeight:function(){var e=this.measureFields.height(he).height(),t=this.columnFields.height(he).height(),i=this.rowFields.height(he).innerHeight(),a=this.columnsHeader.height(he).innerHeight(),n=i-this.rowFields.height(),o=t>e?t:e,r=a>i?a:i;this.measureFields.height(o),this.columnFields.height(o),this.rowFields.height(r-n),this.columnsHeader.height(r)},_setContentWidth:function(){var e=this.content.find("table"),t=this.columnsHeader.children("table"),i=e.children("colgroup").children().length,a=i*this.options.columnWidth,n=Math.ceil(a/this.content.width()*100);100>n&&(n=100),e.add(t).css("width",n+"%"),this._resetColspan(t)},_setContentHeight:function(){var e=this,t=e.content,i=e.rowsHeader,a=e.wrapper.innerHeight(),n=W.support.scrollbar(),o=t[0].offsetHeight===t[0].clientHeight,r=e.options.height;if(e.wrapper.is(":visible")){if(!a||!r)return o&&(n=0),t.height("auto"),void i.height(t.height()-n);a-=ee(e.columnFields),a-=ee(e.columnsHeader),2*n>=a&&(a=2*n+1,o||(a+=n)),t.height(a),o&&(n=0),i.height(a-n)}},_resetColspan:function(e){var i=this,a=e.children("tbody").children(":first").children(":first");i._colspan===t&&(i._colspan=a.attr("colspan")),a.attr("colspan",1),clearTimeout(i._layoutTimeout),i._layoutTimeout=setTimeout(function(){a.attr("colspan",i._colspan),i._colspan=t})},_axisMeasures:function(e){var t=[],i=this.dataSource,a=i.measures(),n=a.length>1||a[0]&&a[0].type;return i.measuresAxis()===e&&(0===i[e]().length||n)&&(t=a),t},items:function(){return[]},refresh:function(){var e=this,t=e.dataSource,i=t.axes(),a=(i.columns||{}).tuples||[],n=(i.rows||{}).tuples||[],o=e._columnBuilder,r=e._rowBuilder,s={},l={};if(!e.trigger(fe,{action:"rebind"})){if(o.measures=e._axisMeasures("columns"),e.columnsHeaderTree.render(o.build(a)),e.rowsHeaderTree.render(r.build(n)),s={indexes:o._indexes,measures:o.measures,metadata:o.metadata},l={indexes:r._indexes,measures:this._axisMeasures("rows"),metadata:r.metadata},e.contentTree.render(e._contentBuilder.build(t.view(),s,l)),e._resize(),e.touchScroller)e.touchScroller.contentResized();else{var d=W.touchScroller(e.content);d&&d.movable&&(e.touchScroller=d,d.movable.bind("change",function(t){e.columnsHeader.scrollLeft(-t.sender.x),e.rowsHeader.scrollTop(-t.sender.y)}))}e._progress(!1),e.trigger(me)}},_scrollable:function(){var t=this,i=t.columnsHeader,a=t.rowsHeader;t.content.scroll(function(){i.scrollLeft(this.scrollLeft),a.scrollTop(this.scrollTop)}),a.bind("DOMMouseScroll"+pe+" mousewheel"+pe,e.proxy(t._wheelScroll,t))},_wheelScroll:function(t){if(!t.ctrlKey){var i=W.wheelDeltaY(t),a=this.content.scrollTop();i&&(t.preventDefault(),e(t.currentTarget).one("wheel"+pe,!1),this.rowsHeader.scrollTop(a+-i),this.content.scrollTop(a+-i))}}}),Oe=W.dom.element,Ve=W.dom.html,je=function(e,t){return{maxChildren:0,children:0,maxMembers:0,members:0,measures:1,levelNum:e,parentMember:0!==t}},ze=function(e,t){for(var i=[],a=0;t>=a;a++)i.push(e.members[a].name);return i},Ue=function(e,t){for(var i="",a=0;t>=a;a++)i+=e.members[a].name;return i},qe=Q.extend({init:function(){this.measures=1,this.metadata={}},build:function(e){var t=this._tbody(e),i=this._colGroup();return[Oe("table",null,[i,t])]},reset:function(){this.metadata={}},_colGroup:function(){for(var e=this._rowLength(),t=[],i=0;e>i;i++)t.push(Oe("col",null));return Oe("colgroup",null,t)},_tbody:function(e){var t=e[0];return this.map={},this.rows=[],this.rootTuple=t,this._indexes=[],t?(this._buildRows(t,0),this._normalize()):this.rows.push(Oe("tr",null,[Oe("th",null,[Ve("&nbsp;")])])),Oe("tbody",null,this.rows)},_normalize:function(){for(var e,t,i,a,n,o=this.rows,r=o.length,s=0;r>s;s++)if(e=o[s],1!==e.rowSpan)for(a=e.children,i=0,t=a.length;t>i;i++)n=a[i],n.tupleAll&&(n.attr.rowSpan=e.rowSpan)},_rowIndex:function(e){for(var t=this.rows,i=t.length,a=0;i>a&&t[a]!==e;a++);return a},_rowLength:function(){var e=this.rows[0]?this.rows[0].children:[],t=e.length,i=0,a=0;if(t)for(;t>a;a++)i+=e[a].attr.colSpan||1;return i||(i=this.measures),i},_row:function(e,t,i){var a,n,o=this.rootTuple.members[t].name,r=e.members[t].levelNum,s=o+r,l=this.map,d=l[s];return d?(d.notFirst=!1,d.parentMember&&d.parentMember===i||(d.parentMember=i,d.collapsed=0,d.colSpan=0)):(d=Oe("tr",null,[]),d.parentMember=i,d.collapsed=0,d.colSpan=0,d.rowSpan=1,l[s]=d,a=l[o+(Number(r)-1)],a&&(n=a.children,n[1]&&-1===n[1].attr.className.indexOf("k-alt")?d.notFirst=!0:d.notFirst=a.notFirst),this.rows.splice(this._rowIndex(a)+1,0,d)),d},_measures:function(e,t,i){var a,n=this.map,o=n.measureRow;o||(o=Oe("tr",null,[]),n.measureRow=o,this.rows.push(o));for(var r=0,s=e.length;s>r;r++)a=e[r],o.children.push(this._cell(i||"",[this._content(a,t)],a));return s},_content:function(e,t){return Ve(this.template({member:e,tuple:t}))},_cell:function(e,t,i){var a=Oe("th",{className:"k-header"+e},t);return a.value=i.caption||i.name,a},_buildRows:function(e,t,i){var a,n,o,r,s,l,d,c,h,u,p=e.members,g=p[t],f=p[t+1],m=[],v=0,y=0,b=0;if(g.measure)return void this._measures(g.children,e);if(c=W.stringify(ze(e,t)),a=this._row(e,t,i),o=g.children,r=o.length,h=this.metadata[c],h||(this.metadata[c]=h=je(Number(g.levelNum),t),h.rootLevelNum=Number(this.rootTuple.members[t].levelNum)),this._indexes.push({path:c,tuple:e}),g.hasChildren&&(h.expanded===!1&&(y=h.maxChildren,a.collapsed+=y,h.children=0,r=0),d={className:"k-icon "+(r?be:De)},d[W.attr("path")]=c,m.push(Oe("span",d))),m.push(this._content(g,e)),s=this._cell(a.notFirst?" k-first":"",m,g),a.children.push(s),a.colSpan+=1,r){for(l=this._cell(" k-alt",[this._content(g,e)],g),a.children.push(l);r>v;v++)n=this._buildRows(o[v],t,g);u=n.colSpan,y=n.collapsed,s.attr.colSpan=u,h.children=u,h.members=1,a.colSpan+=u,a.collapsed+=y,a.rowSpan=n.rowSpan+1,f&&(f.measure?u=this._measures(f.children,e," k-alt"):(n=this._buildRows(e,t+1),u=n.colSpan,a.collapsed+=n.collapsed,b=n.collapsed),l.attr.colSpan=u,u-=1,h.members+=u,a.colSpan+=u)}else f&&(f.measure?u=this._measures(f.children,e):(n=this._buildRows(e,t+1),u=n.colSpan,a.collapsed+=n.collapsed,b=n.collapsed),h.members=u,u>1&&(s.attr.colSpan=u,a.colSpan+=u-1));return h.maxMembers<h.members+b&&(h.maxMembers=h.members+b),o=h.children+y,h.maxChildren<o&&(h.maxChildren=o),(l||s).tupleAll=!0,a}}),Ge=Q.extend({init:function(){this.metadata={}},build:function(e){var t=this._tbody(e),i=this._colGroup();return[Oe("table",null,[i,t])]},reset:function(){this.metadata={}},_rowLength:function(){for(var e=this.rows[0].children,t=0,i=0,a=e[i];a;)t+=a.attr.colSpan||1,a=e[++i];return t},_colGroup:function(){for(var e=this._rowLength(),t=[],i=0;e>i;i++)t.push(Oe("col",null));return Oe("colgroup",null,t)},_tbody:function(e){var t=e[0];return this.rootTuple=t,this.rows=[],this.map={},this._indexes=[],t?(this._buildRows(t,0),this._normalize()):this.rows.push(Oe("tr",null,[Oe("td",null,[Ve("&nbsp;")])])),Oe("tbody",null,this.rows)},_normalize:function(){for(var e,t,i,a,n=this.rows,o=n.length,r=0,s=this.rootTuple.members,l=s[0].name,d=s.length,c=0,h=this.map;o>r;r++)for(e=n[r],c=0;d>c;c++)i=this[s[c].name],t=e.colSpan["dim"+c],t&&t.colSpan<i&&(t.attr.colSpan=i-t.colSpan+1);e=h[l],a=h[l+"all"],e&&(e.children[0].attr.className="k-first"),a&&(a.children[0].attr.className+=" k-first")},_row:function(e){var t=Oe("tr",null,e);return t.rowSpan=1,t.colSpan={},this.rows.push(t),t},_content:function(e,t){var i=this.template({member:e,tuple:t});return e.caption&&0!=e.caption.trim().length||(i=e.isAllCell?"<span>小计</span>":"<span style='visibility: hidden;width: 0px;display: inline-block;'>null</span>"),Ve(i)},_cell:function(e,t,i){var a=Oe("td",{className:e},t);return a.value=i.caption||i.name,a},_buildRows:function(e,t){var i,a,n,o,r,s,l,d,c,h=this.map,u=e.members,p=u[t],g=u[t+1],f=p.children,m=f.length,v=Number(p.levelNum),y=this.rootTuple.members[t].name,b=ze(e,t-1).join(""),D=Number(this.rootTuple.members[t].levelNum),k=b+(D===v?"":p.parentName||""),C=h[k+"all"]||h[k],x=v+1,w=[];if(!C||C.hasChild?C=this._row():C.hasChild=!0,p.measure){for(l=C.allCell?"k-grid-footer":"",C.children.push(this._cell(l,[this._content(f[0],e)],f[0])),C.rowSpan=m,c=1;m>c;c++)this._row([this._cell(l,[this._content(f[c],e)],f[c])]);return C}if(h[b+p.name]=C,i=W.stringify(ze(e,t)),s=this.metadata[i],s||(this.metadata[i]=s=je(v,t),s.rootLevelNum=D),this._indexes.push({path:i,tuple:e}),p.hasChildren&&(s.expanded===!1&&(m=0,s.children=0),d={className:"k-icon "+(m?be:De)},d[W.attr("path")]=i,w.push(Oe("span",d))),w.push(this._content(p,e)),l=C.allCell&&!m?"k-grid-footer":"",a=this._cell(l,w,p),a.colSpan=x,C.children.push(a),C.colSpan["dim"+t]=a,(!this[y]||this[y]<x)&&(this[y]=x),m){for(C.allCell=!1,C.hasChild=!1,c=0;m>c;c++)o=this._buildRows(f[c],t),C!==o&&(C.rowSpan+=o.rowSpan);C.rowSpan>1&&(a.attr.rowSpan=C.rowSpan),s.children=C.rowSpan,p.isAllCell=!0,n=this._cell("k-grid-footer",[this._content(p,e)],p),delete p.isAllCell,n.colSpan=x,r=this._row([n]),r.colSpan["dim"+t]=n,r.allCell=!0,h[b+p.name+"all"]=r,g&&(o=this._buildRows(e,t+1),n.attr.rowSpan=o.rowSpan),C.rowSpan+=r.rowSpan,s.members=r.rowSpan}else g&&(C.hasChild=!1,this._buildRows(e,t+1),(n||a).attr.rowSpan=C.rowSpan,s.members=C.rowSpan);return s.maxChildren<s.children&&(s.maxChildren=s.children),s.maxMembers<s.members&&(s.maxMembers=s.members),C}}),$e=Q.extend({init:function(){this.columnAxis={},this.rowAxis={}},build:function(e,i,a){var n=i.indexes[0],o=i.metadata[n?n.path:t];this.columnAxis=i,this.rowAxis=a,this.data=e,this.rowLength=o?o.maxChildren+o.maxMembers:i.measures.length||1,this.rowLength||(this.rowLength=1);var r=this._tbody(),s=this._colGroup();return[Oe("table",null,[s,r])]},_colGroup:function(){var e=this.columnAxis.measures.length||1,t=[],i=0;for(this.rows[0]&&(e=this.rows[0].children.length);e>i;i++)t.push(Oe("col",null));return Oe("colgroup",null,t)},_tbody:function(){return this.rows=[],this.data[0]?(this.columnIndexes=this._indexes(this.columnAxis,this.rowLength),this.rowIndexes=this._indexes(this.rowAxis,Math.ceil(this.data.length/this.rowLength)),this._buildRows()):this.rows.push(Oe("tr",null,[Oe("td",null,[Ve("&nbsp;")])])),Oe("tbody",null,this.rows)},_indexes:function(e,i){var a,n,o,r,s,l,d=[],c=e.indexes,h=e.metadata,u=e.measures,p=u.length||1,g=0,f=0,m=0,v=c.length;if(!v){for(o=0;p>o;o++)d[o]={index:o,measure:u[o],tuple:null};return d}for(;v>m;m++){if(a=c[m],n=h[a.path],s=n.children+n.members,l=0,s&&(s-=p),n.expanded===!1&&n.children!==n.maxChildren&&(l=n.maxChildren),n.parentMember&&n.levelNum===n.rootLevelNum&&(s=-1),s>-1){for(o=0;p>o;o++)r=s+o,n.children||(r+=f),d[s+f+o]={children:s,index:g,measure:u[o],tuple:a.tuple},g+=1;for(;d[f]!==t;)f+=1}if(f===i)break;g+=l}return d},_buildRows:function(){for(var e=this.rowIndexes,t=e.length,i=0;t>i;i++)this.rows.push(this._buildRow(e[i]))},_buildRow:function(e){for(var t,i,a,n,o,r,s,l=e.index*this.rowLength,d=this.columnIndexes,c=d.length,h=[],u=0;c>u;u++)t=d[u],o={},t.children&&(o.className="k-alt"),n="",r=this.data[l+t.index],s=t.measure||e.measure,r&&t&&s&&(i={columnTuple:t.tuple,rowTuple:e.tuple,measure:s,dataItem:r},""!==r.value&&s&&s.type&&("status"===s.type?n=this.kpiStatusTemplate(i):"trend"===s.type&&(n=this.kpiTrendTemplate(i))),n||(n=this.dataTemplate(i)),a=Oe("td",o,[Ve(n)]),a.value=r.value,h.push(a));return o={},e.children&&(o.className="k-grid-footer"),Oe("tr",o,h)}});J.plugin(He),W.PivotExcelExporter=W.Class.extend({init:function(e){this.options=e,this.widget=e.widget,this.dataSource=this.widget.dataSource},_columns:function(){var e,t=this.widget.columnsHeaderTree.children[0],i=this.widget.rowsHeaderTree.children[0],a=t.children[0].children.length,n=i.children[0].children.length,o=this.widget.options.columnWidth,r=[];if(n&&this.dataSource.data()[0])for(e=0;n>e;e++)r.push({autoWidth:!0});for(e=0;a>e;e++)r.push({autoWidth:!1,width:o});return r},_cells:function(e,t,i){for(var a,n,o,r,s,l=[],d=0,c=e.length;c>d;d++){for(n=[],o=e[d].children,a=o.length,r=0;a>r;r++)s=o[r],n.push({background:"#7a7a7a",color:"#fff",value:s.value,colSpan:s.attr.colSpan||1,rowSpan:s.attr.rowSpan||1});i&&i(n,d),l.push({cells:n,type:t})}return l},_rows:function(){var e=this.widget.columnsHeaderTree.children[0],t=this.widget.rowsHeaderTree.children[0],i=e.children[0].children.length,a=t.children[0].children.length,n=e.children[1].children,o=t.children[1].children,r=this.widget.contentTree.children[0].children[1].children,s=this._cells(n,"header");a&&s[0].cells.splice(0,0,{background:"#7a7a7a",color:"#fff",value:"",colSpan:a,rowSpan:n.length});var l=function(e,t){for(var a,n,o=0,s=r[t].children;i>o;o++)a=s[o],n=Number(a.value),isNaN(n)&&(n=a.value),e.push({background:"#dfdfdf",color:"#333",value:n,colSpan:1,rowSpan:1})},d=this._cells(o,"data",l);return s.concat(d)},_freezePane:function(){var e=this.widget.columnsHeaderTree.children[0],t=this.widget.rowsHeaderTree.children[0],i=t.children[0].children.length,a=e.children[1].children;return{colSplit:i,rowSplit:a.length}},workbook:function(){var t;return this.dataSource.view()[0]?(t=e.Deferred(),t.resolve()):t=this.dataSource.fetch(),t.then(e.proxy(function(){return{sheets:[{columns:this._columns(),rows:this._rows(),freezePane:this._freezePane(),filter:null}]}},this))}});var We={extend:function(t){t.events.push("excelExport"),t.options.excel=e.extend(t.options.excel,this.options),t.saveAsExcel=this.saveAsExcel},options:{proxyURL:"",filterable:!1,fileName:"Export.xlsx"},saveAsExcel:function(){var t=this.options.excel||{},i=new W.PivotExcelExporter({widget:this});i.workbook().then(e.proxy(function(e){if(!this.trigger("excelExport",{workbook:e})){var i=new W.ooxml.Workbook(e);W.saveAs({dataURI:i.toDataURL(),fileName:e.fileName||t.fileName,proxyURL:t.proxyURL,forceProxy:t.forceProxy})}},this))}};W.PivotExcelMixin=We,W.ooxml&&W.ooxml.Workbook&&We.extend(He.prototype),W.PDFMixin&&(W.PDFMixin.extend(He.prototype),He.fn._drawPDF=function(){return this._drawPDFShadow({width:this.wrapper.width()},{avoidLinks:this.options.pdf.avoidLinks})})}(window.kendo.jQuery),define("KDPivotGrid",["KD"],function(e){return function(){var t;return t||e.KDPivotGrid}}(this)),KDExtendTextAreaProxy=KD.extend(KDTextAreaProxy,{tipWordTemplate:"",splitWordNumber:-1,loadConfig:function(e){this.setTipWordTemplate(KD.getValue(e,"TipWordTemplate","")),this.setSplitWordNumber(KD.getValue(e,"SplitWordNumber",0)),KDExtendTextAreaProxy.superclass.loadConfig.call(this,e)},initComponent:function(){var e=this;if(KDExtendTextAreaProxy.superclass.initComponent.call(this),!KD.isEmpty(this.el)){var t=$("<label class='kd_labelTips'></label>");this.labelTips=t;var i=this.el.find("textarea");KD.isEmpty(this.itemContainer)?(this.el.after(t),this.labelTips.css({"max-width":this.el.width()+5+2+"px"})):(this.itemContainer.el.find(".kdItemContainer_editorct").after(t),this.labelTips.css({"max-width":this.itemContainer.el.find(".kdItemContainer_editorct").width()+5+2+"px"}));var a=(this.itemContainer&&this.itemContainer.el.find(".kdItemContainer_label"),this.config.addPaddingRight||0);this.labelTips.css({display:"inline-block","float":"right","padding-right":28+a+"px"}),i.off("keyup").on("keyup",function(t){e.onkeyUp.call(e,t),t.stopPropagation()}),i.off("mousedown").on("mousedown",function(t){e.onkeyUp.call(e,t),t.stopPropagation()}),i.off("mouseup").on("mouseup",function(t){e.onkeyUp.call(e,t),t.stopPropagation()}),this.itemContainer&&this.itemContainer.el.css({display:"inline-block"}),e.onkeyUp.call(e,null)}},setVisible:function(e){KDExtendTextAreaProxy.superclass.setVisible.call(this,e),
e&&this.itemContainer&&this.itemContainer.el.css({display:"inline-block"})},asyncValueToUIText:function(e){KDExtendTextAreaProxy.superclass.asyncValueToUIText.call(this,e),this.onkeyUp.call(this,null)},onkeyUp:function(e){if(!KD.isEmpty(this.tipWordTemplate)){var t,i,a=this.el.find("textarea"),n=a[0].selectionEnd,o=a.val().length;t=a.val().substring(0,n).split("\n").length,i=a.val().substring(0,n).split("\n")[t-1].length;var r=this.tipWordTemplate.replace("{TOTALNUME}",this.config.maxLength||2147483647).replace("{EDITEDNUMBER}",o);r=r.replace("{LINESELECTION}",t),r=r.replace("{LINECHARTSELECTION}",i),r=r.replace("{CHARTSELECTION}",n),this.splitWordNumber>0&&(r=r.replace("{SPLITNUMBER}",Math.ceil(o/this.splitWordNumber))),this.labelTips.text(r)}},setTipWordTemplate:function(e){this.tipWordTemplate=e},setSplitWordNumber:function(e){this.splitWordNumber=e}}),KDControlFactoryProxy.registerType("kdtextareaext",KDExtendTextAreaProxy),define("KDExtendTextAreaProxy",["KDTextAreaProxy","KD"],function(e){return function(){var t;return t||e.KDExtendTextAreaProxy}}(this)),KDOrgMultiComboBoxProxy=KD.extend(KDMultiComboBoxProxy,{}),KDOrgMultiPopupProxy=KD.extend(KDBOSF7Proxy,{createControl:function(e){return e.AllowAutoList=!1,KDOrgMultiPopupProxy.superclass.createControl.call(this,e)},initComponent:function(){KDOrgMultiPopupProxy.superclass.initComponent.call(this),$(".k-input",this.component).attr("disabled","disabled")},commitUITextToValue:function(e){},getKendoOptions:function(){var e=this,t=KDOrgMultiPopupProxy.superclass.getKendoOptions.call(e)||{};return t.focusedShowDisplayer=!1,t},asyncValueToUIText:function(e){for(var t={name:"",number:""},i=0;i<e.length;i++){var a=e[i];a&&a.length>=2&&(0==i?(t.name=a[1],t.number=a[0]):(t.name=t.name+";"+a[1],t.number=t.number+";"+a[0]))}this.component.data(this.getKendoCType()).val(t)},setValue:function(e){},isEmpty:function(){var e=this.getValue();return this.isEmptyValue(e)},_selectedStore:null,setSelectedStore:function(e){this.isInit=!0,this._oldValue=this._value,this._value=e,this.asyncValueToUIText(e),this.mustInputToggleTips(e);var t=this,i=setTimeout(function(){clearTimeout(i),t.isInit=!1},10)}}),KDControlFactoryProxy.registerType("kdmultiselorg",KDMultiComboBoxProxy),KDControlFactoryProxy.registerType("kdmultiselorgpopup",KDOrgMultiPopupProxy),define("KDOrgMultiComboBoxProxy",["KDEditorProxy","KDMultiComboBoxProxy","KDBosF7Proxy","KD"],function(e){return function(){var t;return t||e.KDOrgMultiComboBoxProxy}}(this)),function(){var e=function(){var e=function(){function e(e,i){for(var a=t.getter(i,!0),n=[],o=0,r={};o<e.length;){var s=e[o++],l=a(s);void 0===l||null===l||r.hasOwnProperty(l)||(n.push(s),r[l]=!0)}return n}if(window.kendo&&window.kendo.ui&&window.kendo.ui.FilterMultiCheck&&window.kendo.ui.FilterMultiCheck.fn&&window.kendo.ui.FilterMultiCheck.fn.createCheckBoxes){var t=window.kendo,i="change",a=".kendoFilterMultiCheck",n=$.proxy,o="refresh";window.kendo.ui.FilterMultiCheck.fn._clickReflashDataSouce=!1,window.kendo.ui.FilterMultiCheck.fn.createCheckBoxes=function(){try{var o,s=this.options,l={field:this.field,format:s.format,mobile:this._isMobile,type:this.type};if(void 0==this.GridHeadFilterOnlyShowVisData&&this.options){var d=this.options.fromGridHeadFilter;if(d){var c=KD.getLocalConfiguration();c=c||{},this.GridHeadFilterOnlyShowVisData=KD.equalsIgnoreCase(c.GridHeadFilterOnlyShowVisData+"","true")}else this.GridHeadFilterOnlyShowVisData=!1}if(!this.dataSource)return;if(!this.checkSource)return;this.GridHeadFilterOnlyShowVisData?(this.checkSource.filter(this.dataSource.filter()),this.checkSource._process(this.dataSource.data()),o=this.checkSource.view(),o=e(o,this.field)):this.options.forceUnique?this._foreignKeyValues()?(this._clickReflashDataSouce&&this.checkSource.data(e(this.dataSource.data(),this.field)),o=this.checkSource.data(),l.valueField="value",l.field="text"):(this._clickReflashDataSouce&&this.checkSource.data(e(this.dataSource.data(),this.field)),o=this.checkSource.data()):(this._clickReflashDataSouce&&this.checkSource.data(e(this.dataSource.data(),this.field)),o=this.checkSource.view());var h=this.field,u={};this.options&&this.options.filterSortField&&(h=this.options.filterSortField.field||this.field,KD.isEmpty(this.options.filterSortField.dataIndex)||(u.dataIndex=this.options.filterSortField.dataIndex),KD.isEmpty(this.options.filterSortField.fieldNameExtend)||(u.fieldNameExtend=this.options.filterSortField.fieldNameExtend)),o=r(o,h,this.options.schemaModel,u);var p=t.template(s.itemTemplate(l)),g=t.render(p,o);s.checkAll&&this.createCheckAllItem(),this.container.on(i+a,":checkbox",n(this.updateCheckAllState,this)),this.container.append(g)}catch(f){KD.writeError(f)}},window.kendo.ui.FilterMultiCheck.fn.search=function(){try{var e=this.options.schemaModel,t=KD.equalsIgnoreCase(e+"","number"),i=new RegExp("[^0-9.]+","g");if(KD.isEmpty(this.options))return;if(KD.isEmpty(this.searchTextBox))return;if(KD.isEmpty(this.container))return;var a=this.options.ignoreCase,n=this.searchTextBox[0].value,o=this.container.find("label");a&&(n=n.toLowerCase());var r=0;if(this.options.checkAll&&o.length){var s=n?!1:!0;this.options.filterVisibleData&&(s=!0),s?$(o[0]).show():$(o[0]).hide(),r++}for(;r<o.length;){var l=o[r],d=l.textContent||l.innerText;a&&(d=d.toLowerCase());var c=d.indexOf(n)>=0?"":"none";if(t&&"none"==c){var h=d.replace(i,"");c=h.indexOf(n)>=0?"":"none"}l.parentNode.style.display=c,r++}this.options.filterVisibleData&&this.updateCheckAllState()}catch(u){KD.writeError(u)}},window.kendo.ui.FilterMultiCheck.fn.updateCheckAllState=function(){try{if(KD.isEmpty(this.options))return;if(KD.isEmpty(this.form))return;if(KD.isEmpty(this.container))return;if(KD.isEmpty(this.checkBoxAll))return;if(this.options.messages.selectedItemsFormat&&this.form.find(".k-filter-selected-items").text(t.format(this.options.messages.selectedItemsFormat,this.container.find(":checked:not(.k-check-all)").length)),this.checkBoxAll){var e,i=this.container.find(":checkbox:not(.k-check-all):visible");e=i.length<1?!1:i.length==this.container.find(":checked:not(.k-check-all):visible").length,this.checkBoxAll.prop("checked",e)}}catch(a){KD.writeError(a)}},window.kendo.ui.FilterMultiCheck.fn.checkAll=function(){try{if(KD.isEmpty(this.checkBoxAll))return;if(KD.isEmpty(this.container))return;var e=this.checkBoxAll.is(":checked");this.container.find(":checkbox:visible").prop("checked",e)}catch(t){KD.writeError(t)}},window.kendo.ui.FilterMultiCheck.fn._click=function(e){try{if(e.preventDefault(),e.stopPropagation(),this.popup||this.pane){if(void 0==this.GridHeadFilterOnlyShowVisData&&this.options){var t=this.options.fromGridHeadFilter;if(t){var i=KD.getLocalConfiguration();i=i||{},this.GridHeadFilterOnlyShowVisData=KD.equalsIgnoreCase(i.GridHeadFilterOnlyShowVisData+"","true")}else this.GridHeadFilterOnlyShowVisData=!1}(this.GridHeadFilterOnlyShowVisData||this._clickReflashDataSouce)&&(this.container.empty(),this.refresh(),this._clickReflashDataSouce=!1)}else this._init();this._isMobile?this.pane.navigate(this.view,this.options.animations.left):this.popup.toggle()}catch(a){KD.writeError(a)}},window.kendo.ui.FilterMultiCheck.fn.refresh=function(t){try{var i=this.options.forceUnique,a=this.dataSource,n=this.getFilterArray();this._link&&this._link.toggleClass("k-state-active",0!==n.length),this.form&&(t&&i&&t.sender===a&&!a.options.serverPaging&&("itemchange"==t.action||"add"==t.action||"remove"==t.action||a.options.autoSync&&"sync"===t.action)&&!this._foreignKeyValues()&&(this.options.fromGridHeadFilter&&"itemchange"==t.action?this._clickReflashDataSouce=!0:(this.checkSource.data(e(this.dataSource.data(),this.field)),this.container.empty())),this.container.is(":empty")&&this.createCheckBoxes(),this.checkValues(n),this.trigger(o))}catch(r){KD.writeLog("window.kendo.ui.FilterMultiCheck.refresh error:",r.message,!0)}}}var r=function(e,t,i,a){for(var n=[],o=0;o<e.length;o++)n.push(e[o]);if(!KD.isEmpty(n)){var r="string";if(KD.equalsIgnoreCase(i,"number")?r="number":"date"==i&&(r="date"),n=KD.quickSortByType(n,t,r,a),n&&e&&n.length==e.length)for(var o=0;o<e.length;o++)e[o]=n[o]}return e}};e();var t=function(){if(window.kendo&&window.kendo.ui&&window.kendo.ui.MediaPlayer){var e=window.kendo,t="k-mediaplayer-quality",i="k-mediaplayer-titlebar",a="k-title",n="k-mediaplayer-toolbar",o="k-mediaplayer-seekbar",r="k-mediaplayer-volume",s="k-mediaplayer-media",l="k-mediaplayer-yt",d=".",c=e.ui,h=new Date(1970,0,1),u=(60*h.getTimezoneOffset(),e.ui.Widget,$.isArray,e.template),p=$.proxy,g=(e.keys,{htmlPlayer:"<video class='"+s+"'> </video>",titleBar:u("<div class='"+i+"' role='heading'><span class='"+a+"'>Video Title</span></div>"),toolBar:"<div class='"+n+"'> </div>",youtubePlayer:"<div class='"+l+"'> </div>",toolBarTime:"<span class='k-mediaplayer-currenttime'>00:00:00</span> / <span class='k-mediaplayer-duration'>00:00:00</span>",slider:"<input class='"+o+"' value='0' title='seekbar' />",volumeSlider:"<input class='"+r+"' title='volume'/>",qualityDropDown:"<input class='"+t+"' title='video quality' />",toolTip:"#= kendo.toString(new Date(value), 'HH:mm:ss') #"});window.kendo.ui.MediaPlayer.fn._createToolbar=function(){var e=this.wrapper.find(d+n);if(0===e.length){this._toolbarClickHandler=p(this._toolbarClick,this),this.wrapper.append(g.toolBar),e=this.wrapper.find(d+n),e.width(this.wrapper.find(d+s).width()),this._toolBar=new c.ToolBar(e,{click:this._toolbarClickHandler,resizable:!1,items:[{template:g.slider},{type:"button",spriteCssClass:"k-icon k-font-icon k-i-play"},{template:g.toolBarTime},{type:"button",spriteCssClass:"k-icon k-font-icon k-i-volume-high"},{template:g.volumeSlider},{template:g.qualityDropDown},{type:"button",spriteCssClass:"k-icon k-font-icon k-i-fullscreen-enter"}]});var t=e.find('span[class*="k-i-volume"]');this._volumeButton=t.parent("a");var i=e.find('span[class*="k-i-fullscreen"]');this._fullscreenButton=i.parent("a"),this._volumeButton.attr("title",this.options.mute?this.options.messages.unmute:this.options.messages.mute),this._volumeButton.attr("aria-label",this.options.mute?this.options.messages.unmute:this.options.messages.mute),this._fullscreenButton.attr("title",this.options.messages.fullscreen),this._fullscreenButton.attr("aria-label",this.options.messages.fullscreen),e.width("auto"),this._currentTimeElement=e.find(".k-mediaplayer-currenttime"),this._durationElement=e.find(".k-mediaplayer-duration"),this._playButtonSpan=e.find('span[class*="k-i-play"]'),this._playButton=this._playButtonSpan.parent("a"),this.options.autoPlay&&this._playStateToggle(!0),$([this._volumeButton[0],e.find(".k-mediaplayer-volume").parent()[0],e.find(".k-mediaplayer-quality").parent()[0],this._fullscreenButton[0]]).wrapAll("<div class='k-align-right' />"),$(".k-button",e).addClass("k-button-bare")}},window.kendo.ui.MediaPlayer.fn._createVolumeSlider=function(){var e=this.wrapper.find(d+r);this._volumeSlider||(this._volumeDraggingHandler=p(this._volumeDragging,this),this._volumeChangeHandler=p(this._volumeChange,this),e=this.wrapper.find(d+r),e.width(87),this._volumeSlider=new c.Slider(e[0],{smallStep:1,min:0,max:100,value:this.options.volume,slide:this._volumeDraggingHandler,change:this._volumeChangeHandler,tickPlacement:"none",showButtons:!1,tooltip:{enabled:!1},dragHandleTitle:""}))}}};t();var i=function(){if(window.kendo&&window.kendo.ui&&window.kendo.ui.Popup&&window.kendo.ui.Popup.fn&&window.kendo.ui.Popup.fn._toggleResize){var e=window.kendo,t=e.ui,i=(t.Widget,e.support),a="scroll",n=$(window);window.kendo.ui.Popup.fn._toggleResize=function(e){var t=e?"on":"off",o=i.resize;if(i.mobileOS.ios||i.mobileOS.android||(o+=" "+a),this.options&&this.options.anchor){var r=$(this.options.anchor).closest(".kd-tab-form-container-ui-fluid");r&&r.length>0&&r[t](a,this._resizeProxy)}n[t](o,this._resizeProxy)}}};i()};KD.delayInvoke(function(){e()})}(),define("KDOverrideKendo",["KD"],function(e){return function(){var t;return t||e.KDOverrideKendo}}(this)),function(e){e.delayInvoke(function(){var e=window.onKDScriptReady;e&&e()},30)}(KD),define("kdscriptready",["KDFlexDynamicFormProxy"],function(e){return function(){var t;return t||e.kdscriptready}}(this));
//# sourceMappingURL=k3cloud.min.js.map